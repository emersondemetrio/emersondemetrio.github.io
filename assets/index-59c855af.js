function _mergeNamespaces(e,i){for(var a=0;a<i.length;a++){const o=i[a];if(typeof o!="string"&&!Array.isArray(o)){for(const c in o)if(c!=="default"&&!(c in e)){const s=Object.getOwnPropertyDescriptor(o,c);s&&Object.defineProperty(e,c,s.get?s:{enumerable:!0,get:()=>o[c]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const s of c)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function a(c){const s={};return c.integrity&&(s.integrity=c.integrity),c.referrerPolicy&&(s.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?s.credentials="include":c.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(c){if(c.ep)return;c.ep=!0;const s=a(c);fetch(c.href,s)}})();function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$2=Symbol.iterator;function A$1(e){return e===null||typeof e!="object"?null:(e=z$2&&e[z$2]||e["@@iterator"],typeof e=="function"?e:null)}var B$2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(e,i,a){this.props=e,this.context=i,this.refs=D$1,this.updater=a||B$2}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(e,i){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,i,"setState")};E$1.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(e,i,a){this.props=e,this.context=i,this.refs=D$1,this.updater=a||B$2}var H$2=G$1.prototype=new F;H$2.constructor=G$1;C$1(H$2,E$1.prototype);H$2.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$2={current:null},L$2={key:!0,ref:!0,__self:!0,__source:!0};function M$2(e,i,a){var o,c={},s=null,d=null;if(i!=null)for(o in i.ref!==void 0&&(d=i.ref),i.key!==void 0&&(s=""+i.key),i)J.call(i,o)&&!L$2.hasOwnProperty(o)&&(c[o]=i[o]);var $=arguments.length-2;if($===1)c.children=a;else if(1<$){for(var et=Array($),h=0;h<$;h++)et[h]=arguments[h+2];c.children=et}if(e&&e.defaultProps)for(o in $=e.defaultProps,$)c[o]===void 0&&(c[o]=$[o]);return{$$typeof:l$1,type:e,key:s,ref:d,props:c,_owner:K$2.current}}function N$1(e,i){return{$$typeof:l$1,type:e.type,key:i,ref:e.ref,props:e.props,_owner:e._owner}}function O$1(e){return typeof e=="object"&&e!==null&&e.$$typeof===l$1}function escape(e){var i={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(a){return i[a]})}var P$1=/\/+/g;function Q$2(e,i){return typeof e=="object"&&e!==null&&e.key!=null?escape(""+e.key):i.toString(36)}function R$2(e,i,a,o,c){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var d=!1;if(e===null)d=!0;else switch(s){case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case l$1:case n$1:d=!0}}if(d)return d=e,c=c(d),e=o===""?"."+Q$2(d,0):o,I$1(c)?(a="",e!=null&&(a=e.replace(P$1,"$&/")+"/"),R$2(c,i,a,"",function(h){return h})):c!=null&&(O$1(c)&&(c=N$1(c,a+(!c.key||d&&d.key===c.key?"":(""+c.key).replace(P$1,"$&/")+"/")+e)),i.push(c)),1;if(d=0,o=o===""?".":o+":",I$1(e))for(var $=0;$<e.length;$++){s=e[$];var et=o+Q$2(s,$);d+=R$2(s,i,a,et,c)}else if(et=A$1(e),typeof et=="function")for(e=et.call(e),$=0;!(s=e.next()).done;)s=s.value,et=o+Q$2(s,$++),d+=R$2(s,i,a,et,c);else if(s==="object")throw i=String(e),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return d}function S$1(e,i,a){if(e==null)return e;var o=[],c=0;return R$2(e,o,"","",function(s){return i.call(a,s,c++)}),o}function T$1(e){if(e._status===-1){var i=e._result;i=i(),i.then(function(a){(e._status===0||e._status===-1)&&(e._status=1,e._result=a)},function(a){(e._status===0||e._status===-1)&&(e._status=2,e._result=a)}),e._status===-1&&(e._status=0,e._result=i)}if(e._status===1)return e._result.default;throw e._result}var U$3={current:null},V$2={transition:null},W$1={ReactCurrentDispatcher:U$3,ReactCurrentBatchConfig:V$2,ReactCurrentOwner:K$2};react_production_min.Children={map:S$1,forEach:function(e,i,a){S$1(e,function(){i.apply(this,arguments)},a)},count:function(e){var i=0;return S$1(e,function(){i++}),i},toArray:function(e){return S$1(e,function(i){return i})||[]},only:function(e){if(!O$1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};react_production_min.Component=E$1;react_production_min.Fragment=p$2;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.cloneElement=function(e,i,a){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=C$1({},e.props),c=e.key,s=e.ref,d=e._owner;if(i!=null){if(i.ref!==void 0&&(s=i.ref,d=K$2.current),i.key!==void 0&&(c=""+i.key),e.type&&e.type.defaultProps)var $=e.type.defaultProps;for(et in i)J.call(i,et)&&!L$2.hasOwnProperty(et)&&(o[et]=i[et]===void 0&&$!==void 0?$[et]:i[et])}var et=arguments.length-2;if(et===1)o.children=a;else if(1<et){$=Array(et);for(var h=0;h<et;h++)$[h]=arguments[h+2];o.children=$}return{$$typeof:l$1,type:e.type,key:c,ref:s,props:o,_owner:d}};react_production_min.createContext=function(e){return e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:t,_context:e},e.Consumer=e};react_production_min.createElement=M$2;react_production_min.createFactory=function(e){var i=M$2.bind(null,e);return i.type=e,i};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(e){return{$$typeof:v$1,render:e}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(e){return{$$typeof:y,_payload:{_status:-1,_result:e},_init:T$1}};react_production_min.memo=function(e,i){return{$$typeof:x,type:e,compare:i===void 0?null:i}};react_production_min.startTransition=function(e){var i=V$2.transition;V$2.transition={};try{e()}finally{V$2.transition=i}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(e,i){return U$3.current.useCallback(e,i)};react_production_min.useContext=function(e){return U$3.current.useContext(e)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(e){return U$3.current.useDeferredValue(e)};react_production_min.useEffect=function(e,i){return U$3.current.useEffect(e,i)};react_production_min.useId=function(){return U$3.current.useId()};react_production_min.useImperativeHandle=function(e,i,a){return U$3.current.useImperativeHandle(e,i,a)};react_production_min.useInsertionEffect=function(e,i){return U$3.current.useInsertionEffect(e,i)};react_production_min.useLayoutEffect=function(e,i){return U$3.current.useLayoutEffect(e,i)};react_production_min.useMemo=function(e,i){return U$3.current.useMemo(e,i)};react_production_min.useReducer=function(e,i,a){return U$3.current.useReducer(e,i,a)};react_production_min.useRef=function(e){return U$3.current.useRef(e)};react_production_min.useState=function(e){return U$3.current.useState(e)};react_production_min.useSyncExternalStore=function(e,i,a){return U$3.current.useSyncExternalStore(e,i,a)};react_production_min.useTransition=function(){return U$3.current.useTransition()};react_production_min.version="18.2.0";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(e,i,a){var o,c={},s=null,d=null;a!==void 0&&(s=""+a),i.key!==void 0&&(s=""+i.key),i.ref!==void 0&&(d=i.ref);for(o in i)m$1.call(i,o)&&!p$1.hasOwnProperty(o)&&(c[o]=i[o]);if(e&&e.defaultProps)for(o in i=e.defaultProps,i)c[o]===void 0&&(c[o]=i[o]);return{$$typeof:k,type:e,key:s,ref:d,props:c,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function i(Sn,t0){var d0=Sn.length;Sn.push(t0);e:for(;0<d0;){var xn=d0-1>>>1,f0=Sn[xn];if(0<c(f0,t0))Sn[xn]=t0,Sn[d0]=f0,d0=xn;else break e}}function a(Sn){return Sn.length===0?null:Sn[0]}function o(Sn){if(Sn.length===0)return null;var t0=Sn[0],d0=Sn.pop();if(d0!==t0){Sn[0]=d0;e:for(var xn=0,f0=Sn.length,$0=f0>>>1;xn<$0;){var N0=2*(xn+1)-1,j0=Sn[N0],Z0=N0+1,fy=Sn[Z0];if(0>c(j0,d0))Z0<f0&&0>c(fy,j0)?(Sn[xn]=fy,Sn[Z0]=d0,xn=Z0):(Sn[xn]=j0,Sn[N0]=d0,xn=N0);else if(Z0<f0&&0>c(fy,d0))Sn[xn]=fy,Sn[Z0]=d0,xn=Z0;else break e}}return t0}function c(Sn,t0){var d0=Sn.sortIndex-t0.sortIndex;return d0!==0?d0:Sn.id-t0.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var d=Date,$=d.now();e.unstable_now=function(){return d.now()-$}}var et=[],h=[],b=1,g=null,st=3,$t=!1,vt=!1,Ft=!1,Gt=typeof setTimeout=="function"?setTimeout:null,qt=typeof clearTimeout=="function"?clearTimeout:null,Lt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function rr(Sn){for(var t0=a(h);t0!==null;){if(t0.callback===null)o(h);else if(t0.startTime<=Sn)o(h),t0.sortIndex=t0.expirationTime,i(et,t0);else break;t0=a(h)}}function jr(Sn){if(Ft=!1,rr(Sn),!vt)if(a(et)!==null)vt=!0,Mo(Hr);else{var t0=a(h);t0!==null&&e0(jr,t0.startTime-Sn)}}function Hr(Sn,t0){vt=!1,Ft&&(Ft=!1,qt(No),No=-1),$t=!0;var d0=st;try{for(rr(t0),g=a(et);g!==null&&(!(g.expirationTime>t0)||Sn&&!l0());){var xn=g.callback;if(typeof xn=="function"){g.callback=null,st=g.priorityLevel;var f0=xn(g.expirationTime<=t0);t0=e.unstable_now(),typeof f0=="function"?g.callback=f0:g===a(et)&&o(et),rr(t0)}else o(et);g=a(et)}if(g!==null)var $0=!0;else{var N0=a(h);N0!==null&&e0(jr,N0.startTime-t0),$0=!1}return $0}finally{g=null,st=d0,$t=!1}}var wn=!1,_n=null,No=-1,Qo=5,Xo=-1;function l0(){return!(e.unstable_now()-Xo<Qo)}function v0(){if(_n!==null){var Sn=e.unstable_now();Xo=Sn;var t0=!0;try{t0=_n(!0,Sn)}finally{t0?x0():(wn=!1,_n=null)}}else wn=!1}var x0;if(typeof Lt=="function")x0=function(){Lt(v0)};else if(typeof MessageChannel<"u"){var D0=new MessageChannel,M0=D0.port2;D0.port1.onmessage=v0,x0=function(){M0.postMessage(null)}}else x0=function(){Gt(v0,0)};function Mo(Sn){_n=Sn,wn||(wn=!0,x0())}function e0(Sn,t0){No=Gt(function(){Sn(e.unstable_now())},t0)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Sn){Sn.callback=null},e.unstable_continueExecution=function(){vt||$t||(vt=!0,Mo(Hr))},e.unstable_forceFrameRate=function(Sn){0>Sn||125<Sn?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Qo=0<Sn?Math.floor(1e3/Sn):5},e.unstable_getCurrentPriorityLevel=function(){return st},e.unstable_getFirstCallbackNode=function(){return a(et)},e.unstable_next=function(Sn){switch(st){case 1:case 2:case 3:var t0=3;break;default:t0=st}var d0=st;st=t0;try{return Sn()}finally{st=d0}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Sn,t0){switch(Sn){case 1:case 2:case 3:case 4:case 5:break;default:Sn=3}var d0=st;st=Sn;try{return t0()}finally{st=d0}},e.unstable_scheduleCallback=function(Sn,t0,d0){var xn=e.unstable_now();switch(typeof d0=="object"&&d0!==null?(d0=d0.delay,d0=typeof d0=="number"&&0<d0?xn+d0:xn):d0=xn,Sn){case 1:var f0=-1;break;case 2:f0=250;break;case 5:f0=1073741823;break;case 4:f0=1e4;break;default:f0=5e3}return f0=d0+f0,Sn={id:b++,callback:t0,priorityLevel:Sn,startTime:d0,expirationTime:f0,sortIndex:-1},d0>xn?(Sn.sortIndex=d0,i(h,Sn),a(et)===null&&Sn===a(h)&&(Ft?(qt(No),No=-1):Ft=!0,e0(jr,d0-xn))):(Sn.sortIndex=f0,i(et,Sn),vt||$t||(vt=!0,Mo(Hr))),Sn},e.unstable_shouldYield=l0,e.unstable_wrapCallback=function(Sn){var t0=st;return function(){var d0=st;st=t0;try{return Sn.apply(this,arguments)}finally{st=d0}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa$2=reactExports,ca$2=schedulerExports;function p(e){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)i+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da$2=new Set,ea$1={};function fa$2(e,i){ha$1(e,i),ha$1(e+"Capture",i)}function ha$1(e,i){for(ea$1[e]=i,e=0;e<i.length;e++)da$2.add(i[e])}var ia$2=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja$2=Object.prototype.hasOwnProperty,ka$1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la$2={},ma$1={};function oa$2(e){return ja$2.call(ma$1,e)?!0:ja$2.call(la$2,e)?!1:ka$1.test(e)?ma$1[e]=!0:(la$2[e]=!0,!1)}function pa$2(e,i,a,o){if(a!==null&&a.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return o?!1:a!==null?!a.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qa$2(e,i,a,o){if(i===null||typeof i>"u"||pa$2(e,i,a,o))return!0;if(o)return!1;if(a!==null)switch(a.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function v(e,i,a,o,c,s,d){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=o,this.attributeNamespace=c,this.mustUseProperty=a,this.propertyName=e,this.type=i,this.sanitizeURL=s,this.removeEmptyString=d}var z$1={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){z$1[e]=new v(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var i=e[0];z$1[i]=new v(i,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){z$1[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){z$1[e]=new v(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){z$1[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){z$1[e]=new v(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){z$1[e]=new v(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){z$1[e]=new v(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){z$1[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)});var ra$1=/[\-:]([a-z])/g;function sa$2(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var i=e.replace(ra$1,sa$2);z$1[i]=new v(i,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var i=e.replace(ra$1,sa$2);z$1[i]=new v(i,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var i=e.replace(ra$1,sa$2);z$1[i]=new v(i,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){z$1[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)});z$1.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){z$1[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)});function ta$1(e,i,a,o){var c=z$1.hasOwnProperty(i)?z$1[i]:null;(c!==null?c.type!==0:o||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(qa$2(i,a,c,o)&&(a=null),o||c===null?oa$2(i)&&(a===null?e.removeAttribute(i):e.setAttribute(i,""+a)):c.mustUseProperty?e[c.propertyName]=a===null?c.type===3?!1:"":a:(i=c.attributeName,o=c.attributeNamespace,a===null?e.removeAttribute(i):(c=c.type,a=c===3||c===4&&a===!0?"":""+a,o?e.setAttributeNS(o,i,a):e.setAttribute(i,a))))}var ua$2=aa$2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va$1=Symbol.for("react.element"),wa$1=Symbol.for("react.portal"),ya$1=Symbol.for("react.fragment"),za$1=Symbol.for("react.strict_mode"),Aa$1=Symbol.for("react.profiler"),Ba$1=Symbol.for("react.provider"),Ca$1=Symbol.for("react.context"),Da$1=Symbol.for("react.forward_ref"),Ea$1=Symbol.for("react.suspense"),Fa$1=Symbol.for("react.suspense_list"),Ga$1=Symbol.for("react.memo"),Ha$2=Symbol.for("react.lazy"),Ia$1=Symbol.for("react.offscreen"),Ja$2=Symbol.iterator;function Ka$2(e){return e===null||typeof e!="object"?null:(e=Ja$2&&e[Ja$2]||e["@@iterator"],typeof e=="function"?e:null)}var A=Object.assign,La$1;function Ma$1(e){if(La$1===void 0)try{throw Error()}catch(a){var i=a.stack.trim().match(/\n( *(at )?)/);La$1=i&&i[1]||""}return`
`+La$1+e}var Na=!1;function Oa$1(e,i){if(!e||Na)return"";Na=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(h){var o=h}Reflect.construct(e,[],i)}else{try{i.call()}catch(h){o=h}e.call(i.prototype)}else{try{throw Error()}catch(h){o=h}e()}}catch(h){if(h&&o&&typeof h.stack=="string"){for(var c=h.stack.split(`
`),s=o.stack.split(`
`),d=c.length-1,$=s.length-1;1<=d&&0<=$&&c[d]!==s[$];)$--;for(;1<=d&&0<=$;d--,$--)if(c[d]!==s[$]){if(d!==1||$!==1)do if(d--,$--,0>$||c[d]!==s[$]){var et=`
`+c[d].replace(" at new "," at ");return e.displayName&&et.includes("<anonymous>")&&(et=et.replace("<anonymous>",e.displayName)),et}while(1<=d&&0<=$);break}}}finally{Na=!1,Error.prepareStackTrace=a}return(e=e?e.displayName||e.name:"")?Ma$1(e):""}function Pa(e){switch(e.tag){case 5:return Ma$1(e.type);case 16:return Ma$1("Lazy");case 13:return Ma$1("Suspense");case 19:return Ma$1("SuspenseList");case 0:case 2:case 15:return e=Oa$1(e.type,!1),e;case 11:return e=Oa$1(e.type.render,!1),e;case 1:return e=Oa$1(e.type,!0),e;default:return""}}function Qa$2(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ya$1:return"Fragment";case wa$1:return"Portal";case Aa$1:return"Profiler";case za$1:return"StrictMode";case Ea$1:return"Suspense";case Fa$1:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ca$1:return(e.displayName||"Context")+".Consumer";case Ba$1:return(e._context.displayName||"Context")+".Provider";case Da$1:var i=e.render;return e=e.displayName,e||(e=i.displayName||i.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ga$1:return i=e.displayName||null,i!==null?i:Qa$2(e.type)||"Memo";case Ha$2:i=e._payload,e=e._init;try{return Qa$2(e(i))}catch{}}return null}function Ra(e){var i=e.type;switch(e.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=i.render,e=e.displayName||e.name||"",i.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa$2(i);case 8:return i===za$1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Sa$1(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ta$1(e){var i=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ua$1(e){var i=Ta$1(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,i),o=""+e[i];if(!e.hasOwnProperty(i)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var c=a.get,s=a.set;return Object.defineProperty(e,i,{configurable:!0,get:function(){return c.call(this)},set:function(d){o=""+d,s.call(this,d)}}),Object.defineProperty(e,i,{enumerable:a.enumerable}),{getValue:function(){return o},setValue:function(d){o=""+d},stopTracking:function(){e._valueTracker=null,delete e[i]}}}}function Va$2(e){e._valueTracker||(e._valueTracker=Ua$1(e))}function Wa$1(e){if(!e)return!1;var i=e._valueTracker;if(!i)return!0;var a=i.getValue(),o="";return e&&(o=Ta$1(e)?e.checked?"true":"false":e.value),e=o,e!==a?(i.setValue(e),!0):!1}function Xa$2(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ya$2(e,i){var a=i.checked;return A({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??e._wrapperState.initialChecked})}function Za$2(e,i){var a=i.defaultValue==null?"":i.defaultValue,o=i.checked!=null?i.checked:i.defaultChecked;a=Sa$1(i.value!=null?i.value:a),e._wrapperState={initialChecked:o,initialValue:a,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function ab$1(e,i){i=i.checked,i!=null&&ta$1(e,"checked",i,!1)}function bb$1(e,i){ab$1(e,i);var a=Sa$1(i.value),o=i.type;if(a!=null)o==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+a):e.value!==""+a&&(e.value=""+a);else if(o==="submit"||o==="reset"){e.removeAttribute("value");return}i.hasOwnProperty("value")?cb$1(e,i.type,a):i.hasOwnProperty("defaultValue")&&cb$1(e,i.type,Sa$1(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(e.defaultChecked=!!i.defaultChecked)}function db$1(e,i,a){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var o=i.type;if(!(o!=="submit"&&o!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+e._wrapperState.initialValue,a||i===e.value||(e.value=i),e.defaultValue=i}a=e.name,a!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,a!==""&&(e.name=a)}function cb$1(e,i,a){(i!=="number"||Xa$2(e.ownerDocument)!==e)&&(a==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+a&&(e.defaultValue=""+a))}var eb$1=Array.isArray;function fb$1(e,i,a,o){if(e=e.options,i){i={};for(var c=0;c<a.length;c++)i["$"+a[c]]=!0;for(a=0;a<e.length;a++)c=i.hasOwnProperty("$"+e[a].value),e[a].selected!==c&&(e[a].selected=c),c&&o&&(e[a].defaultSelected=!0)}else{for(a=""+Sa$1(a),i=null,c=0;c<e.length;c++){if(e[c].value===a){e[c].selected=!0,o&&(e[c].defaultSelected=!0);return}i!==null||e[c].disabled||(i=e[c])}i!==null&&(i.selected=!0)}}function gb$1(e,i){if(i.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},i,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hb$1(e,i){var a=i.value;if(a==null){if(a=i.children,i=i.defaultValue,a!=null){if(i!=null)throw Error(p(92));if(eb$1(a)){if(1<a.length)throw Error(p(93));a=a[0]}i=a}i==null&&(i=""),a=i}e._wrapperState={initialValue:Sa$1(a)}}function ib$1(e,i){var a=Sa$1(i.value),o=Sa$1(i.defaultValue);a!=null&&(a=""+a,a!==e.value&&(e.value=a),i.defaultValue==null&&e.defaultValue!==a&&(e.defaultValue=a)),o!=null&&(e.defaultValue=""+o)}function jb$1(e){var i=e.textContent;i===e._wrapperState.initialValue&&i!==""&&i!==null&&(e.value=i)}function kb$1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb$1(e,i){return e==null||e==="http://www.w3.org/1999/xhtml"?kb$1(i):e==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mb$1,nb$1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,a,o,c){MSApp.execUnsafeLocalFunction(function(){return e(i,a,o,c)})}:e}(function(e,i){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=i;else{for(mb$1=mb$1||document.createElement("div"),mb$1.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=mb$1.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;i.firstChild;)e.appendChild(i.firstChild)}});function ob$1(e,i){if(i){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=i;return}}e.textContent=i}var pb$1={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb$1=["Webkit","ms","Moz","O"];Object.keys(pb$1).forEach(function(e){qb$1.forEach(function(i){i=i+e.charAt(0).toUpperCase()+e.substring(1),pb$1[i]=pb$1[e]})});function rb$1(e,i,a){return i==null||typeof i=="boolean"||i===""?"":a||typeof i!="number"||i===0||pb$1.hasOwnProperty(e)&&pb$1[e]?(""+i).trim():i+"px"}function sb$1(e,i){e=e.style;for(var a in i)if(i.hasOwnProperty(a)){var o=a.indexOf("--")===0,c=rb$1(a,i[a],o);a==="float"&&(a="cssFloat"),o?e.setProperty(a,c):e[a]=c}}var tb$1=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub$1(e,i){if(i){if(tb$1[e]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(p(137,e));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(p(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(p(61))}if(i.style!=null&&typeof i.style!="object")throw Error(p(62))}}function vb$1(e,i){if(e.indexOf("-")===-1)return typeof i.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb$1=null;function xb$1(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yb$1=null,zb$1=null,Ab$1=null;function Bb$1(e){if(e=Cb$1(e)){if(typeof yb$1!="function")throw Error(p(280));var i=e.stateNode;i&&(i=Db$1(i),yb$1(e.stateNode,e.type,i))}}function Eb$1(e){zb$1?Ab$1?Ab$1.push(e):Ab$1=[e]:zb$1=e}function Fb$1(){if(zb$1){var e=zb$1,i=Ab$1;if(Ab$1=zb$1=null,Bb$1(e),i)for(e=0;e<i.length;e++)Bb$1(i[e])}}function Gb$1(e,i){return e(i)}function Hb$1(){}var Ib$1=!1;function Jb$1(e,i,a){if(Ib$1)return e(i,a);Ib$1=!0;try{return Gb$1(e,i,a)}finally{Ib$1=!1,(zb$1!==null||Ab$1!==null)&&(Hb$1(),Fb$1())}}function Kb$1(e,i){var a=e.stateNode;if(a===null)return null;var o=Db$1(a);if(o===null)return null;a=o[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(p(231,i,typeof a));return a}var Lb$1=!1;if(ia$2)try{var Mb$1={};Object.defineProperty(Mb$1,"passive",{get:function(){Lb$1=!0}}),window.addEventListener("test",Mb$1,Mb$1),window.removeEventListener("test",Mb$1,Mb$1)}catch{Lb$1=!1}function Nb$1(e,i,a,o,c,s,d,$,et){var h=Array.prototype.slice.call(arguments,3);try{i.apply(a,h)}catch(b){this.onError(b)}}var Ob$1=!1,Pb$1=null,Qb$1=!1,Rb$1=null,Sb$1={onError:function(e){Ob$1=!0,Pb$1=e}};function Tb$1(e,i,a,o,c,s,d,$,et){Ob$1=!1,Pb$1=null,Nb$1.apply(Sb$1,arguments)}function Ub$1(e,i,a,o,c,s,d,$,et){if(Tb$1.apply(this,arguments),Ob$1){if(Ob$1){var h=Pb$1;Ob$1=!1,Pb$1=null}else throw Error(p(198));Qb$1||(Qb$1=!0,Rb$1=h)}}function Vb$1(e){var i=e,a=e;if(e.alternate)for(;i.return;)i=i.return;else{e=i;do i=e,i.flags&4098&&(a=i.return),e=i.return;while(e)}return i.tag===3?a:null}function Wb$1(e){if(e.tag===13){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function Xb$1(e){if(Vb$1(e)!==e)throw Error(p(188))}function Yb$1(e){var i=e.alternate;if(!i){if(i=Vb$1(e),i===null)throw Error(p(188));return i!==e?null:e}for(var a=e,o=i;;){var c=a.return;if(c===null)break;var s=c.alternate;if(s===null){if(o=c.return,o!==null){a=o;continue}break}if(c.child===s.child){for(s=c.child;s;){if(s===a)return Xb$1(c),e;if(s===o)return Xb$1(c),i;s=s.sibling}throw Error(p(188))}if(a.return!==o.return)a=c,o=s;else{for(var d=!1,$=c.child;$;){if($===a){d=!0,a=c,o=s;break}if($===o){d=!0,o=c,a=s;break}$=$.sibling}if(!d){for($=s.child;$;){if($===a){d=!0,a=s,o=c;break}if($===o){d=!0,o=s,a=c;break}$=$.sibling}if(!d)throw Error(p(189))}}if(a.alternate!==o)throw Error(p(190))}if(a.tag!==3)throw Error(p(188));return a.stateNode.current===a?e:i}function Zb$1(e){return e=Yb$1(e),e!==null?$b$1(e):null}function $b$1(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var i=$b$1(e);if(i!==null)return i;e=e.sibling}return null}var ac$2=ca$2.unstable_scheduleCallback,bc$2=ca$2.unstable_cancelCallback,cc$2=ca$2.unstable_shouldYield,dc$2=ca$2.unstable_requestPaint,B$1=ca$2.unstable_now,ec$1=ca$2.unstable_getCurrentPriorityLevel,fc$2=ca$2.unstable_ImmediatePriority,gc$2=ca$2.unstable_UserBlockingPriority,hc$1=ca$2.unstable_NormalPriority,ic$2=ca$2.unstable_LowPriority,jc$2=ca$2.unstable_IdlePriority,kc$2=null,lc$2=null;function mc$2(e){if(lc$2&&typeof lc$2.onCommitFiberRoot=="function")try{lc$2.onCommitFiberRoot(kc$2,e,void 0,(e.current.flags&128)===128)}catch{}}var oc$2=Math.clz32?Math.clz32:nc$2,pc$2=Math.log,qc$2=Math.LN2;function nc$2(e){return e>>>=0,e===0?32:31-(pc$2(e)/qc$2|0)|0}var rc$1=64,sc$2=4194304;function tc$1(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uc$2(e,i){var a=e.pendingLanes;if(a===0)return 0;var o=0,c=e.suspendedLanes,s=e.pingedLanes,d=a&268435455;if(d!==0){var $=d&~c;$!==0?o=tc$1($):(s&=d,s!==0&&(o=tc$1(s)))}else d=a&~c,d!==0?o=tc$1(d):s!==0&&(o=tc$1(s));if(o===0)return 0;if(i!==0&&i!==o&&!(i&c)&&(c=o&-o,s=i&-i,c>=s||c===16&&(s&4194240)!==0))return i;if(o&4&&(o|=a&16),i=e.entangledLanes,i!==0)for(e=e.entanglements,i&=o;0<i;)a=31-oc$2(i),c=1<<a,o|=e[a],i&=~c;return o}function vc$2(e,i){switch(e){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc$2(e,i){for(var a=e.suspendedLanes,o=e.pingedLanes,c=e.expirationTimes,s=e.pendingLanes;0<s;){var d=31-oc$2(s),$=1<<d,et=c[d];et===-1?(!($&a)||$&o)&&(c[d]=vc$2($,i)):et<=i&&(e.expiredLanes|=$),s&=~$}}function xc$2(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yc$2(){var e=rc$1;return rc$1<<=1,!(rc$1&4194240)&&(rc$1=64),e}function zc$2(e){for(var i=[],a=0;31>a;a++)i.push(e);return i}function Ac$2(e,i,a){e.pendingLanes|=i,i!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,i=31-oc$2(i),e[i]=a}function Bc$2(e,i){var a=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<a;){var c=31-oc$2(a),s=1<<c;i[c]=0,o[c]=-1,e[c]=-1,a&=~s}}function Cc$2(e,i){var a=e.entangledLanes|=i;for(e=e.entanglements;a;){var o=31-oc$2(a),c=1<<o;c&i|e[o]&i&&(e[o]|=i),a&=~c}}var C=0;function Dc$2(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ec$2,Fc$2,Gc$2,Hc$2,Ic$2,Jc$2=!1,Kc$2=[],Lc$2=null,Mc$2=null,Nc$2=null,Oc$2=new Map,Pc$2=new Map,Qc$2=[],Rc$2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc$2(e,i){switch(e){case"focusin":case"focusout":Lc$2=null;break;case"dragenter":case"dragleave":Mc$2=null;break;case"mouseover":case"mouseout":Nc$2=null;break;case"pointerover":case"pointerout":Oc$2.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc$2.delete(i.pointerId)}}function Tc$2(e,i,a,o,c,s){return e===null||e.nativeEvent!==s?(e={blockedOn:i,domEventName:a,eventSystemFlags:o,nativeEvent:s,targetContainers:[c]},i!==null&&(i=Cb$1(i),i!==null&&Fc$2(i)),e):(e.eventSystemFlags|=o,i=e.targetContainers,c!==null&&i.indexOf(c)===-1&&i.push(c),e)}function Uc$2(e,i,a,o,c){switch(i){case"focusin":return Lc$2=Tc$2(Lc$2,e,i,a,o,c),!0;case"dragenter":return Mc$2=Tc$2(Mc$2,e,i,a,o,c),!0;case"mouseover":return Nc$2=Tc$2(Nc$2,e,i,a,o,c),!0;case"pointerover":var s=c.pointerId;return Oc$2.set(s,Tc$2(Oc$2.get(s)||null,e,i,a,o,c)),!0;case"gotpointercapture":return s=c.pointerId,Pc$2.set(s,Tc$2(Pc$2.get(s)||null,e,i,a,o,c)),!0}return!1}function Vc$2(e){var i=Wc$2(e.target);if(i!==null){var a=Vb$1(i);if(a!==null){if(i=a.tag,i===13){if(i=Wb$1(a),i!==null){e.blockedOn=i,Ic$2(e.priority,function(){Gc$2(a)});return}}else if(i===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xc$2(e){if(e.blockedOn!==null)return!1;for(var i=e.targetContainers;0<i.length;){var a=Yc$2(e.domEventName,e.eventSystemFlags,i[0],e.nativeEvent);if(a===null){a=e.nativeEvent;var o=new a.constructor(a.type,a);wb$1=o,a.target.dispatchEvent(o),wb$1=null}else return i=Cb$1(a),i!==null&&Fc$2(i),e.blockedOn=a,!1;i.shift()}return!0}function Zc$2(e,i,a){Xc$2(e)&&a.delete(i)}function $c$2(){Jc$2=!1,Lc$2!==null&&Xc$2(Lc$2)&&(Lc$2=null),Mc$2!==null&&Xc$2(Mc$2)&&(Mc$2=null),Nc$2!==null&&Xc$2(Nc$2)&&(Nc$2=null),Oc$2.forEach(Zc$2),Pc$2.forEach(Zc$2)}function ad$2(e,i){e.blockedOn===i&&(e.blockedOn=null,Jc$2||(Jc$2=!0,ca$2.unstable_scheduleCallback(ca$2.unstable_NormalPriority,$c$2)))}function bd$1(e){function i(c){return ad$2(c,e)}if(0<Kc$2.length){ad$2(Kc$2[0],e);for(var a=1;a<Kc$2.length;a++){var o=Kc$2[a];o.blockedOn===e&&(o.blockedOn=null)}}for(Lc$2!==null&&ad$2(Lc$2,e),Mc$2!==null&&ad$2(Mc$2,e),Nc$2!==null&&ad$2(Nc$2,e),Oc$2.forEach(i),Pc$2.forEach(i),a=0;a<Qc$2.length;a++)o=Qc$2[a],o.blockedOn===e&&(o.blockedOn=null);for(;0<Qc$2.length&&(a=Qc$2[0],a.blockedOn===null);)Vc$2(a),a.blockedOn===null&&Qc$2.shift()}var cd$2=ua$2.ReactCurrentBatchConfig,dd$2=!0;function ed$2(e,i,a,o){var c=C,s=cd$2.transition;cd$2.transition=null;try{C=1,fd$2(e,i,a,o)}finally{C=c,cd$2.transition=s}}function gd$1(e,i,a,o){var c=C,s=cd$2.transition;cd$2.transition=null;try{C=4,fd$2(e,i,a,o)}finally{C=c,cd$2.transition=s}}function fd$2(e,i,a,o){if(dd$2){var c=Yc$2(e,i,a,o);if(c===null)hd$2(e,i,o,id$3,a),Sc$2(e,o);else if(Uc$2(c,e,i,a,o))o.stopPropagation();else if(Sc$2(e,o),i&4&&-1<Rc$2.indexOf(e)){for(;c!==null;){var s=Cb$1(c);if(s!==null&&Ec$2(s),s=Yc$2(e,i,a,o),s===null&&hd$2(e,i,o,id$3,a),s===c)break;c=s}c!==null&&o.stopPropagation()}else hd$2(e,i,o,null,a)}}var id$3=null;function Yc$2(e,i,a,o){if(id$3=null,e=xb$1(o),e=Wc$2(e),e!==null)if(i=Vb$1(e),i===null)e=null;else if(a=i.tag,a===13){if(e=Wb$1(i),e!==null)return e;e=null}else if(a===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;e=null}else i!==e&&(e=null);return id$3=e,null}function jd$2(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec$1()){case fc$2:return 1;case gc$2:return 4;case hc$1:case ic$2:return 16;case jc$2:return 536870912;default:return 16}default:return 16}}var kd$2=null,ld$2=null,md$2=null;function nd$2(){if(md$2)return md$2;var e,i=ld$2,a=i.length,o,c="value"in kd$2?kd$2.value:kd$2.textContent,s=c.length;for(e=0;e<a&&i[e]===c[e];e++);var d=a-e;for(o=1;o<=d&&i[a-o]===c[s-o];o++);return md$2=c.slice(e,1<o?1-o:void 0)}function od$2(e){var i=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&i===13&&(e=13)):e=i,e===10&&(e=13),32<=e||e===13?e:0}function pd$2(){return!0}function qd$2(){return!1}function rd$2(e){function i(a,o,c,s,d){this._reactName=a,this._targetInst=c,this.type=o,this.nativeEvent=s,this.target=d,this.currentTarget=null;for(var $ in e)e.hasOwnProperty($)&&(a=e[$],this[$]=a?a(s):s[$]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?pd$2:qd$2,this.isPropagationStopped=qd$2,this}return A(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=pd$2)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=pd$2)},persist:function(){},isPersistent:pd$2}),i}var sd$2={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td$2=rd$2(sd$2),ud$2=A({},sd$2,{view:0,detail:0}),vd$2=rd$2(ud$2),wd$1,xd$1,yd$1,Ad$2=A({},ud$2,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd$1,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yd$1&&(yd$1&&e.type==="mousemove"?(wd$1=e.screenX-yd$1.screenX,xd$1=e.screenY-yd$1.screenY):xd$1=wd$1=0,yd$1=e),wd$1)},movementY:function(e){return"movementY"in e?e.movementY:xd$1}}),Bd$1=rd$2(Ad$2),Cd$2=A({},Ad$2,{dataTransfer:0}),Dd$2=rd$2(Cd$2),Ed$2=A({},ud$2,{relatedTarget:0}),Fd$2=rd$2(Ed$2),Gd$1=A({},sd$2,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd$2=rd$2(Gd$1),Id$2=A({},sd$2,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jd$1=rd$2(Id$2),Kd$2=A({},sd$2,{data:0}),Ld$2=rd$2(Kd$2),Md$1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd$1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od$2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd$2(e){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(e):(e=Od$2[e])?!!i[e]:!1}function zd$1(){return Pd$2}var Qd$1=A({},ud$2,{key:function(e){if(e.key){var i=Md$1[e.key]||e.key;if(i!=="Unidentified")return i}return e.type==="keypress"?(e=od$2(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nd$1[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd$1,charCode:function(e){return e.type==="keypress"?od$2(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?od$2(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rd$1=rd$2(Qd$1),Sd$2=A({},Ad$2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td$1=rd$2(Sd$2),Ud$1=A({},ud$2,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd$1}),Vd$1=rd$2(Ud$1),Wd$1=A({},sd$2,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd$2=rd$2(Wd$1),Yd$2=A({},Ad$2,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd$1=rd$2(Yd$2),$d$1=[9,13,27,32],ae$1=ia$2&&"CompositionEvent"in window,be$1=null;ia$2&&"documentMode"in document&&(be$1=document.documentMode);var ce$1=ia$2&&"TextEvent"in window&&!be$1,de=ia$2&&(!ae$1||be$1&&8<be$1&&11>=be$1),ee=String.fromCharCode(32),fe$2=!1;function ge(e,i){switch(e){case"keyup":return $d$1.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ie=!1;function je(e,i){switch(e){case"compositionend":return he(i);case"keypress":return i.which!==32?null:(fe$2=!0,ee);case"textInput":return e=i.data,e===ee&&fe$2?null:e;default:return null}}function ke$1(e,i){if(ie)return e==="compositionend"||!ae$1&&ge(e,i)?(e=nd$2(),md$2=ld$2=kd$2=null,ie=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return de&&i.locale!=="ko"?null:i.data;default:return null}}var le$1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me$1(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i==="input"?!!le$1[e.type]:i==="textarea"}function ne$1(e,i,a,o){Eb$1(o),i=oe$1(i,"onChange"),0<i.length&&(a=new td$2("onChange","change",null,a,o),e.push({event:a,listeners:i}))}var pe=null,qe$1=null;function re(e){se(e,0)}function te(e){var i=ue(e);if(Wa$1(i))return e}function ve$1(e,i){if(e==="change")return i}var we$2=!1;if(ia$2){var xe$1;if(ia$2){var ye$2="oninput"in document;if(!ye$2){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye$2=typeof ze.oninput=="function"}xe$1=ye$2}else xe$1=!1;we$2=xe$1&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe$1=pe=null)}function Be(e){if(e.propertyName==="value"&&te(qe$1)){var i=[];ne$1(i,qe$1,e,xb$1(e)),Jb$1(re,i)}}function Ce(e,i,a){e==="focusin"?(Ae(),pe=i,qe$1=a,pe.attachEvent("onpropertychange",Be)):e==="focusout"&&Ae()}function De$2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return te(qe$1)}function Ee$1(e,i){if(e==="click")return te(i)}function Fe$1(e,i){if(e==="input"||e==="change")return te(i)}function Ge(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(e,i){if(He(e,i))return!0;if(typeof e!="object"||e===null||typeof i!="object"||i===null)return!1;var a=Object.keys(e),o=Object.keys(i);if(a.length!==o.length)return!1;for(o=0;o<a.length;o++){var c=a[o];if(!ja$2.call(i,c)||!He(e[c],i[c]))return!1}return!0}function Je$1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ke(e,i){var a=Je$1(e);e=0;for(var o;a;){if(a.nodeType===3){if(o=e+a.textContent.length,e<=i&&o>=i)return{node:a,offset:i-e};e=o}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Je$1(a)}}function Le(e,i){return e&&i?e===i?!0:e&&e.nodeType===3?!1:i&&i.nodeType===3?Le(e,i.parentNode):"contains"in e?e.contains(i):e.compareDocumentPosition?!!(e.compareDocumentPosition(i)&16):!1:!1}function Me$1(){for(var e=window,i=Xa$2();i instanceof e.HTMLIFrameElement;){try{var a=typeof i.contentWindow.location.href=="string"}catch{a=!1}if(a)e=i.contentWindow;else break;i=Xa$2(e.document)}return i}function Ne$1(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i&&(i==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||i==="textarea"||e.contentEditable==="true")}function Oe(e){var i=Me$1(),a=e.focusedElem,o=e.selectionRange;if(i!==a&&a&&a.ownerDocument&&Le(a.ownerDocument.documentElement,a)){if(o!==null&&Ne$1(a)){if(i=o.start,e=o.end,e===void 0&&(e=i),"selectionStart"in a)a.selectionStart=i,a.selectionEnd=Math.min(e,a.value.length);else if(e=(i=a.ownerDocument||document)&&i.defaultView||window,e.getSelection){e=e.getSelection();var c=a.textContent.length,s=Math.min(o.start,c);o=o.end===void 0?s:Math.min(o.end,c),!e.extend&&s>o&&(c=o,o=s,s=c),c=Ke(a,s);var d=Ke(a,o);c&&d&&(e.rangeCount!==1||e.anchorNode!==c.node||e.anchorOffset!==c.offset||e.focusNode!==d.node||e.focusOffset!==d.offset)&&(i=i.createRange(),i.setStart(c.node,c.offset),e.removeAllRanges(),s>o?(e.addRange(i),e.extend(d.node,d.offset)):(i.setEnd(d.node,d.offset),e.addRange(i)))}}for(i=[],e=a;e=e.parentNode;)e.nodeType===1&&i.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<i.length;a++)e=i[a],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pe$1=ia$2&&"documentMode"in document&&11>=document.documentMode,Qe$1=null,Re=null,Se=null,Te=!1;function Ue$2(e,i,a){var o=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Te||Qe$1==null||Qe$1!==Xa$2(o)||(o=Qe$1,"selectionStart"in o&&Ne$1(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Se&&Ie(Se,o)||(Se=o,o=oe$1(Re,"onSelect"),0<o.length&&(i=new td$2("onSelect","select",null,i,a),e.push({event:i,listeners:o}),i.target=Qe$1)))}function Ve(e,i){var a={};return a[e.toLowerCase()]=i.toLowerCase(),a["Webkit"+e]="webkit"+i,a["Moz"+e]="moz"+i,a}var We$2={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe$1={},Ye={};ia$2&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We$2.animationend.animation,delete We$2.animationiteration.animation,delete We$2.animationstart.animation),"TransitionEvent"in window||delete We$2.transitionend.transition);function Ze$2(e){if(Xe$1[e])return Xe$1[e];if(!We$2[e])return e;var i=We$2[e],a;for(a in i)if(i.hasOwnProperty(a)&&a in Ye)return Xe$1[e]=i[a];return e}var $e$1=Ze$2("animationend"),af$2=Ze$2("animationiteration"),bf$1=Ze$2("animationstart"),cf$1=Ze$2("transitionend"),df$1=new Map,ef$2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff$2(e,i){df$1.set(e,i),fa$2(i,[e])}for(var gf$1=0;gf$1<ef$2.length;gf$1++){var hf$2=ef$2[gf$1],jf$1=hf$2.toLowerCase(),kf$1=hf$2[0].toUpperCase()+hf$2.slice(1);ff$2(jf$1,"on"+kf$1)}ff$2($e$1,"onAnimationEnd");ff$2(af$2,"onAnimationIteration");ff$2(bf$1,"onAnimationStart");ff$2("dblclick","onDoubleClick");ff$2("focusin","onFocus");ff$2("focusout","onBlur");ff$2(cf$1,"onTransitionEnd");ha$1("onMouseEnter",["mouseout","mouseover"]);ha$1("onMouseLeave",["mouseout","mouseover"]);ha$1("onPointerEnter",["pointerout","pointerover"]);ha$1("onPointerLeave",["pointerout","pointerover"]);fa$2("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa$2("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa$2("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa$2("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa$2("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa$2("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf$2="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf$2=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf$2));function nf$2(e,i,a){var o=e.type||"unknown-event";e.currentTarget=a,Ub$1(o,i,void 0,e),e.currentTarget=null}function se(e,i){i=(i&4)!==0;for(var a=0;a<e.length;a++){var o=e[a],c=o.event;o=o.listeners;e:{var s=void 0;if(i)for(var d=o.length-1;0<=d;d--){var $=o[d],et=$.instance,h=$.currentTarget;if($=$.listener,et!==s&&c.isPropagationStopped())break e;nf$2(c,$,h),s=et}else for(d=0;d<o.length;d++){if($=o[d],et=$.instance,h=$.currentTarget,$=$.listener,et!==s&&c.isPropagationStopped())break e;nf$2(c,$,h),s=et}}}if(Qb$1)throw e=Rb$1,Qb$1=!1,Rb$1=null,e}function D(e,i){var a=i[of$2];a===void 0&&(a=i[of$2]=new Set);var o=e+"__bubble";a.has(o)||(pf$2(i,e,2,!1),a.add(o))}function qf$1(e,i,a){var o=0;i&&(o|=4),pf$2(a,e,o,i)}var rf$2="_reactListening"+Math.random().toString(36).slice(2);function sf$2(e){if(!e[rf$2]){e[rf$2]=!0,da$2.forEach(function(a){a!=="selectionchange"&&(mf$2.has(a)||qf$1(a,!1,e),qf$1(a,!0,e))});var i=e.nodeType===9?e:e.ownerDocument;i===null||i[rf$2]||(i[rf$2]=!0,qf$1("selectionchange",!1,i))}}function pf$2(e,i,a,o){switch(jd$2(i)){case 1:var c=ed$2;break;case 4:c=gd$1;break;default:c=fd$2}a=c.bind(null,i,a,e),c=void 0,!Lb$1||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(c=!0),o?c!==void 0?e.addEventListener(i,a,{capture:!0,passive:c}):e.addEventListener(i,a,!0):c!==void 0?e.addEventListener(i,a,{passive:c}):e.addEventListener(i,a,!1)}function hd$2(e,i,a,o,c){var s=o;if(!(i&1)&&!(i&2)&&o!==null)e:for(;;){if(o===null)return;var d=o.tag;if(d===3||d===4){var $=o.stateNode.containerInfo;if($===c||$.nodeType===8&&$.parentNode===c)break;if(d===4)for(d=o.return;d!==null;){var et=d.tag;if((et===3||et===4)&&(et=d.stateNode.containerInfo,et===c||et.nodeType===8&&et.parentNode===c))return;d=d.return}for(;$!==null;){if(d=Wc$2($),d===null)return;if(et=d.tag,et===5||et===6){o=s=d;continue e}$=$.parentNode}}o=o.return}Jb$1(function(){var h=s,b=xb$1(a),g=[];e:{var st=df$1.get(e);if(st!==void 0){var $t=td$2,vt=e;switch(e){case"keypress":if(od$2(a)===0)break e;case"keydown":case"keyup":$t=Rd$1;break;case"focusin":vt="focus",$t=Fd$2;break;case"focusout":vt="blur",$t=Fd$2;break;case"beforeblur":case"afterblur":$t=Fd$2;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":$t=Bd$1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":$t=Dd$2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":$t=Vd$1;break;case $e$1:case af$2:case bf$1:$t=Hd$2;break;case cf$1:$t=Xd$2;break;case"scroll":$t=vd$2;break;case"wheel":$t=Zd$1;break;case"copy":case"cut":case"paste":$t=Jd$1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":$t=Td$1}var Ft=(i&4)!==0,Gt=!Ft&&e==="scroll",qt=Ft?st!==null?st+"Capture":null:st;Ft=[];for(var Lt=h,rr;Lt!==null;){rr=Lt;var jr=rr.stateNode;if(rr.tag===5&&jr!==null&&(rr=jr,qt!==null&&(jr=Kb$1(Lt,qt),jr!=null&&Ft.push(tf$2(Lt,jr,rr)))),Gt)break;Lt=Lt.return}0<Ft.length&&(st=new $t(st,vt,null,a,b),g.push({event:st,listeners:Ft}))}}if(!(i&7)){e:{if(st=e==="mouseover"||e==="pointerover",$t=e==="mouseout"||e==="pointerout",st&&a!==wb$1&&(vt=a.relatedTarget||a.fromElement)&&(Wc$2(vt)||vt[uf$2]))break e;if(($t||st)&&(st=b.window===b?b:(st=b.ownerDocument)?st.defaultView||st.parentWindow:window,$t?(vt=a.relatedTarget||a.toElement,$t=h,vt=vt?Wc$2(vt):null,vt!==null&&(Gt=Vb$1(vt),vt!==Gt||vt.tag!==5&&vt.tag!==6)&&(vt=null)):($t=null,vt=h),$t!==vt)){if(Ft=Bd$1,jr="onMouseLeave",qt="onMouseEnter",Lt="mouse",(e==="pointerout"||e==="pointerover")&&(Ft=Td$1,jr="onPointerLeave",qt="onPointerEnter",Lt="pointer"),Gt=$t==null?st:ue($t),rr=vt==null?st:ue(vt),st=new Ft(jr,Lt+"leave",$t,a,b),st.target=Gt,st.relatedTarget=rr,jr=null,Wc$2(b)===h&&(Ft=new Ft(qt,Lt+"enter",vt,a,b),Ft.target=rr,Ft.relatedTarget=Gt,jr=Ft),Gt=jr,$t&&vt)t:{for(Ft=$t,qt=vt,Lt=0,rr=Ft;rr;rr=vf$1(rr))Lt++;for(rr=0,jr=qt;jr;jr=vf$1(jr))rr++;for(;0<Lt-rr;)Ft=vf$1(Ft),Lt--;for(;0<rr-Lt;)qt=vf$1(qt),rr--;for(;Lt--;){if(Ft===qt||qt!==null&&Ft===qt.alternate)break t;Ft=vf$1(Ft),qt=vf$1(qt)}Ft=null}else Ft=null;$t!==null&&wf$1(g,st,$t,Ft,!1),vt!==null&&Gt!==null&&wf$1(g,Gt,vt,Ft,!0)}}e:{if(st=h?ue(h):window,$t=st.nodeName&&st.nodeName.toLowerCase(),$t==="select"||$t==="input"&&st.type==="file")var Hr=ve$1;else if(me$1(st))if(we$2)Hr=Fe$1;else{Hr=De$2;var wn=Ce}else($t=st.nodeName)&&$t.toLowerCase()==="input"&&(st.type==="checkbox"||st.type==="radio")&&(Hr=Ee$1);if(Hr&&(Hr=Hr(e,h))){ne$1(g,Hr,a,b);break e}wn&&wn(e,st,h),e==="focusout"&&(wn=st._wrapperState)&&wn.controlled&&st.type==="number"&&cb$1(st,"number",st.value)}switch(wn=h?ue(h):window,e){case"focusin":(me$1(wn)||wn.contentEditable==="true")&&(Qe$1=wn,Re=h,Se=null);break;case"focusout":Se=Re=Qe$1=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue$2(g,a,b);break;case"selectionchange":if(Pe$1)break;case"keydown":case"keyup":Ue$2(g,a,b)}var _n;if(ae$1)e:{switch(e){case"compositionstart":var No="onCompositionStart";break e;case"compositionend":No="onCompositionEnd";break e;case"compositionupdate":No="onCompositionUpdate";break e}No=void 0}else ie?ge(e,a)&&(No="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(No="onCompositionStart");No&&(de&&a.locale!=="ko"&&(ie||No!=="onCompositionStart"?No==="onCompositionEnd"&&ie&&(_n=nd$2()):(kd$2=b,ld$2="value"in kd$2?kd$2.value:kd$2.textContent,ie=!0)),wn=oe$1(h,No),0<wn.length&&(No=new Ld$2(No,e,null,a,b),g.push({event:No,listeners:wn}),_n?No.data=_n:(_n=he(a),_n!==null&&(No.data=_n)))),(_n=ce$1?je(e,a):ke$1(e,a))&&(h=oe$1(h,"onBeforeInput"),0<h.length&&(b=new Ld$2("onBeforeInput","beforeinput",null,a,b),g.push({event:b,listeners:h}),b.data=_n))}se(g,i)})}function tf$2(e,i,a){return{instance:e,listener:i,currentTarget:a}}function oe$1(e,i){for(var a=i+"Capture",o=[];e!==null;){var c=e,s=c.stateNode;c.tag===5&&s!==null&&(c=s,s=Kb$1(e,a),s!=null&&o.unshift(tf$2(e,s,c)),s=Kb$1(e,i),s!=null&&o.push(tf$2(e,s,c))),e=e.return}return o}function vf$1(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wf$1(e,i,a,o,c){for(var s=i._reactName,d=[];a!==null&&a!==o;){var $=a,et=$.alternate,h=$.stateNode;if(et!==null&&et===o)break;$.tag===5&&h!==null&&($=h,c?(et=Kb$1(a,s),et!=null&&d.unshift(tf$2(a,et,$))):c||(et=Kb$1(a,s),et!=null&&d.push(tf$2(a,et,$)))),a=a.return}d.length!==0&&e.push({event:i,listeners:d})}var xf$1=/\r\n?/g,yf$1=/\u0000|\uFFFD/g;function zf$1(e){return(typeof e=="string"?e:""+e).replace(xf$1,`
`).replace(yf$1,"")}function Af$1(e,i,a){if(i=zf$1(i),zf$1(e)!==i&&a)throw Error(p(425))}function Bf$1(){}var Cf$1=null,Df$1=null;function Ef$1(e,i){return e==="textarea"||e==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Ff$1=typeof setTimeout=="function"?setTimeout:void 0,Gf$1=typeof clearTimeout=="function"?clearTimeout:void 0,Hf$1=typeof Promise=="function"?Promise:void 0,Jf$1=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf$1<"u"?function(e){return Hf$1.resolve(null).then(e).catch(If$1)}:Ff$1;function If$1(e){setTimeout(function(){throw e})}function Kf$1(e,i){var a=i,o=0;do{var c=a.nextSibling;if(e.removeChild(a),c&&c.nodeType===8)if(a=c.data,a==="/$"){if(o===0){e.removeChild(c),bd$1(i);return}o--}else a!=="$"&&a!=="$?"&&a!=="$!"||o++;a=c}while(a);bd$1(i)}function Lf$1(e){for(;e!=null;e=e.nextSibling){var i=e.nodeType;if(i===1||i===3)break;if(i===8){if(i=e.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return e}function Mf$1(e){e=e.previousSibling;for(var i=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(i===0)return e;i--}else a==="/$"&&i++}e=e.previousSibling}return null}var Nf$1=Math.random().toString(36).slice(2),Of$1="__reactFiber$"+Nf$1,Pf$1="__reactProps$"+Nf$1,uf$2="__reactContainer$"+Nf$1,of$2="__reactEvents$"+Nf$1,Qf$1="__reactListeners$"+Nf$1,Rf$1="__reactHandles$"+Nf$1;function Wc$2(e){var i=e[Of$1];if(i)return i;for(var a=e.parentNode;a;){if(i=a[uf$2]||a[Of$1]){if(a=i.alternate,i.child!==null||a!==null&&a.child!==null)for(e=Mf$1(e);e!==null;){if(a=e[Of$1])return a;e=Mf$1(e)}return i}e=a,a=e.parentNode}return null}function Cb$1(e){return e=e[Of$1]||e[uf$2],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ue(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(p(33))}function Db$1(e){return e[Pf$1]||null}var Sf$1=[],Tf$1=-1;function Uf$1(e){return{current:e}}function E(e){0>Tf$1||(e.current=Sf$1[Tf$1],Sf$1[Tf$1]=null,Tf$1--)}function G(e,i){Tf$1++,Sf$1[Tf$1]=e.current,e.current=i}var Vf$1={},H$1=Uf$1(Vf$1),Wf$1=Uf$1(!1),Xf$1=Vf$1;function Yf$1(e,i){var a=e.type.contextTypes;if(!a)return Vf$1;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===i)return o.__reactInternalMemoizedMaskedChildContext;var c={},s;for(s in a)c[s]=i[s];return o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=c),c}function Zf$1(e){return e=e.childContextTypes,e!=null}function $f$1(){E(Wf$1),E(H$1)}function ag(e,i,a){if(H$1.current!==Vf$1)throw Error(p(168));G(H$1,i),G(Wf$1,a)}function bg$1(e,i,a){var o=e.stateNode;if(i=i.childContextTypes,typeof o.getChildContext!="function")return a;o=o.getChildContext();for(var c in o)if(!(c in i))throw Error(p(108,Ra(e)||"Unknown",c));return A({},a,o)}function cg$1(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vf$1,Xf$1=H$1.current,G(H$1,e),G(Wf$1,Wf$1.current),!0}function dg$1(e,i,a){var o=e.stateNode;if(!o)throw Error(p(169));a?(e=bg$1(e,i,Xf$1),o.__reactInternalMemoizedMergedChildContext=e,E(Wf$1),E(H$1),G(H$1,e)):E(Wf$1),G(Wf$1,a)}var eg=null,fg$1=!1,gg=!1;function hg$1(e){eg===null?eg=[e]:eg.push(e)}function ig$1(e){fg$1=!0,hg$1(e)}function jg(){if(!gg&&eg!==null){gg=!0;var e=0,i=C;try{var a=eg;for(C=1;e<a.length;e++){var o=a[e];do o=o(!0);while(o!==null)}eg=null,fg$1=!1}catch(c){throw eg!==null&&(eg=eg.slice(e+1)),ac$2(fc$2,jg),c}finally{C=i,gg=!1}}return null}var kg=[],lg$1=0,mg$1=null,ng$1=0,og$1=[],pg$1=0,qg=null,rg$1=1,sg$1="";function tg$1(e,i){kg[lg$1++]=ng$1,kg[lg$1++]=mg$1,mg$1=e,ng$1=i}function ug$1(e,i,a){og$1[pg$1++]=rg$1,og$1[pg$1++]=sg$1,og$1[pg$1++]=qg,qg=e;var o=rg$1;e=sg$1;var c=32-oc$2(o)-1;o&=~(1<<c),a+=1;var s=32-oc$2(i)+c;if(30<s){var d=c-c%5;s=(o&(1<<d)-1).toString(32),o>>=d,c-=d,rg$1=1<<32-oc$2(i)+c|a<<c|o,sg$1=s+e}else rg$1=1<<s|a<<c|o,sg$1=e}function vg$1(e){e.return!==null&&(tg$1(e,1),ug$1(e,1,0))}function wg$1(e){for(;e===mg$1;)mg$1=kg[--lg$1],kg[lg$1]=null,ng$1=kg[--lg$1],kg[lg$1]=null;for(;e===qg;)qg=og$1[--pg$1],og$1[pg$1]=null,sg$1=og$1[--pg$1],og$1[pg$1]=null,rg$1=og$1[--pg$1],og$1[pg$1]=null}var xg$1=null,yg=null,I=!1,zg=null;function Ag(e,i){var a=Bg(5,null,null,0);a.elementType="DELETED",a.stateNode=i,a.return=e,i=e.deletions,i===null?(e.deletions=[a],e.flags|=16):i.push(a)}function Cg(e,i){switch(e.tag){case 5:var a=e.type;return i=i.nodeType!==1||a.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(e.stateNode=i,xg$1=e,yg=Lf$1(i.firstChild),!0):!1;case 6:return i=e.pendingProps===""||i.nodeType!==3?null:i,i!==null?(e.stateNode=i,xg$1=e,yg=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(a=qg!==null?{id:rg$1,overflow:sg$1}:null,e.memoizedState={dehydrated:i,treeContext:a,retryLane:1073741824},a=Bg(18,null,null,0),a.stateNode=i,a.return=e,e.child=a,xg$1=e,yg=null,!0):!1;default:return!1}}function Dg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eg(e){if(I){var i=yg;if(i){var a=i;if(!Cg(e,i)){if(Dg(e))throw Error(p(418));i=Lf$1(a.nextSibling);var o=xg$1;i&&Cg(e,i)?Ag(o,a):(e.flags=e.flags&-4097|2,I=!1,xg$1=e)}}else{if(Dg(e))throw Error(p(418));e.flags=e.flags&-4097|2,I=!1,xg$1=e}}}function Fg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xg$1=e}function Gg(e){if(e!==xg$1)return!1;if(!I)return Fg(e),I=!0,!1;var i;if((i=e.tag!==3)&&!(i=e.tag!==5)&&(i=e.type,i=i!=="head"&&i!=="body"&&!Ef$1(e.type,e.memoizedProps)),i&&(i=yg)){if(Dg(e))throw Hg(),Error(p(418));for(;i;)Ag(e,i),i=Lf$1(i.nextSibling)}if(Fg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(p(317));e:{for(e=e.nextSibling,i=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"){if(i===0){yg=Lf$1(e.nextSibling);break e}i--}else a!=="$"&&a!=="$!"&&a!=="$?"||i++}e=e.nextSibling}yg=null}}else yg=xg$1?Lf$1(e.stateNode.nextSibling):null;return!0}function Hg(){for(var e=yg;e;)e=Lf$1(e.nextSibling)}function Ig(){yg=xg$1=null,I=!1}function Jg(e){zg===null?zg=[e]:zg.push(e)}var Kg=ua$2.ReactCurrentBatchConfig;function Lg(e,i){if(e&&e.defaultProps){i=A({},i),e=e.defaultProps;for(var a in e)i[a]===void 0&&(i[a]=e[a]);return i}return i}var Mg=Uf$1(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(e){var i=Mg.current;E(Mg),e._currentValue=i}function Sg(e,i,a){for(;e!==null;){var o=e.alternate;if((e.childLanes&i)!==i?(e.childLanes|=i,o!==null&&(o.childLanes|=i)):o!==null&&(o.childLanes&i)!==i&&(o.childLanes|=i),e===a)break;e=e.return}}function Tg$1(e,i){Ng=e,Pg=Og=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&i&&(Ug=!0),e.firstContext=null)}function Vg(e){var i=e._currentValue;if(Pg!==e)if(e={context:e,memoizedValue:i,next:null},Og===null){if(Ng===null)throw Error(p(308));Og=e,Ng.dependencies={lanes:0,firstContext:e}}else Og=Og.next=e;return i}var Wg=null;function Xg(e){Wg===null?Wg=[e]:Wg.push(e)}function Yg(e,i,a,o){var c=i.interleaved;return c===null?(a.next=a,Xg(i)):(a.next=c.next,c.next=a),i.interleaved=a,Zg(e,o)}function Zg(e,i){e.lanes|=i;var a=e.alternate;for(a!==null&&(a.lanes|=i),a=e,e=e.return;e!==null;)e.childLanes|=i,a=e.alternate,a!==null&&(a.childLanes|=i),a=e,e=e.return;return a.tag===3?a.stateNode:null}var $g=!1;function ah(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh$1(e,i){e=e.updateQueue,i.updateQueue===e&&(i.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ch$1(e,i){return{eventTime:e,lane:i,tag:0,payload:null,callback:null,next:null}}function dh$1(e,i,a){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,K$1&2){var c=o.pending;return c===null?i.next=i:(i.next=c.next,c.next=i),o.pending=i,Zg(e,a)}return c=o.interleaved,c===null?(i.next=i,Xg(o)):(i.next=c.next,c.next=i),o.interleaved=i,Zg(e,a)}function eh$1(e,i,a){if(i=i.updateQueue,i!==null&&(i=i.shared,(a&4194240)!==0)){var o=i.lanes;o&=e.pendingLanes,a|=o,i.lanes=a,Cc$2(e,a)}}function fh(e,i){var a=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,a===o)){var c=null,s=null;if(a=a.firstBaseUpdate,a!==null){do{var d={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};s===null?c=s=d:s=s.next=d,a=a.next}while(a!==null);s===null?c=s=i:s=s.next=i}else c=s=i;a={baseState:o.baseState,firstBaseUpdate:c,lastBaseUpdate:s,shared:o.shared,effects:o.effects},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=i:e.next=i,a.lastBaseUpdate=i}function gh$1(e,i,a,o){var c=e.updateQueue;$g=!1;var s=c.firstBaseUpdate,d=c.lastBaseUpdate,$=c.shared.pending;if($!==null){c.shared.pending=null;var et=$,h=et.next;et.next=null,d===null?s=h:d.next=h,d=et;var b=e.alternate;b!==null&&(b=b.updateQueue,$=b.lastBaseUpdate,$!==d&&($===null?b.firstBaseUpdate=h:$.next=h,b.lastBaseUpdate=et))}if(s!==null){var g=c.baseState;d=0,b=h=et=null,$=s;do{var st=$.lane,$t=$.eventTime;if((o&st)===st){b!==null&&(b=b.next={eventTime:$t,lane:0,tag:$.tag,payload:$.payload,callback:$.callback,next:null});e:{var vt=e,Ft=$;switch(st=i,$t=a,Ft.tag){case 1:if(vt=Ft.payload,typeof vt=="function"){g=vt.call($t,g,st);break e}g=vt;break e;case 3:vt.flags=vt.flags&-65537|128;case 0:if(vt=Ft.payload,st=typeof vt=="function"?vt.call($t,g,st):vt,st==null)break e;g=A({},g,st);break e;case 2:$g=!0}}$.callback!==null&&$.lane!==0&&(e.flags|=64,st=c.effects,st===null?c.effects=[$]:st.push($))}else $t={eventTime:$t,lane:st,tag:$.tag,payload:$.payload,callback:$.callback,next:null},b===null?(h=b=$t,et=g):b=b.next=$t,d|=st;if($=$.next,$===null){if($=c.shared.pending,$===null)break;st=$,$=st.next,st.next=null,c.lastBaseUpdate=st,c.shared.pending=null}}while(1);if(b===null&&(et=g),c.baseState=et,c.firstBaseUpdate=h,c.lastBaseUpdate=b,i=c.shared.interleaved,i!==null){c=i;do d|=c.lane,c=c.next;while(c!==i)}else s===null&&(c.shared.lanes=0);hh$1|=d,e.lanes=d,e.memoizedState=g}}function ih$1(e,i,a){if(e=i.effects,i.effects=null,e!==null)for(i=0;i<e.length;i++){var o=e[i],c=o.callback;if(c!==null){if(o.callback=null,o=a,typeof c!="function")throw Error(p(191,c));c.call(o)}}}var jh$1=new aa$2.Component().refs;function kh$1(e,i,a,o){i=e.memoizedState,a=a(o,i),a=a==null?i:A({},i,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var nh$1={isMounted:function(e){return(e=e._reactInternals)?Vb$1(e)===e:!1},enqueueSetState:function(e,i,a){e=e._reactInternals;var o=L$1(),c=lh$1(e),s=ch$1(o,c);s.payload=i,a!=null&&(s.callback=a),i=dh$1(e,s,c),i!==null&&(mh$1(i,e,c,o),eh$1(i,e,c))},enqueueReplaceState:function(e,i,a){e=e._reactInternals;var o=L$1(),c=lh$1(e),s=ch$1(o,c);s.tag=1,s.payload=i,a!=null&&(s.callback=a),i=dh$1(e,s,c),i!==null&&(mh$1(i,e,c,o),eh$1(i,e,c))},enqueueForceUpdate:function(e,i){e=e._reactInternals;var a=L$1(),o=lh$1(e),c=ch$1(a,o);c.tag=2,i!=null&&(c.callback=i),i=dh$1(e,c,o),i!==null&&(mh$1(i,e,o,a),eh$1(i,e,o))}};function oh$1(e,i,a,o,c,s,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,s,d):i.prototype&&i.prototype.isPureReactComponent?!Ie(a,o)||!Ie(c,s):!0}function ph$1(e,i,a){var o=!1,c=Vf$1,s=i.contextType;return typeof s=="object"&&s!==null?s=Vg(s):(c=Zf$1(i)?Xf$1:H$1.current,o=i.contextTypes,s=(o=o!=null)?Yf$1(e,c):Vf$1),i=new i(a,s),e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=nh$1,e.stateNode=i,i._reactInternals=e,o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=c,e.__reactInternalMemoizedMaskedChildContext=s),i}function qh$1(e,i,a,o){e=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(a,o),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(a,o),i.state!==e&&nh$1.enqueueReplaceState(i,i.state,null)}function rh$1(e,i,a,o){var c=e.stateNode;c.props=a,c.state=e.memoizedState,c.refs=jh$1,ah(e);var s=i.contextType;typeof s=="object"&&s!==null?c.context=Vg(s):(s=Zf$1(i)?Xf$1:H$1.current,c.context=Yf$1(e,s)),c.state=e.memoizedState,s=i.getDerivedStateFromProps,typeof s=="function"&&(kh$1(e,i,s,a),c.state=e.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(i=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),i!==c.state&&nh$1.enqueueReplaceState(c,c.state,null),gh$1(e,a,c,o),c.state=e.memoizedState),typeof c.componentDidMount=="function"&&(e.flags|=4194308)}function sh$1(e,i,a){if(e=a.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(p(309));var o=a.stateNode}if(!o)throw Error(p(147,e));var c=o,s=""+e;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===s?i.ref:(i=function(d){var $=c.refs;$===jh$1&&($=c.refs={}),d===null?delete $[s]:$[s]=d},i._stringRef=s,i)}if(typeof e!="string")throw Error(p(284));if(!a._owner)throw Error(p(290,e))}return e}function th$1(e,i){throw e=Object.prototype.toString.call(i),Error(p(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e))}function uh$1(e){var i=e._init;return i(e._payload)}function vh$1(e){function i(qt,Lt){if(e){var rr=qt.deletions;rr===null?(qt.deletions=[Lt],qt.flags|=16):rr.push(Lt)}}function a(qt,Lt){if(!e)return null;for(;Lt!==null;)i(qt,Lt),Lt=Lt.sibling;return null}function o(qt,Lt){for(qt=new Map;Lt!==null;)Lt.key!==null?qt.set(Lt.key,Lt):qt.set(Lt.index,Lt),Lt=Lt.sibling;return qt}function c(qt,Lt){return qt=wh$1(qt,Lt),qt.index=0,qt.sibling=null,qt}function s(qt,Lt,rr){return qt.index=rr,e?(rr=qt.alternate,rr!==null?(rr=rr.index,rr<Lt?(qt.flags|=2,Lt):rr):(qt.flags|=2,Lt)):(qt.flags|=1048576,Lt)}function d(qt){return e&&qt.alternate===null&&(qt.flags|=2),qt}function $(qt,Lt,rr,jr){return Lt===null||Lt.tag!==6?(Lt=xh$1(rr,qt.mode,jr),Lt.return=qt,Lt):(Lt=c(Lt,rr),Lt.return=qt,Lt)}function et(qt,Lt,rr,jr){var Hr=rr.type;return Hr===ya$1?b(qt,Lt,rr.props.children,jr,rr.key):Lt!==null&&(Lt.elementType===Hr||typeof Hr=="object"&&Hr!==null&&Hr.$$typeof===Ha$2&&uh$1(Hr)===Lt.type)?(jr=c(Lt,rr.props),jr.ref=sh$1(qt,Lt,rr),jr.return=qt,jr):(jr=yh$1(rr.type,rr.key,rr.props,null,qt.mode,jr),jr.ref=sh$1(qt,Lt,rr),jr.return=qt,jr)}function h(qt,Lt,rr,jr){return Lt===null||Lt.tag!==4||Lt.stateNode.containerInfo!==rr.containerInfo||Lt.stateNode.implementation!==rr.implementation?(Lt=zh$1(rr,qt.mode,jr),Lt.return=qt,Lt):(Lt=c(Lt,rr.children||[]),Lt.return=qt,Lt)}function b(qt,Lt,rr,jr,Hr){return Lt===null||Lt.tag!==7?(Lt=Ah$1(rr,qt.mode,jr,Hr),Lt.return=qt,Lt):(Lt=c(Lt,rr),Lt.return=qt,Lt)}function g(qt,Lt,rr){if(typeof Lt=="string"&&Lt!==""||typeof Lt=="number")return Lt=xh$1(""+Lt,qt.mode,rr),Lt.return=qt,Lt;if(typeof Lt=="object"&&Lt!==null){switch(Lt.$$typeof){case va$1:return rr=yh$1(Lt.type,Lt.key,Lt.props,null,qt.mode,rr),rr.ref=sh$1(qt,null,Lt),rr.return=qt,rr;case wa$1:return Lt=zh$1(Lt,qt.mode,rr),Lt.return=qt,Lt;case Ha$2:var jr=Lt._init;return g(qt,jr(Lt._payload),rr)}if(eb$1(Lt)||Ka$2(Lt))return Lt=Ah$1(Lt,qt.mode,rr,null),Lt.return=qt,Lt;th$1(qt,Lt)}return null}function st(qt,Lt,rr,jr){var Hr=Lt!==null?Lt.key:null;if(typeof rr=="string"&&rr!==""||typeof rr=="number")return Hr!==null?null:$(qt,Lt,""+rr,jr);if(typeof rr=="object"&&rr!==null){switch(rr.$$typeof){case va$1:return rr.key===Hr?et(qt,Lt,rr,jr):null;case wa$1:return rr.key===Hr?h(qt,Lt,rr,jr):null;case Ha$2:return Hr=rr._init,st(qt,Lt,Hr(rr._payload),jr)}if(eb$1(rr)||Ka$2(rr))return Hr!==null?null:b(qt,Lt,rr,jr,null);th$1(qt,rr)}return null}function $t(qt,Lt,rr,jr,Hr){if(typeof jr=="string"&&jr!==""||typeof jr=="number")return qt=qt.get(rr)||null,$(Lt,qt,""+jr,Hr);if(typeof jr=="object"&&jr!==null){switch(jr.$$typeof){case va$1:return qt=qt.get(jr.key===null?rr:jr.key)||null,et(Lt,qt,jr,Hr);case wa$1:return qt=qt.get(jr.key===null?rr:jr.key)||null,h(Lt,qt,jr,Hr);case Ha$2:var wn=jr._init;return $t(qt,Lt,rr,wn(jr._payload),Hr)}if(eb$1(jr)||Ka$2(jr))return qt=qt.get(rr)||null,b(Lt,qt,jr,Hr,null);th$1(Lt,jr)}return null}function vt(qt,Lt,rr,jr){for(var Hr=null,wn=null,_n=Lt,No=Lt=0,Qo=null;_n!==null&&No<rr.length;No++){_n.index>No?(Qo=_n,_n=null):Qo=_n.sibling;var Xo=st(qt,_n,rr[No],jr);if(Xo===null){_n===null&&(_n=Qo);break}e&&_n&&Xo.alternate===null&&i(qt,_n),Lt=s(Xo,Lt,No),wn===null?Hr=Xo:wn.sibling=Xo,wn=Xo,_n=Qo}if(No===rr.length)return a(qt,_n),I&&tg$1(qt,No),Hr;if(_n===null){for(;No<rr.length;No++)_n=g(qt,rr[No],jr),_n!==null&&(Lt=s(_n,Lt,No),wn===null?Hr=_n:wn.sibling=_n,wn=_n);return I&&tg$1(qt,No),Hr}for(_n=o(qt,_n);No<rr.length;No++)Qo=$t(_n,qt,No,rr[No],jr),Qo!==null&&(e&&Qo.alternate!==null&&_n.delete(Qo.key===null?No:Qo.key),Lt=s(Qo,Lt,No),wn===null?Hr=Qo:wn.sibling=Qo,wn=Qo);return e&&_n.forEach(function(l0){return i(qt,l0)}),I&&tg$1(qt,No),Hr}function Ft(qt,Lt,rr,jr){var Hr=Ka$2(rr);if(typeof Hr!="function")throw Error(p(150));if(rr=Hr.call(rr),rr==null)throw Error(p(151));for(var wn=Hr=null,_n=Lt,No=Lt=0,Qo=null,Xo=rr.next();_n!==null&&!Xo.done;No++,Xo=rr.next()){_n.index>No?(Qo=_n,_n=null):Qo=_n.sibling;var l0=st(qt,_n,Xo.value,jr);if(l0===null){_n===null&&(_n=Qo);break}e&&_n&&l0.alternate===null&&i(qt,_n),Lt=s(l0,Lt,No),wn===null?Hr=l0:wn.sibling=l0,wn=l0,_n=Qo}if(Xo.done)return a(qt,_n),I&&tg$1(qt,No),Hr;if(_n===null){for(;!Xo.done;No++,Xo=rr.next())Xo=g(qt,Xo.value,jr),Xo!==null&&(Lt=s(Xo,Lt,No),wn===null?Hr=Xo:wn.sibling=Xo,wn=Xo);return I&&tg$1(qt,No),Hr}for(_n=o(qt,_n);!Xo.done;No++,Xo=rr.next())Xo=$t(_n,qt,No,Xo.value,jr),Xo!==null&&(e&&Xo.alternate!==null&&_n.delete(Xo.key===null?No:Xo.key),Lt=s(Xo,Lt,No),wn===null?Hr=Xo:wn.sibling=Xo,wn=Xo);return e&&_n.forEach(function(v0){return i(qt,v0)}),I&&tg$1(qt,No),Hr}function Gt(qt,Lt,rr,jr){if(typeof rr=="object"&&rr!==null&&rr.type===ya$1&&rr.key===null&&(rr=rr.props.children),typeof rr=="object"&&rr!==null){switch(rr.$$typeof){case va$1:e:{for(var Hr=rr.key,wn=Lt;wn!==null;){if(wn.key===Hr){if(Hr=rr.type,Hr===ya$1){if(wn.tag===7){a(qt,wn.sibling),Lt=c(wn,rr.props.children),Lt.return=qt,qt=Lt;break e}}else if(wn.elementType===Hr||typeof Hr=="object"&&Hr!==null&&Hr.$$typeof===Ha$2&&uh$1(Hr)===wn.type){a(qt,wn.sibling),Lt=c(wn,rr.props),Lt.ref=sh$1(qt,wn,rr),Lt.return=qt,qt=Lt;break e}a(qt,wn);break}else i(qt,wn);wn=wn.sibling}rr.type===ya$1?(Lt=Ah$1(rr.props.children,qt.mode,jr,rr.key),Lt.return=qt,qt=Lt):(jr=yh$1(rr.type,rr.key,rr.props,null,qt.mode,jr),jr.ref=sh$1(qt,Lt,rr),jr.return=qt,qt=jr)}return d(qt);case wa$1:e:{for(wn=rr.key;Lt!==null;){if(Lt.key===wn)if(Lt.tag===4&&Lt.stateNode.containerInfo===rr.containerInfo&&Lt.stateNode.implementation===rr.implementation){a(qt,Lt.sibling),Lt=c(Lt,rr.children||[]),Lt.return=qt,qt=Lt;break e}else{a(qt,Lt);break}else i(qt,Lt);Lt=Lt.sibling}Lt=zh$1(rr,qt.mode,jr),Lt.return=qt,qt=Lt}return d(qt);case Ha$2:return wn=rr._init,Gt(qt,Lt,wn(rr._payload),jr)}if(eb$1(rr))return vt(qt,Lt,rr,jr);if(Ka$2(rr))return Ft(qt,Lt,rr,jr);th$1(qt,rr)}return typeof rr=="string"&&rr!==""||typeof rr=="number"?(rr=""+rr,Lt!==null&&Lt.tag===6?(a(qt,Lt.sibling),Lt=c(Lt,rr),Lt.return=qt,qt=Lt):(a(qt,Lt),Lt=xh$1(rr,qt.mode,jr),Lt.return=qt,qt=Lt),d(qt)):a(qt,Lt)}return Gt}var Bh$1=vh$1(!0),Ch$1=vh$1(!1),Dh$1={},Eh$1=Uf$1(Dh$1),Fh$1=Uf$1(Dh$1),Gh$1=Uf$1(Dh$1);function Hh$1(e){if(e===Dh$1)throw Error(p(174));return e}function Ih(e,i){switch(G(Gh$1,i),G(Fh$1,e),G(Eh$1,Dh$1),e=i.nodeType,e){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:lb$1(null,"");break;default:e=e===8?i.parentNode:i,i=e.namespaceURI||null,e=e.tagName,i=lb$1(i,e)}E(Eh$1),G(Eh$1,i)}function Jh$1(){E(Eh$1),E(Fh$1),E(Gh$1)}function Kh$1(e){Hh$1(Gh$1.current);var i=Hh$1(Eh$1.current),a=lb$1(i,e.type);i!==a&&(G(Fh$1,e),G(Eh$1,a))}function Lh$1(e){Fh$1.current===e&&(E(Eh$1),E(Fh$1))}var M$1=Uf$1(0);function Mh$1(e){for(var i=e;i!==null;){if(i.tag===13){var a=i.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Nh$1=[];function Oh$1(){for(var e=0;e<Nh$1.length;e++)Nh$1[e]._workInProgressVersionPrimary=null;Nh$1.length=0}var Ph$1=ua$2.ReactCurrentDispatcher,Qh$1=ua$2.ReactCurrentBatchConfig,Rh$1=0,N=null,O=null,P=null,Sh$1=!1,Th$1=!1,Uh$1=0,Vh$1=0;function Q$1(){throw Error(p(321))}function Wh$1(e,i){if(i===null)return!1;for(var a=0;a<i.length&&a<e.length;a++)if(!He(e[a],i[a]))return!1;return!0}function Xh$1(e,i,a,o,c,s){if(Rh$1=s,N=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Ph$1.current=e===null||e.memoizedState===null?Yh$1:Zh$1,e=a(o,c),Th$1){s=0;do{if(Th$1=!1,Uh$1=0,25<=s)throw Error(p(301));s+=1,P=O=null,i.updateQueue=null,Ph$1.current=$h$1,e=a(o,c)}while(Th$1)}if(Ph$1.current=ai$1,i=O!==null&&O.next!==null,Rh$1=0,P=O=N=null,Sh$1=!1,i)throw Error(p(300));return e}function bi$1(){var e=Uh$1!==0;return Uh$1=0,e}function ci$1(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P===null?N.memoizedState=P=e:P=P.next=e,P}function di$2(){if(O===null){var e=N.alternate;e=e!==null?e.memoizedState:null}else e=O.next;var i=P===null?N.memoizedState:P.next;if(i!==null)P=i,O=e;else{if(e===null)throw Error(p(310));O=e,e={memoizedState:O.memoizedState,baseState:O.baseState,baseQueue:O.baseQueue,queue:O.queue,next:null},P===null?N.memoizedState=P=e:P=P.next=e}return P}function ei$1(e,i){return typeof i=="function"?i(e):i}function fi$2(e){var i=di$2(),a=i.queue;if(a===null)throw Error(p(311));a.lastRenderedReducer=e;var o=O,c=o.baseQueue,s=a.pending;if(s!==null){if(c!==null){var d=c.next;c.next=s.next,s.next=d}o.baseQueue=c=s,a.pending=null}if(c!==null){s=c.next,o=o.baseState;var $=d=null,et=null,h=s;do{var b=h.lane;if((Rh$1&b)===b)et!==null&&(et=et.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),o=h.hasEagerState?h.eagerState:e(o,h.action);else{var g={lane:b,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};et===null?($=et=g,d=o):et=et.next=g,N.lanes|=b,hh$1|=b}h=h.next}while(h!==null&&h!==s);et===null?d=o:et.next=$,He(o,i.memoizedState)||(Ug=!0),i.memoizedState=o,i.baseState=d,i.baseQueue=et,a.lastRenderedState=o}if(e=a.interleaved,e!==null){c=e;do s=c.lane,N.lanes|=s,hh$1|=s,c=c.next;while(c!==e)}else c===null&&(a.lanes=0);return[i.memoizedState,a.dispatch]}function gi$1(e){var i=di$2(),a=i.queue;if(a===null)throw Error(p(311));a.lastRenderedReducer=e;var o=a.dispatch,c=a.pending,s=i.memoizedState;if(c!==null){a.pending=null;var d=c=c.next;do s=e(s,d.action),d=d.next;while(d!==c);He(s,i.memoizedState)||(Ug=!0),i.memoizedState=s,i.baseQueue===null&&(i.baseState=s),a.lastRenderedState=s}return[s,o]}function hi$2(){}function ii$1(e,i){var a=N,o=di$2(),c=i(),s=!He(o.memoizedState,c);if(s&&(o.memoizedState=c,Ug=!0),o=o.queue,ji$2(ki$1.bind(null,a,o,e),[e]),o.getSnapshot!==i||s||P!==null&&P.memoizedState.tag&1){if(a.flags|=2048,li$1(9,mi$2.bind(null,a,o,c,i),void 0,null),R$1===null)throw Error(p(349));Rh$1&30||ni$1(a,i,c)}return c}function ni$1(e,i,a){e.flags|=16384,e={getSnapshot:i,value:a},i=N.updateQueue,i===null?(i={lastEffect:null,stores:null},N.updateQueue=i,i.stores=[e]):(a=i.stores,a===null?i.stores=[e]:a.push(e))}function mi$2(e,i,a,o){i.value=a,i.getSnapshot=o,oi$1(i)&&pi$2(e)}function ki$1(e,i,a){return a(function(){oi$1(i)&&pi$2(e)})}function oi$1(e){var i=e.getSnapshot;e=e.value;try{var a=i();return!He(e,a)}catch{return!0}}function pi$2(e){var i=Zg(e,1);i!==null&&mh$1(i,e,1,-1)}function qi$2(e){var i=ci$1();return typeof e=="function"&&(e=e()),i.memoizedState=i.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei$1,lastRenderedState:e},i.queue=e,e=e.dispatch=ri$1.bind(null,N,e),[i.memoizedState,e]}function li$1(e,i,a,o){return e={tag:e,create:i,destroy:a,deps:o,next:null},i=N.updateQueue,i===null?(i={lastEffect:null,stores:null},N.updateQueue=i,i.lastEffect=e.next=e):(a=i.lastEffect,a===null?i.lastEffect=e.next=e:(o=a.next,a.next=e,e.next=o,i.lastEffect=e)),e}function si$2(){return di$2().memoizedState}function ti$1(e,i,a,o){var c=ci$1();N.flags|=e,c.memoizedState=li$1(1|i,a,void 0,o===void 0?null:o)}function ui$1(e,i,a,o){var c=di$2();o=o===void 0?null:o;var s=void 0;if(O!==null){var d=O.memoizedState;if(s=d.destroy,o!==null&&Wh$1(o,d.deps)){c.memoizedState=li$1(i,a,s,o);return}}N.flags|=e,c.memoizedState=li$1(1|i,a,s,o)}function vi$1(e,i){return ti$1(8390656,8,e,i)}function ji$2(e,i){return ui$1(2048,8,e,i)}function wi$1(e,i){return ui$1(4,2,e,i)}function xi$1(e,i){return ui$1(4,4,e,i)}function yi$1(e,i){if(typeof i=="function")return e=e(),i(e),function(){i(null)};if(i!=null)return e=e(),i.current=e,function(){i.current=null}}function zi$2(e,i,a){return a=a!=null?a.concat([e]):null,ui$1(4,4,yi$1.bind(null,i,e),a)}function Ai$1(){}function Bi$2(e,i){var a=di$2();i=i===void 0?null:i;var o=a.memoizedState;return o!==null&&i!==null&&Wh$1(i,o[1])?o[0]:(a.memoizedState=[e,i],e)}function Ci$1(e,i){var a=di$2();i=i===void 0?null:i;var o=a.memoizedState;return o!==null&&i!==null&&Wh$1(i,o[1])?o[0]:(e=e(),a.memoizedState=[e,i],e)}function Di$2(e,i,a){return Rh$1&21?(He(a,i)||(a=yc$2(),N.lanes|=a,hh$1|=a,e.baseState=!0),i):(e.baseState&&(e.baseState=!1,Ug=!0),e.memoizedState=a)}function Ei$1(e,i){var a=C;C=a!==0&&4>a?a:4,e(!0);var o=Qh$1.transition;Qh$1.transition={};try{e(!1),i()}finally{C=a,Qh$1.transition=o}}function Fi$2(){return di$2().memoizedState}function Gi$2(e,i,a){var o=lh$1(e);if(a={lane:o,action:a,hasEagerState:!1,eagerState:null,next:null},Hi$2(e))Ii$1(i,a);else if(a=Yg(e,i,a,o),a!==null){var c=L$1();mh$1(a,e,o,c),Ji$2(a,i,o)}}function ri$1(e,i,a){var o=lh$1(e),c={lane:o,action:a,hasEagerState:!1,eagerState:null,next:null};if(Hi$2(e))Ii$1(i,c);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=i.lastRenderedReducer,s!==null))try{var d=i.lastRenderedState,$=s(d,a);if(c.hasEagerState=!0,c.eagerState=$,He($,d)){var et=i.interleaved;et===null?(c.next=c,Xg(i)):(c.next=et.next,et.next=c),i.interleaved=c;return}}catch{}finally{}a=Yg(e,i,c,o),a!==null&&(c=L$1(),mh$1(a,e,o,c),Ji$2(a,i,o))}}function Hi$2(e){var i=e.alternate;return e===N||i!==null&&i===N}function Ii$1(e,i){Th$1=Sh$1=!0;var a=e.pending;a===null?i.next=i:(i.next=a.next,a.next=i),e.pending=i}function Ji$2(e,i,a){if(a&4194240){var o=i.lanes;o&=e.pendingLanes,a|=o,i.lanes=a,Cc$2(e,a)}}var ai$1={readContext:Vg,useCallback:Q$1,useContext:Q$1,useEffect:Q$1,useImperativeHandle:Q$1,useInsertionEffect:Q$1,useLayoutEffect:Q$1,useMemo:Q$1,useReducer:Q$1,useRef:Q$1,useState:Q$1,useDebugValue:Q$1,useDeferredValue:Q$1,useTransition:Q$1,useMutableSource:Q$1,useSyncExternalStore:Q$1,useId:Q$1,unstable_isNewReconciler:!1},Yh$1={readContext:Vg,useCallback:function(e,i){return ci$1().memoizedState=[e,i===void 0?null:i],e},useContext:Vg,useEffect:vi$1,useImperativeHandle:function(e,i,a){return a=a!=null?a.concat([e]):null,ti$1(4194308,4,yi$1.bind(null,i,e),a)},useLayoutEffect:function(e,i){return ti$1(4194308,4,e,i)},useInsertionEffect:function(e,i){return ti$1(4,2,e,i)},useMemo:function(e,i){var a=ci$1();return i=i===void 0?null:i,e=e(),a.memoizedState=[e,i],e},useReducer:function(e,i,a){var o=ci$1();return i=a!==void 0?a(i):i,o.memoizedState=o.baseState=i,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},o.queue=e,e=e.dispatch=Gi$2.bind(null,N,e),[o.memoizedState,e]},useRef:function(e){var i=ci$1();return e={current:e},i.memoizedState=e},useState:qi$2,useDebugValue:Ai$1,useDeferredValue:function(e){return ci$1().memoizedState=e},useTransition:function(){var e=qi$2(!1),i=e[0];return e=Ei$1.bind(null,e[1]),ci$1().memoizedState=e,[i,e]},useMutableSource:function(){},useSyncExternalStore:function(e,i,a){var o=N,c=ci$1();if(I){if(a===void 0)throw Error(p(407));a=a()}else{if(a=i(),R$1===null)throw Error(p(349));Rh$1&30||ni$1(o,i,a)}c.memoizedState=a;var s={value:a,getSnapshot:i};return c.queue=s,vi$1(ki$1.bind(null,o,s,e),[e]),o.flags|=2048,li$1(9,mi$2.bind(null,o,s,a,i),void 0,null),a},useId:function(){var e=ci$1(),i=R$1.identifierPrefix;if(I){var a=sg$1,o=rg$1;a=(o&~(1<<32-oc$2(o)-1)).toString(32)+a,i=":"+i+"R"+a,a=Uh$1++,0<a&&(i+="H"+a.toString(32)),i+=":"}else a=Vh$1++,i=":"+i+"r"+a.toString(32)+":";return e.memoizedState=i},unstable_isNewReconciler:!1},Zh$1={readContext:Vg,useCallback:Bi$2,useContext:Vg,useEffect:ji$2,useImperativeHandle:zi$2,useInsertionEffect:wi$1,useLayoutEffect:xi$1,useMemo:Ci$1,useReducer:fi$2,useRef:si$2,useState:function(){return fi$2(ei$1)},useDebugValue:Ai$1,useDeferredValue:function(e){var i=di$2();return Di$2(i,O.memoizedState,e)},useTransition:function(){var e=fi$2(ei$1)[0],i=di$2().memoizedState;return[e,i]},useMutableSource:hi$2,useSyncExternalStore:ii$1,useId:Fi$2,unstable_isNewReconciler:!1},$h$1={readContext:Vg,useCallback:Bi$2,useContext:Vg,useEffect:ji$2,useImperativeHandle:zi$2,useInsertionEffect:wi$1,useLayoutEffect:xi$1,useMemo:Ci$1,useReducer:gi$1,useRef:si$2,useState:function(){return gi$1(ei$1)},useDebugValue:Ai$1,useDeferredValue:function(e){var i=di$2();return O===null?i.memoizedState=e:Di$2(i,O.memoizedState,e)},useTransition:function(){var e=gi$1(ei$1)[0],i=di$2().memoizedState;return[e,i]},useMutableSource:hi$2,useSyncExternalStore:ii$1,useId:Fi$2,unstable_isNewReconciler:!1};function Ki$2(e,i){try{var a="",o=i;do a+=Pa(o),o=o.return;while(o);var c=a}catch(s){c=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:i,stack:c,digest:null}}function Li$2(e,i,a){return{value:e,source:null,stack:a??null,digest:i??null}}function Mi$2(e,i){try{console.error(i.value)}catch(a){setTimeout(function(){throw a})}}var Ni$1=typeof WeakMap=="function"?WeakMap:Map;function Oi$2(e,i,a){a=ch$1(-1,a),a.tag=3,a.payload={element:null};var o=i.value;return a.callback=function(){Pi$2||(Pi$2=!0,Qi$2=o),Mi$2(e,i)},a}function Ri$2(e,i,a){a=ch$1(-1,a),a.tag=3;var o=e.type.getDerivedStateFromError;if(typeof o=="function"){var c=i.value;a.payload=function(){return o(c)},a.callback=function(){Mi$2(e,i)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(a.callback=function(){Mi$2(e,i),typeof o!="function"&&(Si$1===null?Si$1=new Set([this]):Si$1.add(this));var d=i.stack;this.componentDidCatch(i.value,{componentStack:d!==null?d:""})}),a}function Ti$1(e,i,a){var o=e.pingCache;if(o===null){o=e.pingCache=new Ni$1;var c=new Set;o.set(i,c)}else c=o.get(i),c===void 0&&(c=new Set,o.set(i,c));c.has(a)||(c.add(a),e=Ui$2.bind(null,e,i,a),i.then(e,e))}function Vi$1(e){do{var i;if((i=e.tag===13)&&(i=e.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return e;e=e.return}while(e!==null);return null}function Wi$2(e,i,a,o,c){return e.mode&1?(e.flags|=65536,e.lanes=c,e):(e===i?e.flags|=65536:(e.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(i=ch$1(-1,1),i.tag=2,dh$1(a,i,1))),a.lanes|=1),e)}var Xi$2=ua$2.ReactCurrentOwner,Ug=!1;function Yi$2(e,i,a,o){i.child=e===null?Ch$1(i,null,a,o):Bh$1(i,e.child,a,o)}function Zi$2(e,i,a,o,c){a=a.render;var s=i.ref;return Tg$1(i,c),o=Xh$1(e,i,a,o,s,c),a=bi$1(),e!==null&&!Ug?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~c,$i$1(e,i,c)):(I&&a&&vg$1(i),i.flags|=1,Yi$2(e,i,o,c),i.child)}function aj(e,i,a,o,c){if(e===null){var s=a.type;return typeof s=="function"&&!bj(s)&&s.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(i.tag=15,i.type=s,cj(e,i,s,o,c)):(e=yh$1(a.type,null,o,i,i.mode,c),e.ref=i.ref,e.return=i,i.child=e)}if(s=e.child,!(e.lanes&c)){var d=s.memoizedProps;if(a=a.compare,a=a!==null?a:Ie,a(d,o)&&e.ref===i.ref)return $i$1(e,i,c)}return i.flags|=1,e=wh$1(s,o),e.ref=i.ref,e.return=i,i.child=e}function cj(e,i,a,o,c){if(e!==null){var s=e.memoizedProps;if(Ie(s,o)&&e.ref===i.ref)if(Ug=!1,i.pendingProps=o=s,(e.lanes&c)!==0)e.flags&131072&&(Ug=!0);else return i.lanes=e.lanes,$i$1(e,i,c)}return dj(e,i,a,o,c)}function ej(e,i,a){var o=i.pendingProps,c=o.children,s=e!==null?e.memoizedState:null;if(o.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(fj,gj),gj|=a;else{if(!(a&1073741824))return e=s!==null?s.baseLanes|a:a,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:e,cachePool:null,transitions:null},i.updateQueue=null,G(fj,gj),gj|=e,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=s!==null?s.baseLanes:a,G(fj,gj),gj|=o}else s!==null?(o=s.baseLanes|a,i.memoizedState=null):o=a,G(fj,gj),gj|=o;return Yi$2(e,i,c,a),i.child}function hj(e,i){var a=i.ref;(e===null&&a!==null||e!==null&&e.ref!==a)&&(i.flags|=512,i.flags|=2097152)}function dj(e,i,a,o,c){var s=Zf$1(a)?Xf$1:H$1.current;return s=Yf$1(i,s),Tg$1(i,c),a=Xh$1(e,i,a,o,s,c),o=bi$1(),e!==null&&!Ug?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~c,$i$1(e,i,c)):(I&&o&&vg$1(i),i.flags|=1,Yi$2(e,i,a,c),i.child)}function ij(e,i,a,o,c){if(Zf$1(a)){var s=!0;cg$1(i)}else s=!1;if(Tg$1(i,c),i.stateNode===null)jj(e,i),ph$1(i,a,o),rh$1(i,a,o,c),o=!0;else if(e===null){var d=i.stateNode,$=i.memoizedProps;d.props=$;var et=d.context,h=a.contextType;typeof h=="object"&&h!==null?h=Vg(h):(h=Zf$1(a)?Xf$1:H$1.current,h=Yf$1(i,h));var b=a.getDerivedStateFromProps,g=typeof b=="function"||typeof d.getSnapshotBeforeUpdate=="function";g||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||($!==o||et!==h)&&qh$1(i,d,o,h),$g=!1;var st=i.memoizedState;d.state=st,gh$1(i,o,d,c),et=i.memoizedState,$!==o||st!==et||Wf$1.current||$g?(typeof b=="function"&&(kh$1(i,a,b,o),et=i.memoizedState),($=$g||oh$1(i,a,$,o,st,et,h))?(g||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(i.flags|=4194308)):(typeof d.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=o,i.memoizedState=et),d.props=o,d.state=et,d.context=h,o=$):(typeof d.componentDidMount=="function"&&(i.flags|=4194308),o=!1)}else{d=i.stateNode,bh$1(e,i),$=i.memoizedProps,h=i.type===i.elementType?$:Lg(i.type,$),d.props=h,g=i.pendingProps,st=d.context,et=a.contextType,typeof et=="object"&&et!==null?et=Vg(et):(et=Zf$1(a)?Xf$1:H$1.current,et=Yf$1(i,et));var $t=a.getDerivedStateFromProps;(b=typeof $t=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||($!==g||st!==et)&&qh$1(i,d,o,et),$g=!1,st=i.memoizedState,d.state=st,gh$1(i,o,d,c);var vt=i.memoizedState;$!==g||st!==vt||Wf$1.current||$g?(typeof $t=="function"&&(kh$1(i,a,$t,o),vt=i.memoizedState),(h=$g||oh$1(i,a,h,o,st,vt,et)||!1)?(b||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(o,vt,et),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(o,vt,et)),typeof d.componentDidUpdate=="function"&&(i.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof d.componentDidUpdate!="function"||$===e.memoizedProps&&st===e.memoizedState||(i.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||$===e.memoizedProps&&st===e.memoizedState||(i.flags|=1024),i.memoizedProps=o,i.memoizedState=vt),d.props=o,d.state=vt,d.context=et,o=h):(typeof d.componentDidUpdate!="function"||$===e.memoizedProps&&st===e.memoizedState||(i.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||$===e.memoizedProps&&st===e.memoizedState||(i.flags|=1024),o=!1)}return kj(e,i,a,o,s,c)}function kj(e,i,a,o,c,s){hj(e,i);var d=(i.flags&128)!==0;if(!o&&!d)return c&&dg$1(i,a,!1),$i$1(e,i,s);o=i.stateNode,Xi$2.current=i;var $=d&&typeof a.getDerivedStateFromError!="function"?null:o.render();return i.flags|=1,e!==null&&d?(i.child=Bh$1(i,e.child,null,s),i.child=Bh$1(i,null,$,s)):Yi$2(e,i,$,s),i.memoizedState=o.state,c&&dg$1(i,a,!0),i.child}function lj(e){var i=e.stateNode;i.pendingContext?ag(e,i.pendingContext,i.pendingContext!==i.context):i.context&&ag(e,i.context,!1),Ih(e,i.containerInfo)}function mj(e,i,a,o,c){return Ig(),Jg(c),i.flags|=256,Yi$2(e,i,a,o),i.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(e){return{baseLanes:e,cachePool:null,transitions:null}}function pj(e,i,a){var o=i.pendingProps,c=M$1.current,s=!1,d=(i.flags&128)!==0,$;if(($=d)||($=e!==null&&e.memoizedState===null?!1:(c&2)!==0),$?(s=!0,i.flags&=-129):(e===null||e.memoizedState!==null)&&(c|=1),G(M$1,c&1),e===null)return Eg(i),e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(i.mode&1?e.data==="$!"?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(d=o.children,e=o.fallback,s?(o=i.mode,s=i.child,d={mode:"hidden",children:d},!(o&1)&&s!==null?(s.childLanes=0,s.pendingProps=d):s=qj(d,o,0,null),e=Ah$1(e,o,a,null),s.return=i,e.return=i,s.sibling=e,i.child=s,i.child.memoizedState=oj(a),i.memoizedState=nj,e):rj(i,d));if(c=e.memoizedState,c!==null&&($=c.dehydrated,$!==null))return sj(e,i,d,o,$,c,a);if(s){s=o.fallback,d=i.mode,c=e.child,$=c.sibling;var et={mode:"hidden",children:o.children};return!(d&1)&&i.child!==c?(o=i.child,o.childLanes=0,o.pendingProps=et,i.deletions=null):(o=wh$1(c,et),o.subtreeFlags=c.subtreeFlags&14680064),$!==null?s=wh$1($,s):(s=Ah$1(s,d,a,null),s.flags|=2),s.return=i,o.return=i,o.sibling=s,i.child=o,o=s,s=i.child,d=e.child.memoizedState,d=d===null?oj(a):{baseLanes:d.baseLanes|a,cachePool:null,transitions:d.transitions},s.memoizedState=d,s.childLanes=e.childLanes&~a,i.memoizedState=nj,o}return s=e.child,e=s.sibling,o=wh$1(s,{mode:"visible",children:o.children}),!(i.mode&1)&&(o.lanes=a),o.return=i,o.sibling=null,e!==null&&(a=i.deletions,a===null?(i.deletions=[e],i.flags|=16):a.push(e)),i.child=o,i.memoizedState=null,o}function rj(e,i){return i=qj({mode:"visible",children:i},e.mode,0,null),i.return=e,e.child=i}function tj(e,i,a,o){return o!==null&&Jg(o),Bh$1(i,e.child,null,a),e=rj(i,i.pendingProps.children),e.flags|=2,i.memoizedState=null,e}function sj(e,i,a,o,c,s,d){if(a)return i.flags&256?(i.flags&=-257,o=Li$2(Error(p(422))),tj(e,i,d,o)):i.memoizedState!==null?(i.child=e.child,i.flags|=128,null):(s=o.fallback,c=i.mode,o=qj({mode:"visible",children:o.children},c,0,null),s=Ah$1(s,c,d,null),s.flags|=2,o.return=i,s.return=i,o.sibling=s,i.child=o,i.mode&1&&Bh$1(i,e.child,null,d),i.child.memoizedState=oj(d),i.memoizedState=nj,s);if(!(i.mode&1))return tj(e,i,d,null);if(c.data==="$!"){if(o=c.nextSibling&&c.nextSibling.dataset,o)var $=o.dgst;return o=$,s=Error(p(419)),o=Li$2(s,o,void 0),tj(e,i,d,o)}if($=(d&e.childLanes)!==0,Ug||$){if(o=R$1,o!==null){switch(d&-d){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=c&(o.suspendedLanes|d)?0:c,c!==0&&c!==s.retryLane&&(s.retryLane=c,Zg(e,c),mh$1(o,e,c,-1))}return uj(),o=Li$2(Error(p(421))),tj(e,i,d,o)}return c.data==="$?"?(i.flags|=128,i.child=e.child,i=vj.bind(null,e),c._reactRetry=i,null):(e=s.treeContext,yg=Lf$1(c.nextSibling),xg$1=i,I=!0,zg=null,e!==null&&(og$1[pg$1++]=rg$1,og$1[pg$1++]=sg$1,og$1[pg$1++]=qg,rg$1=e.id,sg$1=e.overflow,qg=i),i=rj(i,o.children),i.flags|=4096,i)}function wj(e,i,a){e.lanes|=i;var o=e.alternate;o!==null&&(o.lanes|=i),Sg(e.return,i,a)}function xj(e,i,a,o,c){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:o,tail:a,tailMode:c}:(s.isBackwards=i,s.rendering=null,s.renderingStartTime=0,s.last=o,s.tail=a,s.tailMode=c)}function yj(e,i,a){var o=i.pendingProps,c=o.revealOrder,s=o.tail;if(Yi$2(e,i,o.children,a),o=M$1.current,o&2)o=o&1|2,i.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=i.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&wj(e,a,i);else if(e.tag===19)wj(e,a,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break e;for(;e.sibling===null;){if(e.return===null||e.return===i)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(G(M$1,o),!(i.mode&1))i.memoizedState=null;else switch(c){case"forwards":for(a=i.child,c=null;a!==null;)e=a.alternate,e!==null&&Mh$1(e)===null&&(c=a),a=a.sibling;a=c,a===null?(c=i.child,i.child=null):(c=a.sibling,a.sibling=null),xj(i,!1,c,a,s);break;case"backwards":for(a=null,c=i.child,i.child=null;c!==null;){if(e=c.alternate,e!==null&&Mh$1(e)===null){i.child=c;break}e=c.sibling,c.sibling=a,a=c,c=e}xj(i,!0,a,null,s);break;case"together":xj(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function jj(e,i){!(i.mode&1)&&e!==null&&(e.alternate=null,i.alternate=null,i.flags|=2)}function $i$1(e,i,a){if(e!==null&&(i.dependencies=e.dependencies),hh$1|=i.lanes,!(a&i.childLanes))return null;if(e!==null&&i.child!==e.child)throw Error(p(153));if(i.child!==null){for(e=i.child,a=wh$1(e,e.pendingProps),i.child=a,a.return=i;e.sibling!==null;)e=e.sibling,a=a.sibling=wh$1(e,e.pendingProps),a.return=i;a.sibling=null}return i.child}function zj(e,i,a){switch(i.tag){case 3:lj(i),Ig();break;case 5:Kh$1(i);break;case 1:Zf$1(i.type)&&cg$1(i);break;case 4:Ih(i,i.stateNode.containerInfo);break;case 10:var o=i.type._context,c=i.memoizedProps.value;G(Mg,o._currentValue),o._currentValue=c;break;case 13:if(o=i.memoizedState,o!==null)return o.dehydrated!==null?(G(M$1,M$1.current&1),i.flags|=128,null):a&i.child.childLanes?pj(e,i,a):(G(M$1,M$1.current&1),e=$i$1(e,i,a),e!==null?e.sibling:null);G(M$1,M$1.current&1);break;case 19:if(o=(a&i.childLanes)!==0,e.flags&128){if(o)return yj(e,i,a);i.flags|=128}if(c=i.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),G(M$1,M$1.current),o)break;return null;case 22:case 23:return i.lanes=0,ej(e,i,a)}return $i$1(e,i,a)}var Aj,Bj,Cj,Dj;Aj=function(e,i){for(var a=i.child;a!==null;){if(a.tag===5||a.tag===6)e.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};Bj=function(){};Cj=function(e,i,a,o){var c=e.memoizedProps;if(c!==o){e=i.stateNode,Hh$1(Eh$1.current);var s=null;switch(a){case"input":c=Ya$2(e,c),o=Ya$2(e,o),s=[];break;case"select":c=A({},c,{value:void 0}),o=A({},o,{value:void 0}),s=[];break;case"textarea":c=gb$1(e,c),o=gb$1(e,o),s=[];break;default:typeof c.onClick!="function"&&typeof o.onClick=="function"&&(e.onclick=Bf$1)}ub$1(a,o);var d;a=null;for(h in c)if(!o.hasOwnProperty(h)&&c.hasOwnProperty(h)&&c[h]!=null)if(h==="style"){var $=c[h];for(d in $)$.hasOwnProperty(d)&&(a||(a={}),a[d]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(ea$1.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in o){var et=o[h];if($=c!=null?c[h]:void 0,o.hasOwnProperty(h)&&et!==$&&(et!=null||$!=null))if(h==="style")if($){for(d in $)!$.hasOwnProperty(d)||et&&et.hasOwnProperty(d)||(a||(a={}),a[d]="");for(d in et)et.hasOwnProperty(d)&&$[d]!==et[d]&&(a||(a={}),a[d]=et[d])}else a||(s||(s=[]),s.push(h,a)),a=et;else h==="dangerouslySetInnerHTML"?(et=et?et.__html:void 0,$=$?$.__html:void 0,et!=null&&$!==et&&(s=s||[]).push(h,et)):h==="children"?typeof et!="string"&&typeof et!="number"||(s=s||[]).push(h,""+et):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(ea$1.hasOwnProperty(h)?(et!=null&&h==="onScroll"&&D("scroll",e),s||$===et||(s=[])):(s=s||[]).push(h,et))}a&&(s=s||[]).push("style",a);var h=s;(i.updateQueue=h)&&(i.flags|=4)}};Dj=function(e,i,a,o){a!==o&&(i.flags|=4)};function Ej(e,i){if(!I)switch(e.tailMode){case"hidden":i=e.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?i||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function S(e){var i=e.alternate!==null&&e.alternate.child===e.child,a=0,o=0;if(i)for(var c=e.child;c!==null;)a|=c.lanes|c.childLanes,o|=c.subtreeFlags&14680064,o|=c.flags&14680064,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)a|=c.lanes|c.childLanes,o|=c.subtreeFlags,o|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=o,e.childLanes=a,i}function Fj(e,i,a){var o=i.pendingProps;switch(wg$1(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(i),null;case 1:return Zf$1(i.type)&&$f$1(),S(i),null;case 3:return o=i.stateNode,Jh$1(),E(Wf$1),E(H$1),Oh$1(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(Gg(i)?i.flags|=4:e===null||e.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(e,i),S(i),null;case 5:Lh$1(i);var c=Hh$1(Gh$1.current);if(a=i.type,e!==null&&i.stateNode!=null)Cj(e,i,a,o,c),e.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!o){if(i.stateNode===null)throw Error(p(166));return S(i),null}if(e=Hh$1(Eh$1.current),Gg(i)){o=i.stateNode,a=i.type;var s=i.memoizedProps;switch(o[Of$1]=i,o[Pf$1]=s,e=(i.mode&1)!==0,a){case"dialog":D("cancel",o),D("close",o);break;case"iframe":case"object":case"embed":D("load",o);break;case"video":case"audio":for(c=0;c<lf$2.length;c++)D(lf$2[c],o);break;case"source":D("error",o);break;case"img":case"image":case"link":D("error",o),D("load",o);break;case"details":D("toggle",o);break;case"input":Za$2(o,s),D("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!s.multiple},D("invalid",o);break;case"textarea":hb$1(o,s),D("invalid",o)}ub$1(a,s),c=null;for(var d in s)if(s.hasOwnProperty(d)){var $=s[d];d==="children"?typeof $=="string"?o.textContent!==$&&(s.suppressHydrationWarning!==!0&&Af$1(o.textContent,$,e),c=["children",$]):typeof $=="number"&&o.textContent!==""+$&&(s.suppressHydrationWarning!==!0&&Af$1(o.textContent,$,e),c=["children",""+$]):ea$1.hasOwnProperty(d)&&$!=null&&d==="onScroll"&&D("scroll",o)}switch(a){case"input":Va$2(o),db$1(o,s,!0);break;case"textarea":Va$2(o),jb$1(o);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(o.onclick=Bf$1)}o=c,i.updateQueue=o,o!==null&&(i.flags|=4)}else{d=c.nodeType===9?c:c.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kb$1(a)),e==="http://www.w3.org/1999/xhtml"?a==="script"?(e=d.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof o.is=="string"?e=d.createElement(a,{is:o.is}):(e=d.createElement(a),a==="select"&&(d=e,o.multiple?d.multiple=!0:o.size&&(d.size=o.size))):e=d.createElementNS(e,a),e[Of$1]=i,e[Pf$1]=o,Aj(e,i,!1,!1),i.stateNode=e;e:{switch(d=vb$1(a,o),a){case"dialog":D("cancel",e),D("close",e),c=o;break;case"iframe":case"object":case"embed":D("load",e),c=o;break;case"video":case"audio":for(c=0;c<lf$2.length;c++)D(lf$2[c],e);c=o;break;case"source":D("error",e),c=o;break;case"img":case"image":case"link":D("error",e),D("load",e),c=o;break;case"details":D("toggle",e),c=o;break;case"input":Za$2(e,o),c=Ya$2(e,o),D("invalid",e);break;case"option":c=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},c=A({},o,{value:void 0}),D("invalid",e);break;case"textarea":hb$1(e,o),c=gb$1(e,o),D("invalid",e);break;default:c=o}ub$1(a,c),$=c;for(s in $)if($.hasOwnProperty(s)){var et=$[s];s==="style"?sb$1(e,et):s==="dangerouslySetInnerHTML"?(et=et?et.__html:void 0,et!=null&&nb$1(e,et)):s==="children"?typeof et=="string"?(a!=="textarea"||et!=="")&&ob$1(e,et):typeof et=="number"&&ob$1(e,""+et):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ea$1.hasOwnProperty(s)?et!=null&&s==="onScroll"&&D("scroll",e):et!=null&&ta$1(e,s,et,d))}switch(a){case"input":Va$2(e),db$1(e,o,!1);break;case"textarea":Va$2(e),jb$1(e);break;case"option":o.value!=null&&e.setAttribute("value",""+Sa$1(o.value));break;case"select":e.multiple=!!o.multiple,s=o.value,s!=null?fb$1(e,!!o.multiple,s,!1):o.defaultValue!=null&&fb$1(e,!!o.multiple,o.defaultValue,!0);break;default:typeof c.onClick=="function"&&(e.onclick=Bf$1)}switch(a){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return S(i),null;case 6:if(e&&i.stateNode!=null)Dj(e,i,e.memoizedProps,o);else{if(typeof o!="string"&&i.stateNode===null)throw Error(p(166));if(a=Hh$1(Gh$1.current),Hh$1(Eh$1.current),Gg(i)){if(o=i.stateNode,a=i.memoizedProps,o[Of$1]=i,(s=o.nodeValue!==a)&&(e=xg$1,e!==null))switch(e.tag){case 3:Af$1(o.nodeValue,a,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Af$1(o.nodeValue,a,(e.mode&1)!==0)}s&&(i.flags|=4)}else o=(a.nodeType===9?a:a.ownerDocument).createTextNode(o),o[Of$1]=i,i.stateNode=o}return S(i),null;case 13:if(E(M$1),o=i.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(I&&yg!==null&&i.mode&1&&!(i.flags&128))Hg(),Ig(),i.flags|=98560,s=!1;else if(s=Gg(i),o!==null&&o.dehydrated!==null){if(e===null){if(!s)throw Error(p(318));if(s=i.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(p(317));s[Of$1]=i}else Ig(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;S(i),s=!1}else zg!==null&&(Gj(zg),zg=null),s=!0;if(!s)return i.flags&65536?i:null}return i.flags&128?(i.lanes=a,i):(o=o!==null,o!==(e!==null&&e.memoizedState!==null)&&o&&(i.child.flags|=8192,i.mode&1&&(e===null||M$1.current&1?T===0&&(T=3):uj())),i.updateQueue!==null&&(i.flags|=4),S(i),null);case 4:return Jh$1(),Bj(e,i),e===null&&sf$2(i.stateNode.containerInfo),S(i),null;case 10:return Rg(i.type._context),S(i),null;case 17:return Zf$1(i.type)&&$f$1(),S(i),null;case 19:if(E(M$1),s=i.memoizedState,s===null)return S(i),null;if(o=(i.flags&128)!==0,d=s.rendering,d===null)if(o)Ej(s,!1);else{if(T!==0||e!==null&&e.flags&128)for(e=i.child;e!==null;){if(d=Mh$1(e),d!==null){for(i.flags|=128,Ej(s,!1),o=d.updateQueue,o!==null&&(i.updateQueue=o,i.flags|=4),i.subtreeFlags=0,o=a,a=i.child;a!==null;)s=a,e=o,s.flags&=14680066,d=s.alternate,d===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=d.childLanes,s.lanes=d.lanes,s.child=d.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=d.memoizedProps,s.memoizedState=d.memoizedState,s.updateQueue=d.updateQueue,s.type=d.type,e=d.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),a=a.sibling;return G(M$1,M$1.current&1|2),i.child}e=e.sibling}s.tail!==null&&B$1()>Hj&&(i.flags|=128,o=!0,Ej(s,!1),i.lanes=4194304)}else{if(!o)if(e=Mh$1(d),e!==null){if(i.flags|=128,o=!0,a=e.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),Ej(s,!0),s.tail===null&&s.tailMode==="hidden"&&!d.alternate&&!I)return S(i),null}else 2*B$1()-s.renderingStartTime>Hj&&a!==1073741824&&(i.flags|=128,o=!0,Ej(s,!1),i.lanes=4194304);s.isBackwards?(d.sibling=i.child,i.child=d):(a=s.last,a!==null?a.sibling=d:i.child=d,s.last=d)}return s.tail!==null?(i=s.tail,s.rendering=i,s.tail=i.sibling,s.renderingStartTime=B$1(),i.sibling=null,a=M$1.current,G(M$1,o?a&1|2:a&1),i):(S(i),null);case 22:case 23:return Ij(),o=i.memoizedState!==null,e!==null&&e.memoizedState!==null!==o&&(i.flags|=8192),o&&i.mode&1?gj&1073741824&&(S(i),i.subtreeFlags&6&&(i.flags|=8192)):S(i),null;case 24:return null;case 25:return null}throw Error(p(156,i.tag))}function Jj(e,i){switch(wg$1(i),i.tag){case 1:return Zf$1(i.type)&&$f$1(),e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 3:return Jh$1(),E(Wf$1),E(H$1),Oh$1(),e=i.flags,e&65536&&!(e&128)?(i.flags=e&-65537|128,i):null;case 5:return Lh$1(i),null;case 13:if(E(M$1),e=i.memoizedState,e!==null&&e.dehydrated!==null){if(i.alternate===null)throw Error(p(340));Ig()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 19:return E(M$1),null;case 4:return Jh$1(),null;case 10:return Rg(i.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U$2=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V$1=null;function Mj(e,i){var a=e.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(o){W(e,i,o)}else a.current=null}function Nj(e,i,a){try{a()}catch(o){W(e,i,o)}}var Oj=!1;function Pj(e,i){if(Cf$1=dd$2,e=Me$1(),Ne$1(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var o=a.getSelection&&a.getSelection();if(o&&o.rangeCount!==0){a=o.anchorNode;var c=o.anchorOffset,s=o.focusNode;o=o.focusOffset;try{a.nodeType,s.nodeType}catch{a=null;break e}var d=0,$=-1,et=-1,h=0,b=0,g=e,st=null;t:for(;;){for(var $t;g!==a||c!==0&&g.nodeType!==3||($=d+c),g!==s||o!==0&&g.nodeType!==3||(et=d+o),g.nodeType===3&&(d+=g.nodeValue.length),($t=g.firstChild)!==null;)st=g,g=$t;for(;;){if(g===e)break t;if(st===a&&++h===c&&($=d),st===s&&++b===o&&(et=d),($t=g.nextSibling)!==null)break;g=st,st=g.parentNode}g=$t}a=$===-1||et===-1?null:{start:$,end:et}}else a=null}a=a||{start:0,end:0}}else a=null;for(Df$1={focusedElem:e,selectionRange:a},dd$2=!1,V$1=i;V$1!==null;)if(i=V$1,e=i.child,(i.subtreeFlags&1028)!==0&&e!==null)e.return=i,V$1=e;else for(;V$1!==null;){i=V$1;try{var vt=i.alternate;if(i.flags&1024)switch(i.tag){case 0:case 11:case 15:break;case 1:if(vt!==null){var Ft=vt.memoizedProps,Gt=vt.memoizedState,qt=i.stateNode,Lt=qt.getSnapshotBeforeUpdate(i.elementType===i.type?Ft:Lg(i.type,Ft),Gt);qt.__reactInternalSnapshotBeforeUpdate=Lt}break;case 3:var rr=i.stateNode.containerInfo;rr.nodeType===1?rr.textContent="":rr.nodeType===9&&rr.documentElement&&rr.removeChild(rr.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(jr){W(i,i.return,jr)}if(e=i.sibling,e!==null){e.return=i.return,V$1=e;break}V$1=i.return}return vt=Oj,Oj=!1,vt}function Qj(e,i,a){var o=i.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var c=o=o.next;do{if((c.tag&e)===e){var s=c.destroy;c.destroy=void 0,s!==void 0&&Nj(i,a,s)}c=c.next}while(c!==o)}}function Rj(e,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&e)===e){var o=a.create;a.destroy=o()}a=a.next}while(a!==i)}}function Sj(e){var i=e.ref;if(i!==null){var a=e.stateNode;switch(e.tag){case 5:e=a;break;default:e=a}typeof i=="function"?i(e):i.current=e}}function Tj(e){var i=e.alternate;i!==null&&(e.alternate=null,Tj(i)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(i=e.stateNode,i!==null&&(delete i[Of$1],delete i[Pf$1],delete i[of$2],delete i[Qf$1],delete i[Rf$1])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Uj(e){return e.tag===5||e.tag===3||e.tag===4}function Vj(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Uj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Wj(e,i,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,i?a.nodeType===8?a.parentNode.insertBefore(e,i):a.insertBefore(e,i):(a.nodeType===8?(i=a.parentNode,i.insertBefore(e,a)):(i=a,i.appendChild(e)),a=a._reactRootContainer,a!=null||i.onclick!==null||(i.onclick=Bf$1));else if(o!==4&&(e=e.child,e!==null))for(Wj(e,i,a),e=e.sibling;e!==null;)Wj(e,i,a),e=e.sibling}function Xj(e,i,a){var o=e.tag;if(o===5||o===6)e=e.stateNode,i?a.insertBefore(e,i):a.appendChild(e);else if(o!==4&&(e=e.child,e!==null))for(Xj(e,i,a),e=e.sibling;e!==null;)Xj(e,i,a),e=e.sibling}var X$1=null,Yj=!1;function Zj(e,i,a){for(a=a.child;a!==null;)ak(e,i,a),a=a.sibling}function ak(e,i,a){if(lc$2&&typeof lc$2.onCommitFiberUnmount=="function")try{lc$2.onCommitFiberUnmount(kc$2,a)}catch{}switch(a.tag){case 5:U$2||Mj(a,i);case 6:var o=X$1,c=Yj;X$1=null,Zj(e,i,a),X$1=o,Yj=c,X$1!==null&&(Yj?(e=X$1,a=a.stateNode,e.nodeType===8?e.parentNode.removeChild(a):e.removeChild(a)):X$1.removeChild(a.stateNode));break;case 18:X$1!==null&&(Yj?(e=X$1,a=a.stateNode,e.nodeType===8?Kf$1(e.parentNode,a):e.nodeType===1&&Kf$1(e,a),bd$1(e)):Kf$1(X$1,a.stateNode));break;case 4:o=X$1,c=Yj,X$1=a.stateNode.containerInfo,Yj=!0,Zj(e,i,a),X$1=o,Yj=c;break;case 0:case 11:case 14:case 15:if(!U$2&&(o=a.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){c=o=o.next;do{var s=c,d=s.destroy;s=s.tag,d!==void 0&&(s&2||s&4)&&Nj(a,i,d),c=c.next}while(c!==o)}Zj(e,i,a);break;case 1:if(!U$2&&(Mj(a,i),o=a.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=a.memoizedProps,o.state=a.memoizedState,o.componentWillUnmount()}catch($){W(a,i,$)}Zj(e,i,a);break;case 21:Zj(e,i,a);break;case 22:a.mode&1?(U$2=(o=U$2)||a.memoizedState!==null,Zj(e,i,a),U$2=o):Zj(e,i,a);break;default:Zj(e,i,a)}}function bk(e){var i=e.updateQueue;if(i!==null){e.updateQueue=null;var a=e.stateNode;a===null&&(a=e.stateNode=new Lj),i.forEach(function(o){var c=ck.bind(null,e,o);a.has(o)||(a.add(o),o.then(c,c))})}}function dk(e,i){var a=i.deletions;if(a!==null)for(var o=0;o<a.length;o++){var c=a[o];try{var s=e,d=i,$=d;e:for(;$!==null;){switch($.tag){case 5:X$1=$.stateNode,Yj=!1;break e;case 3:X$1=$.stateNode.containerInfo,Yj=!0;break e;case 4:X$1=$.stateNode.containerInfo,Yj=!0;break e}$=$.return}if(X$1===null)throw Error(p(160));ak(s,d,c),X$1=null,Yj=!1;var et=c.alternate;et!==null&&(et.return=null),c.return=null}catch(h){W(c,i,h)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)ek(i,e),i=i.sibling}function ek(e,i){var a=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(dk(i,e),fk(e),o&4){try{Qj(3,e,e.return),Rj(3,e)}catch(Ft){W(e,e.return,Ft)}try{Qj(5,e,e.return)}catch(Ft){W(e,e.return,Ft)}}break;case 1:dk(i,e),fk(e),o&512&&a!==null&&Mj(a,a.return);break;case 5:if(dk(i,e),fk(e),o&512&&a!==null&&Mj(a,a.return),e.flags&32){var c=e.stateNode;try{ob$1(c,"")}catch(Ft){W(e,e.return,Ft)}}if(o&4&&(c=e.stateNode,c!=null)){var s=e.memoizedProps,d=a!==null?a.memoizedProps:s,$=e.type,et=e.updateQueue;if(e.updateQueue=null,et!==null)try{$==="input"&&s.type==="radio"&&s.name!=null&&ab$1(c,s),vb$1($,d);var h=vb$1($,s);for(d=0;d<et.length;d+=2){var b=et[d],g=et[d+1];b==="style"?sb$1(c,g):b==="dangerouslySetInnerHTML"?nb$1(c,g):b==="children"?ob$1(c,g):ta$1(c,b,g,h)}switch($){case"input":bb$1(c,s);break;case"textarea":ib$1(c,s);break;case"select":var st=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!s.multiple;var $t=s.value;$t!=null?fb$1(c,!!s.multiple,$t,!1):st!==!!s.multiple&&(s.defaultValue!=null?fb$1(c,!!s.multiple,s.defaultValue,!0):fb$1(c,!!s.multiple,s.multiple?[]:"",!1))}c[Pf$1]=s}catch(Ft){W(e,e.return,Ft)}}break;case 6:if(dk(i,e),fk(e),o&4){if(e.stateNode===null)throw Error(p(162));c=e.stateNode,s=e.memoizedProps;try{c.nodeValue=s}catch(Ft){W(e,e.return,Ft)}}break;case 3:if(dk(i,e),fk(e),o&4&&a!==null&&a.memoizedState.isDehydrated)try{bd$1(i.containerInfo)}catch(Ft){W(e,e.return,Ft)}break;case 4:dk(i,e),fk(e);break;case 13:dk(i,e),fk(e),c=e.child,c.flags&8192&&(s=c.memoizedState!==null,c.stateNode.isHidden=s,!s||c.alternate!==null&&c.alternate.memoizedState!==null||(gk=B$1())),o&4&&bk(e);break;case 22:if(b=a!==null&&a.memoizedState!==null,e.mode&1?(U$2=(h=U$2)||b,dk(i,e),U$2=h):dk(i,e),fk(e),o&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!b&&e.mode&1)for(V$1=e,b=e.child;b!==null;){for(g=V$1=b;V$1!==null;){switch(st=V$1,$t=st.child,st.tag){case 0:case 11:case 14:case 15:Qj(4,st,st.return);break;case 1:Mj(st,st.return);var vt=st.stateNode;if(typeof vt.componentWillUnmount=="function"){o=st,a=st.return;try{i=o,vt.props=i.memoizedProps,vt.state=i.memoizedState,vt.componentWillUnmount()}catch(Ft){W(o,a,Ft)}}break;case 5:Mj(st,st.return);break;case 22:if(st.memoizedState!==null){hk(g);continue}}$t!==null?($t.return=st,V$1=$t):hk(g)}b=b.sibling}e:for(b=null,g=e;;){if(g.tag===5){if(b===null){b=g;try{c=g.stateNode,h?(s=c.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):($=g.stateNode,et=g.memoizedProps.style,d=et!=null&&et.hasOwnProperty("display")?et.display:null,$.style.display=rb$1("display",d))}catch(Ft){W(e,e.return,Ft)}}}else if(g.tag===6){if(b===null)try{g.stateNode.nodeValue=h?"":g.memoizedProps}catch(Ft){W(e,e.return,Ft)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===e)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===e)break e;for(;g.sibling===null;){if(g.return===null||g.return===e)break e;b===g&&(b=null),g=g.return}b===g&&(b=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:dk(i,e),fk(e),o&4&&bk(e);break;case 21:break;default:dk(i,e),fk(e)}}function fk(e){var i=e.flags;if(i&2){try{e:{for(var a=e.return;a!==null;){if(Uj(a)){var o=a;break e}a=a.return}throw Error(p(160))}switch(o.tag){case 5:var c=o.stateNode;o.flags&32&&(ob$1(c,""),o.flags&=-33);var s=Vj(e);Xj(e,s,c);break;case 3:case 4:var d=o.stateNode.containerInfo,$=Vj(e);Wj(e,$,d);break;default:throw Error(p(161))}}catch(et){W(e,e.return,et)}e.flags&=-3}i&4096&&(e.flags&=-4097)}function ik(e,i,a){V$1=e,jk(e)}function jk(e,i,a){for(var o=(e.mode&1)!==0;V$1!==null;){var c=V$1,s=c.child;if(c.tag===22&&o){var d=c.memoizedState!==null||Kj;if(!d){var $=c.alternate,et=$!==null&&$.memoizedState!==null||U$2;$=Kj;var h=U$2;if(Kj=d,(U$2=et)&&!h)for(V$1=c;V$1!==null;)d=V$1,et=d.child,d.tag===22&&d.memoizedState!==null?kk(c):et!==null?(et.return=d,V$1=et):kk(c);for(;s!==null;)V$1=s,jk(s),s=s.sibling;V$1=c,Kj=$,U$2=h}lk(e)}else c.subtreeFlags&8772&&s!==null?(s.return=c,V$1=s):lk(e)}}function lk(e){for(;V$1!==null;){var i=V$1;if(i.flags&8772){var a=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:U$2||Rj(5,i);break;case 1:var o=i.stateNode;if(i.flags&4&&!U$2)if(a===null)o.componentDidMount();else{var c=i.elementType===i.type?a.memoizedProps:Lg(i.type,a.memoizedProps);o.componentDidUpdate(c,a.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var s=i.updateQueue;s!==null&&ih$1(i,s,o);break;case 3:var d=i.updateQueue;if(d!==null){if(a=null,i.child!==null)switch(i.child.tag){case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}ih$1(i,d,a)}break;case 5:var $=i.stateNode;if(a===null&&i.flags&4){a=$;var et=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":et.autoFocus&&a.focus();break;case"img":et.src&&(a.src=et.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var h=i.alternate;if(h!==null){var b=h.memoizedState;if(b!==null){var g=b.dehydrated;g!==null&&bd$1(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U$2||i.flags&512&&Sj(i)}catch(st){W(i,i.return,st)}}if(i===e){V$1=null;break}if(a=i.sibling,a!==null){a.return=i.return,V$1=a;break}V$1=i.return}}function hk(e){for(;V$1!==null;){var i=V$1;if(i===e){V$1=null;break}var a=i.sibling;if(a!==null){a.return=i.return,V$1=a;break}V$1=i.return}}function kk(e){for(;V$1!==null;){var i=V$1;try{switch(i.tag){case 0:case 11:case 15:var a=i.return;try{Rj(4,i)}catch(et){W(i,a,et)}break;case 1:var o=i.stateNode;if(typeof o.componentDidMount=="function"){var c=i.return;try{o.componentDidMount()}catch(et){W(i,c,et)}}var s=i.return;try{Sj(i)}catch(et){W(i,s,et)}break;case 5:var d=i.return;try{Sj(i)}catch(et){W(i,d,et)}}}catch(et){W(i,i.return,et)}if(i===e){V$1=null;break}var $=i.sibling;if($!==null){$.return=i.return,V$1=$;break}V$1=i.return}}var mk=Math.ceil,nk=ua$2.ReactCurrentDispatcher,ok=ua$2.ReactCurrentOwner,pk=ua$2.ReactCurrentBatchConfig,K$1=0,R$1=null,Y=null,Z$1=0,gj=0,fj=Uf$1(0),T=0,qk=null,hh$1=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi$2=!1,Qi$2=null,Si$1=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L$1(){return K$1&6?B$1():Bk!==-1?Bk:Bk=B$1()}function lh$1(e){return e.mode&1?K$1&2&&Z$1!==0?Z$1&-Z$1:Kg.transition!==null?(Ck===0&&(Ck=yc$2()),Ck):(e=C,e!==0||(e=window.event,e=e===void 0?16:jd$2(e.type)),e):1}function mh$1(e,i,a,o){if(50<zk)throw zk=0,Ak=null,Error(p(185));Ac$2(e,a,o),(!(K$1&2)||e!==R$1)&&(e===R$1&&(!(K$1&2)&&(rk|=a),T===4&&Dk(e,Z$1)),Ek(e,o),a===1&&K$1===0&&!(i.mode&1)&&(Hj=B$1()+500,fg$1&&jg()))}function Ek(e,i){var a=e.callbackNode;wc$2(e,i);var o=uc$2(e,e===R$1?Z$1:0);if(o===0)a!==null&&bc$2(a),e.callbackNode=null,e.callbackPriority=0;else if(i=o&-o,e.callbackPriority!==i){if(a!=null&&bc$2(a),i===1)e.tag===0?ig$1(Fk.bind(null,e)):hg$1(Fk.bind(null,e)),Jf$1(function(){!(K$1&6)&&jg()}),a=null;else{switch(Dc$2(o)){case 1:a=fc$2;break;case 4:a=gc$2;break;case 16:a=hc$1;break;case 536870912:a=jc$2;break;default:a=hc$1}a=Gk(a,Hk.bind(null,e))}e.callbackPriority=i,e.callbackNode=a}}function Hk(e,i){if(Bk=-1,Ck=0,K$1&6)throw Error(p(327));var a=e.callbackNode;if(Ik()&&e.callbackNode!==a)return null;var o=uc$2(e,e===R$1?Z$1:0);if(o===0)return null;if(o&30||o&e.expiredLanes||i)i=Jk(e,o);else{i=o;var c=K$1;K$1|=2;var s=Kk();(R$1!==e||Z$1!==i)&&(vk=null,Hj=B$1()+500,Lk(e,i));do try{Mk();break}catch($){Nk(e,$)}while(1);Qg(),nk.current=s,K$1=c,Y!==null?i=0:(R$1=null,Z$1=0,i=T)}if(i!==0){if(i===2&&(c=xc$2(e),c!==0&&(o=c,i=Ok(e,c))),i===1)throw a=qk,Lk(e,0),Dk(e,o),Ek(e,B$1()),a;if(i===6)Dk(e,o);else{if(c=e.current.alternate,!(o&30)&&!Pk(c)&&(i=Jk(e,o),i===2&&(s=xc$2(e),s!==0&&(o=s,i=Ok(e,s))),i===1))throw a=qk,Lk(e,0),Dk(e,o),Ek(e,B$1()),a;switch(e.finishedWork=c,e.finishedLanes=o,i){case 0:case 1:throw Error(p(345));case 2:Qk(e,uk,vk);break;case 3:if(Dk(e,o),(o&130023424)===o&&(i=gk+500-B$1(),10<i)){if(uc$2(e,0)!==0)break;if(c=e.suspendedLanes,(c&o)!==o){L$1(),e.pingedLanes|=e.suspendedLanes&c;break}e.timeoutHandle=Ff$1(Qk.bind(null,e,uk,vk),i);break}Qk(e,uk,vk);break;case 4:if(Dk(e,o),(o&4194240)===o)break;for(i=e.eventTimes,c=-1;0<o;){var d=31-oc$2(o);s=1<<d,d=i[d],d>c&&(c=d),o&=~s}if(o=c,o=B$1()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*mk(o/1960))-o,10<o){e.timeoutHandle=Ff$1(Qk.bind(null,e,uk,vk),o);break}Qk(e,uk,vk);break;case 5:Qk(e,uk,vk);break;default:throw Error(p(329))}}}return Ek(e,B$1()),e.callbackNode===a?Hk.bind(null,e):null}function Ok(e,i){var a=tk;return e.current.memoizedState.isDehydrated&&(Lk(e,i).flags|=256),e=Jk(e,i),e!==2&&(i=uk,uk=a,i!==null&&Gj(i)),e}function Gj(e){uk===null?uk=e:uk.push.apply(uk,e)}function Pk(e){for(var i=e;;){if(i.flags&16384){var a=i.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var o=0;o<a.length;o++){var c=a[o],s=c.getSnapshot;c=c.value;try{if(!He(s(),c))return!1}catch{return!1}}}if(a=i.child,i.subtreeFlags&16384&&a!==null)a.return=i,i=a;else{if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Dk(e,i){for(i&=~sk,i&=~rk,e.suspendedLanes|=i,e.pingedLanes&=~i,e=e.expirationTimes;0<i;){var a=31-oc$2(i),o=1<<a;e[a]=-1,i&=~o}}function Fk(e){if(K$1&6)throw Error(p(327));Ik();var i=uc$2(e,0);if(!(i&1))return Ek(e,B$1()),null;var a=Jk(e,i);if(e.tag!==0&&a===2){var o=xc$2(e);o!==0&&(i=o,a=Ok(e,o))}if(a===1)throw a=qk,Lk(e,0),Dk(e,i),Ek(e,B$1()),a;if(a===6)throw Error(p(345));return e.finishedWork=e.current.alternate,e.finishedLanes=i,Qk(e,uk,vk),Ek(e,B$1()),null}function Rk(e,i){var a=K$1;K$1|=1;try{return e(i)}finally{K$1=a,K$1===0&&(Hj=B$1()+500,fg$1&&jg())}}function Sk(e){xk!==null&&xk.tag===0&&!(K$1&6)&&Ik();var i=K$1;K$1|=1;var a=pk.transition,o=C;try{if(pk.transition=null,C=1,e)return e()}finally{C=o,pk.transition=a,K$1=i,!(K$1&6)&&jg()}}function Ij(){gj=fj.current,E(fj)}function Lk(e,i){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;if(a!==-1&&(e.timeoutHandle=-1,Gf$1(a)),Y!==null)for(a=Y.return;a!==null;){var o=a;switch(wg$1(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&$f$1();break;case 3:Jh$1(),E(Wf$1),E(H$1),Oh$1();break;case 5:Lh$1(o);break;case 4:Jh$1();break;case 13:E(M$1);break;case 19:E(M$1);break;case 10:Rg(o.type._context);break;case 22:case 23:Ij()}a=a.return}if(R$1=e,Y=e=wh$1(e.current,null),Z$1=gj=i,T=0,qk=null,sk=rk=hh$1=0,uk=tk=null,Wg!==null){for(i=0;i<Wg.length;i++)if(a=Wg[i],o=a.interleaved,o!==null){a.interleaved=null;var c=o.next,s=a.pending;if(s!==null){var d=s.next;s.next=c,o.next=d}a.pending=o}Wg=null}return e}function Nk(e,i){do{var a=Y;try{if(Qg(),Ph$1.current=ai$1,Sh$1){for(var o=N.memoizedState;o!==null;){var c=o.queue;c!==null&&(c.pending=null),o=o.next}Sh$1=!1}if(Rh$1=0,P=O=N=null,Th$1=!1,Uh$1=0,ok.current=null,a===null||a.return===null){T=1,qk=i,Y=null;break}e:{var s=e,d=a.return,$=a,et=i;if(i=Z$1,$.flags|=32768,et!==null&&typeof et=="object"&&typeof et.then=="function"){var h=et,b=$,g=b.tag;if(!(b.mode&1)&&(g===0||g===11||g===15)){var st=b.alternate;st?(b.updateQueue=st.updateQueue,b.memoizedState=st.memoizedState,b.lanes=st.lanes):(b.updateQueue=null,b.memoizedState=null)}var $t=Vi$1(d);if($t!==null){$t.flags&=-257,Wi$2($t,d,$,s,i),$t.mode&1&&Ti$1(s,h,i),i=$t,et=h;var vt=i.updateQueue;if(vt===null){var Ft=new Set;Ft.add(et),i.updateQueue=Ft}else vt.add(et);break e}else{if(!(i&1)){Ti$1(s,h,i),uj();break e}et=Error(p(426))}}else if(I&&$.mode&1){var Gt=Vi$1(d);if(Gt!==null){!(Gt.flags&65536)&&(Gt.flags|=256),Wi$2(Gt,d,$,s,i),Jg(Ki$2(et,$));break e}}s=et=Ki$2(et,$),T!==4&&(T=2),tk===null?tk=[s]:tk.push(s),s=d;do{switch(s.tag){case 3:s.flags|=65536,i&=-i,s.lanes|=i;var qt=Oi$2(s,et,i);fh(s,qt);break e;case 1:$=et;var Lt=s.type,rr=s.stateNode;if(!(s.flags&128)&&(typeof Lt.getDerivedStateFromError=="function"||rr!==null&&typeof rr.componentDidCatch=="function"&&(Si$1===null||!Si$1.has(rr)))){s.flags|=65536,i&=-i,s.lanes|=i;var jr=Ri$2(s,$,i);fh(s,jr);break e}}s=s.return}while(s!==null)}Tk(a)}catch(Hr){i=Hr,Y===a&&a!==null&&(Y=a=a.return);continue}break}while(1)}function Kk(){var e=nk.current;return nk.current=ai$1,e===null?ai$1:e}function uj(){(T===0||T===3||T===2)&&(T=4),R$1===null||!(hh$1&268435455)&&!(rk&268435455)||Dk(R$1,Z$1)}function Jk(e,i){var a=K$1;K$1|=2;var o=Kk();(R$1!==e||Z$1!==i)&&(vk=null,Lk(e,i));do try{Uk();break}catch(c){Nk(e,c)}while(1);if(Qg(),K$1=a,nk.current=o,Y!==null)throw Error(p(261));return R$1=null,Z$1=0,T}function Uk(){for(;Y!==null;)Vk(Y)}function Mk(){for(;Y!==null&&!cc$2();)Vk(Y)}function Vk(e){var i=Wk(e.alternate,e,gj);e.memoizedProps=e.pendingProps,i===null?Tk(e):Y=i,ok.current=null}function Tk(e){var i=e;do{var a=i.alternate;if(e=i.return,i.flags&32768){if(a=Jj(a,i),a!==null){a.flags&=32767,Y=a;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{T=6,Y=null;return}}else if(a=Fj(a,i,gj),a!==null){Y=a;return}if(i=i.sibling,i!==null){Y=i;return}Y=i=e}while(i!==null);T===0&&(T=5)}function Qk(e,i,a){var o=C,c=pk.transition;try{pk.transition=null,C=1,Xk(e,i,a,o)}finally{pk.transition=c,C=o}return null}function Xk(e,i,a,o){do Ik();while(xk!==null);if(K$1&6)throw Error(p(327));a=e.finishedWork;var c=e.finishedLanes;if(a===null)return null;if(e.finishedWork=null,e.finishedLanes=0,a===e.current)throw Error(p(177));e.callbackNode=null,e.callbackPriority=0;var s=a.lanes|a.childLanes;if(Bc$2(e,s),e===R$1&&(Y=R$1=null,Z$1=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||wk||(wk=!0,Gk(hc$1,function(){return Ik(),null})),s=(a.flags&15990)!==0,a.subtreeFlags&15990||s){s=pk.transition,pk.transition=null;var d=C;C=1;var $=K$1;K$1|=4,ok.current=null,Pj(e,a),ek(a,e),Oe(Df$1),dd$2=!!Cf$1,Df$1=Cf$1=null,e.current=a,ik(a),dc$2(),K$1=$,C=d,pk.transition=s}else e.current=a;if(wk&&(wk=!1,xk=e,yk=c),s=e.pendingLanes,s===0&&(Si$1=null),mc$2(a.stateNode),Ek(e,B$1()),i!==null)for(o=e.onRecoverableError,a=0;a<i.length;a++)c=i[a],o(c.value,{componentStack:c.stack,digest:c.digest});if(Pi$2)throw Pi$2=!1,e=Qi$2,Qi$2=null,e;return yk&1&&e.tag!==0&&Ik(),s=e.pendingLanes,s&1?e===Ak?zk++:(zk=0,Ak=e):zk=0,jg(),null}function Ik(){if(xk!==null){var e=Dc$2(yk),i=pk.transition,a=C;try{if(pk.transition=null,C=16>e?16:e,xk===null)var o=!1;else{if(e=xk,xk=null,yk=0,K$1&6)throw Error(p(331));var c=K$1;for(K$1|=4,V$1=e.current;V$1!==null;){var s=V$1,d=s.child;if(V$1.flags&16){var $=s.deletions;if($!==null){for(var et=0;et<$.length;et++){var h=$[et];for(V$1=h;V$1!==null;){var b=V$1;switch(b.tag){case 0:case 11:case 15:Qj(8,b,s)}var g=b.child;if(g!==null)g.return=b,V$1=g;else for(;V$1!==null;){b=V$1;var st=b.sibling,$t=b.return;if(Tj(b),b===h){V$1=null;break}if(st!==null){st.return=$t,V$1=st;break}V$1=$t}}}var vt=s.alternate;if(vt!==null){var Ft=vt.child;if(Ft!==null){vt.child=null;do{var Gt=Ft.sibling;Ft.sibling=null,Ft=Gt}while(Ft!==null)}}V$1=s}}if(s.subtreeFlags&2064&&d!==null)d.return=s,V$1=d;else e:for(;V$1!==null;){if(s=V$1,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Qj(9,s,s.return)}var qt=s.sibling;if(qt!==null){qt.return=s.return,V$1=qt;break e}V$1=s.return}}var Lt=e.current;for(V$1=Lt;V$1!==null;){d=V$1;var rr=d.child;if(d.subtreeFlags&2064&&rr!==null)rr.return=d,V$1=rr;else e:for(d=Lt;V$1!==null;){if($=V$1,$.flags&2048)try{switch($.tag){case 0:case 11:case 15:Rj(9,$)}}catch(Hr){W($,$.return,Hr)}if($===d){V$1=null;break e}var jr=$.sibling;if(jr!==null){jr.return=$.return,V$1=jr;break e}V$1=$.return}}if(K$1=c,jg(),lc$2&&typeof lc$2.onPostCommitFiberRoot=="function")try{lc$2.onPostCommitFiberRoot(kc$2,e)}catch{}o=!0}return o}finally{C=a,pk.transition=i}}return!1}function Yk(e,i,a){i=Ki$2(a,i),i=Oi$2(e,i,1),e=dh$1(e,i,1),i=L$1(),e!==null&&(Ac$2(e,1,i),Ek(e,i))}function W(e,i,a){if(e.tag===3)Yk(e,e,a);else for(;i!==null;){if(i.tag===3){Yk(i,e,a);break}else if(i.tag===1){var o=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Si$1===null||!Si$1.has(o))){e=Ki$2(a,e),e=Ri$2(i,e,1),i=dh$1(i,e,1),e=L$1(),i!==null&&(Ac$2(i,1,e),Ek(i,e));break}}i=i.return}}function Ui$2(e,i,a){var o=e.pingCache;o!==null&&o.delete(i),i=L$1(),e.pingedLanes|=e.suspendedLanes&a,R$1===e&&(Z$1&a)===a&&(T===4||T===3&&(Z$1&130023424)===Z$1&&500>B$1()-gk?Lk(e,0):sk|=a),Ek(e,i)}function Zk(e,i){i===0&&(e.mode&1?(i=sc$2,sc$2<<=1,!(sc$2&130023424)&&(sc$2=4194304)):i=1);var a=L$1();e=Zg(e,i),e!==null&&(Ac$2(e,i,a),Ek(e,a))}function vj(e){var i=e.memoizedState,a=0;i!==null&&(a=i.retryLane),Zk(e,a)}function ck(e,i){var a=0;switch(e.tag){case 13:var o=e.stateNode,c=e.memoizedState;c!==null&&(a=c.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(p(314))}o!==null&&o.delete(i),Zk(e,a)}var Wk;Wk=function(e,i,a){if(e!==null)if(e.memoizedProps!==i.pendingProps||Wf$1.current)Ug=!0;else{if(!(e.lanes&a)&&!(i.flags&128))return Ug=!1,zj(e,i,a);Ug=!!(e.flags&131072)}else Ug=!1,I&&i.flags&1048576&&ug$1(i,ng$1,i.index);switch(i.lanes=0,i.tag){case 2:var o=i.type;jj(e,i),e=i.pendingProps;var c=Yf$1(i,H$1.current);Tg$1(i,a),c=Xh$1(null,i,o,e,c,a);var s=bi$1();return i.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Zf$1(o)?(s=!0,cg$1(i)):s=!1,i.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,ah(i),c.updater=nh$1,i.stateNode=c,c._reactInternals=i,rh$1(i,o,e,a),i=kj(null,i,o,!0,s,a)):(i.tag=0,I&&s&&vg$1(i),Yi$2(null,i,c,a),i=i.child),i;case 16:o=i.elementType;e:{switch(jj(e,i),e=i.pendingProps,c=o._init,o=c(o._payload),i.type=o,c=i.tag=$k(o),e=Lg(o,e),c){case 0:i=dj(null,i,o,e,a);break e;case 1:i=ij(null,i,o,e,a);break e;case 11:i=Zi$2(null,i,o,e,a);break e;case 14:i=aj(null,i,o,Lg(o.type,e),a);break e}throw Error(p(306,o,""))}return i;case 0:return o=i.type,c=i.pendingProps,c=i.elementType===o?c:Lg(o,c),dj(e,i,o,c,a);case 1:return o=i.type,c=i.pendingProps,c=i.elementType===o?c:Lg(o,c),ij(e,i,o,c,a);case 3:e:{if(lj(i),e===null)throw Error(p(387));o=i.pendingProps,s=i.memoizedState,c=s.element,bh$1(e,i),gh$1(i,o,null,a);var d=i.memoizedState;if(o=d.element,s.isDehydrated)if(s={element:o,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},i.updateQueue.baseState=s,i.memoizedState=s,i.flags&256){c=Ki$2(Error(p(423)),i),i=mj(e,i,o,a,c);break e}else if(o!==c){c=Ki$2(Error(p(424)),i),i=mj(e,i,o,a,c);break e}else for(yg=Lf$1(i.stateNode.containerInfo.firstChild),xg$1=i,I=!0,zg=null,a=Ch$1(i,null,o,a),i.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(Ig(),o===c){i=$i$1(e,i,a);break e}Yi$2(e,i,o,a)}i=i.child}return i;case 5:return Kh$1(i),e===null&&Eg(i),o=i.type,c=i.pendingProps,s=e!==null?e.memoizedProps:null,d=c.children,Ef$1(o,c)?d=null:s!==null&&Ef$1(o,s)&&(i.flags|=32),hj(e,i),Yi$2(e,i,d,a),i.child;case 6:return e===null&&Eg(i),null;case 13:return pj(e,i,a);case 4:return Ih(i,i.stateNode.containerInfo),o=i.pendingProps,e===null?i.child=Bh$1(i,null,o,a):Yi$2(e,i,o,a),i.child;case 11:return o=i.type,c=i.pendingProps,c=i.elementType===o?c:Lg(o,c),Zi$2(e,i,o,c,a);case 7:return Yi$2(e,i,i.pendingProps,a),i.child;case 8:return Yi$2(e,i,i.pendingProps.children,a),i.child;case 12:return Yi$2(e,i,i.pendingProps.children,a),i.child;case 10:e:{if(o=i.type._context,c=i.pendingProps,s=i.memoizedProps,d=c.value,G(Mg,o._currentValue),o._currentValue=d,s!==null)if(He(s.value,d)){if(s.children===c.children&&!Wf$1.current){i=$i$1(e,i,a);break e}}else for(s=i.child,s!==null&&(s.return=i);s!==null;){var $=s.dependencies;if($!==null){d=s.child;for(var et=$.firstContext;et!==null;){if(et.context===o){if(s.tag===1){et=ch$1(-1,a&-a),et.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var b=h.pending;b===null?et.next=et:(et.next=b.next,b.next=et),h.pending=et}}s.lanes|=a,et=s.alternate,et!==null&&(et.lanes|=a),Sg(s.return,a,i),$.lanes|=a;break}et=et.next}}else if(s.tag===10)d=s.type===i.type?null:s.child;else if(s.tag===18){if(d=s.return,d===null)throw Error(p(341));d.lanes|=a,$=d.alternate,$!==null&&($.lanes|=a),Sg(d,a,i),d=s.sibling}else d=s.child;if(d!==null)d.return=s;else for(d=s;d!==null;){if(d===i){d=null;break}if(s=d.sibling,s!==null){s.return=d.return,d=s;break}d=d.return}s=d}Yi$2(e,i,c.children,a),i=i.child}return i;case 9:return c=i.type,o=i.pendingProps.children,Tg$1(i,a),c=Vg(c),o=o(c),i.flags|=1,Yi$2(e,i,o,a),i.child;case 14:return o=i.type,c=Lg(o,i.pendingProps),c=Lg(o.type,c),aj(e,i,o,c,a);case 15:return cj(e,i,i.type,i.pendingProps,a);case 17:return o=i.type,c=i.pendingProps,c=i.elementType===o?c:Lg(o,c),jj(e,i),i.tag=1,Zf$1(o)?(e=!0,cg$1(i)):e=!1,Tg$1(i,a),ph$1(i,o,c),rh$1(i,o,c,a),kj(null,i,o,!0,e,a);case 19:return yj(e,i,a);case 22:return ej(e,i,a)}throw Error(p(156,i.tag))};function Gk(e,i){return ac$2(e,i)}function al$2(e,i,a,o){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(e,i,a,o){return new al$2(e,i,a,o)}function bj(e){return e=e.prototype,!(!e||!e.isReactComponent)}function $k(e){if(typeof e=="function")return bj(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Da$1)return 11;if(e===Ga$1)return 14}return 2}function wh$1(e,i){var a=e.alternate;return a===null?(a=Bg(e.tag,i,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=i,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&14680064,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,i=e.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a}function yh$1(e,i,a,o,c,s){var d=2;if(o=e,typeof e=="function")bj(e)&&(d=1);else if(typeof e=="string")d=5;else e:switch(e){case ya$1:return Ah$1(a.children,c,s,i);case za$1:d=8,c|=8;break;case Aa$1:return e=Bg(12,a,i,c|2),e.elementType=Aa$1,e.lanes=s,e;case Ea$1:return e=Bg(13,a,i,c),e.elementType=Ea$1,e.lanes=s,e;case Fa$1:return e=Bg(19,a,i,c),e.elementType=Fa$1,e.lanes=s,e;case Ia$1:return qj(a,c,s,i);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ba$1:d=10;break e;case Ca$1:d=9;break e;case Da$1:d=11;break e;case Ga$1:d=14;break e;case Ha$2:d=16,o=null;break e}throw Error(p(130,e==null?e:typeof e,""))}return i=Bg(d,a,i,c),i.elementType=e,i.type=o,i.lanes=s,i}function Ah$1(e,i,a,o){return e=Bg(7,e,o,i),e.lanes=a,e}function qj(e,i,a,o){return e=Bg(22,e,o,i),e.elementType=Ia$1,e.lanes=a,e.stateNode={isHidden:!1},e}function xh$1(e,i,a){return e=Bg(6,e,null,i),e.lanes=a,e}function zh$1(e,i,a){return i=Bg(4,e.children!==null?e.children:[],e.key,i),i.lanes=a,i.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},i}function bl$2(e,i,a,o,c){this.tag=i,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc$2(0),this.expirationTimes=zc$2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc$2(0),this.identifierPrefix=o,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function cl$2(e,i,a,o,c,s,d,$,et){return e=new bl$2(e,i,a,$,et),i===1?(i=1,s===!0&&(i|=8)):i=0,s=Bg(3,null,null,i),e.current=s,s.stateNode=e,s.memoizedState={element:o,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah(s),e}function dl$2(e,i,a){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa$1,key:o==null?null:""+o,children:e,containerInfo:i,implementation:a}}function el$2(e){if(!e)return Vf$1;e=e._reactInternals;e:{if(Vb$1(e)!==e||e.tag!==1)throw Error(p(170));var i=e;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Zf$1(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(p(171))}if(e.tag===1){var a=e.type;if(Zf$1(a))return bg$1(e,a,i)}return i}function fl$2(e,i,a,o,c,s,d,$,et){return e=cl$2(a,o,!0,e,c,s,d,$,et),e.context=el$2(null),a=e.current,o=L$1(),c=lh$1(a),s=ch$1(o,c),s.callback=i??null,dh$1(a,s,c),e.current.lanes=c,Ac$2(e,c,o),Ek(e,o),e}function gl$2(e,i,a,o){var c=i.current,s=L$1(),d=lh$1(c);return a=el$2(a),i.context===null?i.context=a:i.pendingContext=a,i=ch$1(s,d),i.payload={element:e},o=o===void 0?null:o,o!==null&&(i.callback=o),e=dh$1(c,i,d),e!==null&&(mh$1(e,c,d,s),eh$1(e,c,d)),d}function hl$2(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function il$2(e,i){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<i?a:i}}function jl$2(e,i){il$2(e,i),(e=e.alternate)&&il$2(e,i)}function kl$2(){return null}var ll$2=typeof reportError=="function"?reportError:function(e){console.error(e)};function ml$2(e){this._internalRoot=e}nl$2.prototype.render=ml$2.prototype.render=function(e){var i=this._internalRoot;if(i===null)throw Error(p(409));gl$2(e,i,null,null)};nl$2.prototype.unmount=ml$2.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var i=e.containerInfo;Sk(function(){gl$2(null,e,null,null)}),i[uf$2]=null}};function nl$2(e){this._internalRoot=e}nl$2.prototype.unstable_scheduleHydration=function(e){if(e){var i=Hc$2();e={blockedOn:null,target:e,priority:i};for(var a=0;a<Qc$2.length&&i!==0&&i<Qc$2[a].priority;a++);Qc$2.splice(a,0,e),a===0&&Vc$2(e)}};function ol$2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function pl$2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ql$2(){}function rl$2(e,i,a,o,c){if(c){if(typeof o=="function"){var s=o;o=function(){var h=hl$2(d);s.call(h)}}var d=fl$2(i,o,e,0,null,!1,!1,"",ql$2);return e._reactRootContainer=d,e[uf$2]=d.current,sf$2(e.nodeType===8?e.parentNode:e),Sk(),d}for(;c=e.lastChild;)e.removeChild(c);if(typeof o=="function"){var $=o;o=function(){var h=hl$2(et);$.call(h)}}var et=cl$2(e,0,!1,null,null,!1,!1,"",ql$2);return e._reactRootContainer=et,e[uf$2]=et.current,sf$2(e.nodeType===8?e.parentNode:e),Sk(function(){gl$2(i,et,a,o)}),et}function sl$2(e,i,a,o,c){var s=a._reactRootContainer;if(s){var d=s;if(typeof c=="function"){var $=c;c=function(){var et=hl$2(d);$.call(et)}}gl$2(i,d,e,c)}else d=rl$2(a,i,e,c,o);return hl$2(d)}Ec$2=function(e){switch(e.tag){case 3:var i=e.stateNode;if(i.current.memoizedState.isDehydrated){var a=tc$1(i.pendingLanes);a!==0&&(Cc$2(i,a|1),Ek(i,B$1()),!(K$1&6)&&(Hj=B$1()+500,jg()))}break;case 13:Sk(function(){var o=Zg(e,1);if(o!==null){var c=L$1();mh$1(o,e,1,c)}}),jl$2(e,1)}};Fc$2=function(e){if(e.tag===13){var i=Zg(e,134217728);if(i!==null){var a=L$1();mh$1(i,e,134217728,a)}jl$2(e,134217728)}};Gc$2=function(e){if(e.tag===13){var i=lh$1(e),a=Zg(e,i);if(a!==null){var o=L$1();mh$1(a,e,i,o)}jl$2(e,i)}};Hc$2=function(){return C};Ic$2=function(e,i){var a=C;try{return C=e,i()}finally{C=a}};yb$1=function(e,i,a){switch(i){case"input":if(bb$1(e,a),i=a.name,a.type==="radio"&&i!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<a.length;i++){var o=a[i];if(o!==e&&o.form===e.form){var c=Db$1(o);if(!c)throw Error(p(90));Wa$1(o),bb$1(o,c)}}}break;case"textarea":ib$1(e,a);break;case"select":i=a.value,i!=null&&fb$1(e,!!a.multiple,i,!1)}};Gb$1=Rk;Hb$1=Sk;var tl$2={usingClientEntryPoint:!1,Events:[Cb$1,ue,Db$1,Eb$1,Fb$1,Rk]},ul$2={findFiberByHostInstance:Wc$2,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl$2={bundleType:ul$2.bundleType,version:ul$2.version,rendererPackageName:ul$2.rendererPackageName,rendererConfig:ul$2.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua$2.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zb$1(e),e===null?null:e.stateNode},findFiberByHostInstance:ul$2.findFiberByHostInstance||kl$2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl$2=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl$2.isDisabled&&wl$2.supportsFiber)try{kc$2=wl$2.inject(vl$2),lc$2=wl$2}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl$2;reactDom_production_min.createPortal=function(e,i){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol$2(i))throw Error(p(200));return dl$2(e,i,null,a)};reactDom_production_min.createRoot=function(e,i){if(!ol$2(e))throw Error(p(299));var a=!1,o="",c=ll$2;return i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(o=i.identifierPrefix),i.onRecoverableError!==void 0&&(c=i.onRecoverableError)),i=cl$2(e,1,!1,null,null,a,!1,o,c),e[uf$2]=i.current,sf$2(e.nodeType===8?e.parentNode:e),new ml$2(i)};reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var i=e._reactInternals;if(i===void 0)throw typeof e.render=="function"?Error(p(188)):(e=Object.keys(e).join(","),Error(p(268,e)));return e=Zb$1(i),e=e===null?null:e.stateNode,e};reactDom_production_min.flushSync=function(e){return Sk(e)};reactDom_production_min.hydrate=function(e,i,a){if(!pl$2(i))throw Error(p(200));return sl$2(null,e,i,!0,a)};reactDom_production_min.hydrateRoot=function(e,i,a){if(!ol$2(e))throw Error(p(405));var o=a!=null&&a.hydratedSources||null,c=!1,s="",d=ll$2;if(a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(s=a.identifierPrefix),a.onRecoverableError!==void 0&&(d=a.onRecoverableError)),i=fl$2(i,null,e,1,a??null,c,!1,s,d),e[uf$2]=i.current,sf$2(e),o)for(e=0;e<o.length;e++)a=o[e],c=a._getVersion,c=c(a._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[a,c]:i.mutableSourceEagerHydrationData.push(a,c);return new nl$2(i)};reactDom_production_min.render=function(e,i,a){if(!pl$2(i))throw Error(p(200));return sl$2(null,e,i,!1,a)};reactDom_production_min.unmountComponentAtNode=function(e){if(!pl$2(e))throw Error(p(40));return e._reactRootContainer?(Sk(function(){sl$2(null,null,e,!1,function(){e._reactRootContainer=null,e[uf$2]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,i,a,o){if(!pl$2(a))throw Error(p(200));if(e==null||e._reactInternals===void 0)throw Error(p(38));return sl$2(e,i,a,!1,o)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(e){console.error(e)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;const index="";/**
 * @remix-run/router v1.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},_extends$2.apply(this,arguments)}var Action;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createHashHistory(e){e===void 0&&(e={});function i(c,s){let{pathname:d="/",search:$="",hash:et=""}=parsePath(c.location.hash.substr(1));return!d.startsWith("/")&&!d.startsWith(".")&&(d="/"+d),createLocation("",{pathname:d,search:$,hash:et},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function a(c,s){let d=c.document.querySelector("base"),$="";if(d&&d.getAttribute("href")){let et=c.location.href,h=et.indexOf("#");$=h===-1?et:et.slice(0,h)}return $+"#"+(typeof s=="string"?s:createPath(s))}function o(c,s){warning(c.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return getUrlBasedHistory(i,a,o,e)}function invariant(e,i){if(e===!1||e===null||typeof e>"u")throw new Error(i)}function warning(e,i){if(!e){typeof console<"u"&&console.warn(i);try{throw new Error(i)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(e,i){return{usr:e.state,key:e.key,idx:i}}function createLocation(e,i,a,o){return a===void 0&&(a=null),_extends$2({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof i=="string"?parsePath(i):i,{state:a,key:i&&i.key||o||createKey()})}function createPath(e){let{pathname:i="/",search:a="",hash:o=""}=e;return a&&a!=="?"&&(i+=a.charAt(0)==="?"?a:"?"+a),o&&o!=="#"&&(i+=o.charAt(0)==="#"?o:"#"+o),i}function parsePath(e){let i={};if(e){let a=e.indexOf("#");a>=0&&(i.hash=e.substr(a),e=e.substr(0,a));let o=e.indexOf("?");o>=0&&(i.search=e.substr(o),e=e.substr(0,o)),e&&(i.pathname=e)}return i}function getUrlBasedHistory(e,i,a,o){o===void 0&&(o={});let{window:c=document.defaultView,v5Compat:s=!1}=o,d=c.history,$=Action.Pop,et=null,h=b();h==null&&(h=0,d.replaceState(_extends$2({},d.state,{idx:h}),""));function b(){return(d.state||{idx:null}).idx}function g(){$=Action.Pop;let Gt=b(),qt=Gt==null?null:Gt-h;h=Gt,et&&et({action:$,location:Ft.location,delta:qt})}function st(Gt,qt){$=Action.Push;let Lt=createLocation(Ft.location,Gt,qt);a&&a(Lt,Gt),h=b()+1;let rr=getHistoryState(Lt,h),jr=Ft.createHref(Lt);try{d.pushState(rr,"",jr)}catch(Hr){if(Hr instanceof DOMException&&Hr.name==="DataCloneError")throw Hr;c.location.assign(jr)}s&&et&&et({action:$,location:Ft.location,delta:1})}function $t(Gt,qt){$=Action.Replace;let Lt=createLocation(Ft.location,Gt,qt);a&&a(Lt,Gt),h=b();let rr=getHistoryState(Lt,h),jr=Ft.createHref(Lt);d.replaceState(rr,"",jr),s&&et&&et({action:$,location:Ft.location,delta:0})}function vt(Gt){let qt=c.location.origin!=="null"?c.location.origin:c.location.href,Lt=typeof Gt=="string"?Gt:createPath(Gt);return invariant(qt,"No window.location.(origin|href) available to create URL for href: "+Lt),new URL(Lt,qt)}let Ft={get action(){return $},get location(){return e(c,d)},listen(Gt){if(et)throw new Error("A history only accepts one active listener");return c.addEventListener(PopStateEventType,g),et=Gt,()=>{c.removeEventListener(PopStateEventType,g),et=null}},createHref(Gt){return i(c,Gt)},createURL:vt,encodeLocation(Gt){let qt=vt(Gt);return{pathname:qt.pathname,search:qt.search,hash:qt.hash}},push:st,replace:$t,go(Gt){return d.go(Gt)}};return Ft}var ResultType;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(ResultType||(ResultType={}));function matchRoutes(e,i,a){a===void 0&&(a="/");let o=typeof i=="string"?parsePath(i):i,c=stripBasename(o.pathname||"/",a);if(c==null)return null;let s=flattenRoutes(e);rankRouteBranches(s);let d=null;for(let $=0;d==null&&$<s.length;++$)d=matchRouteBranch(s[$],safelyDecodeURI(c));return d}function flattenRoutes(e,i,a,o){i===void 0&&(i=[]),a===void 0&&(a=[]),o===void 0&&(o="");let c=(s,d,$)=>{let et={relativePath:$===void 0?s.path||"":$,caseSensitive:s.caseSensitive===!0,childrenIndex:d,route:s};et.relativePath.startsWith("/")&&(invariant(et.relativePath.startsWith(o),'Absolute route path "'+et.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),et.relativePath=et.relativePath.slice(o.length));let h=joinPaths([o,et.relativePath]),b=a.concat(et);s.children&&s.children.length>0&&(invariant(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),flattenRoutes(s.children,i,b,h)),!(s.path==null&&!s.index)&&i.push({path:h,score:computeScore(h,s.index),routesMeta:b})};return e.forEach((s,d)=>{var $;if(s.path===""||!(($=s.path)!=null&&$.includes("?")))c(s,d);else for(let et of explodeOptionalSegments(s.path))c(s,d,et)}),i}function explodeOptionalSegments(e){let i=e.split("/");if(i.length===0)return[];let[a,...o]=i,c=a.endsWith("?"),s=a.replace(/\?$/,"");if(o.length===0)return c?[s,""]:[s];let d=explodeOptionalSegments(o.join("/")),$=[];return $.push(...d.map(et=>et===""?s:[s,et].join("/"))),c&&$.push(...d),$.map(et=>e.startsWith("/")&&et===""?"/":et)}function rankRouteBranches(e){e.sort((i,a)=>i.score!==a.score?a.score-i.score:compareIndexes(i.routesMeta.map(o=>o.childrenIndex),a.routesMeta.map(o=>o.childrenIndex)))}const paramRe=/^:\w+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=e=>e==="*";function computeScore(e,i){let a=e.split("/"),o=a.length;return a.some(isSplat)&&(o+=splatPenalty),i&&(o+=indexRouteValue),a.filter(c=>!isSplat(c)).reduce((c,s)=>c+(paramRe.test(s)?dynamicSegmentValue:s===""?emptySegmentValue:staticSegmentValue),o)}function compareIndexes(e,i){return e.length===i.length&&e.slice(0,-1).every((o,c)=>o===i[c])?e[e.length-1]-i[i.length-1]:0}function matchRouteBranch(e,i){let{routesMeta:a}=e,o={},c="/",s=[];for(let d=0;d<a.length;++d){let $=a[d],et=d===a.length-1,h=c==="/"?i:i.slice(c.length)||"/",b=matchPath({path:$.relativePath,caseSensitive:$.caseSensitive,end:et},h);if(!b)return null;Object.assign(o,b.params);let g=$.route;s.push({params:o,pathname:joinPaths([c,b.pathname]),pathnameBase:normalizePathname(joinPaths([c,b.pathnameBase])),route:g}),b.pathnameBase!=="/"&&(c=joinPaths([c,b.pathnameBase]))}return s}function matchPath(e,i){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[a,o]=compilePath(e.path,e.caseSensitive,e.end),c=i.match(a);if(!c)return null;let s=c[0],d=s.replace(/(.)\/+$/,"$1"),$=c.slice(1);return{params:o.reduce((h,b,g)=>{if(b==="*"){let st=$[g]||"";d=s.slice(0,s.length-st.length).replace(/(.)\/+$/,"$1")}return h[b]=safelyDecodeURIComponent($[g]||"",b),h},{}),pathname:s,pathnameBase:d,pattern:e}}function compilePath(e,i,a){i===void 0&&(i=!1),a===void 0&&(a=!0),warning(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let o=[],c="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(d,$)=>(o.push($),"/([^\\/]+)"));return e.endsWith("*")?(o.push("*"),c+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?c+="\\/*$":e!==""&&e!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,i?void 0:"i"),o]}function safelyDecodeURI(e){try{return decodeURI(e)}catch(i){return warning(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+i+").")),e}}function safelyDecodeURIComponent(e,i){try{return decodeURIComponent(e)}catch(a){return warning(!1,'The value for the URL param "'+i+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+a+").")),e}}function stripBasename(e,i){if(i==="/")return e;if(!e.toLowerCase().startsWith(i.toLowerCase()))return null;let a=i.endsWith("/")?i.length-1:i.length,o=e.charAt(a);return o&&o!=="/"?null:e.slice(a)||"/"}function resolvePath(e,i){i===void 0&&(i="/");let{pathname:a,search:o="",hash:c=""}=typeof e=="string"?parsePath(e):e;return{pathname:a?a.startsWith("/")?a:resolvePathname(a,i):i,search:normalizeSearch(o),hash:normalizeHash(c)}}function resolvePathname(e,i){let a=i.replace(/\/+$/,"").split("/");return e.split("/").forEach(c=>{c===".."?a.length>1&&a.pop():c!=="."&&a.push(c)}),a.length>1?a.join("/"):"/"}function getInvalidPathError(e,i,a,o){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+i+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(e){return e.filter((i,a)=>a===0||i.route.path&&i.route.path.length>0)}function resolveTo(e,i,a,o){o===void 0&&(o=!1);let c;typeof e=="string"?c=parsePath(e):(c=_extends$2({},e),invariant(!c.pathname||!c.pathname.includes("?"),getInvalidPathError("?","pathname","search",c)),invariant(!c.pathname||!c.pathname.includes("#"),getInvalidPathError("#","pathname","hash",c)),invariant(!c.search||!c.search.includes("#"),getInvalidPathError("#","search","hash",c)));let s=e===""||c.pathname==="",d=s?"/":c.pathname,$;if(o||d==null)$=a;else{let g=i.length-1;if(d.startsWith("..")){let st=d.split("/");for(;st[0]==="..";)st.shift(),g-=1;c.pathname=st.join("/")}$=g>=0?i[g]:"/"}let et=resolvePath(c,$),h=d&&d!=="/"&&d.endsWith("/"),b=(s||d===".")&&a.endsWith("/");return!et.pathname.endsWith("/")&&(h||b)&&(et.pathname+="/"),et}const joinPaths=e=>e.join("/").replace(/\/\/+/g,"/"),normalizePathname=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,normalizeHash=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function isRouteErrorResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},_extends$1.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext$1=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(e,i){let{relative:a}=i===void 0?{}:i;useInRouterContext()||invariant(!1);let{basename:o,navigator:c}=reactExports.useContext(NavigationContext$1),{hash:s,pathname:d,search:$}=useResolvedPath(e,{relative:a}),et=d;return o!=="/"&&(et=d==="/"?o:joinPaths([o,d])),c.createHref({pathname:et,search:$,hash:s})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect$1(e){reactExports.useContext(NavigationContext$1).static||reactExports.useLayoutEffect(e)}function useNavigate(){let{isDataRoute:e}=reactExports.useContext(RouteContext);return e?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant(!1);let e=reactExports.useContext(DataRouterContext),{basename:i,navigator:a}=reactExports.useContext(NavigationContext$1),{matches:o}=reactExports.useContext(RouteContext),{pathname:c}=useLocation(),s=JSON.stringify(getPathContributingMatches(o).map(et=>et.pathnameBase)),d=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{d.current=!0}),reactExports.useCallback(function(et,h){if(h===void 0&&(h={}),!d.current)return;if(typeof et=="number"){a.go(et);return}let b=resolveTo(et,JSON.parse(s),c,h.relative==="path");e==null&&i!=="/"&&(b.pathname=b.pathname==="/"?i:joinPaths([i,b.pathname])),(h.replace?a.replace:a.push)(b,h.state,h)},[i,a,s,c,e])}function useParams(){let{matches:e}=reactExports.useContext(RouteContext),i=e[e.length-1];return i?i.params:{}}function useResolvedPath(e,i){let{relative:a}=i===void 0?{}:i,{matches:o}=reactExports.useContext(RouteContext),{pathname:c}=useLocation(),s=JSON.stringify(getPathContributingMatches(o).map(d=>d.pathnameBase));return reactExports.useMemo(()=>resolveTo(e,JSON.parse(s),c,a==="path"),[e,s,c,a])}function useRoutes(e,i){return useRoutesImpl(e,i)}function useRoutesImpl(e,i,a){useInRouterContext()||invariant(!1);let{navigator:o}=reactExports.useContext(NavigationContext$1),{matches:c}=reactExports.useContext(RouteContext),s=c[c.length-1],d=s?s.params:{};s&&s.pathname;let $=s?s.pathnameBase:"/";s&&s.route;let et=useLocation(),h;if(i){var b;let Ft=typeof i=="string"?parsePath(i):i;$==="/"||(b=Ft.pathname)!=null&&b.startsWith($)||invariant(!1),h=Ft}else h=et;let g=h.pathname||"/",st=$==="/"?g:g.slice($.length)||"/",$t=matchRoutes(e,{pathname:st}),vt=_renderMatches($t&&$t.map(Ft=>Object.assign({},Ft,{params:Object.assign({},d,Ft.params),pathname:joinPaths([$,o.encodeLocation?o.encodeLocation(Ft.pathname).pathname:Ft.pathname]),pathnameBase:Ft.pathnameBase==="/"?$:joinPaths([$,o.encodeLocation?o.encodeLocation(Ft.pathnameBase).pathname:Ft.pathnameBase])})),c,a);return i&&vt?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$1({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Action.Pop}},vt):vt}function DefaultErrorComponent(){let e=useRouteError(),i=isRouteErrorResponse(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,c={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},i),a?reactExports.createElement("pre",{style:c},a):null,s)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,a){return a.location!==i.location||a.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error||a.error,location:a.location,revalidation:i.revalidation||a.revalidation}}componentDidCatch(i,a){console.error("React Router caught the following error during render",i,a)}render(){return this.state.error?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(e){let{routeContext:i,match:a,children:o}=e,c=reactExports.useContext(DataRouterContext);return c&&c.static&&c.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(c.staticContext._deepestRenderedBoundaryId=a.route.id),reactExports.createElement(RouteContext.Provider,{value:i},o)}function _renderMatches(e,i,a){var o;if(i===void 0&&(i=[]),a===void 0&&(a=null),e==null){var c;if((c=a)!=null&&c.errors)e=a.matches;else return null}let s=e,d=(o=a)==null?void 0:o.errors;if(d!=null){let $=s.findIndex(et=>et.route.id&&(d==null?void 0:d[et.route.id]));$>=0||invariant(!1),s=s.slice(0,Math.min(s.length,$+1))}return s.reduceRight(($,et,h)=>{let b=et.route.id?d==null?void 0:d[et.route.id]:null,g=null;a&&(g=et.route.errorElement||defaultErrorElement);let st=i.concat(s.slice(0,h+1)),$t=()=>{let vt;return b?vt=g:et.route.Component?vt=reactExports.createElement(et.route.Component,null):et.route.element?vt=et.route.element:vt=$,reactExports.createElement(RenderedRoute,{match:et,routeContext:{outlet:$,matches:st,isDataRoute:a!=null},children:vt})};return a&&(et.route.ErrorBoundary||et.route.errorElement||h===0)?reactExports.createElement(RenderErrorBoundary,{location:a.location,revalidation:a.revalidation,component:g,error:b,children:$t(),routeContext:{outlet:null,matches:st,isDataRoute:!0}}):$t()},null)}var DataRouterHook$1=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(DataRouterHook$1||{}),DataRouterStateHook$1=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(DataRouterStateHook$1||{});function useDataRouterContext(e){let i=reactExports.useContext(DataRouterContext);return i||invariant(!1),i}function useDataRouterState(e){let i=reactExports.useContext(DataRouterStateContext);return i||invariant(!1),i}function useRouteContext(e){let i=reactExports.useContext(RouteContext);return i||invariant(!1),i}function useCurrentRouteId(e){let i=useRouteContext(),a=i.matches[i.matches.length-1];return a.route.id||invariant(!1),a.route.id}function useRouteError(){var e;let i=reactExports.useContext(RouteErrorContext),a=useDataRouterState(DataRouterStateHook$1.UseRouteError),o=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return i||((e=a.errors)==null?void 0:e[o])}function useNavigateStable(){let{router:e}=useDataRouterContext(DataRouterHook$1.UseNavigateStable),i=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),a=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{a.current=!0}),reactExports.useCallback(function(c,s){s===void 0&&(s={}),a.current&&(typeof c=="number"?e.navigate(c):e.navigate(c,_extends$1({fromRouteId:i},s)))},[e,i])}function Navigate(e){let{to:i,replace:a,state:o,relative:c}=e;useInRouterContext()||invariant(!1);let{matches:s}=reactExports.useContext(RouteContext),{pathname:d}=useLocation(),$=useNavigate(),et=resolveTo(i,getPathContributingMatches(s).map(b=>b.pathnameBase),d,c==="path"),h=JSON.stringify(et);return reactExports.useEffect(()=>$(JSON.parse(h),{replace:a,state:o,relative:c}),[$,h,c,a,o]),null}function Route(e){invariant(!1)}function Router(e){let{basename:i="/",children:a=null,location:o,navigationType:c=Action.Pop,navigator:s,static:d=!1}=e;useInRouterContext()&&invariant(!1);let $=i.replace(/^\/*/,"/"),et=reactExports.useMemo(()=>({basename:$,navigator:s,static:d}),[$,s,d]);typeof o=="string"&&(o=parsePath(o));let{pathname:h="/",search:b="",hash:g="",state:st=null,key:$t="default"}=o,vt=reactExports.useMemo(()=>{let Ft=stripBasename(h,$);return Ft==null?null:{location:{pathname:Ft,search:b,hash:g,state:st,key:$t},navigationType:c}},[$,h,b,g,st,$t,c]);return vt==null?null:reactExports.createElement(NavigationContext$1.Provider,{value:et},reactExports.createElement(LocationContext.Provider,{children:a,value:vt}))}function Routes(e){let{children:i,location:a}=e;return useRoutes(createRoutesFromChildren(i),a)}new Promise(()=>{});function createRoutesFromChildren(e,i){i===void 0&&(i=[]);let a=[];return reactExports.Children.forEach(e,(o,c)=>{if(!reactExports.isValidElement(o))return;let s=[...i,c];if(o.type===reactExports.Fragment){a.push.apply(a,createRoutesFromChildren(o.props.children,s));return}o.type!==Route&&invariant(!1),!o.props.index||!o.props.children||invariant(!1);let d={id:o.props.id||s.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(d.children=createRoutesFromChildren(o.props.children,s)),a.push(d)}),a}/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(e,i){if(e==null)return{};var a={},o=Object.keys(e),c,s;for(s=0;s<o.length;s++)c=o[s],!(i.indexOf(c)>=0)&&(a[c]=e[c]);return a}function isModifiedEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function shouldProcessLinkClick(e,i){return e.button===0&&(!i||i==="_self")&&!isModifiedEvent(e)}const _excluded=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],START_TRANSITION="startTransition",startTransitionImpl=React$1[START_TRANSITION];function HashRouter(e){let{basename:i,children:a,future:o,window:c}=e,s=reactExports.useRef();s.current==null&&(s.current=createHashHistory({window:c,v5Compat:!0}));let d=s.current,[$,et]=reactExports.useState({action:d.action,location:d.location}),{v7_startTransition:h}=o||{},b=reactExports.useCallback(g=>{h&&startTransitionImpl?startTransitionImpl(()=>et(g)):et(g)},[et,h]);return reactExports.useLayoutEffect(()=>d.listen(b),[d,b]),reactExports.createElement(Router,{basename:i,children:a,location:$.location,navigationType:$.action,navigator:d})}const isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function(i,a){let{onClick:o,relative:c,reloadDocument:s,replace:d,state:$,target:et,to:h,preventScrollReset:b}=i,g=_objectWithoutPropertiesLoose(i,_excluded),{basename:st}=reactExports.useContext(NavigationContext$1),$t,vt=!1;if(typeof h=="string"&&ABSOLUTE_URL_REGEX.test(h)&&($t=h,isBrowser))try{let Lt=new URL(window.location.href),rr=h.startsWith("//")?new URL(Lt.protocol+h):new URL(h),jr=stripBasename(rr.pathname,st);rr.origin===Lt.origin&&jr!=null?h=jr+rr.search+rr.hash:vt=!0}catch{}let Ft=useHref(h,{relative:c}),Gt=useLinkClickHandler(h,{replace:d,state:$,target:et,preventScrollReset:b,relative:c});function qt(Lt){o&&o(Lt),Lt.defaultPrevented||Gt(Lt)}return reactExports.createElement("a",_extends({},g,{href:$t||Ft,onClick:vt||s?o:qt,ref:a,target:et}))});var DataRouterHook;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useLinkClickHandler(e,i){let{target:a,replace:o,state:c,preventScrollReset:s,relative:d}=i===void 0?{}:i,$=useNavigate(),et=useLocation(),h=useResolvedPath(e,{relative:d});return reactExports.useCallback(b=>{if(shouldProcessLinkClick(b,a)){b.preventDefault();let g=o!==void 0?o:createPath(et)===createPath(h);$(e,{replace:g,state:c,preventScrollReset:s,relative:d})}},[et,$,h,o,c,a,e,s,d])}const GITHUB_URL="https://github.com/emersondemetrio/emersondemetrio.github.io/blob/main/",API_URL="https://api.exchangerate-api.com/v4/latest/",Links=[{title:"Instagram",url:"https://instagram.com/emersondemetrio/",category:"social",handle:"@emersondemetrio"},{title:"x (Twitter)",url:"https://x.com/emersondemetrio/",category:"social",handle:"@emersondemetrio"},{title:"LinkedIn",url:"https://linkedin.com/in/emersondemetrio/",category:"professional",handle:"@emersondemetrio"},{title:"GitHub",url:"https://github.com/emersondemetrio?tab=repositories",category:"professional",handle:"@emersondemetrio"},{title:"Gist",url:"https://gist.github.com/emersondemetrio",category:"professional",handle:"@emersondemetrio"},{title:"CodePen",url:"https://codepen.io/emersondemetrio/",category:"professional",handle:"@emersondemetrio"},{title:"YouTube",url:"https://youtube.com/@emersondemetrio/videos",category:"arts",handle:"@emersondemetrio"},{title:"Playlists",url:"https://youtube.com/@emersondemetrio/playlists",category:"arts",handle:"YT Playlists"},{title:"SoundCloud",url:"https://soundcloud.com/emersondemetrio/tracks",category:"arts",handle:"@emersondemetrio"},{title:"Spotify",url:"https://open.spotify.com/user/12156014938",category:"arts",handle:"@emersondemetrio"},{title:"Blog",url:"https://badcompiler.tumblr.com",category:"arts",handle:"@badcompiler"}],linkGet=e=>{const i=Links.find(a=>a.title===e);return i||{title:"Instagram",url:"https://instagram.com/emersondemetrio/",category:"social",handle:"@emersondemetrio"}},CurrencyProviders=[{name:"Wise",nickname:"wis",url:(e,i)=>`https://wise.com/us/currency-converter/${`eur-to-${i}-rate?amount=${e}`.toLocaleLowerCase()}`},{name:"Google",nickname:"ggl",url:(e,i)=>`https://google.com/search?q=${e}+eur+to+${i}`}],REPOS={timezones:{name:"Timezones",url:`${GITHUB_URL}src/pages/timezones/timezones.tsx`},weather:{name:"Weather App",url:`${GITHUB_URL}src/pages/weather-app/weather-app.tsx`},codepen:{name:"Code Pen",url:`${GITHUB_URL}src/pages/code-pen/pens`}},Footer$1=()=>jsxRuntimeExports.jsxs("footer",{className:"bg-black px-3 py-12 text-center text-white border-t",children:[jsxRuntimeExports.jsx(Link,{target:"_blank",to:linkGet("instagram").url,className:"btn btn-black",children:"Emerson Demetrio"}),jsxRuntimeExports.jsxs("p",{children:["© ",new Date().getFullYear()]})]}),TargetCurrencies=["USD","GBP","BRL"],cacheKey$1="currency-app-cache",getFromCache$1=e=>JSON.parse(localStorage.getItem(cacheKey$1)||"{}")[e]||null,setCache$1=(e,i)=>{const a=JSON.parse(localStorage.getItem(cacheKey$1)||"{}");a[e]=i,localStorage.setItem(cacheKey$1,JSON.stringify(a))},dateToTimestamp$1=e=>{const i=e.toISOString().split("T")[0];return new Date(i).getTime()},fetchCurrency=async e=>await(await fetch(`${API_URL}/${e}`)).json(),filterTarget=e=>{const i=Object.keys(e.rates).filter(a=>TargetCurrencies.includes(a)).reduce((a,o)=>(a[o]=e.rates[o],a),{});return{...e,rates:i}},fixedAs2=e=>Math.round(e*100)/100,formatToCurrency=(e,i,a=1)=>((!e||isNaN(e))&&(e=1),fixedAs2(e*a).toLocaleString("en-US",{currency:i,style:"currency"})),useCurrencyNow=(e="EUR")=>{const[i,a]=reactExports.useState(!0),[o,c]=reactExports.useState(null),[s,d]=reactExports.useState(null);return reactExports.useEffect(()=>{const $=getFromCache$1(dateToTimestamp$1(new Date));if($){c(filterTarget($)),a(!1);return}fetchCurrency(e).then(et=>{c(filterTarget(et)),setCache$1(dateToTimestamp$1(new Date),et),a(!1)}).catch(et=>{d(et),a(!1)})},[e]),{data:o,isLoading:i,error:s}},Loading=()=>jsxRuntimeExports.jsxs("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"24px",height:"30px",viewBox:"0 0 24 30",xmlSpace:"preserve",children:[jsxRuntimeExports.jsx("rect",{x:"0",y:"0",width:"4",height:"10",fill:"#333",children:jsxRuntimeExports.jsx("animateTransform",{attributeType:"xml",attributeName:"transform",type:"translate",values:"0 0; 0 20; 0 0",begin:"0",dur:"0.6s",repeatCount:"indefinite"})}),jsxRuntimeExports.jsx("rect",{x:"10",y:"0",width:"4",height:"10",fill:"#333",children:jsxRuntimeExports.jsx("animateTransform",{attributeType:"xml",attributeName:"transform",type:"translate",values:"0 0; 0 20; 0 0",begin:"0.2s",dur:"0.6s",repeatCount:"indefinite"})}),jsxRuntimeExports.jsx("rect",{x:"20",y:"0",width:"4",height:"10",fill:"#333",children:jsxRuntimeExports.jsx("animateTransform",{attributeType:"xml",attributeName:"transform",type:"translate",values:"0 0; 0 20; 0 0",begin:"0.4s",dur:"0.6s",repeatCount:"indefinite"})})]}),Badge=({amount:e,currency:i,provider:a})=>jsxRuntimeExports.jsx(Link,{target:"_blank",className:"badge badge-primary",to:a.url(e,i),children:a.nickname}),CurrencyNow=()=>{const{data:e,isLoading:i,error:a}=useCurrencyNow(),[o,c]=reactExports.useState(null);if(i)return jsxRuntimeExports.jsx(Loading,{});const s=$=>()=>{navigator.clipboard.writeText($),alert("Copied to clipboard!")},d=$=>{$.preventDefault();const et=parseInt($.target.value,10);if(isNaN(et)){c(null);return}et>5e6||c(et)};return e===null?jsxRuntimeExports.jsx("div",{className:"currency-item",children:"No currency data"}):a?jsxRuntimeExports.jsx("div",{className:"currency-item",children:a.message}):jsxRuntimeExports.jsx("div",{className:"currency-now",children:jsxRuntimeExports.jsxs("div",{className:"overflow-x-auto",children:[jsxRuntimeExports.jsx("input",{type:"number",max:999999,placeholder:"Type (EUR)",value:o??"",onChange:d,className:"input input-bordered input-md w-full max-w-xs"}),jsxRuntimeExports.jsxs("table",{className:"table",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{}),jsxRuntimeExports.jsx("th",{children:"Conversion"}),jsxRuntimeExports.jsx("th",{children:"Rate"}),jsxRuntimeExports.jsx("th",{children:"Sources"})]})}),jsxRuntimeExports.jsx("tbody",{children:Object.entries(e.rates).map(([$,et],h)=>{const b=formatToCurrency(o||1,"eur"),g=formatToCurrency(o,$,et);return jsxRuntimeExports.jsxs("tr",{title:$,onClick:s(`${b} = ${g}`),children:[jsxRuntimeExports.jsx("th",{children:h+1}),jsxRuntimeExports.jsxs("td",{children:["EUR to ",$]}),jsxRuntimeExports.jsxs("td",{children:[b," = ",g]}),jsxRuntimeExports.jsx("td",{children:CurrencyProviders.map(st=>jsxRuntimeExports.jsx(Badge,{currency:$,amount:o||1,provider:st},st.name))})]},$)})})]})]})})},noop=()=>{},randomUUID=()=>Math.random().toString(36).substring(2,15),range=(e,i)=>Array.from({length:i-e+1},(a,o)=>o+e),reverseRange=(e,i)=>range(e,i).reverse(),limitString=(e,i)=>e.length>i?e.slice(0,i):e,Modal=({title:e,visible:i,onClose:a,children:o})=>{const c=randomUUID();return jsxRuntimeExports.jsx("dialog",{id:c,className:i?"modal modal-open":"modal",children:jsxRuntimeExports.jsxs("div",{className:"modal-box w-full",children:[jsxRuntimeExports.jsx("h3",{className:"font-bold text-lg",children:e}),o,jsxRuntimeExports.jsx("div",{className:"modal-action",children:jsxRuntimeExports.jsx("form",{method:"dialog",children:jsxRuntimeExports.jsx("button",{className:"btn",onClick:a,children:"Close"})})})]})})},terminal="",CloseIcon=({active:e})=>jsxRuntimeExports.jsxs("g",{children:[jsxRuntimeExports.jsx("circle",{cx:"15",cy:"15",r:"15",fill:"#DF4744"}),e&&jsxRuntimeExports.jsxs("g",{children:[jsxRuntimeExports.jsx("circle",{cx:"14.9032",cy:"14.9032",r:"13.7419",fill:"#FC5753"}),jsxRuntimeExports.jsx("rect",{x:"8.10388",y:"20.0107",width:"16.8387",height:"2.12903",transform:"rotate(-45 8.10388 20.0107)",fill:"#7E0508"}),jsxRuntimeExports.jsx("rect",{x:"8.10388",y:"9.60934",width:"2.12903",height:"16.8387",transform:"rotate(-45 8.10388 9.60934)",fill:"#7E0508"})]})]}),MinimizeIcon=({active:e})=>jsxRuntimeExports.jsxs("g",{children:[jsxRuntimeExports.jsx("circle",{cx:"15",cy:"15",r:"15",fill:"#DE9F34"}),e&&jsxRuntimeExports.jsxs("g",{children:[jsxRuntimeExports.jsx("circle",{cx:"14.9032",cy:"14.9032",r:"13.7419",fill:"#FDBC40"}),jsxRuntimeExports.jsx("rect",{x:"6.58064",y:"13.9355",width:"16.8387",height:"2.12903",fill:"#985712"})]})]}),MaximizeIcon=({active:e})=>jsxRuntimeExports.jsxs("g",{children:[jsxRuntimeExports.jsx("circle",{cx:"15",cy:"15",r:"15",fill:"#27AA35"}),e&&jsxRuntimeExports.jsxs("g",{children:[jsxRuntimeExports.jsx("circle",{cx:"14.9032",cy:"14.9032",r:"13.7419",fill:"#36C84B"}),jsxRuntimeExports.jsx("path",{d:"M21.3004 7.52811C21.8549 7.52653 22.3048 7.97644 22.3032 8.53095L22.2815 16.1749C22.2789 17.0644 21.2034 17.5081 20.5744 16.8791L12.9522 9.25696C12.3232 8.62796 12.7669 7.55239 13.6564 7.54986L21.3004 7.52811Z",fill:"#0B650D"}),jsxRuntimeExports.jsx("path",{d:"M8.53096 22.3032C7.97645 22.3048 7.52654 21.8549 7.52811 21.3003L7.54986 13.6564C7.5524 12.7669 8.62797 12.3232 9.25697 12.9522L16.8791 20.5743C17.5081 21.2033 17.0644 22.2789 16.1749 22.2814L8.53096 22.3032Z",fill:"#0B650D"})]})]}),Icon=({onClick:e,name:i})=>{const[a,o]=reactExports.useState(!1);return jsxRuntimeExports.jsxs("svg",{onClick:e,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{width:"15px",height:"15px"},children:[i==="close"&&jsxRuntimeExports.jsx(CloseIcon,{active:a}),i==="minimize"&&jsxRuntimeExports.jsx(MinimizeIcon,{active:a}),i==="maximize"&&jsxRuntimeExports.jsx(MaximizeIcon,{active:a})]})},TerminalActions=({actions:e})=>jsxRuntimeExports.jsxs("div",{className:"action-button-container",children:[jsxRuntimeExports.jsx(Icon,{name:"maximize",onClick:(e==null?void 0:e.onMaximize)||noop}),jsxRuntimeExports.jsx(Icon,{name:"minimize",onClick:(e==null?void 0:e.onMaximize)||noop}),jsxRuntimeExports.jsx(Icon,{name:"close",onClick:(e==null?void 0:e.onMinimize)||noop})]}),TerminalHeader=({title:e,actions:i})=>jsxRuntimeExports.jsxs("div",{className:"terminal-header",children:[jsxRuntimeExports.jsxs("span",{className:"title-container",children:["~/",e.toLowerCase().split(" ").join("-"),"/"]}),jsxRuntimeExports.jsx(TerminalActions,{actions:i})]}),openUrl=e=>window.open(e,"_blank"),TerminalBadge=({name:e,onFocus:i,onFocusLost:a})=>jsxRuntimeExports.jsx("div",{className:"terminal-item-tag-container",onMouseEnter:()=>i(e),onMouseLeave:a,children:jsxRuntimeExports.jsx("span",{className:"badge badge-outline",children:e})}),Terminal=({links:e,tools:i=[]})=>{const[a,o]=reactExports.useState(null),c=$=>{o($)},s=()=>{o(null)},d=$=>{const et=a===$?"terminal-item terminal-item-active":"terminal-item";return a?$===a?et:`${et} terminal-item-inactive`:et};return jsxRuntimeExports.jsxs("div",{className:"terminal-container mb-5",children:[e.map(({handle:$,title:et,url:h,category:b})=>jsxRuntimeExports.jsxs("div",{className:d(b),children:[jsxRuntimeExports.jsx(TerminalHeader,{title:et}),jsxRuntimeExports.jsx("div",{className:"btn btn-dark terminal-item-content",onClick:()=>openUrl(h),children:jsxRuntimeExports.jsx("span",{children:$})}),jsxRuntimeExports.jsx(TerminalBadge,{name:b,onFocus:c,onFocusLost:s})]},`${b}/${et}`)),i.map(($,et)=>jsxRuntimeExports.jsxs("div",{className:d($.category),children:[jsxRuntimeExports.jsx(TerminalHeader,{title:$.title,actions:$.actions}),jsxRuntimeExports.jsx("div",{className:"btn btn-dark terminal-item-content",onClick:$.actions.onMaximize,children:jsxRuntimeExports.jsx("span",{children:$.handle})}),jsxRuntimeExports.jsx(TerminalBadge,{name:$.category,onFocus:c,onFocusLost:s})]},`tool-${et}`))]})},useIsMobile=(e=768)=>{if(typeof window.matchMedia!="function")throw Error("matchMedia not supported by browser!");const[i,a]=reactExports.useState(window.matchMedia(`(max-width: ${e}px)`).matches),o=reactExports.useCallback(c=>{a(c.matches)},[]);return reactExports.useEffect(()=>{const c=window.matchMedia(`(max-width: ${e}px)`);try{c.addEventListener("change",o)}catch{c.addListener(o)}return()=>{try{c.removeEventListener("change",o)}catch{c.removeListener(o)}}},[e]),i},Page=({name:e="Page Name",description:i,children:a,style:o={},onPaste:c=()=>{},className:s="",withoutName:d=!1,isHome:$=!1,withoutPadding:et=!1,repo:h,landing:b=!1})=>{const g=useIsMobile(),st=reactExports.useRef(null);reactExports.useEffect(()=>{if(!g&&st.current){const vt=Ft=>{c(Ft)};return window.addEventListener("paste",vt),()=>{window&&window.removeEventListener("paste",vt)}}},[g,c]);const $t=et?"":"py-8";return s=g&&!$?`mt-10 ${s}`:s,jsxRuntimeExports.jsx("section",{style:o,onPaste:c,ref:st,tabIndex:-1,"data-page":`page-${e.toLowerCase().replace(/\s/g,"-")}`,className:`grid place-items-center py-20 text-center ${$t} ${s}`,children:jsxRuntimeExports.jsxs("div",{className:"container mx-auto flex flex-wrap",children:[d?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}):jsxRuntimeExports.jsxs("div",{className:"w-full flex justify-between items-center flex-col md:flex-row gap-6",children:[!b&&jsxRuntimeExports.jsx("h2",{className:"my-2 text-5xl font-bold leading-tight text-center text-white-800",children:e}),h&&jsxRuntimeExports.jsx(Link,{to:h,target:"_blank",className:"text-center text-white-800 items-center",children:"📋 Show me the code"})]}),$&&jsxRuntimeExports.jsx("div",{className:"w-full flex flex-col",children:a}),!$&&jsxRuntimeExports.jsxs("div",{className:"w-full flex flex-col",children:[i&&jsxRuntimeExports.jsx("div",{className:"mb-6",children:jsxRuntimeExports.jsx("p",{className:"text-lg",children:i})}),jsxRuntimeExports.jsx("div",{className:"w-full flex justify-center items-center",children:a})]})]})})},Hero=()=>useIsMobile()?jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("h1",{className:"my-4 text-2xl font-bold leading-tight text-center",children:"~/emersondemetrio"})}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:"pt-2",children:jsxRuntimeExports.jsx("div",{className:"container px-3 mx-auto flex flex-wrap flex-col md:flex-row items-center",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col w-full md:w-2/5 justify-center items-start text-center md:text-left",children:[jsxRuntimeExports.jsx("h1",{className:"my-4 text-2xl font-bold leading-tight",children:"~/emersondemetrio"}),jsxRuntimeExports.jsx("p",{className:"leading-normal text-2xl mb-8",children:"Software Engineer and music enthusiast."})]})})})}),Home=()=>{const[e,i]=reactExports.useState(!1);return jsxRuntimeExports.jsxs(Page,{isHome:!0,name:"Home",withoutName:!0,children:[jsxRuntimeExports.jsx(Hero,{}),jsxRuntimeExports.jsx(Terminal,{links:Links,tools:[{handle:"Currency Tools",category:"tools",title:"Currency Tools",actions:{onMaximize:()=>i(!0),onMinimize:()=>i(!1),onClose:()=>i(!1)}}]}),jsxRuntimeExports.jsx(Modal,{title:"Currency Tools",visible:e,onClose:()=>i(!1),children:jsxRuntimeExports.jsx(CurrencyNow,{})})]})},Blog=()=>jsxRuntimeExports.jsx(Page,{name:"Blog",description:"Come back soon!"}),FilePicker=({onFileChange:e})=>{const i=a=>{e(a.target.files)};return jsxRuntimeExports.jsxs("div",{className:"container",children:[jsxRuntimeExports.jsx("label",{htmlFor:"fileInput",children:"Select File(s)"}),jsxRuntimeExports.jsx("input",{multiple:!0,type:"file",id:"fileInput",className:"file-input w-full max-w-xs",onChange:i})]})};function iota$1(e){for(var i=new Array(e),a=0;a<e;++a)i[a]=a;return i}var iota_1=iota$1;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var isBuffer_1=function(e){return e!=null&&(isBuffer$1(e)||isSlowBuffer(e)||!!e._isBuffer)};function isBuffer$1(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function isSlowBuffer(e){return typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&isBuffer$1(e.slice(0,0))}var iota=iota_1,isBuffer=isBuffer_1,hasTypedArrays=typeof Float64Array<"u";function compare1st(e,i){return e[0]-i[0]}function order(){var e=this.stride,i=new Array(e.length),a;for(a=0;a<i.length;++a)i[a]=[Math.abs(e[a]),a];i.sort(compare1st);var o=new Array(i.length);for(a=0;a<o.length;++a)o[a]=i[a][1];return o}function compileConstructor(e,i){var a=["View",i,"d",e].join("");i<0&&(a="View_Nil"+e);var o=e==="generic";if(i===-1){var c="function "+a+"(a){this.data=a;};var proto="+a+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+a+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+a+"(a){return new "+a+"(a);}",Ft=new Function(c);return Ft()}else if(i===0){var c="function "+a+"(a,d) {this.data = a;this.offset = d};var proto="+a+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+a+"_copy() {return new "+a+"(this.data,this.offset)};proto.pick=function "+a+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+a+"_get(){return "+(o?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+a+"_set(v){return "+(o?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+a+"(a,b,c,d){return new "+a+"(a,d)}",Ft=new Function("TrivialArray",c);return Ft(CACHED_CONSTRUCTORS[e][0])}var c=["'use strict'"],s=iota(i),d=s.map(function(Gt){return"i"+Gt}),$="this.offset+"+s.map(function(Gt){return"this.stride["+Gt+"]*i"+Gt}).join("+"),et=s.map(function(Gt){return"b"+Gt}).join(","),h=s.map(function(Gt){return"c"+Gt}).join(",");c.push("function "+a+"(a,"+et+","+h+",d){this.data=a","this.shape=["+et+"]","this.stride=["+h+"]","this.offset=d|0}","var proto="+a+".prototype","proto.dtype='"+e+"'","proto.dimension="+i),c.push("Object.defineProperty(proto,'size',{get:function "+a+"_size(){return "+s.map(function(Gt){return"this.shape["+Gt+"]"}).join("*"),"}})"),i===1?c.push("proto.order=[0]"):(c.push("Object.defineProperty(proto,'order',{get:"),i<4?(c.push("function "+a+"_order(){"),i===2?c.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):i===3&&c.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):c.push("ORDER})")),c.push("proto.set=function "+a+"_set("+d.join(",")+",v){"),o?c.push("return this.data.set("+$+",v)}"):c.push("return this.data["+$+"]=v}"),c.push("proto.get=function "+a+"_get("+d.join(",")+"){"),o?c.push("return this.data.get("+$+")}"):c.push("return this.data["+$+"]}"),c.push("proto.index=function "+a+"_index(",d.join(),"){return "+$+"}"),c.push("proto.hi=function "+a+"_hi("+d.join(",")+"){return new "+a+"(this.data,"+s.map(function(Gt){return["(typeof i",Gt,"!=='number'||i",Gt,"<0)?this.shape[",Gt,"]:i",Gt,"|0"].join("")}).join(",")+","+s.map(function(Gt){return"this.stride["+Gt+"]"}).join(",")+",this.offset)}");var b=s.map(function(Gt){return"a"+Gt+"=this.shape["+Gt+"]"}),g=s.map(function(Gt){return"c"+Gt+"=this.stride["+Gt+"]"});c.push("proto.lo=function "+a+"_lo("+d.join(",")+"){var b=this.offset,d=0,"+b.join(",")+","+g.join(","));for(var st=0;st<i;++st)c.push("if(typeof i"+st+"==='number'&&i"+st+">=0){d=i"+st+"|0;b+=c"+st+"*d;a"+st+"-=d}");c.push("return new "+a+"(this.data,"+s.map(function(Gt){return"a"+Gt}).join(",")+","+s.map(function(Gt){return"c"+Gt}).join(",")+",b)}"),c.push("proto.step=function "+a+"_step("+d.join(",")+"){var "+s.map(function(Gt){return"a"+Gt+"=this.shape["+Gt+"]"}).join(",")+","+s.map(function(Gt){return"b"+Gt+"=this.stride["+Gt+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var st=0;st<i;++st)c.push("if(typeof i"+st+"==='number'){d=i"+st+"|0;if(d<0){c+=b"+st+"*(a"+st+"-1);a"+st+"=ceil(-a"+st+"/d)}else{a"+st+"=ceil(a"+st+"/d)}b"+st+"*=d}");c.push("return new "+a+"(this.data,"+s.map(function(Gt){return"a"+Gt}).join(",")+","+s.map(function(Gt){return"b"+Gt}).join(",")+",c)}");for(var $t=new Array(i),vt=new Array(i),st=0;st<i;++st)$t[st]="a[i"+st+"]",vt[st]="b[i"+st+"]";c.push("proto.transpose=function "+a+"_transpose("+d+"){"+d.map(function(Gt,qt){return Gt+"=("+Gt+"===undefined?"+qt+":"+Gt+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+a+"(this.data,"+$t.join(",")+","+vt.join(",")+",this.offset)}"),c.push("proto.pick=function "+a+"_pick("+d+"){var a=[],b=[],c=this.offset");for(var st=0;st<i;++st)c.push("if(typeof i"+st+"==='number'&&i"+st+">=0){c=(c+this.stride["+st+"]*i"+st+")|0}else{a.push(this.shape["+st+"]);b.push(this.stride["+st+"])}");c.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),c.push("return function construct_"+a+"(data,shape,stride,offset){return new "+a+"(data,"+s.map(function(Gt){return"shape["+Gt+"]"}).join(",")+","+s.map(function(Gt){return"stride["+Gt+"]"}).join(",")+",offset)}");var Ft=new Function("CTOR_LIST","ORDER",c.join(`
`));return Ft(CACHED_CONSTRUCTORS[e],order)}function arrayDType(e){if(isBuffer(e))return"buffer";if(hasTypedArrays)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(e)?"array":"generic"}var CACHED_CONSTRUCTORS={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};function wrappedNDArrayCtor(e,i,a,o){if(e===void 0){var h=CACHED_CONSTRUCTORS.array[0];return h([])}else typeof e=="number"&&(e=[e]);i===void 0&&(i=[e.length]);var c=i.length;if(a===void 0){a=new Array(c);for(var s=c-1,d=1;s>=0;--s)a[s]=d,d*=i[s]}if(o===void 0){o=0;for(var s=0;s<c;++s)a[s]<0&&(o-=(i[s]-1)*a[s])}for(var $=arrayDType(e),et=CACHED_CONSTRUCTORS[$];et.length<=c+1;)et.push(compileConstructor($,et.length-1));var h=et[c+1];return h(e,i,a,o)}var ndarray=wrappedNDArrayCtor;const ndarray4=getDefaultExportFromCjs(ndarray);/*!
 * ONNX Runtime Web v1.18.0
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */var vd$1=Object.create,Pn$1=Object.defineProperty,_d$1=Object.getOwnPropertyDescriptor,Od$1=Object.getOwnPropertyNames,Id$1=Object.getPrototypeOf,Sd$1=Object.prototype.hasOwnProperty,L=(e,i)=>()=>(e&&(i=e(e=0)),i),me=(e,i)=>()=>(i||e((i={exports:{}}).exports,i),i.exports),Sr=(e,i)=>{for(var a in i)Pn$1(e,a,{get:i[a],enumerable:!0})},Va$1=(e,i,a,o)=>{if(i&&typeof i=="object"||typeof i=="function")for(let c of Od$1(i))!Sd$1.call(e,c)&&c!==a&&Pn$1(e,c,{get:()=>i[c],enumerable:!(o=_d$1(i,c))||o.enumerable});return e},Ar=(e,i,a)=>(a=e!=null?vd$1(Id$1(e)):{},Va$1(i||!e||!e.__esModule?Pn$1(a,"default",{value:e,enumerable:!0}):a,e)),ar=e=>Va$1(Pn$1({},"__esModule",{value:!0}),e),En,sr$1,Pr$1,Ad$1,Dn$1,Ln$1=L(()=>{En=new Map,sr$1=[],Pr$1=(e,i,a)=>{if(i&&typeof i.init=="function"&&typeof i.createInferenceSessionHandler=="function"){let o=En.get(e);if(o===void 0)En.set(e,{backend:i,priority:a});else{if(o.priority>a)return;if(o.priority===a&&o.backend!==i)throw new Error(`cannot register backend "${e}" using priority ${a}`)}if(a>=0){let c=sr$1.indexOf(e);c!==-1&&sr$1.splice(c,1);for(let s=0;s<sr$1.length;s++)if(En.get(sr$1[s]).priority<=a){sr$1.splice(s,0,e);return}sr$1.push(e)}return}throw new TypeError("not a valid backend")},Ad$1=async e=>{let i=En.get(e);if(!i)return"backend not found.";if(i.initialized)return i.backend;if(i.aborted)return i.error;{let a=!!i.initPromise;try{return a||(i.initPromise=i.backend.init(e)),await i.initPromise,i.initialized=!0,i.backend}catch(o){return a||(i.error=`${o}`,i.aborted=!0),i.error}finally{delete i.initPromise}}},Dn$1=async e=>{let i=e.executionProviders||[],a=i.map(et=>typeof et=="string"?et:et.name),o=a.length===0?sr$1:a,c,s=[],d=new Set;for(let et of o){let h=await Ad$1(et);typeof h=="string"?s.push({name:et,err:h}):(c||(c=h),c===h&&d.add(et))}if(!c)throw new Error(`no available backend found. ERR: ${s.map(et=>`[${et.name}] ${et.err}`).join(", ")}`);for(let{name:et,err:h}of s)a.includes(et)&&console.warn(`removing requested execution provider "${et}" from session options because it is not available: ${h}`);let $=i.filter(et=>d.has(typeof et=="string"?et:et.name));return[c,new Proxy(e,{get:(et,h)=>h==="executionProviders"?$:Reflect.get(et,h)})]}}),Wa=L(()=>{Ln$1()}),Ha$1,qa$1=L(()=>{Ha$1="1.18.0"}),ja$1,ut$1,Vo=L(()=>{qa$1(),ja$1="warning",ut$1={wasm:{},webgl:{},webgpu:{},versions:{common:Ha$1},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);ja$1=e}},get logLevel(){return ja$1}},Object.defineProperty(ut$1,"logLevel",{enumerable:!0})}),Z,Ya$1=L(()=>{Vo(),Z=ut$1}),Xa$1,Ka$1,Ja$1=L(()=>{Xa$1=(e,i)=>{let a=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);a.width=e.dims[3],a.height=e.dims[2];let o=a.getContext("2d");if(o!=null){let c,s;(i==null?void 0:i.tensorLayout)!==void 0&&i.tensorLayout==="NHWC"?(c=e.dims[2],s=e.dims[3]):(c=e.dims[3],s=e.dims[2]);let d=(i==null?void 0:i.format)!==void 0?i.format:"RGB",$=i==null?void 0:i.norm,et,h;$===void 0||$.mean===void 0?et=[255,255,255,255]:typeof $.mean=="number"?et=[$.mean,$.mean,$.mean,$.mean]:(et=[$.mean[0],$.mean[1],$.mean[2],0],$.mean[3]!==void 0&&(et[3]=$.mean[3])),$===void 0||$.bias===void 0?h=[0,0,0,0]:typeof $.bias=="number"?h=[$.bias,$.bias,$.bias,$.bias]:(h=[$.bias[0],$.bias[1],$.bias[2],0],$.bias[3]!==void 0&&(h[3]=$.bias[3]));let b=s*c,g=0,st=b,$t=b*2,vt=-1;d==="RGBA"?(g=0,st=b,$t=b*2,vt=b*3):d==="RGB"?(g=0,st=b,$t=b*2):d==="RBG"&&(g=0,$t=b,st=b*2);for(let Ft=0;Ft<s;Ft++)for(let Gt=0;Gt<c;Gt++){let qt=(e.data[g++]-h[0])*et[0],Lt=(e.data[st++]-h[1])*et[1],rr=(e.data[$t++]-h[2])*et[2],jr=vt===-1?255:(e.data[vt++]-h[3])*et[3];o.fillStyle="rgba("+qt+","+Lt+","+rr+","+jr+")",o.fillRect(Gt,Ft,1,1)}if("toDataURL"in a)return a.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},Ka$1=(e,i)=>{let a=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),o;if(a!=null){let c,s,d;(i==null?void 0:i.tensorLayout)!==void 0&&i.tensorLayout==="NHWC"?(c=e.dims[2],s=e.dims[1],d=e.dims[3]):(c=e.dims[3],s=e.dims[2],d=e.dims[1]);let $=i!==void 0&&i.format!==void 0?i.format:"RGB",et=i==null?void 0:i.norm,h,b;et===void 0||et.mean===void 0?h=[255,255,255,255]:typeof et.mean=="number"?h=[et.mean,et.mean,et.mean,et.mean]:(h=[et.mean[0],et.mean[1],et.mean[2],255],et.mean[3]!==void 0&&(h[3]=et.mean[3])),et===void 0||et.bias===void 0?b=[0,0,0,0]:typeof et.bias=="number"?b=[et.bias,et.bias,et.bias,et.bias]:(b=[et.bias[0],et.bias[1],et.bias[2],0],et.bias[3]!==void 0&&(b[3]=et.bias[3]));let g=s*c;if(i!==void 0&&(i.format!==void 0&&d===4&&i.format!=="RGBA"||d===3&&i.format!=="RGB"&&i.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let st=4,$t=0,vt=1,Ft=2,Gt=3,qt=0,Lt=g,rr=g*2,jr=-1;$==="RGBA"?(qt=0,Lt=g,rr=g*2,jr=g*3):$==="RGB"?(qt=0,Lt=g,rr=g*2):$==="RBG"&&(qt=0,rr=g,Lt=g*2),o=a.createImageData(c,s);for(let Hr=0;Hr<s*c;$t+=st,vt+=st,Ft+=st,Gt+=st,Hr++)o.data[$t]=(e.data[qt++]-b[0])*h[0],o.data[vt]=(e.data[Lt++]-b[1])*h[1],o.data[Ft]=(e.data[rr++]-b[2])*h[2],o.data[Gt]=jr===-1?255:(e.data[jr++]-b[3])*h[3]}else throw new Error("Can not access image data");return o}}),Wo,Za$1,Qa$1,es$1,ts$1,rs$1=L(()=>{Cn(),Wo=(e,i)=>{if(e===void 0)throw new Error("Image buffer must be defined");if(i.height===void 0||i.width===void 0)throw new Error("Image height and width must be defined");if(i.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:a,width:o}=i,c=i.norm??{mean:255,bias:0},s,d;typeof c.mean=="number"?s=[c.mean,c.mean,c.mean,c.mean]:s=[c.mean[0],c.mean[1],c.mean[2],c.mean[3]??255],typeof c.bias=="number"?d=[c.bias,c.bias,c.bias,c.bias]:d=[c.bias[0],c.bias[1],c.bias[2],c.bias[3]??0];let $=i.format!==void 0?i.format:"RGBA",et=i.tensorFormat!==void 0&&i.tensorFormat!==void 0?i.tensorFormat:"RGB",h=a*o,b=et==="RGBA"?new Float32Array(h*4):new Float32Array(h*3),g=4,st=0,$t=1,vt=2,Ft=3,Gt=0,qt=h,Lt=h*2,rr=-1;$==="RGB"&&(g=3,st=0,$t=1,vt=2,Ft=-1),et==="RGBA"?rr=h*3:et==="RBG"?(Gt=0,Lt=h,qt=h*2):et==="BGR"&&(Lt=0,qt=h,Gt=h*2);for(let jr=0;jr<h;jr++,st+=g,vt+=g,$t+=g,Ft+=g)b[Gt++]=(e[st]+d[0])/s[0],b[qt++]=(e[$t]+d[1])/s[1],b[Lt++]=(e[vt]+d[2])/s[2],rr!==-1&&Ft!==-1&&(b[rr++]=(e[Ft]+d[3])/s[3]);return et==="RGBA"?new Je("float32",b,[1,4,a,o]):new Je("float32",b,[1,3,a,o])},Za$1=async(e,i)=>{let a=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,o=typeof ImageData<"u"&&e instanceof ImageData,c=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,s=typeof e=="string",d,$=i??{},et=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},h=b=>b instanceof HTMLCanvasElement||b instanceof OffscreenCanvas?b.getContext("2d"):null;if(a){let b=et();b.width=e.width,b.height=e.height;let g=h(b);if(g!=null){let st=e.height,$t=e.width;if(i!==void 0&&i.resizedHeight!==void 0&&i.resizedWidth!==void 0&&(st=i.resizedHeight,$t=i.resizedWidth),i!==void 0){if($=i,i.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");$.tensorFormat="RGBA",$.height=st,$.width=$t}else $.tensorFormat="RGBA",$.height=st,$.width=$t;g.drawImage(e,0,0),d=g.getImageData(0,0,$t,st).data}else throw new Error("Can not access image data")}else if(o){let b,g;if(i!==void 0&&i.resizedWidth!==void 0&&i.resizedHeight!==void 0?(b=i.resizedHeight,g=i.resizedWidth):(b=e.height,g=e.width),i!==void 0&&($=i),$.format="RGBA",$.height=b,$.width=g,i!==void 0){let st=et();st.width=g,st.height=b;let $t=h(st);if($t!=null)$t.putImageData(e,0,0),d=$t.getImageData(0,0,g,b).data;else throw new Error("Can not access image data")}else d=e.data}else if(c){if(i===void 0)throw new Error("Please provide image config with format for Imagebitmap");let b=et();b.width=e.width,b.height=e.height;let g=h(b);if(g!=null){let st=e.height,$t=e.width;return g.drawImage(e,0,0,$t,st),d=g.getImageData(0,0,$t,st).data,$.height=st,$.width=$t,Wo(d,$)}else throw new Error("Can not access image data")}else{if(s)return new Promise((b,g)=>{let st=et(),$t=h(st);if(!e||!$t)return g();let vt=new Image;vt.crossOrigin="Anonymous",vt.src=e,vt.onload=()=>{st.width=vt.width,st.height=vt.height,$t.drawImage(vt,0,0,st.width,st.height);let Ft=$t.getImageData(0,0,st.width,st.height);$.height=st.height,$.width=st.width,b(Wo(Ft.data,$))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(d!==void 0)return Wo(d,$);throw new Error("Input data provided is not supported - aborted tensor creation")},Qa$1=(e,i)=>{let{width:a,height:o,download:c,dispose:s}=i,d=[1,o,a,4];return new Je({location:"texture",type:"float32",texture:e,dims:d,download:c,dispose:s})},es$1=(e,i)=>{let{dataType:a,dims:o,download:c,dispose:s}=i;return new Je({location:"gpu-buffer",type:a??"float32",gpuBuffer:e,dims:o,download:c,dispose:s})},ts$1=(e,i,a)=>new Je({location:"cpu-pinned",type:e,data:i,dims:a??[i.length]})}),ur$1,Qr$1,ns,os$1,is$1=L(()=>{ur$1=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),Qr$1=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),ns=!1,os$1=()=>{if(!ns){ns=!0;let e=typeof BigInt64Array<"u"&&BigInt64Array.from,i=typeof BigUint64Array<"u"&&BigUint64Array.from,a=typeof Float16Array<"u"&&Float16Array.from;e&&(ur$1.set("int64",BigInt64Array),Qr$1.set(BigInt64Array,"int64")),i&&(ur$1.set("uint64",BigUint64Array),Qr$1.set(BigUint64Array,"uint64")),a?(ur$1.set("float16",Float16Array),Qr$1.set(Float16Array,"float16")):ur$1.set("float16",Uint16Array)}}}),as$1,ss$1,us$1=L(()=>{Cn(),as$1=e=>{let i=1;for(let a=0;a<e.length;a++){let o=e[a];if(typeof o!="number"||!Number.isSafeInteger(o))throw new TypeError(`dims[${a}] must be an integer, got: ${o}`);if(o<0)throw new RangeError(`dims[${a}] must be a non-negative integer, got: ${o}`);i*=o}return i},ss$1=(e,i)=>{switch(e.location){case"cpu":return new Je(e.type,e.data,i);case"cpu-pinned":return new Je({location:"cpu-pinned",data:e.data,type:e.type,dims:i});case"texture":return new Je({location:"texture",texture:e.texture,type:e.type,dims:i});case"gpu-buffer":return new Je({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:i});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}}}),Je,Cn=L(()=>{Ja$1(),rs$1(),is$1(),us$1(),Je=class{constructor(e,i,a){os$1();let o,c;if(typeof e=="object"&&"location"in e)switch(this.dataLocation=e.location,o=e.type,c=e.dims,e.location){case"cpu-pinned":{let d=ur$1.get(o);if(!d)throw new TypeError(`unsupported type "${o}" to create tensor from pinned buffer`);if(!(e.data instanceof d))throw new TypeError(`buffer should be of type ${d.name}`);this.cpuData=e.data;break}case"texture":{if(o!=="float32")throw new TypeError(`unsupported type "${o}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break}case"gpu-buffer":{if(o!=="float32"&&o!=="float16"&&o!=="int32"&&o!=="int64"&&o!=="uint32"&&o!=="uint8"&&o!=="bool")throw new TypeError(`unsupported type "${o}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let d,$;if(typeof e=="string")if(o=e,$=a,e==="string"){if(!Array.isArray(i))throw new TypeError("A string tensor's data must be a string array.");d=i}else{let et=ur$1.get(e);if(et===void 0)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(i)){if(e==="float16"&&et===Uint16Array)throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");e==="uint64"||e==="int64"?d=et.from(i,BigInt):d=et.from(i)}else if(i instanceof et)d=i;else throw new TypeError(`A ${o} tensor's data must be type of ${et}`)}else if($=i,Array.isArray(e)){if(e.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let et=typeof e[0];if(et==="string")o="string",d=e;else if(et==="boolean")o="bool",d=Uint8Array.from(e);else throw new TypeError(`Invalid element type of data array: ${et}.`)}else{let et=Qr$1.get(e.constructor);if(et===void 0)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);o=et,d=e}if($===void 0)$=[d.length];else if(!Array.isArray($))throw new TypeError("A tensor's dims must be a number array");c=$,this.cpuData=d,this.dataLocation="cpu"}let s=as$1(c);if(this.cpuData&&s!==this.cpuData.length)throw new Error(`Tensor's size(${s}) does not match data length(${this.cpuData.length}).`);this.type=o,this.dims=c,this.size=s}static async fromImage(e,i){return Za$1(e,i)}static fromTexture(e,i){return Qa$1(e,i)}static fromGpuBuffer(e,i){return es$1(e,i)}static fromPinnedBuffer(e,i,a){return ts$1(e,i,a)}toDataURL(e){return Xa$1(this,e)}toImageData(e){return Ka$1(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let i=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=i,e&&this.disposer&&(this.disposer(),this.disposer=void 0),i}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return ss$1(this,e)}}}),Me,Fn$1=L(()=>{Cn(),Me=Je}),ls$1,fs$1,lr$1,fr$1,Ho=L(()=>{Vo(),ls$1=(e,i)=>{(typeof ut$1.trace>"u"?!ut$1.wasm.trace:!ut$1.trace)||console.timeStamp(`${e}::ORT::${i}`)},fs$1=(e,i)=>{var c;let a=((c=new Error().stack)==null?void 0:c.split(/\r\n|\r|\n/g))||[],o=!1;for(let s=0;s<a.length;s++){if(o&&!a[s].includes("TRACE_FUNC")){let d=`FUNC_${e}::${a[s].trim().split(" ")[1]}`;i&&(d+=`::${i}`),ls$1("CPU",d);return}a[s].includes("TRACE_FUNC")&&(o=!0)}},lr$1=e=>{(typeof ut$1.trace>"u"?!ut$1.wasm.trace:!ut$1.trace)||fs$1("BEGIN",e)},fr$1=e=>{(typeof ut$1.trace>"u"?!ut$1.wasm.trace:!ut$1.trace)||fs$1("END",e)}}),$n,cs$1=L(()=>{Ln$1(),Fn$1(),Ho(),$n=class Wx{constructor(i){this.handler=i}async run(i,a,o){lr$1();let c={},s={};if(typeof i!="object"||i===null||i instanceof Me||Array.isArray(i))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let d=!0;if(typeof a=="object"){if(a===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(a instanceof Me)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(a)){if(a.length===0)throw new TypeError("'fetches' cannot be an empty array.");d=!1;for(let h of a){if(typeof h!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(h)===-1)throw new RangeError(`'fetches' contains invalid output name: ${h}.`);c[h]=null}if(typeof o=="object"&&o!==null)s=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else{let h=!1,b=Object.getOwnPropertyNames(a);for(let g of this.outputNames)if(b.indexOf(g)!==-1){let st=a[g];(st===null||st instanceof Me)&&(h=!0,d=!1,c[g]=st)}if(h){if(typeof o=="object"&&o!==null)s=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else s=a}}else if(typeof a<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let h of this.inputNames)if(typeof i[h]>"u")throw new Error(`input '${h}' is missing in 'feeds'.`);if(d)for(let h of this.outputNames)c[h]=null;let $=await this.handler.run(i,c,s),et={};for(let h in $)if(Object.hasOwnProperty.call($,h)){let b=$[h];b instanceof Me?et[h]=b:et[h]=new Me(b.type,b.data,b.dims)}return fr$1(),et}async release(){return this.handler.dispose()}static async create(i,a,o,c){lr$1();let s,d={};if(typeof i=="string"){if(s=i,typeof a=="object"&&a!==null)d=a;else if(typeof a<"u")throw new TypeError("'options' must be an object.")}else if(i instanceof Uint8Array){if(s=i,typeof a=="object"&&a!==null)d=a;else if(typeof a<"u")throw new TypeError("'options' must be an object.")}else if(i instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&i instanceof SharedArrayBuffer){let b=i,g=0,st=i.byteLength;if(typeof a=="object"&&a!==null)d=a;else if(typeof a=="number"){if(g=a,!Number.isSafeInteger(g))throw new RangeError("'byteOffset' must be an integer.");if(g<0||g>=b.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${b.byteLength}).`);if(st=i.byteLength-g,typeof o=="number"){if(st=o,!Number.isSafeInteger(st))throw new RangeError("'byteLength' must be an integer.");if(st<=0||g+st>b.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${b.byteLength-g}].`);if(typeof c=="object"&&c!==null)d=c;else if(typeof c<"u")throw new TypeError("'options' must be an object.")}else if(typeof o<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof a<"u")throw new TypeError("'options' must be an object.");s=new Uint8Array(b,g,st)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[$,et]=await Dn$1(d),h=await $.createInferenceSessionHandler(s,et);return fr$1(),new Wx(h)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}}),Pd$1,ps$1=L(()=>{cs$1(),Pd$1=$n}),ds$1=L(()=>{}),hs$1=L(()=>{}),ms$1=L(()=>{}),bs$1=L(()=>{}),Ed$1,kn$1,gs$1=L(()=>{Ln$1(),Fn$1(),Ed$1="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",kn$1=class Vx{constructor(i,a,o){this.handler=i,this.hasOptimizerModel=a,this.hasEvalModel=o}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static async create(i,a){let o=i.evalModel||"",c=i.optimizerModel||"",s=a||{},[d,$]=await Dn$1(s);if(d.createTrainingSessionHandler){let et=await d.createTrainingSessionHandler(i.checkpointState,i.trainModel,o,c,$);return new Vx(et,!!i.optimizerModel,!!i.evalModel)}else throw new Error(Ed$1)}typeNarrowingForRunStep(i,a,o,c,s){let d={},$={};if(typeof o!="object"||o===null||o instanceof Me||Array.isArray(o))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let et=!0;if(typeof c=="object"){if(c===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(c instanceof Me)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(c)){if(c.length===0)throw new TypeError("'fetches' cannot be an empty array.");et=!1;for(let h of c){if(typeof h!="string")throw new TypeError("'fetches' must be a string array or an object.");if(a.indexOf(h)===-1)throw new RangeError(`'fetches' contains invalid output name: ${h}.`);d[h]=null}if(typeof s=="object"&&s!==null)$=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else{let h=!1,b=Object.getOwnPropertyNames(c);for(let g of a)if(b.indexOf(g)!==-1){let st=c[g];(st===null||st instanceof Me)&&(h=!0,et=!1,d[g]=st)}if(h){if(typeof s=="object"&&s!==null)$=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else $=c}}else if(typeof c<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let h of i)if(typeof o[h]>"u")throw new Error(`input '${h}' is missing in 'feeds'.`);if(et)for(let h of a)d[h]=null;return[d,$]}convertHandlerReturnTypeToMapOfTensors(i){let a={};for(let o in i)if(Object.hasOwnProperty.call(i,o)){let c=i[o];c instanceof Me?a[o]=c:a[o]=new Me(c.type,c.data,c.dims)}return a}async lazyResetGrad(){await this.handler.lazyResetGrad()}async runTrainStep(i,a,o){let[c,s]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,i,a,o),d=await this.handler.runTrainStep(i,c,s);return this.convertHandlerReturnTypeToMapOfTensors(d)}async runOptimizerStep(i){if(this.hasOptimizerModel)await this.handler.runOptimizerStep(i||{});else throw new Error("This TrainingSession has no OptimizerModel loaded.")}async runEvalStep(i,a,o){if(this.hasEvalModel){let[c,s]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,i,a,o),d=await this.handler.runEvalStep(i,c,s);return this.convertHandlerReturnTypeToMapOfTensors(d)}else throw new Error("This TrainingSession has no EvalModel loaded.")}async getParametersSize(i=!0){return this.handler.getParametersSize(i)}async loadParametersBuffer(i,a=!0){let o=await this.getParametersSize(a);if(i.length!==4*o)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(i,a)}async getContiguousParameters(i=!0){return this.handler.getContiguousParameters(i)}async release(){return this.handler.dispose()}}}),Dd$1,ys$1=L(()=>{gs$1(),Dd$1=kn$1}),qo={};Sr(qo,{InferenceSession:()=>Pd$1,TRACE:()=>ls$1,TRACE_FUNC_BEGIN:()=>lr$1,TRACE_FUNC_END:()=>fr$1,Tensor:()=>Me,TrainingSession:()=>Dd$1,env:()=>Z,registerBackend:()=>Pr$1});var Ot$1=L(()=>{Wa(),Ya$1(),ps$1(),Fn$1(),ds$1(),hs$1(),Ho(),ms$1(),bs$1(),ys$1()});function Xt$1(e,i,a,o){if(i===void 0)return Cd$1(e);if(a===void 0)Bn$1(e,i);else if(typeof a=="number"&&o===void 0)Bn$1(e,i);else if(typeof a=="string"&&o===void 0)Bn$1(e,a,1,i);else if(typeof a=="string"&&typeof o=="number")Bn$1(e,a,o,i);else throw new TypeError("input is valid")}function Cd$1(e){return{verbose:Xt$1.verbose.bind(null,e),info:Xt$1.info.bind(null,e),warning:Xt$1.warning.bind(null,e),error:Xt$1.error.bind(null,e),fatal:Xt$1.fatal.bind(null,e)}}function Bn$1(e,i,a,o){let c=en$1[o||""]||en$1[""];xs$1[e]<xs$1[c.minimalSeverity]||(c.logDateTime&&(i=`${new Date().toISOString()}|${i}`),c.logSourceLocation,Ld$1[c.provider].log(e,i,o))}var jo,Yo,xs$1,Ld$1,ws$1,en$1,ce,Rn$1,Mn$1,Gn$1,Nn$1,lt$1=L(()=>{jo=class{log(e,i,a){}},Yo=class{log(e,i,a){console.log(`${this.color(e)} ${a?"\x1B[35m"+a+"\x1B[0m ":""}${i}`)}color(e){switch(e){case"verbose":return"\x1B[34;40mv\x1B[0m";case"info":return"\x1B[32mi\x1B[0m";case"warning":return"\x1B[30;43mw\x1B[0m";case"error":return"\x1B[31;40me\x1B[0m";case"fatal":return"\x1B[101mf\x1B[0m";default:throw new Error(`unsupported severity: ${e}`)}}},xs$1={verbose:1e3,info:2e3,warning:4e3,error:5e3,fatal:6e3},Ld$1={none:new jo,console:new Yo},ws$1={provider:"console",minimalSeverity:"warning",logDateTime:!0,logSourceLocation:!1},en$1={"":ws$1},(e=>{function i(h,b){e("verbose",h,b)}e.verbose=i;function a(h,b){e("info",h,b)}e.info=a;function o(h,b){e("warning",h,b)}e.warning=o;function c(h,b){e("error",h,b)}e.error=c;function s(h,b){e("fatal",h,b)}e.fatal=s;function d(h){en$1={},$("",h||{})}e.reset=d;function $(h,b){if(h==="*")d(b);else{let g=en$1[h]||ws$1;en$1[h]={provider:b.provider||g.provider,minimalSeverity:b.minimalSeverity||g.minimalSeverity,logDateTime:b.logDateTime===void 0?g.logDateTime:b.logDateTime,logSourceLocation:b.logSourceLocation===void 0?g.logSourceLocation:b.logSourceLocation}}}e.set=$;function et(h){let b={};h.logLevel&&(b.minimalSeverity=h.logLevel),$("",b)}e.setWithEnv=et})(Xt$1||(Xt$1={})),ce=Xt$1,Rn$1=class{constructor(e,i,a,o,c,s){this.category=e,this.name=i,this.startTime=a,this.endCallback=o,this.timer=c,this.ctx=s}async end(){return this.endCallback(this)}async checkTimer(){if(this.ctx===void 0||this.timer===void 0)throw new Error("No webgl timer found");return this.ctx.endTimer(),this.ctx.waitForQueryAndGetTime(this.timer)}},Mn$1=class{constructor(e,i,a,o){this.category=e,this.name=i,this.startTime=a,this.endTime=o}},Gn$1=class{constructor(e,i,a){this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=e===void 0?1e4:e,this._flushBatchSize=i===void 0?10:i,this._flushIntervalInMilliseconds=a===void 0?5e3:a}static create(e){return e===void 0?new this:new this(e.maxNumberEvents,e.flushBatchSize,e.flushIntervalInMilliseconds)}start(){this._started=!0,this._timingEvents=[],this._flushTime=Nn$1(),this._flushPointer=0}stop(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer])}event(e,i,a,o){let c=this._started?this.begin(e,i,o):void 0,s=!1,d=a();if(d&&typeof d.then=="function")return s=!0,new Promise(($,et)=>{d.then(async h=>{c&&await c.end(),$(h)},async h=>{c&&await c.end(),et(h)})});if(!s&&c){let $=c.end();if($&&typeof $.then=="function")return new Promise((et,h)=>{$.then(()=>{et(d)},b=>{h(b)})})}return d}begin(e,i,a){if(!this._started)throw new Error("profiler is not started yet");if(a===void 0){let o=Nn$1();return this.flush(o),new Rn$1(e,i,o,c=>this.endSync(c))}else{let o=a.beginTimer();return new Rn$1(e,i,0,async c=>this.end(c),o,a)}}async end(e){let i=await e.checkTimer();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new Mn$1(e.category,e.name,e.startTime,i)),this.flush(i))}endSync(e){let i=Nn$1();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new Mn$1(e.category,e.name,e.startTime,i)),this.flush(i))}logOneEvent(e){ce.verbose(`Profiler.${e.category}`,`${(e.endTime-e.startTime).toFixed(2)}ms on event '${e.name}' at ${e.endTime.toFixed(2)}`)}flush(e){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||e-this._flushTime>=this._flushIntervalInMilliseconds){for(let i=this._flushPointer;this._flushPointer<i+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=Nn$1()}}get started(){return this._started}},Nn$1=typeof performance<"u"&&performance.now?()=>performance.now():Date.now});function vs$1(e,i,a){for(let o of a){let c=o[0],s=o[1],d=o[2],$=o[3],et=o[4];if(e.opType===c){for(let h of i)if((h.domain===s||h.domain==="ai.onnx"&&s==="")&&Fd$1(h.version,d))return{opImpl:$,opInit:et}}}throw new TypeError(`cannot resolve operator '${e.opType}' with opsets: ${i.map(o=>`${o.domain||"ai.onnx"} v${o.version}`).join(", ")}`)}function Fd$1(e,i){if(i.endsWith("+")){let a=Number.parseInt(i.substring(0,i.length-1),10);return!isNaN(a)&&a<=e}else if(i.split("-").length===2){let a=i.split("-"),o=Number.parseInt(a[0],10),c=Number.parseInt(a[1],10);return!isNaN(o)&&!isNaN(c)&&o<=e&&e<=c}else return Number.parseInt(i,10)===e}var _s$1=L(()=>{}),Os$1=me(e=>{e.__esModule=!0;var i=function(){function a(o){if(!o)throw new TypeError("Invalid argument; `value` has no value.");this.value=a.EMPTY,o&&a.isGuid(o)&&(this.value=o)}return a.isGuid=function(o){var c=o.toString();return o&&(o instanceof a||a.validator.test(c))},a.create=function(){return new a([a.gen(2),a.gen(1),a.gen(1),a.gen(1),a.gen(3)].join("-"))},a.createEmpty=function(){return new a("emptyguid")},a.parse=function(o){return new a(o)},a.raw=function(){return[a.gen(2),a.gen(1),a.gen(1),a.gen(1),a.gen(3)].join("-")},a.gen=function(o){for(var c="",s=0;s<o;s++)c+=((1+Math.random())*65536|0).toString(16).substring(1);return c},a.prototype.equals=function(o){return a.isGuid(o)&&this.value===o.toString()},a.prototype.isEmpty=function(){return this.value===a.EMPTY},a.prototype.toString=function(){return this.value},a.prototype.toJSON=function(){return{value:this.value}},a.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),a.EMPTY="00000000-0000-0000-0000-000000000000",a}();e.Guid=i});function be(e,i,a){this.low=e|0,this.high=i|0,this.unsigned=!!a}function Xe(e){return(e&&e.__isLong__)===!0}function Is$1(e){var i=Math.clz32(e&-e);return e?31-i:i}function cr$1(e,i){var a,o,c;return i?(e>>>=0,(c=0<=e&&e<256)&&(o=As$1[e],o)?o:(a=le(e,0,!0),c&&(As$1[e]=a),a)):(e|=0,(c=-128<=e&&e<128)&&(o=Ss$1[e],o)?o:(a=le(e,e<0?-1:0,!1),c&&(Ss$1[e]=a),a))}function ct(e,i){if(isNaN(e))return i?zt$1:It;if(i){if(e<0)return zt$1;if(e>=Ls$1)return $s$1}else{if(e<=-Es$1)return nt$1;if(e+1>=Es$1)return Fs$1}return e<0?ct(-e,i).neg():le(e%Dr|0,e/Dr|0,i)}function le(e,i,a){return new be(e,i,a)}function Jo(e,i,a){if(e.length===0)throw Error("empty string");if(typeof i=="number"?(a=i,i=!1):i=!!i,e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return i?zt$1:It;if(a=a||10,a<2||36<a)throw RangeError("radix");var o;if((o=e.indexOf("-"))>0)throw Error("interior hyphen");if(o===0)return Jo(e.substring(1),i,a).neg();for(var c=ct(Un$1(a,8)),s=It,d=0;d<e.length;d+=8){var $=Math.min(8,e.length-d),et=parseInt(e.substring(d,d+$),a);if($<8){var h=ct(Un$1(a,$));s=s.mul(h).add(ct(et))}else s=s.mul(c),s=s.add(ct(et))}return s.unsigned=i,s}function St$1(e,i){return typeof e=="number"?ct(e,i):typeof e=="string"?Jo(e,i):le(e.low,e.high,typeof i=="boolean"?i:e.unsigned)}var ft,Ss$1,As$1,Un$1,Ps$1,kd$1,Dr,Ls$1,Es$1,Ds$1,It,zt$1,Er$1,Cs$1,Ko,Fs$1,$s$1,nt$1,B,Vt,Zo=L(()=>{ft=null;try{ft=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}be.prototype.__isLong__,Object.defineProperty(be.prototype,"__isLong__",{value:!0}),be.isLong=Xe,Ss$1={},As$1={},be.fromInt=cr$1,be.fromNumber=ct,be.fromBits=le,Un$1=Math.pow,be.fromString=Jo,be.fromValue=St$1,Ps$1=65536,kd$1=1<<24,Dr=Ps$1*Ps$1,Ls$1=Dr*Dr,Es$1=Ls$1/2,Ds$1=cr$1(kd$1),It=cr$1(0),be.ZERO=It,zt$1=cr$1(0,!0),be.UZERO=zt$1,Er$1=cr$1(1),be.ONE=Er$1,Cs$1=cr$1(1,!0),be.UONE=Cs$1,Ko=cr$1(-1),be.NEG_ONE=Ko,Fs$1=le(-1,2147483647,!1),be.MAX_VALUE=Fs$1,$s$1=le(-1,-1,!0),be.MAX_UNSIGNED_VALUE=$s$1,nt$1=le(0,-2147483648,!1),be.MIN_VALUE=nt$1,B=be.prototype,B.toInt=function(){return this.unsigned?this.low>>>0:this.low},B.toNumber=function(){return this.unsigned?(this.high>>>0)*Dr+(this.low>>>0):this.high*Dr+(this.low>>>0)},B.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(nt$1)){var i=ct(e),a=this.div(i),o=a.mul(i).sub(this);return a.toString(e)+o.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var c=ct(Un$1(e,6),this.unsigned),s=this,d="";;){var $=s.div(c),et=s.sub($.mul(c)).toInt()>>>0,h=et.toString(e);if(s=$,s.isZero())return h+d;for(;h.length<6;)h="0"+h;d=""+h+d}},B.getHighBits=function(){return this.high},B.getHighBitsUnsigned=function(){return this.high>>>0},B.getLowBits=function(){return this.low},B.getLowBitsUnsigned=function(){return this.low>>>0},B.getNumBitsAbs=function(){if(this.isNegative())return this.eq(nt$1)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,i=31;i>0&&!(e&1<<i);i--);return this.high!=0?i+33:i+1},B.isZero=function(){return this.high===0&&this.low===0},B.eqz=B.isZero,B.isNegative=function(){return!this.unsigned&&this.high<0},B.isPositive=function(){return this.unsigned||this.high>=0},B.isOdd=function(){return(this.low&1)===1},B.isEven=function(){return(this.low&1)===0},B.equals=function(e){return Xe(e)||(e=St$1(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low},B.eq=B.equals,B.notEquals=function(e){return!this.eq(e)},B.neq=B.notEquals,B.ne=B.notEquals,B.lessThan=function(e){return this.comp(e)<0},B.lt=B.lessThan,B.lessThanOrEqual=function(e){return this.comp(e)<=0},B.lte=B.lessThanOrEqual,B.le=B.lessThanOrEqual,B.greaterThan=function(e){return this.comp(e)>0},B.gt=B.greaterThan,B.greaterThanOrEqual=function(e){return this.comp(e)>=0},B.gte=B.greaterThanOrEqual,B.ge=B.greaterThanOrEqual,B.compare=function(e){if(Xe(e)||(e=St$1(e)),this.eq(e))return 0;var i=this.isNegative(),a=e.isNegative();return i&&!a?-1:!i&&a?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},B.comp=B.compare,B.negate=function(){return!this.unsigned&&this.eq(nt$1)?nt$1:this.not().add(Er$1)},B.neg=B.negate,B.add=function(e){Xe(e)||(e=St$1(e));var i=this.high>>>16,a=this.high&65535,o=this.low>>>16,c=this.low&65535,s=e.high>>>16,d=e.high&65535,$=e.low>>>16,et=e.low&65535,h=0,b=0,g=0,st=0;return st+=c+et,g+=st>>>16,st&=65535,g+=o+$,b+=g>>>16,g&=65535,b+=a+d,h+=b>>>16,b&=65535,h+=i+s,h&=65535,le(g<<16|st,h<<16|b,this.unsigned)},B.subtract=function(e){return Xe(e)||(e=St$1(e)),this.add(e.neg())},B.sub=B.subtract,B.multiply=function(e){if(this.isZero())return this;if(Xe(e)||(e=St$1(e)),ft){var i=ft.mul(this.low,this.high,e.low,e.high);return le(i,ft.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?zt$1:It;if(this.eq(nt$1))return e.isOdd()?nt$1:It;if(e.eq(nt$1))return this.isOdd()?nt$1:It;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(Ds$1)&&e.lt(Ds$1))return ct(this.toNumber()*e.toNumber(),this.unsigned);var a=this.high>>>16,o=this.high&65535,c=this.low>>>16,s=this.low&65535,d=e.high>>>16,$=e.high&65535,et=e.low>>>16,h=e.low&65535,b=0,g=0,st=0,$t=0;return $t+=s*h,st+=$t>>>16,$t&=65535,st+=c*h,g+=st>>>16,st&=65535,st+=s*et,g+=st>>>16,st&=65535,g+=o*h,b+=g>>>16,g&=65535,g+=c*et,b+=g>>>16,g&=65535,g+=s*$,b+=g>>>16,g&=65535,b+=a*h+o*et+c*$+s*d,b&=65535,le(st<<16|$t,b<<16|g,this.unsigned)},B.mul=B.multiply,B.divide=function(e){if(Xe(e)||(e=St$1(e)),e.isZero())throw Error("division by zero");if(ft){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var i=(this.unsigned?ft.div_u:ft.div_s)(this.low,this.high,e.low,e.high);return le(i,ft.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?zt$1:It;var a,o,c;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return zt$1;if(e.gt(this.shru(1)))return Cs$1;c=zt$1}else{if(this.eq(nt$1)){if(e.eq(Er$1)||e.eq(Ko))return nt$1;if(e.eq(nt$1))return Er$1;var s=this.shr(1);return a=s.div(e).shl(1),a.eq(It)?e.isNegative()?Er$1:Ko:(o=this.sub(e.mul(a)),c=a.add(o.div(e)),c)}else if(e.eq(nt$1))return this.unsigned?zt$1:It;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();c=It}for(o=this;o.gte(e);){a=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var d=Math.ceil(Math.log(a)/Math.LN2),$=d<=48?1:Un$1(2,d-48),et=ct(a),h=et.mul(e);h.isNegative()||h.gt(o);)a-=$,et=ct(a,this.unsigned),h=et.mul(e);et.isZero()&&(et=Er$1),c=c.add(et),o=o.sub(h)}return c},B.div=B.divide,B.modulo=function(e){if(Xe(e)||(e=St$1(e)),ft){var i=(this.unsigned?ft.rem_u:ft.rem_s)(this.low,this.high,e.low,e.high);return le(i,ft.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))},B.mod=B.modulo,B.rem=B.modulo,B.not=function(){return le(~this.low,~this.high,this.unsigned)},B.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},B.clz=B.countLeadingZeros,B.countTrailingZeros=function(){return this.low?Is$1(this.low):Is$1(this.high)+32},B.ctz=B.countTrailingZeros,B.and=function(e){return Xe(e)||(e=St$1(e)),le(this.low&e.low,this.high&e.high,this.unsigned)},B.or=function(e){return Xe(e)||(e=St$1(e)),le(this.low|e.low,this.high|e.high,this.unsigned)},B.xor=function(e){return Xe(e)||(e=St$1(e)),le(this.low^e.low,this.high^e.high,this.unsigned)},B.shiftLeft=function(e){return Xe(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?le(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):le(0,this.low<<e-32,this.unsigned)},B.shl=B.shiftLeft,B.shiftRight=function(e){return Xe(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?le(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):le(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},B.shr=B.shiftRight,B.shiftRightUnsigned=function(e){return Xe(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?le(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?le(this.high,0,this.unsigned):le(this.high>>>e-32,0,this.unsigned)},B.shru=B.shiftRightUnsigned,B.shr_u=B.shiftRightUnsigned,B.rotateLeft=function(e){var i;return Xe(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?le(this.high,this.low,this.unsigned):e<32?(i=32-e,le(this.low<<e|this.high>>>i,this.high<<e|this.low>>>i,this.unsigned)):(e-=32,i=32-e,le(this.high<<e|this.low>>>i,this.low<<e|this.high>>>i,this.unsigned))},B.rotl=B.rotateLeft,B.rotateRight=function(e){var i;return Xe(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?le(this.high,this.low,this.unsigned):e<32?(i=32-e,le(this.high<<i|this.low>>>e,this.low<<i|this.high>>>e,this.unsigned)):(e-=32,i=32-e,le(this.low<<i|this.high>>>e,this.high<<i|this.low>>>e,this.unsigned))},B.rotr=B.rotateRight,B.toSigned=function(){return this.unsigned?le(this.low,this.high,!1):this},B.toUnsigned=function(){return this.unsigned?this:le(this.low,this.high,!0)},B.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},B.toBytesLE=function(){var e=this.high,i=this.low;return[i&255,i>>>8&255,i>>>16&255,i>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]},B.toBytesBE=function(){var e=this.high,i=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,i>>>24,i>>>16&255,i>>>8&255,i&255]},be.fromBytes=function(e,i,a){return a?be.fromBytesLE(e,i):be.fromBytesBE(e,i)},be.fromBytesLE=function(e,i){return new be(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,i)},be.fromBytesBE=function(e,i){return new be(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],i)},Vt=be}),_,zn$1=L(()=>{_={},_.Offset,_.Table,_.SIZEOF_SHORT=2,_.SIZEOF_INT=4,_.FILE_IDENTIFIER_LENGTH=4,_.SIZE_PREFIX_LENGTH=4,_.Encoding={UTF8_BYTES:1,UTF16_STRING:2},_.int32=new Int32Array(2),_.float32=new Float32Array(_.int32.buffer),_.float64=new Float64Array(_.int32.buffer),_.isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1,_.Long=function(e,i){this.low=e|0,this.high=i|0},_.Long.create=function(e,i){return e==0&&i==0?_.Long.ZERO:new _.Long(e,i)},_.Long.prototype.toFloat64=function(){return(this.low>>>0)+this.high*4294967296},_.Long.prototype.equals=function(e){return this.low==e.low&&this.high==e.high},_.Long.ZERO=new _.Long(0,0),_.Builder=function(e){if(e)var i=e;else var i=1024;this.bb=_.ByteBuffer.allocate(i),this.space=i,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},_.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},_.Builder.prototype.forceDefaults=function(e){this.force_defaults=e},_.Builder.prototype.dataBuffer=function(){return this.bb},_.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},_.Builder.prototype.prep=function(e,i){e>this.minalign&&(this.minalign=e);for(var a=~(this.bb.capacity()-this.space+i)+1&e-1;this.space<a+e+i;){var o=this.bb.capacity();this.bb=_.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-o}this.pad(a)},_.Builder.prototype.pad=function(e){for(var i=0;i<e;i++)this.bb.writeInt8(--this.space,0)},_.Builder.prototype.writeInt8=function(e){this.bb.writeInt8(this.space-=1,e)},_.Builder.prototype.writeInt16=function(e){this.bb.writeInt16(this.space-=2,e)},_.Builder.prototype.writeInt32=function(e){this.bb.writeInt32(this.space-=4,e)},_.Builder.prototype.writeInt64=function(e){this.bb.writeInt64(this.space-=8,e)},_.Builder.prototype.writeFloat32=function(e){this.bb.writeFloat32(this.space-=4,e)},_.Builder.prototype.writeFloat64=function(e){this.bb.writeFloat64(this.space-=8,e)},_.Builder.prototype.addInt8=function(e){this.prep(1,0),this.writeInt8(e)},_.Builder.prototype.addInt16=function(e){this.prep(2,0),this.writeInt16(e)},_.Builder.prototype.addInt32=function(e){this.prep(4,0),this.writeInt32(e)},_.Builder.prototype.addInt64=function(e){this.prep(8,0),this.writeInt64(e)},_.Builder.prototype.addFloat32=function(e){this.prep(4,0),this.writeFloat32(e)},_.Builder.prototype.addFloat64=function(e){this.prep(8,0),this.writeFloat64(e)},_.Builder.prototype.addFieldInt8=function(e,i,a){(this.force_defaults||i!=a)&&(this.addInt8(i),this.slot(e))},_.Builder.prototype.addFieldInt16=function(e,i,a){(this.force_defaults||i!=a)&&(this.addInt16(i),this.slot(e))},_.Builder.prototype.addFieldInt32=function(e,i,a){(this.force_defaults||i!=a)&&(this.addInt32(i),this.slot(e))},_.Builder.prototype.addFieldInt64=function(e,i,a){(this.force_defaults||!i.equals(a))&&(this.addInt64(i),this.slot(e))},_.Builder.prototype.addFieldFloat32=function(e,i,a){(this.force_defaults||i!=a)&&(this.addFloat32(i),this.slot(e))},_.Builder.prototype.addFieldFloat64=function(e,i,a){(this.force_defaults||i!=a)&&(this.addFloat64(i),this.slot(e))},_.Builder.prototype.addFieldOffset=function(e,i,a){(this.force_defaults||i!=a)&&(this.addOffset(i),this.slot(e))},_.Builder.prototype.addFieldStruct=function(e,i,a){i!=a&&(this.nested(i),this.slot(e))},_.Builder.prototype.nested=function(e){if(e!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},_.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},_.Builder.prototype.slot=function(e){this.vtable[e]=this.offset()},_.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},_.Builder.growByteBuffer=function(e){var i=e.capacity();if(i&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var a=i<<1,o=_.ByteBuffer.allocate(a);return o.setPosition(a-i),o.bytes().set(e.bytes(),a-i),o},_.Builder.prototype.addOffset=function(e){this.prep(_.SIZEOF_INT,0),this.writeInt32(this.offset()-e+_.SIZEOF_INT)},_.Builder.prototype.startObject=function(e){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=e;for(var i=0;i<e;i++)this.vtable[i]=0;this.isNested=!0,this.object_start=this.offset()},_.Builder.prototype.endObject=function(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var e=this.offset(),i=this.vtable_in_use-1;i>=0&&this.vtable[i]==0;i--);for(var a=i+1;i>=0;i--)this.addInt16(this.vtable[i]!=0?e-this.vtable[i]:0);var o=2;this.addInt16(e-this.object_start);var c=(a+o)*_.SIZEOF_SHORT;this.addInt16(c);var s=0,d=this.space;e:for(i=0;i<this.vtables.length;i++){var $=this.bb.capacity()-this.vtables[i];if(c==this.bb.readInt16($)){for(var et=_.SIZEOF_SHORT;et<c;et+=_.SIZEOF_SHORT)if(this.bb.readInt16(d+et)!=this.bb.readInt16($+et))continue e;s=this.vtables[i];break}}return s?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,s-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e},_.Builder.prototype.finish=function(e,i,a){var o=a?_.SIZE_PREFIX_LENGTH:0;if(i){var c=i;if(this.prep(this.minalign,_.SIZEOF_INT+_.FILE_IDENTIFIER_LENGTH+o),c.length!=_.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+_.FILE_IDENTIFIER_LENGTH);for(var s=_.FILE_IDENTIFIER_LENGTH-1;s>=0;s--)this.writeInt8(c.charCodeAt(s))}this.prep(this.minalign,_.SIZEOF_INT+o),this.addOffset(e),o&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)},_.Builder.prototype.finishSizePrefixed=function(e,i){this.finish(e,i,!0)},_.Builder.prototype.requiredField=function(e,i){var a=this.bb.capacity()-e,o=a-this.bb.readInt32(a),c=this.bb.readInt16(o+i)!=0;if(!c)throw new Error("FlatBuffers: field "+i+" must be set")},_.Builder.prototype.startVector=function(e,i,a){this.notNested(),this.vector_num_elems=i,this.prep(_.SIZEOF_INT,e*i),this.prep(a,e*i)},_.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},_.Builder.prototype.createString=function(e){if(e instanceof Uint8Array)var i=e;else for(var i=[],a=0;a<e.length;){var o,c=e.charCodeAt(a++);if(c<55296||c>=56320)o=c;else{var s=e.charCodeAt(a++);o=(c<<10)+s+(65536-56623104-56320)}o<128?i.push(o):(o<2048?i.push(o>>6&31|192):(o<65536?i.push(o>>12&15|224):i.push(o>>18&7|240,o>>12&63|128),i.push(o>>6&63|128)),i.push(o&63|128))}this.addInt8(0),this.startVector(1,i.length,1),this.bb.setPosition(this.space-=i.length);for(var a=0,d=this.space,$=this.bb.bytes();a<i.length;a++)$[d++]=i[a];return this.endVector()},_.Builder.prototype.createLong=function(e,i){return _.Long.create(e,i)},_.ByteBuffer=function(e){this.bytes_=e,this.position_=0},_.ByteBuffer.allocate=function(e){return new _.ByteBuffer(new Uint8Array(e))},_.ByteBuffer.prototype.clear=function(){this.position_=0},_.ByteBuffer.prototype.bytes=function(){return this.bytes_},_.ByteBuffer.prototype.position=function(){return this.position_},_.ByteBuffer.prototype.setPosition=function(e){this.position_=e},_.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},_.ByteBuffer.prototype.readInt8=function(e){return this.readUint8(e)<<24>>24},_.ByteBuffer.prototype.readUint8=function(e){return this.bytes_[e]},_.ByteBuffer.prototype.readInt16=function(e){return this.readUint16(e)<<16>>16},_.ByteBuffer.prototype.readUint16=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8},_.ByteBuffer.prototype.readInt32=function(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24},_.ByteBuffer.prototype.readUint32=function(e){return this.readInt32(e)>>>0},_.ByteBuffer.prototype.readInt64=function(e){return new _.Long(this.readInt32(e),this.readInt32(e+4))},_.ByteBuffer.prototype.readUint64=function(e){return new _.Long(this.readUint32(e),this.readUint32(e+4))},_.ByteBuffer.prototype.readFloat32=function(e){return _.int32[0]=this.readInt32(e),_.float32[0]},_.ByteBuffer.prototype.readFloat64=function(e){return _.int32[_.isLittleEndian?0:1]=this.readInt32(e),_.int32[_.isLittleEndian?1:0]=this.readInt32(e+4),_.float64[0]},_.ByteBuffer.prototype.writeInt8=function(e,i){this.bytes_[e]=i},_.ByteBuffer.prototype.writeUint8=function(e,i){this.bytes_[e]=i},_.ByteBuffer.prototype.writeInt16=function(e,i){this.bytes_[e]=i,this.bytes_[e+1]=i>>8},_.ByteBuffer.prototype.writeUint16=function(e,i){this.bytes_[e]=i,this.bytes_[e+1]=i>>8},_.ByteBuffer.prototype.writeInt32=function(e,i){this.bytes_[e]=i,this.bytes_[e+1]=i>>8,this.bytes_[e+2]=i>>16,this.bytes_[e+3]=i>>24},_.ByteBuffer.prototype.writeUint32=function(e,i){this.bytes_[e]=i,this.bytes_[e+1]=i>>8,this.bytes_[e+2]=i>>16,this.bytes_[e+3]=i>>24},_.ByteBuffer.prototype.writeInt64=function(e,i){this.writeInt32(e,i.low),this.writeInt32(e+4,i.high)},_.ByteBuffer.prototype.writeUint64=function(e,i){this.writeUint32(e,i.low),this.writeUint32(e+4,i.high)},_.ByteBuffer.prototype.writeFloat32=function(e,i){_.float32[0]=i,this.writeInt32(e,_.int32[0])},_.ByteBuffer.prototype.writeFloat64=function(e,i){_.float64[0]=i,this.writeInt32(e,_.int32[_.isLittleEndian?0:1]),this.writeInt32(e+4,_.int32[_.isLittleEndian?1:0])},_.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+_.SIZEOF_INT+_.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var e="",i=0;i<_.FILE_IDENTIFIER_LENGTH;i++)e+=String.fromCharCode(this.readInt8(this.position_+_.SIZEOF_INT+i));return e},_.ByteBuffer.prototype.__offset=function(e,i){var a=e-this.readInt32(e);return i<this.readInt16(a)?this.readInt16(a+i):0},_.ByteBuffer.prototype.__union=function(e,i){return e.bb_pos=i+this.readInt32(i),e.bb=this,e},_.ByteBuffer.prototype.__string=function(e,i){e+=this.readInt32(e);var a=this.readInt32(e),o="",c=0;if(e+=_.SIZEOF_INT,i===_.Encoding.UTF8_BYTES)return this.bytes_.subarray(e,e+a);for(;c<a;){var s,d=this.readUint8(e+c++);if(d<192)s=d;else{var $=this.readUint8(e+c++);if(d<224)s=(d&31)<<6|$&63;else{var et=this.readUint8(e+c++);if(d<240)s=(d&15)<<12|($&63)<<6|et&63;else{var h=this.readUint8(e+c++);s=(d&7)<<18|($&63)<<12|(et&63)<<6|h&63}}}s<65536?o+=String.fromCharCode(s):(s-=65536,o+=String.fromCharCode((s>>10)+55296,(s&1024-1)+56320))}return o},_.ByteBuffer.prototype.__indirect=function(e){return e+this.readInt32(e)},_.ByteBuffer.prototype.__vector=function(e){return e+this.readInt32(e)+_.SIZEOF_INT},_.ByteBuffer.prototype.__vector_len=function(e){return this.readInt32(e+this.readInt32(e))},_.ByteBuffer.prototype.__has_identifier=function(e){if(e.length!=_.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+_.FILE_IDENTIFIER_LENGTH);for(var i=0;i<_.FILE_IDENTIFIER_LENGTH;i++)if(e.charCodeAt(i)!=this.readInt8(this.position_+_.SIZEOF_INT+i))return!1;return!0},_.ByteBuffer.prototype.createLong=function(e,i){return _.Long.create(e,i)}}),V,tn$1=L(()=>{zn$1(),(e=>{(i=>{(a=>{(o=>(o[o.UNDEFINED=0]="UNDEFINED",o[o.FLOAT=1]="FLOAT",o[o.INT=2]="INT",o[o.STRING=3]="STRING",o[o.TENSOR=4]="TENSOR",o[o.GRAPH=5]="GRAPH",o[o.FLOATS=6]="FLOATS",o[o.INTS=7]="INTS",o[o.STRINGS=8]="STRINGS",o[o.TENSORS=9]="TENSORS",o[o.GRAPHS=10]="GRAPHS",o[o.SPARSE_TENSOR=11]="SPARSE_TENSOR",o[o.SPARSE_TENSORS=12]="SPARSE_TENSORS"))(a.AttributeType||(a.AttributeType={}))})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{(o=>(o[o.UNKNOWN=0]="UNKNOWN",o[o.VALUE=1]="VALUE",o[o.PARAM=2]="PARAM"))(a.DimensionValueType||(a.DimensionValueType={}))})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{(o=>(o[o.UNDEFINED=0]="UNDEFINED",o[o.FLOAT=1]="FLOAT",o[o.UINT8=2]="UINT8",o[o.INT8=3]="INT8",o[o.UINT16=4]="UINT16",o[o.INT16=5]="INT16",o[o.INT32=6]="INT32",o[o.INT64=7]="INT64",o[o.STRING=8]="STRING",o[o.BOOL=9]="BOOL",o[o.FLOAT16=10]="FLOAT16",o[o.DOUBLE=11]="DOUBLE",o[o.UINT32=12]="UINT32",o[o.UINT64=13]="UINT64",o[o.COMPLEX64=14]="COMPLEX64",o[o.COMPLEX128=15]="COMPLEX128",o[o.BFLOAT16=16]="BFLOAT16",o[o.FLOAT8E4M3FN=17]="FLOAT8E4M3FN",o[o.FLOAT8E4M3FNUZ=18]="FLOAT8E4M3FNUZ",o[o.FLOAT8E5M2=19]="FLOAT8E5M2",o[o.FLOAT8E5M2FNUZ=20]="FLOAT8E5M2FNUZ"))(a.TensorDataType||(a.TensorDataType={}))})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{(o=>(o[o.Primitive=0]="Primitive",o[o.Fused=1]="Fused"))(a.NodeType||(a.NodeType={}))})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{(o=>(o[o.NONE=0]="NONE",o[o.tensor_type=1]="tensor_type",o[o.sequence_type=2]="sequence_type",o[o.map_type=3]="map_type"))(a.TypeInfoValue||(a.TypeInfoValue={}))})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsShape(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsShape(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}dim(s,d){let $=this.bb.__offset(this.bb_pos,4);return $?(d||new e.experimental.fbs.Dimension).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+$)+s*4),this.bb):null}dimLength(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.__vector_len(this.bb_pos+s):0}static startShape(s){s.startObject(1)}static addDim(s,d){s.addFieldOffset(0,d,0)}static createDimVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startDimVector(s,d){s.startVector(4,d,4)}static endShape(s){return s.endObject()}static createShape(s,d){return o.startShape(s),o.addDim(s,d),o.endShape(s)}}a.Shape=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsDimension(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsDimension(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}value(s){let d=this.bb.__offset(this.bb_pos,4);return d?(s||new e.experimental.fbs.DimensionValue).__init(this.bb.__indirect(this.bb_pos+d),this.bb):null}denotation(s){let d=this.bb.__offset(this.bb_pos,6);return d?this.bb.__string(this.bb_pos+d,s):null}static startDimension(s){s.startObject(2)}static addValue(s,d){s.addFieldOffset(0,d,0)}static addDenotation(s,d){s.addFieldOffset(1,d,0)}static endDimension(s){return s.endObject()}static createDimension(s,d,$){return o.startDimension(s),o.addValue(s,d),o.addDenotation(s,$),o.endDimension(s)}}a.Dimension=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsDimensionValue(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsDimensionValue(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}dimType(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt8(this.bb_pos+s):0}dimValue(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}dimParam(s){let d=this.bb.__offset(this.bb_pos,8);return d?this.bb.__string(this.bb_pos+d,s):null}static startDimensionValue(s){s.startObject(3)}static addDimType(s,d){s.addFieldInt8(0,d,0)}static addDimValue(s,d){s.addFieldInt64(1,d,s.createLong(0,0))}static addDimParam(s,d){s.addFieldOffset(2,d,0)}static endDimensionValue(s){return s.endObject()}static createDimensionValue(s,d,$,et){return o.startDimensionValue(s),o.addDimType(s,d),o.addDimValue(s,$),o.addDimParam(s,et),o.endDimensionValue(s)}}a.DimensionValue=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsTensorTypeAndShape(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsTensorTypeAndShape(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}elemType(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt32(this.bb_pos+s):0}shape(s){let d=this.bb.__offset(this.bb_pos,6);return d?(s||new e.experimental.fbs.Shape).__init(this.bb.__indirect(this.bb_pos+d),this.bb):null}static startTensorTypeAndShape(s){s.startObject(2)}static addElemType(s,d){s.addFieldInt32(0,d,0)}static addShape(s,d){s.addFieldOffset(1,d,0)}static endTensorTypeAndShape(s){return s.endObject()}static createTensorTypeAndShape(s,d,$){return o.startTensorTypeAndShape(s),o.addElemType(s,d),o.addShape(s,$),o.endTensorTypeAndShape(s)}}a.TensorTypeAndShape=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsMapType(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsMapType(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}keyType(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt32(this.bb_pos+s):0}valueType(s){let d=this.bb.__offset(this.bb_pos,6);return d?(s||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+d),this.bb):null}static startMapType(s){s.startObject(2)}static addKeyType(s,d){s.addFieldInt32(0,d,0)}static addValueType(s,d){s.addFieldOffset(1,d,0)}static endMapType(s){return s.endObject()}static createMapType(s,d,$){return o.startMapType(s),o.addKeyType(s,d),o.addValueType(s,$),o.endMapType(s)}}a.MapType=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsSequenceType(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsSequenceType(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}elemType(s){let d=this.bb.__offset(this.bb_pos,4);return d?(s||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+d),this.bb):null}static startSequenceType(s){s.startObject(1)}static addElemType(s,d){s.addFieldOffset(0,d,0)}static endSequenceType(s){return s.endObject()}static createSequenceType(s,d){return o.startSequenceType(s),o.addElemType(s,d),o.endSequenceType(s)}}a.SequenceType=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}nodeIndex(){return this.bb.readUint32(this.bb_pos)}srcArgIndex(){return this.bb.readInt32(this.bb_pos+4)}dstArgIndex(){return this.bb.readInt32(this.bb_pos+8)}static createEdgeEnd(s,d,$,et){return s.prep(4,12),s.writeInt32(et),s.writeInt32($),s.writeInt32(d),s.offset()}}a.EdgeEnd=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsNodeEdge(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsNodeEdge(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}nodeIndex(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readUint32(this.bb_pos+s):0}inputEdges(s,d){let $=this.bb.__offset(this.bb_pos,6);return $?(d||new e.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+$)+s*12,this.bb):null}inputEdgesLength(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.__vector_len(this.bb_pos+s):0}outputEdges(s,d){let $=this.bb.__offset(this.bb_pos,8);return $?(d||new e.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+$)+s*12,this.bb):null}outputEdgesLength(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.__vector_len(this.bb_pos+s):0}static startNodeEdge(s){s.startObject(3)}static addNodeIndex(s,d){s.addFieldInt32(0,d,0)}static addInputEdges(s,d){s.addFieldOffset(1,d,0)}static startInputEdgesVector(s,d){s.startVector(12,d,4)}static addOutputEdges(s,d){s.addFieldOffset(2,d,0)}static startOutputEdgesVector(s,d){s.startVector(12,d,4)}static endNodeEdge(s){return s.endObject()}static createNodeEdge(s,d,$,et){return o.startNodeEdge(s),o.addNodeIndex(s,d),o.addInputEdges(s,$),o.addOutputEdges(s,et),o.endNodeEdge(s)}}a.NodeEdge=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsNode(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsNode(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}name(s){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.__string(this.bb_pos+d,s):null}docString(s){let d=this.bb.__offset(this.bb_pos,6);return d?this.bb.__string(this.bb_pos+d,s):null}domain(s){let d=this.bb.__offset(this.bb_pos,8);return d?this.bb.__string(this.bb_pos+d,s):null}sinceVersion(){let s=this.bb.__offset(this.bb_pos,10);return s?this.bb.readInt32(this.bb_pos+s):0}index(){let s=this.bb.__offset(this.bb_pos,12);return s?this.bb.readUint32(this.bb_pos+s):0}opType(s){let d=this.bb.__offset(this.bb_pos,14);return d?this.bb.__string(this.bb_pos+d,s):null}type(){let s=this.bb.__offset(this.bb_pos,16);return s?this.bb.readInt32(this.bb_pos+s):0}executionProviderType(s){let d=this.bb.__offset(this.bb_pos,18);return d?this.bb.__string(this.bb_pos+d,s):null}inputs(s,d){let $=this.bb.__offset(this.bb_pos,20);return $?this.bb.__string(this.bb.__vector(this.bb_pos+$)+s*4,d):null}inputsLength(){let s=this.bb.__offset(this.bb_pos,20);return s?this.bb.__vector_len(this.bb_pos+s):0}outputs(s,d){let $=this.bb.__offset(this.bb_pos,22);return $?this.bb.__string(this.bb.__vector(this.bb_pos+$)+s*4,d):null}outputsLength(){let s=this.bb.__offset(this.bb_pos,22);return s?this.bb.__vector_len(this.bb_pos+s):0}attributes(s,d){let $=this.bb.__offset(this.bb_pos,24);return $?(d||new e.experimental.fbs.Attribute).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+$)+s*4),this.bb):null}attributesLength(){let s=this.bb.__offset(this.bb_pos,24);return s?this.bb.__vector_len(this.bb_pos+s):0}inputArgCounts(s){let d=this.bb.__offset(this.bb_pos,26);return d?this.bb.readInt32(this.bb.__vector(this.bb_pos+d)+s*4):0}inputArgCountsLength(){let s=this.bb.__offset(this.bb_pos,26);return s?this.bb.__vector_len(this.bb_pos+s):0}inputArgCountsArray(){let s=this.bb.__offset(this.bb_pos,26);return s?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+s),this.bb.__vector_len(this.bb_pos+s)):null}implicitInputs(s,d){let $=this.bb.__offset(this.bb_pos,28);return $?this.bb.__string(this.bb.__vector(this.bb_pos+$)+s*4,d):null}implicitInputsLength(){let s=this.bb.__offset(this.bb_pos,28);return s?this.bb.__vector_len(this.bb_pos+s):0}static startNode(s){s.startObject(13)}static addName(s,d){s.addFieldOffset(0,d,0)}static addDocString(s,d){s.addFieldOffset(1,d,0)}static addDomain(s,d){s.addFieldOffset(2,d,0)}static addSinceVersion(s,d){s.addFieldInt32(3,d,0)}static addIndex(s,d){s.addFieldInt32(4,d,0)}static addOpType(s,d){s.addFieldOffset(5,d,0)}static addType(s,d){s.addFieldInt32(6,d,0)}static addExecutionProviderType(s,d){s.addFieldOffset(7,d,0)}static addInputs(s,d){s.addFieldOffset(8,d,0)}static createInputsVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startInputsVector(s,d){s.startVector(4,d,4)}static addOutputs(s,d){s.addFieldOffset(9,d,0)}static createOutputsVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startOutputsVector(s,d){s.startVector(4,d,4)}static addAttributes(s,d){s.addFieldOffset(10,d,0)}static createAttributesVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startAttributesVector(s,d){s.startVector(4,d,4)}static addInputArgCounts(s,d){s.addFieldOffset(11,d,0)}static createInputArgCountsVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addInt32(d[$]);return s.endVector()}static startInputArgCountsVector(s,d){s.startVector(4,d,4)}static addImplicitInputs(s,d){s.addFieldOffset(12,d,0)}static createImplicitInputsVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startImplicitInputsVector(s,d){s.startVector(4,d,4)}static endNode(s){return s.endObject()}static createNode(s,d,$,et,h,b,g,st,$t,vt,Ft,Gt,qt,Lt){return o.startNode(s),o.addName(s,d),o.addDocString(s,$),o.addDomain(s,et),o.addSinceVersion(s,h),o.addIndex(s,b),o.addOpType(s,g),o.addType(s,st),o.addExecutionProviderType(s,$t),o.addInputs(s,vt),o.addOutputs(s,Ft),o.addAttributes(s,Gt),o.addInputArgCounts(s,qt),o.addImplicitInputs(s,Lt),o.endNode(s)}}a.Node=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsValueInfo(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsValueInfo(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}name(s){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.__string(this.bb_pos+d,s):null}docString(s){let d=this.bb.__offset(this.bb_pos,6);return d?this.bb.__string(this.bb_pos+d,s):null}type(s){let d=this.bb.__offset(this.bb_pos,8);return d?(s||new e.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+d),this.bb):null}static startValueInfo(s){s.startObject(3)}static addName(s,d){s.addFieldOffset(0,d,0)}static addDocString(s,d){s.addFieldOffset(1,d,0)}static addType(s,d){s.addFieldOffset(2,d,0)}static endValueInfo(s){return s.endObject()}static createValueInfo(s,d,$,et){return o.startValueInfo(s),o.addName(s,d),o.addDocString(s,$),o.addType(s,et),o.endValueInfo(s)}}a.ValueInfo=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsTypeInfo(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsTypeInfo(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}denotation(s){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.__string(this.bb_pos+d,s):null}valueType(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.readUint8(this.bb_pos+s):0}value(s){let d=this.bb.__offset(this.bb_pos,8);return d?this.bb.__union(s,this.bb_pos+d):null}static startTypeInfo(s){s.startObject(3)}static addDenotation(s,d){s.addFieldOffset(0,d,0)}static addValueType(s,d){s.addFieldInt8(1,d,0)}static addValue(s,d){s.addFieldOffset(2,d,0)}static endTypeInfo(s){return s.endObject()}static createTypeInfo(s,d,$,et){return o.startTypeInfo(s),o.addDenotation(s,d),o.addValueType(s,$),o.addValue(s,et),o.endTypeInfo(s)}}a.TypeInfo=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsOperatorSetId(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsOperatorSetId(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}domain(s){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.__string(this.bb_pos+d,s):null}version(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}static startOperatorSetId(s){s.startObject(2)}static addDomain(s,d){s.addFieldOffset(0,d,0)}static addVersion(s,d){s.addFieldInt64(1,d,s.createLong(0,0))}static endOperatorSetId(s){return s.endObject()}static createOperatorSetId(s,d,$){return o.startOperatorSetId(s),o.addDomain(s,d),o.addVersion(s,$),o.endOperatorSetId(s)}}a.OperatorSetId=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsTensor(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsTensor(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}name(s){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.__string(this.bb_pos+d,s):null}docString(s){let d=this.bb.__offset(this.bb_pos,6);return d?this.bb.__string(this.bb_pos+d,s):null}dims(s){let d=this.bb.__offset(this.bb_pos,8);return d?this.bb.readInt64(this.bb.__vector(this.bb_pos+d)+s*8):this.bb.createLong(0,0)}dimsLength(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.__vector_len(this.bb_pos+s):0}dataType(){let s=this.bb.__offset(this.bb_pos,10);return s?this.bb.readInt32(this.bb_pos+s):0}rawData(s){let d=this.bb.__offset(this.bb_pos,12);return d?this.bb.readUint8(this.bb.__vector(this.bb_pos+d)+s):0}rawDataLength(){let s=this.bb.__offset(this.bb_pos,12);return s?this.bb.__vector_len(this.bb_pos+s):0}rawDataArray(){let s=this.bb.__offset(this.bb_pos,12);return s?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+s),this.bb.__vector_len(this.bb_pos+s)):null}stringData(s,d){let $=this.bb.__offset(this.bb_pos,14);return $?this.bb.__string(this.bb.__vector(this.bb_pos+$)+s*4,d):null}stringDataLength(){let s=this.bb.__offset(this.bb_pos,14);return s?this.bb.__vector_len(this.bb_pos+s):0}static startTensor(s){s.startObject(6)}static addName(s,d){s.addFieldOffset(0,d,0)}static addDocString(s,d){s.addFieldOffset(1,d,0)}static addDims(s,d){s.addFieldOffset(2,d,0)}static createDimsVector(s,d){s.startVector(8,d.length,8);for(let $=d.length-1;$>=0;$--)s.addInt64(d[$]);return s.endVector()}static startDimsVector(s,d){s.startVector(8,d,8)}static addDataType(s,d){s.addFieldInt32(3,d,0)}static addRawData(s,d){s.addFieldOffset(4,d,0)}static createRawDataVector(s,d){s.startVector(1,d.length,1);for(let $=d.length-1;$>=0;$--)s.addInt8(d[$]);return s.endVector()}static startRawDataVector(s,d){s.startVector(1,d,1)}static addStringData(s,d){s.addFieldOffset(5,d,0)}static createStringDataVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startStringDataVector(s,d){s.startVector(4,d,4)}static endTensor(s){return s.endObject()}static createTensor(s,d,$,et,h,b,g){return o.startTensor(s),o.addName(s,d),o.addDocString(s,$),o.addDims(s,et),o.addDataType(s,h),o.addRawData(s,b),o.addStringData(s,g),o.endTensor(s)}}a.Tensor=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsSparseTensor(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsSparseTensor(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}values(s){let d=this.bb.__offset(this.bb_pos,4);return d?(s||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+d),this.bb):null}indices(s){let d=this.bb.__offset(this.bb_pos,6);return d?(s||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+d),this.bb):null}dims(s){let d=this.bb.__offset(this.bb_pos,8);return d?this.bb.readInt64(this.bb.__vector(this.bb_pos+d)+s*8):this.bb.createLong(0,0)}dimsLength(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.__vector_len(this.bb_pos+s):0}static startSparseTensor(s){s.startObject(3)}static addValues(s,d){s.addFieldOffset(0,d,0)}static addIndices(s,d){s.addFieldOffset(1,d,0)}static addDims(s,d){s.addFieldOffset(2,d,0)}static createDimsVector(s,d){s.startVector(8,d.length,8);for(let $=d.length-1;$>=0;$--)s.addInt64(d[$]);return s.endVector()}static startDimsVector(s,d){s.startVector(8,d,8)}static endSparseTensor(s){return s.endObject()}static createSparseTensor(s,d,$,et){return o.startSparseTensor(s),o.addValues(s,d),o.addIndices(s,$),o.addDims(s,et),o.endSparseTensor(s)}}a.SparseTensor=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsAttribute(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsAttribute(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}name(s){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.__string(this.bb_pos+d,s):null}docString(s){let d=this.bb.__offset(this.bb_pos,6);return d?this.bb.__string(this.bb_pos+d,s):null}type(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.readInt32(this.bb_pos+s):0}f(){let s=this.bb.__offset(this.bb_pos,10);return s?this.bb.readFloat32(this.bb_pos+s):0}i(){let s=this.bb.__offset(this.bb_pos,12);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}s(s){let d=this.bb.__offset(this.bb_pos,14);return d?this.bb.__string(this.bb_pos+d,s):null}t(s){let d=this.bb.__offset(this.bb_pos,16);return d?(s||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+d),this.bb):null}g(s){let d=this.bb.__offset(this.bb_pos,18);return d?(s||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+d),this.bb):null}floats(s){let d=this.bb.__offset(this.bb_pos,20);return d?this.bb.readFloat32(this.bb.__vector(this.bb_pos+d)+s*4):0}floatsLength(){let s=this.bb.__offset(this.bb_pos,20);return s?this.bb.__vector_len(this.bb_pos+s):0}floatsArray(){let s=this.bb.__offset(this.bb_pos,20);return s?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+s),this.bb.__vector_len(this.bb_pos+s)):null}ints(s){let d=this.bb.__offset(this.bb_pos,22);return d?this.bb.readInt64(this.bb.__vector(this.bb_pos+d)+s*8):this.bb.createLong(0,0)}intsLength(){let s=this.bb.__offset(this.bb_pos,22);return s?this.bb.__vector_len(this.bb_pos+s):0}strings(s,d){let $=this.bb.__offset(this.bb_pos,24);return $?this.bb.__string(this.bb.__vector(this.bb_pos+$)+s*4,d):null}stringsLength(){let s=this.bb.__offset(this.bb_pos,24);return s?this.bb.__vector_len(this.bb_pos+s):0}tensors(s,d){let $=this.bb.__offset(this.bb_pos,26);return $?(d||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+$)+s*4),this.bb):null}tensorsLength(){let s=this.bb.__offset(this.bb_pos,26);return s?this.bb.__vector_len(this.bb_pos+s):0}graphs(s,d){let $=this.bb.__offset(this.bb_pos,28);return $?(d||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+$)+s*4),this.bb):null}graphsLength(){let s=this.bb.__offset(this.bb_pos,28);return s?this.bb.__vector_len(this.bb_pos+s):0}static startAttribute(s){s.startObject(13)}static addName(s,d){s.addFieldOffset(0,d,0)}static addDocString(s,d){s.addFieldOffset(1,d,0)}static addType(s,d){s.addFieldInt32(2,d,0)}static addF(s,d){s.addFieldFloat32(3,d,0)}static addI(s,d){s.addFieldInt64(4,d,s.createLong(0,0))}static addS(s,d){s.addFieldOffset(5,d,0)}static addT(s,d){s.addFieldOffset(6,d,0)}static addG(s,d){s.addFieldOffset(7,d,0)}static addFloats(s,d){s.addFieldOffset(8,d,0)}static createFloatsVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addFloat32(d[$]);return s.endVector()}static startFloatsVector(s,d){s.startVector(4,d,4)}static addInts(s,d){s.addFieldOffset(9,d,0)}static createIntsVector(s,d){s.startVector(8,d.length,8);for(let $=d.length-1;$>=0;$--)s.addInt64(d[$]);return s.endVector()}static startIntsVector(s,d){s.startVector(8,d,8)}static addStrings(s,d){s.addFieldOffset(10,d,0)}static createStringsVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startStringsVector(s,d){s.startVector(4,d,4)}static addTensors(s,d){s.addFieldOffset(11,d,0)}static createTensorsVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startTensorsVector(s,d){s.startVector(4,d,4)}static addGraphs(s,d){s.addFieldOffset(12,d,0)}static createGraphsVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startGraphsVector(s,d){s.startVector(4,d,4)}static endAttribute(s){return s.endObject()}static createAttribute(s,d,$,et,h,b,g,st,$t,vt,Ft,Gt,qt,Lt){return o.startAttribute(s),o.addName(s,d),o.addDocString(s,$),o.addType(s,et),o.addF(s,h),o.addI(s,b),o.addS(s,g),o.addT(s,st),o.addG(s,$t),o.addFloats(s,vt),o.addInts(s,Ft),o.addStrings(s,Gt),o.addTensors(s,qt),o.addGraphs(s,Lt),o.endAttribute(s)}}a.Attribute=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsGraph(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsGraph(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}initializers(s,d){let $=this.bb.__offset(this.bb_pos,4);return $?(d||new e.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+$)+s*4),this.bb):null}initializersLength(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.__vector_len(this.bb_pos+s):0}nodeArgs(s,d){let $=this.bb.__offset(this.bb_pos,6);return $?(d||new e.experimental.fbs.ValueInfo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+$)+s*4),this.bb):null}nodeArgsLength(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.__vector_len(this.bb_pos+s):0}nodes(s,d){let $=this.bb.__offset(this.bb_pos,8);return $?(d||new e.experimental.fbs.Node).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+$)+s*4),this.bb):null}nodesLength(){let s=this.bb.__offset(this.bb_pos,8);return s?this.bb.__vector_len(this.bb_pos+s):0}maxNodeIndex(){let s=this.bb.__offset(this.bb_pos,10);return s?this.bb.readUint32(this.bb_pos+s):0}nodeEdges(s,d){let $=this.bb.__offset(this.bb_pos,12);return $?(d||new e.experimental.fbs.NodeEdge).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+$)+s*4),this.bb):null}nodeEdgesLength(){let s=this.bb.__offset(this.bb_pos,12);return s?this.bb.__vector_len(this.bb_pos+s):0}inputs(s,d){let $=this.bb.__offset(this.bb_pos,14);return $?this.bb.__string(this.bb.__vector(this.bb_pos+$)+s*4,d):null}inputsLength(){let s=this.bb.__offset(this.bb_pos,14);return s?this.bb.__vector_len(this.bb_pos+s):0}outputs(s,d){let $=this.bb.__offset(this.bb_pos,16);return $?this.bb.__string(this.bb.__vector(this.bb_pos+$)+s*4,d):null}outputsLength(){let s=this.bb.__offset(this.bb_pos,16);return s?this.bb.__vector_len(this.bb_pos+s):0}sparseInitializers(s,d){let $=this.bb.__offset(this.bb_pos,18);return $?(d||new e.experimental.fbs.SparseTensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+$)+s*4),this.bb):null}sparseInitializersLength(){let s=this.bb.__offset(this.bb_pos,18);return s?this.bb.__vector_len(this.bb_pos+s):0}static startGraph(s){s.startObject(8)}static addInitializers(s,d){s.addFieldOffset(0,d,0)}static createInitializersVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startInitializersVector(s,d){s.startVector(4,d,4)}static addNodeArgs(s,d){s.addFieldOffset(1,d,0)}static createNodeArgsVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startNodeArgsVector(s,d){s.startVector(4,d,4)}static addNodes(s,d){s.addFieldOffset(2,d,0)}static createNodesVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startNodesVector(s,d){s.startVector(4,d,4)}static addMaxNodeIndex(s,d){s.addFieldInt32(3,d,0)}static addNodeEdges(s,d){s.addFieldOffset(4,d,0)}static createNodeEdgesVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startNodeEdgesVector(s,d){s.startVector(4,d,4)}static addInputs(s,d){s.addFieldOffset(5,d,0)}static createInputsVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startInputsVector(s,d){s.startVector(4,d,4)}static addOutputs(s,d){s.addFieldOffset(6,d,0)}static createOutputsVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startOutputsVector(s,d){s.startVector(4,d,4)}static addSparseInitializers(s,d){s.addFieldOffset(7,d,0)}static createSparseInitializersVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startSparseInitializersVector(s,d){s.startVector(4,d,4)}static endGraph(s){return s.endObject()}static createGraph(s,d,$,et,h,b,g,st,$t){return o.startGraph(s),o.addInitializers(s,d),o.addNodeArgs(s,$),o.addNodes(s,et),o.addMaxNodeIndex(s,h),o.addNodeEdges(s,b),o.addInputs(s,g),o.addOutputs(s,st),o.addSparseInitializers(s,$t),o.endGraph(s)}}a.Graph=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsModel(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsModel(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}irVersion(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}opsetImport(s,d){let $=this.bb.__offset(this.bb_pos,6);return $?(d||new e.experimental.fbs.OperatorSetId).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+$)+s*4),this.bb):null}opsetImportLength(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.__vector_len(this.bb_pos+s):0}producerName(s){let d=this.bb.__offset(this.bb_pos,8);return d?this.bb.__string(this.bb_pos+d,s):null}producerVersion(s){let d=this.bb.__offset(this.bb_pos,10);return d?this.bb.__string(this.bb_pos+d,s):null}domain(s){let d=this.bb.__offset(this.bb_pos,12);return d?this.bb.__string(this.bb_pos+d,s):null}modelVersion(){let s=this.bb.__offset(this.bb_pos,14);return s?this.bb.readInt64(this.bb_pos+s):this.bb.createLong(0,0)}docString(s){let d=this.bb.__offset(this.bb_pos,16);return d?this.bb.__string(this.bb_pos+d,s):null}graph(s){let d=this.bb.__offset(this.bb_pos,18);return d?(s||new e.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+d),this.bb):null}graphDocString(s){let d=this.bb.__offset(this.bb_pos,20);return d?this.bb.__string(this.bb_pos+d,s):null}static startModel(s){s.startObject(9)}static addIrVersion(s,d){s.addFieldInt64(0,d,s.createLong(0,0))}static addOpsetImport(s,d){s.addFieldOffset(1,d,0)}static createOpsetImportVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startOpsetImportVector(s,d){s.startVector(4,d,4)}static addProducerName(s,d){s.addFieldOffset(2,d,0)}static addProducerVersion(s,d){s.addFieldOffset(3,d,0)}static addDomain(s,d){s.addFieldOffset(4,d,0)}static addModelVersion(s,d){s.addFieldInt64(5,d,s.createLong(0,0))}static addDocString(s,d){s.addFieldOffset(6,d,0)}static addGraph(s,d){s.addFieldOffset(7,d,0)}static addGraphDocString(s,d){s.addFieldOffset(8,d,0)}static endModel(s){return s.endObject()}static createModel(s,d,$,et,h,b,g,st,$t,vt){return o.startModel(s),o.addIrVersion(s,d),o.addOpsetImport(s,$),o.addProducerName(s,et),o.addProducerVersion(s,h),o.addDomain(s,b),o.addModelVersion(s,g),o.addDocString(s,st),o.addGraph(s,$t),o.addGraphDocString(s,vt),o.endModel(s)}}a.Model=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsKernelCreateInfos(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsKernelCreateInfos(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}nodeIndices(s){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.readUint32(this.bb.__vector(this.bb_pos+d)+s*4):0}nodeIndicesLength(){let s=this.bb.__offset(this.bb_pos,4);return s?this.bb.__vector_len(this.bb_pos+s):0}nodeIndicesArray(){let s=this.bb.__offset(this.bb_pos,4);return s?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+s),this.bb.__vector_len(this.bb_pos+s)):null}kernelDefHashes(s){let d=this.bb.__offset(this.bb_pos,6);return d?this.bb.readUint64(this.bb.__vector(this.bb_pos+d)+s*8):this.bb.createLong(0,0)}kernelDefHashesLength(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.__vector_len(this.bb_pos+s):0}static startKernelCreateInfos(s){s.startObject(2)}static addNodeIndices(s,d){s.addFieldOffset(0,d,0)}static createNodeIndicesVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addInt32(d[$]);return s.endVector()}static startNodeIndicesVector(s,d){s.startVector(4,d,4)}static addKernelDefHashes(s,d){s.addFieldOffset(1,d,0)}static createKernelDefHashesVector(s,d){s.startVector(8,d.length,8);for(let $=d.length-1;$>=0;$--)s.addInt64(d[$]);return s.endVector()}static startKernelDefHashesVector(s,d){s.startVector(8,d,8)}static endKernelCreateInfos(s){return s.endObject()}static createKernelCreateInfos(s,d,$){return o.startKernelCreateInfos(s),o.addNodeIndices(s,d),o.addKernelDefHashes(s,$),o.endKernelCreateInfos(s)}}a.KernelCreateInfos=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsSubGraphSessionState(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsSubGraphSessionState(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}graphId(s){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.__string(this.bb_pos+d,s):null}sessionState(s){let d=this.bb.__offset(this.bb_pos,6);return d?(s||new e.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+d),this.bb):null}static startSubGraphSessionState(s){s.startObject(2)}static addGraphId(s,d){s.addFieldOffset(0,d,0)}static addSessionState(s,d){s.addFieldOffset(1,d,0)}static endSubGraphSessionState(s){let d=s.endObject();return s.requiredField(d,4),d}static createSubGraphSessionState(s,d,$){return o.startSubGraphSessionState(s),o.addGraphId(s,d),o.addSessionState(s,$),o.endSubGraphSessionState(s)}}a.SubGraphSessionState=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsSessionState(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsSessionState(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}kernels(s){let d=this.bb.__offset(this.bb_pos,4);return d?(s||new e.experimental.fbs.KernelCreateInfos).__init(this.bb.__indirect(this.bb_pos+d),this.bb):null}subGraphSessionStates(s,d){let $=this.bb.__offset(this.bb_pos,6);return $?(d||new e.experimental.fbs.SubGraphSessionState).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+$)+s*4),this.bb):null}subGraphSessionStatesLength(){let s=this.bb.__offset(this.bb_pos,6);return s?this.bb.__vector_len(this.bb_pos+s):0}static startSessionState(s){s.startObject(2)}static addKernels(s,d){s.addFieldOffset(0,d,0)}static addSubGraphSessionStates(s,d){s.addFieldOffset(1,d,0)}static createSubGraphSessionStatesVector(s,d){s.startVector(4,d.length,4);for(let $=d.length-1;$>=0;$--)s.addOffset(d[$]);return s.endVector()}static startSubGraphSessionStatesVector(s,d){s.startVector(4,d,4)}static endSessionState(s){return s.endObject()}static createSessionState(s,d,$){return o.startSessionState(s),o.addKernels(s,d),o.addSubGraphSessionStates(s,$),o.endSessionState(s)}}a.SessionState=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={})),(e=>{(i=>{(a=>{class o{constructor(){this.bb=null,this.bb_pos=0}__init(s,d){return this.bb_pos=s,this.bb=d,this}static getRootAsInferenceSession(s,d){return(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static getSizePrefixedRootAsInferenceSession(s,d){return s.setPosition(s.position()+_.SIZE_PREFIX_LENGTH),(d||new o).__init(s.readInt32(s.position())+s.position(),s)}static bufferHasIdentifier(s){return s.__has_identifier("ORTM")}ortVersion(s){let d=this.bb.__offset(this.bb_pos,4);return d?this.bb.__string(this.bb_pos+d,s):null}model(s){let d=this.bb.__offset(this.bb_pos,6);return d?(s||new e.experimental.fbs.Model).__init(this.bb.__indirect(this.bb_pos+d),this.bb):null}sessionState(s){let d=this.bb.__offset(this.bb_pos,8);return d?(s||new e.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+d),this.bb):null}static startInferenceSession(s){s.startObject(3)}static addOrtVersion(s,d){s.addFieldOffset(0,d,0)}static addModel(s,d){s.addFieldOffset(1,d,0)}static addSessionState(s,d){s.addFieldOffset(2,d,0)}static endInferenceSession(s){return s.endObject()}static finishInferenceSessionBuffer(s,d){s.finish(d,"ORTM")}static finishSizePrefixedInferenceSessionBuffer(s,d){s.finish(d,"ORTM",!0)}static createInferenceSession(s,d,$,et){return o.startInferenceSession(s),o.addOrtVersion(s,d),o.addModel(s,$),o.addSessionState(s,et),o.endInferenceSession(s)}}a.InferenceSession=o})(i.fbs||(i.fbs={}))})(e.experimental||(e.experimental={}))})(V||(V={}))}),Bs$1=me((e,i)=>{i.exports=a;function a(o,c){for(var s=new Array(arguments.length-1),d=0,$=2,et=!0;$<arguments.length;)s[d++]=arguments[$++];return new Promise(function(h,b){s[d]=function(g){if(et)if(et=!1,g)b(g);else{for(var st=new Array(arguments.length-1),$t=0;$t<st.length;)st[$t++]=arguments[$t];h.apply(null,st)}};try{o.apply(c||null,s)}catch(g){et&&(et=!1,b(g))}})}}),Gs$1=me(e=>{var i=e;i.length=function(d){var $=d.length;if(!$)return 0;for(var et=0;--$%4>1&&d.charAt($)==="=";)++et;return Math.ceil(d.length*3)/4-et};var a=new Array(64),o=new Array(123);for(c=0;c<64;)o[a[c]=c<26?c+65:c<52?c+71:c<62?c-4:c-59|43]=c++;var c;i.encode=function(d,$,et){for(var h=null,b=[],g=0,st=0,$t;$<et;){var vt=d[$++];switch(st){case 0:b[g++]=a[vt>>2],$t=(vt&3)<<4,st=1;break;case 1:b[g++]=a[$t|vt>>4],$t=(vt&15)<<2,st=2;break;case 2:b[g++]=a[$t|vt>>6],b[g++]=a[vt&63],st=0;break}g>8191&&((h||(h=[])).push(String.fromCharCode.apply(String,b)),g=0)}return st&&(b[g++]=a[$t],b[g++]=61,st===1&&(b[g++]=61)),h?(g&&h.push(String.fromCharCode.apply(String,b.slice(0,g))),h.join("")):String.fromCharCode.apply(String,b.slice(0,g))};var s="invalid encoding";i.decode=function(d,$,et){for(var h=et,b=0,g,st=0;st<d.length;){var $t=d.charCodeAt(st++);if($t===61&&b>1)break;if(($t=o[$t])===void 0)throw Error(s);switch(b){case 0:g=$t,b=1;break;case 1:$[et++]=g<<2|($t&48)>>4,g=$t,b=2;break;case 2:$[et++]=(g&15)<<4|($t&60)>>2,g=$t,b=3;break;case 3:$[et++]=(g&3)<<6|$t,b=0;break}}if(b===1)throw Error(s);return et-h},i.test=function(d){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(d)}}),zs$1=me((e,i)=>{i.exports=a;function a(){this._listeners={}}a.prototype.on=function(o,c,s){return(this._listeners[o]||(this._listeners[o]=[])).push({fn:c,ctx:s||this}),this},a.prototype.off=function(o,c){if(o===void 0)this._listeners={};else if(c===void 0)this._listeners[o]=[];else for(var s=this._listeners[o],d=0;d<s.length;)s[d].fn===c?s.splice(d,1):++d;return this},a.prototype.emit=function(o){var c=this._listeners[o];if(c){for(var s=[],d=1;d<arguments.length;)s.push(arguments[d++]);for(d=0;d<c.length;)c[d].fn.apply(c[d++].ctx,s)}return this}}),Xs$1=me((e,i)=>{i.exports=a(a);function a($){return typeof Float32Array<"u"?function(){var et=new Float32Array([-0]),h=new Uint8Array(et.buffer),b=h[3]===128;function g(Ft,Gt,qt){et[0]=Ft,Gt[qt]=h[0],Gt[qt+1]=h[1],Gt[qt+2]=h[2],Gt[qt+3]=h[3]}function st(Ft,Gt,qt){et[0]=Ft,Gt[qt]=h[3],Gt[qt+1]=h[2],Gt[qt+2]=h[1],Gt[qt+3]=h[0]}$.writeFloatLE=b?g:st,$.writeFloatBE=b?st:g;function $t(Ft,Gt){return h[0]=Ft[Gt],h[1]=Ft[Gt+1],h[2]=Ft[Gt+2],h[3]=Ft[Gt+3],et[0]}function vt(Ft,Gt){return h[3]=Ft[Gt],h[2]=Ft[Gt+1],h[1]=Ft[Gt+2],h[0]=Ft[Gt+3],et[0]}$.readFloatLE=b?$t:vt,$.readFloatBE=b?vt:$t}():function(){function et(b,g,st,$t){var vt=g<0?1:0;if(vt&&(g=-g),g===0)b(1/g>0?0:2147483648,st,$t);else if(isNaN(g))b(2143289344,st,$t);else if(g>34028234663852886e22)b((vt<<31|2139095040)>>>0,st,$t);else if(g<11754943508222875e-54)b((vt<<31|Math.round(g/1401298464324817e-60))>>>0,st,$t);else{var Ft=Math.floor(Math.log(g)/Math.LN2),Gt=Math.round(g*Math.pow(2,-Ft)*8388608)&8388607;b((vt<<31|Ft+127<<23|Gt)>>>0,st,$t)}}$.writeFloatLE=et.bind(null,o),$.writeFloatBE=et.bind(null,c);function h(b,g,st){var $t=b(g,st),vt=($t>>31)*2+1,Ft=$t>>>23&255,Gt=$t&8388607;return Ft===255?Gt?NaN:vt*(1/0):Ft===0?vt*1401298464324817e-60*Gt:vt*Math.pow(2,Ft-150)*(Gt+8388608)}$.readFloatLE=h.bind(null,s),$.readFloatBE=h.bind(null,d)}(),typeof Float64Array<"u"?function(){var et=new Float64Array([-0]),h=new Uint8Array(et.buffer),b=h[7]===128;function g(Ft,Gt,qt){et[0]=Ft,Gt[qt]=h[0],Gt[qt+1]=h[1],Gt[qt+2]=h[2],Gt[qt+3]=h[3],Gt[qt+4]=h[4],Gt[qt+5]=h[5],Gt[qt+6]=h[6],Gt[qt+7]=h[7]}function st(Ft,Gt,qt){et[0]=Ft,Gt[qt]=h[7],Gt[qt+1]=h[6],Gt[qt+2]=h[5],Gt[qt+3]=h[4],Gt[qt+4]=h[3],Gt[qt+5]=h[2],Gt[qt+6]=h[1],Gt[qt+7]=h[0]}$.writeDoubleLE=b?g:st,$.writeDoubleBE=b?st:g;function $t(Ft,Gt){return h[0]=Ft[Gt],h[1]=Ft[Gt+1],h[2]=Ft[Gt+2],h[3]=Ft[Gt+3],h[4]=Ft[Gt+4],h[5]=Ft[Gt+5],h[6]=Ft[Gt+6],h[7]=Ft[Gt+7],et[0]}function vt(Ft,Gt){return h[7]=Ft[Gt],h[6]=Ft[Gt+1],h[5]=Ft[Gt+2],h[4]=Ft[Gt+3],h[3]=Ft[Gt+4],h[2]=Ft[Gt+5],h[1]=Ft[Gt+6],h[0]=Ft[Gt+7],et[0]}$.readDoubleLE=b?$t:vt,$.readDoubleBE=b?vt:$t}():function(){function et(b,g,st,$t,vt,Ft){var Gt=$t<0?1:0;if(Gt&&($t=-$t),$t===0)b(0,vt,Ft+g),b(1/$t>0?0:2147483648,vt,Ft+st);else if(isNaN($t))b(0,vt,Ft+g),b(2146959360,vt,Ft+st);else if($t>17976931348623157e292)b(0,vt,Ft+g),b((Gt<<31|2146435072)>>>0,vt,Ft+st);else{var qt;if($t<22250738585072014e-324)qt=$t/5e-324,b(qt>>>0,vt,Ft+g),b((Gt<<31|qt/4294967296)>>>0,vt,Ft+st);else{var Lt=Math.floor(Math.log($t)/Math.LN2);Lt===1024&&(Lt=1023),qt=$t*Math.pow(2,-Lt),b(qt*4503599627370496>>>0,vt,Ft+g),b((Gt<<31|Lt+1023<<20|qt*1048576&1048575)>>>0,vt,Ft+st)}}}$.writeDoubleLE=et.bind(null,o,0,4),$.writeDoubleBE=et.bind(null,c,4,0);function h(b,g,st,$t,vt){var Ft=b($t,vt+g),Gt=b($t,vt+st),qt=(Gt>>31)*2+1,Lt=Gt>>>20&2047,rr=4294967296*(Gt&1048575)+Ft;return Lt===2047?rr?NaN:qt*(1/0):Lt===0?qt*5e-324*rr:qt*Math.pow(2,Lt-1075)*(rr+4503599627370496)}$.readDoubleLE=h.bind(null,s,0,4),$.readDoubleBE=h.bind(null,d,4,0)}(),$}function o($,et,h){et[h]=$&255,et[h+1]=$>>>8&255,et[h+2]=$>>>16&255,et[h+3]=$>>>24}function c($,et,h){et[h]=$>>>24,et[h+1]=$>>>16&255,et[h+2]=$>>>8&255,et[h+3]=$&255}function s($,et){return($[et]|$[et+1]<<8|$[et+2]<<16|$[et+3]<<24)>>>0}function d($,et){return($[et]<<24|$[et+1]<<16|$[et+2]<<8|$[et+3])>>>0}}),Ks$1=me((exports,module)=>{module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}}),Zs$1=me(e=>{var i=e;i.length=function(a){for(var o=0,c=0,s=0;s<a.length;++s)c=a.charCodeAt(s),c<128?o+=1:c<2048?o+=2:(c&64512)===55296&&(a.charCodeAt(s+1)&64512)===56320?(++s,o+=4):o+=3;return o},i.read=function(a,o,c){var s=c-o;if(s<1)return"";for(var d=null,$=[],et=0,h;o<c;)h=a[o++],h<128?$[et++]=h:h>191&&h<224?$[et++]=(h&31)<<6|a[o++]&63:h>239&&h<365?(h=((h&7)<<18|(a[o++]&63)<<12|(a[o++]&63)<<6|a[o++]&63)-65536,$[et++]=55296+(h>>10),$[et++]=56320+(h&1023)):$[et++]=(h&15)<<12|(a[o++]&63)<<6|a[o++]&63,et>8191&&((d||(d=[])).push(String.fromCharCode.apply(String,$)),et=0);return d?(et&&d.push(String.fromCharCode.apply(String,$.slice(0,et))),d.join("")):String.fromCharCode.apply(String,$.slice(0,et))},i.write=function(a,o,c){for(var s=c,d,$,et=0;et<a.length;++et)d=a.charCodeAt(et),d<128?o[c++]=d:d<2048?(o[c++]=d>>6|192,o[c++]=d&63|128):(d&64512)===55296&&(($=a.charCodeAt(et+1))&64512)===56320?(d=65536+((d&1023)<<10)+($&1023),++et,o[c++]=d>>18|240,o[c++]=d>>12&63|128,o[c++]=d>>6&63|128,o[c++]=d&63|128):(o[c++]=d>>12|224,o[c++]=d>>6&63|128,o[c++]=d&63|128);return c-s}}),eu$1=me((e,i)=>{i.exports=a;function a(o,c,s){var d=s||8192,$=d>>>1,et=null,h=d;return function(b){if(b<1||b>$)return o(b);h+b>d&&(et=o(d),h=0);var g=c.call(et,h,h+=b);return h&7&&(h=(h|7)+1),g}}}),ru$1=me((e,i)=>{i.exports=o;var a=Jt();function o($,et){this.lo=$>>>0,this.hi=et>>>0}var c=o.zero=new o(0,0);c.toNumber=function(){return 0},c.zzEncode=c.zzDecode=function(){return this},c.length=function(){return 1};var s=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function($){if($===0)return c;var et=$<0;et&&($=-$);var h=$>>>0,b=($-h)/4294967296>>>0;return et&&(b=~b>>>0,h=~h>>>0,++h>4294967295&&(h=0,++b>4294967295&&(b=0))),new o(h,b)},o.from=function($){if(typeof $=="number")return o.fromNumber($);if(a.isString($))if(a.Long)$=a.Long.fromString($);else return o.fromNumber(parseInt($,10));return $.low||$.high?new o($.low>>>0,$.high>>>0):c},o.prototype.toNumber=function($){if(!$&&this.hi>>>31){var et=~this.lo+1>>>0,h=~this.hi>>>0;return et||(h=h+1>>>0),-(et+h*4294967296)}return this.lo+this.hi*4294967296},o.prototype.toLong=function($){return a.Long?new a.Long(this.lo|0,this.hi|0,!!$):{low:this.lo|0,high:this.hi|0,unsigned:!!$}};var d=String.prototype.charCodeAt;o.fromHash=function($){return $===s?c:new o((d.call($,0)|d.call($,1)<<8|d.call($,2)<<16|d.call($,3)<<24)>>>0,(d.call($,4)|d.call($,5)<<8|d.call($,6)<<16|d.call($,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var $=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^$)>>>0,this.lo=(this.lo<<1^$)>>>0,this},o.prototype.zzDecode=function(){var $=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^$)>>>0,this.hi=(this.hi>>>1^$)>>>0,this},o.prototype.length=function(){var $=this.lo,et=(this.lo>>>28|this.hi<<4)>>>0,h=this.hi>>>24;return h===0?et===0?$<16384?$<128?1:2:$<2097152?3:4:et<16384?et<128?5:6:et<2097152?7:8:h<128?9:10}}),Jt=me(e=>{var i=e;i.asPromise=Bs$1(),i.base64=Gs$1(),i.EventEmitter=zs$1(),i.float=Xs$1(),i.inquire=Ks$1(),i.utf8=Zs$1(),i.pool=eu$1(),i.LongBits=ru$1(),i.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node),i.global=i.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||e,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isInteger=Number.isInteger||function(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c},i.isString=function(c){return typeof c=="string"||c instanceof String},i.isObject=function(c){return c&&typeof c=="object"},i.isset=i.isSet=function(c,s){var d=c[s];return d!=null&&c.hasOwnProperty(s)?typeof d!="object"||(Array.isArray(d)?d.length:Object.keys(d).length)>0:!1},i.Buffer=function(){try{var c=i.inquire("buffer").Buffer;return c.prototype.utf8Write?c:null}catch{return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(c){return typeof c=="number"?i.Buffer?i._Buffer_allocUnsafe(c):new i.Array(c):i.Buffer?i._Buffer_from(c):typeof Uint8Array>"u"?c:new Uint8Array(c)},i.Array=typeof Uint8Array<"u"?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(c){return c?i.LongBits.from(c).toHash():i.LongBits.zeroHash},i.longFromHash=function(c,s){var d=i.LongBits.fromHash(c);return i.Long?i.Long.fromBits(d.lo,d.hi,s):d.toNumber(!!s)};function a(c,s,d){for(var $=Object.keys(s),et=0;et<$.length;++et)(c[$[et]]===void 0||!d)&&(c[$[et]]=s[$[et]]);return c}i.merge=a,i.lcFirst=function(c){return c.charAt(0).toLowerCase()+c.substring(1)};function o(c){function s(d,$){if(!(this instanceof s))return new s(d,$);Object.defineProperty(this,"message",{get:function(){return d}}),Error.captureStackTrace?Error.captureStackTrace(this,s):Object.defineProperty(this,"stack",{value:new Error().stack||""}),$&&a(this,$)}return s.prototype=Object.create(Error.prototype,{constructor:{value:s,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return c},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),s}i.newError=o,i.ProtocolError=o("ProtocolError"),i.oneOfGetter=function(c){for(var s={},d=0;d<c.length;++d)s[c[d]]=1;return function(){for(var $=Object.keys(this),et=$.length-1;et>-1;--et)if(s[$[et]]===1&&this[$[et]]!==void 0&&this[$[et]]!==null)return $[et]}},i.oneOfSetter=function(c){return function(s){for(var d=0;d<c.length;++d)c[d]!==s&&delete this[c[d]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var c=i.Buffer;if(!c){i._Buffer_from=i._Buffer_allocUnsafe=null;return}i._Buffer_from=c.from!==Uint8Array.from&&c.from||function(s,d){return new c(s,d)},i._Buffer_allocUnsafe=c.allocUnsafe||function(s){return new c(s)}}}),si$1=me((e,i)=>{i.exports=b;var a=Jt(),o,c=a.LongBits,s=a.base64,d=a.utf8;function $(Lt,rr,jr){this.fn=Lt,this.len=rr,this.next=void 0,this.val=jr}function et(){}function h(Lt){this.head=Lt.head,this.tail=Lt.tail,this.len=Lt.len,this.next=Lt.states}function b(){this.len=0,this.head=new $(et,0,0),this.tail=this.head,this.states=null}var g=function(){return a.Buffer?function(){return(b.create=function(){return new o})()}:function(){return new b}};b.create=g(),b.alloc=function(Lt){return new a.Array(Lt)},a.Array!==Array&&(b.alloc=a.pool(b.alloc,a.Array.prototype.subarray)),b.prototype._push=function(Lt,rr,jr){return this.tail=this.tail.next=new $(Lt,rr,jr),this.len+=rr,this};function st(Lt,rr,jr){rr[jr]=Lt&255}function $t(Lt,rr,jr){for(;Lt>127;)rr[jr++]=Lt&127|128,Lt>>>=7;rr[jr]=Lt}function vt(Lt,rr){this.len=Lt,this.next=void 0,this.val=rr}vt.prototype=Object.create($.prototype),vt.prototype.fn=$t,b.prototype.uint32=function(Lt){return this.len+=(this.tail=this.tail.next=new vt((Lt=Lt>>>0)<128?1:Lt<16384?2:Lt<2097152?3:Lt<268435456?4:5,Lt)).len,this},b.prototype.int32=function(Lt){return Lt<0?this._push(Ft,10,c.fromNumber(Lt)):this.uint32(Lt)},b.prototype.sint32=function(Lt){return this.uint32((Lt<<1^Lt>>31)>>>0)};function Ft(Lt,rr,jr){for(;Lt.hi;)rr[jr++]=Lt.lo&127|128,Lt.lo=(Lt.lo>>>7|Lt.hi<<25)>>>0,Lt.hi>>>=7;for(;Lt.lo>127;)rr[jr++]=Lt.lo&127|128,Lt.lo=Lt.lo>>>7;rr[jr++]=Lt.lo}b.prototype.uint64=function(Lt){var rr=c.from(Lt);return this._push(Ft,rr.length(),rr)},b.prototype.int64=b.prototype.uint64,b.prototype.sint64=function(Lt){var rr=c.from(Lt).zzEncode();return this._push(Ft,rr.length(),rr)},b.prototype.bool=function(Lt){return this._push(st,1,Lt?1:0)};function Gt(Lt,rr,jr){rr[jr]=Lt&255,rr[jr+1]=Lt>>>8&255,rr[jr+2]=Lt>>>16&255,rr[jr+3]=Lt>>>24}b.prototype.fixed32=function(Lt){return this._push(Gt,4,Lt>>>0)},b.prototype.sfixed32=b.prototype.fixed32,b.prototype.fixed64=function(Lt){var rr=c.from(Lt);return this._push(Gt,4,rr.lo)._push(Gt,4,rr.hi)},b.prototype.sfixed64=b.prototype.fixed64,b.prototype.float=function(Lt){return this._push(a.float.writeFloatLE,4,Lt)},b.prototype.double=function(Lt){return this._push(a.float.writeDoubleLE,8,Lt)};var qt=a.Array.prototype.set?function(Lt,rr,jr){rr.set(Lt,jr)}:function(Lt,rr,jr){for(var Hr=0;Hr<Lt.length;++Hr)rr[jr+Hr]=Lt[Hr]};b.prototype.bytes=function(Lt){var rr=Lt.length>>>0;if(!rr)return this._push(st,1,0);if(a.isString(Lt)){var jr=b.alloc(rr=s.length(Lt));s.decode(Lt,jr,0),Lt=jr}return this.uint32(rr)._push(qt,rr,Lt)},b.prototype.string=function(Lt){var rr=d.length(Lt);return rr?this.uint32(rr)._push(d.write,rr,Lt):this._push(st,1,0)},b.prototype.fork=function(){return this.states=new h(this),this.head=this.tail=new $(et,0,0),this.len=0,this},b.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new $(et,0,0),this.len=0),this},b.prototype.ldelim=function(){var Lt=this.head,rr=this.tail,jr=this.len;return this.reset().uint32(jr),jr&&(this.tail.next=Lt.next,this.tail=rr,this.len+=jr),this},b.prototype.finish=function(){for(var Lt=this.head.next,rr=this.constructor.alloc(this.len),jr=0;Lt;)Lt.fn(Lt.val,rr,jr),jr+=Lt.len,Lt=Lt.next;return rr},b._configure=function(Lt){o=Lt,b.create=g(),o._configure()}}),cu$1=me((e,i)=>{i.exports=c;var a=si$1();(c.prototype=Object.create(a.prototype)).constructor=c;var o=Jt();function c(){a.call(this)}c._configure=function(){c.alloc=o._Buffer_allocUnsafe,c.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&o.Buffer.prototype.set.name==="set"?function(d,$,et){$.set(d,et)}:function(d,$,et){if(d.copy)d.copy($,et,0,d.length);else for(var h=0;h<d.length;)$[et++]=d[h++]}},c.prototype.bytes=function(d){o.isString(d)&&(d=o._Buffer_from(d,"base64"));var $=d.length>>>0;return this.uint32($),$&&this._push(c.writeBytesBuffer,$,d),this};function s(d,$,et){d.length<40?o.utf8.write(d,$,et):$.utf8Write?$.utf8Write(d,et):$.write(d,et)}c.prototype.string=function(d){var $=o.Buffer.byteLength(d);return this.uint32($),$&&this._push(s,$,d),this},c._configure()}),fi$1=me((e,i)=>{i.exports=$;var a=Jt(),o,c=a.LongBits,s=a.utf8;function d($t,vt){return RangeError("index out of range: "+$t.pos+" + "+(vt||1)+" > "+$t.len)}function $($t){this.buf=$t,this.pos=0,this.len=$t.length}var et=typeof Uint8Array<"u"?function($t){if($t instanceof Uint8Array||Array.isArray($t))return new $($t);throw Error("illegal buffer")}:function($t){if(Array.isArray($t))return new $($t);throw Error("illegal buffer")},h=function(){return a.Buffer?function($t){return($.create=function(vt){return a.Buffer.isBuffer(vt)?new o(vt):et(vt)})($t)}:et};$.create=h(),$.prototype._slice=a.Array.prototype.subarray||a.Array.prototype.slice,$.prototype.uint32=function(){var $t=4294967295;return function(){if($t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||($t=($t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||($t=($t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||($t=($t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||($t=($t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return $t;if((this.pos+=5)>this.len)throw this.pos=this.len,d(this,10);return $t}}(),$.prototype.int32=function(){return this.uint32()|0},$.prototype.sint32=function(){var $t=this.uint32();return $t>>>1^-($t&1)|0};function b(){var $t=new c(0,0),vt=0;if(this.len-this.pos>4){for(;vt<4;++vt)if($t.lo=($t.lo|(this.buf[this.pos]&127)<<vt*7)>>>0,this.buf[this.pos++]<128)return $t;if($t.lo=($t.lo|(this.buf[this.pos]&127)<<28)>>>0,$t.hi=($t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return $t;vt=0}else{for(;vt<3;++vt){if(this.pos>=this.len)throw d(this);if($t.lo=($t.lo|(this.buf[this.pos]&127)<<vt*7)>>>0,this.buf[this.pos++]<128)return $t}return $t.lo=($t.lo|(this.buf[this.pos++]&127)<<vt*7)>>>0,$t}if(this.len-this.pos>4){for(;vt<5;++vt)if($t.hi=($t.hi|(this.buf[this.pos]&127)<<vt*7+3)>>>0,this.buf[this.pos++]<128)return $t}else for(;vt<5;++vt){if(this.pos>=this.len)throw d(this);if($t.hi=($t.hi|(this.buf[this.pos]&127)<<vt*7+3)>>>0,this.buf[this.pos++]<128)return $t}throw Error("invalid varint encoding")}$.prototype.bool=function(){return this.uint32()!==0};function g($t,vt){return($t[vt-4]|$t[vt-3]<<8|$t[vt-2]<<16|$t[vt-1]<<24)>>>0}$.prototype.fixed32=function(){if(this.pos+4>this.len)throw d(this,4);return g(this.buf,this.pos+=4)},$.prototype.sfixed32=function(){if(this.pos+4>this.len)throw d(this,4);return g(this.buf,this.pos+=4)|0};function st(){if(this.pos+8>this.len)throw d(this,8);return new c(g(this.buf,this.pos+=4),g(this.buf,this.pos+=4))}$.prototype.float=function(){if(this.pos+4>this.len)throw d(this,4);var $t=a.float.readFloatLE(this.buf,this.pos);return this.pos+=4,$t},$.prototype.double=function(){if(this.pos+8>this.len)throw d(this,4);var $t=a.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,$t},$.prototype.bytes=function(){var $t=this.uint32(),vt=this.pos,Ft=this.pos+$t;if(Ft>this.len)throw d(this,$t);if(this.pos+=$t,Array.isArray(this.buf))return this.buf.slice(vt,Ft);if(vt===Ft){var Gt=a.Buffer;return Gt?Gt.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,vt,Ft)},$.prototype.string=function(){var $t=this.bytes();return s.read($t,0,$t.length)},$.prototype.skip=function($t){if(typeof $t=="number"){if(this.pos+$t>this.len)throw d(this,$t);this.pos+=$t}else do if(this.pos>=this.len)throw d(this);while(this.buf[this.pos++]&128);return this},$.prototype.skipType=function($t){switch($t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;($t=this.uint32()&7)!==4;)this.skipType($t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+$t+" at offset "+this.pos)}return this},$._configure=function($t){o=$t,$.create=h(),o._configure();var vt=a.Long?"toLong":"toNumber";a.merge($.prototype,{int64:function(){return b.call(this)[vt](!1)},uint64:function(){return b.call(this)[vt](!0)},sint64:function(){return b.call(this).zzDecode()[vt](!1)},fixed64:function(){return st.call(this)[vt](!0)},sfixed64:function(){return st.call(this)[vt](!1)}})}}),xu=me((e,i)=>{i.exports=c;var a=fi$1();(c.prototype=Object.create(a.prototype)).constructor=c;var o=Jt();function c(s){a.call(this,s)}c._configure=function(){o.Buffer&&(c.prototype._slice=o.Buffer.prototype.slice)},c.prototype.string=function(){var s=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+s,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+s,this.len))},c._configure()}),vu$1=me((e,i)=>{i.exports=o;var a=Jt();(o.prototype=Object.create(a.EventEmitter.prototype)).constructor=o;function o(c,s,d){if(typeof c!="function")throw TypeError("rpcImpl must be a function");a.EventEmitter.call(this),this.rpcImpl=c,this.requestDelimited=!!s,this.responseDelimited=!!d}o.prototype.rpcCall=function c(s,d,$,et,h){if(!et)throw TypeError("request must be specified");var b=this;if(!h)return a.asPromise(c,b,s,d,$,et);if(!b.rpcImpl){setTimeout(function(){h(Error("already ended"))},0);return}try{return b.rpcImpl(s,d[b.requestDelimited?"encodeDelimited":"encode"](et).finish(),function(g,st){if(g)return b.emit("error",g,s),h(g);if(st===null){b.end(!0);return}if(!(st instanceof $))try{st=$[b.responseDelimited?"decodeDelimited":"decode"](st)}catch($t){return b.emit("error",$t,s),h($t)}return b.emit("data",st,s),h(null,st)})}catch(g){b.emit("error",g,s),setTimeout(function(){h(g)},0);return}},o.prototype.end=function(c){return this.rpcImpl&&(c||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}}),Ou$1=me(e=>{var i=e;i.Service=vu$1()}),Su$1=me((e,i)=>{i.exports={}}),Eu$1=me(e=>{var i=e;i.build="minimal",i.Writer=si$1(),i.BufferWriter=cu$1(),i.Reader=fi$1(),i.BufferReader=xu(),i.util=Jt(),i.rpc=Ou$1(),i.roots=Su$1(),i.configure=a;function a(){i.util._configure(),i.Writer._configure(i.BufferWriter),i.Reader._configure(i.BufferReader)}a()}),Lu$1=me((e,i)=>{i.exports=Eu$1()}),Cr=me((e,i)=>{var a=Lu$1(),o=a.Reader,c=a.Writer,s=a.util,d=a.roots.default||(a.roots.default={});d.onnx=function(){var $={};return $.Version=function(){var et={},h=Object.create(et);return h[et[0]="_START_VERSION"]=0,h[et[1]="IR_VERSION_2017_10_10"]=1,h[et[2]="IR_VERSION_2017_10_30"]=2,h[et[3]="IR_VERSION_2017_11_3"]=3,h[et[4]="IR_VERSION_2019_1_22"]=4,h[et[5]="IR_VERSION_2019_3_18"]=5,h[et[6]="IR_VERSION_2019_9_19"]=6,h[et[7]="IR_VERSION_2020_5_8"]=7,h[et[8]="IR_VERSION_2021_7_30"]=8,h[et[9]="IR_VERSION"]=9,h}(),$.AttributeProto=function(){function et(h){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],this.sparseTensors=[],this.typeProtos=[],h)for(var b=Object.keys(h),g=0;g<b.length;++g)h[b[g]]!=null&&(this[b[g]]=h[b[g]])}return et.prototype.name="",et.prototype.refAttrName="",et.prototype.docString="",et.prototype.type=0,et.prototype.f=0,et.prototype.i=s.Long?s.Long.fromBits(0,0,!1):0,et.prototype.s=s.newBuffer([]),et.prototype.t=null,et.prototype.g=null,et.prototype.sparseTensor=null,et.prototype.tp=null,et.prototype.floats=s.emptyArray,et.prototype.ints=s.emptyArray,et.prototype.strings=s.emptyArray,et.prototype.tensors=s.emptyArray,et.prototype.graphs=s.emptyArray,et.prototype.sparseTensors=s.emptyArray,et.prototype.typeProtos=s.emptyArray,et.create=function(h){return new et(h)},et.encode=function(h,b){if(b||(b=c.create()),h.name!=null&&Object.hasOwnProperty.call(h,"name")&&b.uint32(10).string(h.name),h.f!=null&&Object.hasOwnProperty.call(h,"f")&&b.uint32(21).float(h.f),h.i!=null&&Object.hasOwnProperty.call(h,"i")&&b.uint32(24).int64(h.i),h.s!=null&&Object.hasOwnProperty.call(h,"s")&&b.uint32(34).bytes(h.s),h.t!=null&&Object.hasOwnProperty.call(h,"t")&&d.onnx.TensorProto.encode(h.t,b.uint32(42).fork()).ldelim(),h.g!=null&&Object.hasOwnProperty.call(h,"g")&&d.onnx.GraphProto.encode(h.g,b.uint32(50).fork()).ldelim(),h.floats!=null&&h.floats.length){b.uint32(58).fork();for(var g=0;g<h.floats.length;++g)b.float(h.floats[g]);b.ldelim()}if(h.ints!=null&&h.ints.length){b.uint32(66).fork();for(var g=0;g<h.ints.length;++g)b.int64(h.ints[g]);b.ldelim()}if(h.strings!=null&&h.strings.length)for(var g=0;g<h.strings.length;++g)b.uint32(74).bytes(h.strings[g]);if(h.tensors!=null&&h.tensors.length)for(var g=0;g<h.tensors.length;++g)d.onnx.TensorProto.encode(h.tensors[g],b.uint32(82).fork()).ldelim();if(h.graphs!=null&&h.graphs.length)for(var g=0;g<h.graphs.length;++g)d.onnx.GraphProto.encode(h.graphs[g],b.uint32(90).fork()).ldelim();if(h.docString!=null&&Object.hasOwnProperty.call(h,"docString")&&b.uint32(106).string(h.docString),h.tp!=null&&Object.hasOwnProperty.call(h,"tp")&&d.onnx.TypeProto.encode(h.tp,b.uint32(114).fork()).ldelim(),h.typeProtos!=null&&h.typeProtos.length)for(var g=0;g<h.typeProtos.length;++g)d.onnx.TypeProto.encode(h.typeProtos[g],b.uint32(122).fork()).ldelim();if(h.type!=null&&Object.hasOwnProperty.call(h,"type")&&b.uint32(160).int32(h.type),h.refAttrName!=null&&Object.hasOwnProperty.call(h,"refAttrName")&&b.uint32(170).string(h.refAttrName),h.sparseTensor!=null&&Object.hasOwnProperty.call(h,"sparseTensor")&&d.onnx.SparseTensorProto.encode(h.sparseTensor,b.uint32(178).fork()).ldelim(),h.sparseTensors!=null&&h.sparseTensors.length)for(var g=0;g<h.sparseTensors.length;++g)d.onnx.SparseTensorProto.encode(h.sparseTensors[g],b.uint32(186).fork()).ldelim();return b},et.encodeDelimited=function(h,b){return this.encode(h,b).ldelim()},et.decode=function(h,b){h instanceof o||(h=o.create(h));for(var g=b===void 0?h.len:h.pos+b,st=new d.onnx.AttributeProto;h.pos<g;){var $t=h.uint32();switch($t>>>3){case 1:{st.name=h.string();break}case 21:{st.refAttrName=h.string();break}case 13:{st.docString=h.string();break}case 20:{st.type=h.int32();break}case 2:{st.f=h.float();break}case 3:{st.i=h.int64();break}case 4:{st.s=h.bytes();break}case 5:{st.t=d.onnx.TensorProto.decode(h,h.uint32());break}case 6:{st.g=d.onnx.GraphProto.decode(h,h.uint32());break}case 22:{st.sparseTensor=d.onnx.SparseTensorProto.decode(h,h.uint32());break}case 14:{st.tp=d.onnx.TypeProto.decode(h,h.uint32());break}case 7:{if(st.floats&&st.floats.length||(st.floats=[]),($t&7)===2)for(var vt=h.uint32()+h.pos;h.pos<vt;)st.floats.push(h.float());else st.floats.push(h.float());break}case 8:{if(st.ints&&st.ints.length||(st.ints=[]),($t&7)===2)for(var vt=h.uint32()+h.pos;h.pos<vt;)st.ints.push(h.int64());else st.ints.push(h.int64());break}case 9:{st.strings&&st.strings.length||(st.strings=[]),st.strings.push(h.bytes());break}case 10:{st.tensors&&st.tensors.length||(st.tensors=[]),st.tensors.push(d.onnx.TensorProto.decode(h,h.uint32()));break}case 11:{st.graphs&&st.graphs.length||(st.graphs=[]),st.graphs.push(d.onnx.GraphProto.decode(h,h.uint32()));break}case 23:{st.sparseTensors&&st.sparseTensors.length||(st.sparseTensors=[]),st.sparseTensors.push(d.onnx.SparseTensorProto.decode(h,h.uint32()));break}case 15:{st.typeProtos&&st.typeProtos.length||(st.typeProtos=[]),st.typeProtos.push(d.onnx.TypeProto.decode(h,h.uint32()));break}default:h.skipType($t&7);break}}return st},et.decodeDelimited=function(h){return h instanceof o||(h=new o(h)),this.decode(h,h.uint32())},et.verify=function(h){if(typeof h!="object"||h===null)return"object expected";if(h.name!=null&&h.hasOwnProperty("name")&&!s.isString(h.name))return"name: string expected";if(h.refAttrName!=null&&h.hasOwnProperty("refAttrName")&&!s.isString(h.refAttrName))return"refAttrName: string expected";if(h.docString!=null&&h.hasOwnProperty("docString")&&!s.isString(h.docString))return"docString: string expected";if(h.type!=null&&h.hasOwnProperty("type"))switch(h.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 11:case 13:case 6:case 7:case 8:case 9:case 10:case 12:case 14:break}if(h.f!=null&&h.hasOwnProperty("f")&&typeof h.f!="number")return"f: number expected";if(h.i!=null&&h.hasOwnProperty("i")&&!s.isInteger(h.i)&&!(h.i&&s.isInteger(h.i.low)&&s.isInteger(h.i.high)))return"i: integer|Long expected";if(h.s!=null&&h.hasOwnProperty("s")&&!(h.s&&typeof h.s.length=="number"||s.isString(h.s)))return"s: buffer expected";if(h.t!=null&&h.hasOwnProperty("t")){var b=d.onnx.TensorProto.verify(h.t);if(b)return"t."+b}if(h.g!=null&&h.hasOwnProperty("g")){var b=d.onnx.GraphProto.verify(h.g);if(b)return"g."+b}if(h.sparseTensor!=null&&h.hasOwnProperty("sparseTensor")){var b=d.onnx.SparseTensorProto.verify(h.sparseTensor);if(b)return"sparseTensor."+b}if(h.tp!=null&&h.hasOwnProperty("tp")){var b=d.onnx.TypeProto.verify(h.tp);if(b)return"tp."+b}if(h.floats!=null&&h.hasOwnProperty("floats")){if(!Array.isArray(h.floats))return"floats: array expected";for(var g=0;g<h.floats.length;++g)if(typeof h.floats[g]!="number")return"floats: number[] expected"}if(h.ints!=null&&h.hasOwnProperty("ints")){if(!Array.isArray(h.ints))return"ints: array expected";for(var g=0;g<h.ints.length;++g)if(!s.isInteger(h.ints[g])&&!(h.ints[g]&&s.isInteger(h.ints[g].low)&&s.isInteger(h.ints[g].high)))return"ints: integer|Long[] expected"}if(h.strings!=null&&h.hasOwnProperty("strings")){if(!Array.isArray(h.strings))return"strings: array expected";for(var g=0;g<h.strings.length;++g)if(!(h.strings[g]&&typeof h.strings[g].length=="number"||s.isString(h.strings[g])))return"strings: buffer[] expected"}if(h.tensors!=null&&h.hasOwnProperty("tensors")){if(!Array.isArray(h.tensors))return"tensors: array expected";for(var g=0;g<h.tensors.length;++g){var b=d.onnx.TensorProto.verify(h.tensors[g]);if(b)return"tensors."+b}}if(h.graphs!=null&&h.hasOwnProperty("graphs")){if(!Array.isArray(h.graphs))return"graphs: array expected";for(var g=0;g<h.graphs.length;++g){var b=d.onnx.GraphProto.verify(h.graphs[g]);if(b)return"graphs."+b}}if(h.sparseTensors!=null&&h.hasOwnProperty("sparseTensors")){if(!Array.isArray(h.sparseTensors))return"sparseTensors: array expected";for(var g=0;g<h.sparseTensors.length;++g){var b=d.onnx.SparseTensorProto.verify(h.sparseTensors[g]);if(b)return"sparseTensors."+b}}if(h.typeProtos!=null&&h.hasOwnProperty("typeProtos")){if(!Array.isArray(h.typeProtos))return"typeProtos: array expected";for(var g=0;g<h.typeProtos.length;++g){var b=d.onnx.TypeProto.verify(h.typeProtos[g]);if(b)return"typeProtos."+b}}return null},et.fromObject=function(h){if(h instanceof d.onnx.AttributeProto)return h;var b=new d.onnx.AttributeProto;switch(h.name!=null&&(b.name=String(h.name)),h.refAttrName!=null&&(b.refAttrName=String(h.refAttrName)),h.docString!=null&&(b.docString=String(h.docString)),h.type){default:if(typeof h.type=="number"){b.type=h.type;break}break;case"UNDEFINED":case 0:b.type=0;break;case"FLOAT":case 1:b.type=1;break;case"INT":case 2:b.type=2;break;case"STRING":case 3:b.type=3;break;case"TENSOR":case 4:b.type=4;break;case"GRAPH":case 5:b.type=5;break;case"SPARSE_TENSOR":case 11:b.type=11;break;case"TYPE_PROTO":case 13:b.type=13;break;case"FLOATS":case 6:b.type=6;break;case"INTS":case 7:b.type=7;break;case"STRINGS":case 8:b.type=8;break;case"TENSORS":case 9:b.type=9;break;case"GRAPHS":case 10:b.type=10;break;case"SPARSE_TENSORS":case 12:b.type=12;break;case"TYPE_PROTOS":case 14:b.type=14;break}if(h.f!=null&&(b.f=Number(h.f)),h.i!=null&&(s.Long?(b.i=s.Long.fromValue(h.i)).unsigned=!1:typeof h.i=="string"?b.i=parseInt(h.i,10):typeof h.i=="number"?b.i=h.i:typeof h.i=="object"&&(b.i=new s.LongBits(h.i.low>>>0,h.i.high>>>0).toNumber())),h.s!=null&&(typeof h.s=="string"?s.base64.decode(h.s,b.s=s.newBuffer(s.base64.length(h.s)),0):h.s.length>=0&&(b.s=h.s)),h.t!=null){if(typeof h.t!="object")throw TypeError(".onnx.AttributeProto.t: object expected");b.t=d.onnx.TensorProto.fromObject(h.t)}if(h.g!=null){if(typeof h.g!="object")throw TypeError(".onnx.AttributeProto.g: object expected");b.g=d.onnx.GraphProto.fromObject(h.g)}if(h.sparseTensor!=null){if(typeof h.sparseTensor!="object")throw TypeError(".onnx.AttributeProto.sparseTensor: object expected");b.sparseTensor=d.onnx.SparseTensorProto.fromObject(h.sparseTensor)}if(h.tp!=null){if(typeof h.tp!="object")throw TypeError(".onnx.AttributeProto.tp: object expected");b.tp=d.onnx.TypeProto.fromObject(h.tp)}if(h.floats){if(!Array.isArray(h.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");b.floats=[];for(var g=0;g<h.floats.length;++g)b.floats[g]=Number(h.floats[g])}if(h.ints){if(!Array.isArray(h.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");b.ints=[];for(var g=0;g<h.ints.length;++g)s.Long?(b.ints[g]=s.Long.fromValue(h.ints[g])).unsigned=!1:typeof h.ints[g]=="string"?b.ints[g]=parseInt(h.ints[g],10):typeof h.ints[g]=="number"?b.ints[g]=h.ints[g]:typeof h.ints[g]=="object"&&(b.ints[g]=new s.LongBits(h.ints[g].low>>>0,h.ints[g].high>>>0).toNumber())}if(h.strings){if(!Array.isArray(h.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");b.strings=[];for(var g=0;g<h.strings.length;++g)typeof h.strings[g]=="string"?s.base64.decode(h.strings[g],b.strings[g]=s.newBuffer(s.base64.length(h.strings[g])),0):h.strings[g].length>=0&&(b.strings[g]=h.strings[g])}if(h.tensors){if(!Array.isArray(h.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");b.tensors=[];for(var g=0;g<h.tensors.length;++g){if(typeof h.tensors[g]!="object")throw TypeError(".onnx.AttributeProto.tensors: object expected");b.tensors[g]=d.onnx.TensorProto.fromObject(h.tensors[g])}}if(h.graphs){if(!Array.isArray(h.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");b.graphs=[];for(var g=0;g<h.graphs.length;++g){if(typeof h.graphs[g]!="object")throw TypeError(".onnx.AttributeProto.graphs: object expected");b.graphs[g]=d.onnx.GraphProto.fromObject(h.graphs[g])}}if(h.sparseTensors){if(!Array.isArray(h.sparseTensors))throw TypeError(".onnx.AttributeProto.sparseTensors: array expected");b.sparseTensors=[];for(var g=0;g<h.sparseTensors.length;++g){if(typeof h.sparseTensors[g]!="object")throw TypeError(".onnx.AttributeProto.sparseTensors: object expected");b.sparseTensors[g]=d.onnx.SparseTensorProto.fromObject(h.sparseTensors[g])}}if(h.typeProtos){if(!Array.isArray(h.typeProtos))throw TypeError(".onnx.AttributeProto.typeProtos: array expected");b.typeProtos=[];for(var g=0;g<h.typeProtos.length;++g){if(typeof h.typeProtos[g]!="object")throw TypeError(".onnx.AttributeProto.typeProtos: object expected");b.typeProtos[g]=d.onnx.TypeProto.fromObject(h.typeProtos[g])}}return b},et.toObject=function(h,b){b||(b={});var g={};if((b.arrays||b.defaults)&&(g.floats=[],g.ints=[],g.strings=[],g.tensors=[],g.graphs=[],g.typeProtos=[],g.sparseTensors=[]),b.defaults){if(g.name="",g.f=0,s.Long){var st=new s.Long(0,0,!1);g.i=b.longs===String?st.toString():b.longs===Number?st.toNumber():st}else g.i=b.longs===String?"0":0;b.bytes===String?g.s="":(g.s=[],b.bytes!==Array&&(g.s=s.newBuffer(g.s))),g.t=null,g.g=null,g.docString="",g.tp=null,g.type=b.enums===String?"UNDEFINED":0,g.refAttrName="",g.sparseTensor=null}if(h.name!=null&&h.hasOwnProperty("name")&&(g.name=h.name),h.f!=null&&h.hasOwnProperty("f")&&(g.f=b.json&&!isFinite(h.f)?String(h.f):h.f),h.i!=null&&h.hasOwnProperty("i")&&(typeof h.i=="number"?g.i=b.longs===String?String(h.i):h.i:g.i=b.longs===String?s.Long.prototype.toString.call(h.i):b.longs===Number?new s.LongBits(h.i.low>>>0,h.i.high>>>0).toNumber():h.i),h.s!=null&&h.hasOwnProperty("s")&&(g.s=b.bytes===String?s.base64.encode(h.s,0,h.s.length):b.bytes===Array?Array.prototype.slice.call(h.s):h.s),h.t!=null&&h.hasOwnProperty("t")&&(g.t=d.onnx.TensorProto.toObject(h.t,b)),h.g!=null&&h.hasOwnProperty("g")&&(g.g=d.onnx.GraphProto.toObject(h.g,b)),h.floats&&h.floats.length){g.floats=[];for(var $t=0;$t<h.floats.length;++$t)g.floats[$t]=b.json&&!isFinite(h.floats[$t])?String(h.floats[$t]):h.floats[$t]}if(h.ints&&h.ints.length){g.ints=[];for(var $t=0;$t<h.ints.length;++$t)typeof h.ints[$t]=="number"?g.ints[$t]=b.longs===String?String(h.ints[$t]):h.ints[$t]:g.ints[$t]=b.longs===String?s.Long.prototype.toString.call(h.ints[$t]):b.longs===Number?new s.LongBits(h.ints[$t].low>>>0,h.ints[$t].high>>>0).toNumber():h.ints[$t]}if(h.strings&&h.strings.length){g.strings=[];for(var $t=0;$t<h.strings.length;++$t)g.strings[$t]=b.bytes===String?s.base64.encode(h.strings[$t],0,h.strings[$t].length):b.bytes===Array?Array.prototype.slice.call(h.strings[$t]):h.strings[$t]}if(h.tensors&&h.tensors.length){g.tensors=[];for(var $t=0;$t<h.tensors.length;++$t)g.tensors[$t]=d.onnx.TensorProto.toObject(h.tensors[$t],b)}if(h.graphs&&h.graphs.length){g.graphs=[];for(var $t=0;$t<h.graphs.length;++$t)g.graphs[$t]=d.onnx.GraphProto.toObject(h.graphs[$t],b)}if(h.docString!=null&&h.hasOwnProperty("docString")&&(g.docString=h.docString),h.tp!=null&&h.hasOwnProperty("tp")&&(g.tp=d.onnx.TypeProto.toObject(h.tp,b)),h.typeProtos&&h.typeProtos.length){g.typeProtos=[];for(var $t=0;$t<h.typeProtos.length;++$t)g.typeProtos[$t]=d.onnx.TypeProto.toObject(h.typeProtos[$t],b)}if(h.type!=null&&h.hasOwnProperty("type")&&(g.type=b.enums===String?d.onnx.AttributeProto.AttributeType[h.type]===void 0?h.type:d.onnx.AttributeProto.AttributeType[h.type]:h.type),h.refAttrName!=null&&h.hasOwnProperty("refAttrName")&&(g.refAttrName=h.refAttrName),h.sparseTensor!=null&&h.hasOwnProperty("sparseTensor")&&(g.sparseTensor=d.onnx.SparseTensorProto.toObject(h.sparseTensor,b)),h.sparseTensors&&h.sparseTensors.length){g.sparseTensors=[];for(var $t=0;$t<h.sparseTensors.length;++$t)g.sparseTensors[$t]=d.onnx.SparseTensorProto.toObject(h.sparseTensors[$t],b)}return g},et.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},et.getTypeUrl=function(h){return h===void 0&&(h="type.googleapis.com"),h+"/onnx.AttributeProto"},et.AttributeType=function(){var h={},b=Object.create(h);return b[h[0]="UNDEFINED"]=0,b[h[1]="FLOAT"]=1,b[h[2]="INT"]=2,b[h[3]="STRING"]=3,b[h[4]="TENSOR"]=4,b[h[5]="GRAPH"]=5,b[h[11]="SPARSE_TENSOR"]=11,b[h[13]="TYPE_PROTO"]=13,b[h[6]="FLOATS"]=6,b[h[7]="INTS"]=7,b[h[8]="STRINGS"]=8,b[h[9]="TENSORS"]=9,b[h[10]="GRAPHS"]=10,b[h[12]="SPARSE_TENSORS"]=12,b[h[14]="TYPE_PROTOS"]=14,b}(),et}(),$.ValueInfoProto=function(){function et(h){if(h)for(var b=Object.keys(h),g=0;g<b.length;++g)h[b[g]]!=null&&(this[b[g]]=h[b[g]])}return et.prototype.name="",et.prototype.type=null,et.prototype.docString="",et.create=function(h){return new et(h)},et.encode=function(h,b){return b||(b=c.create()),h.name!=null&&Object.hasOwnProperty.call(h,"name")&&b.uint32(10).string(h.name),h.type!=null&&Object.hasOwnProperty.call(h,"type")&&d.onnx.TypeProto.encode(h.type,b.uint32(18).fork()).ldelim(),h.docString!=null&&Object.hasOwnProperty.call(h,"docString")&&b.uint32(26).string(h.docString),b},et.encodeDelimited=function(h,b){return this.encode(h,b).ldelim()},et.decode=function(h,b){h instanceof o||(h=o.create(h));for(var g=b===void 0?h.len:h.pos+b,st=new d.onnx.ValueInfoProto;h.pos<g;){var $t=h.uint32();switch($t>>>3){case 1:{st.name=h.string();break}case 2:{st.type=d.onnx.TypeProto.decode(h,h.uint32());break}case 3:{st.docString=h.string();break}default:h.skipType($t&7);break}}return st},et.decodeDelimited=function(h){return h instanceof o||(h=new o(h)),this.decode(h,h.uint32())},et.verify=function(h){if(typeof h!="object"||h===null)return"object expected";if(h.name!=null&&h.hasOwnProperty("name")&&!s.isString(h.name))return"name: string expected";if(h.type!=null&&h.hasOwnProperty("type")){var b=d.onnx.TypeProto.verify(h.type);if(b)return"type."+b}return h.docString!=null&&h.hasOwnProperty("docString")&&!s.isString(h.docString)?"docString: string expected":null},et.fromObject=function(h){if(h instanceof d.onnx.ValueInfoProto)return h;var b=new d.onnx.ValueInfoProto;if(h.name!=null&&(b.name=String(h.name)),h.type!=null){if(typeof h.type!="object")throw TypeError(".onnx.ValueInfoProto.type: object expected");b.type=d.onnx.TypeProto.fromObject(h.type)}return h.docString!=null&&(b.docString=String(h.docString)),b},et.toObject=function(h,b){b||(b={});var g={};return b.defaults&&(g.name="",g.type=null,g.docString=""),h.name!=null&&h.hasOwnProperty("name")&&(g.name=h.name),h.type!=null&&h.hasOwnProperty("type")&&(g.type=d.onnx.TypeProto.toObject(h.type,b)),h.docString!=null&&h.hasOwnProperty("docString")&&(g.docString=h.docString),g},et.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},et.getTypeUrl=function(h){return h===void 0&&(h="type.googleapis.com"),h+"/onnx.ValueInfoProto"},et}(),$.NodeProto=function(){function et(h){if(this.input=[],this.output=[],this.attribute=[],h)for(var b=Object.keys(h),g=0;g<b.length;++g)h[b[g]]!=null&&(this[b[g]]=h[b[g]])}return et.prototype.input=s.emptyArray,et.prototype.output=s.emptyArray,et.prototype.name="",et.prototype.opType="",et.prototype.domain="",et.prototype.attribute=s.emptyArray,et.prototype.docString="",et.create=function(h){return new et(h)},et.encode=function(h,b){if(b||(b=c.create()),h.input!=null&&h.input.length)for(var g=0;g<h.input.length;++g)b.uint32(10).string(h.input[g]);if(h.output!=null&&h.output.length)for(var g=0;g<h.output.length;++g)b.uint32(18).string(h.output[g]);if(h.name!=null&&Object.hasOwnProperty.call(h,"name")&&b.uint32(26).string(h.name),h.opType!=null&&Object.hasOwnProperty.call(h,"opType")&&b.uint32(34).string(h.opType),h.attribute!=null&&h.attribute.length)for(var g=0;g<h.attribute.length;++g)d.onnx.AttributeProto.encode(h.attribute[g],b.uint32(42).fork()).ldelim();return h.docString!=null&&Object.hasOwnProperty.call(h,"docString")&&b.uint32(50).string(h.docString),h.domain!=null&&Object.hasOwnProperty.call(h,"domain")&&b.uint32(58).string(h.domain),b},et.encodeDelimited=function(h,b){return this.encode(h,b).ldelim()},et.decode=function(h,b){h instanceof o||(h=o.create(h));for(var g=b===void 0?h.len:h.pos+b,st=new d.onnx.NodeProto;h.pos<g;){var $t=h.uint32();switch($t>>>3){case 1:{st.input&&st.input.length||(st.input=[]),st.input.push(h.string());break}case 2:{st.output&&st.output.length||(st.output=[]),st.output.push(h.string());break}case 3:{st.name=h.string();break}case 4:{st.opType=h.string();break}case 7:{st.domain=h.string();break}case 5:{st.attribute&&st.attribute.length||(st.attribute=[]),st.attribute.push(d.onnx.AttributeProto.decode(h,h.uint32()));break}case 6:{st.docString=h.string();break}default:h.skipType($t&7);break}}return st},et.decodeDelimited=function(h){return h instanceof o||(h=new o(h)),this.decode(h,h.uint32())},et.verify=function(h){if(typeof h!="object"||h===null)return"object expected";if(h.input!=null&&h.hasOwnProperty("input")){if(!Array.isArray(h.input))return"input: array expected";for(var b=0;b<h.input.length;++b)if(!s.isString(h.input[b]))return"input: string[] expected"}if(h.output!=null&&h.hasOwnProperty("output")){if(!Array.isArray(h.output))return"output: array expected";for(var b=0;b<h.output.length;++b)if(!s.isString(h.output[b]))return"output: string[] expected"}if(h.name!=null&&h.hasOwnProperty("name")&&!s.isString(h.name))return"name: string expected";if(h.opType!=null&&h.hasOwnProperty("opType")&&!s.isString(h.opType))return"opType: string expected";if(h.domain!=null&&h.hasOwnProperty("domain")&&!s.isString(h.domain))return"domain: string expected";if(h.attribute!=null&&h.hasOwnProperty("attribute")){if(!Array.isArray(h.attribute))return"attribute: array expected";for(var b=0;b<h.attribute.length;++b){var g=d.onnx.AttributeProto.verify(h.attribute[b]);if(g)return"attribute."+g}}return h.docString!=null&&h.hasOwnProperty("docString")&&!s.isString(h.docString)?"docString: string expected":null},et.fromObject=function(h){if(h instanceof d.onnx.NodeProto)return h;var b=new d.onnx.NodeProto;if(h.input){if(!Array.isArray(h.input))throw TypeError(".onnx.NodeProto.input: array expected");b.input=[];for(var g=0;g<h.input.length;++g)b.input[g]=String(h.input[g])}if(h.output){if(!Array.isArray(h.output))throw TypeError(".onnx.NodeProto.output: array expected");b.output=[];for(var g=0;g<h.output.length;++g)b.output[g]=String(h.output[g])}if(h.name!=null&&(b.name=String(h.name)),h.opType!=null&&(b.opType=String(h.opType)),h.domain!=null&&(b.domain=String(h.domain)),h.attribute){if(!Array.isArray(h.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");b.attribute=[];for(var g=0;g<h.attribute.length;++g){if(typeof h.attribute[g]!="object")throw TypeError(".onnx.NodeProto.attribute: object expected");b.attribute[g]=d.onnx.AttributeProto.fromObject(h.attribute[g])}}return h.docString!=null&&(b.docString=String(h.docString)),b},et.toObject=function(h,b){b||(b={});var g={};if((b.arrays||b.defaults)&&(g.input=[],g.output=[],g.attribute=[]),b.defaults&&(g.name="",g.opType="",g.docString="",g.domain=""),h.input&&h.input.length){g.input=[];for(var st=0;st<h.input.length;++st)g.input[st]=h.input[st]}if(h.output&&h.output.length){g.output=[];for(var st=0;st<h.output.length;++st)g.output[st]=h.output[st]}if(h.name!=null&&h.hasOwnProperty("name")&&(g.name=h.name),h.opType!=null&&h.hasOwnProperty("opType")&&(g.opType=h.opType),h.attribute&&h.attribute.length){g.attribute=[];for(var st=0;st<h.attribute.length;++st)g.attribute[st]=d.onnx.AttributeProto.toObject(h.attribute[st],b)}return h.docString!=null&&h.hasOwnProperty("docString")&&(g.docString=h.docString),h.domain!=null&&h.hasOwnProperty("domain")&&(g.domain=h.domain),g},et.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},et.getTypeUrl=function(h){return h===void 0&&(h="type.googleapis.com"),h+"/onnx.NodeProto"},et}(),$.TrainingInfoProto=function(){function et(h){if(this.initializationBinding=[],this.updateBinding=[],h)for(var b=Object.keys(h),g=0;g<b.length;++g)h[b[g]]!=null&&(this[b[g]]=h[b[g]])}return et.prototype.initialization=null,et.prototype.algorithm=null,et.prototype.initializationBinding=s.emptyArray,et.prototype.updateBinding=s.emptyArray,et.create=function(h){return new et(h)},et.encode=function(h,b){if(b||(b=c.create()),h.initialization!=null&&Object.hasOwnProperty.call(h,"initialization")&&d.onnx.GraphProto.encode(h.initialization,b.uint32(10).fork()).ldelim(),h.algorithm!=null&&Object.hasOwnProperty.call(h,"algorithm")&&d.onnx.GraphProto.encode(h.algorithm,b.uint32(18).fork()).ldelim(),h.initializationBinding!=null&&h.initializationBinding.length)for(var g=0;g<h.initializationBinding.length;++g)d.onnx.StringStringEntryProto.encode(h.initializationBinding[g],b.uint32(26).fork()).ldelim();if(h.updateBinding!=null&&h.updateBinding.length)for(var g=0;g<h.updateBinding.length;++g)d.onnx.StringStringEntryProto.encode(h.updateBinding[g],b.uint32(34).fork()).ldelim();return b},et.encodeDelimited=function(h,b){return this.encode(h,b).ldelim()},et.decode=function(h,b){h instanceof o||(h=o.create(h));for(var g=b===void 0?h.len:h.pos+b,st=new d.onnx.TrainingInfoProto;h.pos<g;){var $t=h.uint32();switch($t>>>3){case 1:{st.initialization=d.onnx.GraphProto.decode(h,h.uint32());break}case 2:{st.algorithm=d.onnx.GraphProto.decode(h,h.uint32());break}case 3:{st.initializationBinding&&st.initializationBinding.length||(st.initializationBinding=[]),st.initializationBinding.push(d.onnx.StringStringEntryProto.decode(h,h.uint32()));break}case 4:{st.updateBinding&&st.updateBinding.length||(st.updateBinding=[]),st.updateBinding.push(d.onnx.StringStringEntryProto.decode(h,h.uint32()));break}default:h.skipType($t&7);break}}return st},et.decodeDelimited=function(h){return h instanceof o||(h=new o(h)),this.decode(h,h.uint32())},et.verify=function(h){if(typeof h!="object"||h===null)return"object expected";if(h.initialization!=null&&h.hasOwnProperty("initialization")){var b=d.onnx.GraphProto.verify(h.initialization);if(b)return"initialization."+b}if(h.algorithm!=null&&h.hasOwnProperty("algorithm")){var b=d.onnx.GraphProto.verify(h.algorithm);if(b)return"algorithm."+b}if(h.initializationBinding!=null&&h.hasOwnProperty("initializationBinding")){if(!Array.isArray(h.initializationBinding))return"initializationBinding: array expected";for(var g=0;g<h.initializationBinding.length;++g){var b=d.onnx.StringStringEntryProto.verify(h.initializationBinding[g]);if(b)return"initializationBinding."+b}}if(h.updateBinding!=null&&h.hasOwnProperty("updateBinding")){if(!Array.isArray(h.updateBinding))return"updateBinding: array expected";for(var g=0;g<h.updateBinding.length;++g){var b=d.onnx.StringStringEntryProto.verify(h.updateBinding[g]);if(b)return"updateBinding."+b}}return null},et.fromObject=function(h){if(h instanceof d.onnx.TrainingInfoProto)return h;var b=new d.onnx.TrainingInfoProto;if(h.initialization!=null){if(typeof h.initialization!="object")throw TypeError(".onnx.TrainingInfoProto.initialization: object expected");b.initialization=d.onnx.GraphProto.fromObject(h.initialization)}if(h.algorithm!=null){if(typeof h.algorithm!="object")throw TypeError(".onnx.TrainingInfoProto.algorithm: object expected");b.algorithm=d.onnx.GraphProto.fromObject(h.algorithm)}if(h.initializationBinding){if(!Array.isArray(h.initializationBinding))throw TypeError(".onnx.TrainingInfoProto.initializationBinding: array expected");b.initializationBinding=[];for(var g=0;g<h.initializationBinding.length;++g){if(typeof h.initializationBinding[g]!="object")throw TypeError(".onnx.TrainingInfoProto.initializationBinding: object expected");b.initializationBinding[g]=d.onnx.StringStringEntryProto.fromObject(h.initializationBinding[g])}}if(h.updateBinding){if(!Array.isArray(h.updateBinding))throw TypeError(".onnx.TrainingInfoProto.updateBinding: array expected");b.updateBinding=[];for(var g=0;g<h.updateBinding.length;++g){if(typeof h.updateBinding[g]!="object")throw TypeError(".onnx.TrainingInfoProto.updateBinding: object expected");b.updateBinding[g]=d.onnx.StringStringEntryProto.fromObject(h.updateBinding[g])}}return b},et.toObject=function(h,b){b||(b={});var g={};if((b.arrays||b.defaults)&&(g.initializationBinding=[],g.updateBinding=[]),b.defaults&&(g.initialization=null,g.algorithm=null),h.initialization!=null&&h.hasOwnProperty("initialization")&&(g.initialization=d.onnx.GraphProto.toObject(h.initialization,b)),h.algorithm!=null&&h.hasOwnProperty("algorithm")&&(g.algorithm=d.onnx.GraphProto.toObject(h.algorithm,b)),h.initializationBinding&&h.initializationBinding.length){g.initializationBinding=[];for(var st=0;st<h.initializationBinding.length;++st)g.initializationBinding[st]=d.onnx.StringStringEntryProto.toObject(h.initializationBinding[st],b)}if(h.updateBinding&&h.updateBinding.length){g.updateBinding=[];for(var st=0;st<h.updateBinding.length;++st)g.updateBinding[st]=d.onnx.StringStringEntryProto.toObject(h.updateBinding[st],b)}return g},et.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},et.getTypeUrl=function(h){return h===void 0&&(h="type.googleapis.com"),h+"/onnx.TrainingInfoProto"},et}(),$.ModelProto=function(){function et(h){if(this.opsetImport=[],this.metadataProps=[],this.trainingInfo=[],this.functions=[],h)for(var b=Object.keys(h),g=0;g<b.length;++g)h[b[g]]!=null&&(this[b[g]]=h[b[g]])}return et.prototype.irVersion=s.Long?s.Long.fromBits(0,0,!1):0,et.prototype.opsetImport=s.emptyArray,et.prototype.producerName="",et.prototype.producerVersion="",et.prototype.domain="",et.prototype.modelVersion=s.Long?s.Long.fromBits(0,0,!1):0,et.prototype.docString="",et.prototype.graph=null,et.prototype.metadataProps=s.emptyArray,et.prototype.trainingInfo=s.emptyArray,et.prototype.functions=s.emptyArray,et.create=function(h){return new et(h)},et.encode=function(h,b){if(b||(b=c.create()),h.irVersion!=null&&Object.hasOwnProperty.call(h,"irVersion")&&b.uint32(8).int64(h.irVersion),h.producerName!=null&&Object.hasOwnProperty.call(h,"producerName")&&b.uint32(18).string(h.producerName),h.producerVersion!=null&&Object.hasOwnProperty.call(h,"producerVersion")&&b.uint32(26).string(h.producerVersion),h.domain!=null&&Object.hasOwnProperty.call(h,"domain")&&b.uint32(34).string(h.domain),h.modelVersion!=null&&Object.hasOwnProperty.call(h,"modelVersion")&&b.uint32(40).int64(h.modelVersion),h.docString!=null&&Object.hasOwnProperty.call(h,"docString")&&b.uint32(50).string(h.docString),h.graph!=null&&Object.hasOwnProperty.call(h,"graph")&&d.onnx.GraphProto.encode(h.graph,b.uint32(58).fork()).ldelim(),h.opsetImport!=null&&h.opsetImport.length)for(var g=0;g<h.opsetImport.length;++g)d.onnx.OperatorSetIdProto.encode(h.opsetImport[g],b.uint32(66).fork()).ldelim();if(h.metadataProps!=null&&h.metadataProps.length)for(var g=0;g<h.metadataProps.length;++g)d.onnx.StringStringEntryProto.encode(h.metadataProps[g],b.uint32(114).fork()).ldelim();if(h.trainingInfo!=null&&h.trainingInfo.length)for(var g=0;g<h.trainingInfo.length;++g)d.onnx.TrainingInfoProto.encode(h.trainingInfo[g],b.uint32(162).fork()).ldelim();if(h.functions!=null&&h.functions.length)for(var g=0;g<h.functions.length;++g)d.onnx.FunctionProto.encode(h.functions[g],b.uint32(202).fork()).ldelim();return b},et.encodeDelimited=function(h,b){return this.encode(h,b).ldelim()},et.decode=function(h,b){h instanceof o||(h=o.create(h));for(var g=b===void 0?h.len:h.pos+b,st=new d.onnx.ModelProto;h.pos<g;){var $t=h.uint32();switch($t>>>3){case 1:{st.irVersion=h.int64();break}case 8:{st.opsetImport&&st.opsetImport.length||(st.opsetImport=[]),st.opsetImport.push(d.onnx.OperatorSetIdProto.decode(h,h.uint32()));break}case 2:{st.producerName=h.string();break}case 3:{st.producerVersion=h.string();break}case 4:{st.domain=h.string();break}case 5:{st.modelVersion=h.int64();break}case 6:{st.docString=h.string();break}case 7:{st.graph=d.onnx.GraphProto.decode(h,h.uint32());break}case 14:{st.metadataProps&&st.metadataProps.length||(st.metadataProps=[]),st.metadataProps.push(d.onnx.StringStringEntryProto.decode(h,h.uint32()));break}case 20:{st.trainingInfo&&st.trainingInfo.length||(st.trainingInfo=[]),st.trainingInfo.push(d.onnx.TrainingInfoProto.decode(h,h.uint32()));break}case 25:{st.functions&&st.functions.length||(st.functions=[]),st.functions.push(d.onnx.FunctionProto.decode(h,h.uint32()));break}default:h.skipType($t&7);break}}return st},et.decodeDelimited=function(h){return h instanceof o||(h=new o(h)),this.decode(h,h.uint32())},et.verify=function(h){if(typeof h!="object"||h===null)return"object expected";if(h.irVersion!=null&&h.hasOwnProperty("irVersion")&&!s.isInteger(h.irVersion)&&!(h.irVersion&&s.isInteger(h.irVersion.low)&&s.isInteger(h.irVersion.high)))return"irVersion: integer|Long expected";if(h.opsetImport!=null&&h.hasOwnProperty("opsetImport")){if(!Array.isArray(h.opsetImport))return"opsetImport: array expected";for(var b=0;b<h.opsetImport.length;++b){var g=d.onnx.OperatorSetIdProto.verify(h.opsetImport[b]);if(g)return"opsetImport."+g}}if(h.producerName!=null&&h.hasOwnProperty("producerName")&&!s.isString(h.producerName))return"producerName: string expected";if(h.producerVersion!=null&&h.hasOwnProperty("producerVersion")&&!s.isString(h.producerVersion))return"producerVersion: string expected";if(h.domain!=null&&h.hasOwnProperty("domain")&&!s.isString(h.domain))return"domain: string expected";if(h.modelVersion!=null&&h.hasOwnProperty("modelVersion")&&!s.isInteger(h.modelVersion)&&!(h.modelVersion&&s.isInteger(h.modelVersion.low)&&s.isInteger(h.modelVersion.high)))return"modelVersion: integer|Long expected";if(h.docString!=null&&h.hasOwnProperty("docString")&&!s.isString(h.docString))return"docString: string expected";if(h.graph!=null&&h.hasOwnProperty("graph")){var g=d.onnx.GraphProto.verify(h.graph);if(g)return"graph."+g}if(h.metadataProps!=null&&h.hasOwnProperty("metadataProps")){if(!Array.isArray(h.metadataProps))return"metadataProps: array expected";for(var b=0;b<h.metadataProps.length;++b){var g=d.onnx.StringStringEntryProto.verify(h.metadataProps[b]);if(g)return"metadataProps."+g}}if(h.trainingInfo!=null&&h.hasOwnProperty("trainingInfo")){if(!Array.isArray(h.trainingInfo))return"trainingInfo: array expected";for(var b=0;b<h.trainingInfo.length;++b){var g=d.onnx.TrainingInfoProto.verify(h.trainingInfo[b]);if(g)return"trainingInfo."+g}}if(h.functions!=null&&h.hasOwnProperty("functions")){if(!Array.isArray(h.functions))return"functions: array expected";for(var b=0;b<h.functions.length;++b){var g=d.onnx.FunctionProto.verify(h.functions[b]);if(g)return"functions."+g}}return null},et.fromObject=function(h){if(h instanceof d.onnx.ModelProto)return h;var b=new d.onnx.ModelProto;if(h.irVersion!=null&&(s.Long?(b.irVersion=s.Long.fromValue(h.irVersion)).unsigned=!1:typeof h.irVersion=="string"?b.irVersion=parseInt(h.irVersion,10):typeof h.irVersion=="number"?b.irVersion=h.irVersion:typeof h.irVersion=="object"&&(b.irVersion=new s.LongBits(h.irVersion.low>>>0,h.irVersion.high>>>0).toNumber())),h.opsetImport){if(!Array.isArray(h.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");b.opsetImport=[];for(var g=0;g<h.opsetImport.length;++g){if(typeof h.opsetImport[g]!="object")throw TypeError(".onnx.ModelProto.opsetImport: object expected");b.opsetImport[g]=d.onnx.OperatorSetIdProto.fromObject(h.opsetImport[g])}}if(h.producerName!=null&&(b.producerName=String(h.producerName)),h.producerVersion!=null&&(b.producerVersion=String(h.producerVersion)),h.domain!=null&&(b.domain=String(h.domain)),h.modelVersion!=null&&(s.Long?(b.modelVersion=s.Long.fromValue(h.modelVersion)).unsigned=!1:typeof h.modelVersion=="string"?b.modelVersion=parseInt(h.modelVersion,10):typeof h.modelVersion=="number"?b.modelVersion=h.modelVersion:typeof h.modelVersion=="object"&&(b.modelVersion=new s.LongBits(h.modelVersion.low>>>0,h.modelVersion.high>>>0).toNumber())),h.docString!=null&&(b.docString=String(h.docString)),h.graph!=null){if(typeof h.graph!="object")throw TypeError(".onnx.ModelProto.graph: object expected");b.graph=d.onnx.GraphProto.fromObject(h.graph)}if(h.metadataProps){if(!Array.isArray(h.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");b.metadataProps=[];for(var g=0;g<h.metadataProps.length;++g){if(typeof h.metadataProps[g]!="object")throw TypeError(".onnx.ModelProto.metadataProps: object expected");b.metadataProps[g]=d.onnx.StringStringEntryProto.fromObject(h.metadataProps[g])}}if(h.trainingInfo){if(!Array.isArray(h.trainingInfo))throw TypeError(".onnx.ModelProto.trainingInfo: array expected");b.trainingInfo=[];for(var g=0;g<h.trainingInfo.length;++g){if(typeof h.trainingInfo[g]!="object")throw TypeError(".onnx.ModelProto.trainingInfo: object expected");b.trainingInfo[g]=d.onnx.TrainingInfoProto.fromObject(h.trainingInfo[g])}}if(h.functions){if(!Array.isArray(h.functions))throw TypeError(".onnx.ModelProto.functions: array expected");b.functions=[];for(var g=0;g<h.functions.length;++g){if(typeof h.functions[g]!="object")throw TypeError(".onnx.ModelProto.functions: object expected");b.functions[g]=d.onnx.FunctionProto.fromObject(h.functions[g])}}return b},et.toObject=function(h,b){b||(b={});var g={};if((b.arrays||b.defaults)&&(g.opsetImport=[],g.metadataProps=[],g.trainingInfo=[],g.functions=[]),b.defaults){if(s.Long){var st=new s.Long(0,0,!1);g.irVersion=b.longs===String?st.toString():b.longs===Number?st.toNumber():st}else g.irVersion=b.longs===String?"0":0;if(g.producerName="",g.producerVersion="",g.domain="",s.Long){var st=new s.Long(0,0,!1);g.modelVersion=b.longs===String?st.toString():b.longs===Number?st.toNumber():st}else g.modelVersion=b.longs===String?"0":0;g.docString="",g.graph=null}if(h.irVersion!=null&&h.hasOwnProperty("irVersion")&&(typeof h.irVersion=="number"?g.irVersion=b.longs===String?String(h.irVersion):h.irVersion:g.irVersion=b.longs===String?s.Long.prototype.toString.call(h.irVersion):b.longs===Number?new s.LongBits(h.irVersion.low>>>0,h.irVersion.high>>>0).toNumber():h.irVersion),h.producerName!=null&&h.hasOwnProperty("producerName")&&(g.producerName=h.producerName),h.producerVersion!=null&&h.hasOwnProperty("producerVersion")&&(g.producerVersion=h.producerVersion),h.domain!=null&&h.hasOwnProperty("domain")&&(g.domain=h.domain),h.modelVersion!=null&&h.hasOwnProperty("modelVersion")&&(typeof h.modelVersion=="number"?g.modelVersion=b.longs===String?String(h.modelVersion):h.modelVersion:g.modelVersion=b.longs===String?s.Long.prototype.toString.call(h.modelVersion):b.longs===Number?new s.LongBits(h.modelVersion.low>>>0,h.modelVersion.high>>>0).toNumber():h.modelVersion),h.docString!=null&&h.hasOwnProperty("docString")&&(g.docString=h.docString),h.graph!=null&&h.hasOwnProperty("graph")&&(g.graph=d.onnx.GraphProto.toObject(h.graph,b)),h.opsetImport&&h.opsetImport.length){g.opsetImport=[];for(var $t=0;$t<h.opsetImport.length;++$t)g.opsetImport[$t]=d.onnx.OperatorSetIdProto.toObject(h.opsetImport[$t],b)}if(h.metadataProps&&h.metadataProps.length){g.metadataProps=[];for(var $t=0;$t<h.metadataProps.length;++$t)g.metadataProps[$t]=d.onnx.StringStringEntryProto.toObject(h.metadataProps[$t],b)}if(h.trainingInfo&&h.trainingInfo.length){g.trainingInfo=[];for(var $t=0;$t<h.trainingInfo.length;++$t)g.trainingInfo[$t]=d.onnx.TrainingInfoProto.toObject(h.trainingInfo[$t],b)}if(h.functions&&h.functions.length){g.functions=[];for(var $t=0;$t<h.functions.length;++$t)g.functions[$t]=d.onnx.FunctionProto.toObject(h.functions[$t],b)}return g},et.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},et.getTypeUrl=function(h){return h===void 0&&(h="type.googleapis.com"),h+"/onnx.ModelProto"},et}(),$.StringStringEntryProto=function(){function et(h){if(h)for(var b=Object.keys(h),g=0;g<b.length;++g)h[b[g]]!=null&&(this[b[g]]=h[b[g]])}return et.prototype.key="",et.prototype.value="",et.create=function(h){return new et(h)},et.encode=function(h,b){return b||(b=c.create()),h.key!=null&&Object.hasOwnProperty.call(h,"key")&&b.uint32(10).string(h.key),h.value!=null&&Object.hasOwnProperty.call(h,"value")&&b.uint32(18).string(h.value),b},et.encodeDelimited=function(h,b){return this.encode(h,b).ldelim()},et.decode=function(h,b){h instanceof o||(h=o.create(h));for(var g=b===void 0?h.len:h.pos+b,st=new d.onnx.StringStringEntryProto;h.pos<g;){var $t=h.uint32();switch($t>>>3){case 1:{st.key=h.string();break}case 2:{st.value=h.string();break}default:h.skipType($t&7);break}}return st},et.decodeDelimited=function(h){return h instanceof o||(h=new o(h)),this.decode(h,h.uint32())},et.verify=function(h){return typeof h!="object"||h===null?"object expected":h.key!=null&&h.hasOwnProperty("key")&&!s.isString(h.key)?"key: string expected":h.value!=null&&h.hasOwnProperty("value")&&!s.isString(h.value)?"value: string expected":null},et.fromObject=function(h){if(h instanceof d.onnx.StringStringEntryProto)return h;var b=new d.onnx.StringStringEntryProto;return h.key!=null&&(b.key=String(h.key)),h.value!=null&&(b.value=String(h.value)),b},et.toObject=function(h,b){b||(b={});var g={};return b.defaults&&(g.key="",g.value=""),h.key!=null&&h.hasOwnProperty("key")&&(g.key=h.key),h.value!=null&&h.hasOwnProperty("value")&&(g.value=h.value),g},et.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},et.getTypeUrl=function(h){return h===void 0&&(h="type.googleapis.com"),h+"/onnx.StringStringEntryProto"},et}(),$.TensorAnnotation=function(){function et(h){if(this.quantParameterTensorNames=[],h)for(var b=Object.keys(h),g=0;g<b.length;++g)h[b[g]]!=null&&(this[b[g]]=h[b[g]])}return et.prototype.tensorName="",et.prototype.quantParameterTensorNames=s.emptyArray,et.create=function(h){return new et(h)},et.encode=function(h,b){if(b||(b=c.create()),h.tensorName!=null&&Object.hasOwnProperty.call(h,"tensorName")&&b.uint32(10).string(h.tensorName),h.quantParameterTensorNames!=null&&h.quantParameterTensorNames.length)for(var g=0;g<h.quantParameterTensorNames.length;++g)d.onnx.StringStringEntryProto.encode(h.quantParameterTensorNames[g],b.uint32(18).fork()).ldelim();return b},et.encodeDelimited=function(h,b){return this.encode(h,b).ldelim()},et.decode=function(h,b){h instanceof o||(h=o.create(h));for(var g=b===void 0?h.len:h.pos+b,st=new d.onnx.TensorAnnotation;h.pos<g;){var $t=h.uint32();switch($t>>>3){case 1:{st.tensorName=h.string();break}case 2:{st.quantParameterTensorNames&&st.quantParameterTensorNames.length||(st.quantParameterTensorNames=[]),st.quantParameterTensorNames.push(d.onnx.StringStringEntryProto.decode(h,h.uint32()));break}default:h.skipType($t&7);break}}return st},et.decodeDelimited=function(h){return h instanceof o||(h=new o(h)),this.decode(h,h.uint32())},et.verify=function(h){if(typeof h!="object"||h===null)return"object expected";if(h.tensorName!=null&&h.hasOwnProperty("tensorName")&&!s.isString(h.tensorName))return"tensorName: string expected";if(h.quantParameterTensorNames!=null&&h.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(h.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var b=0;b<h.quantParameterTensorNames.length;++b){var g=d.onnx.StringStringEntryProto.verify(h.quantParameterTensorNames[b]);if(g)return"quantParameterTensorNames."+g}}return null},et.fromObject=function(h){if(h instanceof d.onnx.TensorAnnotation)return h;var b=new d.onnx.TensorAnnotation;if(h.tensorName!=null&&(b.tensorName=String(h.tensorName)),h.quantParameterTensorNames){if(!Array.isArray(h.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");b.quantParameterTensorNames=[];for(var g=0;g<h.quantParameterTensorNames.length;++g){if(typeof h.quantParameterTensorNames[g]!="object")throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");b.quantParameterTensorNames[g]=d.onnx.StringStringEntryProto.fromObject(h.quantParameterTensorNames[g])}}return b},et.toObject=function(h,b){b||(b={});var g={};if((b.arrays||b.defaults)&&(g.quantParameterTensorNames=[]),b.defaults&&(g.tensorName=""),h.tensorName!=null&&h.hasOwnProperty("tensorName")&&(g.tensorName=h.tensorName),h.quantParameterTensorNames&&h.quantParameterTensorNames.length){g.quantParameterTensorNames=[];for(var st=0;st<h.quantParameterTensorNames.length;++st)g.quantParameterTensorNames[st]=d.onnx.StringStringEntryProto.toObject(h.quantParameterTensorNames[st],b)}return g},et.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},et.getTypeUrl=function(h){return h===void 0&&(h="type.googleapis.com"),h+"/onnx.TensorAnnotation"},et}(),$.GraphProto=function(){function et(h){if(this.node=[],this.initializer=[],this.sparseInitializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],h)for(var b=Object.keys(h),g=0;g<b.length;++g)h[b[g]]!=null&&(this[b[g]]=h[b[g]])}return et.prototype.node=s.emptyArray,et.prototype.name="",et.prototype.initializer=s.emptyArray,et.prototype.sparseInitializer=s.emptyArray,et.prototype.docString="",et.prototype.input=s.emptyArray,et.prototype.output=s.emptyArray,et.prototype.valueInfo=s.emptyArray,et.prototype.quantizationAnnotation=s.emptyArray,et.create=function(h){return new et(h)},et.encode=function(h,b){if(b||(b=c.create()),h.node!=null&&h.node.length)for(var g=0;g<h.node.length;++g)d.onnx.NodeProto.encode(h.node[g],b.uint32(10).fork()).ldelim();if(h.name!=null&&Object.hasOwnProperty.call(h,"name")&&b.uint32(18).string(h.name),h.initializer!=null&&h.initializer.length)for(var g=0;g<h.initializer.length;++g)d.onnx.TensorProto.encode(h.initializer[g],b.uint32(42).fork()).ldelim();if(h.docString!=null&&Object.hasOwnProperty.call(h,"docString")&&b.uint32(82).string(h.docString),h.input!=null&&h.input.length)for(var g=0;g<h.input.length;++g)d.onnx.ValueInfoProto.encode(h.input[g],b.uint32(90).fork()).ldelim();if(h.output!=null&&h.output.length)for(var g=0;g<h.output.length;++g)d.onnx.ValueInfoProto.encode(h.output[g],b.uint32(98).fork()).ldelim();if(h.valueInfo!=null&&h.valueInfo.length)for(var g=0;g<h.valueInfo.length;++g)d.onnx.ValueInfoProto.encode(h.valueInfo[g],b.uint32(106).fork()).ldelim();if(h.quantizationAnnotation!=null&&h.quantizationAnnotation.length)for(var g=0;g<h.quantizationAnnotation.length;++g)d.onnx.TensorAnnotation.encode(h.quantizationAnnotation[g],b.uint32(114).fork()).ldelim();if(h.sparseInitializer!=null&&h.sparseInitializer.length)for(var g=0;g<h.sparseInitializer.length;++g)d.onnx.SparseTensorProto.encode(h.sparseInitializer[g],b.uint32(122).fork()).ldelim();return b},et.encodeDelimited=function(h,b){return this.encode(h,b).ldelim()},et.decode=function(h,b){h instanceof o||(h=o.create(h));for(var g=b===void 0?h.len:h.pos+b,st=new d.onnx.GraphProto;h.pos<g;){var $t=h.uint32();switch($t>>>3){case 1:{st.node&&st.node.length||(st.node=[]),st.node.push(d.onnx.NodeProto.decode(h,h.uint32()));break}case 2:{st.name=h.string();break}case 5:{st.initializer&&st.initializer.length||(st.initializer=[]),st.initializer.push(d.onnx.TensorProto.decode(h,h.uint32()));break}case 15:{st.sparseInitializer&&st.sparseInitializer.length||(st.sparseInitializer=[]),st.sparseInitializer.push(d.onnx.SparseTensorProto.decode(h,h.uint32()));break}case 10:{st.docString=h.string();break}case 11:{st.input&&st.input.length||(st.input=[]),st.input.push(d.onnx.ValueInfoProto.decode(h,h.uint32()));break}case 12:{st.output&&st.output.length||(st.output=[]),st.output.push(d.onnx.ValueInfoProto.decode(h,h.uint32()));break}case 13:{st.valueInfo&&st.valueInfo.length||(st.valueInfo=[]),st.valueInfo.push(d.onnx.ValueInfoProto.decode(h,h.uint32()));break}case 14:{st.quantizationAnnotation&&st.quantizationAnnotation.length||(st.quantizationAnnotation=[]),st.quantizationAnnotation.push(d.onnx.TensorAnnotation.decode(h,h.uint32()));break}default:h.skipType($t&7);break}}return st},et.decodeDelimited=function(h){return h instanceof o||(h=new o(h)),this.decode(h,h.uint32())},et.verify=function(h){if(typeof h!="object"||h===null)return"object expected";if(h.node!=null&&h.hasOwnProperty("node")){if(!Array.isArray(h.node))return"node: array expected";for(var b=0;b<h.node.length;++b){var g=d.onnx.NodeProto.verify(h.node[b]);if(g)return"node."+g}}if(h.name!=null&&h.hasOwnProperty("name")&&!s.isString(h.name))return"name: string expected";if(h.initializer!=null&&h.hasOwnProperty("initializer")){if(!Array.isArray(h.initializer))return"initializer: array expected";for(var b=0;b<h.initializer.length;++b){var g=d.onnx.TensorProto.verify(h.initializer[b]);if(g)return"initializer."+g}}if(h.sparseInitializer!=null&&h.hasOwnProperty("sparseInitializer")){if(!Array.isArray(h.sparseInitializer))return"sparseInitializer: array expected";for(var b=0;b<h.sparseInitializer.length;++b){var g=d.onnx.SparseTensorProto.verify(h.sparseInitializer[b]);if(g)return"sparseInitializer."+g}}if(h.docString!=null&&h.hasOwnProperty("docString")&&!s.isString(h.docString))return"docString: string expected";if(h.input!=null&&h.hasOwnProperty("input")){if(!Array.isArray(h.input))return"input: array expected";for(var b=0;b<h.input.length;++b){var g=d.onnx.ValueInfoProto.verify(h.input[b]);if(g)return"input."+g}}if(h.output!=null&&h.hasOwnProperty("output")){if(!Array.isArray(h.output))return"output: array expected";for(var b=0;b<h.output.length;++b){var g=d.onnx.ValueInfoProto.verify(h.output[b]);if(g)return"output."+g}}if(h.valueInfo!=null&&h.hasOwnProperty("valueInfo")){if(!Array.isArray(h.valueInfo))return"valueInfo: array expected";for(var b=0;b<h.valueInfo.length;++b){var g=d.onnx.ValueInfoProto.verify(h.valueInfo[b]);if(g)return"valueInfo."+g}}if(h.quantizationAnnotation!=null&&h.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(h.quantizationAnnotation))return"quantizationAnnotation: array expected";for(var b=0;b<h.quantizationAnnotation.length;++b){var g=d.onnx.TensorAnnotation.verify(h.quantizationAnnotation[b]);if(g)return"quantizationAnnotation."+g}}return null},et.fromObject=function(h){if(h instanceof d.onnx.GraphProto)return h;var b=new d.onnx.GraphProto;if(h.node){if(!Array.isArray(h.node))throw TypeError(".onnx.GraphProto.node: array expected");b.node=[];for(var g=0;g<h.node.length;++g){if(typeof h.node[g]!="object")throw TypeError(".onnx.GraphProto.node: object expected");b.node[g]=d.onnx.NodeProto.fromObject(h.node[g])}}if(h.name!=null&&(b.name=String(h.name)),h.initializer){if(!Array.isArray(h.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");b.initializer=[];for(var g=0;g<h.initializer.length;++g){if(typeof h.initializer[g]!="object")throw TypeError(".onnx.GraphProto.initializer: object expected");b.initializer[g]=d.onnx.TensorProto.fromObject(h.initializer[g])}}if(h.sparseInitializer){if(!Array.isArray(h.sparseInitializer))throw TypeError(".onnx.GraphProto.sparseInitializer: array expected");b.sparseInitializer=[];for(var g=0;g<h.sparseInitializer.length;++g){if(typeof h.sparseInitializer[g]!="object")throw TypeError(".onnx.GraphProto.sparseInitializer: object expected");b.sparseInitializer[g]=d.onnx.SparseTensorProto.fromObject(h.sparseInitializer[g])}}if(h.docString!=null&&(b.docString=String(h.docString)),h.input){if(!Array.isArray(h.input))throw TypeError(".onnx.GraphProto.input: array expected");b.input=[];for(var g=0;g<h.input.length;++g){if(typeof h.input[g]!="object")throw TypeError(".onnx.GraphProto.input: object expected");b.input[g]=d.onnx.ValueInfoProto.fromObject(h.input[g])}}if(h.output){if(!Array.isArray(h.output))throw TypeError(".onnx.GraphProto.output: array expected");b.output=[];for(var g=0;g<h.output.length;++g){if(typeof h.output[g]!="object")throw TypeError(".onnx.GraphProto.output: object expected");b.output[g]=d.onnx.ValueInfoProto.fromObject(h.output[g])}}if(h.valueInfo){if(!Array.isArray(h.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");b.valueInfo=[];for(var g=0;g<h.valueInfo.length;++g){if(typeof h.valueInfo[g]!="object")throw TypeError(".onnx.GraphProto.valueInfo: object expected");b.valueInfo[g]=d.onnx.ValueInfoProto.fromObject(h.valueInfo[g])}}if(h.quantizationAnnotation){if(!Array.isArray(h.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");b.quantizationAnnotation=[];for(var g=0;g<h.quantizationAnnotation.length;++g){if(typeof h.quantizationAnnotation[g]!="object")throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");b.quantizationAnnotation[g]=d.onnx.TensorAnnotation.fromObject(h.quantizationAnnotation[g])}}return b},et.toObject=function(h,b){b||(b={});var g={};if((b.arrays||b.defaults)&&(g.node=[],g.initializer=[],g.input=[],g.output=[],g.valueInfo=[],g.quantizationAnnotation=[],g.sparseInitializer=[]),b.defaults&&(g.name="",g.docString=""),h.node&&h.node.length){g.node=[];for(var st=0;st<h.node.length;++st)g.node[st]=d.onnx.NodeProto.toObject(h.node[st],b)}if(h.name!=null&&h.hasOwnProperty("name")&&(g.name=h.name),h.initializer&&h.initializer.length){g.initializer=[];for(var st=0;st<h.initializer.length;++st)g.initializer[st]=d.onnx.TensorProto.toObject(h.initializer[st],b)}if(h.docString!=null&&h.hasOwnProperty("docString")&&(g.docString=h.docString),h.input&&h.input.length){g.input=[];for(var st=0;st<h.input.length;++st)g.input[st]=d.onnx.ValueInfoProto.toObject(h.input[st],b)}if(h.output&&h.output.length){g.output=[];for(var st=0;st<h.output.length;++st)g.output[st]=d.onnx.ValueInfoProto.toObject(h.output[st],b)}if(h.valueInfo&&h.valueInfo.length){g.valueInfo=[];for(var st=0;st<h.valueInfo.length;++st)g.valueInfo[st]=d.onnx.ValueInfoProto.toObject(h.valueInfo[st],b)}if(h.quantizationAnnotation&&h.quantizationAnnotation.length){g.quantizationAnnotation=[];for(var st=0;st<h.quantizationAnnotation.length;++st)g.quantizationAnnotation[st]=d.onnx.TensorAnnotation.toObject(h.quantizationAnnotation[st],b)}if(h.sparseInitializer&&h.sparseInitializer.length){g.sparseInitializer=[];for(var st=0;st<h.sparseInitializer.length;++st)g.sparseInitializer[st]=d.onnx.SparseTensorProto.toObject(h.sparseInitializer[st],b)}return g},et.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},et.getTypeUrl=function(h){return h===void 0&&(h="type.googleapis.com"),h+"/onnx.GraphProto"},et}(),$.TensorProto=function(){function et(h){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],h)for(var b=Object.keys(h),g=0;g<b.length;++g)h[b[g]]!=null&&(this[b[g]]=h[b[g]])}return et.prototype.dims=s.emptyArray,et.prototype.dataType=0,et.prototype.segment=null,et.prototype.floatData=s.emptyArray,et.prototype.int32Data=s.emptyArray,et.prototype.stringData=s.emptyArray,et.prototype.int64Data=s.emptyArray,et.prototype.name="",et.prototype.docString="",et.prototype.rawData=s.newBuffer([]),et.prototype.externalData=s.emptyArray,et.prototype.dataLocation=0,et.prototype.doubleData=s.emptyArray,et.prototype.uint64Data=s.emptyArray,et.create=function(h){return new et(h)},et.encode=function(h,b){if(b||(b=c.create()),h.dims!=null&&h.dims.length){b.uint32(10).fork();for(var g=0;g<h.dims.length;++g)b.int64(h.dims[g]);b.ldelim()}if(h.dataType!=null&&Object.hasOwnProperty.call(h,"dataType")&&b.uint32(16).int32(h.dataType),h.segment!=null&&Object.hasOwnProperty.call(h,"segment")&&d.onnx.TensorProto.Segment.encode(h.segment,b.uint32(26).fork()).ldelim(),h.floatData!=null&&h.floatData.length){b.uint32(34).fork();for(var g=0;g<h.floatData.length;++g)b.float(h.floatData[g]);b.ldelim()}if(h.int32Data!=null&&h.int32Data.length){b.uint32(42).fork();for(var g=0;g<h.int32Data.length;++g)b.int32(h.int32Data[g]);b.ldelim()}if(h.stringData!=null&&h.stringData.length)for(var g=0;g<h.stringData.length;++g)b.uint32(50).bytes(h.stringData[g]);if(h.int64Data!=null&&h.int64Data.length){b.uint32(58).fork();for(var g=0;g<h.int64Data.length;++g)b.int64(h.int64Data[g]);b.ldelim()}if(h.name!=null&&Object.hasOwnProperty.call(h,"name")&&b.uint32(66).string(h.name),h.rawData!=null&&Object.hasOwnProperty.call(h,"rawData")&&b.uint32(74).bytes(h.rawData),h.doubleData!=null&&h.doubleData.length){b.uint32(82).fork();for(var g=0;g<h.doubleData.length;++g)b.double(h.doubleData[g]);b.ldelim()}if(h.uint64Data!=null&&h.uint64Data.length){b.uint32(90).fork();for(var g=0;g<h.uint64Data.length;++g)b.uint64(h.uint64Data[g]);b.ldelim()}if(h.docString!=null&&Object.hasOwnProperty.call(h,"docString")&&b.uint32(98).string(h.docString),h.externalData!=null&&h.externalData.length)for(var g=0;g<h.externalData.length;++g)d.onnx.StringStringEntryProto.encode(h.externalData[g],b.uint32(106).fork()).ldelim();return h.dataLocation!=null&&Object.hasOwnProperty.call(h,"dataLocation")&&b.uint32(112).int32(h.dataLocation),b},et.encodeDelimited=function(h,b){return this.encode(h,b).ldelim()},et.decode=function(h,b){h instanceof o||(h=o.create(h));for(var g=b===void 0?h.len:h.pos+b,st=new d.onnx.TensorProto;h.pos<g;){var $t=h.uint32();switch($t>>>3){case 1:{if(st.dims&&st.dims.length||(st.dims=[]),($t&7)===2)for(var vt=h.uint32()+h.pos;h.pos<vt;)st.dims.push(h.int64());else st.dims.push(h.int64());break}case 2:{st.dataType=h.int32();break}case 3:{st.segment=d.onnx.TensorProto.Segment.decode(h,h.uint32());break}case 4:{if(st.floatData&&st.floatData.length||(st.floatData=[]),($t&7)===2)for(var vt=h.uint32()+h.pos;h.pos<vt;)st.floatData.push(h.float());else st.floatData.push(h.float());break}case 5:{if(st.int32Data&&st.int32Data.length||(st.int32Data=[]),($t&7)===2)for(var vt=h.uint32()+h.pos;h.pos<vt;)st.int32Data.push(h.int32());else st.int32Data.push(h.int32());break}case 6:{st.stringData&&st.stringData.length||(st.stringData=[]),st.stringData.push(h.bytes());break}case 7:{if(st.int64Data&&st.int64Data.length||(st.int64Data=[]),($t&7)===2)for(var vt=h.uint32()+h.pos;h.pos<vt;)st.int64Data.push(h.int64());else st.int64Data.push(h.int64());break}case 8:{st.name=h.string();break}case 12:{st.docString=h.string();break}case 9:{st.rawData=h.bytes();break}case 13:{st.externalData&&st.externalData.length||(st.externalData=[]),st.externalData.push(d.onnx.StringStringEntryProto.decode(h,h.uint32()));break}case 14:{st.dataLocation=h.int32();break}case 10:{if(st.doubleData&&st.doubleData.length||(st.doubleData=[]),($t&7)===2)for(var vt=h.uint32()+h.pos;h.pos<vt;)st.doubleData.push(h.double());else st.doubleData.push(h.double());break}case 11:{if(st.uint64Data&&st.uint64Data.length||(st.uint64Data=[]),($t&7)===2)for(var vt=h.uint32()+h.pos;h.pos<vt;)st.uint64Data.push(h.uint64());else st.uint64Data.push(h.uint64());break}default:h.skipType($t&7);break}}return st},et.decodeDelimited=function(h){return h instanceof o||(h=new o(h)),this.decode(h,h.uint32())},et.verify=function(h){if(typeof h!="object"||h===null)return"object expected";if(h.dims!=null&&h.hasOwnProperty("dims")){if(!Array.isArray(h.dims))return"dims: array expected";for(var b=0;b<h.dims.length;++b)if(!s.isInteger(h.dims[b])&&!(h.dims[b]&&s.isInteger(h.dims[b].low)&&s.isInteger(h.dims[b].high)))return"dims: integer|Long[] expected"}if(h.dataType!=null&&h.hasOwnProperty("dataType")&&!s.isInteger(h.dataType))return"dataType: integer expected";if(h.segment!=null&&h.hasOwnProperty("segment")){var g=d.onnx.TensorProto.Segment.verify(h.segment);if(g)return"segment."+g}if(h.floatData!=null&&h.hasOwnProperty("floatData")){if(!Array.isArray(h.floatData))return"floatData: array expected";for(var b=0;b<h.floatData.length;++b)if(typeof h.floatData[b]!="number")return"floatData: number[] expected"}if(h.int32Data!=null&&h.hasOwnProperty("int32Data")){if(!Array.isArray(h.int32Data))return"int32Data: array expected";for(var b=0;b<h.int32Data.length;++b)if(!s.isInteger(h.int32Data[b]))return"int32Data: integer[] expected"}if(h.stringData!=null&&h.hasOwnProperty("stringData")){if(!Array.isArray(h.stringData))return"stringData: array expected";for(var b=0;b<h.stringData.length;++b)if(!(h.stringData[b]&&typeof h.stringData[b].length=="number"||s.isString(h.stringData[b])))return"stringData: buffer[] expected"}if(h.int64Data!=null&&h.hasOwnProperty("int64Data")){if(!Array.isArray(h.int64Data))return"int64Data: array expected";for(var b=0;b<h.int64Data.length;++b)if(!s.isInteger(h.int64Data[b])&&!(h.int64Data[b]&&s.isInteger(h.int64Data[b].low)&&s.isInteger(h.int64Data[b].high)))return"int64Data: integer|Long[] expected"}if(h.name!=null&&h.hasOwnProperty("name")&&!s.isString(h.name))return"name: string expected";if(h.docString!=null&&h.hasOwnProperty("docString")&&!s.isString(h.docString))return"docString: string expected";if(h.rawData!=null&&h.hasOwnProperty("rawData")&&!(h.rawData&&typeof h.rawData.length=="number"||s.isString(h.rawData)))return"rawData: buffer expected";if(h.externalData!=null&&h.hasOwnProperty("externalData")){if(!Array.isArray(h.externalData))return"externalData: array expected";for(var b=0;b<h.externalData.length;++b){var g=d.onnx.StringStringEntryProto.verify(h.externalData[b]);if(g)return"externalData."+g}}if(h.dataLocation!=null&&h.hasOwnProperty("dataLocation"))switch(h.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:break}if(h.doubleData!=null&&h.hasOwnProperty("doubleData")){if(!Array.isArray(h.doubleData))return"doubleData: array expected";for(var b=0;b<h.doubleData.length;++b)if(typeof h.doubleData[b]!="number")return"doubleData: number[] expected"}if(h.uint64Data!=null&&h.hasOwnProperty("uint64Data")){if(!Array.isArray(h.uint64Data))return"uint64Data: array expected";for(var b=0;b<h.uint64Data.length;++b)if(!s.isInteger(h.uint64Data[b])&&!(h.uint64Data[b]&&s.isInteger(h.uint64Data[b].low)&&s.isInteger(h.uint64Data[b].high)))return"uint64Data: integer|Long[] expected"}return null},et.fromObject=function(h){if(h instanceof d.onnx.TensorProto)return h;var b=new d.onnx.TensorProto;if(h.dims){if(!Array.isArray(h.dims))throw TypeError(".onnx.TensorProto.dims: array expected");b.dims=[];for(var g=0;g<h.dims.length;++g)s.Long?(b.dims[g]=s.Long.fromValue(h.dims[g])).unsigned=!1:typeof h.dims[g]=="string"?b.dims[g]=parseInt(h.dims[g],10):typeof h.dims[g]=="number"?b.dims[g]=h.dims[g]:typeof h.dims[g]=="object"&&(b.dims[g]=new s.LongBits(h.dims[g].low>>>0,h.dims[g].high>>>0).toNumber())}if(h.dataType!=null&&(b.dataType=h.dataType|0),h.segment!=null){if(typeof h.segment!="object")throw TypeError(".onnx.TensorProto.segment: object expected");b.segment=d.onnx.TensorProto.Segment.fromObject(h.segment)}if(h.floatData){if(!Array.isArray(h.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");b.floatData=[];for(var g=0;g<h.floatData.length;++g)b.floatData[g]=Number(h.floatData[g])}if(h.int32Data){if(!Array.isArray(h.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");b.int32Data=[];for(var g=0;g<h.int32Data.length;++g)b.int32Data[g]=h.int32Data[g]|0}if(h.stringData){if(!Array.isArray(h.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");b.stringData=[];for(var g=0;g<h.stringData.length;++g)typeof h.stringData[g]=="string"?s.base64.decode(h.stringData[g],b.stringData[g]=s.newBuffer(s.base64.length(h.stringData[g])),0):h.stringData[g].length>=0&&(b.stringData[g]=h.stringData[g])}if(h.int64Data){if(!Array.isArray(h.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");b.int64Data=[];for(var g=0;g<h.int64Data.length;++g)s.Long?(b.int64Data[g]=s.Long.fromValue(h.int64Data[g])).unsigned=!1:typeof h.int64Data[g]=="string"?b.int64Data[g]=parseInt(h.int64Data[g],10):typeof h.int64Data[g]=="number"?b.int64Data[g]=h.int64Data[g]:typeof h.int64Data[g]=="object"&&(b.int64Data[g]=new s.LongBits(h.int64Data[g].low>>>0,h.int64Data[g].high>>>0).toNumber())}if(h.name!=null&&(b.name=String(h.name)),h.docString!=null&&(b.docString=String(h.docString)),h.rawData!=null&&(typeof h.rawData=="string"?s.base64.decode(h.rawData,b.rawData=s.newBuffer(s.base64.length(h.rawData)),0):h.rawData.length>=0&&(b.rawData=h.rawData)),h.externalData){if(!Array.isArray(h.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");b.externalData=[];for(var g=0;g<h.externalData.length;++g){if(typeof h.externalData[g]!="object")throw TypeError(".onnx.TensorProto.externalData: object expected");b.externalData[g]=d.onnx.StringStringEntryProto.fromObject(h.externalData[g])}}switch(h.dataLocation){default:if(typeof h.dataLocation=="number"){b.dataLocation=h.dataLocation;break}break;case"DEFAULT":case 0:b.dataLocation=0;break;case"EXTERNAL":case 1:b.dataLocation=1;break}if(h.doubleData){if(!Array.isArray(h.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");b.doubleData=[];for(var g=0;g<h.doubleData.length;++g)b.doubleData[g]=Number(h.doubleData[g])}if(h.uint64Data){if(!Array.isArray(h.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");b.uint64Data=[];for(var g=0;g<h.uint64Data.length;++g)s.Long?(b.uint64Data[g]=s.Long.fromValue(h.uint64Data[g])).unsigned=!0:typeof h.uint64Data[g]=="string"?b.uint64Data[g]=parseInt(h.uint64Data[g],10):typeof h.uint64Data[g]=="number"?b.uint64Data[g]=h.uint64Data[g]:typeof h.uint64Data[g]=="object"&&(b.uint64Data[g]=new s.LongBits(h.uint64Data[g].low>>>0,h.uint64Data[g].high>>>0).toNumber(!0))}return b},et.toObject=function(h,b){b||(b={});var g={};if((b.arrays||b.defaults)&&(g.dims=[],g.floatData=[],g.int32Data=[],g.stringData=[],g.int64Data=[],g.doubleData=[],g.uint64Data=[],g.externalData=[]),b.defaults&&(g.dataType=0,g.segment=null,g.name="",b.bytes===String?g.rawData="":(g.rawData=[],b.bytes!==Array&&(g.rawData=s.newBuffer(g.rawData))),g.docString="",g.dataLocation=b.enums===String?"DEFAULT":0),h.dims&&h.dims.length){g.dims=[];for(var st=0;st<h.dims.length;++st)typeof h.dims[st]=="number"?g.dims[st]=b.longs===String?String(h.dims[st]):h.dims[st]:g.dims[st]=b.longs===String?s.Long.prototype.toString.call(h.dims[st]):b.longs===Number?new s.LongBits(h.dims[st].low>>>0,h.dims[st].high>>>0).toNumber():h.dims[st]}if(h.dataType!=null&&h.hasOwnProperty("dataType")&&(g.dataType=h.dataType),h.segment!=null&&h.hasOwnProperty("segment")&&(g.segment=d.onnx.TensorProto.Segment.toObject(h.segment,b)),h.floatData&&h.floatData.length){g.floatData=[];for(var st=0;st<h.floatData.length;++st)g.floatData[st]=b.json&&!isFinite(h.floatData[st])?String(h.floatData[st]):h.floatData[st]}if(h.int32Data&&h.int32Data.length){g.int32Data=[];for(var st=0;st<h.int32Data.length;++st)g.int32Data[st]=h.int32Data[st]}if(h.stringData&&h.stringData.length){g.stringData=[];for(var st=0;st<h.stringData.length;++st)g.stringData[st]=b.bytes===String?s.base64.encode(h.stringData[st],0,h.stringData[st].length):b.bytes===Array?Array.prototype.slice.call(h.stringData[st]):h.stringData[st]}if(h.int64Data&&h.int64Data.length){g.int64Data=[];for(var st=0;st<h.int64Data.length;++st)typeof h.int64Data[st]=="number"?g.int64Data[st]=b.longs===String?String(h.int64Data[st]):h.int64Data[st]:g.int64Data[st]=b.longs===String?s.Long.prototype.toString.call(h.int64Data[st]):b.longs===Number?new s.LongBits(h.int64Data[st].low>>>0,h.int64Data[st].high>>>0).toNumber():h.int64Data[st]}if(h.name!=null&&h.hasOwnProperty("name")&&(g.name=h.name),h.rawData!=null&&h.hasOwnProperty("rawData")&&(g.rawData=b.bytes===String?s.base64.encode(h.rawData,0,h.rawData.length):b.bytes===Array?Array.prototype.slice.call(h.rawData):h.rawData),h.doubleData&&h.doubleData.length){g.doubleData=[];for(var st=0;st<h.doubleData.length;++st)g.doubleData[st]=b.json&&!isFinite(h.doubleData[st])?String(h.doubleData[st]):h.doubleData[st]}if(h.uint64Data&&h.uint64Data.length){g.uint64Data=[];for(var st=0;st<h.uint64Data.length;++st)typeof h.uint64Data[st]=="number"?g.uint64Data[st]=b.longs===String?String(h.uint64Data[st]):h.uint64Data[st]:g.uint64Data[st]=b.longs===String?s.Long.prototype.toString.call(h.uint64Data[st]):b.longs===Number?new s.LongBits(h.uint64Data[st].low>>>0,h.uint64Data[st].high>>>0).toNumber(!0):h.uint64Data[st]}if(h.docString!=null&&h.hasOwnProperty("docString")&&(g.docString=h.docString),h.externalData&&h.externalData.length){g.externalData=[];for(var st=0;st<h.externalData.length;++st)g.externalData[st]=d.onnx.StringStringEntryProto.toObject(h.externalData[st],b)}return h.dataLocation!=null&&h.hasOwnProperty("dataLocation")&&(g.dataLocation=b.enums===String?d.onnx.TensorProto.DataLocation[h.dataLocation]===void 0?h.dataLocation:d.onnx.TensorProto.DataLocation[h.dataLocation]:h.dataLocation),g},et.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},et.getTypeUrl=function(h){return h===void 0&&(h="type.googleapis.com"),h+"/onnx.TensorProto"},et.DataType=function(){var h={},b=Object.create(h);return b[h[0]="UNDEFINED"]=0,b[h[1]="FLOAT"]=1,b[h[2]="UINT8"]=2,b[h[3]="INT8"]=3,b[h[4]="UINT16"]=4,b[h[5]="INT16"]=5,b[h[6]="INT32"]=6,b[h[7]="INT64"]=7,b[h[8]="STRING"]=8,b[h[9]="BOOL"]=9,b[h[10]="FLOAT16"]=10,b[h[11]="DOUBLE"]=11,b[h[12]="UINT32"]=12,b[h[13]="UINT64"]=13,b[h[14]="COMPLEX64"]=14,b[h[15]="COMPLEX128"]=15,b[h[16]="BFLOAT16"]=16,b[h[17]="FLOAT8E4M3FN"]=17,b[h[18]="FLOAT8E4M3FNUZ"]=18,b[h[19]="FLOAT8E5M2"]=19,b[h[20]="FLOAT8E5M2FNUZ"]=20,b}(),et.Segment=function(){function h(b){if(b)for(var g=Object.keys(b),st=0;st<g.length;++st)b[g[st]]!=null&&(this[g[st]]=b[g[st]])}return h.prototype.begin=s.Long?s.Long.fromBits(0,0,!1):0,h.prototype.end=s.Long?s.Long.fromBits(0,0,!1):0,h.create=function(b){return new h(b)},h.encode=function(b,g){return g||(g=c.create()),b.begin!=null&&Object.hasOwnProperty.call(b,"begin")&&g.uint32(8).int64(b.begin),b.end!=null&&Object.hasOwnProperty.call(b,"end")&&g.uint32(16).int64(b.end),g},h.encodeDelimited=function(b,g){return this.encode(b,g).ldelim()},h.decode=function(b,g){b instanceof o||(b=o.create(b));for(var st=g===void 0?b.len:b.pos+g,$t=new d.onnx.TensorProto.Segment;b.pos<st;){var vt=b.uint32();switch(vt>>>3){case 1:{$t.begin=b.int64();break}case 2:{$t.end=b.int64();break}default:b.skipType(vt&7);break}}return $t},h.decodeDelimited=function(b){return b instanceof o||(b=new o(b)),this.decode(b,b.uint32())},h.verify=function(b){return typeof b!="object"||b===null?"object expected":b.begin!=null&&b.hasOwnProperty("begin")&&!s.isInteger(b.begin)&&!(b.begin&&s.isInteger(b.begin.low)&&s.isInteger(b.begin.high))?"begin: integer|Long expected":b.end!=null&&b.hasOwnProperty("end")&&!s.isInteger(b.end)&&!(b.end&&s.isInteger(b.end.low)&&s.isInteger(b.end.high))?"end: integer|Long expected":null},h.fromObject=function(b){if(b instanceof d.onnx.TensorProto.Segment)return b;var g=new d.onnx.TensorProto.Segment;return b.begin!=null&&(s.Long?(g.begin=s.Long.fromValue(b.begin)).unsigned=!1:typeof b.begin=="string"?g.begin=parseInt(b.begin,10):typeof b.begin=="number"?g.begin=b.begin:typeof b.begin=="object"&&(g.begin=new s.LongBits(b.begin.low>>>0,b.begin.high>>>0).toNumber())),b.end!=null&&(s.Long?(g.end=s.Long.fromValue(b.end)).unsigned=!1:typeof b.end=="string"?g.end=parseInt(b.end,10):typeof b.end=="number"?g.end=b.end:typeof b.end=="object"&&(g.end=new s.LongBits(b.end.low>>>0,b.end.high>>>0).toNumber())),g},h.toObject=function(b,g){g||(g={});var st={};if(g.defaults){if(s.Long){var $t=new s.Long(0,0,!1);st.begin=g.longs===String?$t.toString():g.longs===Number?$t.toNumber():$t}else st.begin=g.longs===String?"0":0;if(s.Long){var $t=new s.Long(0,0,!1);st.end=g.longs===String?$t.toString():g.longs===Number?$t.toNumber():$t}else st.end=g.longs===String?"0":0}return b.begin!=null&&b.hasOwnProperty("begin")&&(typeof b.begin=="number"?st.begin=g.longs===String?String(b.begin):b.begin:st.begin=g.longs===String?s.Long.prototype.toString.call(b.begin):g.longs===Number?new s.LongBits(b.begin.low>>>0,b.begin.high>>>0).toNumber():b.begin),b.end!=null&&b.hasOwnProperty("end")&&(typeof b.end=="number"?st.end=g.longs===String?String(b.end):b.end:st.end=g.longs===String?s.Long.prototype.toString.call(b.end):g.longs===Number?new s.LongBits(b.end.low>>>0,b.end.high>>>0).toNumber():b.end),st},h.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},h.getTypeUrl=function(b){return b===void 0&&(b="type.googleapis.com"),b+"/onnx.TensorProto.Segment"},h}(),et.DataLocation=function(){var h={},b=Object.create(h);return b[h[0]="DEFAULT"]=0,b[h[1]="EXTERNAL"]=1,b}(),et}(),$.SparseTensorProto=function(){function et(h){if(this.dims=[],h)for(var b=Object.keys(h),g=0;g<b.length;++g)h[b[g]]!=null&&(this[b[g]]=h[b[g]])}return et.prototype.values=null,et.prototype.indices=null,et.prototype.dims=s.emptyArray,et.create=function(h){return new et(h)},et.encode=function(h,b){if(b||(b=c.create()),h.values!=null&&Object.hasOwnProperty.call(h,"values")&&d.onnx.TensorProto.encode(h.values,b.uint32(10).fork()).ldelim(),h.indices!=null&&Object.hasOwnProperty.call(h,"indices")&&d.onnx.TensorProto.encode(h.indices,b.uint32(18).fork()).ldelim(),h.dims!=null&&h.dims.length){b.uint32(26).fork();for(var g=0;g<h.dims.length;++g)b.int64(h.dims[g]);b.ldelim()}return b},et.encodeDelimited=function(h,b){return this.encode(h,b).ldelim()},et.decode=function(h,b){h instanceof o||(h=o.create(h));for(var g=b===void 0?h.len:h.pos+b,st=new d.onnx.SparseTensorProto;h.pos<g;){var $t=h.uint32();switch($t>>>3){case 1:{st.values=d.onnx.TensorProto.decode(h,h.uint32());break}case 2:{st.indices=d.onnx.TensorProto.decode(h,h.uint32());break}case 3:{if(st.dims&&st.dims.length||(st.dims=[]),($t&7)===2)for(var vt=h.uint32()+h.pos;h.pos<vt;)st.dims.push(h.int64());else st.dims.push(h.int64());break}default:h.skipType($t&7);break}}return st},et.decodeDelimited=function(h){return h instanceof o||(h=new o(h)),this.decode(h,h.uint32())},et.verify=function(h){if(typeof h!="object"||h===null)return"object expected";if(h.values!=null&&h.hasOwnProperty("values")){var b=d.onnx.TensorProto.verify(h.values);if(b)return"values."+b}if(h.indices!=null&&h.hasOwnProperty("indices")){var b=d.onnx.TensorProto.verify(h.indices);if(b)return"indices."+b}if(h.dims!=null&&h.hasOwnProperty("dims")){if(!Array.isArray(h.dims))return"dims: array expected";for(var g=0;g<h.dims.length;++g)if(!s.isInteger(h.dims[g])&&!(h.dims[g]&&s.isInteger(h.dims[g].low)&&s.isInteger(h.dims[g].high)))return"dims: integer|Long[] expected"}return null},et.fromObject=function(h){if(h instanceof d.onnx.SparseTensorProto)return h;var b=new d.onnx.SparseTensorProto;if(h.values!=null){if(typeof h.values!="object")throw TypeError(".onnx.SparseTensorProto.values: object expected");b.values=d.onnx.TensorProto.fromObject(h.values)}if(h.indices!=null){if(typeof h.indices!="object")throw TypeError(".onnx.SparseTensorProto.indices: object expected");b.indices=d.onnx.TensorProto.fromObject(h.indices)}if(h.dims){if(!Array.isArray(h.dims))throw TypeError(".onnx.SparseTensorProto.dims: array expected");b.dims=[];for(var g=0;g<h.dims.length;++g)s.Long?(b.dims[g]=s.Long.fromValue(h.dims[g])).unsigned=!1:typeof h.dims[g]=="string"?b.dims[g]=parseInt(h.dims[g],10):typeof h.dims[g]=="number"?b.dims[g]=h.dims[g]:typeof h.dims[g]=="object"&&(b.dims[g]=new s.LongBits(h.dims[g].low>>>0,h.dims[g].high>>>0).toNumber())}return b},et.toObject=function(h,b){b||(b={});var g={};if((b.arrays||b.defaults)&&(g.dims=[]),b.defaults&&(g.values=null,g.indices=null),h.values!=null&&h.hasOwnProperty("values")&&(g.values=d.onnx.TensorProto.toObject(h.values,b)),h.indices!=null&&h.hasOwnProperty("indices")&&(g.indices=d.onnx.TensorProto.toObject(h.indices,b)),h.dims&&h.dims.length){g.dims=[];for(var st=0;st<h.dims.length;++st)typeof h.dims[st]=="number"?g.dims[st]=b.longs===String?String(h.dims[st]):h.dims[st]:g.dims[st]=b.longs===String?s.Long.prototype.toString.call(h.dims[st]):b.longs===Number?new s.LongBits(h.dims[st].low>>>0,h.dims[st].high>>>0).toNumber():h.dims[st]}return g},et.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},et.getTypeUrl=function(h){return h===void 0&&(h="type.googleapis.com"),h+"/onnx.SparseTensorProto"},et}(),$.TensorShapeProto=function(){function et(h){if(this.dim=[],h)for(var b=Object.keys(h),g=0;g<b.length;++g)h[b[g]]!=null&&(this[b[g]]=h[b[g]])}return et.prototype.dim=s.emptyArray,et.create=function(h){return new et(h)},et.encode=function(h,b){if(b||(b=c.create()),h.dim!=null&&h.dim.length)for(var g=0;g<h.dim.length;++g)d.onnx.TensorShapeProto.Dimension.encode(h.dim[g],b.uint32(10).fork()).ldelim();return b},et.encodeDelimited=function(h,b){return this.encode(h,b).ldelim()},et.decode=function(h,b){h instanceof o||(h=o.create(h));for(var g=b===void 0?h.len:h.pos+b,st=new d.onnx.TensorShapeProto;h.pos<g;){var $t=h.uint32();switch($t>>>3){case 1:{st.dim&&st.dim.length||(st.dim=[]),st.dim.push(d.onnx.TensorShapeProto.Dimension.decode(h,h.uint32()));break}default:h.skipType($t&7);break}}return st},et.decodeDelimited=function(h){return h instanceof o||(h=new o(h)),this.decode(h,h.uint32())},et.verify=function(h){if(typeof h!="object"||h===null)return"object expected";if(h.dim!=null&&h.hasOwnProperty("dim")){if(!Array.isArray(h.dim))return"dim: array expected";for(var b=0;b<h.dim.length;++b){var g=d.onnx.TensorShapeProto.Dimension.verify(h.dim[b]);if(g)return"dim."+g}}return null},et.fromObject=function(h){if(h instanceof d.onnx.TensorShapeProto)return h;var b=new d.onnx.TensorShapeProto;if(h.dim){if(!Array.isArray(h.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");b.dim=[];for(var g=0;g<h.dim.length;++g){if(typeof h.dim[g]!="object")throw TypeError(".onnx.TensorShapeProto.dim: object expected");b.dim[g]=d.onnx.TensorShapeProto.Dimension.fromObject(h.dim[g])}}return b},et.toObject=function(h,b){b||(b={});var g={};if((b.arrays||b.defaults)&&(g.dim=[]),h.dim&&h.dim.length){g.dim=[];for(var st=0;st<h.dim.length;++st)g.dim[st]=d.onnx.TensorShapeProto.Dimension.toObject(h.dim[st],b)}return g},et.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},et.getTypeUrl=function(h){return h===void 0&&(h="type.googleapis.com"),h+"/onnx.TensorShapeProto"},et.Dimension=function(){function h(g){if(g)for(var st=Object.keys(g),$t=0;$t<st.length;++$t)g[st[$t]]!=null&&(this[st[$t]]=g[st[$t]])}h.prototype.dimValue=null,h.prototype.dimParam=null,h.prototype.denotation="";var b;return Object.defineProperty(h.prototype,"value",{get:s.oneOfGetter(b=["dimValue","dimParam"]),set:s.oneOfSetter(b)}),h.create=function(g){return new h(g)},h.encode=function(g,st){return st||(st=c.create()),g.dimValue!=null&&Object.hasOwnProperty.call(g,"dimValue")&&st.uint32(8).int64(g.dimValue),g.dimParam!=null&&Object.hasOwnProperty.call(g,"dimParam")&&st.uint32(18).string(g.dimParam),g.denotation!=null&&Object.hasOwnProperty.call(g,"denotation")&&st.uint32(26).string(g.denotation),st},h.encodeDelimited=function(g,st){return this.encode(g,st).ldelim()},h.decode=function(g,st){g instanceof o||(g=o.create(g));for(var $t=st===void 0?g.len:g.pos+st,vt=new d.onnx.TensorShapeProto.Dimension;g.pos<$t;){var Ft=g.uint32();switch(Ft>>>3){case 1:{vt.dimValue=g.int64();break}case 2:{vt.dimParam=g.string();break}case 3:{vt.denotation=g.string();break}default:g.skipType(Ft&7);break}}return vt},h.decodeDelimited=function(g){return g instanceof o||(g=new o(g)),this.decode(g,g.uint32())},h.verify=function(g){if(typeof g!="object"||g===null)return"object expected";var st={};if(g.dimValue!=null&&g.hasOwnProperty("dimValue")&&(st.value=1,!s.isInteger(g.dimValue)&&!(g.dimValue&&s.isInteger(g.dimValue.low)&&s.isInteger(g.dimValue.high))))return"dimValue: integer|Long expected";if(g.dimParam!=null&&g.hasOwnProperty("dimParam")){if(st.value===1)return"value: multiple values";if(st.value=1,!s.isString(g.dimParam))return"dimParam: string expected"}return g.denotation!=null&&g.hasOwnProperty("denotation")&&!s.isString(g.denotation)?"denotation: string expected":null},h.fromObject=function(g){if(g instanceof d.onnx.TensorShapeProto.Dimension)return g;var st=new d.onnx.TensorShapeProto.Dimension;return g.dimValue!=null&&(s.Long?(st.dimValue=s.Long.fromValue(g.dimValue)).unsigned=!1:typeof g.dimValue=="string"?st.dimValue=parseInt(g.dimValue,10):typeof g.dimValue=="number"?st.dimValue=g.dimValue:typeof g.dimValue=="object"&&(st.dimValue=new s.LongBits(g.dimValue.low>>>0,g.dimValue.high>>>0).toNumber())),g.dimParam!=null&&(st.dimParam=String(g.dimParam)),g.denotation!=null&&(st.denotation=String(g.denotation)),st},h.toObject=function(g,st){st||(st={});var $t={};return st.defaults&&($t.denotation=""),g.dimValue!=null&&g.hasOwnProperty("dimValue")&&(typeof g.dimValue=="number"?$t.dimValue=st.longs===String?String(g.dimValue):g.dimValue:$t.dimValue=st.longs===String?s.Long.prototype.toString.call(g.dimValue):st.longs===Number?new s.LongBits(g.dimValue.low>>>0,g.dimValue.high>>>0).toNumber():g.dimValue,st.oneofs&&($t.value="dimValue")),g.dimParam!=null&&g.hasOwnProperty("dimParam")&&($t.dimParam=g.dimParam,st.oneofs&&($t.value="dimParam")),g.denotation!=null&&g.hasOwnProperty("denotation")&&($t.denotation=g.denotation),$t},h.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},h.getTypeUrl=function(g){return g===void 0&&(g="type.googleapis.com"),g+"/onnx.TensorShapeProto.Dimension"},h}(),et}(),$.TypeProto=function(){function et(b){if(b)for(var g=Object.keys(b),st=0;st<g.length;++st)b[g[st]]!=null&&(this[g[st]]=b[g[st]])}et.prototype.tensorType=null,et.prototype.sequenceType=null,et.prototype.mapType=null,et.prototype.optionalType=null,et.prototype.sparseTensorType=null,et.prototype.denotation="";var h;return Object.defineProperty(et.prototype,"value",{get:s.oneOfGetter(h=["tensorType","sequenceType","mapType","optionalType","sparseTensorType"]),set:s.oneOfSetter(h)}),et.create=function(b){return new et(b)},et.encode=function(b,g){return g||(g=c.create()),b.tensorType!=null&&Object.hasOwnProperty.call(b,"tensorType")&&d.onnx.TypeProto.Tensor.encode(b.tensorType,g.uint32(10).fork()).ldelim(),b.sequenceType!=null&&Object.hasOwnProperty.call(b,"sequenceType")&&d.onnx.TypeProto.Sequence.encode(b.sequenceType,g.uint32(34).fork()).ldelim(),b.mapType!=null&&Object.hasOwnProperty.call(b,"mapType")&&d.onnx.TypeProto.Map.encode(b.mapType,g.uint32(42).fork()).ldelim(),b.denotation!=null&&Object.hasOwnProperty.call(b,"denotation")&&g.uint32(50).string(b.denotation),b.sparseTensorType!=null&&Object.hasOwnProperty.call(b,"sparseTensorType")&&d.onnx.TypeProto.SparseTensor.encode(b.sparseTensorType,g.uint32(66).fork()).ldelim(),b.optionalType!=null&&Object.hasOwnProperty.call(b,"optionalType")&&d.onnx.TypeProto.Optional.encode(b.optionalType,g.uint32(74).fork()).ldelim(),g},et.encodeDelimited=function(b,g){return this.encode(b,g).ldelim()},et.decode=function(b,g){b instanceof o||(b=o.create(b));for(var st=g===void 0?b.len:b.pos+g,$t=new d.onnx.TypeProto;b.pos<st;){var vt=b.uint32();switch(vt>>>3){case 1:{$t.tensorType=d.onnx.TypeProto.Tensor.decode(b,b.uint32());break}case 4:{$t.sequenceType=d.onnx.TypeProto.Sequence.decode(b,b.uint32());break}case 5:{$t.mapType=d.onnx.TypeProto.Map.decode(b,b.uint32());break}case 9:{$t.optionalType=d.onnx.TypeProto.Optional.decode(b,b.uint32());break}case 8:{$t.sparseTensorType=d.onnx.TypeProto.SparseTensor.decode(b,b.uint32());break}case 6:{$t.denotation=b.string();break}default:b.skipType(vt&7);break}}return $t},et.decodeDelimited=function(b){return b instanceof o||(b=new o(b)),this.decode(b,b.uint32())},et.verify=function(b){if(typeof b!="object"||b===null)return"object expected";var g={};if(b.tensorType!=null&&b.hasOwnProperty("tensorType")){g.value=1;{var st=d.onnx.TypeProto.Tensor.verify(b.tensorType);if(st)return"tensorType."+st}}if(b.sequenceType!=null&&b.hasOwnProperty("sequenceType")){if(g.value===1)return"value: multiple values";g.value=1;{var st=d.onnx.TypeProto.Sequence.verify(b.sequenceType);if(st)return"sequenceType."+st}}if(b.mapType!=null&&b.hasOwnProperty("mapType")){if(g.value===1)return"value: multiple values";g.value=1;{var st=d.onnx.TypeProto.Map.verify(b.mapType);if(st)return"mapType."+st}}if(b.optionalType!=null&&b.hasOwnProperty("optionalType")){if(g.value===1)return"value: multiple values";g.value=1;{var st=d.onnx.TypeProto.Optional.verify(b.optionalType);if(st)return"optionalType."+st}}if(b.sparseTensorType!=null&&b.hasOwnProperty("sparseTensorType")){if(g.value===1)return"value: multiple values";g.value=1;{var st=d.onnx.TypeProto.SparseTensor.verify(b.sparseTensorType);if(st)return"sparseTensorType."+st}}return b.denotation!=null&&b.hasOwnProperty("denotation")&&!s.isString(b.denotation)?"denotation: string expected":null},et.fromObject=function(b){if(b instanceof d.onnx.TypeProto)return b;var g=new d.onnx.TypeProto;if(b.tensorType!=null){if(typeof b.tensorType!="object")throw TypeError(".onnx.TypeProto.tensorType: object expected");g.tensorType=d.onnx.TypeProto.Tensor.fromObject(b.tensorType)}if(b.sequenceType!=null){if(typeof b.sequenceType!="object")throw TypeError(".onnx.TypeProto.sequenceType: object expected");g.sequenceType=d.onnx.TypeProto.Sequence.fromObject(b.sequenceType)}if(b.mapType!=null){if(typeof b.mapType!="object")throw TypeError(".onnx.TypeProto.mapType: object expected");g.mapType=d.onnx.TypeProto.Map.fromObject(b.mapType)}if(b.optionalType!=null){if(typeof b.optionalType!="object")throw TypeError(".onnx.TypeProto.optionalType: object expected");g.optionalType=d.onnx.TypeProto.Optional.fromObject(b.optionalType)}if(b.sparseTensorType!=null){if(typeof b.sparseTensorType!="object")throw TypeError(".onnx.TypeProto.sparseTensorType: object expected");g.sparseTensorType=d.onnx.TypeProto.SparseTensor.fromObject(b.sparseTensorType)}return b.denotation!=null&&(g.denotation=String(b.denotation)),g},et.toObject=function(b,g){g||(g={});var st={};return g.defaults&&(st.denotation=""),b.tensorType!=null&&b.hasOwnProperty("tensorType")&&(st.tensorType=d.onnx.TypeProto.Tensor.toObject(b.tensorType,g),g.oneofs&&(st.value="tensorType")),b.sequenceType!=null&&b.hasOwnProperty("sequenceType")&&(st.sequenceType=d.onnx.TypeProto.Sequence.toObject(b.sequenceType,g),g.oneofs&&(st.value="sequenceType")),b.mapType!=null&&b.hasOwnProperty("mapType")&&(st.mapType=d.onnx.TypeProto.Map.toObject(b.mapType,g),g.oneofs&&(st.value="mapType")),b.denotation!=null&&b.hasOwnProperty("denotation")&&(st.denotation=b.denotation),b.sparseTensorType!=null&&b.hasOwnProperty("sparseTensorType")&&(st.sparseTensorType=d.onnx.TypeProto.SparseTensor.toObject(b.sparseTensorType,g),g.oneofs&&(st.value="sparseTensorType")),b.optionalType!=null&&b.hasOwnProperty("optionalType")&&(st.optionalType=d.onnx.TypeProto.Optional.toObject(b.optionalType,g),g.oneofs&&(st.value="optionalType")),st},et.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},et.getTypeUrl=function(b){return b===void 0&&(b="type.googleapis.com"),b+"/onnx.TypeProto"},et.Tensor=function(){function b(g){if(g)for(var st=Object.keys(g),$t=0;$t<st.length;++$t)g[st[$t]]!=null&&(this[st[$t]]=g[st[$t]])}return b.prototype.elemType=0,b.prototype.shape=null,b.create=function(g){return new b(g)},b.encode=function(g,st){return st||(st=c.create()),g.elemType!=null&&Object.hasOwnProperty.call(g,"elemType")&&st.uint32(8).int32(g.elemType),g.shape!=null&&Object.hasOwnProperty.call(g,"shape")&&d.onnx.TensorShapeProto.encode(g.shape,st.uint32(18).fork()).ldelim(),st},b.encodeDelimited=function(g,st){return this.encode(g,st).ldelim()},b.decode=function(g,st){g instanceof o||(g=o.create(g));for(var $t=st===void 0?g.len:g.pos+st,vt=new d.onnx.TypeProto.Tensor;g.pos<$t;){var Ft=g.uint32();switch(Ft>>>3){case 1:{vt.elemType=g.int32();break}case 2:{vt.shape=d.onnx.TensorShapeProto.decode(g,g.uint32());break}default:g.skipType(Ft&7);break}}return vt},b.decodeDelimited=function(g){return g instanceof o||(g=new o(g)),this.decode(g,g.uint32())},b.verify=function(g){if(typeof g!="object"||g===null)return"object expected";if(g.elemType!=null&&g.hasOwnProperty("elemType")&&!s.isInteger(g.elemType))return"elemType: integer expected";if(g.shape!=null&&g.hasOwnProperty("shape")){var st=d.onnx.TensorShapeProto.verify(g.shape);if(st)return"shape."+st}return null},b.fromObject=function(g){if(g instanceof d.onnx.TypeProto.Tensor)return g;var st=new d.onnx.TypeProto.Tensor;if(g.elemType!=null&&(st.elemType=g.elemType|0),g.shape!=null){if(typeof g.shape!="object")throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");st.shape=d.onnx.TensorShapeProto.fromObject(g.shape)}return st},b.toObject=function(g,st){st||(st={});var $t={};return st.defaults&&($t.elemType=0,$t.shape=null),g.elemType!=null&&g.hasOwnProperty("elemType")&&($t.elemType=g.elemType),g.shape!=null&&g.hasOwnProperty("shape")&&($t.shape=d.onnx.TensorShapeProto.toObject(g.shape,st)),$t},b.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},b.getTypeUrl=function(g){return g===void 0&&(g="type.googleapis.com"),g+"/onnx.TypeProto.Tensor"},b}(),et.Sequence=function(){function b(g){if(g)for(var st=Object.keys(g),$t=0;$t<st.length;++$t)g[st[$t]]!=null&&(this[st[$t]]=g[st[$t]])}return b.prototype.elemType=null,b.create=function(g){return new b(g)},b.encode=function(g,st){return st||(st=c.create()),g.elemType!=null&&Object.hasOwnProperty.call(g,"elemType")&&d.onnx.TypeProto.encode(g.elemType,st.uint32(10).fork()).ldelim(),st},b.encodeDelimited=function(g,st){return this.encode(g,st).ldelim()},b.decode=function(g,st){g instanceof o||(g=o.create(g));for(var $t=st===void 0?g.len:g.pos+st,vt=new d.onnx.TypeProto.Sequence;g.pos<$t;){var Ft=g.uint32();switch(Ft>>>3){case 1:{vt.elemType=d.onnx.TypeProto.decode(g,g.uint32());break}default:g.skipType(Ft&7);break}}return vt},b.decodeDelimited=function(g){return g instanceof o||(g=new o(g)),this.decode(g,g.uint32())},b.verify=function(g){if(typeof g!="object"||g===null)return"object expected";if(g.elemType!=null&&g.hasOwnProperty("elemType")){var st=d.onnx.TypeProto.verify(g.elemType);if(st)return"elemType."+st}return null},b.fromObject=function(g){if(g instanceof d.onnx.TypeProto.Sequence)return g;var st=new d.onnx.TypeProto.Sequence;if(g.elemType!=null){if(typeof g.elemType!="object")throw TypeError(".onnx.TypeProto.Sequence.elemType: object expected");st.elemType=d.onnx.TypeProto.fromObject(g.elemType)}return st},b.toObject=function(g,st){st||(st={});var $t={};return st.defaults&&($t.elemType=null),g.elemType!=null&&g.hasOwnProperty("elemType")&&($t.elemType=d.onnx.TypeProto.toObject(g.elemType,st)),$t},b.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},b.getTypeUrl=function(g){return g===void 0&&(g="type.googleapis.com"),g+"/onnx.TypeProto.Sequence"},b}(),et.Map=function(){function b(g){if(g)for(var st=Object.keys(g),$t=0;$t<st.length;++$t)g[st[$t]]!=null&&(this[st[$t]]=g[st[$t]])}return b.prototype.keyType=0,b.prototype.valueType=null,b.create=function(g){return new b(g)},b.encode=function(g,st){return st||(st=c.create()),g.keyType!=null&&Object.hasOwnProperty.call(g,"keyType")&&st.uint32(8).int32(g.keyType),g.valueType!=null&&Object.hasOwnProperty.call(g,"valueType")&&d.onnx.TypeProto.encode(g.valueType,st.uint32(18).fork()).ldelim(),st},b.encodeDelimited=function(g,st){return this.encode(g,st).ldelim()},b.decode=function(g,st){g instanceof o||(g=o.create(g));for(var $t=st===void 0?g.len:g.pos+st,vt=new d.onnx.TypeProto.Map;g.pos<$t;){var Ft=g.uint32();switch(Ft>>>3){case 1:{vt.keyType=g.int32();break}case 2:{vt.valueType=d.onnx.TypeProto.decode(g,g.uint32());break}default:g.skipType(Ft&7);break}}return vt},b.decodeDelimited=function(g){return g instanceof o||(g=new o(g)),this.decode(g,g.uint32())},b.verify=function(g){if(typeof g!="object"||g===null)return"object expected";if(g.keyType!=null&&g.hasOwnProperty("keyType")&&!s.isInteger(g.keyType))return"keyType: integer expected";if(g.valueType!=null&&g.hasOwnProperty("valueType")){var st=d.onnx.TypeProto.verify(g.valueType);if(st)return"valueType."+st}return null},b.fromObject=function(g){if(g instanceof d.onnx.TypeProto.Map)return g;var st=new d.onnx.TypeProto.Map;if(g.keyType!=null&&(st.keyType=g.keyType|0),g.valueType!=null){if(typeof g.valueType!="object")throw TypeError(".onnx.TypeProto.Map.valueType: object expected");st.valueType=d.onnx.TypeProto.fromObject(g.valueType)}return st},b.toObject=function(g,st){st||(st={});var $t={};return st.defaults&&($t.keyType=0,$t.valueType=null),g.keyType!=null&&g.hasOwnProperty("keyType")&&($t.keyType=g.keyType),g.valueType!=null&&g.hasOwnProperty("valueType")&&($t.valueType=d.onnx.TypeProto.toObject(g.valueType,st)),$t},b.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},b.getTypeUrl=function(g){return g===void 0&&(g="type.googleapis.com"),g+"/onnx.TypeProto.Map"},b}(),et.Optional=function(){function b(g){if(g)for(var st=Object.keys(g),$t=0;$t<st.length;++$t)g[st[$t]]!=null&&(this[st[$t]]=g[st[$t]])}return b.prototype.elemType=null,b.create=function(g){return new b(g)},b.encode=function(g,st){return st||(st=c.create()),g.elemType!=null&&Object.hasOwnProperty.call(g,"elemType")&&d.onnx.TypeProto.encode(g.elemType,st.uint32(10).fork()).ldelim(),st},b.encodeDelimited=function(g,st){return this.encode(g,st).ldelim()},b.decode=function(g,st){g instanceof o||(g=o.create(g));for(var $t=st===void 0?g.len:g.pos+st,vt=new d.onnx.TypeProto.Optional;g.pos<$t;){var Ft=g.uint32();switch(Ft>>>3){case 1:{vt.elemType=d.onnx.TypeProto.decode(g,g.uint32());break}default:g.skipType(Ft&7);break}}return vt},b.decodeDelimited=function(g){return g instanceof o||(g=new o(g)),this.decode(g,g.uint32())},b.verify=function(g){if(typeof g!="object"||g===null)return"object expected";if(g.elemType!=null&&g.hasOwnProperty("elemType")){var st=d.onnx.TypeProto.verify(g.elemType);if(st)return"elemType."+st}return null},b.fromObject=function(g){if(g instanceof d.onnx.TypeProto.Optional)return g;var st=new d.onnx.TypeProto.Optional;if(g.elemType!=null){if(typeof g.elemType!="object")throw TypeError(".onnx.TypeProto.Optional.elemType: object expected");st.elemType=d.onnx.TypeProto.fromObject(g.elemType)}return st},b.toObject=function(g,st){st||(st={});var $t={};return st.defaults&&($t.elemType=null),g.elemType!=null&&g.hasOwnProperty("elemType")&&($t.elemType=d.onnx.TypeProto.toObject(g.elemType,st)),$t},b.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},b.getTypeUrl=function(g){return g===void 0&&(g="type.googleapis.com"),g+"/onnx.TypeProto.Optional"},b}(),et.SparseTensor=function(){function b(g){if(g)for(var st=Object.keys(g),$t=0;$t<st.length;++$t)g[st[$t]]!=null&&(this[st[$t]]=g[st[$t]])}return b.prototype.elemType=0,b.prototype.shape=null,b.create=function(g){return new b(g)},b.encode=function(g,st){return st||(st=c.create()),g.elemType!=null&&Object.hasOwnProperty.call(g,"elemType")&&st.uint32(8).int32(g.elemType),g.shape!=null&&Object.hasOwnProperty.call(g,"shape")&&d.onnx.TensorShapeProto.encode(g.shape,st.uint32(18).fork()).ldelim(),st},b.encodeDelimited=function(g,st){return this.encode(g,st).ldelim()},b.decode=function(g,st){g instanceof o||(g=o.create(g));for(var $t=st===void 0?g.len:g.pos+st,vt=new d.onnx.TypeProto.SparseTensor;g.pos<$t;){var Ft=g.uint32();switch(Ft>>>3){case 1:{vt.elemType=g.int32();break}case 2:{vt.shape=d.onnx.TensorShapeProto.decode(g,g.uint32());break}default:g.skipType(Ft&7);break}}return vt},b.decodeDelimited=function(g){return g instanceof o||(g=new o(g)),this.decode(g,g.uint32())},b.verify=function(g){if(typeof g!="object"||g===null)return"object expected";if(g.elemType!=null&&g.hasOwnProperty("elemType")&&!s.isInteger(g.elemType))return"elemType: integer expected";if(g.shape!=null&&g.hasOwnProperty("shape")){var st=d.onnx.TensorShapeProto.verify(g.shape);if(st)return"shape."+st}return null},b.fromObject=function(g){if(g instanceof d.onnx.TypeProto.SparseTensor)return g;var st=new d.onnx.TypeProto.SparseTensor;if(g.elemType!=null&&(st.elemType=g.elemType|0),g.shape!=null){if(typeof g.shape!="object")throw TypeError(".onnx.TypeProto.SparseTensor.shape: object expected");st.shape=d.onnx.TensorShapeProto.fromObject(g.shape)}return st},b.toObject=function(g,st){st||(st={});var $t={};return st.defaults&&($t.elemType=0,$t.shape=null),g.elemType!=null&&g.hasOwnProperty("elemType")&&($t.elemType=g.elemType),g.shape!=null&&g.hasOwnProperty("shape")&&($t.shape=d.onnx.TensorShapeProto.toObject(g.shape,st)),$t},b.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},b.getTypeUrl=function(g){return g===void 0&&(g="type.googleapis.com"),g+"/onnx.TypeProto.SparseTensor"},b}(),et}(),$.OperatorSetIdProto=function(){function et(h){if(h)for(var b=Object.keys(h),g=0;g<b.length;++g)h[b[g]]!=null&&(this[b[g]]=h[b[g]])}return et.prototype.domain="",et.prototype.version=s.Long?s.Long.fromBits(0,0,!1):0,et.create=function(h){return new et(h)},et.encode=function(h,b){return b||(b=c.create()),h.domain!=null&&Object.hasOwnProperty.call(h,"domain")&&b.uint32(10).string(h.domain),h.version!=null&&Object.hasOwnProperty.call(h,"version")&&b.uint32(16).int64(h.version),b},et.encodeDelimited=function(h,b){return this.encode(h,b).ldelim()},et.decode=function(h,b){h instanceof o||(h=o.create(h));for(var g=b===void 0?h.len:h.pos+b,st=new d.onnx.OperatorSetIdProto;h.pos<g;){var $t=h.uint32();switch($t>>>3){case 1:{st.domain=h.string();break}case 2:{st.version=h.int64();break}default:h.skipType($t&7);break}}return st},et.decodeDelimited=function(h){return h instanceof o||(h=new o(h)),this.decode(h,h.uint32())},et.verify=function(h){return typeof h!="object"||h===null?"object expected":h.domain!=null&&h.hasOwnProperty("domain")&&!s.isString(h.domain)?"domain: string expected":h.version!=null&&h.hasOwnProperty("version")&&!s.isInteger(h.version)&&!(h.version&&s.isInteger(h.version.low)&&s.isInteger(h.version.high))?"version: integer|Long expected":null},et.fromObject=function(h){if(h instanceof d.onnx.OperatorSetIdProto)return h;var b=new d.onnx.OperatorSetIdProto;return h.domain!=null&&(b.domain=String(h.domain)),h.version!=null&&(s.Long?(b.version=s.Long.fromValue(h.version)).unsigned=!1:typeof h.version=="string"?b.version=parseInt(h.version,10):typeof h.version=="number"?b.version=h.version:typeof h.version=="object"&&(b.version=new s.LongBits(h.version.low>>>0,h.version.high>>>0).toNumber())),b},et.toObject=function(h,b){b||(b={});var g={};if(b.defaults)if(g.domain="",s.Long){var st=new s.Long(0,0,!1);g.version=b.longs===String?st.toString():b.longs===Number?st.toNumber():st}else g.version=b.longs===String?"0":0;return h.domain!=null&&h.hasOwnProperty("domain")&&(g.domain=h.domain),h.version!=null&&h.hasOwnProperty("version")&&(typeof h.version=="number"?g.version=b.longs===String?String(h.version):h.version:g.version=b.longs===String?s.Long.prototype.toString.call(h.version):b.longs===Number?new s.LongBits(h.version.low>>>0,h.version.high>>>0).toNumber():h.version),g},et.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},et.getTypeUrl=function(h){return h===void 0&&(h="type.googleapis.com"),h+"/onnx.OperatorSetIdProto"},et}(),$.OperatorStatus=function(){var et={},h=Object.create(et);return h[et[0]="EXPERIMENTAL"]=0,h[et[1]="STABLE"]=1,h}(),$.FunctionProto=function(){function et(h){if(this.input=[],this.output=[],this.attribute=[],this.attributeProto=[],this.node=[],this.opsetImport=[],h)for(var b=Object.keys(h),g=0;g<b.length;++g)h[b[g]]!=null&&(this[b[g]]=h[b[g]])}return et.prototype.name="",et.prototype.input=s.emptyArray,et.prototype.output=s.emptyArray,et.prototype.attribute=s.emptyArray,et.prototype.attributeProto=s.emptyArray,et.prototype.node=s.emptyArray,et.prototype.docString="",et.prototype.opsetImport=s.emptyArray,et.prototype.domain="",et.create=function(h){return new et(h)},et.encode=function(h,b){if(b||(b=c.create()),h.name!=null&&Object.hasOwnProperty.call(h,"name")&&b.uint32(10).string(h.name),h.input!=null&&h.input.length)for(var g=0;g<h.input.length;++g)b.uint32(34).string(h.input[g]);if(h.output!=null&&h.output.length)for(var g=0;g<h.output.length;++g)b.uint32(42).string(h.output[g]);if(h.attribute!=null&&h.attribute.length)for(var g=0;g<h.attribute.length;++g)b.uint32(50).string(h.attribute[g]);if(h.node!=null&&h.node.length)for(var g=0;g<h.node.length;++g)d.onnx.NodeProto.encode(h.node[g],b.uint32(58).fork()).ldelim();if(h.docString!=null&&Object.hasOwnProperty.call(h,"docString")&&b.uint32(66).string(h.docString),h.opsetImport!=null&&h.opsetImport.length)for(var g=0;g<h.opsetImport.length;++g)d.onnx.OperatorSetIdProto.encode(h.opsetImport[g],b.uint32(74).fork()).ldelim();if(h.domain!=null&&Object.hasOwnProperty.call(h,"domain")&&b.uint32(82).string(h.domain),h.attributeProto!=null&&h.attributeProto.length)for(var g=0;g<h.attributeProto.length;++g)d.onnx.AttributeProto.encode(h.attributeProto[g],b.uint32(90).fork()).ldelim();return b},et.encodeDelimited=function(h,b){return this.encode(h,b).ldelim()},et.decode=function(h,b){h instanceof o||(h=o.create(h));for(var g=b===void 0?h.len:h.pos+b,st=new d.onnx.FunctionProto;h.pos<g;){var $t=h.uint32();switch($t>>>3){case 1:{st.name=h.string();break}case 4:{st.input&&st.input.length||(st.input=[]),st.input.push(h.string());break}case 5:{st.output&&st.output.length||(st.output=[]),st.output.push(h.string());break}case 6:{st.attribute&&st.attribute.length||(st.attribute=[]),st.attribute.push(h.string());break}case 11:{st.attributeProto&&st.attributeProto.length||(st.attributeProto=[]),st.attributeProto.push(d.onnx.AttributeProto.decode(h,h.uint32()));break}case 7:{st.node&&st.node.length||(st.node=[]),st.node.push(d.onnx.NodeProto.decode(h,h.uint32()));break}case 8:{st.docString=h.string();break}case 9:{st.opsetImport&&st.opsetImport.length||(st.opsetImport=[]),st.opsetImport.push(d.onnx.OperatorSetIdProto.decode(h,h.uint32()));break}case 10:{st.domain=h.string();break}default:h.skipType($t&7);break}}return st},et.decodeDelimited=function(h){return h instanceof o||(h=new o(h)),this.decode(h,h.uint32())},et.verify=function(h){if(typeof h!="object"||h===null)return"object expected";if(h.name!=null&&h.hasOwnProperty("name")&&!s.isString(h.name))return"name: string expected";if(h.input!=null&&h.hasOwnProperty("input")){if(!Array.isArray(h.input))return"input: array expected";for(var b=0;b<h.input.length;++b)if(!s.isString(h.input[b]))return"input: string[] expected"}if(h.output!=null&&h.hasOwnProperty("output")){if(!Array.isArray(h.output))return"output: array expected";for(var b=0;b<h.output.length;++b)if(!s.isString(h.output[b]))return"output: string[] expected"}if(h.attribute!=null&&h.hasOwnProperty("attribute")){if(!Array.isArray(h.attribute))return"attribute: array expected";for(var b=0;b<h.attribute.length;++b)if(!s.isString(h.attribute[b]))return"attribute: string[] expected"}if(h.attributeProto!=null&&h.hasOwnProperty("attributeProto")){if(!Array.isArray(h.attributeProto))return"attributeProto: array expected";for(var b=0;b<h.attributeProto.length;++b){var g=d.onnx.AttributeProto.verify(h.attributeProto[b]);if(g)return"attributeProto."+g}}if(h.node!=null&&h.hasOwnProperty("node")){if(!Array.isArray(h.node))return"node: array expected";for(var b=0;b<h.node.length;++b){var g=d.onnx.NodeProto.verify(h.node[b]);if(g)return"node."+g}}if(h.docString!=null&&h.hasOwnProperty("docString")&&!s.isString(h.docString))return"docString: string expected";if(h.opsetImport!=null&&h.hasOwnProperty("opsetImport")){if(!Array.isArray(h.opsetImport))return"opsetImport: array expected";for(var b=0;b<h.opsetImport.length;++b){var g=d.onnx.OperatorSetIdProto.verify(h.opsetImport[b]);if(g)return"opsetImport."+g}}return h.domain!=null&&h.hasOwnProperty("domain")&&!s.isString(h.domain)?"domain: string expected":null},et.fromObject=function(h){if(h instanceof d.onnx.FunctionProto)return h;var b=new d.onnx.FunctionProto;if(h.name!=null&&(b.name=String(h.name)),h.input){if(!Array.isArray(h.input))throw TypeError(".onnx.FunctionProto.input: array expected");b.input=[];for(var g=0;g<h.input.length;++g)b.input[g]=String(h.input[g])}if(h.output){if(!Array.isArray(h.output))throw TypeError(".onnx.FunctionProto.output: array expected");b.output=[];for(var g=0;g<h.output.length;++g)b.output[g]=String(h.output[g])}if(h.attribute){if(!Array.isArray(h.attribute))throw TypeError(".onnx.FunctionProto.attribute: array expected");b.attribute=[];for(var g=0;g<h.attribute.length;++g)b.attribute[g]=String(h.attribute[g])}if(h.attributeProto){if(!Array.isArray(h.attributeProto))throw TypeError(".onnx.FunctionProto.attributeProto: array expected");b.attributeProto=[];for(var g=0;g<h.attributeProto.length;++g){if(typeof h.attributeProto[g]!="object")throw TypeError(".onnx.FunctionProto.attributeProto: object expected");b.attributeProto[g]=d.onnx.AttributeProto.fromObject(h.attributeProto[g])}}if(h.node){if(!Array.isArray(h.node))throw TypeError(".onnx.FunctionProto.node: array expected");b.node=[];for(var g=0;g<h.node.length;++g){if(typeof h.node[g]!="object")throw TypeError(".onnx.FunctionProto.node: object expected");b.node[g]=d.onnx.NodeProto.fromObject(h.node[g])}}if(h.docString!=null&&(b.docString=String(h.docString)),h.opsetImport){if(!Array.isArray(h.opsetImport))throw TypeError(".onnx.FunctionProto.opsetImport: array expected");b.opsetImport=[];for(var g=0;g<h.opsetImport.length;++g){if(typeof h.opsetImport[g]!="object")throw TypeError(".onnx.FunctionProto.opsetImport: object expected");b.opsetImport[g]=d.onnx.OperatorSetIdProto.fromObject(h.opsetImport[g])}}return h.domain!=null&&(b.domain=String(h.domain)),b},et.toObject=function(h,b){b||(b={});var g={};if((b.arrays||b.defaults)&&(g.input=[],g.output=[],g.attribute=[],g.node=[],g.opsetImport=[],g.attributeProto=[]),b.defaults&&(g.name="",g.docString="",g.domain=""),h.name!=null&&h.hasOwnProperty("name")&&(g.name=h.name),h.input&&h.input.length){g.input=[];for(var st=0;st<h.input.length;++st)g.input[st]=h.input[st]}if(h.output&&h.output.length){g.output=[];for(var st=0;st<h.output.length;++st)g.output[st]=h.output[st]}if(h.attribute&&h.attribute.length){g.attribute=[];for(var st=0;st<h.attribute.length;++st)g.attribute[st]=h.attribute[st]}if(h.node&&h.node.length){g.node=[];for(var st=0;st<h.node.length;++st)g.node[st]=d.onnx.NodeProto.toObject(h.node[st],b)}if(h.docString!=null&&h.hasOwnProperty("docString")&&(g.docString=h.docString),h.opsetImport&&h.opsetImport.length){g.opsetImport=[];for(var st=0;st<h.opsetImport.length;++st)g.opsetImport[st]=d.onnx.OperatorSetIdProto.toObject(h.opsetImport[st],b)}if(h.domain!=null&&h.hasOwnProperty("domain")&&(g.domain=h.domain),h.attributeProto&&h.attributeProto.length){g.attributeProto=[];for(var st=0;st<h.attributeProto.length;++st)g.attributeProto[st]=d.onnx.AttributeProto.toObject(h.attributeProto[st],b)}return g},et.prototype.toJSON=function(){return this.constructor.toObject(this,a.util.toJSONOptions)},et.getTypeUrl=function(h){return h===void 0&&(h="type.googleapis.com"),h+"/onnx.FunctionProto"},et}(),$}(),i.exports=d});function Fr(e,i){if(!e)throw new Error(typeof i=="string"?i:i())}function sn$1(e){return new TextDecoder().decode(e)}var ye$1,hr$1,pi$1,Ze$1,jn$1,We$1,it,U$1,an$1,mr$1,br,gr$1,fe$1=L(()=>{zn$1(),Zo(),ye$1=Ar(Cr()),yr(),hr$1=class{static arraysEqual(e,i){if(e.length!==i.length)return!1;for(let a=0;a<e.length;a++)if(e[a]!==i[a])return!1;return!0}},pi$1=class{static preprocessInputShapes(e,i){let a=e.length===1?[1,e[0]]:e,o=i.length===1?[i[0],1]:i;return[a,o]}static postprocessOutputShape(e,i,a){i===1&&e.splice(e.length-2,1),a===1&&e.pop()}static calcMatMulShape(e,i){return e[1]!==i[0]?void 0:[e[0],i[1]]}},Ze$1=class tw{static calcShape(i,a,o=!1){let c=i.length,s=a.length;if(c===0)return a;if(s===0)return i;let d=Math.max(i.length,a.length),$=new Array(d);if(o){if(c<2||s<2)return;let et=pi$1.calcMatMulShape([i[c-2],i[c-1]],[a[s-2],a[s-1]]);if(et===void 0)return;[$[d-2],$[d-1]]=et}for(let et=o?3:1;et<=d;et++){let h=c-et<0?1:i[c-et],b=s-et<0?1:a[s-et];if(h!==b&&h>1&&b>1)return;$[d-et]=Math.max(h,b)}return $}static index(i,a){let o=new Array(a.length);return tw.fillIndex(i,a,o),o}static fillIndex(i,a,o){let c=i.length-a.length;for(let s=0;s<a.length;s++)o[s]=i[c+s]%a[s]}static calc(i,a,o,c,s){let d=tw.calcShape(i.dims,a.dims);if(d){if(c&&!U$1.areEqual(d,i.dims))return;let $=U$1.size(d),et=c?i:new $e(d,s||i.type);if(d.length===0)et.set([],o(i.get([]),a.get([])));else{let h=new Array(d.length),b=new Array(i.dims.length),g=new Array(a.dims.length),st=0,$t=0,vt=!1,Ft=!1;i.dims.length===0&&(st=i.get([]),vt=!0),a.dims.length===0&&($t=a.get([]),Ft=!0);let Gt;for(let qt=0;qt<$;qt++){Gt=qt;for(let Lt=d.length-1;Lt>=0;Lt--)h[Lt]=Gt%d[Lt],Gt=Math.floor(Gt/d[Lt]);vt||(tw.fillIndex(h,i.dims,b),st=i.get(b)),Ft||(tw.fillIndex(h,a.dims,g),$t=a.get(g)),et.set(h,o(st,$t))}}return et}}static isValidBroadcast(i,a){let o=i.length,c=a.length;if(o>c)return!1;for(let s=1;s<=o;s++)if(i[o-s]!==1&&i[o-s]!==a[c-s])return!1;return!0}static getBroadcastDims(i,a){let o=i.length,c=[];for(let s=0;s<o;s++){let d=o-1-s,$=i[d]||1;(a[a.length-1-s]||1)>1&&$===1&&c.unshift(d)}return c}},jn$1=class{static getShapeOfGemmResult(e,i,a,o,c){if(e.length!==2||a.length!==2)throw new Error("shape need to be of size 2");let s,d,$;i?(s=e[1],d=e[0]):(s=e[0],d=e[1]);let et=-1;if(o?($=a[0],et=1):($=a[1],et=0),a[et]!==d)throw new Error("dimension mismatch");if(s<=0||$<=0||d<=0)throw new Error("invalid shape specified");if(c&&!Ze$1.isValidBroadcast(c,[s,$]))throw new Error("gemm: invalid bias shape for broadcast");return[s,$,d]}},We$1=class Y2{static tensorDataTypeFromProto(i){switch(i){case ye$1.onnx.TensorProto.DataType.INT8:return"int8";case ye$1.onnx.TensorProto.DataType.UINT8:return"uint8";case ye$1.onnx.TensorProto.DataType.BOOL:return"bool";case ye$1.onnx.TensorProto.DataType.INT16:return"int16";case ye$1.onnx.TensorProto.DataType.UINT16:return"uint16";case ye$1.onnx.TensorProto.DataType.INT32:return"int32";case ye$1.onnx.TensorProto.DataType.UINT32:return"uint32";case ye$1.onnx.TensorProto.DataType.FLOAT:return"float32";case ye$1.onnx.TensorProto.DataType.DOUBLE:return"float64";case ye$1.onnx.TensorProto.DataType.STRING:return"string";case ye$1.onnx.TensorProto.DataType.INT64:return"int32";case ye$1.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw new Error(`unsupported data type: ${ye$1.onnx.TensorProto.DataType[i]}`)}}static tensorDataTypeStringToEnum(i){switch(i){case"int8":return ye$1.onnx.TensorProto.DataType.INT8;case"uint8":return ye$1.onnx.TensorProto.DataType.UINT8;case"bool":return ye$1.onnx.TensorProto.DataType.BOOL;case"int16":return ye$1.onnx.TensorProto.DataType.INT16;case"uint16":return ye$1.onnx.TensorProto.DataType.UINT16;case"int32":return ye$1.onnx.TensorProto.DataType.INT32;case"uint32":return ye$1.onnx.TensorProto.DataType.UINT32;case"float32":return ye$1.onnx.TensorProto.DataType.FLOAT;case"float64":return ye$1.onnx.TensorProto.DataType.DOUBLE;case"string":return ye$1.onnx.TensorProto.DataType.STRING;case"int64":return ye$1.onnx.TensorProto.DataType.INT64;case"uint64":return ye$1.onnx.TensorProto.DataType.UINT64;default:throw new Error(`unsupported data type: ${i}`)}}static tensorDimsFromProto(i){return i.map(a=>Vt.isLong(a)?a.toNumber():a)}static tensorValueTypeFromProto(i){return{tensorType:Y2.tensorDataTypeFromProto(i.elemType),shape:{dims:Y2.tensorDimsFromProto(i.shape.dim.map(a=>a.dimValue))}}}static tensorDimsFromORTFormat(i){let a=[];for(let o=0;o<i.dimsLength();o++)a.push(it.longToNumber(i.dims(o)));return a}static tensorAttributesFromORTFormat(i){let a=[];for(let o=0;o<i.attributesLength();o++)a.push(i.attributes(o));return a}},it=class{static longToNumber(e,i){return Vt.isLong(e)?e.toNumber():e instanceof _.Long?Vt.fromValue({low:e.low,high:e.high,unsigned:i??!1}).toNumber():e}static isLong(e){return Vt.isLong(e)||e instanceof _.Long}},U$1=class Qv{static size(i){return Qv.getSizeFromDimensionRange(i,0,i.length)}static sizeFromDimension(i,a){if(a<0||a>i.length)throw new Error(`invalid dimension of ${a} for sizeFromDimension as Tensor has ${i.length} dimensions.`);return Qv.getSizeFromDimensionRange(i,a,i.length)}static sizeToDimension(i,a){if(a<0||a>i.length)throw new Error(`invalid dimension of ${a} for sizeToDimension as Tensor has ${i.length} dimensions.`);return Qv.getSizeFromDimensionRange(i,0,a)}static getSizeFromDimensionRange(i,a,o){let c=1;for(let s=a;s<o;s++){if(i[s]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");c*=i[s]}return c}static computeStrides(i){let a=i.length;if(a===0)return[];if(a===1)return[1];let o=new Array(a);o[a-1]=1,o[a-2]=i[a-1];for(let c=a-3;c>=0;--c)o[c]=o[c+1]*i[c+1];return o}static transpose(i){return i.slice().reverse()}static indicesToOffset(i,a,o){o===void 0&&(o=i.length);let c=0;for(let s=0;s<o;++s)c+=a[s]*i[s];return c}static offsetToIndices(i,a){let o=a.length;if(o===0)return[];if(o===1)return[i*a[0]];let c=new Array(a.length);for(let s=0;s<c.length-1;++s)c[s]=Math.floor(i/a[s]),i-=c[s]*a[s];return c[c.length-1]=i,c}static normalizeAxis(i,a){if(i<-a&&i>=a)throw new Error("unsupported axis for this operation.");return i<0?i+a:i}static normalizeAxes(i,a){return i.map(o=>this.normalizeAxis(o,a))}static incrementIndex(i,a,o){if(a.length===0||i.length===0)throw new Error("Index incrementing unsupported for scalar Tensor");if(o===void 0)o=a.length;else if(o<=0||o>a.length)throw new Error("Incorrect axis to increment on");for(let c=o-1;c>=0&&(i[c]++,!(i[c]<a[c]));--c)i[c]=0}static calculateReshapedDims(i,a){if(a.length===0){if(i.length===0||Qv.size(i)===1)return[];throw new Error("cannot reshape to a scalar Tensor")}let o=a.length,c=new Array(o),s=-1,d=1;for(let et=0;et<o;et++){if(a[et]<-1)throw new Error("a dimension in shape hints cannot be less than -1");if(a[et]===-1){if(s!==-1)throw new Error("at most one dimension in shape hints can be -1");s=et}else{if(a[et]===0){if(et>=i.length)throw new Error("the dimension with value zero exceeds the dimension size of the input tensor");c[et]=i[et]}else c[et]=a[et];d*=c[et]}}let $=Qv.size(i);if(s!==-1){if($%d!==0)throw new Error(`the input tensor cannot be reshaped to the requested shape. Input shape: [${i}] Output shape: [${a}]`);c[s]=$/d}else if(d!==$)throw new Error("reshapedDims and originalDims don't have matching sizes");return c}static sortBasedOnPerm(i,a){return a?a.map(o=>i[o]):i.slice().reverse()}static padShape(i,a){let o=i.length;return i.map((c,s)=>c+a[s]+a[s+o])}static areEqual(i,a){return i.length!==a.length?!1:i.every((o,c)=>o===a[c])}static validateDimsAndCalcSize(i){if(i.length>6)throw new TypeError("Only rank 0 to 6 is supported for tensor shape.");let a=1;for(let o of i){if(!Number.isInteger(o))throw new TypeError(`Invalid shape: ${o} is not an integer`);if(o<0||o>2147483647)throw new TypeError(`Invalid shape: length ${o} is not allowed`);a*=o}return a}static flattenShape(i,a){a<0&&(a+=i.length);let o=i.reduce((s,d)=>s*d,1),c=i.slice(a).reduce((s,d)=>s*d,1);return[o/c,c]}static squeezeShape(i,a){let o=new Array;a=Qv.normalizeAxes(a,i.length);for(let c=0;c<i.length;c++){let s=a.indexOf(c)>=0;if(s&&i[c]!==1)throw new Error("squeeze an axis of size different than 1");(a.length===0&&i[c]>1||a.length>0&&!s)&&o.push(i[c])}return o}static unsqueezeShape(i,a){let o=new Array(i.length+a.length);o.fill(0);for(let s=0;s<a.length;s++){let d=Qv.normalizeAxis(a[s],o.length);if(d>=o.length)throw new Error("'axes' has an out of range axis");if(o[d]!==0)throw new Error("'axes' has a duplicate axis");o[d]=1}let c=0;for(let s=0;s<o.length;s++)o[s]===0&&(o[s]=i[c++]);if(c!==i.length)throw new Error("the unsqueezed dimension could not be established");return o}},an$1=class Hx{static splitShape(i,a,o,c){if(o.length===0){if(!c)throw new Error("need to know number of outputs when the 'split' attribute is not specified");Hx.determineSplit(i[a],c,o)}let s=[],d=[0];for(let $=0;$<o.length;++$){$!==0&&d.push(d[$-1]+o[$-1]);let et=i.slice();et[a]=o[$],s.push(et)}return[s,d]}static determineSplit(i,a,o){if(i%a!==0)throw new Error("cannot split tensor to equal sized parts");for(let c=0;c<a;++c)o.push(i/a)}},mr$1=class rw{static adjustPoolAttributes(i,a,o,c,s,d){if(!i&&o.length!==a.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(i)for(let $=0;$<a.length-2;$++)$>=o.length?o.push(a[$+2]):o[$]=a[$+2];for(let $=0;$<o.length;$++)if($<c.length){if(c[$]<0)throw new Error("strides should be greater than or equal to 1")}else c.push(1);for(let $=0;$<o.length;$++)if($<s.length){if(s[$]<0)throw new Error("dilations should be greater than or equal to 1")}else s.push(1);for(let $=0;$<o.length*2;$++)if($<d.length){if(d[$]<0)throw new Error("pad should be greater than or equal to 1")}else d.push(0);for(let $=0;$<o.length;$++){if(o[$]<=0)throw new Error("kernel shapes need to be greater than 0");if(d[$]>=o[$]||d[$+o.length]>=o[$])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(i,a,o,c,s,d){if(d){if(s.length!==2*(i.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(a.length!==i.length-2)throw new Error("length of strides should be the length of data dimensions");if(c.length!==i.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let $=0;$<i.length-2;$++)rw.adjustPadAndReturnShape(i[$+2],a[$],o[$],c[$],s,$,$+i.length-2,d)}}static computePoolOutputShape(i,a,o,c,s,d,$){if(a.length<=0)throw new Error("input shape must be of size greater than 0");let et=[a[0],a[1]];return rw.computeShapeHelper(i,a,et,o,c,s,d,$),et}static computeConvOutputShape(i,a,o,c,s,d,$){if(i.length<=0||a.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let et=[i[0],a[0]];return rw.computeShapeHelper(!1,i,et,o,c,s,d,$),et}static computeShapeHelper(i,a,o,c,s,d,$,et){if(i)for(let h=0;h<a.length-2;h++)o.push(1);else for(let h=0;h<a.length-2;h++)o.push(rw.adjustPadAndReturnShape(a[h+2],c[h],s[h],d[h],$,h,h+a.length-2,et))}static adjustPadAndReturnShape(i,a,o,c,s,d,$,et){let h=o*(c-1)+1;if(et&&et!=="NOTSET")switch(et){case"VALID":return s[d]=0,s[$]=0,Math.floor((i-h)/a+1);case"SAME_LOWER":case"SAME_UPPER":if(o!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let b=((i+a-1)/a-1)*a+c-i;return s[d]=Math.floor(et==="SAME_LOWER"?(b+1)/2:b/2),s[$]=b-s[d],Math.floor((i+b-c)/a+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((i+s[d]+s[$]-h)/a+1)}},br=-34028234663852886e22,gr$1=34028234663852886e22});function Hd$1(e){switch(e){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw new Error(`cannot calculate sizeof() on type ${e}`)}}function Fu$1(e){switch(e){case ne.onnx.TensorProto.DataType.UINT8:case ne.onnx.TensorProto.DataType.INT8:case ne.onnx.TensorProto.DataType.BOOL:return 1;case ne.onnx.TensorProto.DataType.UINT16:case ne.onnx.TensorProto.DataType.INT16:return 2;case ne.onnx.TensorProto.DataType.FLOAT:case ne.onnx.TensorProto.DataType.INT32:case ne.onnx.TensorProto.DataType.UINT32:return 4;case ne.onnx.TensorProto.DataType.INT64:case ne.onnx.TensorProto.DataType.DOUBLE:case ne.onnx.TensorProto.DataType.UINT64:return 8;default:throw new Error(`cannot calculate sizeof() on type ${ne.onnx.TensorProto.DataType[e]}`)}}function qd$1(e,i){return new(Bu$1(i))(e)}function Bu$1(e){switch(e){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw new Error("unspecified error")}}function hi$1(e,i){if(i===ne.onnx.TensorProto.DataType.INT64||i===di$1.TensorDataType.INT64){if(e.greaterThanOrEqual(2147483648)||e.lessThan(-2147483648))throw new TypeError("int64 is not supported")}else if(i===ne.onnx.TensorProto.DataType.UINT32||i===di$1.TensorDataType.UINT32||i===ne.onnx.TensorProto.DataType.UINT64||i===di$1.TensorDataType.UINT64){if(e.greaterThanOrEqual(4294967296)||e.lessThan(0))throw new TypeError("uint64 is not supported")}else throw new TypeError(`not a LONG type: ${ne.onnx.TensorProto.DataType[i]}`);return e.toNumber()}function $u$1(e,i,a){switch(i){case ne.onnx.TensorProto.DataType.BOOL:case ne.onnx.TensorProto.DataType.UINT8:return e.getUint8(a);case ne.onnx.TensorProto.DataType.INT8:return e.getInt8(a);case ne.onnx.TensorProto.DataType.UINT16:return e.getUint16(a,!0);case ne.onnx.TensorProto.DataType.INT16:return e.getInt16(a,!0);case ne.onnx.TensorProto.DataType.FLOAT:return e.getFloat32(a,!0);case ne.onnx.TensorProto.DataType.INT32:return e.getInt32(a,!0);case ne.onnx.TensorProto.DataType.UINT32:return e.getUint32(a,!0);case ne.onnx.TensorProto.DataType.INT64:return hi$1(Vt.fromBits(e.getUint32(a,!0),e.getUint32(a+4,!0),!1),i);case ne.onnx.TensorProto.DataType.DOUBLE:return e.getFloat64(a,!0);case ne.onnx.TensorProto.DataType.UINT64:return hi$1(Vt.fromBits(e.getUint32(a,!0),e.getUint32(a+4,!0),!0),i);default:throw new Error(`cannot read from DataView for type ${ne.onnx.TensorProto.DataType[i]}`)}}var ku$1,ne,di$1,$e,yr=L(()=>{ku$1=Ar(Os$1()),Zo(),tn$1(),ne=Ar(Cr()),fe$1(),di$1=V.experimental.fbs,$e=class Jw{constructor(i,a,o,c,s,d=ku$1.Guid.create()){this.dims=i,this.type=a,this.dataProvider=o,this.asyncDataProvider=c,this.cache=s,this.dataId=d,this.size=U$1.validateDimsAndCalcSize(i);let $=this.size,et=o===void 0&&c===void 0&&s===void 0;if(s!==void 0&&s.length!==$)throw new RangeError("Input dims doesn't match data length.");if(a==="string"){if(s!==void 0&&(!Array.isArray(s)||!s.every(h=>typeof h=="string")))throw new TypeError("cache should be a string array");et&&(this.cache=new Array($))}else{if(s!==void 0){let h=Bu$1(a);if(!(s instanceof h))throw new TypeError(`cache should be type ${h.name}`)}if(et){let h=new ArrayBuffer($*Hd$1(a));this.cache=qd$1(h,a)}}}get data(){if(this.cache===void 0){let i=this.dataProvider(this.dataId);if(i.length!==this.size)throw new Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=i}return this.cache}get stringData(){if(this.type!=="string")throw new TypeError("data type is not string");return this.data}get integerData(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw new TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)")}}get floatData(){switch(this.type){case"float32":case"float64":return this.data;default:throw new TypeError("data type is not float (float32, float64)")}}get numberData(){if(this.type!=="string")return this.data;throw new TypeError("type cannot be non-number (string)")}get(i){return this.data[U$1.indicesToOffset(i,this.strides)]}set(i,a){this.data[U$1.indicesToOffset(i,this.strides)]=a}async getData(){return this.cache===void 0&&(this.cache=await this.asyncDataProvider(this.dataId)),this.cache}get strides(){return this._strides||(this._strides=U$1.computeStrides(this.dims)),this._strides}static fromProto(i){if(!i)throw new Error("cannot construct Value from an empty tensor");let a=We$1.tensorDataTypeFromProto(i.dataType),o=We$1.tensorDimsFromProto(i.dims),c=new Jw(o,a);if(a==="string")i.stringData.forEach((s,d)=>{c.data[d]=sn$1(s)});else if(i.rawData&&typeof i.rawData.byteLength=="number"&&i.rawData.byteLength>0){let s=c.data,d=new DataView(i.rawData.buffer,i.rawData.byteOffset,i.rawData.byteLength),$=Fu$1(i.dataType),et=i.rawData.byteLength/$;if(i.rawData.byteLength%$!==0)throw new Error("invalid buffer length");if(s.length!==et)throw new Error("buffer length mismatch");for(let h=0;h<et;h++){let b=$u$1(d,i.dataType,h*$);s[h]=b}}else{let s;switch(i.dataType){case ne.onnx.TensorProto.DataType.FLOAT:s=i.floatData;break;case ne.onnx.TensorProto.DataType.INT32:case ne.onnx.TensorProto.DataType.INT16:case ne.onnx.TensorProto.DataType.UINT16:case ne.onnx.TensorProto.DataType.INT8:case ne.onnx.TensorProto.DataType.UINT8:case ne.onnx.TensorProto.DataType.BOOL:s=i.int32Data;break;case ne.onnx.TensorProto.DataType.INT64:s=i.int64Data;break;case ne.onnx.TensorProto.DataType.DOUBLE:s=i.doubleData;break;case ne.onnx.TensorProto.DataType.UINT32:case ne.onnx.TensorProto.DataType.UINT64:s=i.uint64Data;break;default:throw new Error("unspecific error")}if(s==null)throw new Error("failed to populate data from a tensorproto value");let d=c.data;if(d.length!==s.length)throw new Error("array length mismatch");for(let $=0;$<s.length;$++){let et=s[$];Vt.isLong(et)?d[$]=hi$1(et,i.dataType):d[$]=et}}return c}static fromData(i,a,o){return new Jw(a,o,void 0,void 0,i)}static fromOrtTensor(i){if(!i)throw new Error("cannot construct Value from an empty tensor");let a=We$1.tensorDimsFromORTFormat(i),o=We$1.tensorDataTypeFromProto(i.dataType()),c=new Jw(a,o);if(o==="string")for(let s=0;s<i.stringDataLength();s++)c.data[s]=i.stringData(s);else if(i.rawDataArray()&&typeof i.rawDataLength()=="number"&&i.rawDataLength()>0){let s=c.data,d=new DataView(i.rawDataArray().buffer,i.rawDataArray().byteOffset,i.rawDataLength()),$=Fu$1(i.dataType()),et=i.rawDataLength()/$;if(i.rawDataLength()%$!==0)throw new Error("invalid buffer length");if(s.length!==et)throw new Error("buffer length mismatch");for(let h=0;h<et;h++){let b=$u$1(d,i.dataType(),h*$);s[h]=b}}return c}}});function H(e){return e===1?jd$1:Yd$1}function Nu$1(e){let i=H(e);return`${i.version}
      precision highp float;
      ${i.attribute} vec3 position;
      ${i.attribute} vec2 textureCoord;

      ${i.varyingVertex} vec2 TexCoords;

      void main()
      {
          gl_Position = vec4(position, 1.0);
          TexCoords = textureCoord;
      }`}function Ru$1(e){let i=H(e);return`${i.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${i.varyingFrag} vec2 TexCoords;
    ${i.outputDeclaration}
    const vec2 halfCR = vec2(0.5, 0.5);

    // Custom vector types to handle higher dimenalities.
    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    `}function Mu$1(e,i){let a=H(e);return`
  void main() {
    int indices[${i}];
    toVec(TexCoords, indices);
    vec4 result = vec4(process(indices));
    ${a.output} = result;
  }
  `}var jd$1,Yd$1,we$1=L(()=>{jd$1={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},Yd$1={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"}}),ae=L(()=>{});async function mi$1(e,i=o=>0,a){return new Promise((o,c)=>{let s=0,d=()=>{if(e()){o();return}s++;let $=i(s);if(a!=null&&s>=a){c();return}setTimeout(d,$)};d()})}function Yn$1(e){return Fr(typeof e<"u"&&e.length!==0,()=>"empty string found for sampler name"),"get"+e.charAt(0).toUpperCase()+e.slice(1)}function Gu$1(e){return Fr(typeof e<"u"&&e.length!==0,()=>"empty string found for sampler name"),"get"+e.charAt(0).toUpperCase()+e.slice(1)+"AtOutCoords"}function $r(e,i){let a=JSON.parse(JSON.stringify(e));return a=i,a}function kr$1(e,i){return i.map(a=>e[a]).join(", ")}function Qe(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function Dt$1(e=6){return["x","y","z","w","u","v"].slice(0,e)}var Bt$1=L(()=>{fe$1()});function Xd$1(e,i){return Dt$1(i).map(a=>`${e}.${a}`)}function Br$1(e,i){return i===1?[e]:Xd$1(e,i)}function Nt(){return`
    float getChannel(vec4 frag, int dim) {
      int modCoord = imod(dim, 2);
      return modCoord == 0 ? frag.r : frag.g;
    }

    float getChannel(vec4 frag, vec2 innerDims) {
      vec2 modCoord = mod(innerDims, 2.);
      return modCoord.x == 0. ?
        (modCoord.y == 0. ? frag.r : frag.g) :
        (modCoord.y == 0. ? frag.b : frag.a);
    }
  `}var Tr=L(()=>{Bt$1()});function Jd(e,i,a){if(e===0)return"false";if(e===1)return`rc > ${i[0]}`;let o="";for(let c=e-2;c<e;c++)o+=`${a[c]} >= ${i[c-e+2]}`,c<e-1&&(o+="||");return o}function Zd(e,i){let a=e.length;if(a===0)return"getA(), 0, 0, 0";if(a===1)return`getA(rc),
            rc + 1 >= ${e[0]} ? 0. : getA(rc + 1),
            0, 0`;let o="r, c",c="r, cp1",s="rp1, c",d="rp1, cp1",$="";if(a>2)for(let et=0;et<a-2;++et)$=$+`${i[et]},`;return`getA(${$}${o}),
          rEdge ? 0. : getA(${$}${s}),
          cEdge ? 0. : getA(${$}${c}),
          rEdge || cEdge ? 0. : getA(${$}${d})`}function Qd(e,i,a,o){return e===0||e===1?"":`
    int r = ${i[e-2]};
    int c = ${i[e-1]};
    int rp1 = ${i[e-2]} + 1;
    int cp1 = ${i[e-1]} + 1;
    bool rEdge = rp1 >= ${o};
    bool cEdge = cp1 >= ${a};
    `}var Uu$1,Kd$1,zu$1,Vu$1=L(()=>{we$1(),ae(),Bt$1(),Tr(),Uu$1={name:"pack",inputNames:["A"],inputTypes:[1]},Kd$1=(e,i)=>{let a=H(e.session.backend.glContext.version),o=i.dims,c=o.length,s=i.dims.length,d=Qe(s),$=Br$1("rc",s),et=Qd(s,$,o[o.length-2],o[o.length-1]),h;c===0?h=[1,1]:c===1?h=[o[0],1]:h=[o[s-1],o[s-2]];let b=Jd(s,h,$),g=Zd(o,$),st=`
        void main() {
          ${d} rc = getOutputCoords();

          if(${b}) {
            ${a.output} = vec4(0);
          } else {
            ${et}

            ${a.output} = vec4(${g});
          }
        }
      `;return{...Uu$1,hasMain:!0,output:{dims:i.dims,type:i.type,textureType:2},shaderSource:st}},zu$1=(e,i)=>({...Uu$1,get:()=>Kd$1(e,i)})});function bi(e){if(e.length===0)return[1,1,1];let i=1;for(let a=0;a<e.length-2;++a)i*=e[a];return[i,e.length>1?e[e.length-2]:1,e[e.length-1]]}function Hu$1(e,i){let a=!1;return e.length===0||i.length===0?a=!0:e.length<2||i.length<2?a=e[e.length-1]===i[i.length-1]:a=e[e.length-1]===i[i.length-1]&&e[e.length-2]===i[i.length-2],a}function rh(e){let i=U$1.computeStrides(e),a=["b","r","c"],o="index";return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${i.map((c,s)=>{let d=`int ${a[s]} = ${o} / ${c}`,$=s===i.length-1?`int ${a[s+1]} = ${o} - ${a[s]} * ${c}`:`index -= ${a[s]} * ${c}`;return`${d}; ${$};`}).join("")}
      return ivec3(b, r, c);
    }
  `}function nh(e){let i=U$1.computeStrides(e);return`
  int getFlattenedIndex(ivec3 coords) {
    // reverse y, z order
    return coords.x * ${i[0]} + coords.z * ${i[1]} + coords.y;
  }
`}var eh,th,Wu$1,qu$1=L(()=>{fe$1(),we$1(),ae(),Tr(),eh=e=>({name:"Reshape (packed)",inputTypes:[2],inputNames:["A"],cacheHint:`${e}`}),th=(e,i,a,o)=>{let c=i.dims,s=o,d="";for(let h=0;h<4;h++){let b="";switch(h){case 0:b="outputCoords = rc;";break;case 1:b="outputCoords = ivec3(rc.x, rc.y+1, rc.z);";break;case 2:b="outputCoords = ivec3(rc.x, rc.y, rc.z+1);";break;case 3:b="outputCoords = ivec3(rc.x, rc.y+1, rc.z+1);";break;default:throw new Error}d+=`
        ${b}
        ${h>0?"if(outputCoords.y < rows && outputCoords.z < cols){":""}
          int flattenedIndex = getFlattenedIndex(outputCoords);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flattenedIndex);
          vec2 innerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${h}] = getChannel(getA(inputRC.x, inputRC.y, inputRC.z), innerDims);

        ${h>0?"}":""}
      `}let $=H(e.session.backend.glContext.version),et=`
      ${rh(c)}
      ${nh(s)}
      ${Nt()}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.0);

        ivec3 outputCoords;
        int rows = ${s[2]};
        int cols = ${s[1]};

        ${d}
        ${$.output} = result;
      }
    `;return{...a,output:{dims:s,type:i.type,textureType:2},shaderSource:et,hasMain:!0}},Wu$1=(e,i,a)=>{let o=eh(a);return{...o,get:()=>th(e,i,o,a)}}}),gi,ju$1=L(()=>{we$1(),ae(),gi=(e,i)=>{let a=i.shape,o=H(e.session.backend.glContext.version),c=`
    const float FLOAT_MAX = 1.70141184e38;
    const float FLOAT_MIN = 1.17549435e-38;

    bool isNaN(float val) {
      return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;
    }

    highp vec4 encodeAsUint8(highp float v) {
      if (isNaN(v)) {
        return vec4(255, 255, 255, 255);
      }

      highp float av = abs(v);

      if(av < FLOAT_MIN) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      } else if(v > FLOAT_MAX) {
        return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
      } else if(v < -FLOAT_MAX) {
        return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
      }

      highp vec4 c = vec4(0,0,0,0);

      highp float e = floor(log2(av));
      highp float m = exp2(fract(log2(av))) - 1.0;

      c[2] = floor(128.0 * m);
      m -= c[2] / 128.0;
      c[1] = floor(32768.0 * m);
      m -= c[1] / 32768.0;
      c[0] = floor(8388608.0 * m);

      highp float ebias = e + 127.0;
      c[3] = floor(ebias / 2.0);
      ebias -= c[3] * 2.0;
      c[2] += floor(ebias) * 128.0;

      c[3] += 128.0 * step(0.0, -v);

      return c / 255.0;
    }

    void main() {
      float value = ${o.texture2D}(X,TexCoords).r;
      ${o.output} = encodeAsUint8(value);
    }`,s={name:"Uint8Encode",inputTypes:[0],inputNames:["X"],output:{dims:a,type:i.tensor.type,textureType:3},shaderSource:c,hasMain:!0};return e.executeProgram(s,[i.tensor])}});function ih(e,i){if(e===1)return"rc";let a="";for(let o=0;o<e;o++)a+=i[o],o<e-1&&(a+=",");return a}var Yu$1,oh,Xu$1,Ku$1=L(()=>{we$1(),ae(),Bt$1(),Tr(),Yu$1={name:"unpack",inputNames:["A"],inputTypes:[2]},oh=(e,i)=>{let a=i.dims.length,o=Br$1("rc",a),c=o.slice(-2),s=Qe(a),d=Nt(),$=i.dims.length===0?"":ih(a,o),et=a<=1?"rc":`vec2(${c.join(",")})`,h=H(e.session.backend.glContext.version),b=`
    ${d}
    void main() {
      ${s} rc = getOutputCoords();

       // Sample the texture with the coords to get the rgba channel value.
       vec4 packedInput = getA(${$});

       ${h.output} = vec4(getChannel(packedInput, ${et}), 0, 0, 0);
     }
   `;return{...Yu$1,hasMain:!0,output:{dims:i.dims,type:i.type,textureType:0},shaderSource:b}},Xu$1=(e,i)=>({...Yu$1,get:()=>oh(e,i)})}),Xn$1,un,Kn$1,ln=L(()=>{lt$1(),Xn$1=class{constructor(e,i=1){if(i===1)this.internalFormat=e.R32F,this.format=e.RED,this.textureType=e.FLOAT,this.channelSize=i;else if(i===4)this.internalFormat=e.RGBA32F,this.format=e.RGBA,this.textureType=e.FLOAT,this.channelSize=i;else throw new Error(`Invalid number of channels: ${i}`)}encode(e,i){let a,o;return e.constructor!==Float32Array&&(ce.warning("Encoder","data was not of type Float32; creating new Float32Array"),o=new Float32Array(e)),i*this.channelSize>e.length?(ce.warning("Encoder","Source data too small. Allocating larger array"),o=e,a=this.allocate(i*this.channelSize),o.forEach((c,s)=>a[s]=c)):(o=e,a=o),a}allocate(e){return new Float32Array(e*4)}decode(e,i){return this.channelSize===1?e.filter((a,o)=>o%4===0).subarray(0,i):e.subarray(0,i)}},un=class{constructor(e,i=1,a){if(i!==1&&i!==4)throw new Error(`Invalid number of channels: ${i}`);this.internalFormat=e.RGBA,this.format=e.RGBA,this.channelSize=i,this.textureType=a||e.FLOAT}encode(e,i){let a=e;return this.channelSize===1&&(ce.verbose("Encoder","Exploding into a larger array"),a=this.allocate(i),e.forEach((o,c)=>a[c*4]=o)),a}allocate(e){return new Float32Array(e*4)}decode(e,i){return this.channelSize===1?e.filter((a,o)=>o%4===0).subarray(0,i):e.subarray(0,i)}},Kn$1=class{constructor(e,i=1){if(this.channelSize=4,i===1)this.internalFormat=e.ALPHA,this.format=e.ALPHA,this.textureType=e.UNSIGNED_BYTE,this.channelSize=i;else if(i===4)this.internalFormat=e.RGBA,this.format=e.RGBA,this.textureType=e.UNSIGNED_BYTE,this.channelSize=i;else throw new Error(`Invalid number of channels: ${i}`)}encode(e,i){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}allocate(e){return new Uint8Array(e*this.channelSize)}decode(e,i){if(e instanceof Uint8Array)return e.subarray(0,i);throw new Error(`Invalid array type: ${e.constructor}`)}}}),fn,Ju$1,yi,Zu$1=L(()=>{fe$1(),ae(),fn=(e,i,a)=>{let o=a===0||a===1?1:4,c=a===2,s=a===1||a===2,d=a===4?i.length-1:void 0,$=a===4?i.map((et,h)=>h===i.length-1?et*4:et):void 0;return yi(e,i,o,$,{isPacked:c,reverseWH:s,breakAxis:d})},Ju$1=(e,i,a)=>{let o=fn(e,i,a);return[o.width,o.height]},yi=(e,i,a=1,o,c)=>{let s=!!(c&&c.isPacked),[d,$]=e.computeTextureWH(s&&o||i,c),et=i.length,h=i.slice(0);if(et===0&&(h=[1]),a===1)o=i;else if(s){if(a!==4)throw new Error("a packed texture must be 4-channel");o=i,et>0&&(h[et-1]=Math.ceil(h[et-1]/2)),et>1&&(h[et-2]=Math.ceil(h[et-2]/2))}else if(!o)throw new Error("Unpacked shape is needed when using channels > 1");return{width:d,height:$,channels:a,isPacked:s,shape:h,strides:U$1.computeStrides(h),unpackedShape:o,reversedWH:c&&c.reverseWH}}}),sh,Jn$1,el$1=L(()=>{lt$1(),yr(),fe$1(),Vu$1(),qu$1(),ju$1(),Ku$1(),ln(),Zu$1(),ae(),sh=(e,i)=>{let a=i.map(c=>`${c.unpackedShape.join(",")};${c.width}x${c.height}`).join("_"),o=e.name;return e.cacheHint&&(o+="["+e.cacheHint+"]"),o+=":"+a,o},Jn$1=class{constructor(e){this.session=e,this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map}calculateTextureWidthAndHeight(e,i){return Ju$1(this.session.layoutStrategy,e,i)}executeProgram(e,i){if(i.length<e.inputNames.length)throw new Error(`Input size mustn't be less than ${e.inputNames.length}.`);if(e.inputNames.length!==e.inputTypes.length)throw new Error("input names size does not match input types");let a=[];for(let et=0;et<e.inputNames.length;++et)a[et]=this.getOrCreateTextureData(i[et],e.inputTypes[et]);let o=sh(e,a),c=this.session.programManager.getArtifact(o),s=c?c.programInfo:typeof e.get=="function"?e.get():e,d=fn(this.session.layoutStrategy,s.output.dims,s.output.textureType),$=this.createTextureData(d,s.output.type);return c||(c=this.session.programManager.build(s,a,$),this.session.programManager.setArtifact(o,c)),this.runProgram(c,a,$),$}run(e,i){return this.executeProgram(e,i).tensor}runProgram(e,i,a){for(let o=0;o<i.length;++o)if(!!i[o].isPacked!=(e.programInfo.inputTypes[o]===2))throw new Error(`input[${o}] property packed inconsistent`);if(!!a.isPacked!=(e.programInfo.output.textureType===2))throw new Error("output property packed inconsistent");this.session.programManager.run(e,i,a)}getOrCreateTextureData(e,i){let a=this.getTextureData(e.dataId,i===2);if(!a&&(a=this.getTextureData(e.dataId,i!==2),a))return i===2?this.pack(a):this.unpack(a);if(!a){let o=fn(this.session.layoutStrategy,e.dims,i);if(i===4){let c=e.dims;if(c.length===4){let s=[c[0],Math.ceil(c[1]*c[2]*c[3]/4)],d=fn(this.session.layoutStrategy,s,i),$=e.numberData;if(c[1]*c[2]*c[3]%4!==0){let et=c[0],h=c[1]*c[2]*c[3],b=Math.ceil(h*1/4)*4,g=et*b;$=new Float32Array(g);for(let st=0;st<et;++st){let $t=st*h,vt=st*b+st%1*h;$.set(e.numberData.subarray($t,$t+h),vt)}}return this.createTextureData(d,e.type,$,e,1)}}if(i===2){let c=yi(this.session.layoutStrategy,e.dims,1,[],{reverseWH:!0}),s=this.createTextureData(c,e.type,e.numberData,e,1);a=this.pack(s)}else a=this.createTextureData(o,e.type,e.numberData,e,1)}return a}createTextureDataFromLayoutBindTensor(e,i,a,o){return this.createTextureData(e,i,a,o,1)}createTextureData(e,i,a,o,c){ce.verbose("InferenceHandler",`Creating TextureData: layout:[${JSON.stringify(e)}]`);let s=this.session.textureManager.createTextureFromLayout(i,e,a,c);return this.createTextureDataFromTexture(e,i,s,o)}reshapeUnpacked(e,i){let a=this.getOrCreateTextureData(e,0),o={channels:a.channels,height:a.height,width:a.width,shape:i.length!==0?i:[1],strides:U$1.computeStrides(i),unpackedShape:i};return this.createTextureDataFromTexture(o,e.type,a.texture).tensor}reshapePacked(e,i){let a=this.getOrCreateTextureData(e,2);if(Hu$1(e.dims,i)){let $={channels:a.channels,height:a.height,width:a.width,shape:i.length!==0?i:[1],strides:U$1.computeStrides(i),unpackedShape:i,isPacked:!0};return this.createTextureDataFromTexture($,e.type,a.texture).tensor}let o=bi(e.dims),c=bi(i),s=this.reshapePacked(e,o),d=this.run(Wu$1(this,s,c),[s]);return this.reshapePacked(d,i)}cast(e,i){let a=this.getOrCreateTextureData(e,0);return this.createTextureDataFromTexture(a,i,a.texture).tensor}createTextureDataFromTexture(e,i,a,o,c){let s={...e,tensor:o||new $e(e.unpackedShape,i,d=>this.readTexture(s),async d=>this.readTextureAsync(s),void 0,c),texture:a};return this.setTextureData(s.tensor.dataId,s,e.isPacked),s}getTextureData(e,i=!1){return this.session.isInitializer(e)?this.session.getTextureData(e,i):i?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e)}setTextureData(e,i,a=!1){this.session.isInitializer(e)?this.session.setTextureData(e,i,a):(a?this.packedTextureDataCache:this.unpackedTextureDataCache).set(e,i)}isTextureLayoutCached(e,i=!1){return!!this.getTextureData(e.dataId,i)}dispose(){this.session.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(e=>this.session.textureManager.releaseTexture(e)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(e=>this.session.textureManager.releaseTexture(e)),this.unpackedTextureDataCache=new Map}readTexture(e){return e.isPacked?this.readTexture(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTexture(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat(gi(this,e))}async readTextureAsync(e){return e.isPacked?this.readTextureAsync(this.unpack(e)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTextureAsync(e,e.tensor.type,e.channels):this.session.textureManager.readUint8TextureAsFloat(gi(this,e))}pack(e){return this.executeProgram(zu$1(this,e.tensor),[e.tensor])}unpack(e){return this.executeProgram(Xu$1(this,e.tensor),[e.tensor])}}}),Ti,Q,Ue$1=L(()=>{Ti=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(e=>`${this[e]}`).join(";")),this.key}},Q=e=>new Ti(e)}),tl$1,rl$1,nl$1,uh,lh,ol$1=L(()=>{Ue$1(),we$1(),ae(),tl$1={name:"BatchNormalization",inputNames:["A","Scale","B","Mean","Variance"],inputTypes:[0,0,0,0,0]},rl$1=(e,i,a)=>(lh(i),[e.run({...tl$1,cacheHint:a.cacheKey,get:()=>uh(e,i,a)},i)]),nl$1=e=>{let i=e.attributes.getFloat("epsilon",1e-5),a=e.attributes.getFloat("momentum",.9),o=e.attributes.getInt("spatial",1);return Q({epsilon:i,momentum:a,spatial:o})},uh=(e,i,a)=>{let o=H(e.session.backend.glContext.version),c=i[0].dims.length,[s,d]=e.calculateTextureWidthAndHeight(i[1].dims,0),$=`
  float process(int[${c}] indices) {
    vec2 position = offsetToCoords(indices[1], ${s}, ${d});
    float scale = getColorAsFloat(${o.texture2D}(Scale, position));
    float mean = getColorAsFloat(${o.texture2D}(Mean, position));
    float variance = getColorAsFloat(${o.texture2D}(Variance, position));
    float b = getColorAsFloat(${o.texture2D}(B, position));

    return scale * ( (_A(indices) - mean) / sqrt(variance + float(${a.epsilon})) ) + b;
  }`;return{...tl$1,output:{dims:i[0].dims,type:i[0].type,textureType:0},shaderSource:$}},lh=e=>{if(!e||e.length!==5)throw new Error("BatchNormalization requires 5 inputs.");let i=e[0],a=e[1],o=e[2],c=e[3],s=e[4];if(i.dims.length<3||a.dims.length!==1||o.dims.length!==1||c.dims.length!==1||s.dims.length!==1)throw new Error("invalid input shape.");if(a.dims[0]!==i.dims[1]||o.dims[0]!==i.dims[1]||c.dims[0]!==i.dims[1]||s.dims[0]!==i.dims[1])throw new Error("invalid input shape.");if(i.type!=="float32"&&i.type!=="float64"||a.type!=="float32"&&a.type!=="float64"||o.type!=="float32"&&o.type!=="float64"||c.type!=="float32"&&c.type!=="float64"||s.type!=="float32"&&s.type!=="float64")throw new Error("invalid input tensor types.")}}),Zn$1,dt,R,cn,Qn$1,Wt$1=L(()=>{Zn$1=class{constructor(e,i,a,o){this.glContext=e,this.programInfo=i,this.inputTextureLayouts=a,this.outputTextureLayout=o}},dt=class{constructor(e){this.context=e}},R=class{constructor(e,i){this.routineBody=e,this.dependencies=i}},cn=class{constructor(e,i,a){this.name=e,a?this.dependencies=a:this.dependencies=[],i&&(this.routineBody=i)}addDependency(e){e&&this.dependencies.push(e)}},Qn$1=class{static returnOrderedNodes(e){if(!e||e.length===0)return[];if(e.length===1)return e;let i=new Set,a=new Set,o=new Array;return this.createOrderedNodes(e,i,a,o),o}static createOrderedNodes(e,i,a,o){for(let c=0;c<e.length;++c)this.dfsTraverse(e[c],i,a,o)}static dfsTraverse(e,i,a,o){if(!e||a.has(e.name))return;if(i.has(e.name))throw new Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");i.add(e.name);let c=e.dependencies;if(c&&c.length>0)for(let s=0;s<c.length;++s)this.dfsTraverse(c[s],i,a,o);o.push(e),a.add(e.name),i.delete(e.name)}}});function ch(){let e="add_";return{body:`
  float ${e}(float a, float b) {
    return a + b;
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return v1 + v2;
  }
  `,name:e,type:0}}function ph(){let e="div_";return{body:`
  float ${e}(float a, float b) {
    return a / b;
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return v1 / v2;
  }
  `,name:e,type:0}}function dh(){let e="mul_";return{body:`
  float ${e}(float a, float b) {
    return a * b;
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return v1 * v2;
  }
  `,name:e,type:0}}function hh(){let e="sub_";return{body:`
  float ${e}(float a, float b) {
    return a - b;
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return v1 - v2;
  }
  `,name:e,type:0}}function mh(){let e="equal_";return{body:`
  float ${e}(float a, float b) {
    return float(a == b);
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return vec4(equal(v1, v2));
  }
  `,name:e,type:0}}function bh(){let e="greater_";return{body:`
  float ${e}(float a, float b) {
    return float(a > b);
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return vec4( v1.r > v2.r ,
      v1.g > v2.g,
      v1.b > v2.b,
      v1.a > v2.a );
  }
  `,name:e,type:0}}function gh(){let e="less_";return{body:`
  float ${e}(float a, float b) {
    return float(a < b);
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return vec4( v1.r < v2.r ,
                v1.g < v2.g,
                v1.b < v2.b,
                v1.a < v2.a );
  }
  `,name:e,type:0}}function yh(){let e="and_";return{body:`
  float ${e}(float a, float b) {
    return float( bool(a) && bool(b) );
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r && b2.r ,
                b1.g && b2.g,
                b1.b && b2.b,
                b1.a && b2.a );
  }
  `,name:e,type:0}}function Th(){let e="or_";return{body:`
  float ${e}(float a, float b) {
    return float( bool(a) || bool(b) );
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r || b2.r ,
                b1.g || b2.g,
                b1.b || b2.b,
                b1.a || b2.a );
  }
  `,name:e,type:0}}function xh(){let e="xor_";return{body:`
  float ${e}(float a, float b) {
    return float( bool(a) ^^ bool(b) );
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r ^^ b2.r ,
                b1.g ^^ b2.g,
                b1.b ^^ b2.b,
                b1.a ^^ b2.a );
  }
  `,name:e,type:0}}function wh(){return _h("pow")}function vh(){let e="prelu_";return{body:`
  float ${e}(float a, float b) {
    return a < 0.0 ? a * b: a;
  }
  vec4 ${e}(vec4 v1, vec4 v2) {
    return vec4(
      v1.r < 0.0 ? v1.r * v2.r: v1.r,
      v1.g < 0.0 ? v1.g * v2.g: v1.g,
      v1.b < 0.0 ? v1.b * v2.b: v1.b,
      v1.a < 0.0 ? v1.a * v2.a: v1.a
      );
  }
  `,name:e,type:0}}function _h(e){let i=`${e}_`;return{body:`
  float ${i}(float a, float b) {
    return ${e}(a, b);
  }
  vec4 ${i}(vec4 v1, vec4 v2) {
    return ${e}(v1, v2);
  }
  `,name:i,type:0}}var ht,Oh,il$1,al$1,sl$1,ul$1,ll$1,fl$1,cl$1,pl$1,dl$1,hl$1,ml$1,bl$1,gl$1=L(()=>{fe$1(),Wt$1(),we$1(),ae(),ht=(e,i,a,o=i[0].type,c)=>{let s=e.session.pack?2:0;return{name:a.name,inputNames:["A","B"],inputTypes:[s,s],cacheHint:c,get:()=>Oh(e,i,a,o)}},Oh=(e,i,a,o=i[0].type)=>{let c=e.session.pack?2:0,s=!U$1.areEqual(i[0].dims,i[1].dims),d=i[0].dims,$=e.session.pack;if(s){let b=Ze$1.calcShape(i[0].dims,i[1].dims,!1);if(!b)throw new Error("Can't perform binary op on the given tensors");d=b;let g=d.length,st=i[0].dims.length!==0?i[0].dims.length:1,$t=i[1].dims.length!==0?i[1].dims.length:1,vt=i[0].dims.length!==0?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",Ft=i[1].dims.length!==0?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",Gt=H(e.session.backend.glContext.version),qt=$?`
      ${a.body}
      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();
        vec4 result = ${a.name}(a, b);
        ${Gt.output} = result;
      }`:`
      ${a.body}
      float process(int indices[${g}]) {
        int aindices[${st}];
        int bindices[${$t}];
        ${vt}
        ${Ft}
        return ${a.name}(_A(aindices), _B(bindices));
      }`;return{name:a.name,inputNames:["A","B"],inputTypes:[c,c],output:{dims:d,type:o,textureType:c},shaderSource:qt,hasMain:$}}let et=H(e.session.backend.glContext.version),h=`
    ${a.body}
    void main() {
      vec4 v1 = ${et.texture2D}(A, TexCoords);
      vec4 v2 = ${et.texture2D}(B, TexCoords);
      vec4 result = ${a.name}(v1, v2);
      ${et.output} = result;
    }
    `;return{name:a.name,inputNames:["A","B"],inputTypes:[c,c],output:{dims:i[0].dims,type:o,textureType:c},shaderSource:h,hasMain:!0}},il$1=(e,i)=>[e.run(ht(e,i,ch()),i)],al$1=(e,i)=>[e.run(ht(e,i,yh(),"bool"),i)],sl$1=(e,i)=>[e.run(ht(e,i,ph()),i)],ul$1=(e,i)=>[e.run(ht(e,i,mh(),"bool"),i)],ll$1=(e,i)=>[e.run(ht(e,i,bh(),"bool"),i)],fl$1=(e,i)=>[e.run(ht(e,i,gh(),"bool"),i)],cl$1=(e,i)=>[e.run(ht(e,i,dh()),i)],pl$1=(e,i)=>[e.run(ht(e,i,Th(),"bool"),i)],dl$1=(e,i)=>[e.run(ht(e,i,wh()),i)],hl$1=(e,i)=>[e.run(ht(e,i,vh()),i)],ml$1=(e,i)=>[e.run(ht(e,i,hh()),i)],bl$1=(e,i)=>[e.run(ht(e,i,xh(),"bool"),i)]}),yl$1,Tl$1,Sh,xl$1=L(()=>{fe$1(),yl$1=(e,i,a)=>(Sh(i),[e.cast(i[0],a)]),Tl$1=e=>We$1.tensorDataTypeFromProto(e.attributes.getInt("to")),Sh=e=>{if(!e||e.length!==1)throw new Error("Cast requires 1 input.");if(e[0].type==="string")throw new Error("Invalid input type.")}}),Ah,Ph,wl$1,eo$1,vl$1=L(()=>{we$1(),ae(),Bt$1(),Tr(),Ah=(e,i)=>({name:"Concat (packed)",inputNames:Array.from({length:e},(a,o)=>`X${o}`),inputTypes:Array(e).fill(2),cacheHint:i}),Ph=(e,i,a,o)=>{let c=a[0].dims.slice();if(o>=c.length||o<-1*c.length)throw new Error("axis specified for concat doesn't match input dimensionality");o<0&&(o=c.length+o);let s=c.slice(0);for(let Hr=1;Hr<a.length;Hr++){let wn=a[Hr].dims.slice();for(let _n=0;_n<c.length;_n++)if(_n===o)s[o]+=wn[_n];else if(c[_n]!==wn[_n])throw new Error("non concat dimensions must match")}let d=s.length,$=Br$1("coords",d),et=Qe(d),h=Nt(),b=a.map(Hr=>Hr.dims),g=Dt$1(d),st=new Array(b.length-1);st[0]=b[0][o];for(let Hr=1;Hr<st.length;Hr++)st[Hr]=st[Hr-1]+b[Hr][o];let $t=g[o],vt=g.slice(-2),Ft=g.join(),Gt=`if (${$t} < ${st[0]}) {
        return getChannel(
            getX0(${Ft}), vec2(${vt.join()}));
        }`;for(let Hr=1;Hr<st.length;Hr++){let wn=st[Hr-1];Gt+=`
            if (${$t} < ${st[Hr]}  && ${$t} >= ${st[Hr-1]}) {
              return getChannel(
                getX${Hr}(${eo$1(g,$t,wn)}),
                vec2(${eo$1(vt,$t,wn)}));
            }`}let qt=st.length,Lt=st[st.length-1];Gt+=`
            return getChannel(
              getX${qt}(${eo$1(g,$t,Lt)}),
              vec2(${eo$1(vt,$t,Lt)}));`;let rr=H(e.session.backend.glContext.version),jr=`
          ${h}
          float getValue(${g.map(Hr=>"int "+Hr)}) {
            ${Gt}
          }

          void main() {
            ${et} coords = getOutputCoords();
            int lastDim = coords.${g[d-1]};
            coords.${g[d-1]} = coords.${g[d-2]};
            coords.${g[d-2]} = lastDim;

            vec4 result = vec4(getValue(${$}), 0., 0., 0.);

            ${$[d-1]} = ${$[d-1]} + 1;
            if (${$[d-1]} < ${s[d-1]}) {
              result.g = getValue(${$});
            }

            ${$[d-2]} = ${$[d-2]} + 1;
            if (${$[d-2]} < ${s[d-2]}) {
              result.a = getValue(${$});
            }

            ${$[d-1]} = ${$[d-1]} - 1;
            if (${$[d-2]} < ${s[d-2]} &&
                ${$[d-1]} < ${s[d-1]}) {
              result.b = getValue(${$});
            }
            ${rr.output} = result;
          }
        `;return{...i,output:{dims:s,type:a[0].type,textureType:2},shaderSource:jr,hasMain:!0}},wl$1=(e,i,a)=>{let o=Ah(i.length,a.cacheKey);return{...o,get:()=>Ph(e,o,i,a.axis)}},eo$1=(e,i,a)=>{let o=e.indexOf(i);return e.map((c,s)=>s===o?`${c} - ${a}`:c).join()}}),_l$1,Eh,Dh,Lh,Ol$1,Ch,Fh,$h,Il$1,kh,Sl$1=L(()=>{Ue$1(),ae(),vl$1(),_l$1=(e,i,a)=>(kh(i),e.session.pack&&i[0].dims.length>1?[e.run(wl$1(e,i,a),i)]:[e.run(Lh(e,i,a),i)]),Eh=(e,i)=>({name:"Concat",inputNames:Array.from({length:e},(a,o)=>`X${o}`),inputTypes:Array(e).fill(0),cacheHint:i}),Dh=(e,i,a,o)=>{let c=a[0].dims.slice();if(o>=c.length||o<-1*c.length)throw new Error("axis specified for concat doesn't match input dimensionality");o<0&&(o=c.length+o);let s=c.slice(0);for(let $t=1;$t<a.length;$t++){let vt=a[$t].dims.slice();for(let Ft=0;Ft<c.length;Ft++)if(Ft===o)s[o]+=vt[Ft];else if(c[Ft]!==vt[Ft])throw new Error("non concat dimensions must match")}let d=s.length,$=new Array(a.length),et=0;for(let $t=0;$t<$.length;++$t)et+=a[$t].dims[o],$[$t]=et;let h="";a.length<5?h=Ol$1($):h=Ch($);let b=Fh(a.length,d),g=$h($),st=`
        ${b}
        ${g}
        ${h}
        float process(int indices[${d}]) {
          int textureIndex = getTextureWhereDataResides (indices[${o}]);

          if(textureIndex != 0) {
            indices[${o}] = indices[${o}] - int(getSizeInConcatAxisValueFromIndex(textureIndex-int(1)));
          }

          return fetchDataFromCorrectTexture(textureIndex, indices);
        }`;return{...i,output:{dims:s,type:a[0].type,textureType:0},shaderSource:st}},Lh=(e,i,a)=>{let o=Eh(i.length,a.cacheKey);return{...o,get:()=>Dh(e,o,i,a.axis)}},Ol$1=e=>`int getTextureWhereDataResides(int index) {
      ${e.map((i,a)=>`if(index<${i}) {return ${a};}
`).join("")}
    }`,Ch=e=>Ol$1(e),Fh=(e,i)=>{let a=[`float fetchDataFromCorrectTexture(int textureIndex, int indices[${i}]) {`];for(let o=0;o<e;++o)o===0?a.push(`	if (textureIndex == ${o}) { return _X${o}(indices); }`):o===e-1?a.push(`	else { return _X${o}(indices); }`):a.push(`	else if (textureIndex == ${o}) { return _X${o}(indices); }`);return a.push("	}"),a.join(`
`)},$h=e=>{let i=["int getSizeInConcatAxisValueFromIndex(int index) {"];for(let a=0;a<e.length;++a)a===0?i.push(`	if (index == ${a}) { return ${e[a]}; }`):a===e.length-1?i.push(`	else { return ${e[a]}; }`):i.push(`	else if (index == ${a}) { return ${e[a]}; }`);return i.push("	}"),i.join(`
`)},Il$1=e=>Q({axis:e.attributes.getInt("axis")}),kh=e=>{if(!e||e.length<1)throw new Error("too few inputs");let i=e[0].type,a=e[0].dims.length;if(i==="string")throw new Error("string tensor is not supported yet");for(let o of e){if(o.type!==i)throw new Error("input tensors should be one type");if(o.dims.length!==a)throw new Error("input tensors should have the same shape")}}});function Bh(){return mt("abs")}function Nh(){return mt("acos")}function Rh(){return mt("asin")}function Mh(){return mt("atan")}function Gh(){return mt("ceil")}function Uh(){return mt("cos")}function zh(e){let i="elu";return{body:`
  const float alpha = float(${e});

  float ${i}_(float a) {
    return a >= 0.0 ? a: (exp(a) - 1.0) * alpha;
  }
  vec4 ${i}_(vec4 v) {
    return vec4(${i}_(v.x), ${i}_(v.y), ${i}_(v.z), ${i}_(v.w));
  }
  `,name:i,type:0}}function Vh(){return mt("exp")}function Wh(){return mt("floor")}function xi(e,i){let a="clip";return{body:`
  const float min = float(${e});
  const float max = float(${i});

  float ${a}_(float a) {
    return clamp(a, min, max);
  }
  vec4 ${a}_(vec4 v) {
    return clamp(v, min, max);
  }
  `,name:a,type:0}}function Hh(){let e="indentity";return{body:`
  float ${e}_(float a) {
    return a;
  }
  vec4 ${e}_(vec4 v) {
    return v;
  }
  `,name:e,type:0}}function qh(e){let i="leakyRelu";return{body:`
  const float alpha = float(${e});

  float ${i}_(float a) {
    return a < 0.0 ? a * alpha : a;
  }
  vec4 ${i}_(vec4 v) {
    return vec4(${i}_(v.x), ${i}_(v.y), ${i}_(v.z), ${i}_(v.w));
  }
  `,name:i,type:0}}function jh(){return mt("log")}function Yh(){let e="neg";return{body:`
  float ${e}_(float a) {
    return -a;
  }
  vec4 ${e}_(vec4 v) {
    return -v;
  }
  `,name:e,type:0}}function Xh(){let e="not";return{body:`
  float ${e}_(float a) {
    return float( ! bool(a) );
  }
  bool ${e}_(bool a) {
    return !a;
  }
  vec4 ${e}_(vec4 v) {
    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));
  }
  bvec4 ${e}_(bvec4 v) {
    return bvec4(!v.x, !v.y, !v.z, !v.w);
  }
  `,name:e,type:0}}function Kh(){return mt("sin")}function wi(){let e="relu";return{body:`
  float ${e}_(float a) {
    return max( a, 0.0 );
  }
  vec4 ${e}_(vec4 v) {
    return max( v, 0.0 );
  }
  `,name:e,type:0}}function vi(){let e="sigmoid";return{body:`
  float ${e}_(float a) {
    return 1.0 / (1.0 + exp(-a));
  }
  vec4 ${e}_(vec4 v) {
    return 1.0 / (1.0 + exp(-v));
  }
  `,name:e,type:0}}function Jh(){return mt("sqrt")}function Zh(){return mt("tan")}function Qh(){let e="tanh";return{body:`
  float ${e}_(float a) {
    a = clamp(a, -10., 10.);
    a = exp(2.*a);
    return (a - 1.) / (a + 1.);
  }
  vec4 ${e}_(vec4 v) {
    v = clamp(v, -10., 10.);
    v = exp(2.*v);
    return (v - 1.) / (v + 1.);
  }
  `,name:e,type:0}}function mt(e){return{body:`
  float ${e}_(float a) {
    return ${e}(a);
  }
  vec4 ${e}_(vec4 v) {
    return ${e}(v);
  }
  `,name:e,type:0}}var em$1,Ee,Al$1,Pl$1,El$1,Dl$1,_i,Ll$1,Cl$1,tm$1,Fl$1,$l$1,kl$1,Bl$1,Nl$1,Rl$1,Oi$1,Ml$1,Gl$1,Ul$1,zl$1,Vl$1,Wl$1,Hl$1,ql$1,jl$1,Yl$1,Xl$1,Ii=L(()=>{Ue$1(),fe$1(),Wt$1(),we$1(),ae(),em$1=(e,i,a,o)=>{let c=e.session.pack?2:0,s=H(e.session.backend.glContext.version);return{...i,output:{dims:a.dims,type:a.type,textureType:c},shaderSource:`
     ${o.body}
     void main() {
       vec4 v = ${s.texture2D}(A, TexCoords);
       v = ${o.name}_(v);
       ${s.output} = v;
     }
     `,hasMain:!0}},Ee=(e,i,a,o)=>{let c=e.session.pack?2:0,s={name:a.name,inputTypes:[c],inputNames:["A"],cacheHint:o};return{...s,get:()=>em$1(e,s,i,a)}},Al$1=(e,i)=>[e.run(Ee(e,i[0],Bh()),i)],Pl$1=(e,i)=>[e.run(Ee(e,i[0],Nh()),i)],El$1=(e,i)=>[e.run(Ee(e,i[0],Rh()),i)],Dl$1=(e,i)=>[e.run(Ee(e,i[0],Mh()),i)],_i=(e,i,a)=>[e.run(Ee(e,i[0],xi(a.min,a.max),a.cacheKey),i)],Ll$1=e=>Q({min:e.attributes.getFloat("min",br),max:e.attributes.getFloat("max",gr$1)}),Cl$1=(e,i)=>{let a=tm$1(e,i);return _i(e,[i[0]],a)},tm$1=(e,i)=>{if(i.length>=3&&(!e.session.isInitializer(i[1].dataId)||!e.session.isInitializer(i[2].dataId)))throw new Error("dynamic clip attributes are not allowed");let a=i.length>=3?i[1].numberData[0]:br,o=i.length>=3?i[2].numberData[0]:gr$1;return Q({min:a,max:o})},Fl$1=(e,i)=>[e.run(Ee(e,i[0],Gh()),i)],$l$1=(e,i)=>[e.run(Ee(e,i[0],Uh()),i)],kl$1=(e,i,a)=>[e.run(Ee(e,i[0],zh(a.alpha),a.cacheKey),i)],Bl$1=e=>Q({alpha:e.attributes.getFloat("alpha",1)}),Nl$1=(e,i)=>[e.run(Ee(e,i[0],Vh()),i)],Rl$1=(e,i)=>[e.run(Ee(e,i[0],Wh()),i)],Oi$1=(e,i)=>[e.run(Ee(e,i[0],Hh()),i)],Ml$1=(e,i,a)=>[e.run(Ee(e,i[0],qh(a.alpha),a.cacheKey),i)],Gl$1=e=>Q({alpha:e.attributes.getFloat("alpha",.01)}),Ul$1=(e,i)=>[e.run(Ee(e,i[0],jh()),i)],zl$1=(e,i)=>[e.run(Ee(e,i[0],Yh()),i)],Vl$1=(e,i)=>[e.run(Ee(e,i[0],Xh()),i)],Wl$1=(e,i)=>[e.run(Ee(e,i[0],wi()),i)],Hl$1=(e,i)=>[e.run(Ee(e,i[0],vi()),i)],ql$1=(e,i)=>[e.run(Ee(e,i[0],Kh()),i)],jl$1=(e,i)=>[e.run(Ee(e,i[0],Jh()),i)],Yl$1=(e,i)=>[e.run(Ee(e,i[0],Zh()),i)],Xl$1=(e,i)=>[e.run(Ee(e,i[0],Qh()),i)]});function Rt(e){let i;switch(e.activation){case"Relu":i=wi();break;case"Sigmoid":i=vi();break;case"Clip":i=xi(e.clipMin,e.clipMax);break;default:return{activationFunction:"",applyActivation:""}}let a=i.name,o=i.body,c=`value = ${a}_(value);`;return{activationFunction:o,applyActivation:c}}var Nr,xr=L(()=>{fe$1(),Ii(),Nr=e=>{let i=e.getString("activation","");if(i==="Clip"){let[a,o]=e.getFloats("activation_params",[br,gr$1]);return{activation:i,clipMax:o,clipMin:a,activationCacheKey:`${i}:${a},${o}`}}return{activation:i,activationCacheKey:i}}}),nm$1,om$1,Kl$1,Jl$1=L(()=>{lt$1(),we$1(),ae(),to$2(),xr(),nm$1=(e,i)=>({name:"GroupedConv",inputNames:e?["X","W","Bias"]:["X","W"],inputTypes:e?[0,0,0]:[0,0],cacheHint:i}),om$1=(e,i,a,o)=>{let c=i.length>2?"value += getBias(output_channel);":"",s=i[0].dims.slice(),d=i[1].dims.slice(),$=d[0]/o.group;ce.verbose("GroupedConv",`autpPad:${o.autoPad}, dilations:${o.dilations}, group:${o.group}, kernelShape:${o.kernelShape}, pads:${o.pads}, strides:${o.strides}`);let et=Rr$1(s,d,o.dilations,o.pads,o.strides),h=H(e.session.backend.glContext.version),{activationFunction:b,applyActivation:g}=Rt(o),st=`
  const ivec2 strides = ivec2(${o.strides[0]}, ${o.strides[1]});
  const ivec2 pads = ivec2(${o.pads[0]}, ${o.pads[1]});
  ${b}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;
    ivec2 xRCCorner = coords.zw * strides - pads;
    int group_id = output_channel / ${$};

    float value = 0.0;
    for (int wInChannel = 0; wInChannel < ${d[1]}; wInChannel++) {
      int input_channel = group_id * ${d[1]} + wInChannel;
      for (int wHeight = 0; wHeight < ${d[2]}; wHeight++) {
        int xHeight = xRCCorner.x + wHeight * ${o.dilations[0]};

        if (xHeight < 0 || xHeight >= ${s[2]}) {
          continue;
        }

        for (int wWidth = 0; wWidth < ${d[3]}; wWidth++) {
          int xWidth = xRCCorner.y + wWidth * ${o.dilations[1]};
          if (xWidth < 0 || xWidth >= ${s[3]}) {
            continue;
          }

          float xVal = getX(batch, input_channel, xWidth, xHeight);
          float wVal = getW(output_channel, wInChannel, wWidth, wHeight);
          value += xVal*wVal;
        }
      }
    }
    ${c}
    ${g}
    ${h.output} = vec4(value, .0, .0, .0);
  }
`;return{...a,output:{dims:et,type:i[0].type,textureType:0},shaderSource:st,hasMain:!0}},Kl$1=(e,i,a)=>{let o=nm$1(i.length>2,a.cacheKey);return{...o,get:()=>om$1(e,i,o,a)}}}),im$1,am$1,Zl$1,Ql$1=L(()=>{we$1(),ae(),Tr(),im$1=e=>({name:"Im2Col (packed)",inputNames:["A"],inputTypes:[2],cacheHint:e}),am$1=(e,i,a,o,c,s)=>{let d=a.dims,$=o.dims,et=2,h=3,b=c.length,g=[$[1]*$[2]*$[3],c[2]*c[3]],st=$[2]*$[3],$t=Nt(),vt=H(e.session.backend.glContext.version),Ft="";for(let qt=0;qt<=1;qt++)for(let Lt=0;Lt<=1;Lt++)Ft+=`
            blockIndex = rc.x + ${Lt};
            pos = rc.y + ${qt};

            if(blockIndex < ${g[1]} && pos < ${g[0]}) {
              offsetY = int(blockIndex / (${c[b-1]})) * ${s.strides[0]} -
                ${s.pads[0]};
              d0 = offsetY + ${s.dilations[0]} * (imod(pos, ${st}) / ${$[2]});

              if(d0 < ${d[et]} && d0 >= 0) {
                offsetX = imod(blockIndex, ${c[b-1]}) * ${s.strides[1]} -
                  ${s.pads[1]};
                d1 = offsetX + ${s.dilations[1]} * imod(imod(pos, ${st}), ${$[2]});

                if(d1 < ${d[h]} && d1 >= 0) {

                  ch = int(float(pos)/ ${st}.);
                    innerDims = vec2(d0, d1);
                    result[${qt*2+Lt}] = getChannel(
                      getA(0, ch, int(innerDims.x),
                      int(innerDims.y)), innerDims);
                }
              }
            }

          `;let Gt=`
      ${$t}

      void main() {
        ivec2 rc = getOutputCoords();
          vec4 result = vec4(0.0);
          int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
          vec2 innerDims;
          ${Ft}
          ${vt.output} = result;
      }
            `;return{...i,output:{dims:g,type:a.type,textureType:2},shaderSource:Gt,hasMain:!0}},Zl$1=(e,i,a,o,c)=>{let s=im$1(c.cacheKey);return{...s,get:()=>am$1(e,s,i,a,o,c)}}});function um$1(e,i,a){let o=i[0].dims,c=i[1].dims,s=Ze$1.calcShape(o,c,!0);if(!s)throw new Error("Can't use matmul on the given tensors");let d=Qe(s.length),$=Dt$1(),{activationFunction:et,applyActivation:h}=Rt(a),b=i.length>2,g=b?"value += getBiasForMatmul();":"",st=b?`${Ai(d,$,i[2].dims,s,!1)}`:"",$t=s.length,vt=o.length,Ft=c.length,Gt=o[o.length-1],qt=`
    ${et}
    ${st}
    float process(int indices[${$t}]) {
        int a[${vt}];
        int b[${Ft}];
        bcastMatmulIndices_A(indices, a);
        bcastMatmulIndices_B(indices, b);

        float value;
        for (int k=0; k<${Gt}; ++k) {
            a[${vt-1}] = k;
            b[${Ft-2}] = k;
            value += _A(a) * _B(b);
        }
        ${g}
        ${h}
        return value;
    }`;return{...e,output:{dims:s,type:i[0].type,textureType:0},shaderSource:qt}}function Si(e,i){let a=sm$1(e.length>2,i.activationCacheKey);return{...a,get:()=>um$1(a,e,i)}}function Ai(e,i,a,o,c){let s="",d=a.length,$=o.length,et=$-d;$<2&&d>0?s="coords":s=a.map((st,$t)=>`coords.${i[$t+et]}`).join(", ");let h=Ze$1.getBroadcastDims(a,o).map(st=>`coords.${i[st+et]} = 0;`).join(`
`),b=U$1.size(a)===1,g="vec4(outputValue.xx, outputValue.yy)";return b&&(g="vec4(outputValue.x)"),c?`
vec4 getBiasForMatmul() {
  ${e} coords = getOutputCoords();
  ${h}
  vec4 outputValue = getBias(${s});
  return ${g};
}`:`
float getBiasForMatmul() {
  ${e} coords = getOutputCoords();
  ${h}
  return getBias(coords.x);
}`}var ef$1,tf$1,sm$1,lm$1,ro$1=L(()=>{fe$1(),ae(),Bt$1(),xr(),Pi$1(),ef$1=(e,i,a)=>(lm$1(i),e.session.pack?[e.run(no$1(e,i,a),i)]:[e.run(Si(i,a),i)]),tf$1=e=>Nr(e.attributes),sm$1=(e,i)=>({name:"MatMul",inputNames:e?["A","B","Bias"]:["A","B"],inputTypes:e?[0,0,0]:[0,0],cacheHint:i}),lm$1=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.");if(e[0].type!=="float32"&&e[0].type!=="float64"||e[1].type!=="float32"&&e[1].type!=="float64")throw new Error("inputs should be float type");if(e[0].type!==e[1].type)throw new Error("inputs types should match")}});function pm$1(e,i,a,o){let c=[],s=[],d=a[0].dims,$=a[1].dims,et=d.length,h=$.length,b=o.length,g=b-et,st=b-h;c=d.map((Lt,rr)=>`coords.${i[rr+g]}`),c[et-1]="i*2",c.join(", "),s=$.map((Lt,rr)=>`coords.${i[rr+st]}`),s[h-2]="i*2",s.join(", ");let $t=Ze$1.getBroadcastDims(d,o),vt=Ze$1.getBroadcastDims($,o),Ft=$t.map(Lt=>`coords.${i[Lt+g]} = 0;`).join(`
`),Gt=vt.map(Lt=>`coords.${i[Lt+st]} = 0;`).join(`
`),qt=`int lastDim = coords.${i[b-1]};
  coords.${i[b-1]} = coords.${i[b-2]};
  coords.${i[b-2]} = lastDim;`;return`
vec4 getAAtOutCoordsMatmul(int i) {
  ${e} coords = getOutputCoords();
  ${qt}
  ${Ft}
  vec4 outputValue = getA(${c});
  return outputValue;
}

vec4 getBAtOutCoordsMatmul(int i) {
  ${e} coords = getOutputCoords();
  ${qt}
  ${Gt}
  vec4 outputValue = getB(${s});
  return outputValue;
}`}function dm$1(e,i){let a="";for(let o=0;o<i-2;o++)a+=`rc.${e[o]}, `;return a+=`rc.${e[i-2]}, i*2`,a}function hm$1(e,i){let a="";for(let o=0;o<i-2;o++)a+=`rc.${e[o]}, `;return a+=`i*2, rc.${e[i-1]}`,a}var fm$1,cm$1,no$1,Pi$1=L(()=>{fe$1(),we$1(),ae(),Bt$1(),xr(),ro$1(),fm$1=(e,i)=>({name:"MatMul (packed)",inputNames:e?["A","B","Bias"]:["A","B"],inputTypes:e?[2,2,2]:[2,2],cacheHint:i}),cm$1=(e,i,a,o)=>{let c=a.length>2,s=c?"value += getBiasForMatmul();":"",d=a[0].dims,$=a[1].dims,et=Ze$1.calcShape(d,$,!0),h=!U$1.areEqual(a[0].dims,a[1].dims);if(!et)throw new Error("Can't use matmul on the given tensors");let b=d[d.length-1],g=Math.ceil(b/2),st=d.length,$t=$.length,vt=H(e.session.backend.glContext.version),Ft=Qe(et.length),Gt=et.length,qt=Dt$1(),{activationFunction:Lt,applyActivation:rr}=Rt(o),jr=c?`${Ai(Ft,qt,a[2].dims,et,!0)}`:"",Hr=h?`${pm$1(Ft,qt,a,et)}`:"",wn=h?"getAAtOutCoordsMatmul(i)":`getA(${dm$1(qt,st)})`,_n=h?"getBAtOutCoordsMatmul(i)":`getB(${hm$1(qt,$t)})`,No=h?"":`${Ft} rc =
          getOutputCoords(); int lastDim = rc.${qt[Gt-1]}; rc.${qt[Gt-1]} =
          rc.${qt[Gt-2]}; rc.${qt[Gt-2]} = lastDim;
      `,Qo=`
            ${Hr}
            ${jr}
            ${Lt}
            void main() {
              ${No}

              vec4 value = vec4(0);
              for (int i = 0; i < ${g}; i++) {
                vec4 a = ${wn};
                vec4 b = ${_n};

                value += (a.rrbb * b.rgrg);
                value += (a.ggaa * b.baba);
              }
              ${s}
              ${rr}
              ${vt.output} = value;
            }`;return{...i,output:{dims:et,type:a[0].type,textureType:2},shaderSource:Qo,hasMain:!0}},no$1=(e,i,a)=>{let o=fm$1(i.length>2,a.activationCacheKey);return{...o,get:()=>cm$1(e,o,i,a)}}}),rf$1,nf$1=L(()=>{to$2(),Ql$1(),Pi$1(),rf$1=(e,i,a)=>{let o=i[0].dims,c=i[1].dims,s=Rr$1(o,c,a.dilations,a.pads,a.strides),d=e.run(Zl$1(e,i[0],i[1],s,a),[i[0]]),$=e.reshapePacked(i[1],[c[0],c[1]*c[2]*c[3]]),et=i.length===3?[$,d,i[2]]:[$,d],h=e.run(no$1(e,et,a),et);return e.reshapePacked(h,s)}}),mm$1,bm$1,of$1,Ei,Di$1=L(()=>{ae(),mm$1=e=>({name:"Im2Col",inputNames:["X"],inputTypes:[0],cacheHint:e}),bm$1=(e,i,a,o,c,s)=>{let d=a.dims,$=o.dims,et=c.length,h=Ei(d,$,c,4),b=`
        const int XC = ${d[1]};
        const int XH = ${d[2]};
        const int XW = ${d[3]};
        const int KH = ${s.kernelShape[0]};
        const int KW = ${s.kernelShape[1]};
        const int dilationH = ${s.dilations[0]};
        const int dilationW = ${s.dilations[1]};
        const int strideH = ${s.strides[0]};
        const int strideW = ${s.strides[1]};
        const int padH = ${s.pads[0]};
        const int padW = ${s.pads[1]};
        const int KHKW = KH*KW;
        const int XCKHKW = XC * KHKW;
        const int outputChannels = 4;
        vec4 process(int indices[${et}]) {
          int b  = indices[0]; // batch size
          int oh = indices[1] * strideH - padH; //output height
          int ow = indices[2] * strideW - padW; //output width
          int p = indices[3] * outputChannels; //patch
          vec4 value = vec4(0.0);
          for(int i=0; i < outputChannels; ++i) {
            if(p < XCKHKW) {
              int patchC = p / KHKW;
              int patchH = (p - patchC*KHKW) / KW;
              int patchW = (p - patchC*KHKW) - patchH * KW;
              int xh2 = oh + patchH * dilationH;
              int xw2 = ow + patchW * dilationW;
              int x[${d.length}];
              x[0] = b;
              x[1] = patchC;
              x[2] = xh2;
              x[3] = xw2;
              if(xh2 >= 0 &&
                  xh2 < XH &&
                  xw2 >= 0 &&
                  xw2 < XW) {
                value[i] = _X(x);
              }
            }
            ++p;
          }
          return value;
        }
        `;return{...i,output:{dims:h,type:a.type,textureType:4},shaderSource:b}},of$1=(e,i,a,o,c)=>{let s=mm$1(c.cacheKey);return{...s,get:()=>bm$1(e,s,i,a,o,c)}},Ei=(e,i,a,o=4)=>[a[0],a[2],a[3],Math.ceil(e[1]*i[2]*i[3]/o)]}),gm$1,ym$1,af$1,sf$1=L(()=>{fe$1(),we$1(),ae(),xr(),Di$1(),gm$1=(e,i)=>({name:"ConvDotProduct",inputNames:e?["Im2Col","K","B"]:["Im2Col","K"],inputTypes:e?[0,4,0]:[0,4],cacheKey:i.activationCacheKey}),ym$1=(e,i,a,o,c)=>{let s=a[0].dims,d=a[1].dims,$=[d[0],Math.ceil(s[1]*d[2]*d[3]/4)],et=Ei(s,d,o),[h,b]=e.calculateTextureWidthAndHeight($,4),g=U$1.computeStrides(et),[st,$t]=e.calculateTextureWidthAndHeight(et,4),vt=o.length,Ft=a.length<3?"0.0":"_B(b)",Gt=Math.ceil(s[1]*d[2]*d[3]/4),{activationFunction:qt,applyActivation:Lt}=Rt(c),rr=H(e.session.backend.glContext.version),jr=`
${qt}
float process(int indices[${vt}]) {
  int b[1];
  b[0] = indices[1];
  int im2col[4];
  im2col[0] = indices[0];
  im2col[1] = indices[2];
  im2col[2] = indices[3];
  int im2colOffset = im2col[0] * ${g[0]} + im2col[1] * ${g[1]} + im2col[2] * ${g[2]};
  int kernelOffset = indices[1] * ${$[1]};
  float value = ${Ft};
  for (int i = 0; i < ${Gt}; ++i) {
    vec2 im2colCoords = offsetToCoords(im2colOffset, ${st}, ${$t});
    vec2 kernelCoords = offsetToCoords(kernelOffset, ${h}, ${b});
    value += dot(${rr.texture2D}(Im2Col, im2colCoords), ${rr.texture2D}(K, kernelCoords));
    ++im2colOffset;
    ++kernelOffset;
  }
  ${Lt}
  return value;
}`;return{...i,output:{dims:o,type:a[0].type,textureType:0},shaderSource:jr}},af$1=(e,i,a,o)=>{let c=gm$1(i.length>2,o);return{...c,get:()=>ym$1(e,c,i,a,o)}}}),Rr$1,Li$1,Tm$1,xm$1,wm$1,vm,Ci,_m$1,to$2=L(()=>{Ue$1(),fe$1(),Jl$1(),nf$1(),sf$1(),xr(),Di$1(),ro$1(),Rr$1=(e,i,a,o,c)=>{let s=e[0],d=e.slice(2),$=d.length,et=i[0],h=i.slice(2).map((g,st)=>g+(g-1)*(a[st]-1)),b=d.map((g,st)=>g+o[st]+o[st+$]).map((g,st)=>Math.floor((g-h[st]+c[st])/c[st]));return[s,et].concat(...b)},Li$1=(e,i,a)=>(_m$1(i,a),Tm$1(e,i,a)),Tm$1=(e,i,a)=>{let o=vm(a,i),c=e.session.pack,s=o.kernelShape[0]===1&&o.kernelShape[1]===1;return o.group>1?[e.run(Kl$1(e,i,o),i)]:s&&c?[xm$1(e,i,o)]:c&&i[0].dims.length===4&&i[0].dims[0]===1&&!s?[rf$1(e,i,o)]:[wm$1(e,i,o)]},xm$1=(e,i,a)=>{let o=i[0].dims,c=i[1].dims,s=Rr$1(o,c,a.dilations,a.pads,a.strides),d=e.reshapeUnpacked(i[0],[o[1],o[2]*o[3]]),$=e.reshapeUnpacked(i[1],[c[0],c[1]]),et=i.length>2?[$,d,i[2]]:[$,d],h=e.run(Si(et,a),et);return e.reshapeUnpacked(h,s)},wm$1=(e,i,a)=>{let o=i[0].dims,c=i[1].dims,s=Rr$1(o,c,a.dilations,a.pads,a.strides),d=e.run(of$1(e,i[0],i[1],s,a),[i[0]]),$=i.length===3?[d,i[1],i[2]]:[d,i[1]];return e.run(af$1(e,i,s,a),$)},vm=(e,i)=>{let a=e.kernelShape.slice();if(e.kernelShape.length===0)for(let s=2;s<i[1].dims.length;++s)a.push(i[1].dims[s]);let o=e.pads.slice();mr$1.adjustPadsBasedOnAutoPad(i[0].dims,e.strides,e.dilations,a,o,e.autoPad);let c=Object.assign({},e);return Object.assign(c,{kernelShape:a,pads:o,cacheKey:e.cacheKey}),c},Ci=e=>{let i=e.attributes,a=Nr(i),o=i.getString("auto_pad","NOTSET"),c=i.getInts("dilations",[1,1]),s=i.getInt("group",1),d=i.getInts("kernel_shape",[]),$=i.getInts("pads",[0,0,0,0]),et=i.getInts("strides",[1,1]);return Q({autoPad:o,dilations:c,group:s,kernelShape:d,pads:$,strides:et,...a})},_m$1=(e,i)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4||e[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");let a=e[0].dims[1],o=e[1].dims[1]*i.group;if(a!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(e.length===3&&(e[2].dims.length!==1||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let c=e[0].dims.length-2;if(i.dilations.length!==c)throw new Error(`dilations should be ${c}D`);if(i.strides.length!==c)throw new Error(`strides should be ${c}D`);if(i.pads.length!==c*2)throw new Error(`pads should be ${c*2}D`);if(i.kernelShape.length!==0&&i.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(e[0].type!=="float32"||e[1].type!=="float32")throw new Error("Conv input(X,W) should be float tensor");if(e.length===3&&e[2].type!=="float32")throw new Error("Conv input(bias) should be float tensor")}}),Om$1,Im$1,Sm$1,uf$1,Am$1,Pm$1,Em$1,Dm$1,Lm$1,Cm$1,lf$1,Fm$1,ff$1=L(()=>{Ue$1(),we$1(),ae(),xr(),Om$1=(e,i,a,o,c,s)=>(e-1)*i+a+(o-1)*c+1-s,Im$1=(e,i,a,o,c)=>{let s=Math.floor(e/2);i==="SAME_UPPER"?(a[o]=s,a[c]=e-s):i==="SAME_LOWER"&&(a[o]=e-s,a[c]=s)},Sm$1=(e,i,a,o,c,s,d,$)=>{let et=e.length-2,h=$.length===0;for(let b=0;b<et;++b){let g=h?e[b+2]*s[b]:$[b],st=Om$1(e[b+2],s[b],c[b],i[b],a[b],g);Im$1(st,o,c,b,b+et),h&&$.push(s[b]*(e[b+2]-1)+d[b]+(i[b]-1)*a[b]+1-c[b]-c[b+et])}},uf$1=(e,i,a)=>(Fm$1(i,a),Am$1(e,i,a)),Am$1=(e,i,a)=>{let o=Cm$1(a,i);return[Lm$1(e,i,o)]},Pm$1=(e,i)=>({name:"ConvTranspose",inputNames:e?["X","W","B"]:["X","W"],inputTypes:e?[0,0,0]:[0,0],cacheHint:i}),Em$1=(e,i,a,o)=>{let c=i.length>2?"getB(output_channel)":"0.0",s=i[0].dims,d=i[1].dims,$=d[1],et=d[0]/o.group,h=[i[0].dims[0],i[1].dims[1]*o.group,...o.outputShape],b=H(e.session.backend.glContext.version),{activationFunction:g,applyActivation:st}=Rt(o),$t=`
  const ivec2 strides = ivec2(${o.strides[0]}, ${o.strides[1]});
  const ivec2 pads = ivec2(${o.pads[0]}, ${o.pads[1]});
  ${g}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;

    ivec2 loc = coords.zw + pads;

    int group_id = output_channel / ${$};
    int wOutChannel = output_channel - group_id * ${$};

    float value = ${c};
    for (int inChannelOffset = 0; inChannelOffset < ${et}; inChannelOffset++) {
      int input_channel = group_id * ${et} + inChannelOffset;
      for (int wWOff = 0; wWOff < ${d[2]}; wWOff++) {
        for (int wHOff = 0; wHOff < ${d[3]}; wHOff++) {
          ivec2 wOff = ivec2(wWOff * ${o.dilations[0]}, wHOff * ${o.dilations[1]});
          ivec2 wLoc = loc - wOff;
          ivec2 wLocIn = wLoc / strides;
          if (
            wLocIn * strides == wLoc &&
            wLocIn.x >= 0 && wLocIn.x < ${s[2]} &&
            wLocIn.y >= 0 && wLocIn.y < ${s[3]}
          ) {
            float xVal = getX(batch, input_channel, wLocIn.y, wLocIn.x);
            float wVal = getW(input_channel, wOutChannel, wHOff, wWOff);
            value += xVal * wVal;
          }
        }
      }
    }
    ${st}
    ${b.output} = vec4(value, .0, .0, .0);
  }
`;return{...a,output:{dims:h,type:i[0].type,textureType:0},shaderSource:$t,hasMain:!0}},Dm$1=(e,i,a)=>{let o=Pm$1(i.length>2,a.cacheKey);return{...o,get:()=>Em$1(e,i,o,a)}},Lm$1=(e,i,a)=>e.run(Dm$1(e,i,a),i),Cm$1=(e,i)=>{let a=e.kernelShape.slice();if(e.kernelShape.length===0)for(let $=2;$<i[1].dims.length;++$)a.push(i[1].dims[$]);let o=e.pads.slice(),c=e.outputShape.slice(),s=i[0].dims;Sm$1(s,a,e.dilations,e.autoPad,o,e.strides,e.outputPadding,c);let d=Object.assign({},e);return Object.assign(d,{kernelShape:a,pads:o,outputShape:c,cacheKey:e.cacheKey}),d},lf$1=e=>{let i=e.attributes,a=Nr(i),o=i.getString("auto_pad","NOTSET"),c=i.getInts("dilations",[1,1]),s=i.getInt("group",1),d=i.getInts("kernel_shape",[]),$=i.getInts("output_padding",[0,0]),et=i.getInts("output_shape",[]),h=i.getInts("pads",[0,0,0,0]),b=i.getInts("strides",[1,1]);return Q({autoPad:o,dilations:c,group:s,kernelShape:d,outputPadding:$,outputShape:et,pads:h,strides:b,...a})},Fm$1=(e,i)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4||e[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");let a=e[0].dims[1],o=e[1].dims[0];if(a!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let c=e[1].dims[1]*i.group;if(e.length===3&&(e[2].dims.length!==1||e[2].dims[0]!==c))throw new Error("invalid bias");let s=e[0].dims.length-2;if(i.dilations.length!==s)throw new Error(`dilations should be ${s}D`);if(i.strides.length!==s)throw new Error(`strides should be ${s}D`);if(i.pads.length!==s*2)throw new Error(`pads should be ${s*2}D`);if(i.outputPadding.length!==s)throw new Error(`output_padding should be ${s}D`);if(i.kernelShape.length!==0&&i.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(i.outputShape.length!==0&&i.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape");if(e[0].type!=="float32"||e[1].type!=="float32")throw new Error("ConvTranspose input(X,W) should be float tensor");if(e.length===3&&e[2].type!=="float32")throw new Error("ConvTranspose input(bias) should be float tensor")}}),cf,wr,pf$1,$m$1,df,km$1,Bm$1,Nm$1,oo$1=L(()=>{Ue$1(),fe$1(),ae(),cf={name:"Transpose",inputNames:["A"],inputTypes:[0]},wr=(e,i,a)=>(Nm$1(i),[e.run({...cf,cacheHint:a.cacheKey,get:()=>$m$1(e,i[0],a.perm)},i)]),pf$1=e=>Q({perm:e.attributes.getInts("perm",[])}),$m$1=(e,i,a)=>{let o=i.dims;a=df(o,a);let c=km$1(o,a),s=o.length,d=`
      ${Bm$1("perm",a,s)}
      float process(int indices[${s}]) {
        int a[${s}];
        perm(a, indices);
        return _A(a);
      }`;return{...cf,output:{dims:c,type:i.type,textureType:0},shaderSource:d}},df=(e,i)=>(i&&i.length!==e.length&&(i=[...e.keys()].reverse()),i),km$1=(e,i)=>(i=df(e,i),U$1.sortBasedOnPerm(e,i)),Bm$1=(e,i,a)=>{let o=[];o.push(`void ${e}(out int a[${a}], int src[${a}]) {`);for(let c=0;c<a;++c)o.push(`	a[${i[c]}]=src[${c}];`);return o.push("	}"),o.join(`
`)},Nm$1=e=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.");if(e[0].type!=="float32"&&e[0].type!=="float64")throw new Error("input should be float tensor")}}),hf$1,mf$1,Rm$1,bf=L(()=>{oo$1(),hf$1=(e,i,a)=>{Rm$1(i);let o=a.blocksize,c=o*o,s=a.mode==="DCR"?[0,3,4,1,5,2]:[0,1,4,2,5,3],d=a.mode==="DCR"?[i[0].dims[0],o,o,i[0].dims[1]/c,i[0].dims[2],i[0].dims[3]]:[i[0].dims[0],i[0].dims[1]/c,o,o,i[0].dims[2],i[0].dims[3]],$=e.reshapeUnpacked(i[0],d),et={perm:s,cacheKey:`${s}`},[h]=wr(e,[$],et),b=[i[0].dims[0],i[0].dims[1]/c,i[0].dims[2]*o,i[0].dims[3]*o];return[e.reshapeUnpacked(h,b)]},mf$1=e=>{let i=e.attributes.getInt("blocksize");if(i<1)throw new Error(`blocksize must be >= 1, but got : ${i} for DepthToSpace`);let a=e.attributes.getString("mode","DCR");if(a!=="DCR"&&a!=="CRD")throw new Error(`unrecognized mode: ${a} for DepthToSpace`);return{mode:a,blocksize:i}},Rm$1=e=>{if(e.length!==1)throw new Error(`DepthToSpace expect 1 inputs, but got ${e.length}`);if(e[0].type==="string"||e[0].dims.length!==4)throw new TypeError("DepthToSpace input should be a 4-D numeric tensor")}}),gf,yf,Mm$1,Tf=L(()=>{fe$1(),gf=(e,i,a)=>{Mm$1(i,a);let o=U$1.flattenShape(i[0].dims,a);return[e.reshapeUnpacked(i[0],o)]},yf=e=>e.attributes.getInt("axis",1),Mm$1=(e,i)=>{if(!e||e.length!==1)throw new Error("Flatten requires 1 input.");let a=e[0].dims.length;if(a===0)throw new Error("scalar tensor is not supported.");if(i<-a||i>a)throw new Error("Invalid axis");if(e[0].type==="string")throw new Error("string tensor is not supported.")}}),Qt,pn=L(()=>{Qt=["float32","float64","int32","int16","int8","uint16","uint32","uint8"]}),xf,wf,Gm$1,Um$1,zm$1,Vm$1,vf=L(()=>{Ue$1(),pn(),fe$1(),ae(),xf=(e,i,a)=>(Vm$1(i,a.axis),[e.run(zm$1(e,i,a),i)]),wf=e=>Q({axis:e.attributes.getInt("axis",0)}),Gm$1={name:"Gather",inputNames:["A","B"],inputTypes:[0,0]},Um$1=(e,i,a,o)=>{let c=a[0].dims.slice(),s=a[1].dims.slice(),d=new Array(c.length+s.length-1);o=U$1.normalizeAxis(o,c.length);let $=[];for(let st=0;st<d.length;st++)st<o?(d[st]=c[st],$.push(`inputIdx[${st}] = outputIdx[${st}];`)):st<o+s.length?(d[st]=s[st-o],$.push(`indexDataIdx[${st-o}] = outputIdx[${st}];`)):(d[st]=c[st-s.length+1],$.push(`inputIdx[${st-s.length+1}] = outputIdx[${st}];`));let et=d.length||1,h=c.length,b=s.length||1,g=`
      float process(int outputIdx[${et}]) {
        int inputIdx[${h}];
        int indexDataIdx[${b}];
        indexDataIdx[0] = 0;
        ${$.join(`
        `)}
        int idx = int(_B(indexDataIdx));
        inputIdx[${o}] = idx < 0 ? idx + ${c[o]} : idx;
        return _A(inputIdx);
      }`;return{...i,output:{dims:d,type:a[0].type,textureType:0},shaderSource:g}},zm$1=(e,i,a)=>{let o={...Gm$1,cacheHint:a.cacheKey};return{...o,get:()=>Um$1(e,o,i,a.axis)}},Vm$1=(e,i)=>{if(!e||e.length!==2)throw new Error("Gather requires 2 inputs.");let a=e[0].dims.length;if(a<1)throw new Error("Invalid input shape.");if(i<-a||i>a-1)throw new Error("Invalid axis.");if(Qt.indexOf(e[0].type)===-1)throw new Error("Invaid input type.");if(e[1].type!=="int32"&&e[1].type!=="int16")throw new Error("Invaid input type.")}}),Fi$1,_f,Of,If,Wm$1,Hm$1,qm$1,Sf=L(()=>{Ue$1(),fe$1(),ae(),Fi$1=(e,i,a)=>(qm$1(i,a),[e.run(Wm$1(i,a),i)]),_f=(e,i)=>{let a=e.attributes.getInt("transA",0)!==0,o=e.attributes.getInt("transB",0)!==0,c=e.attributes.getFloat("alpha",1),s=e.attributes.getFloat("beta",1);return Q({transA:a,transB:o,alpha:c,beta:s,isOptionalC:i})},Of=e=>_f(e,!1),If=e=>_f(e,!0),Wm$1=(e,i)=>{let a={name:"Gemm",inputNames:e.length===3?["A","B","C"]:["A","B"],inputTypes:e.length===3?[0,0,0]:[0,0],key:i.cacheKey};return{...a,get:()=>Hm$1(a,e,i)}},Hm$1=(e,i,a)=>{let o=i[0].dims.slice(),c=i[1].dims.slice(),[s,d]=jn$1.getShapeOfGemmResult(o,a.transA,c,a.transB,i.length===3?i[2].dims:void 0),$=[s,d];if(!$)throw new Error("Can't use gemm on the given tensors");let et=o[o.length-1],h="";a.transA&&(et=o[0]),a.transA&&a.transB?h="value += _A_T(a) * _B_T(b);":a.transA&&!a.transB?h="value += _A_T(a) * _B(b);":!a.transA&&a.transB?h="value += _A(a) * _B_T(b);":!a.transA&&!a.transB&&(h="value += _A(a) * _B(b);");let b=$.length,g=i.length===3?`int c[${i[2].dims.length}];`:"",st=i.length===3?"bcastIndices_C(indices, c);":"",$t=i.length===3?"value += beta * _C(c);":"",vt=`
      float process(int indices[${b}]) {
          int a[${b}];
          int b[${b}];
          ${g}

          copyVec(indices, a);
          copyVec(indices, b);
          ${st}

          float value = 0.0;
          for (int k=0; k<${et}; ++k) {
              a[${b-1}] = k;
              b[${b-2}] = k;
              ${h}
          }

          value = value * alpha;
          ${$t}
          return value;
      }`;return{...e,output:{dims:$,type:i[0].type,textureType:0},variables:[{name:"alpha",type:"float",data:a.alpha},{name:"beta",type:"float",data:a.beta}],shaderSource:vt}},qm$1=(e,i)=>{if(!e)throw new Error("Input is missing");if(i.isOptionalC&&(e.length<2||e.length>3))throw new Error("Invaid input shape.");if(!i.isOptionalC&&e.length!==3)throw new Error("Gemm requires 3 inputs");if(e.length===3&&e[2].dims.length!==1&&e[2].dims.length!==2)throw new Error("Invalid input shape of C");if(e[0].type!=="float32"&&e[0].type!=="float64"||e[1].type!=="float32"&&e[1].type!=="float64"||e.length===3&&e[2].type!=="float32"&&e[2].type!=="float64")throw new Error("Invalid input type.");if(e[0].type!==e[1].type||e.length===3&&e[0].type!==e[2].type)throw new Error("Input types are mismatched")}}),Af,Pf,jm$1,Ym$1,Xm$1,Km$1,Jm$1,Ef=L(()=>{Ue$1(),ae(),Af=(e,i,a)=>(Jm$1(i),[e.run(Xm$1(e,i,a),i)]),Pf=e=>{let i=e.attributes.getFloat("scale"),a=e.attributes.getFloats("bias");return Q({scale:i,bias:a})},jm$1={name:"ImageScaler",inputNames:["X"],inputTypes:[0]},Ym$1=(e,i,a,o)=>{let c=a[0].dims.slice(),s=c.length,d=`
      ${Km$1(o.bias.length)}
      float process(int indices[${s}]) {
        return _X(indices) * scale + getBias(bias, indices[1]);
      }`;return{...i,output:{dims:c,type:a[0].type,textureType:0},variables:[{name:"bias",type:"float",arrayLength:o.bias.length,data:o.bias},{name:"scale",type:"float",data:o.scale}],shaderSource:d}},Xm$1=(e,i,a)=>{let o={...jm$1,cacheHint:a.cacheKey};return{...o,get:()=>Ym$1(e,o,i,a)}},Km$1=e=>{let i=[`float getBias(float bias[${e}], int channel) {`];for(let a=0;a<e;++a)a===0?i.push(`	if (channel == ${a}) { return bias[${a}]; }`):a===e-1?i.push(`	else { return bias[${a}]; }`):i.push(`	else if (channel == ${a}) { return bias[${a}]; }`);return i.push("	}"),i.join(`
`)},Jm$1=e=>{if(!e||e.length!==1)throw new Error("ImageScaler requires 1 input.");if(e[0].dims.length!==4)throw new Error("Invalid input shape.");if(e[0].type!=="float32"&&e[0].type!=="float64")throw new Error("Invalid input type.")}}),Lf,Cf,Df,Zm$1,Qm$1,eb,tb,rb,nb,Ff=L(()=>{we$1(),ae(),Lf=(e,i,a)=>{nb(i);let o=e.run(Qm$1(i[0]),i);return[e.run(rb(e,i[0],a,o.dims),[i[0],o,i[1],i[2]])]},Cf=e=>e.attributes.getFloat("epsilon",1e-5),Df={name:"InstanceNormalization_MeanAndVariance",inputNames:["X"],inputTypes:[0]},Zm$1=(e,i)=>{let a=i.dims.slice(),o=a[1],c=a[2]*a[3],s=[a[0],o],d=`
      vec4 process(int[2] indices) {
        vec4 v = vec4(0.0);
        int a[4];
        a[0] = indices[0];
        a[1] = indices[1];
        float temp = 0.0;
        for(int a2=0; a2<${a[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${a[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += x;
          }
        }
        float mean = temp / float(${c});
        temp = 0.0;
        for(int a2=0; a2<${a[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${a[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += (x - mean) * (x - mean);
          }
        }
        v.r = mean;
        v.g = temp / float(${c});

        return v;
      }`;return{...e,output:{dims:s,type:i.type,textureType:4},shaderSource:d}},Qm$1=e=>({...Df,get:()=>Zm$1(Df,e)}),eb={name:"InstanceNormalization_ComputeOutput",inputNames:["X","MeanAndVariance","Scale","B"],inputTypes:[0,4,0,0]},tb=(e,i,a,o,c)=>{let s=H(e.session.backend.glContext.version),[d,$]=e.calculateTextureWidthAndHeight(c,4),[et,h]=[d/4,$],b=`
      vec4 get_MeanAndVariance(int[2] mv) {
        int offset = indicesToOffset_MeanAndVariance(mv);
        vec2 coords = offsetToCoords(offset, ${et}, ${h});
        return ${s.texture2D}(MeanAndVariance, coords);
      }

      float process(int[4] indices) {
        int mv[2];
        mv[0] = indices[0];
        mv[1] = indices[1];
        vec4 mean_and_variance = get_MeanAndVariance(mv);
        float mean = mean_and_variance.r;
        float variance = mean_and_variance.g;

        int sb[1];
        sb[0] = indices[1];
        float scale = _Scale(sb);
        float b = _B(sb);

        return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;
      }`;return{...i,output:{dims:a.dims,type:a.type,textureType:0},variables:[{name:"epsilon",type:"float",data:o}],shaderSource:b}},rb=(e,i,a,o)=>{let c={...eb,cacheHint:`${a}`};return{...c,get:()=>tb(e,c,i,a,o)}},nb=e=>{if(!e||e.length!==3)throw new Error("InstanceNormalization requires 3 inputs.");let i=e[0],a=e[1],o=e[2];if(i.dims.length<3||a.dims.length!==1||o.dims.length!==1)throw new Error("Invalid input shape.");if(a.dims[0]!==i.dims[1]||o.dims[0]!==i.dims[1])throw new Error("Input shapes are mismatched.");if(i.type!=="float32"&&i.type!=="float64"||a.type!=="float32"&&a.type!=="float64"||o.type!=="float32"&&o.type!=="float64")throw new Error("Invalid input type.");if(e[0].dims.length!==4)throw new Error("Only support 4-D input shape.")}});function ob(e,i){let a=e[0].dims[1],o=e[0].dims.length,c=-Math.floor((i.size-1)/2),s=Math.ceil((i.size-1)/2),d=`float(${i.alpha}) / float(${i.size})`,$=`float(${i.bias})`,et=`float(${i.beta})`,h=`
    float process(int indices[${o}]) {
        int c = indices[1];
        float x = _X(indices);
        float square_sum = 0.0;

        for (int i = ${c}; i <= ${s}; i++) {
          int idx = c + i;
          if (c >= 0 && c < ${a}) {
            indices[1] = idx;
            float j = _X(indices);
            square_sum += j * j;
          }
        }
        return x / pow(${$} + ${d} * square_sum, ${et});
    }`;return{...Bf,cacheHint:i.cacheKey,output:{dims:e[0].dims,type:e[0].type,textureType:0},shaderSource:h}}function ib(e,i){return{...Bf,cacheHint:i.cacheKey,get:()=>ob(e,i)}}var $f,kf,Bf,ab,Nf=L(()=>{Ue$1(),ae(),$f=(e,i,a)=>(ab(i),[e.run(ib(i,a),i)]),kf=e=>{let i=e.attributes.getFloat("alpha",1e-4),a=e.attributes.getFloat("beta",.75),o=e.attributes.getFloat("bias",1),c=e.attributes.getInt("size");return Q({alpha:i,beta:a,bias:o,size:c})},Bf={name:"LRN",inputNames:["X"],inputTypes:[0]},ab=e=>{if(!e||e.length!==1)throw new Error("LRN requires 1 input.");if(e[0].dims.length!==4)throw new Error('currently only support LRN for input with "NCHW" format');if(e[0].type!=="float32")throw new Error("input should be float type")}}),sb,$i,Rf,Mf,Gf,ub,lb,fb,cb,pb,db,hb,mb,Uf=L(()=>{Ue$1(),fe$1(),we$1(),ae(),sb={name:"Pad",inputNames:["A"],inputTypes:[0]},$i=(e,i,a)=>(fb(i),[e.run({...sb,cacheHint:a.cacheKey,get:()=>lb(e,i[0],a)},i)]),Rf=e=>{let i=e.attributes.getString("mode","constant"),a=e.attributes.getFloat("value",0),o=e.attributes.getInts("pads");return Q({mode:i,value:a,pads:o})},Mf=(e,i,a)=>{cb(i);let o=ub(e,i,a);return $i(e,[i[0]],o)},Gf=e=>e.attributes.getString("mode","constant"),ub=(e,i,a)=>{if(!e.session.isInitializer(i[1].dataId)||i.length>=3&&!e.session.isInitializer(i[2].dataId))throw new Error("dynamic pad attributes are not allowed");let o=Array.from(i[1].integerData),c=i.length>=3?i[2].floatData[0]:0;return Q({mode:a,pads:o,value:c})},lb=(e,i,a)=>{let o=U$1.padShape(i.dims.slice(),a.pads),c=o.length,s=`
      ${pb(e,i,a)}
      float process(int[${c}] indices) {
          return padA(indices);
      }`;return{name:"Pad",inputNames:["A"],inputTypes:[0],output:{dims:o,type:i.type,textureType:0},shaderSource:s}},fb=e=>{if(!e||e.length!==1)throw new Error("Pad requires 1 input");if(e[0].type!=="float32"&&e[0].type!=="float64")throw new Error("Invalid input type.")},cb=e=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Pad requires 2 or 3 inputs");if(e[1].type!=="int32")throw new Error("Invalid input type.");if(e.length>=3&&e[2].type==="string")throw new Error("Invalid input type.")},pb=(e,i,a)=>{let o=H(e.session.backend.glContext.version),[c,s]=e.calculateTextureWidthAndHeight(i.dims,0),d=U$1.computeStrides(i.dims);switch(a.mode){case"constant":return db(o,i.dims,d,c,s,a.pads,a.value);case"reflect":return hb(o,i.dims,d,c,s,a.pads);case"edge":return mb(o,i.dims,d,c,s,a.pads);default:throw new Error("Invalid mode")}},db=(e,i,a,o,c,s,d)=>{let $=i.length,et="";for(let h=$-1;h>=0;--h)et+=`
        k = m[${h}] - ${s[h]};
        if (k < 0)  return constant;
        if (k >= ${i[h]}) return constant;
        offset += k * ${a[h]};
        `;return`
      float padA(int m[${$}]) {
        const float constant = float(${d});
        int offset = 0;
        int k = 0;
        ${et}
        vec2 coords = offsetToCoords(offset, ${o}, ${c});
        float value = getColorAsFloat(${e.texture2D}(A, coords));
        return value;
      }
      `},hb=(e,i,a,o,c,s)=>{let d=i.length,$="";for(let et=d-1;et>=0;--et)$+=`
        k = m[${et}] - ${s[et]};
        if (k < 0) { k = -k; }
        {
          const int _2n_1 = ${2*(i[et]-1)};
          k = int( mod( float(k), float(_2n_1) ) ) ;
          if(k >= ${i[et]}) { k = _2n_1 - k; }
        }
        offset += k * ${a[et]};
        `;return`
      float padA(int m[${d}]) {
        int offset = 0;
        int k = 0;
        ${$}
        vec2 coords = offsetToCoords(offset, ${o}, ${c});
        float value = getColorAsFloat(${e.texture2D}(A, coords));
        return value;
      }
      `},mb=(e,i,a,o,c,s)=>{let d=i.length,$="";for(let et=d-1;et>=0;--et)$+=`
        k = m[${et}] - ${s[et]};
        if (k < 0)  k = 0;
        if (k >= ${i[et]}) k = ${i[et]-1};
        offset += k * ${a[et]};
      `;return`
      float padA(int m[${d}]) {
        int offset = 0;
        int k = 0;
        ${$}
        vec2 coords = offsetToCoords(offset, ${o}, ${c});
        float value = getColorAsFloat(${e.texture2D}(A, coords));
        return value;
      }
      `}}),Vf,Wf,Hf,qf,jf,Yf,Xf,Kf,Jf,bb,zf,Zf,ao$1,Qf,io$1,gb,ec=L(()=>{Ue$1(),fe$1(),ae(),Vf=(e,i,a)=>{ao$1(i);let o={name:"AveragePool",inputNames:["X"],inputTypes:[0],cacheHint:a.cacheKey};return[e.run({...o,get:()=>Hf(i,o,!1,a)},i)]},Wf=e=>{let i=e.attributes.getString("auto_pad","NOTSET"),a=e.attributes.getInt("ceil_mode",0),o=e.attributes.getInt("count_include_pad",0)!==0,c=e.attributes.getInts("kernel_shape"),s=e.attributes.getInts("strides",[]),d=e.attributes.getInts("pads",[]);if(a!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return Q({autoPad:i,ceilMode:a,countIncludePad:o,kernelShape:c,strides:s,pads:d})},Hf=(e,i,a,o)=>{let[c,s]=Jf(e,o,a),d=U$1.size(c.kernelShape),$="value += _X(x);",et="";c.countIncludePad?et+=`value /= float(${d});`:et+=`value /= float(${d} - pad);`;let h=`
        ${Qf(e[0].dims,c,$,et,"0.0")}
      `;return{...i,output:{dims:s,type:e[0].type,textureType:0},shaderSource:h}},qf=(e,i,a)=>{ao$1(i);let o={name:"GlobalAveragePool",inputNames:["X"],inputTypes:[0],cacheHint:`${a.countIncludePad}`};return[e.run({...o,get:()=>Hf(i,o,!0,a)},i)]},jf=e=>{let i=e.attributes.getInt("count_include_pad",0)!==0;return Q({autoPad:"",ceilMode:0,countIncludePad:i,kernelShape:[],strides:[],pads:[]})},Yf=(e,i,a)=>{ao$1(i);let o={name:"MaxPool",inputNames:["X"],inputTypes:[0],cacheHint:a.cacheKey};return[e.run({...o,get:()=>Kf(i,o,!1,a)},i)]},Xf=e=>{let i=e.attributes.getString("auto_pad","NOTSET"),a=e.attributes.getInt("ceil_mode",0),o=e.attributes.getInts("kernel_shape"),c=e.attributes.getInts("strides",[]),s=e.attributes.getInts("pads",[]),d=e.attributes.getInt("storage_order",0),$=e.attributes.getInts("dilations",[]);if(d!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(a!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return Q({autoPad:i,ceilMode:a,countIncludePad:!1,kernelShape:o,strides:c,pads:s,storageOrder:d,dilations:$})},Kf=(e,i,a,o)=>{let[c,s]=Jf(e,o,a),d=`
      value = max(_X(x), value);
    `,$="",et=`
      ${Qf(e[0].dims,c,d,$,"-1e5")}
    `;return{...i,output:{dims:s,type:e[0].type,textureType:0},shaderSource:et}},Jf=(e,i,a)=>{let o=e[0].dims.slice(),c=Object.hasOwnProperty.call(i,"dilations"),s=i.kernelShape.slice(),d=i.strides.slice(),$=c?i.dilations.slice():[],et=i.pads.slice();mr$1.adjustPoolAttributes(a,o,s,d,$,et);let h=mr$1.computePoolOutputShape(a,o,d,$,s,et,i.autoPad),b=Object.assign({},i);return c?Object.assign(b,{kernelShape:s,strides:d,pads:et,dilations:$,cacheKey:i.cacheKey}):Object.assign(b,{kernelShape:s,strides:d,pads:et,cacheKey:i.cacheKey}),[b,h]},bb={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""},zf={name:"GlobalMaxPool",inputNames:["X"],inputTypes:[0]},Zf=(e,i)=>(ao$1(i),[e.run({...zf,get:()=>Kf(i,zf,!0,bb)},i)]),ao$1=e=>{if(!e||e.length!==1)throw new Error("Pool ops requires 1 input.");if(e[0].type!=="float32"&&e[0].type!=="float64")throw new Error("Invalid input type.")},Qf=(e,i,a,o,c)=>{let s=e.length;if(i.kernelShape.length<=2){let d=i.kernelShape[i.kernelShape.length-1],$=i.strides[i.strides.length-1],et=i.pads[i.pads.length/2-1],h=i.pads[i.pads.length-1],b=e[s-1],g="",st="",$t="";if(et+h!==0?g=`
          for (int i = 0; i < ${d}; i++) {
            x[${s} - 1] = indices[${s} - 1] * ${$} - ${et} + i;
            if (x[${s} - 1] < 0 || x[${s} - 1] >= ${b}) {
              pad++;
              continue;
            }
            ${a}
          }`:g=`
          for (int i = 0; i < ${d}; i++) {
            x[${s} - 1] = indices[${s} - 1] * ${$} - ${et} + i;
            ${a}
          }`,i.kernelShape.length===2){let vt=i.kernelShape[i.kernelShape.length-2],Ft=i.strides[i.strides.length-2],Gt=i.pads[i.pads.length/2-2],qt=i.pads[i.pads.length-2],Lt=e[s-2];Gt+qt!==0?st=`
            for (int j = 0; j < ${vt}; j++) {
              x[${s} - 2] = indices[${s} - 2] * ${Ft} - ${Gt} + j;
              if (x[${s} - 2] < 0 || x[${s} - 2] >= ${Lt}) {
                pad+= ${d};
                continue;
              }
          `:st=`
            for (int j = 0; j < ${vt}; j++) {
              x[${s} - 2] = indices[${s} - 2] * ${Ft} - ${Gt} + j;
            `,$t=`
          }
        `}return`
        float process(int indices[${s}]) {
          int x[${s}];
          copyVec(indices, x);

          float value = ${c};
          int pad = 0;
          ${st}
          ${g}
          ${$t}
          ${o}
          return value;
        }
      `}else{let d=U$1.size(i.kernelShape),$=U$1.computeStrides(i.kernelShape),et=$.length,h=i.pads.length,b=gb(et),g=io$1(e,"inputDims"),st=io$1(i.pads,"pads"),$t=io$1($,"kernelStrides"),vt=io$1(i.strides,"strides"),Ft=i.pads.reduce((qt,Lt)=>qt+Lt),Gt="";return Ft?Gt=`
            if (x[j] >= inputDims[j] || x[j] < 0) {
              pad++;
              isPad = true;
              break;
            }
          }
          if (!isPad) {
            ${a}
          }`:Gt=`
          }
          ${a}
        `,`
        ${b}
        float process(int indices[${s}]) {
          int x[${s}];
          copyVec(indices, x);
          int offset[${et}];
          int pads[${h}];
          int inputDims[${s}];
          int kernelStrides[${et}];
          int strides[${et}];
          ${st}
          ${g}
          ${vt}
          ${$t}

          float value = ${c};
          int pad = 0;
          bool isPad = false;
          for (int i = 0; i < ${d}; i++) {
            offsetToIndices(i, kernelStrides, offset);
            isPad = false;
            for (int j = ${s} - ${et}; j < ${s}; j++) {
              x[j] = indices[j] * strides[j - ${s} + ${et}]
                + offset[j - ${s} + ${et}] - pads[j - 2];
              ${Gt}
          }
          ${o}

          return value;
        }
      `}},io$1=(e,i)=>{let a="";for(let o=0;o<e.length;o++)a+=`
      ${i}[${o}] = ${e[o]};
    `;return a},gb=e=>`
  void offsetToIndices(int offset, int[${e}] strides, out int[${e}] indices) {
    if (${e} == 0) {
      return;
    }
    for (int i = 0; i < ${e} - 1; ++i) {
      indices[i] = offset / strides[i];
      offset -= indices[i] * strides[i];
    }
    indices[${e} - 1] = offset;
  }`}),vr,er,yb,Tb,tc,rc,nc$1,oc$1,ic$1,ac$1,sc$1,uc$1=L(()=>{Ue$1(),pn(),fe$1(),ae(),vr=(e,i,a,o,c)=>{Tb(i);let s={name:o,inputNames:["A"],inputTypes:[0]};return[e.run({...s,cacheHint:a.cacheKey,get:()=>yb(e,i,a,o,c,s)},i)]},er=e=>{let i=e.attributes.getInts("axes",[]),a=e.attributes.getInt("keepdims",1)===1;return Q({axes:i,keepDims:a})},yb=(e,i,a,o,c,s)=>{let d=[],$=i[0].dims.length||1,et=[],h=U$1.normalizeAxes(a.axes,i[0].dims.length),b=c(i,h),g=b[1];for(let $t=0;$t<i[0].dims.length;$t++)h.indexOf($t)>=0||h.length===0?(a.keepDims&&d.push(1),g=`
          for(int j${$t} = 0; j${$t} < ${i[0].dims[$t]}; j${$t}++) {
            inputIdx[${$t}] = j${$t};
            ${g}
          }`):(et.push(`inputIdx[${$t}] = outputIdx[${d.length}];`),d.push(i[0].dims[$t]));let st=`
      float process(int outputIdx[${d.length||1}]) {
        float value;                 // final result
        int inputIdx[${$}];      // addressing input data
        ${et.join(`
`)}
        ${b[0]}       // init ops for reduce max/min
        ${g}
        ${b[2]}       // final computation for reduce mean
        return value;
      }`;return{...s,output:{dims:d,type:i[0].type,textureType:0},shaderSource:st}},Tb=e=>{if(!e||e.length!==1)throw new Error("Reduce op requires 1 input.");if(Qt.indexOf(e[0].type)===-1)throw new Error("Invalid input type.")},tc=(e,i,a)=>vr(e,i,a,"ReduceSum",()=>["value = 0.0;","value += _A(inputIdx);",""]),rc=(e,i,a)=>vr(e,i,a,"ReduceMean",(o,c)=>{let s=1;for(let d=0;d<o[0].dims.length;d++)(c.indexOf(d)>=0||c.length===0)&&(s*=o[0].dims[d]);return["value = 0.0;","value += _A(inputIdx);",`value /= ${s}.;`]}),nc$1=(e,i,a)=>vr(e,i,a,"ReduceMax",(o,c)=>{let s=[];for(let d=0;d<o[0].dims.length;d++)(c.indexOf(d)>=0||c.length===0)&&s.push(`inputIdx[${d}] = 0;`);return[`${s.join(`
`)}
value = _A(inputIdx);`,"value = max(value, _A(inputIdx));",""]}),oc$1=(e,i,a)=>vr(e,i,a,"ReduceMin",(o,c)=>{let s=[];for(let d=0;d<o[0].dims.length;d++)(c.indexOf(d)>=0||c.length===0)&&s.push(`inputIdx[${d}] = 0;`);return[`${s.join(`
`)}
value = _A(inputIdx);`,"value = min(value, _A(inputIdx));",""]}),ic$1=(e,i,a)=>vr(e,i,a,"ReduceProd",()=>["value = 1.0;","value *= _A(inputIdx);",""]),ac$1=(e,i,a)=>vr(e,i,a,"ReduceLogSum",()=>["value = 0.0;","value += _A(inputIdx);","value = log(value);"]),sc$1=(e,i,a)=>vr(e,i,a,"ReduceLogSumSquare",()=>["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""])}),lc$1,fc$1=L(()=>{fe$1(),lc$1=(e,i)=>{let a=U$1.calculateReshapedDims(i[0].dims,i[1].integerData);return e.session.pack?[e.reshapePacked(i[0],a)]:[e.reshapeUnpacked(i[0],a)]}}),cc$1,ki,pc$1,dc$1,dn,xb,Bi$1,so$1,Ni=L(()=>{Ue$1(),we$1(),ae(),cc$1={name:"Upsample",inputNames:["X"],inputTypes:[0]},ki=(e,i,a)=>(Bi$1(i,a),[e.run({...cc$1,cacheHint:a.cacheKey,get:()=>xb(e,i,a)},i)]),pc$1=e=>dn(e,7),dc$1=e=>dn(e,9),dn=(e,i)=>{let a=i>=10,o=e.attributes.getString("mode","nearest");if(o!=="nearest"&&o!=="linear"&&(i<11||o!=="cubic"))throw new Error(`unrecognized mode: ${o}`);let c=[];i<9&&(c=e.attributes.getFloats("scales"),so$1(c,o,a));let s=e.attributes.getFloat("extrapolation_value",0),d=i>10?e.attributes.getString("coordinate_transformation_mode","half_pixel"):"asymmetric";if(["asymmetric","pytorch_half_pixel","tf_half_pixel_for_nn","align_corners","tf_crop_and_resize","half_pixel"].indexOf(d)===-1)throw new Error(`coordinate_transform_mode '${d}' is not supported`);let $=d==="tf_crop_and_resize",et=$,h=o==="nearest"&&i>=11?e.attributes.getString("nearest_mode","round_prefer_floor"):"";if(["round_prefer_floor","round_prefer_ceil","floor","ceil",""].indexOf(h)===-1)throw new Error(`nearest_mode '${h}' is not supported`);let b=e.attributes.getFloat("cubic_coeff_a",-.75),g=e.attributes.getInt("exclude_outside",0)!==0;if(g&&o!=="cubic")throw new Error("exclude_outside can be set to 1 only when mode is CUBIC.");let st=i<11?!0:o==="nearest"&&d==="asymmetric"&&h==="floor",$t=0,vt=0,Ft=0;return i>10?e.inputs.length>2?($t=1,vt=2,Ft=3):(vt=1,Ft=2):i===9&&(vt=1),Q({opset:i,isResize:a,mode:o,scales:c,extrapolationValue:s,coordinateTransformMode:d,useExtrapolation:et,needRoiInput:$,nearestMode:h,cubicCoefficientA:b,excludeOutside:g,useNearest2xOptimization:st,roiInputIdx:$t,scalesInputIdx:vt,sizesInputIdx:Ft})},xb=(e,i,a)=>{let o=H(e.session.backend.glContext.version),[c,s]=e.calculateTextureWidthAndHeight(i[0].dims,0),d=i[0].dims.map((Ft,Gt)=>Math.floor(Ft*a.scales[Gt])),[$,et]=e.calculateTextureWidthAndHeight(d,0),h=d.length,b=new Array(h),g=new Array(h),st=`
      int output_pitches[${h}];
      int input_pitches[${h}];
      `;for(let Ft=h-1;Ft>=0;Ft--)b[Ft]=Ft===h-1?1:b[Ft+1]*d[Ft+1],g[Ft]=Ft===h-1?1:g[Ft+1]*i[0].dims[Ft+1],st+=`
        output_pitches[${Ft}] = ${b[Ft]};
        input_pitches[${Ft}] = ${g[Ft]};
        `;let $t=`
      float getInputFloat(int index) {
        vec2 coords = offsetToCoords(index, ${c}, ${s});
        float value = getColorAsFloat(${o.texture2D}(X, coords));
        return value;
      }
      `,vt=a.mode==="nearest"?`
    ${$t}
    float process(int indices[${h}]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${$}, ${et});

      ${st}

      int d, m;
      for (int dim = 0; dim < ${h}; ++dim) {
        d = output_index / output_pitches[dim];
        m = output_index - d * output_pitches[dim];
        output_index = m;

        if (scales[dim] != 1 && d > 0) {
          int d2 = d / scales[dim];
          m = d - d2 * scales[dim];
          d = d2;
        }
        input_index += input_pitches[dim] * d;
      }

      return getInputFloat(input_index);
    }`:h===4?`
    ${$t}
    float process(int indices[4]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${$}, ${et});

      ${st}

      int m;
      int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m / output_pitches[1];
      m = m - index_of_dim1 * output_pitches[1];
      index_of_dim2 = m / output_pitches[2];
      m = m - index_of_dim2 * output_pitches[2];
      index_of_dim3 = m;

      int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;
      index_of_input_dim2 = index_of_dim2 / scales[2];
      y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];
      index_of_input_dim3 = index_of_dim3 / scales[3];
      x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];

      input_index = index_of_dim0 * input_pitches[0] +
            index_of_dim1 * input_pitches[1] +
            index_of_input_dim2 * input_pitches[2] +
            index_of_input_dim3;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim2 = false;
      if (index_of_input_dim2 == (${i[0].dims[2]} - 1)) {
        // It's the end in dimension 2
        x01 = x00;
        end_of_dim2 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[2]);
      }

      if (index_of_input_dim3 == (input_pitches[2] - 1)) {
        // It's the end in dimension 3
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);
    }`:`
    ${$t}
    float process(int indices[2]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${$}, ${et});

      ${st}

      int m;
      int index_of_dim0, index_of_dim1;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m;

      int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;
      index_of_input_dim0 = index_of_dim0 / scales[0];
      y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];
      index_of_input_dim1 = index_of_dim1 / scales[1];
      x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];

      input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim0 = false;
      if (index_of_input_dim0 == (${i[0].dims[0]} - 1)) {
        // It's the end in dimension 0
        x01 = x00;
        end_of_dim0 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[0]);
      }

      if (index_of_input_dim1 == (input_pitches[0] - 1)) {
        // It's the end in dimension 1
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);
    }`;return{...cc$1,output:{dims:d,type:i[0].type,textureType:0},shaderSource:vt,variables:[{name:"scales",type:"int",arrayLength:a.scales.length,data:a.scales.map(Ft=>Math.ceil(Ft))}]}},Bi$1=(e,i)=>{if(!e||i.opset<9&&e.length!==1||i.opset>=9&&i.opset<11&&e.length!==2||i.opset>=11&&e.length<2)throw new Error("invalid inputs.");if(i.scales.length>0&&e[0].dims.length!==i.scales.length)throw new Error("Invalid input shape.");if(e[0].type==="string")throw new Error("Invalid input tensor types.")},so$1=(e,i,a)=>{if(a){for(let o of e)if(o<=0)throw new Error("Scale value should be greater than 0.")}else for(let o of e)if(o<1)throw new Error("Scale value should be greater than or equal to 1.");if((i==="linear"||i==="cubic")&&e.length!==2&&(e.length!==4||e[0]!==1||e[1]!==1))throw new Error(`'Linear' mode and 'Cubic' mode only support 2-D inputs ('Bilinear', 'Bicubic')         or 4-D inputs with the corresponding outermost 2 scale values being 1         in the ${a?"Resize":"Upsample"} opeartor.`)}}),Ri$1,Mi$1,hc,mc$1,wb,vb,_b,Ob,bc$1=L(()=>{we$1(),ae(),Bt$1(),Tr(),Ni(),Ri$1={name:"Resize",inputNames:["A"],inputTypes:[2]},Mi$1=(e,i,a)=>(Bi$1(i,a),[e.run({...Ri$1,cacheHint:a.cacheKey,get:()=>wb(e,i,a)},i)]),hc=e=>dn(e,10),mc$1=e=>dn(e,11),wb=(e,i,a)=>{let o=H(e.session.backend.glContext.version),[c,s]=vb(i,a);if(c.every(Lt=>Lt===1)&&a.coordinateTransformMode!=="tf_crop_and_resize")return{...Ri$1,output:{dims:s,type:i[0].type,textureType:2},hasMain:!0,shaderSource:`void main() {
                    vec4 v = ${o.texture2D}(X, TexCoords);
                    ${o.output} = v;
                }`};let d=s.length;if(d<2)throw new Error(`output dimension should be at least 2, but got ${d}`);let $=s[d-2],et=s[d-1],h=i[0].dims;if(d!==h.length)throw new Error(`output dimension should match input ${h.length}, but got ${d}`);let b=h[d-2],g=h[d-1],st=c[d-2],$t=c[d-1],vt="";if(a.mode!=="linear")throw new Error(`resize (packed) does not support mode: '${a.mode}'`);switch(a.coordinateTransformMode){case"asymmetric":vt=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return vec4(coords) / scaleWHWH;
                    }
                `;break;case"half_pixel":vt=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return (vec4(coords) + 0.5) / scaleWHWH - 0.5;
                    }
                `;break;case"pytorch_half_pixel":vt=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 fcoords = vec4(coords);
                        return vec4(
                            ${et}.0 > 1.0 ? (fcoords.x + 0.5) / scaleWHWH.x - 0.5 : 0.0,
                            ${$}.0 > 1.0 ? (fcoords.y + 0.5) / scaleWHWH.y - 0.5 : 0.0,
                            ${et}.0 > 1.0 ? (fcoords.z + 0.5) / scaleWHWH.z - 0.5 : 0.0,
                            ${$}.0 > 1.0 ? (fcoords.w + 0.5) / scaleWHWH.w - 0.5 : 0.0
                          );
                    }
                `;break;case"align_corners":vt=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 resized = vec4(${et}.0 - 1.0, ${$}.0 - 1.0, ${et}.0 - 1.0,
                            ${$}.0 - 1.0);
                        vec4 original = vec4(${g}.0 - 1.0, ${b}.0 - 1.0, ${g}.0 - 1.0,
                            ${b}.0 - 1.0);
                        vec4 new_scale = original / resized;
                        return vec4(coords) * new_scale;
                    }
                `;break;default:throw new Error(`resize (packed) does not support coordinateTransformMode:                                 '${a.coordinateTransformMode}'`)}let Ft=Qe(d),Gt=Nt(),qt=`
            const vec2 inputWH = vec2(${b}.0, ${g}.0);
            const vec4 scaleWHWH = vec4(float(${st}), float(${$t}), float(${st}), float(${$t}));
            ${Gt}
            ${vt}
            float getAValue(int x10, int r, int c, int d) {
                return getChannel(getA(x10, r, c, d), vec2(c, d));
            }
            void main() {
                ${Ft} rc = getOutputCoords();

                int batch = rc[0];
                int depth = rc[1];

                // retrieve the 4 coordinates that is used in the 4 packed output values.
                ivec4 coords = ivec4(rc.wz, rc.w + 1, rc.z + 1);

                // calculate the source index in fraction
                vec4 sourceFrac = getSourceFracIndex(coords);

                // get the lower and upper bound of the 4 values that will be packed into one texel.
                ivec4 x00 = ivec4(max(sourceFrac.xy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xy)));
                ivec4 x01 = ivec4(max(sourceFrac.xw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xw)));
                ivec4 x10 = ivec4(max(sourceFrac.zy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zy)));
                ivec4 x11 = ivec4(max(sourceFrac.zw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zw)));

                bool hasNextRow = rc.w < ${$-1};
                bool hasNextCol = rc.z < ${et-1};

                // pack x00, x01, x10, x11's top-left corner into one vec4 structure
                vec4 topLeft = vec4(
                    getAValue(batch, depth, x00.x, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.y) : 0.0);

                // pack x00, x01, x10, x11's top-right corner into one vec4 structure
                vec4 topRight = vec4(
                    getAValue(batch, depth, x00.x, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.w) : 0.0);

                // pack x00, x01, x10, x11's bottom-left corner into one vec4 structure
                vec4 bottomLeft = vec4(
                    getAValue(batch, depth, x00.z, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.y) : 0.0);

                // pack x00, x01, x10, x11's bottom-right corner into one vec4 structure
                vec4 bottomRight = vec4(
                    getAValue(batch, depth, x00.z, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.w) : 0.0);

                // calculate the interpolation fraction on u and v direction
                vec4 frac = vec4(sourceFrac) - floor(sourceFrac);
                vec4 clampFrac = clamp(frac, vec4(0.0), vec4(1.0));

                vec4 top = mix(topLeft, topRight, clampFrac.ywyw);
                vec4 bottom = mix(bottomLeft, bottomRight, clampFrac.ywyw);
                vec4 newValue = mix(top, bottom, clampFrac.xxzz);

                ${o.output} = vec4(newValue);
            }
        `;return{...Ri$1,output:{dims:s,type:i[0].type,textureType:2},hasMain:!0,shaderSource:qt}},vb=(e,i)=>{let a=e[0].dims,o=i.scales,c;if(o.length===0){let d=e[i.scalesInputIdx];if(d&&d.size!==0){if(e[i.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");o=_b(d,i.mode,i.isResize)}else{let $=e[i.sizesInputIdx];if(!$||$.size===0)throw new Error("Either scales or sizes MUST be provided as input.");c=Array.from($.integerData),o=Ob(c,a,i.mode,i.isResize)}}else if(e[i.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");let s=c||a.map((d,$)=>Math.floor(d*o[$]));return[o,s]},_b=(e,i,a)=>{let o=Array.from(e.floatData);return so$1(o,i,a),o},Ob=(e,i,a,o)=>{let c=i.length,s=new Array(c);for(let d=0,$=c;d<$;d++)if(i[d]===0){if(e[d]!==0)throw new Error("Input dim is zero but required output dim is non-zero.");s[d]=1}else s[d]=e[d]/i[d];return so$1(s,a,o),s}}),gc$1,Ib,yc$1=L(()=>{yr(),gc$1=(e,i)=>(Ib(i),[new $e([i[0].dims.length],"int32",void 0,void 0,new Int32Array(i[0].dims))]),Ib=e=>{if(!e||e.length!==1)throw new Error("Shape requires 1 input.")}}),Gi$1,Tc$1,xc$1,wc$1,Sb,vc$1,Ab,Pb,_c$1=L(()=>{Ue$1(),pn(),fe$1(),ae(),Gi$1={name:"Slice",inputNames:["A"],inputTypes:[0]},Tc$1=(e,i,a)=>(Sb(i),[e.run({...Gi$1,cacheHint:a.cacheKey,get:()=>wc$1(e,i[0],a)},i)]),xc$1=e=>{let i=e.attributes.getInts("starts"),a=e.attributes.getInts("ends"),o=e.attributes.getInts("axes",[]);return Q({starts:i,ends:a,axes:o})},wc$1=(e,i,a)=>{let o=a.axes.length===0?i.dims.slice(0).map((b,g)=>g):a.axes,c=U$1.normalizeAxes(o,i.dims.length),s=a.starts.map((b,g)=>b>i.dims[c[g]]-1?i.dims[c[g]]:U$1.normalizeAxis(b,i.dims[c[g]])),d=a.ends.map((b,g)=>b>i.dims[c[g]]-1?i.dims[c[g]]:U$1.normalizeAxis(b,i.dims[c[g]])),$=i.dims.slice(),et=[];for(let b=0;b<c.length;b++)$[c[b]]=d[b]-s[b],s[b]>0&&et.push(`outputIdx[${c[b]}] += ${s[b]};`);let h=`
      float process(int outputIdx[${$.length}]) {
        ${et.join(`
      `)}
        return _A(outputIdx);
      }`;return{...Gi$1,output:{dims:$,type:i.type,textureType:0},shaderSource:h}},Sb=e=>{if(!e||e.length!==1)throw new Error("Slice requires 1 input.");if(Qt.indexOf(e[0].type)===-1)throw new Error("Invalid input type.")},vc$1=(e,i)=>{Pb(i);let a=Ab(e,i);return[e.run({...Gi$1,cacheHint:a.cacheKey,get:()=>wc$1(e,i[0],a)},[i[0]])]},Ab=(e,i)=>{if(!e.session.isInitializer(i[1].dataId)||!e.session.isInitializer(i[2].dataId)||i.length>=4&&!e.session.isInitializer(i[3].dataId)||i.length>=5&&!e.session.isInitializer(i[4].dataId))throw new Error("dynamic slice attributes are not allowed");if(i.length>=5&&i[4].integerData.some(d=>d!==1))throw new Error("currently non-1 steps is not supported for Slice");let a=Array.from(i[1].integerData),o=Array.from(i[2].integerData),c=i.length>=4?Array.from(i[3].integerData):[],s=`${c};${a};${o}`;return{starts:a,ends:o,axes:c,cacheKey:s}},Pb=e=>{if(!e||e.length<3||e.length>5)throw new Error("Invalid input number.");if(e[1].type!=="int32"||e[1].dims.length!==1)throw new Error("Invalid input type.");if(e[2].type!=="int32"||e[2].dims.length!==1)throw new Error("Invalid input type.");if(e.length>=4&&(e[3].type!=="int32"||e[3].dims.length!==1))throw new Error("Invalid input type.");if(e.length>=5&&(e[4].type!=="int32"||e[4].dims.length!==1))throw new Error("Invalid input type.")}}),Oc$1,Ic$1,Sc$1,Ac$1,Pc$1,Ec$1,Dc$1,Lc$1,Eb,Db,Lb,Cc$1,Fc$1=L(()=>{Ue$1(),fe$1(),we$1(),ae(),oo$1(),Oc$1={name:"SoftmaxComputeMax",inputNames:["A"],inputTypes:[0]},Ic$1={name:"SoftmaxComputeScale",inputNames:["A","Max"],inputTypes:[0,0]},Sc$1={name:"SoftMax",inputNames:["A","Max","Norm"],inputTypes:[0,0,0]},Ac$1=(e,i,a)=>{Cc$1(i);let o=i[0].dims.slice(),c=U$1.normalizeAxis(a.axis,o.length),s=U$1.sizeToDimension(o,c),d=U$1.sizeFromDimension(o,c);return Lc$1(e,i,a,s,d)},Pc$1=e=>Q({axis:e.attributes.getInt("axis",1)}),Ec$1=e=>Q({axis:e.attributes.getInt("axis",-1)}),Dc$1=(e,i,a)=>{Cc$1(i);let o=i[0].dims.slice(),c=U$1.normalizeAxis(a.axis,o.length),s=o.length,d=c!==s-1,$=[],et=[],h=[],b;d&&(et=Array.from({length:s}).map((vt,Ft)=>Ft),et[c]=s-1,et[s-1]=c,et.map(vt=>$.push(o[vt])),b=Q({perm:et}),h=wr(e,i,b));let g=d?U$1.sizeToDimension($,s-1):U$1.sizeToDimension(o,s-1),st=d?U$1.sizeFromDimension($,s-1):U$1.sizeFromDimension(o,s-1),$t=Lc$1(e,d?h:i,a,g,st);return d?wr(e,$t,b):$t},Lc$1=(e,i,a,o,c)=>{let s=Eb(e,i[0],o,c,[o]),d=e.run({...Oc$1,cacheHint:a.cacheKey,get:()=>s},i),$=Db(e,i[0],o,c,s.output.dims,[o]),et=e.run({...Ic$1,cacheHint:a.cacheKey,get:()=>$},[i[0],d]),h=Lb(e,i[0],o,c,s.output.dims,$.output.dims);return[e.run({...Sc$1,cacheHint:a.cacheKey,get:()=>h},[i[0],d,et])]},Eb=(e,i,a,o,c)=>{let[s,d]=e.calculateTextureWidthAndHeight(i.dims,0),$=c.length;if(a<1||o<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(c.length!==1)throw new Error("Dimensionality of the output should be 1");if(c[0]!==a)throw new Error("Shape of the output should be equal to logical row count");let et=H(e.session.backend.glContext.version),h=`
      float process(int[${$}] indices) {
        int logical_row_start_offset = indices[0] * ${o};

        float max = getColorAsFloat(${et.texture2D}(A, offsetToCoords(logical_row_start_offset, ${s},
        ${d} )));
        for(int i=1; i<${o}; ++i)
        {
          float current = getColorAsFloat(${et.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${s}, ${d})));
          if(current > max)
          max = current;
        }

        return max;
      }`;return{...Oc$1,output:{dims:c,type:i.type,textureType:0},shaderSource:h}},Db=(e,i,a,o,c,s)=>{let[d,$]=e.calculateTextureWidthAndHeight(i.dims,0),et=s.length;if(a<1||o<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(s.length!==1)throw new Error("Dimensionality of the output should be 1");if(s[0]!==a)throw new Error("Shape of the output should be equal to logical row count");if(c.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(c[0]!==a)throw new Error("Shape of the intermediate results should be equal to logical row count");let h=H(e.session.backend.glContext.version),b=`
      float process(int[${et}] indices) {
        int logical_row_start_offset = indices[0] * ${o};

        float norm_factor = 0.0;
        float max = _Max(indices);
        for(int i=0; i<${o}; ++i)
        {
          norm_factor += exp(getColorAsFloat(${h.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${d}, ${$}))) - max);
        }

        return norm_factor;
      }`;return{...Ic$1,output:{dims:s,type:i.type,textureType:0},shaderSource:b}},Lb=(e,i,a,o,c,s)=>{let[d,$]=e.calculateTextureWidthAndHeight(i.dims,0),et=i.dims.length;if(a<1||o<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(c.length!==1||s.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(c[0]!==a||s[0]!==a)throw new Error("Shape of the intermediate results should be equal to logical row count");let h=`
      float process(int[${et}] indices) {

      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)
      int offset = coordsToOffset(TexCoords, ${d}, ${$});

      //determine the logical row for this index
      int logical_row_index[1];
      logical_row_index[0] = offset / ${o};

      float norm_factor = _Norm(logical_row_index);

      // avoid possible division by 0
      // if norm_facor is 0, all elements are zero
      // if so, return 0
      if(norm_factor == 0.0)
        return 0.0;

      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;
    }`;return{...Sc$1,output:{dims:i.dims,type:i.type,textureType:0},shaderSource:h}},Cc$1=e=>{if(!e||e.length!==1)throw new Error("Softmax requires 1 input.");if(e[0].type!=="float32"&&e[0].type!=="float64")throw new Error("Invalid input type")}}),$c$1,kc$1,Bc$1,Cb,Fb,$b,Nc$1=L(()=>{Ue$1(),fe$1(),ae(),$c$1={name:"Split",inputNames:["A"],inputTypes:[0]},kc$1=(e,i,a)=>{$b(i);let o=U$1.normalizeAxis(a.axis,i[0].dims.length),c=Cb(e,i,o,a),s=[];for(let d=0;d<c;++d)s.push(e.run({...$c$1,cacheHint:`${a.cacheKey};${d}`,get:()=>Fb(e,i[0],a,o,d)},i));return s},Bc$1=e=>{let i=e.attributes.getInt("axis",0),a=e.attributes.getInts("split",[]),o=e.outputs.length;return Q({axis:i,split:a,numOutputs:o})},Cb=(e,i,a,o)=>{let[,c]=an$1.splitShape(i[0].dims,a,o.split,o.numOutputs);return c.length},Fb=(e,i,a,o,c)=>{let[s,d]=an$1.splitShape(i.dims,o,a.split,a.numOutputs),$=d[c],et=s[c],h=`
      float process(int indices[${et.length}]) {
        indices[${o}] += ${$};
        return _A(indices);
      }
    `;return{...$c$1,cacheHint:`${a.cacheKey}:${c}`,output:{dims:et,type:i.type,textureType:0},shaderSource:h}},$b=e=>{if(!e||e.length!==1)throw new Error("Split requires one input.");if(e[0].type!=="int8"&&e[0].type!=="uint8"&&e[0].type!=="int16"&&e[0].type!=="uint16"&&e[0].type!=="int32"&&e[0].type!=="uint32"&&e[0].type!=="float32"&&e[0].type!=="float64"&&e[0].type!=="bool")throw new Error("Invalid input type.")}}),Ui$1,Rc$1,Mc$1,kb,Bb,Gc$1=L(()=>{fe$1(),Ui$1=(e,i,a)=>{kb(i);let o=U$1.squeezeShape(i[0].dims,a);return[e.reshapeUnpacked(i[0],o)]},Rc$1=(e,i)=>(Bb(i),Ui$1(e,[i[0]],Array.from(i[1].integerData))),Mc$1=e=>e.attributes.getInts("axes"),kb=e=>{if(!e||e.length!==1)throw new Error("Squeeze requires 1 input.");if(e[0].type==="string")throw new Error("invalid input tensor types.")},Bb=e=>{if(!e||e.length!==2)throw new Error("Squeeze requires 2 inputs.");if(e[1].type!=="int32")throw new Error("Invalid input type.")}}),Uc$1,Nb,Rb,zc$1=L(()=>{we$1(),ae(),Uc$1=(e,i)=>{Rb(i);let a={name:"Sum",inputNames:i.map((o,c)=>`X${c}`),inputTypes:new Array(i.length).fill(0)};return[e.run({...a,get:()=>Nb(e,i,a)},i)]},Nb=(e,i,a)=>{let o=H(e.session.backend.glContext.version),c=i[0].dims.slice(),s=`
      void main() {
        vec4 result = ${i.map((d,$)=>`${o.texture2D}(X${$},TexCoords)`).join(" + ")};
        ${o.output} = result;
      }
    `;return{...a,output:{dims:c,type:i[0].type,textureType:0},hasMain:!0,shaderSource:s}},Rb=e=>{if(!e||e.length===0)throw new Error("Sum requires inputs.");let i=e[0].dims.length;for(let a=1;a<e.length;a++){if(i!==e[a].dims.length)throw new Error("Input shapes are mismatched.");for(let o=0;o<i;o++)if(e[0].dims[o]!==e[a].dims[o])throw new Error("Input shapes are not matched.")}if(e[0].type!=="float32"&&e[0].type!=="float64")throw new Error("Invalid input type.");for(let a=1;a<e.length;a++)if(e[0].type!==e[a].type)throw new Error("Input types are not matched.")}}),Vc$1,Mb,Gb,Wc$1=L(()=>{pn(),ae(),Vc$1=(e,i)=>{Gb(i);let a={name:"Tile",inputNames:["A"],inputTypes:[0]};return[e.run({...a,get:()=>Mb(e,i,a)},i)]},Mb=(e,i,a)=>{let o=i[0].dims.slice(),c=new Array(o.length),s=[];for(let et=0;et<o.length;et++)c[et]=o[et]*i[1].numberData[et],s.push(`inputIdx[${et}] = int(mod(float(outputIdx[${et}]), ${o[et]}.));`);let d=c.length,$=`
      float process(int outputIdx[${d}]) {
        int inputIdx[${d}];
        ${s.join(`
`)}
        return _A(inputIdx);
      }
    `;return{...a,output:{dims:c,type:i[0].type,textureType:0},shaderSource:$}},Gb=e=>{if(!e||e.length!==2)throw new Error("Tile requires 2 input.");if(e[1].dims.length!==1)throw new Error("The second input shape must 1 dimension.");if(e[1].dims[0]!==e[0].dims.length)throw new Error("Invalid input shape.");if(Qt.indexOf(e[0].type)===-1)throw new Error("Invalid input type.");if(e[1].type!=="int32"&&e[1].type!=="int16")throw new Error("Invalid repeat type.")}}),zi$1,Hc$1,qc$1,Ub,zb,jc$1=L(()=>{fe$1(),zi$1=(e,i,a)=>{Ub(i);let o=U$1.unsqueezeShape(i[0].dims,a);return[e.reshapeUnpacked(i[0],o)]},Hc$1=(e,i)=>(zb(i),zi$1(e,[i[0]],Array.from(i[1].integerData))),qc$1=e=>e.attributes.getInts("axes"),Ub=e=>{if(!e||e.length!==1)throw new Error("Unsqueeze requires 1 input.");if(e[0].type==="string")throw new Error("invalid input tensor types.")},zb=e=>{if(!e||e.length!==2)throw new Error("Unsqueeze requires 2 inputs.");if(e[1].type!=="int32")throw new Error("Invalid input type.")}}),Yc$1,Xc$1=L(()=>{ol$1(),gl$1(),xl$1(),Sl$1(),to$2(),ff$1(),bf(),Tf(),vf(),Sf(),Ef(),Ff(),Nf(),ro$1(),Uf(),ec(),uc$1(),fc$1(),bc$1(),yc$1(),_c$1(),Fc$1(),Nc$1(),Gc$1(),zc$1(),Wc$1(),oo$1(),Ii(),jc$1(),Ni(),Yc$1=[["Abs","","6+",Al$1],["Acos","","7+",Pl$1],["Add","","7+",il$1],["And","","7+",al$1],["Asin","","7+",El$1],["Atan","","7+",Dl$1],["AveragePool","","7+",Vf,Wf],["BatchNormalization","","7+",rl$1,nl$1],["Cast","","6+",yl$1,Tl$1],["Ceil","","6+",Fl$1],["Clip","","6-10",_i,Ll$1],["Clip","","11+",Cl$1],["Concat","","4+",_l$1,Il$1],["Conv","","1+",Li$1,Ci],["ConvTranspose","","1+",uf$1,lf$1],["Cos","","7+",$l$1],["Div","","7+",sl$1],["Dropout","","7+",Oi$1],["DepthToSpace","","1+",hf$1,mf$1],["Equal","","7+",ul$1],["Elu","","6+",kl$1,Bl$1],["Exp","","6+",Nl$1],["Flatten","","1+",gf,yf],["Floor","","6+",Rl$1],["FusedConv","com.microsoft","1+",Li$1,Ci],["Gather","","1+",xf,wf],["Gemm","","7-10",Fi$1,Of],["Gemm","","11+",Fi$1,If],["GlobalAveragePool","","1+",qf,jf],["GlobalMaxPool","","1+",Zf],["Greater","","7+",ll$1],["Identity","","1+",Oi$1],["ImageScaler","","1+",Af,Pf],["InstanceNormalization","","6+",Lf,Cf],["LeakyRelu","","6+",Ml$1,Gl$1],["Less","","7+",fl$1],["LRN","","1+",$f,kf],["Log","","6+",Ul$1],["MatMul","","1+",ef$1,tf$1],["MaxPool","","1+",Yf,Xf],["Mul","","7+",cl$1],["Neg","","6+",zl$1],["Not","","1+",Vl$1],["Or","","7+",pl$1],["Pad","","2-10",$i,Rf],["Pad","","11+",Mf,Gf],["Pow","","7+",dl$1],["PRelu","","7+",hl$1],["ReduceLogSum","","1+",ac$1,er],["ReduceMax","","1+",nc$1,er],["ReduceMean","","1+",rc,er],["ReduceMin","","1+",oc$1,er],["ReduceProd","","1+",ic$1,er],["ReduceSum","","1-12",tc,er],["ReduceSumSquare","","1+",sc$1,er],["Relu","","6+",Wl$1],["Reshape","","5+",lc$1],["Resize","","10",Mi$1,hc],["Resize","","11+",Mi$1,mc$1],["Shape","","1+",gc$1],["Sigmoid","","6+",Hl$1],["Sin","","7+",ql$1],["Slice","","10+",vc$1],["Slice","","1-9",Tc$1,xc$1],["Softmax","","1-12",Ac$1,Pc$1],["Softmax","","13+",Dc$1,Ec$1],["Split","","2-12",kc$1,Bc$1],["Sqrt","","6+",jl$1],["Squeeze","","1-12",Ui$1,Mc$1],["Squeeze","","13+",Rc$1],["Sub","","7+",ml$1],["Sum","","6+",Uc$1],["Tan","","7+",Yl$1],["Tanh","","6+",Xl$1],["Tile","","6+",Vc$1],["Transpose","","1+",wr,pf$1],["Upsample","","7-8",ki,pc$1],["Upsample","","9",ki,dc$1],["Unsqueeze","","1-12",zi$1,qc$1],["Unsqueeze","","13+",Hc$1],["Xor","","7+",bl$1]]});function Jc$1(e){let i={},a;for(;(a=Kc$1.exec(e))!==null;){let o=a[3].split(",").map(c=>{let s=c.trim().split(" ");return s&&s.length===2?{type:s[0],name:s[1]}:null}).filter(c=>c!==null);i[a[2]]={params:o,body:a[4]}}for(let o in i){let c=Vb.replace("__FUNC__",o),s=new RegExp(c,"gm");for(;(a=s.exec(e))!==null;){let d=a[1],$=a[2],et=a[3].split(","),h=d?`${d} ${$};`:"",b=i[o].body,g="";i[o].params.forEach(($t,vt)=>{$t&&(g+=`${$t.type} ${$t.name} = ${et[vt]};
`)}),b=`${g}
 ${b}`,b=b.replace("return",`${$} = `);let st=`
      ${h}
      {
        ${b}
      }
      `;e=e.replace(a[0],st)}}return e=e.replace(Kc$1,""),e}var Kc$1,Vb,Zc$1=L(()=>{Kc$1=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm,Vb="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;"});function Mr(e,i){let a=[],o=[],c=i!=null&&Array.isArray(i)&&i.length===0,s=i==null||c?null:Wb(i,e).sort(),d=0;for(let $=0;$<e.length;++$){if(s!=null){if(s[d]===$&&e[$]!==1)throw new Error(`Can't squeeze axis ${$} since its dim '${e[$]}' is not 1`);(s[d]==null||s[d]>$)&&e[$]===1&&(a.push(e[$]),o.push($)),s[d]<=$&&d++}e[$]!==1&&(a.push(e[$]),o.push($))}return{newShape:a,keptDims:o}}function Wb(e,i){let a=i.length;return e=e==null?i.map((o,c)=>c):[].concat(e),Fr(e.every(o=>o>=-a&&o<a),()=>`All values in axis param must be in range [-${a}, ${a}) but got axis ${e}`),Fr(e.every(Hb),()=>`All values in axis param must be integers but got axis ${e}`),e.map(o=>o<0?a+o:o)}function Hb(e){return e%1===0}function qb(e){if(e.length===0)return 1;let i=e[0];for(let a=1;a<e.length;a++)i*=e[a];return i}function Qc$1(e){let i=Math.ceil(Math.sqrt(e));return[i,Math.ceil(e/i)]}var uo$1,Vi=L(()=>{lt$1(),fe$1(),uo$1=class{constructor(e){this.maxTextureSize=e}computeTextureWH(e,i){let a=this.computeTexture(e,i);return i&&i.isPacked&&(a[0]/=2,a[1]/=2),i&&i.reverseWH?[a[1],a[0]]:a}computeTexture(e,i){let a=i&&i.isPacked;if(e.length===0)return a?[2,2]:[1,1];let o=this.maxTextureSize;if(i&&i.breakAxis!==void 0){let d=i.breakAxis>=e.length?1:e.slice(i.breakAxis).reduce((et,h)=>et*h),$=i.breakAxis<=0?1:e.slice(0,i.breakAxis).reduce((et,h)=>et*h);if(d>o||$>o)ce.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${e}, breakAxis:${i.breakAxis}`);else return[d,$]}let c=e.slice(0);a&&(o=o*2,c=c.map((d,$)=>$>=c.length-2?c[$]%2===0?c[$]:c[$]+1:c[$]),c.length===1&&(c=[2,c[0]])),c.length!==2&&(c=Mr(c).newShape);let s=qb(c);return c.length<=1&&s<=o?[1,s]:c.length===2&&c[0]<=o&&c[1]<=o?c:c.length===3&&c[0]*c[1]<=o&&c[2]<=o?[c[0]*c[1],c[2]]:c.length===3&&c[0]<=o&&c[1]*c[2]<=o?[c[0],c[1]*c[2]]:c.length===4&&c[0]*c[1]*c[2]<=o&&c[3]<=o?[c[0]*c[1]*c[2],c[3]]:c.length===4&&c[0]<=o&&c[1]*c[2]*c[3]<=o?[c[0],c[1]*c[2]*c[3]]:a?Qc$1(s/4).map(d=>d*2):Qc$1(s)}}}),lo$1,ep$1=L(()=>{fe$1(),Wt$1(),we$1(),Vi(),Bt$1(),lo$1=class extends dt{constructor(e){super(e)}getFunctions(){return{...this.offsetToCoords(),...this.coordsToOffset(),...this.toVec(),...this.valueFrom(),...this.getCommonUtilFuncs(),...this.getInputsSamplingSnippets(),...this.getOutputSamplingSnippet()}}getCustomTypes(){return{}}offsetToCoords(){let e="offsetToCoords";return{offsetToCoords:new R(`
      vec2 ${e}(int offset, int width, int height) {
        int t = offset / width;
        int s = offset - t*width;
        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);
        return coords;
      }
      `)}}coordsToOffset(){let e="coordsToOffset";return{coordsToOffset:new R(`
      int ${e}(vec2 coords, int width, int height) {
        float s = coords.s * float(width);
        float t = coords.t * float(height);
        int offset = int(t) * width + int(s);
        return offset;
      }
      `)}}getOutputSamplingSnippet(){let e=this.context.outputTextureLayout;return e.isPacked?this.getPackedOutputSamplingSnippet(e):this.getUnpackedOutputSamplingSnippet(e)}getPackedOutputSamplingSnippet(e){let i=e.unpackedShape,a=[e.width,e.height],o={},c="getOutputCoords";switch(i.length){case 0:o[c]=this.getOutputScalarCoords();break;case 1:o[c]=this.getOutputPacked1DCoords(i,a);break;case 2:o[c]=this.getOutputPacked2DCoords(i,a);break;case 3:o[c]=this.getOutputPacked3DCoords(i,a);break;default:o[c]=this.getOutputPackedNDCoords(i,a)}let s=`
      void setOutput(vec4 val) {
        ${H(this.context.glContext.version).output} = val;
      }
    `,d="floatTextureSetRGBA";return o[d]=new R(s),o}getUnpackedOutputSamplingSnippet(e){let i=e.unpackedShape,a=[e.width,e.height],o={},c="getOutputCoords";switch(i.length){case 0:o[c]=this.getOutputScalarCoords();break;case 1:o[c]=this.getOutputUnpacked1DCoords(i,a);break;case 2:o[c]=this.getOutputUnpacked2DCoords(i,a);break;case 3:o[c]=this.getOutputUnpacked3DCoords(i,a);break;case 4:o[c]=this.getOutputUnpacked4DCoords(i,a);break;case 5:o[c]=this.getOutputUnpacked5DCoords(i,a);break;case 6:o[c]=this.getOutputUnpacked6DCoords(i,a);break;default:throw new Error(`Unsupported output dimensionality: ${i.length}`)}let s=`
        void setOutput(float val) {
          ${H(this.context.glContext.version).output} = vec4(val, 0, 0, 0);
        }
    `,d="floatTextureSetR";return o[d]=new R(s),o}getOutputScalarCoords(){return new R(`
      int getOutputCoords() {
        return 0;
      }
    `)}getOutputPacked1DCoords(e,i){let a=i,o="";return a[0]===1?(o=`
          int getOutputCoords() {
            return 2 * int(TexCoords.y * ${a[1]}.0);
          }
        `,new R(o)):a[1]===1?(o=`
          int getOutputCoords() {
            return 2 * int(TexCoords.x * ${a[0]}.0);
          }
        `,new R(o)):(o=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                 vec2(${a[0]}, ${a[1]}));
          return 2 * (resTexRC.y * ${a[0]} + resTexRC.x);
        }
      `,new R(o))}getOutputPacked2DCoords(e,i){let a="";if(hr$1.arraysEqual(e,i))return a=`
        ivec2 getOutputCoords() {
          return 2 * ivec2(TexCoords.xy * vec2(${i[0]}, ${i[1]}));
        }
      `,new R(a);let o=i,c=Math.ceil(e[1]/2);return a=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${o[0]}, ${o[1]}));

          int index = resTexRC.y * ${o[0]} + resTexRC.x;

          // reverse r and c order for packed texture
          int r = imod(index, ${c}) * 2;
          int c = 2 * (index / ${c});

          return ivec2(r, c);
        }
      `,new R(a)}getOutputPacked3DCoords(e,i){let a=[i[0],i[1]],o=Math.ceil(e[2]/2),c=o*Math.ceil(e[1]/2),s=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${a[0]}, ${a[1]}));
          int index = resTexRC.y * ${a[0]} + resTexRC.x;

          int b = index / ${c};
          index -= b * ${c};

          // reverse r and c order for packed texture
          int r = imod(index, ${o}) * 2;
          int c = 2 * (index / ${o});

          return ivec3(b, r, c);
        }
      `;return new R(s)}getOutputPackedNDCoords(e,i){let a=[i[0],i[1]],o=Math.ceil(e[e.length-1]/2),c=o*Math.ceil(e[e.length-2]/2),s=c,d="",$="b, r, c";for(let h=2;h<e.length-1;h++)s*=e[e.length-h-1],d=`
      int b${h} = index / ${s};
      index -= b${h} * ${s};
    `+d,$=`b${h}, `+$;let et=`
      ivec${e.length} getOutputCoords() {
        ivec2 resTexRC = ivec2(TexCoords.xy *
                              vec2(${a[0]}, ${a[1]}));
        int index = resTexRC.y * ${a[0]} + resTexRC.x;

        ${d}

        int b = index / ${c};
        index -= b * ${c};

        // reverse r and c order for packed texture
        int r = imod(index, ${o}) * 2;
        int c = 2 * (index / ${o});

        return ivec${e.length}(${$});
      }
    `;return new R(et)}getOutputUnpacked1DCoords(e,i){let a=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${i[0]}, ${i[1]}));
          return resTexRC.y * ${i[0]} + resTexRC.x;
        }
      `;return new R(a)}getOutputUnpacked2DCoords(e,i){let a=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${i[0]}, ${i[1]}));
          int index = resTexRC.y * ${i[0]} + resTexRC.x;
          int r = index / ${e[1]};
          int c = index - r * ${e[1]};
          return ivec2(r, c);
        }
      `;return new R(a)}getOutputUnpacked3DCoords(e,i){let a="",o=e.length,c=null;o<2&&(c=[]),c=new Array(o-1),c[o-2]=e[o-1];for(let $=o-3;$>=0;--$)c[$]=c[$+1]*e[$+1];let s=["r","c","d"],d=c.map(($,et)=>{let h=`int ${s[et]} = index / ${$}`,b=et===c.length-1?`int ${s[et+1]} = index - ${s[et]} * ${$}`:`index -= ${s[et]} * ${$}`;return`${h}; ${b};`}).join("");return a=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${i[0]}, ${i[1]}));
          int index = resTexRC.y * ${i[0]} + resTexRC.x;
          ${d}
          return ivec3(r, c, d);
        }
      `,new R(a)}getOutputUnpacked4DCoords(e,i){let a="",o=e.length,c=null;o<2&&(c=[]),c=new Array(o-1),c[o-2]=e[o-1];for(let $=o-3;$>=0;--$)c[$]=c[$+1]*e[$+1];let s=["r","c","d","d2"],d=c.map(($,et)=>{let h=`int ${s[et]} = index / ${$}`,b=et===c.length-1?`int ${s[et+1]} = index - ${s[et]} * ${$}`:`index -= ${s[et]} * ${$}`;return`${h}; ${b};`}).join("");return a=`
      ivec4 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${i[0]}, ${i[1]}));
          int index = resTexRC.y * ${i[0]} + resTexRC.x;
          ${d}
          return ivec4(r, c, d, d2);
        }
      `,new R(a)}getOutputUnpacked5DCoords(e,i){let a="",o=e.length,c=null;o<2&&(c=[]),c=new Array(o-1),c[o-2]=e[o-1];for(let $=o-3;$>=0;--$)c[$]=c[$+1]*e[$+1];let s=["r","c","d","d2","d3"],d=c.map(($,et)=>{let h=`int ${s[et]} = index / ${$}`,b=et===c.length-1?`int ${s[et+1]} = index - ${s[et]} * ${$}`:`index -= ${s[et]} * ${$}`;return`${h}; ${b};`}).join("");return a=`
      ivec5 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${i[0]}, ${i[1]}));
          int index = resTexRC.y * ${i[0]} + resTexRC.x;
          ${d}
          return ivec5(r, c, d, d2, d3);
        }
      `,new R(a)}getOutputUnpacked6DCoords(e,i){let a="",o=e.length,c=null;o<2&&(c=[]),c=new Array(o-1),c[o-2]=e[o-1];for(let $=o-3;$>=0;--$)c[$]=c[$+1]*e[$+1];let s=["r","c","d","d2","d3","d4"],d=c.map(($,et)=>{let h=`int ${s[et]} = index / ${$}`,b=et===c.length-1?`int ${s[et+1]} = index - ${s[et]} * ${$}`:`index -= ${s[et]} * ${$}`;return`${h}; ${b};`}).join("");return a=`
     ivec6 getOutputCoords() {
         ivec2 resTexRC = ivec2(TexCoords.xy *
                               vec2(${i[0]}, ${i[1]}));
         int index = resTexRC.y * ${i[0]} + resTexRC.x;
         ${d}
         return ivec6(r, c, d, d2, d3, d4);
       }
     `,new R(a)}getCommonUtilFuncs(){let e={},i="uvFromFlat";e[i]=new R(`
    vec2 uvFromFlat(int texNumR, int texNumC, int index) {
      int texC = index / texNumR;
      int texR = index - texC * texNumR;
      // TODO: swap texR, texC order in following function so row is corresponding to u and column is corresponding to
      //       v.
      return (vec2(texR, texC) + halfCR) / vec2(texNumR, texNumC);
    }
    `),i="packedUVfrom1D",e[i]=new R(`
      vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
        int texelIndex = index / 2;
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),i="packedUVfrom2D",e[i]=new R(`
      vec2 packedUVfrom2D(int texNumR, int texNumC, int texelsInLogicalRow, int row, int col) {
        int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),i="packedUVfrom3D",e[i]=new R(`
      vec2 packedUVfrom3D(int texNumR, int texNumC,
          int texelsInBatch, int texelsInLogicalRow, int b,
          int row, int col) {
        int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = index / texNumC;
        int texC = index - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),i="sampleTexture";let a=H(this.context.glContext.version);return e[i]=new R(`
        float sampleTexture(sampler2D textureSampler, vec2 uv) {
            return ${a.texture2D}(textureSampler, uv).r;
        }`),e}getInputsSamplingSnippets(){let e={},i=this.context.outputTextureLayout;return this.context.programInfo.inputNames.forEach((a,o)=>{let c=this.context.inputTextureLayouts[o],s=Yn$1(a);c.isPacked?e[s]=this.getPackedSamplerFromInput(s,a,c):e[s]=this.getUnpackedSamplerFromInput(s,a,c);let d=Gu$1(a);c.unpackedShape.length<=i.unpackedShape.length&&(c.isPacked?e[d]=this.getPackedSamplerAtOutputCoords(d,c,i,a):e[d]=this.getUnpackedSamplerAtOutputCoords(d,c,i,a))}),e}getPackedSamplerAtOutputCoords(e,i,a,o){let c=i.unpackedShape,s=a.unpackedShape,d=Yn$1(o),$=c.length,et=s.length,h=Ze$1.getBroadcastDims(c,s),b=Qe(et),g=et-$,st,$t=Dt$1();$===0?st="":et<2&&h.length>=1?st="coords = 0;":st=h.map(jr=>`coords.${$t[jr+g]} = 0;`).join(`
`);let vt="";et<2&&$>0?vt="coords":vt=c.map((jr,Hr)=>`coords.${$t[Hr+g]}`).join(", ");let Ft="return outputValue;",Gt=U$1.size(c)===1,qt=U$1.size(s)===1;if($===1&&!Gt&&!qt)Ft=`
        return vec4(outputValue.xy, outputValue.xy);
      `;else if(Gt&&!qt)et===1?Ft=`
          return vec4(outputValue.x, outputValue.x, 0., 0.);
        `:Ft=`
          return vec4(outputValue.x);
        `;else if(h.length){let jr=$-2,Hr=$-1;h.indexOf(jr)>-1&&h.indexOf(Hr)>-1?Ft="return vec4(outputValue.x);":h.indexOf(jr)>-1?Ft="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":h.indexOf(Hr)>-1&&(Ft="return vec4(outputValue.xx, outputValue.zz);")}let Lt=`
        int lastDim = coords.${$t[et-1]};
        coords.${$t[et-1]} = coords.${$t[et-2]};
        coords.${$t[et-2]} = lastDim;
      `,rr=`
      vec4 ${e}() {
        ${b} coords = getOutputCoords();
        ${Lt}
        ${st}
        vec4 outputValue = ${d}(${vt});
        ${Ft}
      }
    `;return new R(rr,["coordinates.getOutputCoords"])}getUnpackedSamplerAtOutputCoords(e,i,a,o){let c=[a.width,a.height],s=[i.width,i.height],d=i.unpackedShape.length,$=a.unpackedShape.length,et=i.unpackedShape,h=a.unpackedShape,b=Yn$1(o);if(d===$&&hr$1.arraysEqual(s,c)){let Lt=`
          float ${e}() {
            return sampleTexture(${o}, TexCoords);
          }
        `;return new R(Lt,["coordinates.sampleTexture"])}let g=Qe($),st=Ze$1.getBroadcastDims(et,h),$t=$-d,vt,Ft=Dt$1();d===0?vt="":$<2&&st.length>=1?vt="coords = 0;":vt=st.map(Lt=>`coords.${Ft[Lt+$t]} = 0;`).join(`
`);let Gt="";$<2&&d>0?Gt="coords":Gt=i.unpackedShape.map((Lt,rr)=>`coords.${Ft[rr+$t]}`).join(", ");let qt=`
        float ${e}() {
          ${g} coords = getOutputCoords();
          ${vt}
          return ${b}(${Gt});
        }
      `;return new R(qt,["coordinates.getOutputCoords"])}getPackedSamplerFromInput(e,i,a){switch(a.unpackedShape.length){case 0:return this.getPackedSamplerScalar(e,i);case 1:return this.getPackedSampler1D(e,i,a);case 2:return this.getPackedSampler2D(e,i,a);case 3:return this.getPackedSampler3D(e,i,a);default:return this.getPackedSamplerND(e,i,a)}}getUnpackedSamplerFromInput(e,i,a){let o=a.unpackedShape;switch(o.length){case 0:return this.getUnpackedSamplerScalar(e,i,a);case 1:return this.getUnpackedSampler1D(e,i,a);case 2:return this.getUnpackedSampler2D(e,i,a);case 3:return this.getUnpackedSampler3D(e,i,a);case 4:return this.getUnpackedSampler4D(e,i,a);case 5:return this.getUnpackedSampler5D(e,i,a);case 6:return this.getUnpackedSampler6D(e,i,a);default:throw new Error(`Unsupported dimension ${o.length}-D`)}}getPackedSamplerScalar(e,i){let a=H(this.context.glContext.version),o=`
          vec4 ${e}() {
            return ${a.texture2D}(${i}, halfCR);
          }
        `;return new R(o)}getPackedSampler1D(e,i,a){let o=[a.width,a.height],c=[o[1],o[0]],s=H(this.context.glContext.version),d=`vec4 ${e}(int index) {
      vec2 uv = packedUVfrom1D(
      ${c[0]}, ${c[1]}, index);
      return ${s.texture2D}(${i}, uv);
    }`;return new R(d,["coordinates.packedUVfrom1D"])}getPackedSampler2D(e,i,a){let o=a.unpackedShape,c=[a.width,a.height],s=H(this.context.glContext.version),d=c[0],$=c[1];if(c!=null&&hr$1.arraysEqual(o,c)){let g=`vec4 ${e}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${$}.0, ${d}.0);
        return ${s.texture2D}(${i}, uv);
      }`;return new R(g)}let et=c,h=Math.ceil(o[1]/2),b=`vec4 ${e}(int row, int col) {
      vec2 uv = packedUVfrom2D(${et[1]}, ${et[0]}, ${h}, row, col);
      return ${s.texture2D}(${i}, uv);
    }`;return new R(b,["coordinates.packedUVfrom2D"])}getPackedSampler3D(e,i,a){let o=a.unpackedShape,c=[a.width,a.height],s=[c[0],c[1]],d=H(this.context.glContext.version);if(o[0]===1){let st=o.slice(1),$t=[1,2],vt=$r(o,st),Ft=["b","row","col"],Gt=JSON.parse(JSON.stringify(a));Gt.unpackedShape=vt;let qt=this.getPackedSamplerFromInput(e,i,Gt),Lt=`${qt.routineBody}
      vec4 ${e}(int b, int row, int col) {
        return ${e}(${kr$1(Ft,$t)});
      } `;return new R(Lt,qt.dependencies)}let $=s[0],et=s[1],h=Math.ceil(o[2]/2),b=h*Math.ceil(o[1]/2),g=`vec4 ${e}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${et}, ${$}, ${b}, ${h}, b, row, col);
      return ${d.texture2D}(${i}, uv);}`;return new R(g,["coordinates.packedUVfrom3D"])}getPackedSamplerND(e,i,a){let o=a.unpackedShape,c=o.length,s=[a.width,a.height],d=H(this.context.glContext.version),$=[s[0],s[1]],et=$[1],h=$[0],b=Math.ceil(o[c-1]/2),g=b*Math.ceil(o[c-2]/2),st="int b, int row, int col",$t=`b * ${g} + (row / 2) * ${b} + (col / 2)`;for(let Ft=2;Ft<c-1;Ft++)st=`int b${Ft}, `+st,g*=o[c-Ft-1],$t=`b${Ft} * ${g} + `+$t;let vt=`vec4 ${e}(${st}) {
      int index = ${$t};
      int texR = index / ${h};
      int texC = index - texR * ${h};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}, ${et});
      return ${d.texture2D}(${i}, uv);
    }`;return new R(vt)}getUnpackedSamplerScalar(e,i,a){let[o,c]=[a.width,a.height];if(o===1&&c===1){let d=`
          float ${e}() {
            return sampleTexture(${i}, halfCR);
          }
        `;return new R(d,["coordinates.sampleTexture"])}let s=`
        float ${e}() {
          int offset_${i} = coordsToOffset(TexCoords, ${o}, ${c});
          vec2 uv = uvFromFlat(${o}, ${c}, offset_${i});
          return sampleTexture(${i}, uv);
        }
      `;return new R(s,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler1D(e,i,a){let o=a.width,c=a.height;if(c===1&&o===1){let d=`
        float ${e}(int index) {
          return sampleTexture(${i}, halfCR);
        }
      `;return new R(d,["coordinates.sampleTexture"])}if(c===1){let d=`
          float ${e}(int index) {
            vec2 uv = vec2((float(index) + 0.5) / ${o}.0, 0.5);
            return sampleTexture(${i}, uv);
          }
        `;return new R(d,["coordinates.sampleTexture"])}if(o===1){let d=`
          float ${e}(int index) {
            vec2 uv = vec2(0.5, (float(index) + 0.5) / ${c}.0);
            return sampleTexture(${i}, uv);
          }
        `;return new R(d,["coordinates.sampleTexture"])}let s=`
        float ${e}(int index) {
          vec2 uv = uvFromFlat(${o}, ${c}, index);
          return sampleTexture(${i}, uv);
        }
      `;return new R(s,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler2D(e,i,a){let o=a.unpackedShape,c=[a.height,a.width];if(c!=null&&hr$1.arraysEqual(o,c)){let g=c[1],st=c[0],$t=`
          float ${e}(int row, int col) {
            vec2 uv = (vec2(row, col) + halfCR) / vec2(${g}.0, ${st}.0);
            return sampleTexture(${i}, uv);
          }
        `;return new R($t,["coordinates.sampleTexture"])}let{newShape:s,keptDims:d}=Mr(o),$=s;if($.length<o.length){let g=$r(o,$),st=JSON.parse(JSON.stringify(a));st.unpackedShape=g;let $t=["col","row"],vt=`
          ${this.getUnpackedSamplerFromInput(e,i,st).routineBody}
          float ${e}(int row, int col) {
            return ${e}(${kr$1($t,d)});
          }
        `;return new R(vt,["coordinates.sampleTexture"])}let et=c[1],h=c[0];if(h===1){let g=`
          float ${e}(int row, int col) {
            int offset_${i} = coordsToOffset(TexCoords, ${et}, ${h});
            float index = dot(vec3(row, col, offset_${i}), vec3(${o[1]}, 1, 1));
            vec2 uv = vec2(0.5, (index + 0.5) / ${et}.0);
            return sampleTexture(${i}, uv);
          }
        `;return new R(g,["coordinates.sampleTexture","coordinates.coordsToOffset"])}if(et===1){let g=`
          float ${e}(int row, int col) {
            int offset_${i} = coordsToOffset(TexCoords, ${et}, ${h});
            float index = dot(vec3(row, col, offset_${i}), vec3(${o[1]}, 1, 1));
            vec2 uv = vec2((index + 0.5) / ${h}.0, 0.5);
            return sampleTexture(${i}, uv);
          }
        `;return new R(g,["coordinates.sampleTexture","coordinates.coordsToOffset"])}let b=`
        float ${e}(int row, int col) {
          int index = col * ${o[1]} + row;
          vec2 uv = uvFromFlat(${et}, ${h}, index);
          return sampleTexture(${i}, uv);
        }
      `;return new R(b,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler3D(e,i,a){let o=a.unpackedShape,c=o[1]*o[2],s=o[2],{newShape:d,keptDims:$}=Mr(o),et=d;if(et.length<o.length){let st=$r(o,et),$t=["batch","col","row"],vt=JSON.parse(JSON.stringify(a));vt.unpackedShape=st;let Ft=this.getUnpackedSamplerFromInput(e,i,vt),Gt=$.reverse(),qt=`
          ${Ft.routineBody}
          float ${e}(int batch, int row, int col) {
            return ${e}(${kr$1($t,Gt)});
          }
        `;return new R(qt,Ft.dependencies)}let h=a.width,b=a.height,g=`
          float ${e}(int depth, int row, int col) {
            // Explicitly use integer operations as dot() only works on floats.
            int index = depth * ${c} + col * ${s} + row;
            vec2 uv = uvFromFlat(${h}, ${b}, index);
            return sampleTexture(${i}, uv);
          }
      `;return new R(g,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler4D(e,i,a){let o=a.unpackedShape,c=o[3],s=o[2]*c,d=o[1]*s,$=a.width,et=a.height,h=`
        float ${e}(int row, int col, int depth, int depth2) {
          int index = row * ${d} + col * ${s} +
              depth2 * ${c} + depth;
          vec2 uv = uvFromFlat(${$}, ${et}, index);
          return sampleTexture(${i}, uv);
        }
      `;return new R(h,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler5D(e,i,a){let o=a.unpackedShape,c=o[4],s=o[3]*c,d=o[2]*s,$=o[1]*d,{newShape:et,keptDims:h}=Mr(o);if(et.length<o.length){let $t=$r(o,et),vt=["row","col","depth","depth2","depth3"],Ft=JSON.parse(JSON.stringify(a));Ft.unpackedShape=$t;let Gt=`
          ${this.getUnpackedSamplerFromInput(e,i,Ft).routineBody}
          float ${e}(int row, int col, int depth, int depth2, int depth3) {
            return ${e}(${kr$1(vt,h)});
          }
        `;return new R(Gt,["coordinates.sampleTexture","coordinates.uvFromFlat"])}let b=a.width,g=a.height,st=`
        float ${e}(int row, int col, int depth, int depth2, int depth3) {
          int index = row * ${$} + col * ${d} + depth * ${s} +
          depth3 * ${c} + depth2;
          vec2 uv = uvFromFlat(${b}, ${g}, index);
          return sampleTexture(${i}, uv);
        }
      `;return new R(st,["coordinates.sampleTexture","coordinates.uvFromFlat"])}getUnpackedSampler6D(e,i,a){let o=a.unpackedShape,c=o[5],s=o[4]*c,d=o[3]*s,$=o[2]*d,et=o[1]*$,{newShape:h,keptDims:b}=Mr(o);if(h.length<o.length){let vt=$r(o,h),Ft=["row","col","depth","depth2","depth3","depth4"],Gt=JSON.parse(JSON.stringify(a));Gt.unpackedShape=vt;let qt=`
            ${this.getUnpackedSamplerFromInput(e,i,Gt).routineBody}
            float ${e}(int row, int col, int depth,
              int depth2, int depth3, int depth4) {
              return ${e}(${kr$1(Ft,b)});
            }
          `;return new R(qt,["coordinates.sampleTexture","coordinates.uvFromFlat"])}let g=a.width,st=a.height,$t=`
          float ${e}(int row, int col, int depth,
            int depth2, int depth3, int depth4) {
            int index = row * ${et} + col * ${$} + depth * ${d} +
            depth2 * ${s} + depth3 * ${c} + depth4;
            vec2 uv = uvFromFlat(${g}, ${st}, index);
            return sampleTexture(${i}, uv);
          }
        `;return new R($t,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}toVec(){let e=this.context.outputTextureLayout,i=e.shape.length,a=e.strides,o=e.width,c=e.height,s=[];for(let $=0;$<i-1;++$)s.push(`
        c[${$}] = offset / ${a[$]};`),s.push(`
        offset -= c[${$}] * ${a[$]};`);s.push(`
        c[${i-1}] = offset;`);let d=`
      void toVec(vec2 texCoords, out int c[${i}]) {
        int offset = coordsToOffset(texCoords, ${o}, ${c});
        ${s.join("")}
      }
      void toVec(int offset, out int c[${i}]) {
        ${s.join("")}
      }
    `;return{toVec:new R(d,["coordinates.coordsToOffset"])}}valueFrom(){let e={};return this.context.programInfo.inputNames.forEach((i,a)=>{let o=this.context.inputTextureLayouts[a],c=(o.unpackedShape.length>0?o.unpackedShape:o.shape).length,s=`_${i}`;e[s]=new R(this.getValueFromSingle(i,c,o.width,o.height,!1),[`shapeUtils.indicesToOffset${s}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),s=s+"_T",e[s]=new R(this.getValueFromSingle(i,c,o.width,o.height,!0),[`shapeUtils.indicesToOffset${s}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"])}),e}getValueFromSingle(e,i,a,o,c){let s=`_${e}`;c&&(s=s+"_T");let d=H(this.context.glContext.version);return`
        float ${s}(int m[${i}]) {
          int offset = indicesToOffset${s}(m);
          vec2 coords = offsetToCoords(offset, ${a}, ${o});
          float value = getColorAsFloat(${d.texture2D}(${e}, coords));
          return value;
        }
        `}getPackedValueFrom(e,i,a,o,c){let s=`_${e}_Pack`;c&&(s=s+"_T");let d=H(this.context.glContext.version);return`
        vec4 ${s}(int m[${i}]) {
          int offset = indicesToOffset_${e}(m);
          vec2 coords = offsetToCoords(offset, ${a}, ${o});
          return ${d.texture2D}(${e}, coords);
        }
        `}}}),fo$1,tp$1=L(()=>{Wt$1(),fo$1=class X2 extends dt{constructor(i){super(i)}getFunctions(){return{...this.encodeFloat32(),...this.decodeFloat32()}}getCustomTypes(){return{}}encodeFloat32(){return{encode:new R(`highp vec4 encode(highp float f) {
        return vec4(f, 0.0, 0.0, 0.0);
      }
        `)}}decodeFloat32(){return{decode:new R(`highp float decode(highp vec4 rgba) {
        return rgba.r;
      }
        `)}}encodeUint8(){let i=X2.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new R(`
      highp vec4 encode(highp float f) {
        highp float F = abs(f);
        highp float Sign = step(0.0,-f);
        highp float Exponent = floor(log2(F));
        highp float Mantissa = (exp2(- Exponent) * F);
        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));
        highp vec4 rgba;
        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));
        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);
        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));
        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));
        ${i}
        rgba = rgba / 255.0; // values need to be normalized to [0,1]
        return rgba;
    }
        `)}}decodeUint8(){let i=X2.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new R(`
        highp float decode(highp vec4 rgba) {
          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]
          ${i}
          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;
          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;
          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);
          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));
          return Result;
      }
        `)}}static isLittleEndian(){let i=new ArrayBuffer(4),a=new Uint32Array(i),o=new Uint8Array(i);if(a[0]=3735928559,o[0]===239)return!0;if(o[0]===222)return!1;throw new Error("unknown endianness")}}}),co$1,rp$1=L(()=>{Wt$1(),we$1(),co$1=class extends dt{constructor(e){super(e)}getFunctions(){return{...this.setFragColor(),...this.getColorAsFloat()}}getCustomTypes(){return{}}setFragColor(){let e=H(this.context.glContext.version);return{setFragColor:new R(`
        void setFragColor(float value) {
            ${e.output} = encode(value);
        }
        `,["encoding.encode"])}}getColorAsFloat(){return{getColorAsFloat:new R(`
        float getColorAsFloat(vec4 color) {
            return decode(color);
        }
        `,["encoding.decode"])}}}}),po$1,np$1=L(()=>{Wt$1(),po$1=class nw extends dt{constructor(i){super(i)}getFunctions(){return{...this.bcastIndex(),...this.bcastMatmulIndex(),...this.offsetToIndices(),...this.indicesToOffset(),...this.incrementIndices()}}getCustomTypes(){return{}}bcastIndex(){let i=this.context.outputTextureLayout.shape.length,a={};return this.context.programInfo.inputNames.forEach((o,c)=>{let s=this.context.inputTextureLayouts[c].unpackedShape;if(s.length<=i){let d=s.length,$=i-d,et=`bcastIndices_${o}`,h="";for(let g=0;g<d;++g)h+=`
          realIndices[${g}] = int( mod(float(bcastedIndices[${$+g}]), ${s[g]}.0) );
          `;let b=`
        void ${et} (int bcastedIndices[${i}], out int realIndices[${d}]) {
          ${h}
        }
        `;a[et]=new R(b)}}),a}bcastMatmulIndex(){let i=this.context.outputTextureLayout.shape.length,a={};return this.context.programInfo.inputNames.forEach((o,c)=>{let s=this.context.inputTextureLayouts[c].shape;if(!(s.length<2||s.length>i)){let d=s.length,$=i-d,et=`bcastMatmulIndices_${o}`,h="";for(let g=0;g<d-2;++g)h+=`
          realIndices[${g}] = int( mod(float(bcastedIndices[${$+g}]), ${s[g]}.0) );
          `;let b=`
        void ${et}(int bcastedIndices[${i}], out int realIndices[${d}]) {
          ${h}
          realIndices[${d-1}] = bcastedIndices[${i-1}];
          realIndices[${d-2}] = bcastedIndices[${i-2}];
        }
        `;a[et]=new R(b)}}),a}indicesToOffset(){let i={};return this.context.programInfo.inputNames.forEach((a,o)=>{let c=this.context.inputTextureLayouts[o].shape,s=this.context.inputTextureLayouts[o].strides,d=c.length,$=`indicesToOffset_${a}`;i[$]=new R(nw.indexToOffsetSingle($,d,s)),$=`indicesToOffset_${a}_T`,i[$]=new R(nw.indexToOffsetSingle($,d,s.slice().reverse()))}),i}static indexToOffsetSingle(i,a,o){let c="";for(let s=a-1;s>=0;--s)c+=`
        offset += indices[${s}] * ${o[s]};
        `;return`
      int ${i}(int indices[${a}]) {
        int offset = 0;
        ${c}
        return offset;
      }
      `}offsetToIndices(){let i={};return this.context.programInfo.inputNames.forEach((a,o)=>{let c=this.context.inputTextureLayouts[o].shape,s=this.context.inputTextureLayouts[o].strides,d=c.length,$=`offsetToIndices_${a}`;i[$]=new R(nw.offsetToIndicesSingle($,d,s)),$=`offsetToIndices_${a}_T`,i[$]=new R(nw.offsetToIndicesSingle($,d,s.slice().reverse()))}),i}static offsetToIndicesSingle(i,a,o){let c=[];for(let s=0;s<a-1;++s)c.push(`
      indices[${s}] = offset / ${o[s]};`),c.push(`
        offset -= indices[${s}] * ${o[s]};`);return c.push(`
      indices[${a-1}] = offset;`),`
      void ${i}(int offset, out int indices[${a}]) {
        ${c.join("")}
      }
      `}incrementIndices(){let i={};return this.context.programInfo.inputNames.forEach((a,o)=>{let c=this.context.inputTextureLayouts[o].shape,s=c.length,d=`incrementIndices_${a}`,$="";for(let h=0;h<s;++h)$+=`
        shape[${h}] = ${c[h]};`;let et=`
        void ${d}(int axis, out int indices[${s}]) {
          int shape[${s}];
          ${$};
          for(int i = ${s} -1 ; i >= 0; --i) {
            if(i > axis) continue;
            indices[i] += 1;
            if(indices[i] < shape[i]) {
              break;
            }
            indices[i] = 0;
          }
        }
        `;i[d]=new R(et)}),i}}}),ho$1,op$1=L(()=>{Wt$1(),ho$1=class extends dt{constructor(e){super(e)}getCustomTypes(){return{}}getFunctions(){return{...this.binaryVecFunctions(),...this.copyVec(),...this.setVecItem(),...this.getVecItem()}}binaryVecFunctions(){let e=this.context.outputTextureLayout.shape.length,i={add:"+=",sub:"-=",mul:"*=",div:"/="},a={};for(let o in i){let c=`${o}Vec`,s="";for(let $=0;$<e;++$)s+=`
          dest[${$}] ${i[o]} src[${$}];
          `;let d=`
        void ${c}(int src[${e}], out int dest[${e}]) {
          ${s}
        }
        `;a[c]=new R(d)}return a}copyVec(){let e=this.context.outputTextureLayout.shape.length,i="";for(let o=0;o<e;++o)i+=`
        dest[${o}] = src[${o}];
        `;let a=`
      void copyVec(int src[${e}], out int dest[${e}]) {
        ${i}
      }
      `;return{copyVec:new R(a)}}setVecItem(){let e=this.context.outputTextureLayout.shape.length,i=`
        if(index < 0)
            index =${e} + index;
        if (index == 0)
            m[0] = value;
        `;for(let o=1;o<e-1;++o)i+=`
        else if (index == ${o})
            m[${o}] = value;
            `;i+=`
        else
            m[${e-1}] = value;
        `;let a=`
      void setVecItem(out int m[${e}], int index, int value) {
        ${i}
      }
        `;return{setVecItem:new R(a)}}getVecItem(){let e=this.context.outputTextureLayout.shape.length,i=`
        if(index < 0)
            index = ${e} + index;
        if (index == 0)
            return m[0];
      `;for(let o=1;o<e-1;++o)i+=`
        else if (index == ${o})
            return m[${o}];
      `;i+=`
        else
            return m[${e-1}];
        `;let a=`
      int getVecItem(int m[${e}], int index) {
        ${i}
      }
    `;return{getVecItem:new R(a)}}}}),Wi$1,ip$1=L(()=>{ep$1(),tp$1(),rp$1(),np$1(),op$1(),Wi$1={encoding:fo$1,fragcolor:co$1,vec:ho$1,shapeUtils:po$1,coordinates:lo$1}}),mo$1,ap$1=L(()=>{Wt$1(),Zc$1(),ip$1(),we$1(),mo$1=class{constructor(e,i,a,o){this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new Zn$1(e,i,a,o),Object.keys(Wi$1).forEach(s=>{let d=new Wi$1[s](this.context);this.libs[s]=d});let c=this.glslLibRoutineDependencyGraph;for(let s in this.libs){let d=this.libs[s].getFunctions();for(let $ in d){let et=s+"."+$,h;c[et]?(h=c[et],h.routineBody=d[$].routineBody):(h=new cn(et,d[$].routineBody),c[et]=h);let b=d[$].dependencies;if(b)for(let g=0;g<b.length;++g)if(c[b[g]])h.addDependency(c[b[g]]);else{let st=new cn(b[g]);c[b[g]]=st,h.addDependency(st)}}}}preprocess(){let e=this.context.programInfo,i=e.shaderSource;return this.context.programInfo.hasMain||(i=`${i}
      ${Mu$1(this.context.glContext.version,this.context.outputTextureLayout.shape.length)}`),i=Jc$1(i),`${Ru$1(this.context.glContext.version)}
    ${this.getUniforms(e.inputNames,e.variables)}
    ${this.getImports(i)}
    ${i}`}getImports(e){let i=this.selectGlslLibRoutinesToBeIncluded(e);if(i.length===0)return"";let a="";for(let o=0;o<i.length;++o)if(i[o].routineBody)a+=i[o].routineBody+`
`;else throw new Error(`Missing body for the Glsl Library routine: ${i[o].name}`);return a}selectGlslLibRoutinesToBeIncluded(e){let i=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach(a=>{let o=a.split(".")[1];e.indexOf(o)!==-1&&i.push(this.glslLibRoutineDependencyGraph[a])}),Qn$1.returnOrderedNodes(i)}getUniforms(e,i){let a=[];if(e)for(let o of e)a.push(`uniform sampler2D ${o};`);if(i)for(let o of i)a.push(`uniform ${o.type} ${o.name}${o.arrayLength?`[${o.arrayLength}]`:""};`);return a.join(`
`)}}}),bo$1,sp$1=L(()=>{Ot$1(),lt$1(),ap$1(),we$1(),bo$1=class{constructor(e,i,a){this.profiler=e,this.glContext=i,this.textureLayoutStrategy=a,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,i){this.repo.set(e,i)}run(e,i,a){this.profiler.event("op",`ProgramManager.run ${e.programInfo.name??"unknown kernel"}`,()=>{let o=this.glContext.gl,c=e.program;o.useProgram(c);try{this.bindOutput(a),this.attributesBound||this.bindAttributes(e.attribLocations),this.bindUniforms(e.uniformLocations,e.programInfo.variables??[],i)}catch(s){throw ce.error("ProgramManager",e.programInfo.shaderSource),s}this.profiler.event("backend","GlContext.draw()",()=>{this.glContext.draw()})},this.glContext)}dispose(){this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach(e=>this.glContext.deleteProgram(e.program))}build(e,i,a){return this.profiler.event("backend","ProgramManager.build",()=>{let o=new mo$1(this.glContext,e,i,a),c=o.preprocess(),s=this.compile(c);return{programInfo:e,program:s,uniformLocations:this.getUniformLocations(s,o.context.programInfo.inputNames,o.context.programInfo.variables),attribLocations:this.getAttribLocations(s)}})}compile(e){if(!this.vertexShader){ce.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");let o=Nu$1(this.glContext.version);this.vertexShader=this.glContext.compileShader(o,this.glContext.gl.VERTEX_SHADER)}Z.debug&&ce.verbose("ProrgramManager",`FragShader:
${e}
`);let i=this.glContext.compileShader(e,this.glContext.gl.FRAGMENT_SHADER),a=this.glContext.createProgram(this.vertexShader,i);return this.glContext.deleteShader(i),a}bindOutput(e){let i=e.width,a=e.height;ce.verbose("ProrgramManager",`Binding output texture to Framebuffer: w/h=${i}/${a}, shape=${e.shape}, type=${e.tensor.type}`),this.glContext.attachFramebuffer(e.texture,i,a)}bindAttributes(e){let i=e.position,a=e.textureCoord;this.glContext.setVertexAttributes(i,a),this.attributesBound=!0}bindUniforms(e,i,a){var s;let o=this.glContext.gl,c=0;for(let{name:d,type:$,location:et,arrayLength:h}of e){let b=(s=i.find(g=>g.name===d))==null?void 0:s.data;if($!=="sampler2D"&&!b)throw new Error(`variable '${d}' does not have data defined in program info`);switch($){case"sampler2D":this.bindTexture(a[c],et,c),c++;break;case"float":h?o.uniform1fv(et,b):o.uniform1f(et,b);break;case"int":h?o.uniform1iv(et,b):o.uniform1i(et,b);break;default:throw new Error(`Uniform not implemented: ${$}`)}}}bindTexture(e,i,a){this.glContext.bindTextureToUniform(e.texture,a,i)}getAttribLocations(e){return{position:this.getAttribLocation(e,"position"),textureCoord:this.getAttribLocation(e,"textureCoord")}}getUniformLocations(e,i,a){let o=[];if(i)for(let c of i)o.push({name:c,type:"sampler2D",location:this.getUniformLocation(e,c)});if(a)for(let c of a)o.push({...c,location:this.getUniformLocation(e,c.name)});return o}getUniformLocation(e,i){let a=this.glContext.gl.getUniformLocation(e,i);if(a===null)throw new Error(`Uniform ${i} not found.`);return a}getAttribLocation(e,i){return this.glContext.gl.getAttribLocation(e,i)}}}),go$1,up$1=L(()=>{lt$1(),ln(),go$1=class{constructor(e,i,a,o){this.glContext=e,this.layoutStrategy=i,this.profiler=a,this.config=o,this.pendingRead=new Map,o.reuseTextures&&(this.inUseTextures=new Map,this.idleTextures=new Map,this.textureLookup=new Map)}createTextureFromLayout(e,i,a,o){let c=this.toEncoderType(e),s=this.glContext.getEncoder(c,i.channels||1,o);if(i.isPacked&&o===1)throw new Error("not implemented");let d=i.width,$=i.height,et,h;if(this.config.reuseTextures){et=`${d}x${$}_${s.format}_${s.internalFormat}_${s.textureType}`,h=this.inUseTextures.get(et),h||(h=[],this.inUseTextures.set(et,h));let g=this.idleTextures.get(et);if(g&&g.length>0){let st=g.pop();return h.push(st),o===1&&this.glContext.updateTexture(st,d,$,s,this.toTextureData(e,a)),st}}ce.verbose("TextureManager",`Creating new texture of size ${i.width}x${i.height}`);let b=this.glContext.allocateTexture(d,$,s,this.toTextureData(e,a));return this.config.reuseTextures&&(h.push(b),this.textureLookup.set(b,et)),b}readTexture(e,i,a){return a||(a=1),this.profiler.event("backend","TextureManager.readTexture",()=>{let o=e.shape.reduce((s,d)=>s*d)*a,c=this.glContext.readTexture(e.texture,e.width,e.height,o,this.toEncoderType(i),a);return this.toTensorData(i,c)})}async readTextureAsync(e,i,a){let o=e.tensor.dataId;if(a||(a=1),this.pendingRead.has(o)){let c=this.pendingRead.get(o);return new Promise(s=>c==null?void 0:c.push(s))}return this.profiler.event("backend","TextureManager.readTextureAsync",async()=>{this.pendingRead.set(o,[]);let c=e.shape.reduce((et,h)=>et*h)*a;await this.glContext.createAndWaitForFence();let s=this.glContext.readTexture(e.texture,e.width,e.height,c,this.toEncoderType(i),a),d=this.toTensorData(i,s),$=this.pendingRead.get(o);return this.pendingRead.delete(o),$==null||$.forEach(et=>et(d)),d})}readUint8TextureAsFloat(e){return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",()=>{let i=e.shape.reduce((o,c)=>o*c),a=this.glContext.readTexture(e.texture,e.width,e.height,i*4,"byte",4);return new Float32Array(a.buffer,a.byteOffset,i)})}releaseTexture(e,i){let a;if(this.config.reuseTextures&&(a=this.textureLookup.get(e.texture),a)){i&&this.textureLookup.delete(a);let o=this.inUseTextures.get(a);if(o){let c=o.indexOf(e.texture);if(c!==-1){o.splice(c,1);let s=this.idleTextures.get(a);s||(s=[],this.idleTextures.set(a,s)),s.push(e.texture)}}}(!a||i)&&(ce.verbose("TextureManager",`Deleting texture of size ${e.width}x${e.height}`),this.glContext.deleteTexture(e.texture))}toTensorData(e,i){switch(e){case"int16":return i instanceof Int16Array?i:Int16Array.from(i);case"int32":return i instanceof Int32Array?i:Int32Array.from(i);case"int8":return i instanceof Int8Array?i:Int8Array.from(i);case"uint16":return i instanceof Uint16Array?i:Uint16Array.from(i);case"uint32":return i instanceof Uint32Array?i:Uint32Array.from(i);case"uint8":case"bool":return i instanceof Uint8Array?i:Uint8Array.from(i);case"float32":return i instanceof Float32Array?i:Float32Array.from(i);case"float64":return i instanceof Float64Array?i:Float64Array.from(i);default:throw new Error(`TensorData type ${e} is not supported`)}}toTextureData(e,i){if(i)return i instanceof Float32Array?i:new Float32Array(i)}toEncoderType(e){return"float"}clearActiveTextures(){this.glContext.clearActiveTextures()}}}),yo$1,lp$1=L(()=>{lt$1(),_s$1(),el$1(),Xc$1(),sp$1(),Vi(),up$1(),yo$1=class{constructor(e,i){this.backend=e,this.context=i,this.layoutStrategy=new uo$1(e.glContext.maxTextureSize),this.programManager=new bo$1(this.context.profiler,e.glContext,this.layoutStrategy),this.textureManager=new go$1(e.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:e.textureCacheMode==="full"}),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map,this.pack=e.pack,this.pack2unpackMap=new Map,this.unpack2packMap=new Map}createInferenceHandler(){return new Jn$1(this)}onGraphInitialized(e){let i=e.getValues().filter(a=>a.from===-1&&a.tensor).map(a=>a.tensor.dataId);this.initializers=new Set(i)}isInitializer(e){return this.initializers?this.initializers.has(e):!1}addInitializer(e){this.initializers.add(e)}getTextureData(e,i){return i?this.packedTextureDataCache.get(e):this.unpackedTextureDataCache.get(e)}setTextureData(e,i,a=!1){ce.verbose("WebGLSessionHandler","Storing Texture data in cache"),a?this.packedTextureDataCache.set(e,i):this.unpackedTextureDataCache.set(e,i)}dispose(){this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(e=>this.textureManager.releaseTexture(e,!0)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(e=>this.textureManager.releaseTexture(e,!0)),this.unpackedTextureDataCache=new Map}resolve(e,i,a){let o=vs$1(e,i,Yc$1);return{impl:o.opImpl,context:o.opInit?o.opInit(e,a):e}}}});function jb(e){let i=0;for(;i<e.length&&e[i]();++i);return i-1}var hn,fp$1=L(()=>{Ot$1(),ln(),ln(),Bt$1(),hn=class{constructor(e,i){this.frameBufferBound=!1,this.itemsToPoll=[],this.gl=e,this.version=i,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters()}allocateTexture(e,i,a,o){let c=this.gl,s=c.createTexture();c.bindTexture(c.TEXTURE_2D,s),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);let d=o?a.encode(o,e*i):null;return c.texImage2D(c.TEXTURE_2D,0,a.internalFormat,e,i,0,a.format,a.textureType,d),this.checkError(),s}updateTexture(e,i,a,o,c){let s=this.gl;s.bindTexture(s.TEXTURE_2D,e);let d=o.encode(c,i*a);s.texSubImage2D(s.TEXTURE_2D,0,0,0,i,a,o.format,o.textureType,d),this.checkError()}attachFramebuffer(e,i,a){let o=this.gl;o.bindTexture(o.TEXTURE_2D,e),o.bindFramebuffer(o.FRAMEBUFFER,this.framebuffer),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,e,0),this.checkError(),o.viewport(0,0,i,a),o.scissor(0,0,i,a)}readTexture(e,i,a,o,c,s){let d=this.gl;s||(s=1),this.frameBufferBound||this.attachFramebuffer(e,i,a);let $=this.getEncoder(c,s),et=$.allocate(i*a);return d.bindTexture(d.TEXTURE_2D,e),d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,e,0),d.readPixels(0,0,i,a,d.RGBA,$.textureType,et),this.checkError(),$.decode(et,o)}isFramebufferReady(){return!0}getActiveTexture(){let e=this.gl;return`TEXTURE${e.getParameter(this.gl.ACTIVE_TEXTURE)-e.TEXTURE0}`}getTextureBinding(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D)}getFramebufferBinding(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)}setVertexAttributes(e,i){let a=this.gl;a.vertexAttribPointer(e,3,a.FLOAT,!1,20,0),a.enableVertexAttribArray(e),i!==-1&&(a.vertexAttribPointer(i,2,a.FLOAT,!1,20,12),a.enableVertexAttribArray(i)),this.checkError()}createProgram(e,i){let a=this.gl,o=a.createProgram();return a.attachShader(o,e),a.attachShader(o,i),a.linkProgram(o),o}compileShader(e,i){let a=this.gl,o=a.createShader(i);if(!o)throw new Error(`createShader() returned null with type ${i}`);if(a.shaderSource(o,e),a.compileShader(o),a.getShaderParameter(o,a.COMPILE_STATUS)===!1)throw new Error(`Failed to compile shader: ${a.getShaderInfoLog(o)}
Shader source:
${e}`);return o}deleteShader(e){this.gl.deleteShader(e)}bindTextureToUniform(e,i,a){let o=this.gl;o.activeTexture(o.TEXTURE0+i),this.checkError(),o.bindTexture(o.TEXTURE_2D,e),this.checkError(),o.uniform1i(a,i),this.checkError()}draw(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError()}checkError(){if(Z.debug){let e=this.gl,i=e.getError(),a="";switch(i){case e.NO_ERROR:return;case e.INVALID_ENUM:a="INVALID_ENUM";break;case e.INVALID_VALUE:a="INVALID_VALUE";break;case e.INVALID_OPERATION:a="INVALID_OPERATION";break;case e.INVALID_FRAMEBUFFER_OPERATION:a="INVALID_FRAMEBUFFER_OPERATION";break;case e.OUT_OF_MEMORY:a="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:a="CONTEXT_LOST_WEBGL";break;default:a=`Unknown WebGL Error: ${i.toString(16)}`}throw new Error(a)}}deleteTexture(e){this.gl.deleteTexture(e)}deleteProgram(e){this.gl.deleteProgram(e)}getEncoder(e,i,a=0){if(this.version===2)return new Xn$1(this.gl,i);switch(e){case"float":return a===1||this.isRenderFloat32Supported?new un(this.gl,i):new un(this.gl,i,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw new Error("not implemented");case"byte":return new Kn$1(this.gl,i);default:throw new Error(`Invalid dataType: ${e}`)}}clearActiveTextures(){let e=this.gl;for(let i=0;i<this.maxTextureImageUnits;++i)e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,null)}dispose(){if(this.disposed)return;let e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(this.framebuffer),e.bindBuffer(e.ARRAY_BUFFER,null),e.deleteBuffer(this.vertexbuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.finish(),this.disposed=!0}createDefaultGeometry(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0])}createVertexbuffer(){let e=this.gl,i=e.createBuffer();if(!i)throw new Error("createBuffer() returned null");let a=this.createDefaultGeometry();return e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,a,e.STATIC_DRAW),this.checkError(),i}createFramebuffer(){let e=this.gl.createFramebuffer();if(!e)throw new Error("createFramebuffer returned null");return e}queryVitalParameters(){let e=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),this.version===1&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw new Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),this.version}getExtensions(){this.version===2?(this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"),this.disjointTimerQueryWebgl2Extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"))}checkFloatTextureAttachableToFrameBuffer(){let e=this.gl,i=e.createTexture();e.bindTexture(e.TEXTURE_2D,i);let a=this.version===2?e.RGBA32F:e.RGBA;e.texImage2D(e.TEXTURE_2D,0,a,1,1,0,e.RGBA,e.FLOAT,null);let o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0);let c=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(i),e.deleteFramebuffer(o),c}checkRenderFloat32(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Download(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension||!this.gl.getExtension("WEBGL_color_buffer_float"))return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Blend(){let e=this.gl,i,a,o,c,s;try{i=e.createTexture(),a=e.createFramebuffer(),e.bindTexture(e.TEXTURE_2D,i);let d=this.version===2?e.RGBA32F:e.RGBA;return e.texImage2D(e.TEXTURE_2D,0,d,1,1,0,e.RGBA,e.FLOAT,null),e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0),e.enable(e.BLEND),o=e.createShader(e.VERTEX_SHADER),!o||(e.shaderSource(o,"void main(){}"),e.compileShader(o),c=e.createShader(e.FRAGMENT_SHADER),!c)||(e.shaderSource(c,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),e.compileShader(c),s=e.createProgram(),!s)?!1:(e.attachShader(s,o),e.attachShader(s,c),e.linkProgram(s),e.useProgram(s),e.drawArrays(e.POINTS,0,1),e.getError()===e.NO_ERROR)}finally{e.disable(e.BLEND),s&&e.deleteProgram(s),o&&e.deleteShader(o),c&&e.deleteShader(c),a&&(e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteFramebuffer(a)),i&&(e.bindTexture(e.TEXTURE_2D,null),e.deleteTexture(i))}}beginTimer(){if(this.version===2&&this.disjointTimerQueryWebgl2Extension){let e=this.gl,i=this.disjointTimerQueryWebgl2Extension,a=e.createQuery();return e.beginQuery(i.TIME_ELAPSED_EXT,a),a}else throw new Error("WebGL1 profiling currently not supported.")}endTimer(){if(this.version===2&&this.disjointTimerQueryWebgl2Extension){let e=this.gl,i=this.disjointTimerQueryWebgl2Extension;e.endQuery(i.TIME_ELAPSED_EXT);return}else throw new Error("WebGL1 profiling currently not supported")}isTimerResultAvailable(e){let i=!1,a=!1;if(this.version===2&&this.disjointTimerQueryWebgl2Extension){let o=this.gl,c=this.disjointTimerQueryWebgl2Extension;i=o.getQueryParameter(e,o.QUERY_RESULT_AVAILABLE),a=o.getParameter(c.GPU_DISJOINT_EXT)}else throw new Error("WebGL1 profiling currently not supported");return i&&!a}getTimerResult(e){let i=0;if(this.version===2){let a=this.gl;i=a.getQueryParameter(e,a.QUERY_RESULT),a.deleteQuery(e)}else throw new Error("WebGL1 profiling currently not supported");return i/1e6}async waitForQueryAndGetTime(e){return await mi$1(()=>this.isTimerResultAvailable(e)),this.getTimerResult(e)}async createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let i,a=e,o=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),o===null?i=()=>!0:i=()=>{let c=a.clientWaitSync(o,0,0);return c===a.ALREADY_SIGNALED||c===a.CONDITION_SATISFIED},{query:o,isFencePassed:i}}async pollFence(e){return new Promise(i=>{this.addItemToPoll(()=>e.isFencePassed(),()=>i())})}pollItems(){let e=jb(this.itemsToPoll.map(i=>i.isDoneFn));for(let i=0;i<=e;++i){let{resolveFn:a}=this.itemsToPoll[i];a()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}async addItemToPoll(e,i){this.itemsToPoll.push({isDoneFn:e,resolveFn:i}),!(this.itemsToPoll.length>1)&&await mi$1(()=>(this.pollItems(),this.itemsToPoll.length===0))}}});function Hi$1(e){let i;if((!e||e==="webgl2")&&"webgl2"in Gr?i=Gr.webgl2:(!e||e==="webgl")&&"webgl"in Gr&&(i=Gr.webgl),!i)try{let o=Xb();i=cp$1(o,e)}catch{let o=Yb();i=cp$1(o,e)}e=e||i.version===1?"webgl":"webgl2";let a=i.gl;return Gr[e]=i,a.isContextLost()?(delete Gr[e],Hi$1(e)):(a.disable(a.DEPTH_TEST),a.disable(a.STENCIL_TEST),a.disable(a.BLEND),a.disable(a.DITHER),a.disable(a.POLYGON_OFFSET_FILL),a.disable(a.SAMPLE_COVERAGE),a.enable(a.SCISSOR_TEST),a.enable(a.CULL_FACE),a.cullFace(a.BACK),i)}function cp$1(e,i){let a={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1},o,c=a;if((!i||i==="webgl2")&&(o=e.getContext("webgl2",c),o))try{return new hn(o,2)}catch(s){ce.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl2'. Error: ${s}`)}if((!i||i==="webgl")&&(o=e.getContext("webgl",c)||e.getContext("experimental-webgl",c),o))try{return new hn(o,1)}catch(s){ce.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: ${s}`)}throw new Error("WebGL is not supported")}function Yb(){if(typeof document>"u")throw new TypeError("failed to create canvas: document is not supported");let e=document.createElement("canvas");return e.width=1,e.height=1,e}function Xb(){if(typeof OffscreenCanvas>"u")throw new TypeError("failed to create offscreen canvas: OffscreenCanvas is not supported");return new OffscreenCanvas(1,1)}var Gr,pp$1=L(()=>{lt$1(),fp$1(),Gr={}}),To$1,dp$1=L(()=>{Ot$1(),lt$1(),lp$1(),pp$1(),To$1=class{get contextId(){return Z.webgl.contextId}set contextId(e){Z.webgl.contextId=e}get matmulMaxBatchSize(){return Z.webgl.matmulMaxBatchSize}set matmulMaxBatchSize(e){Z.webgl.matmulMaxBatchSize=e}get textureCacheMode(){return Z.webgl.textureCacheMode}set textureCacheMode(e){Z.webgl.textureCacheMode=e}get pack(){return Z.webgl.pack}set pack(e){Z.webgl.pack=e}get async(){return Z.webgl.async}set async(e){Z.webgl.async=e}initialize(){try{return this.glContext=Hi$1(this.contextId),typeof this.matmulMaxBatchSize!="number"&&(this.matmulMaxBatchSize=16),typeof this.textureCacheMode!="string"&&(this.textureCacheMode="full"),typeof this.pack!="boolean"&&(this.pack=!1),typeof this.async!="boolean"&&(this.async=!1),ce.setWithEnv(Z),Z.webgl.context||Object.defineProperty(Z.webgl,"context",{value:this.glContext.gl}),ce.verbose("WebGLBackend",`Created WebGLContext: ${typeof this.glContext} with matmulMaxBatchSize: ${this.matmulMaxBatchSize}; textureCacheMode: ${this.textureCacheMode}; pack: ${this.pack}; async: ${this.async}.`),!0}catch(e){return ce.warning("WebGLBackend",`Unable to initialize WebGLBackend. ${e}`),!1}}createSessionHandler(e){return new yo$1(this,e)}dispose(){this.glContext.dispose()}}});async function qi$1(e){if(e){let i=typeof e=="string"?[e]:e;for(let a of i){let o=hp$1.get(a);if(o)return o;let c=await Jb(a);if(c)return c}}else return qi$1(["webgl"]);throw new Error("no available backend to use")}async function Jb(e){let i=Kb;if(typeof i[e]<"u"&&Zb(i[e])){let a=i[e],o=a.initialize();if(typeof o=="object"&&"then"in o&&(o=await o),o)return hp$1.set(e,a),a}}function Zb(e){let i=e;return"initialize"in i&&typeof i.initialize=="function"&&"createSessionHandler"in i&&typeof i.createSessionHandler=="function"&&"dispose"in i&&typeof i.dispose=="function"}var hp$1,Kb,mp$1=L(()=>{dp$1(),hp$1=new Map,Kb={webgl:new To$1}}),ji$1,xo$1,bp=L(()=>{lt$1(),ji$1=class{constructor(e,i){this.op=e,this.node=i}},xo$1=class{constructor(e,i,a){this.graph=e,this.profiler=a,this.initialize(i)}initialize(e){this.profiler.event("session","ExecutionPlan.initialize",()=>{let i=this.graph.getNodes();if(i.length!==e.length)throw new Error("The size of nodes and OPs do not match.");this._ops=e.map((a,o)=>new ji$1(a,i[o])),this.reset(),this._starter=[],this._ops.forEach((a,o)=>{let c=!0;for(let s of a.node.inputs)if(!this._values[s]&&this.graph.getInputIndices().indexOf(s)===-1){c=!1;break}c&&this._starter.push(o)})})}reset(){this._values=this.graph.getValues().map(e=>e.tensor)}async execute(e,i){return this.profiler.event("session","ExecutionPlan.execute",async()=>{this.reset();let a=e.createInferenceHandler(),o=this.graph.getInputIndices();if(i.length!==o.length)throw new Error(`number of input tensors don't match the number of inputs to the model: actual: ${i.length} expected: ${o.length}`);i.forEach((h,b)=>{let g=o[b];this._values[g]=h});let c=this._starter.slice(0),s=this.graph.getValues(),d=this.graph.getNodes(),$=0;for(;$<c.length;){let h=c[$++],b=this._ops[h],g=b.node.inputs.map(Ft=>this._values[Ft]);if(g.indexOf(void 0)!==-1)throw new Error(`unresolved input detected: op: ${b.node}`);let st=g;ce.verbose("ExecPlan",`Runing op:${b.node.name} (${st.map((Ft,Gt)=>`'${b.node.inputs[Gt]}': ${Ft.type}[${Ft.dims.join(",")}]`).join(", ")})`);let $t=await this.profiler.event("node",b.node.name,async()=>b.op.impl(a,st,b.op.context));if($t.length!==b.node.outputs.length)throw new Error("the size of output does not match model definition.");$t.forEach((Ft,Gt)=>{let qt=b.node.outputs[Gt];if(this._values[qt])throw new Error(`output [${qt}] already has value: op:${b.node.name}`);this._values[qt]=Ft});let vt=new Set;$t.forEach((Ft,Gt)=>{let qt=b.node.outputs[Gt];for(let Lt of s[qt].to){let rr=d[Lt],jr=!0;for(let Hr of rr.inputs)if(!this._values[Hr]){jr=!1;break}jr&&vt.add(Lt)}}),c.push(...vt)}let et=[];for(let h=0;h<this.graph.getOutputIndices().length;h++){let b=this.graph.getOutputIndices()[h],g=this._values[b];if(g===void 0)throw new Error(`required output [${b}] does not have value`);b===0?await g.getData():g.data,et.push(g)}return ce.verbose("ExecPlan","disposing of inferenceHandler"),a.dispose(),et})}}}),oe,bt,mn,gp$1=L(()=>{tn$1(),oe=Ar(Cr()),yr(),fe$1(),bt=V.experimental.fbs,mn=class iw{constructor(i){if(this._attributes=new Map,i!=null){for(let a of i)a instanceof oe.onnx.AttributeProto?this._attributes.set(a.name,[iw.getValue(a),iw.getType(a)]):a instanceof bt.Attribute&&this._attributes.set(a.name(),[iw.getValue(a),iw.getType(a)]);if(this._attributes.size<i.length)throw new Error("duplicated attribute names")}}set(i,a,o){this._attributes.set(i,[o,a])}delete(i){this._attributes.delete(i)}getFloat(i,a){return this.get(i,"float",a)}getInt(i,a){return this.get(i,"int",a)}getString(i,a){return this.get(i,"string",a)}getTensor(i,a){return this.get(i,"tensor",a)}getFloats(i,a){return this.get(i,"floats",a)}getInts(i,a){return this.get(i,"ints",a)}getStrings(i,a){return this.get(i,"strings",a)}getTensors(i,a){return this.get(i,"tensors",a)}get(i,a,o){let c=this._attributes.get(i);if(c===void 0){if(o!==void 0)return o;throw new Error(`required attribute not found: ${i}`)}if(c[1]!==a)throw new Error(`type mismatch: expected ${a} but got ${c[1]}`);return c[0]}static getType(i){let a=i instanceof oe.onnx.AttributeProto?i.type:i.type();switch(a){case oe.onnx.AttributeProto.AttributeType.FLOAT:return"float";case oe.onnx.AttributeProto.AttributeType.INT:return"int";case oe.onnx.AttributeProto.AttributeType.STRING:return"string";case oe.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case oe.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case oe.onnx.AttributeProto.AttributeType.INTS:return"ints";case oe.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case oe.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw new Error(`attribute type is not supported yet: ${oe.onnx.AttributeProto.AttributeType[a]}`)}}static getValue(i){let a=i instanceof oe.onnx.AttributeProto?i.type:i.type();if(a===oe.onnx.AttributeProto.AttributeType.GRAPH||a===oe.onnx.AttributeProto.AttributeType.GRAPHS)throw new Error("graph attribute is not supported yet");let o=this.getValueNoCheck(i);if(a===oe.onnx.AttributeProto.AttributeType.INT&&it.isLong(o))return it.longToNumber(o);if(a===oe.onnx.AttributeProto.AttributeType.INTS){let c=o,s=new Array(c.length);for(let d=0;d<c.length;d++){let $=c[d];s[d]=it.longToNumber($)}return s}if(a===oe.onnx.AttributeProto.AttributeType.TENSOR)return i instanceof oe.onnx.AttributeProto?$e.fromProto(o):$e.fromOrtTensor(o);if(a===oe.onnx.AttributeProto.AttributeType.TENSORS){if(i instanceof oe.onnx.AttributeProto)return o.map(c=>$e.fromProto(c));if(i instanceof bt.Attribute)return o.map(c=>$e.fromOrtTensor(c))}return a===oe.onnx.AttributeProto.AttributeType.STRING&&i instanceof oe.onnx.AttributeProto?sn$1(o):a===oe.onnx.AttributeProto.AttributeType.STRINGS&&i instanceof oe.onnx.AttributeProto?o.map(sn$1):o}static getValueNoCheck(i){return i instanceof oe.onnx.AttributeProto?this.getValueNoCheckFromOnnxFormat(i):this.getValueNoCheckFromOrtFormat(i)}static getValueNoCheckFromOnnxFormat(i){switch(i.type){case oe.onnx.AttributeProto.AttributeType.FLOAT:return i.f;case oe.onnx.AttributeProto.AttributeType.INT:return i.i;case oe.onnx.AttributeProto.AttributeType.STRING:return i.s;case oe.onnx.AttributeProto.AttributeType.TENSOR:return i.t;case oe.onnx.AttributeProto.AttributeType.GRAPH:return i.g;case oe.onnx.AttributeProto.AttributeType.FLOATS:return i.floats;case oe.onnx.AttributeProto.AttributeType.INTS:return i.ints;case oe.onnx.AttributeProto.AttributeType.STRINGS:return i.strings;case oe.onnx.AttributeProto.AttributeType.TENSORS:return i.tensors;case oe.onnx.AttributeProto.AttributeType.GRAPHS:return i.graphs;default:throw new Error(`unsupported attribute type: ${oe.onnx.AttributeProto.AttributeType[i.type]}`)}}static getValueNoCheckFromOrtFormat(i){switch(i.type()){case bt.AttributeType.FLOAT:return i.f();case bt.AttributeType.INT:return i.i();case bt.AttributeType.STRING:return i.s();case bt.AttributeType.TENSOR:return i.t();case bt.AttributeType.GRAPH:return i.g();case bt.AttributeType.FLOATS:return i.floatsArray();case bt.AttributeType.INTS:{let a=[];for(let o=0;o<i.intsLength();o++)a.push(i.ints(o));return a}case bt.AttributeType.STRINGS:{let a=[];for(let o=0;o<i.stringsLength();o++)a.push(i.strings(o));return a}case bt.AttributeType.TENSORS:{let a=[];for(let o=0;o<i.tensorsLength();o++)a.push(i.tensors(o));return a}default:throw new Error(`unsupported attribute type: ${bt.AttributeType[i.type()]}`)}}}}),Xi$1,wo$1,Ki$1,Mt$1,vo$1,Yi$1,yp$1=L(()=>{gp$1(),tn$1(),Xi$1=Ar(Cr()),yr(),fe$1(),wo$1=V.experimental.fbs,Ki$1={from:(e,i)=>new Yi$1(e,i)},Mt$1=class{constructor(e){this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,e&&(this.type=We$1.tensorValueTypeFromProto(e.type.tensorType))}get from(){return this._from}get to(){return this._to}},vo$1=class{constructor(e,i){e instanceof Xi$1.onnx.NodeProto?(this.name=e.name,this.opType=e.opType,this.attributes=new mn(e.attribute)):e instanceof wo$1.Node&&(this.name=i??e.name(),this.opType=e.opType(),this.attributes=new mn(We$1.tensorAttributesFromORTFormat(e))),this.inputs=[],this.outputs=[],this.executeNode=!0}},Yi$1=class{constructor(e,i){if(!e)throw new TypeError("graph is empty");this.buildGraph(e),this.transformGraph(i),this.checkIsAcyclic()}getInputIndices(){return this._allInputIndices}getInputNames(){return this._allInputNames}getOutputIndices(){return this._allOutputIndices}getOutputNames(){return this._allOutputNames}getValues(){return this._allData}getNodes(){return this._nodes}buildGraph(e){if(e instanceof Xi$1.onnx.GraphProto)this.buildGraphFromOnnxFormat(e);else if(e instanceof wo$1.Graph)this.buildGraphFromOrtFormat(e);else throw new TypeError("Graph type is not supported.")}buildGraphFromOnnxFormat(e){let i=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];let a=new Map;if(!e.input)throw new Error("missing information in graph: input");let o=[];for(let c of e.input){if(i.has(c.name))throw new Error(`duplicated input name: ${c.name}`);let s=this._allData.push(new Mt$1(c))-1;i.set(c.name,s),o.push(c.name)}if(!e.initializer)throw new Error("missing information in graph: initializer");for(let c of e.initializer){let s=i.get(c.name);if(s===void 0){let d=new Mt$1;d.type={shape:{dims:We$1.tensorDimsFromProto(c.dims)},tensorType:We$1.tensorDataTypeFromProto(c.dataType)},s=this._allData.push(d)-1,i.set(c.name,s)}this._allData[s]._from=-1,this._allData[s].tensor=$e.fromProto(c)}for(let c=0;c<this._allData.length;c++)this._allData[c].tensor||(this._allInputIndices.push(c),this._allInputNames.push(o[c]));if(!e.output)throw new Error("missing information in graph: output");for(let c of e.output){if(i.has(c.name))throw new Error(`duplicated output name: ${c.name}`);let s=this._allData.push(new Mt$1(c))-1;i.set(c.name,s),this._allOutputIndices.push(s),this._allOutputNames.push(c.name)}if(!e.node)throw new Error("missing information in graph: node");for(let c of e.node){if(!c.name)for(let d=0;;d++){let $=`unnamed_${c.opType}_${d}`;if(!a.has($)){c.name=$;break}}if(a.has(c.name))throw new Error(`duplicated node name: ${c.name}`);let s=this._nodes.push(new vo$1(c))-1;a.set(c.name,s)}for(let c=0;c<this._nodes.length;c++){let s=this._nodes[c],d=e.node[c];if(!d.output)throw new Error(`missing output for node: ${d.name}`);for(let $ of d.output){let et=i.get($);if(typeof et>"u"&&(et=this._allData.push(new Mt$1)-1,i.set($,et)),s.outputs.push(et),this._allData[et]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${et}`);if(this._allData[et]._from=c,d.opType==="Constant"){if(!d.attribute||d.attribute.length!==1||!d.attribute[0].t)throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!d.output||d.output.length!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");s.outputs.pop(),s.executeNode=!1,this._allData[et]._from=-1,this._allData[et].tensor=$e.fromProto(d.attribute[0].t)}}}for(let c=0;c<this._nodes.length;c++){let s=this._nodes[c],d=e.node[c];if(!d.input)throw new Error(`missing input for node: ${d.name}`);for(let $ of d.input){let et=i.get($);if(typeof et>"u"){if($===""&&(d.input.length===3||d.input.length===4)&&d.opType==="Resize")continue;throw new Error(`unrecognized input '${$}' for node: ${d.name}`)}s.inputs.push(et),this._allData[et]._to.push(c)}}return!0}buildGraphFromOrtFormat(e){var c,s,d;let i=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];let a=new Map,o=[];for(let $=0;$<e.inputsLength();$++){let et=e.inputs($);if(i.has(et))throw new Error(`duplicated input name: ${et}`);for(let h=0;h<e.nodeArgsLength();h++)if(((c=e.nodeArgs(h))==null?void 0:c.name())===et){let b=new Mt$1;if(((d=(s=e.nodeArgs(h))==null?void 0:s.type())==null?void 0:d.valueType())!==wo$1.TypeInfoValue.tensor_type)throw new Error("Unexpected value type for the nodeArg.");let g=e.nodeArgs(h).type().value(new wo$1.TensorTypeAndShape),st=We$1.tensorDataTypeFromProto(g.elemType()),$t=g.shape(),vt=[];for(let Gt=0;Gt<$t.dimLength();Gt++)vt.push(it.longToNumber($t.dim(Gt).value().dimValue()));b.type={shape:{dims:vt},tensorType:st};let Ft=this._allData.push(b)-1;i.set(et,Ft),o.push(et)}}for(let $=0;$<e.initializersLength();$++){let et=e.initializers($),h=i.get(et.name());if(h===void 0){let b=new Mt$1,g=We$1.tensorDimsFromORTFormat(et),st=We$1.tensorDataTypeFromProto(et.dataType());b.type={shape:{dims:g},tensorType:st},h=this._allData.push(b)-1,i.set(et.name(),h)}this._allData[h]._from=-1,this._allData[h].tensor=$e.fromOrtTensor(et)}for(let $=0;$<this._allData.length;$++)this._allData[$].tensor||(this._allInputIndices.push($),this._allInputNames.push(o[$]));for(let $=0;$<e.outputsLength();$++){let et=e.outputs($);if(i.has(et))throw new Error(`duplicated output name: ${et}`);let h=this._allData.push(new Mt$1)-1;i.set(et,h),this._allOutputIndices.push(h),this._allOutputNames.push(et)}if(!e.nodes)throw new Error("missing information in graph: node");for(let $=0;$<e.nodesLength();$++){let et=e.nodes($),h=et.name();if(!h)for(let g=0;h=`unnamed_${et.opType()}_${g}`,!!a.has(h);g++);if(a.has(h))throw new Error(`duplicated node name: ${h}`);let b=this._nodes.push(new vo$1(et,h))-1;a.set(h,b)}for(let $=0;$<this._nodes.length;$++){let et=this._nodes[$],h=e.nodes($);if(h==null)throw new Error(`No node exists at index ${$}`);if((h==null?void 0:h.outputsLength())===0)throw new Error(`missing output for node: ${h.name}`);for(let b=0;b<(h==null?void 0:h.outputsLength());b++){let g=h==null?void 0:h.outputs(b),st=i.get(g);if(typeof st>"u"&&(st=this._allData.push(new Mt$1)-1,i.set(g,st)),et.outputs.push(st),this._allData[st]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${st}`);if(this._allData[st]._from=$,h.opType()==="Constant"){if(h.attributesLength()!==1||!h.attributes(0).t())throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(h.outputsLength()!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");et.outputs.pop(),et.executeNode=!1,this._allData[st]._from=-1,this._allData[st].tensor=$e.fromOrtTensor(h.attributes(0).t())}}}for(let $=0;$<this._nodes.length;$++){let et=this._nodes[$],h=e.nodes($);if(h.inputsLength()===0)throw new Error(`missing input for node: ${h.name}`);for(let b=0;b<h.inputsLength();b++){let g=h.inputs(b),st=i.get(g);if(typeof st>"u")throw new Error(`unrecognized input '${g}' for node: ${h.name()}`);et.inputs.push(st),this._allData[st]._to.push($)}}}checkIsAcyclic(){let e=new Set;this._allInputIndices.forEach(o=>{this._allData[o]._to.forEach(c=>{e.add(c)})});let i=Array.from(e),a=new Array(this._nodes.length).fill("white");for(;i.length>0;){let o=i.pop();a[o]==="gray"?a[o]="black":(i.push(o),a[o]="gray",this._nodes[o].outputs.forEach(c=>{let s=this._allData[c];if(typeof s.tensor<"u")throw new Error("node outputs should not be initialized");if(s._from!==o)throw new Error("from property of the Value object doesn't match index of Node being processed");s._to.forEach(d=>{if(a[d]==="gray")throw new Error("model graph is cyclic");a[d]==="white"&&i.push(d)})}))}}transformGraph(e){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),this.fuseConvActivationNodes(),e&&e.transformGraph(this),this.finalizeGraph()}finalizeGraph(){let e=0,i=new Array(this._nodes.length,0),a=0;for(let o=0;o<this._nodes.length;o++)i[o]=a,this._nodes[o].executeNode?(a!==o&&(this._nodes[a]=this._nodes[o]),a++):this._nodes[o].outputs.forEach(c=>{this._allData[c]._from=-2});this._nodes.splice(a,this._nodes.length-a);for(let o=0;o<this._allData.length;o++){let c=this._allData[o];c._from!==void 0&&c._from!==-1&&c._from!==-2&&(c._from=i[c._from]);for(let s=0;s<c._to.length;s++)if(c._to[s]>=0)c._to[s]=i[c._to[s]];else throw new Error("Trying to update a removed node")}e=0;for(let o=0;o<this._allData.length;o++){if(this._allData[o].from===-2&&this._allOutputIndices.indexOf(o+e)===-1){e++,this._allData.splice(o,1),o--;continue}if(e>0){let c=-1;this._allData[o].from!==void 0&&this._allData[o].from!==-1?(c=this._nodes[this._allData[o].from].outputs.indexOf(o+e),c!==-1&&(this._nodes[this._allData[o].from].outputs[c]=o)):(c=this._allInputIndices.indexOf(o+e),c!==-1&&(this._allInputIndices[c]=o)),this._allData[o].to.forEach(s=>{c=this._nodes[s].inputs.indexOf(o+e),c!==-1&&(this._nodes[s].inputs[c]=o)}),this._allData[o].to.length===0&&(c=this._allOutputIndices.indexOf(o+e),c!==-1&&(this._allOutputIndices[c]=o))}}}deleteNode(e){let i=this._nodes[e];if(i.outputs.length>1){for(let d=1;d<i.outputs.length;d++)if(this._allData[i.outputs[d]].to.length>0)throw new Error("Node deletion with more than one output connected to other nodes is not supported. ")}i.executeNode=!1;let a=i.inputs[0],o=i.outputs[0],c=this._allData[o].to;for(let d=0;d<i.inputs.length;d++){let $=this._allData[i.inputs[d]].to.indexOf(e);if($===-1)throw new Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[i.inputs[d]].to.splice($,1)}this._allData[o]._to=[];let s=this._allOutputIndices.indexOf(o);if(s!==-1&&(this._allOutputIndices[s]=a),c&&c.length>0)for(let d of c){let $=this._nodes[d].inputs.indexOf(o);if($===-1)throw new Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[d].inputs[$]=a,this._allData[a].to.push(d)}}removeAllDropoutNodes(){let e=0;for(let i of this._nodes){if(i.opType==="Dropout"){if(i.inputs.length!==1)throw new Error("Dropout nodes should only contain one input. ");if(i.outputs.length!==1&&i.outputs.length!==2)throw new Error("Dropout nodes should contain either 1 or 2 output(s)");if(i.outputs.length===2&&this._allData[i.outputs[1]]._to.length!==0)throw new Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(e)}e++}}removeAllIdentityNodes(){let e=0;for(let i of this._nodes)i.opType==="Identity"&&this.deleteNode(e),e++}isActivation(e){switch(e.opType){case"Relu":case"Sigmoid":case"Clip":return!0;default:return!1}}fuseConvActivationNodes(){for(let e of this._nodes)if(e.opType==="Conv"){let i=this._allData[e.outputs[0]]._to;if(i.length===1&&this.isActivation(this._nodes[i[0]])){let a=this._nodes[i[0]];if(a.opType==="Clip")if(a.inputs.length===1)try{e.attributes.set("activation_params","floats",[a.attributes.getFloat("min"),a.attributes.getFloat("max")])}catch{e.attributes.set("activation_params","floats",[br,gr$1])}else if(a.inputs.length>=3&&this._allData[a.inputs[1]].tensor!==void 0&&this._allData[a.inputs[2]].tensor!==void 0)e.attributes.set("activation_params","floats",[this._allData[a.inputs[1]].tensor.floatData[0],this._allData[a.inputs[2]].tensor.floatData[0]]);else continue;e.attributes.set("activation","string",a.opType),this.deleteNode(i[0])}}}}}),Tp$1,Qb,_o$1,xp$1=L(()=>{zn$1(),yp$1(),tn$1(),Tp$1=Ar(Cr()),fe$1(),Qb=V.experimental.fbs,_o$1=class{constructor(){}load(e,i,a){let o;if(!a)try{this.loadFromOnnxFormat(e,i);return}catch(c){if(a!==void 0)throw c;o=c}try{this.loadFromOrtFormat(e,i)}catch(c){throw a!==void 0?c:new Error(`Failed to load model as ONNX format: ${o}
as ORT format: ${c}`)}}loadFromOnnxFormat(e,i){let a=Tp$1.onnx.ModelProto.decode(e);if(it.longToNumber(a.irVersion)<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=a.opsetImport.map(o=>({domain:o.domain,version:it.longToNumber(o.version)})),this._graph=Ki$1.from(a.graph,i)}loadFromOrtFormat(e,i){let a=new _.ByteBuffer(e),o=Qb.InferenceSession.getRootAsInferenceSession(a).model();if(it.longToNumber(o.irVersion())<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=[];for(let c=0;c<o.opsetImportLength();c++){let s=o.opsetImport(c);this._opsets.push({domain:s==null?void 0:s.domain(),version:it.longToNumber(s.version())})}this._graph=Ki$1.from(o.graph(),i)}get graph(){return this._graph}get opsets(){return this._opsets}}}),Oo,wp$1=L(()=>{mp$1(),bp(),lt$1(),xp$1(),Oo=class{constructor(e={}){this._initialized=!1,this.backendHint=e.backendHint,this.profiler=Gn$1.create(e.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]}}get inputNames(){return this._model.graph.getInputNames()}get outputNames(){return this._model.graph.getOutputNames()}startProfiling(){this.profiler.start()}endProfiling(){this.profiler.stop()}async loadModel(e,i,a){await this.profiler.event("session","Session.loadModel",async()=>{let o=await qi$1(this.backendHint);if(this.sessionHandler=o.createSessionHandler(this.context),this._model=new _o$1,typeof e=="string"){let c=e.endsWith(".ort");if(typeof process<"u"&&process.versions&&process.versions.node){let s=await(void 0)(e);this.initialize(s,c)}else{let s=await(await fetch(e)).arrayBuffer();this.initialize(new Uint8Array(s),c)}}else if(ArrayBuffer.isView(e))this.initialize(e);else{let c=new Uint8Array(e,i||0,a||e.byteLength);this.initialize(c)}})}initialize(e,i){if(this._initialized)throw new Error("already initialized");this.profiler.event("session","Session.initialize",()=>{let a=this.sessionHandler.transformGraph?this.sessionHandler:void 0;this._model.load(e,a,i),this.sessionHandler.onGraphInitialized&&this.sessionHandler.onGraphInitialized(this._model.graph),this.initializeOps(this._model.graph),this._executionPlan=new xo$1(this._model.graph,this._ops,this.profiler)}),this._initialized=!0}async run(e){if(!this._initialized)throw new Error("session not initialized yet");return this.profiler.event("session","Session.run",async()=>{let i=this.normalizeAndValidateInputs(e),a=await this._executionPlan.execute(this.sessionHandler,i);return this.createOutput(a)})}normalizeAndValidateInputs(e){let i=this._model.graph.getInputNames();if(Array.isArray(e)){if(e.length!==i.length)throw new Error(`incorrect input array length: expected ${i.length} but got ${e.length}`)}else{if(e.size!==i.length)throw new Error(`incorrect input map size: expected ${i.length} but got ${e.size}`);let a=new Array(e.size),o=0;for(let c=0;c<i.length;++c){let s=e.get(i[c]);if(!s)throw new Error(`missing input tensor for: '${name}'`);a[o++]=s}e=a}if(!this.context.graphInputTypes||this.context.graphInputTypes.length===0||!this.context.graphInputDims||this.context.graphInputDims.length===0){let a=this._model.graph.getInputIndices(),o=this._model.graph.getValues(),c=new Array(a.length);for(let s=0;s<a.length;++s){let d=o[a[s]];c[s]=d.type.shape.dims,this.context.graphInputTypes.push(d.type.tensorType),this.context.graphInputDims.push(e[s].dims)}this.validateInputTensorDims(c,e,!0)}else this.validateInputTensorDims(this.context.graphInputDims,e,!1);return this.validateInputTensorTypes(this.context.graphInputTypes,e),e}validateInputTensorTypes(e,i){for(let a=0;a<i.length;a++){let o=e[a],c=i[a].type;if(o!==c)throw new Error(`input tensor[${a}] check failed: expected type '${o}' but got ${c}`)}}validateInputTensorDims(e,i,a){for(let o=0;o<i.length;o++){let c=e[o],s=i[o].dims;if(!this.compareTensorDims(c,s,a))throw new Error(`input tensor[${o}] check failed: expected shape '[${c.join(",")}]' but got [${s.join(",")}]`)}}compareTensorDims(e,i,a){if(e.length!==i.length)return!1;for(let o=0;o<e.length;++o)if(e[o]!==i[o]&&(!a||e[o]!==0))return!1;return!0}createOutput(e){let i=this._model.graph.getOutputNames();if(e.length!==i.length)throw new Error("expected number of outputs do not match number of generated outputs");let a=new Map;for(let o=0;o<i.length;++o)a.set(i[o],e[o]);return a}initializeOps(e){let i=e.getNodes();this._ops=new Array(i.length);for(let a=0;a<i.length;a++)this._ops[a]=this.sessionHandler.resolve(i[a],this._model.opsets,e)}}}),Io$1,vp$1=L(()=>{Ot$1(),yr(),Io$1=class{constructor(e){this.session=e,this.inputNames=this.session.inputNames,this.outputNames=this.session.outputNames}async dispose(){}async run(e,i,a){let o=new Map;for(let d in e)if(Object.hasOwnProperty.call(e,d)){let $=e[d];o.set(d,new $e($.dims,$.type,void 0,void 0,$.data))}let c=await this.session.run(o),s={};return c.forEach((d,$)=>{s[$]=new Me(d.type,d.data,d.dims)}),s}startProfiling(){this.session.startProfiling()}endProfiling(){this.session.endProfiling()}}}),_p$1={};Sr(_p$1,{onnxjsBackend:()=>tg});var Ji$1,tg,Op$1=L(()=>{wp$1(),vp$1(),Ji$1=class{async init(){}async createInferenceSessionHandler(e,i){let a=new Oo(i);return typeof e=="string"?await a.loadModel(e):await a.loadModel(e),new Io$1(a)}},tg=new Ji$1}),Zi$1={};Sr(Zi$1,{createReadStream:()=>Ip$1,readFile:()=>rg,readFileSync:()=>ng});var rg,ng,Ip$1,Qi$1=L(()=>{rg=void 0,ng=void 0,Ip$1=void 0}),ea={};Sr(ea,{join:()=>og});var og,ta=L(()=>{og=void 0}),Pp$1=me((e,i)=>{var a=(()=>{var c;var o=typeof document<"u"?(c=document.currentScript)==null?void 0:c.src:void 0;return typeof __filename<"u"&&(o||(o=__filename)),function(s={}){var d=s,$,et,h=new Promise((Yr,Ro)=>{$=Yr,et=Ro}),b=Object.assign({},d),g="./this.program",st=typeof window=="object",$t=typeof importScripts=="function",vt=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",Ft="",Gt,qt,Lt;if(vt){var rr=(Qi$1(),ar(Zi$1)),jr=(ta(),ar(ea));Ft=$t?jr.dirname(Ft)+"/":__dirname+"/",Gt=(Yr,Ro)=>(Yr=f0(Yr)?new URL(Yr):jr.normalize(Yr),rr.readFileSync(Yr,Ro?void 0:"utf8")),Lt=Yr=>(Yr=Gt(Yr,!0),Yr.buffer||(Yr=new Uint8Array(Yr)),Yr),qt=(Yr,Ro,Bo,a0=!0)=>{Yr=f0(Yr)?new URL(Yr):jr.normalize(Yr),rr.readFile(Yr,a0?void 0:"utf8",(u0,O0)=>{u0?Bo(u0):Ro(a0?O0.buffer:O0)})},!d.thisProgram&&1<process.argv.length&&(g=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2)}else(st||$t)&&($t?Ft=self.location.href:typeof document<"u"&&document.currentScript&&(Ft=document.currentScript.src),o&&(Ft=o),Ft.startsWith("blob:")?Ft="":Ft=Ft.substr(0,Ft.replace(/[?#].*/,"").lastIndexOf("/")+1),Gt=Yr=>{var Ro=new XMLHttpRequest;return Ro.open("GET",Yr,!1),Ro.send(null),Ro.responseText},$t&&(Lt=Yr=>{var Ro=new XMLHttpRequest;return Ro.open("GET",Yr,!1),Ro.responseType="arraybuffer",Ro.send(null),new Uint8Array(Ro.response)}),qt=(Yr,Ro,Bo)=>{var a0=new XMLHttpRequest;a0.open("GET",Yr,!0),a0.responseType="arraybuffer",a0.onload=()=>{a0.status==200||a0.status==0&&a0.response?Ro(a0.response):Bo()},a0.onerror=Bo,a0.send(null)});var Hr=console.log.bind(console),wn=console.error.bind(console);Object.assign(d,b),b=null;var _n,No=!1,Qo,Xo,l0,v0,x0;function D0(){var Yr=_n.buffer;d.HEAP8=Qo=new Int8Array(Yr),d.HEAP16=new Int16Array(Yr),d.HEAPU8=Xo=new Uint8Array(Yr),d.HEAPU16=new Uint16Array(Yr),d.HEAP32=l0=new Int32Array(Yr),d.HEAPU32=v0=new Uint32Array(Yr),d.HEAPF32=new Float32Array(Yr),d.HEAPF64=x0=new Float64Array(Yr)}var M0=[],Mo=[],e0=[],Sn=0,t0=null;function d0(Yr){throw Yr="Aborted("+Yr+")",wn(Yr),No=!0,Yr=new WebAssembly.RuntimeError(Yr+". Build with -sASSERTIONS for more info."),et(Yr),Yr}var xn=Yr=>Yr.startsWith("data:application/octet-stream;base64,"),f0=Yr=>Yr.startsWith("file://"),$0;if($0="ort-wasm.wasm",!xn($0)){var N0=$0;$0=d.locateFile?d.locateFile(N0,Ft):Ft+N0}function j0(Yr){if(Lt)return Lt(Yr);throw"both async and sync fetching of the wasm failed"}function Z0(Yr){if(st||$t){if(typeof fetch=="function"&&!f0(Yr))return fetch(Yr,{credentials:"same-origin"}).then(Ro=>{if(!Ro.ok)throw`failed to load wasm binary file at '${Yr}'`;return Ro.arrayBuffer()}).catch(()=>j0(Yr));if(qt)return new Promise((Ro,Bo)=>{qt(Yr,a0=>Ro(new Uint8Array(a0)),Bo)})}return Promise.resolve().then(()=>j0(Yr))}function fy(Yr,Ro,Bo){return Z0(Yr).then(a0=>WebAssembly.instantiate(a0,Ro)).then(Bo,a0=>{wn(`failed to asynchronously prepare wasm: ${a0}`),d0(a0)})}function oy(Yr,Ro){var Bo=$0;return typeof WebAssembly.instantiateStreaming!="function"||xn(Bo)||f0(Bo)||vt||typeof fetch!="function"?fy(Bo,Yr,Ro):fetch(Bo,{credentials:"same-origin"}).then(a0=>WebAssembly.instantiateStreaming(a0,Yr).then(Ro,function(u0){return wn(`wasm streaming compile failed: ${u0}`),wn("falling back to ArrayBuffer instantiation"),fy(Bo,Yr,Ro)}))}var gy,hy={798088:(Yr,Ro,Bo,a0)=>{if(typeof d>"u"||!d.ya)return 1;if(Yr=$y(Yr>>>0),Yr.startsWith("./")&&(Yr=Yr.substring(2)),Yr=d.ya.get(Yr),!Yr)return 2;if(Ro>>>=0,Bo>>>=0,Ro+Bo>Yr.byteLength)return 3;try{return Xo.set(Yr.subarray(Ro,Ro+Bo),a0>>>0>>>0),0}catch{return 4}}};class J0{constructor(Ro){this.wa=Ro-24}}var H0=0,yy=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,vy=(Yr,Ro,Bo)=>{Ro>>>=0;var a0=Ro+Bo;for(Bo=Ro;Yr[Bo]&&!(Bo>=a0);)++Bo;if(16<Bo-Ro&&Yr.buffer&&yy)return yy.decode(Yr.subarray(Ro,Bo));for(a0="";Ro<Bo;){var u0=Yr[Ro++];if(u0&128){var O0=Yr[Ro++]&63;if((u0&224)==192)a0+=String.fromCharCode((u0&31)<<6|O0);else{var G0=Yr[Ro++]&63;u0=(u0&240)==224?(u0&15)<<12|O0<<6|G0:(u0&7)<<18|O0<<12|G0<<6|Yr[Ro++]&63,65536>u0?a0+=String.fromCharCode(u0):(u0-=65536,a0+=String.fromCharCode(55296|u0>>10,56320|u0&1023))}}else a0+=String.fromCharCode(u0)}return a0},$y=(Yr,Ro)=>(Yr>>>=0)?vy(Xo,Yr,Ro):"",o1=Yr=>{for(var Ro=0,Bo=0;Bo<Yr.length;++Bo){var a0=Yr.charCodeAt(Bo);127>=a0?Ro++:2047>=a0?Ro+=2:55296<=a0&&57343>=a0?(Ro+=4,++Bo):Ro+=3}return Ro},_y=(Yr,Ro,Bo,a0)=>{if(Bo>>>=0,!(0<a0))return 0;var u0=Bo;a0=Bo+a0-1;for(var O0=0;O0<Yr.length;++O0){var G0=Yr.charCodeAt(O0);if(55296<=G0&&57343>=G0){var Cy=Yr.charCodeAt(++O0);G0=65536+((G0&1023)<<10)|Cy&1023}if(127>=G0){if(Bo>=a0)break;Ro[Bo++>>>0]=G0}else{if(2047>=G0){if(Bo+1>=a0)break;Ro[Bo++>>>0]=192|G0>>6}else{if(65535>=G0){if(Bo+2>=a0)break;Ro[Bo++>>>0]=224|G0>>12}else{if(Bo+3>=a0)break;Ro[Bo++>>>0]=240|G0>>18,Ro[Bo++>>>0]=128|G0>>12&63}Ro[Bo++>>>0]=128|G0>>6&63}Ro[Bo++>>>0]=128|G0&63}}return Ro[Bo>>>0]=0,Bo-u0},Gy=Yr=>Yr%4===0&&(Yr%100!==0||Yr%400===0),fv=[0,31,60,91,121,152,182,213,244,274,305,335],Ly=[0,31,59,90,120,151,181,212,243,273,304,334],Iy=[],Ny={},py=()=>{if(!n1){var Yr={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:g||"./this.program"},Ro;for(Ro in Ny)Ny[Ro]===void 0?delete Yr[Ro]:Yr[Ro]=Ny[Ro];var Bo=[];for(Ro in Yr)Bo.push(`${Ro}=${Yr[Ro]}`);n1=Bo}return n1},n1,Ay=[null,[],[]],s1=[31,29,31,30,31,30,31,31,30,31,30,31],xy=[31,28,31,30,31,30,31,31,30,31,30,31];function u1(Yr){var Ro=Array(o1(Yr)+1);return _y(Yr,Ro,0,Ro.length),Ro}function ay(Yr,Ro,Bo,a0){function u0(_g,ey,ty){for(_g=typeof _g=="number"?_g.toString():_g||"";_g.length<ey;)_g=ty[0]+_g;return _g}function O0(_g,ey){return u0(_g,ey,"0")}function G0(_g,ey){function ty(R1){return 0>R1?-1:0<R1?1:0}var Ey;return(Ey=ty(_g.getFullYear()-ey.getFullYear()))===0&&(Ey=ty(_g.getMonth()-ey.getMonth()))===0&&(Ey=ty(_g.getDate()-ey.getDate())),Ey}function Cy(_g){switch(_g.getDay()){case 0:return new Date(_g.getFullYear()-1,11,29);case 1:return _g;case 2:return new Date(_g.getFullYear(),0,3);case 3:return new Date(_g.getFullYear(),0,2);case 4:return new Date(_g.getFullYear(),0,1);case 5:return new Date(_g.getFullYear()-1,11,31);case 6:return new Date(_g.getFullYear()-1,11,30)}}function Uy(_g){var ey=_g.sa;for(_g=new Date(new Date(_g.ta+1900,0,1).getTime());0<ey;){var ty=_g.getMonth(),Ey=(Gy(_g.getFullYear())?s1:xy)[ty];if(ey>Ey-_g.getDate())ey-=Ey-_g.getDate()+1,_g.setDate(1),11>ty?_g.setMonth(ty+1):(_g.setMonth(0),_g.setFullYear(_g.getFullYear()+1));else{_g.setDate(_g.getDate()+ey);break}}return ty=new Date(_g.getFullYear()+1,0,4),ey=Cy(new Date(_g.getFullYear(),0,4)),ty=Cy(ty),0>=G0(ey,_g)?0>=G0(ty,_g)?_g.getFullYear()+1:_g.getFullYear():_g.getFullYear()-1}Yr>>>=0,Ro>>>=0,Bo>>>=0,a0>>>=0;var Ry=v0[a0+40>>>2>>>0];a0={Ba:l0[a0>>>2>>>0],Aa:l0[a0+4>>>2>>>0],ua:l0[a0+8>>>2>>>0],xa:l0[a0+12>>>2>>>0],va:l0[a0+16>>>2>>>0],ta:l0[a0+20>>>2>>>0],na:l0[a0+24>>>2>>>0],sa:l0[a0+28>>>2>>>0],Da:l0[a0+32>>>2>>>0],za:l0[a0+36>>>2>>>0],Ca:Ry?$y(Ry):""},Bo=$y(Bo),Ry={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var Oy in Ry)Bo=Bo.replace(new RegExp(Oy,"g"),Ry[Oy]);var P1="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Zy="January February March April May June July August September October November December".split(" ");Ry={"%a":_g=>P1[_g.na].substring(0,3),"%A":_g=>P1[_g.na],"%b":_g=>Zy[_g.va].substring(0,3),"%B":_g=>Zy[_g.va],"%C":_g=>O0((_g.ta+1900)/100|0,2),"%d":_g=>O0(_g.xa,2),"%e":_g=>u0(_g.xa,2," "),"%g":_g=>Uy(_g).toString().substring(2),"%G":Uy,"%H":_g=>O0(_g.ua,2),"%I":_g=>(_g=_g.ua,_g==0?_g=12:12<_g&&(_g-=12),O0(_g,2)),"%j":_g=>{for(var ey=0,ty=0;ty<=_g.va-1;ey+=(Gy(_g.ta+1900)?s1:xy)[ty++]);return O0(_g.xa+ey,3)},"%m":_g=>O0(_g.va+1,2),"%M":_g=>O0(_g.Aa,2),"%n":()=>`
`,"%p":_g=>0<=_g.ua&&12>_g.ua?"AM":"PM","%S":_g=>O0(_g.Ba,2),"%t":()=>"	","%u":_g=>_g.na||7,"%U":_g=>O0(Math.floor((_g.sa+7-_g.na)/7),2),"%V":_g=>{var ey=Math.floor((_g.sa+7-(_g.na+6)%7)/7);if(2>=(_g.na+371-_g.sa-2)%7&&ey++,ey)ey==53&&(ty=(_g.na+371-_g.sa)%7,ty==4||ty==3&&Gy(_g.ta)||(ey=1));else{ey=52;var ty=(_g.na+7-_g.sa-1)%7;(ty==4||ty==5&&Gy(_g.ta%400-1))&&ey++}return O0(ey,2)},"%w":_g=>_g.na,"%W":_g=>O0(Math.floor((_g.sa+7-(_g.na+6)%7)/7),2),"%y":_g=>(_g.ta+1900).toString().substring(2),"%Y":_g=>_g.ta+1900,"%z":_g=>{_g=_g.za;var ey=0<=_g;return _g=Math.abs(_g)/60,(ey?"+":"-")+("0000"+(_g/60*100+_g%60)).slice(-4)},"%Z":_g=>_g.Ca,"%%":()=>"%"},Bo=Bo.replace(/%%/g,"\0\0");for(Oy in Ry)Bo.includes(Oy)&&(Bo=Bo.replace(new RegExp(Oy,"g"),Ry[Oy](a0)));return Bo=Bo.replace(/\0\0/g,"%"),Oy=u1(Bo),Oy.length>Ro?0:(Qo.set(Oy,Yr>>>0),Oy.length-1)}var qy={a:function(Yr,Ro,Bo){Yr>>>=0;var a0=new J0(Yr);throw v0[a0.wa+16>>>2>>>0]=0,v0[a0.wa+4>>>2>>>0]=Ro>>>0,v0[a0.wa+8>>>2>>>0]=Bo>>>0,H0=Yr,H0},e:function(){return 0},H:function(){},x:function(){},z:function(){},J:function(){return 0},F:function(){},A:function(){},E:function(){},g:function(){},y:function(){},v:function(){},G:function(){},w:function(){},k:()=>1,I:function(Yr,Ro,Bo){return Ro>>>=0,Xo.copyWithin(Yr>>>0>>>0,Ro>>>0,Ro+(Bo>>>0)>>>0)},n:function(Yr,Ro,Bo){Yr=Ro+2097152>>>0<4194305-!!Yr?(Yr>>>0)+4294967296*Ro:NaN,Bo>>>=0,Yr=new Date(1e3*Yr),l0[Bo>>>2>>>0]=Yr.getUTCSeconds(),l0[Bo+4>>>2>>>0]=Yr.getUTCMinutes(),l0[Bo+8>>>2>>>0]=Yr.getUTCHours(),l0[Bo+12>>>2>>>0]=Yr.getUTCDate(),l0[Bo+16>>>2>>>0]=Yr.getUTCMonth(),l0[Bo+20>>>2>>>0]=Yr.getUTCFullYear()-1900,l0[Bo+24>>>2>>>0]=Yr.getUTCDay(),l0[Bo+28>>>2>>>0]=(Yr.getTime()-Date.UTC(Yr.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},o:function(Yr,Ro,Bo){Yr=Ro+2097152>>>0<4194305-!!Yr?(Yr>>>0)+4294967296*Ro:NaN,Bo>>>=0,Yr=new Date(1e3*Yr),l0[Bo>>>2>>>0]=Yr.getSeconds(),l0[Bo+4>>>2>>>0]=Yr.getMinutes(),l0[Bo+8>>>2>>>0]=Yr.getHours(),l0[Bo+12>>>2>>>0]=Yr.getDate(),l0[Bo+16>>>2>>>0]=Yr.getMonth(),l0[Bo+20>>>2>>>0]=Yr.getFullYear()-1900,l0[Bo+24>>>2>>>0]=Yr.getDay(),l0[Bo+28>>>2>>>0]=(Gy(Yr.getFullYear())?fv:Ly)[Yr.getMonth()]+Yr.getDate()-1|0,l0[Bo+36>>>2>>>0]=-(60*Yr.getTimezoneOffset()),Ro=new Date(Yr.getFullYear(),6,1).getTimezoneOffset();var a0=new Date(Yr.getFullYear(),0,1).getTimezoneOffset();l0[Bo+32>>>2>>>0]=(Ro!=a0&&Yr.getTimezoneOffset()==Math.min(a0,Ro))|0},p:function(Yr){Yr>>>=0;var Ro=new Date(l0[Yr+20>>>2>>>0]+1900,l0[Yr+16>>>2>>>0],l0[Yr+12>>>2>>>0],l0[Yr+8>>>2>>>0],l0[Yr+4>>>2>>>0],l0[Yr>>>2>>>0],0),Bo=l0[Yr+32>>>2>>>0],a0=Ro.getTimezoneOffset(),u0=new Date(Ro.getFullYear(),6,1).getTimezoneOffset(),O0=new Date(Ro.getFullYear(),0,1).getTimezoneOffset(),G0=Math.min(O0,u0);return 0>Bo?l0[Yr+32>>>2>>>0]=+(u0!=O0&&G0==a0):0<Bo!=(G0==a0)&&(u0=Math.max(O0,u0),Ro.setTime(Ro.getTime()+6e4*((0<Bo?G0:u0)-a0))),l0[Yr+24>>>2>>>0]=Ro.getDay(),l0[Yr+28>>>2>>>0]=(Gy(Ro.getFullYear())?fv:Ly)[Ro.getMonth()]+Ro.getDate()-1|0,l0[Yr>>>2>>>0]=Ro.getSeconds(),l0[Yr+4>>>2>>>0]=Ro.getMinutes(),l0[Yr+8>>>2>>>0]=Ro.getHours(),l0[Yr+12>>>2>>>0]=Ro.getDate(),l0[Yr+16>>>2>>>0]=Ro.getMonth(),l0[Yr+20>>>2>>>0]=Ro.getYear(),Yr=Ro.getTime(),Yr=isNaN(Yr)?-1:Yr/1e3,Dy((gy=Yr,1<=+Math.abs(gy)?0<gy?+Math.floor(gy/4294967296)>>>0:~~+Math.ceil((gy-+(~~gy>>>0))/4294967296)>>>0:0)),Yr>>>0},l:function(){return-52},m:function(){},t:function(Yr,Ro,Bo,a0){Bo>>>=0,a0>>>=0;var u0=new Date().getFullYear(),O0=new Date(u0,0,1),G0=new Date(u0,6,1);u0=O0.getTimezoneOffset();var Cy=G0.getTimezoneOffset();v0[Yr>>>0>>>2>>>0]=60*Math.max(u0,Cy),l0[Ro>>>0>>>2>>>0]=+(u0!=Cy),Yr=Uy=>Uy.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1],O0=Yr(O0),G0=Yr(G0),Cy<u0?(_y(O0,Xo,Bo,17),_y(G0,Xo,a0,17)):(_y(O0,Xo,a0,17),_y(G0,Xo,Bo,17))},d:()=>{d0("")},B:function(Yr,Ro,Bo){Yr>>>=0,Ro>>>=0,Bo>>>=0,Iy.length=0;for(var a0;a0=Xo[Ro++>>>0];){var u0=a0!=105;u0&=a0!=112,Bo+=u0&&Bo%8?4:0,Iy.push(a0==112?v0[Bo>>>2>>>0]:a0==105?l0[Bo>>>2>>>0]:x0[Bo>>>3>>>0]),Bo+=u0?8:4}return hy[Yr](...Iy)},h:()=>Date.now(),u:function(){return 4294901760},b:()=>performance.now(),s:function(Yr){Yr>>>=0;var Ro=Xo.length;if(4294901760<Yr)return!1;for(var Bo=1;4>=Bo;Bo*=2){var a0=Ro*(1+.2/Bo);a0=Math.min(a0,Yr+100663296);var u0=Math;a0=Math.max(Yr,a0);e:{u0=(u0.min.call(u0,4294901760,a0+(65536-a0%65536)%65536)-_n.buffer.byteLength+65535)/65536;try{_n.grow(u0),D0();var O0=1;break e}catch{}O0=void 0}if(O0)return!0}return!1},C:function(Yr,Ro){Yr>>>=0,Ro>>>=0;var Bo=0;return py().forEach((a0,u0)=>{var O0=Ro+Bo;for(u0=v0[Yr+4*u0>>>2>>>0]=O0,O0=0;O0<a0.length;++O0)Qo[u0++>>>0]=a0.charCodeAt(O0);Qo[u0>>>0]=0,Bo+=a0.length+1}),0},D:function(Yr,Ro){Yr>>>=0,Ro>>>=0;var Bo=py();v0[Yr>>>2>>>0]=Bo.length;var a0=0;return Bo.forEach(u0=>a0+=u0.length+1),v0[Ro>>>2>>>0]=a0,0},f:()=>52,j:function(){return 52},q:function(){return 70},i:function(Yr,Ro,Bo,a0){Ro>>>=0,Bo>>>=0,a0>>>=0;for(var u0=0,O0=0;O0<Bo;O0++){var G0=v0[Ro>>>2>>>0],Cy=v0[Ro+4>>>2>>>0];Ro+=8;for(var Uy=0;Uy<Cy;Uy++){var Ry=Xo[G0+Uy>>>0],Oy=Ay[Yr];Ry===0||Ry===10?((Yr===1?Hr:wn)(vy(Oy,0)),Oy.length=0):Oy.push(Ry)}u0+=Cy}return v0[a0>>>2>>>0]=u0,0},r:ay,c:function(Yr,Ro,Bo,a0){return ay(Yr>>>0,Ro>>>0,Bo>>>0,a0>>>0)}},L0=function(){function Yr(Bo){return L0=Bo.exports,L0=d1(),_n=L0.K,D0(),Mo.unshift(L0.L),Sn--,Sn==0&&t0&&(Bo=t0,t0=null,Bo()),L0}var Ro={a:qy};if(Sn++,d.instantiateWasm)try{return d.instantiateWasm(Ro,Yr)}catch(Bo){wn(`Module.instantiateWasm callback failed with error: ${Bo}`),et(Bo)}return oy(Ro,function(Bo){Yr(Bo.instance)}).catch(et),{}}();d._OrtInit=(Yr,Ro)=>(d._OrtInit=L0.M)(Yr,Ro),d._OrtGetLastError=(Yr,Ro)=>(d._OrtGetLastError=L0.N)(Yr,Ro),d._OrtCreateSessionOptions=(Yr,Ro,Bo,a0,u0,O0,G0,Cy,Uy,Ry)=>(d._OrtCreateSessionOptions=L0.O)(Yr,Ro,Bo,a0,u0,O0,G0,Cy,Uy,Ry),d._OrtAppendExecutionProvider=(Yr,Ro)=>(d._OrtAppendExecutionProvider=L0.P)(Yr,Ro),d._OrtAddFreeDimensionOverride=(Yr,Ro,Bo)=>(d._OrtAddFreeDimensionOverride=L0.Q)(Yr,Ro,Bo),d._OrtAddSessionConfigEntry=(Yr,Ro,Bo)=>(d._OrtAddSessionConfigEntry=L0.R)(Yr,Ro,Bo),d._OrtReleaseSessionOptions=Yr=>(d._OrtReleaseSessionOptions=L0.S)(Yr),d._OrtCreateSession=(Yr,Ro,Bo)=>(d._OrtCreateSession=L0.T)(Yr,Ro,Bo),d._OrtReleaseSession=Yr=>(d._OrtReleaseSession=L0.U)(Yr),d._OrtGetInputOutputCount=(Yr,Ro,Bo)=>(d._OrtGetInputOutputCount=L0.V)(Yr,Ro,Bo),d._OrtGetInputName=(Yr,Ro)=>(d._OrtGetInputName=L0.W)(Yr,Ro),d._OrtGetOutputName=(Yr,Ro)=>(d._OrtGetOutputName=L0.X)(Yr,Ro),d._OrtFree=Yr=>(d._OrtFree=L0.Y)(Yr),d._OrtCreateTensor=(Yr,Ro,Bo,a0,u0,O0)=>(d._OrtCreateTensor=L0.Z)(Yr,Ro,Bo,a0,u0,O0),d._OrtGetTensorData=(Yr,Ro,Bo,a0,u0)=>(d._OrtGetTensorData=L0._)(Yr,Ro,Bo,a0,u0),d._OrtReleaseTensor=Yr=>(d._OrtReleaseTensor=L0.$)(Yr),d._OrtCreateRunOptions=(Yr,Ro,Bo,a0)=>(d._OrtCreateRunOptions=L0.aa)(Yr,Ro,Bo,a0),d._OrtAddRunConfigEntry=(Yr,Ro,Bo)=>(d._OrtAddRunConfigEntry=L0.ba)(Yr,Ro,Bo),d._OrtReleaseRunOptions=Yr=>(d._OrtReleaseRunOptions=L0.ca)(Yr),d._OrtCreateBinding=Yr=>(d._OrtCreateBinding=L0.da)(Yr),d._OrtBindInput=(Yr,Ro,Bo)=>(d._OrtBindInput=L0.ea)(Yr,Ro,Bo),d._OrtBindOutput=(Yr,Ro,Bo,a0)=>(d._OrtBindOutput=L0.fa)(Yr,Ro,Bo,a0),d._OrtClearBoundOutputs=Yr=>(d._OrtClearBoundOutputs=L0.ga)(Yr),d._OrtReleaseBinding=Yr=>(d._OrtReleaseBinding=L0.ha)(Yr),d._OrtRunWithBinding=(Yr,Ro,Bo,a0,u0)=>(d._OrtRunWithBinding=L0.ia)(Yr,Ro,Bo,a0,u0),d._OrtRun=(Yr,Ro,Bo,a0,u0,O0,G0,Cy)=>(d._OrtRun=L0.ja)(Yr,Ro,Bo,a0,u0,O0,G0,Cy),d._OrtEndProfiling=Yr=>(d._OrtEndProfiling=L0.ka)(Yr),d._malloc=Yr=>(d._malloc=L0.la)(Yr),d._free=Yr=>(d._free=L0.ma)(Yr);var Dy=Yr=>(Dy=L0.oa)(Yr),l1=Yr=>(l1=L0.pa)(Yr),g1=Yr=>(g1=L0.qa)(Yr),T0=()=>(T0=L0.ra)();function d1(){var Yr=L0;Yr=Object.assign({},Yr);var Ro=Bo=>a0=>Bo(a0)>>>0;return Yr.la=Ro(Yr.la),Yr.qa=Ro(Yr.qa),Yr.ra=(Bo=>()=>Bo()>>>0)(Yr.ra),Yr}d.stackSave=()=>T0(),d.stackRestore=Yr=>l1(Yr),d.stackAlloc=Yr=>g1(Yr),d.UTF8ToString=$y,d.stringToUTF8=(Yr,Ro,Bo)=>_y(Yr,Xo,Ro,Bo),d.lengthBytesUTF8=o1;var U0;t0=function Yr(){U0||Py(),U0||(t0=Yr)};function Py(){if(!(0<Sn)){if(d.preRun)for(typeof d.preRun=="function"&&(d.preRun=[d.preRun]);d.preRun.length;){var Yr=d.preRun.shift();M0.unshift(Yr)}for(;0<M0.length;)M0.shift()(d);if(!(0<Sn||U0||(U0=!0,d.calledRun=!0,No))){for(;0<Mo.length;)Mo.shift()(d);for($(d);0<e0.length;)e0.shift()(d)}}}return Py(),h}})();typeof e=="object"&&typeof i=="object"?i.exports=a:typeof define=="function"&&define.amd&&define([],()=>a)}),Ep$1=me(()=>{}),Dp$1=me(()=>{}),Lp$1={};Sr(Lp$1,{cpus:()=>ig});var ig,Cp$1=L(()=>{ig=void 0}),kp$1=me((e,i)=>{var a=(()=>{var c;var o=typeof document<"u"?(c=document.currentScript)==null?void 0:c.src:void 0;return typeof __filename<"u"&&(o||(o=__filename)),function(s={}){function d(){return e0.buffer!=xn.buffer&&Z0(),xn}function $(){return e0.buffer!=xn.buffer&&Z0(),f0}function et(){return e0.buffer!=xn.buffer&&Z0(),$0}function h(){return e0.buffer!=xn.buffer&&Z0(),N0}function b(){return e0.buffer!=xn.buffer&&Z0(),j0}var g=s,st,$t,vt=new Promise((nr,wt)=>{st=nr,$t=wt}),Ft=Object.assign({},g),Gt="./this.program",qt=(nr,wt)=>{throw wt},Lt=typeof window=="object",rr=typeof importScripts=="function",jr=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",Hr=g.ENVIRONMENT_IS_PTHREAD||!1,wn="";function _n(nr){return g.locateFile?g.locateFile(nr,wn):wn+nr}var No,Qo,Xo;if(jr){var l0=(Qi$1(),ar(Zi$1)),v0=(ta(),ar(ea));wn=rr?v0.dirname(wn)+"/":__dirname+"/",No=(nr,wt)=>(nr=o1(nr)?new URL(nr):v0.normalize(nr),l0.readFileSync(nr,wt?void 0:"utf8")),Xo=nr=>(nr=No(nr,!0),nr.buffer||(nr=new Uint8Array(nr)),nr),Qo=(nr,wt,jt,tr=!0)=>{nr=o1(nr)?new URL(nr):v0.normalize(nr),l0.readFile(nr,tr?void 0:"utf8",(or,qr)=>{or?jt(or):wt(tr?qr.buffer:qr)})},!g.thisProgram&&1<process.argv.length&&(Gt=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),qt=(nr,wt)=>{throw process.exitCode=nr,wt},global.Worker=Ep$1().Worker}else(Lt||rr)&&(rr?wn=self.location.href:typeof document<"u"&&document.currentScript&&(wn=document.currentScript.src),typeof o<"u"&&o&&(wn=o),wn.startsWith("blob:")?wn="":wn=wn.substr(0,wn.replace(/[?#].*/,"").lastIndexOf("/")+1),jr||(No=nr=>{var wt=new XMLHttpRequest;return wt.open("GET",nr,!1),wt.send(null),wt.responseText},rr&&(Xo=nr=>{var wt=new XMLHttpRequest;return wt.open("GET",nr,!1),wt.responseType="arraybuffer",wt.send(null),new Uint8Array(wt.response)}),Qo=(nr,wt,jt)=>{var tr=new XMLHttpRequest;tr.open("GET",nr,!0),tr.responseType="arraybuffer",tr.onload=()=>{tr.status==200||tr.status==0&&tr.response?wt(tr.response):jt()},tr.onerror=jt,tr.send(null)}));jr&&typeof performance>"u"&&(global.performance=Dp$1().performance);var x0=console.log.bind(console),D0=console.error.bind(console);jr&&(x0=(...nr)=>l0.writeSync(1,nr.join(" ")+`
`),D0=(...nr)=>l0.writeSync(2,nr.join(" ")+`
`));var M0=x0,Mo=D0;Object.assign(g,Ft),Ft=null;var e0,Sn,t0=!1,d0,xn,f0,$0,N0,j0;function Z0(){var nr=e0.buffer;g.HEAP8=xn=new Int8Array(nr),g.HEAP16=new Int16Array(nr),g.HEAPU8=f0=new Uint8Array(nr),g.HEAPU16=new Uint16Array(nr),g.HEAP32=$0=new Int32Array(nr),g.HEAPU32=N0=new Uint32Array(nr),g.HEAPF32=new Float32Array(nr),g.HEAPF64=j0=new Float64Array(nr)}var fy=16777216;if(Hr)e0=g.wasmMemory;else if(g.wasmMemory)e0=g.wasmMemory;else if(e0=new WebAssembly.Memory({initial:fy/65536,maximum:65536,shared:!0}),!(e0.buffer instanceof SharedArrayBuffer))throw Mo("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),jr&&Mo("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");Z0(),fy=e0.buffer.byteLength;var oy=[],gy=[],hy=[],J0=0,H0=null;function yy(){if(J0--,J0==0&&H0){var nr=H0;H0=null,nr()}}function vy(nr){throw nr="Aborted("+nr+")",Mo(nr),t0=!0,d0=1,nr=new WebAssembly.RuntimeError(nr+". Build with -sASSERTIONS for more info."),$t(nr),nr}var $y=nr=>nr.startsWith("data:application/octet-stream;base64,"),o1=nr=>nr.startsWith("file://"),_y;_y="ort-wasm-threaded.wasm",$y(_y)||(_y=_n(_y));function Gy(nr){if(Xo)return Xo(nr);throw"both async and sync fetching of the wasm failed"}function fv(nr){if(Lt||rr){if(typeof fetch=="function"&&!o1(nr))return fetch(nr,{credentials:"same-origin"}).then(wt=>{if(!wt.ok)throw`failed to load wasm binary file at '${nr}'`;return wt.arrayBuffer()}).catch(()=>Gy(nr));if(Qo)return new Promise((wt,jt)=>{Qo(nr,tr=>wt(new Uint8Array(tr)),jt)})}return Promise.resolve().then(()=>Gy(nr))}function Ly(nr,wt,jt){return fv(nr).then(tr=>WebAssembly.instantiate(tr,wt)).then(jt,tr=>{Mo(`failed to asynchronously prepare wasm: ${tr}`),vy(tr)})}function Iy(nr,wt){var jt=_y;return typeof WebAssembly.instantiateStreaming!="function"||$y(jt)||o1(jt)||jr||typeof fetch!="function"?Ly(jt,nr,wt):fetch(jt,{credentials:"same-origin"}).then(tr=>WebAssembly.instantiateStreaming(tr,nr).then(wt,function(or){return Mo(`wasm streaming compile failed: ${or}`),Mo("falling back to ArrayBuffer instantiation"),Ly(jt,nr,wt)}))}var Ny,py={799444:(nr,wt,jt,tr)=>{if(typeof g>"u"||!g.bb)return 1;if(nr=Cy(nr>>>0),nr.startsWith("./")&&(nr=nr.substring(2)),nr=g.bb.get(nr),!nr)return 2;if(wt>>>=0,jt>>>=0,tr>>>=0,wt+jt>nr.byteLength)return 3;try{return $().set(nr.subarray(wt,wt+jt),tr>>>0),0}catch{return 4}}};function n1(nr){this.name="ExitStatus",this.message=`Program terminated with exit(${nr})`,this.status=nr}var Ay=nr=>{nr.terminate(),nr.onmessage=()=>{}},s1=nr=>{T0.Oa.length==0&&(l1(),T0.Xa(T0.Oa[0]));var wt=T0.Oa.pop();if(!wt)return 6;T0.Pa.push(wt),T0.La[nr.Na]=wt,wt.Na=nr.Na;var jt={cmd:"run",start_routine:nr.gb,arg:nr.cb,pthread_ptr:nr.Na};return jr&&wt.unref(),wt.postMessage(jt,nr.mb),0},xy=0,u1=nr=>{var wt=t1();return nr=nr(),Yy(wt),nr},ay=(nr,wt,...jt)=>u1(()=>{for(var tr=jt.length,or=ov(8*tr),qr=or>>>3,Tn=0;Tn<jt.length;Tn++){var o0=jt[Tn];b()[qr+Tn>>>0]=o0}return av(nr,0,tr,or,wt)});function qy(nr){var wt;if(Hr)return ay(0,1,nr);d0=nr,0<xy||(T0.hb(),(wt=g.onExit)==null||wt.call(g,nr),t0=!0),qt(nr,new n1(nr))}var L0=nr=>{if(d0=nr,Hr)throw U0(nr),"unwind";qy(nr)};function Dy(){for(var nr=g.numThreads;nr--;)l1();oy.unshift(()=>{J0++,g1(()=>yy())})}function l1(){var nr=_n("ort-wasm-threaded.worker.js");nr=new Worker(nr),T0.Oa.push(nr)}function g1(nr){Hr?nr():Promise.all(T0.Oa.map(T0.Xa)).then(nr)}var T0={Oa:[],Pa:[],ab:[],La:{},Va(){Hr?(T0.receiveObjectTransfer=T0.fb,T0.threadInitTLS=T0.$a,T0.setExitStatus=T0.Za):Dy()},Za:nr=>d0=nr,pb:["$terminateWorker"],hb:()=>{for(var nr of T0.Pa)Ay(nr);for(nr of T0.Oa)Ay(nr);T0.Oa=[],T0.Pa=[],T0.La=[]},Ya:nr=>{var wt=nr.Na;delete T0.La[wt],T0.Oa.push(nr),T0.Pa.splice(T0.Pa.indexOf(nr),1),nr.Na=0,f1(wt)},fb(){},$a(){T0.ab.forEach(nr=>nr())},Xa:nr=>new Promise(wt=>{nr.onmessage=qr=>{qr=qr.data;var Tn=qr.cmd;if(qr.targetThread&&qr.targetThread!=bv()){var o0=T0.La[qr.targetThread];o0?o0.postMessage(qr,qr.transferList):Mo(`Internal error! Worker sent a message "${Tn}" to target pthread ${qr.targetThread}, but that thread no longer exists!`)}else Tn==="checkMailbox"?J1():Tn==="spawnThread"?s1(qr):Tn==="cleanupThread"?T0.Ya(T0.La[qr.thread]):Tn==="killThread"?(qr=qr.thread,Tn=T0.La[qr],delete T0.La[qr],Ay(Tn),f1(qr),T0.Pa.splice(T0.Pa.indexOf(Tn),1),Tn.Na=0):Tn==="cancelThread"?T0.La[qr.thread].postMessage({cmd:"cancel"}):Tn==="loaded"?(nr.loaded=!0,jr&&!nr.Na&&nr.unref(),wt(nr)):Tn==="alert"?alert(`Thread ${qr.threadId}: ${qr.text}`):qr.target==="setimmediate"?nr.postMessage(qr):Tn==="callHandler"?g[qr.handler](...qr.args):Tn&&Mo(`worker sent an unknown command ${Tn}`)},nr.onerror=qr=>{throw Mo(`worker sent an error! ${qr.filename}:${qr.lineno}: ${qr.message}`),qr},jr&&(nr.on("message",qr=>nr.onmessage({data:qr})),nr.on("error",qr=>nr.onerror(qr)));var jt=[],tr=["onExit"],or;for(or of tr)g.hasOwnProperty(or)&&jt.push(or);nr.postMessage({cmd:"load",handlers:jt,urlOrBlob:g.mainScriptUrlOrBlob||o,wasmMemory:e0,wasmModule:Sn})})};g.PThread=T0;var d1=nr=>{for(;0<nr.length;)nr.shift()(g)};g.establishStackSpace=()=>{var nr=bv(),wt=h()[nr+52>>>2>>>0];nr=h()[nr+56>>>2>>>0],V1(wt,wt-nr),Yy(wt)};function U0(nr){if(Hr)return ay(1,0,nr);L0(nr)}var Py=[],Yr;g.invokeEntryPoint=(nr,wt)=>{xy=0;var jt=Py[nr];jt||(nr>=Py.length&&(Py.length=nr+1),Py[nr]=jt=Yr.get(nr)),nr=jt(wt),0<xy?T0.Za(nr):Fy(nr)};class Ro{constructor(wt){this.Ua=wt-24}Va(wt,jt){h()[this.Ua+16>>>2>>>0]=0,h()[this.Ua+4>>>2>>>0]=wt,h()[this.Ua+8>>>2>>>0]=jt}}var Bo=0;function a0(nr,wt,jt,tr){return Hr?ay(2,1,nr,wt,jt,tr):u0(nr,wt,jt,tr)}function u0(nr,wt,jt,tr){if(nr>>>=0,wt>>>=0,jt>>>=0,tr>>>=0,typeof SharedArrayBuffer>"u")return Mo("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var or=[];return Hr&&or.length===0?a0(nr,wt,jt,tr):(nr={gb:jt,Na:nr,cb:tr,mb:or},Hr?(nr.ob="spawnThread",postMessage(nr,or),0):s1(nr))}var O0=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,G0=(nr,wt,jt)=>{wt>>>=0;var tr=wt+jt;for(jt=wt;nr[jt]&&!(jt>=tr);)++jt;if(16<jt-wt&&nr.buffer&&O0)return O0.decode(nr.buffer instanceof SharedArrayBuffer?nr.slice(wt,jt):nr.subarray(wt,jt));for(tr="";wt<jt;){var or=nr[wt++];if(or&128){var qr=nr[wt++]&63;if((or&224)==192)tr+=String.fromCharCode((or&31)<<6|qr);else{var Tn=nr[wt++]&63;or=(or&240)==224?(or&15)<<12|qr<<6|Tn:(or&7)<<18|qr<<12|Tn<<6|nr[wt++]&63,65536>or?tr+=String.fromCharCode(or):(or-=65536,tr+=String.fromCharCode(55296|or>>10,56320|or&1023))}}else tr+=String.fromCharCode(or)}return tr},Cy=(nr,wt)=>(nr>>>=0)?G0($(),nr,wt):"";function Uy(nr,wt,jt){return Hr?ay(3,1,nr,wt,jt):0}function Ry(nr,wt){if(Hr)return ay(4,1,nr,wt)}var Oy=nr=>{for(var wt=0,jt=0;jt<nr.length;++jt){var tr=nr.charCodeAt(jt);127>=tr?wt++:2047>=tr?wt+=2:55296<=tr&&57343>=tr?(wt+=4,++jt):wt+=3}return wt},P1=(nr,wt,jt,tr)=>{if(jt>>>=0,!(0<tr))return 0;var or=jt;tr=jt+tr-1;for(var qr=0;qr<nr.length;++qr){var Tn=nr.charCodeAt(qr);if(55296<=Tn&&57343>=Tn){var o0=nr.charCodeAt(++qr);Tn=65536+((Tn&1023)<<10)|o0&1023}if(127>=Tn){if(jt>=tr)break;wt[jt++>>>0]=Tn}else{if(2047>=Tn){if(jt+1>=tr)break;wt[jt++>>>0]=192|Tn>>6}else{if(65535>=Tn){if(jt+2>=tr)break;wt[jt++>>>0]=224|Tn>>12}else{if(jt+3>=tr)break;wt[jt++>>>0]=240|Tn>>18,wt[jt++>>>0]=128|Tn>>12&63}wt[jt++>>>0]=128|Tn>>6&63}wt[jt++>>>0]=128|Tn&63}}return wt[jt>>>0]=0,jt-or},Zy=(nr,wt,jt)=>P1(nr,$(),wt,jt);function _g(nr,wt){if(Hr)return ay(5,1,nr,wt)}function ey(nr,wt,jt){if(Hr)return ay(6,1,nr,wt,jt)}function ty(nr,wt,jt){return Hr?ay(7,1,nr,wt,jt):0}function Ey(nr,wt){if(Hr)return ay(8,1,nr,wt)}function R1(nr,wt,jt){if(Hr)return ay(9,1,nr,wt,jt)}function c1(nr,wt,jt,tr){if(Hr)return ay(10,1,nr,wt,jt,tr)}function hv(nr,wt,jt,tr){if(Hr)return ay(11,1,nr,wt,jt,tr)}function mv(nr,wt,jt,tr){if(Hr)return ay(12,1,nr,wt,jt,tr)}function kv(nr){if(Hr)return ay(13,1,nr)}function Q1(nr,wt){if(Hr)return ay(14,1,nr,wt)}function gv(nr,wt,jt){if(Hr)return ay(15,1,nr,wt,jt)}function yv(nr){nr>>>=0,typeof Atomics.nb=="function"&&(Atomics.nb(et(),nr>>>2,nr).value.then(J1),nr+=128,Atomics.store(et(),nr>>>2,1))}g.__emscripten_thread_mailbox_await=yv;var J1=()=>{var nr=bv();if(nr&&(yv(nr),nr=W1,!t0))try{if(nr(),!(0<xy))try{Hr?Fy(d0):L0(d0)}catch(wt){wt instanceof n1||wt=="unwind"||qt(1,wt)}}catch(wt){wt instanceof n1||wt=="unwind"||qt(1,wt)}};g.checkMailbox=J1;var vv=[],T1=nr=>nr%4===0&&(nr%100!==0||nr%400===0),U1=[0,31,60,91,121,152,182,213,244,274,305,335],Iv=[0,31,59,90,120,151,181,212,243,273,304,334];function S1(nr,wt,jt,tr,or,qr,Tn,o0){return Hr?ay(16,1,nr,wt,jt,tr,or,qr,Tn,o0):-52}function Jy(nr,wt,jt,tr,or,qr,Tn){if(Hr)return ay(17,1,nr,wt,jt,tr,or,qr,Tn)}var E1=[],ev={},p1=()=>{if(!Cv){var nr={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:Gt||"./this.program"},wt;for(wt in ev)ev[wt]===void 0?delete nr[wt]:nr[wt]=ev[wt];var jt=[];for(wt in nr)jt.push(`${wt}=${nr[wt]}`);Cv=jt}return Cv},Cv;function zy(nr,wt){if(Hr)return ay(18,1,nr,wt);nr>>>=0,wt>>>=0;var jt=0;return p1().forEach((tr,or)=>{var qr=wt+jt;for(or=h()[nr+4*or>>>2>>>0]=qr,qr=0;qr<tr.length;++qr)d()[or++>>>0]=tr.charCodeAt(qr);d()[or>>>0]=0,jt+=tr.length+1}),0}function tv(nr,wt){if(Hr)return ay(19,1,nr,wt);nr>>>=0,wt>>>=0;var jt=p1();h()[nr>>>2>>>0]=jt.length;var tr=0;return jt.forEach(or=>tr+=or.length+1),h()[wt>>>2>>>0]=tr,0}function F1(nr){return Hr?ay(20,1,nr):52}function e1(nr,wt,jt,tr){return Hr?ay(21,1,nr,wt,jt,tr):52}function rv(nr,wt,jt,tr,or){return Hr?ay(22,1,nr,wt,jt,tr,or):70}var jy=[null,[],[]];function Ky(nr,wt,jt,tr){if(Hr)return ay(23,1,nr,wt,jt,tr);wt>>>=0,jt>>>=0,tr>>>=0;for(var or=0,qr=0;qr<jt;qr++){var Tn=h()[wt>>>2>>>0],o0=h()[wt+4>>>2>>>0];wt+=8;for(var h0=0;h0<o0;h0++){var b0=$()[Tn+h0>>>0],y0=jy[nr];b0===0||b0===10?((nr===1?M0:Mo)(G0(y0,0)),y0.length=0):y0.push(b0)}or+=o0}return h()[tr>>>2>>>0]=or,0}var D1=[31,29,31,30,31,30,31,31,30,31,30,31],Ov=[31,28,31,30,31,30,31,31,30,31,30,31];function Av(nr){var wt=Array(Oy(nr)+1);return P1(nr,wt,0,wt.length),wt}var nv=(nr,wt)=>{d().set(nr,wt>>>0)};function Wv(nr,wt,jt,tr){function or(Go,Uo,S0){for(Go=typeof Go=="number"?Go.toString():Go||"";Go.length<Uo;)Go=S0[0]+Go;return Go}function qr(Go,Uo){return or(Go,Uo,"0")}function Tn(Go,Uo){function S0(ny){return 0>ny?-1:0<ny?1:0}var E0;return(E0=S0(Go.getFullYear()-Uo.getFullYear()))===0&&(E0=S0(Go.getMonth()-Uo.getMonth()))===0&&(E0=S0(Go.getDate()-Uo.getDate())),E0}function o0(Go){switch(Go.getDay()){case 0:return new Date(Go.getFullYear()-1,11,29);case 1:return Go;case 2:return new Date(Go.getFullYear(),0,3);case 3:return new Date(Go.getFullYear(),0,2);case 4:return new Date(Go.getFullYear(),0,1);case 5:return new Date(Go.getFullYear()-1,11,31);case 6:return new Date(Go.getFullYear()-1,11,30)}}function h0(Go){var Uo=Go.Qa;for(Go=new Date(new Date(Go.Ra+1900,0,1).getTime());0<Uo;){var S0=Go.getMonth(),E0=(T1(Go.getFullYear())?D1:Ov)[S0];if(Uo>E0-Go.getDate())Uo-=E0-Go.getDate()+1,Go.setDate(1),11>S0?Go.setMonth(S0+1):(Go.setMonth(0),Go.setFullYear(Go.getFullYear()+1));else{Go.setDate(Go.getDate()+Uo);break}}return S0=new Date(Go.getFullYear()+1,0,4),Uo=o0(new Date(Go.getFullYear(),0,4)),S0=o0(S0),0>=Tn(Uo,Go)?0>=Tn(S0,Go)?Go.getFullYear()+1:Go.getFullYear():Go.getFullYear()-1}nr>>>=0,wt>>>=0,jt>>>=0,tr>>>=0;var b0=h()[tr+40>>>2>>>0];tr={kb:et()[tr>>>2>>>0],jb:et()[tr+4>>>2>>>0],Sa:et()[tr+8>>>2>>>0],Wa:et()[tr+12>>>2>>>0],Ta:et()[tr+16>>>2>>>0],Ra:et()[tr+20>>>2>>>0],Ma:et()[tr+24>>>2>>>0],Qa:et()[tr+28>>>2>>>0],qb:et()[tr+32>>>2>>>0],ib:et()[tr+36>>>2>>>0],lb:b0?Cy(b0):""},jt=Cy(jt),b0={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var y0 in b0)jt=jt.replace(new RegExp(y0,"g"),b0[y0]);var R0="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ry="January February March April May June July August September October November December".split(" ");b0={"%a":Go=>R0[Go.Ma].substring(0,3),"%A":Go=>R0[Go.Ma],"%b":Go=>ry[Go.Ta].substring(0,3),"%B":Go=>ry[Go.Ta],"%C":Go=>qr((Go.Ra+1900)/100|0,2),"%d":Go=>qr(Go.Wa,2),"%e":Go=>or(Go.Wa,2," "),"%g":Go=>h0(Go).toString().substring(2),"%G":h0,"%H":Go=>qr(Go.Sa,2),"%I":Go=>(Go=Go.Sa,Go==0?Go=12:12<Go&&(Go-=12),qr(Go,2)),"%j":Go=>{for(var Uo=0,S0=0;S0<=Go.Ta-1;Uo+=(T1(Go.Ra+1900)?D1:Ov)[S0++]);return qr(Go.Wa+Uo,3)},"%m":Go=>qr(Go.Ta+1,2),"%M":Go=>qr(Go.jb,2),"%n":()=>`
`,"%p":Go=>0<=Go.Sa&&12>Go.Sa?"AM":"PM","%S":Go=>qr(Go.kb,2),"%t":()=>"	","%u":Go=>Go.Ma||7,"%U":Go=>qr(Math.floor((Go.Qa+7-Go.Ma)/7),2),"%V":Go=>{var Uo=Math.floor((Go.Qa+7-(Go.Ma+6)%7)/7);if(2>=(Go.Ma+371-Go.Qa-2)%7&&Uo++,Uo)Uo==53&&(S0=(Go.Ma+371-Go.Qa)%7,S0==4||S0==3&&T1(Go.Ra)||(Uo=1));else{Uo=52;var S0=(Go.Ma+7-Go.Qa-1)%7;(S0==4||S0==5&&T1(Go.Ra%400-1))&&Uo++}return qr(Uo,2)},"%w":Go=>Go.Ma,"%W":Go=>qr(Math.floor((Go.Qa+7-(Go.Ma+6)%7)/7),2),"%y":Go=>(Go.Ra+1900).toString().substring(2),"%Y":Go=>Go.Ra+1900,"%z":Go=>{Go=Go.ib;var Uo=0<=Go;return Go=Math.abs(Go)/60,(Uo?"+":"-")+("0000"+(Go/60*100+Go%60)).slice(-4)},"%Z":Go=>Go.lb,"%%":()=>"%"},jt=jt.replace(/%%/g,"\0\0");for(y0 in b0)jt.includes(y0)&&(jt=jt.replace(new RegExp(y0,"g"),b0[y0](tr)));return jt=jt.replace(/\0\0/g,"%"),y0=Av(jt),y0.length>wt?0:(nv(y0,nr),y0.length-1)}T0.Va();var Pv=[qy,U0,a0,Uy,Ry,_g,ey,ty,Ey,R1,c1,hv,mv,kv,Q1,gv,S1,Jy,zy,tv,F1,e1,rv,Ky],iv={b:function(nr,wt,jt){throw nr>>>=0,new Ro(nr).Va(wt>>>0,jt>>>0),Bo=nr,Bo},L:function(nr){z0(nr>>>0,!rr,1,!Lt,131072,!1),T0.$a()},j:function(nr){nr>>>=0,Hr?postMessage({cmd:"cleanupThread",thread:nr}):T0.Ya(T0.La[nr])},H:u0,h:Uy,S:Ry,D:_g,F:ey,T:ty,Q:Ey,J:R1,P:c1,n:hv,E:mv,B:kv,R:Q1,C:gv,p:()=>1,z:function(nr,wt){nr>>>=0,nr==wt>>>0?setTimeout(J1):Hr?postMessage({targetThread:nr,cmd:"checkMailbox"}):(nr=T0.La[nr])&&nr.postMessage({cmd:"checkMailbox"})},I:function(nr,wt,jt,tr,or){wt>>>=0,jt>>>=0,vv.length=tr,or=or>>>0>>>3;for(var qr=0;qr<tr;qr++)vv[qr]=b()[or+qr>>>0];return nr=wt?py[wt]:Pv[nr],T0.eb=jt,jt=nr(...vv),T0.eb=0,jt},K:yv,o:function(nr){jr&&T0.La[nr>>>0].ref()},s:function(nr,wt,jt){nr=wt+2097152>>>0<4194305-!!nr?(nr>>>0)+4294967296*wt:NaN,jt>>>=0,nr=new Date(1e3*nr),et()[jt>>>2>>>0]=nr.getUTCSeconds(),et()[jt+4>>>2>>>0]=nr.getUTCMinutes(),et()[jt+8>>>2>>>0]=nr.getUTCHours(),et()[jt+12>>>2>>>0]=nr.getUTCDate(),et()[jt+16>>>2>>>0]=nr.getUTCMonth(),et()[jt+20>>>2>>>0]=nr.getUTCFullYear()-1900,et()[jt+24>>>2>>>0]=nr.getUTCDay(),nr=(nr.getTime()-Date.UTC(nr.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,et()[jt+28>>>2>>>0]=nr},t:function(nr,wt,jt){nr=wt+2097152>>>0<4194305-!!nr?(nr>>>0)+4294967296*wt:NaN,jt>>>=0,nr=new Date(1e3*nr),et()[jt>>>2>>>0]=nr.getSeconds(),et()[jt+4>>>2>>>0]=nr.getMinutes(),et()[jt+8>>>2>>>0]=nr.getHours(),et()[jt+12>>>2>>>0]=nr.getDate(),et()[jt+16>>>2>>>0]=nr.getMonth(),et()[jt+20>>>2>>>0]=nr.getFullYear()-1900,et()[jt+24>>>2>>>0]=nr.getDay(),wt=(T1(nr.getFullYear())?U1:Iv)[nr.getMonth()]+nr.getDate()-1|0,et()[jt+28>>>2>>>0]=wt,et()[jt+36>>>2>>>0]=-(60*nr.getTimezoneOffset()),wt=new Date(nr.getFullYear(),6,1).getTimezoneOffset();var tr=new Date(nr.getFullYear(),0,1).getTimezoneOffset();nr=(wt!=tr&&nr.getTimezoneOffset()==Math.min(tr,wt))|0,et()[jt+32>>>2>>>0]=nr},u:function(nr){nr>>>=0;var wt=new Date(et()[nr+20>>>2>>>0]+1900,et()[nr+16>>>2>>>0],et()[nr+12>>>2>>>0],et()[nr+8>>>2>>>0],et()[nr+4>>>2>>>0],et()[nr>>>2>>>0],0),jt=et()[nr+32>>>2>>>0],tr=wt.getTimezoneOffset(),or=new Date(wt.getFullYear(),6,1).getTimezoneOffset(),qr=new Date(wt.getFullYear(),0,1).getTimezoneOffset(),Tn=Math.min(qr,or);return 0>jt?et()[nr+32>>>2>>>0]=+(or!=qr&&Tn==tr):0<jt!=(Tn==tr)&&(or=Math.max(qr,or),wt.setTime(wt.getTime()+6e4*((0<jt?Tn:or)-tr))),et()[nr+24>>>2>>>0]=wt.getDay(),jt=(T1(wt.getFullYear())?U1:Iv)[wt.getMonth()]+wt.getDate()-1|0,et()[nr+28>>>2>>>0]=jt,et()[nr>>>2>>>0]=wt.getSeconds(),et()[nr+4>>>2>>>0]=wt.getMinutes(),et()[nr+8>>>2>>>0]=wt.getHours(),et()[nr+12>>>2>>>0]=wt.getDate(),et()[nr+16>>>2>>>0]=wt.getMonth(),et()[nr+20>>>2>>>0]=wt.getYear(),nr=wt.getTime(),nr=isNaN(nr)?-1:nr/1e3,M1((Ny=nr,1<=+Math.abs(Ny)?0<Ny?+Math.floor(Ny/4294967296)>>>0:~~+Math.ceil((Ny-+(~~Ny>>>0))/4294967296)>>>0:0)),nr>>>0},q:S1,r:Jy,y:function(nr,wt,jt,tr){nr>>>=0,wt>>>=0,jt>>>=0,tr>>>=0;var or=new Date().getFullYear(),qr=new Date(or,0,1),Tn=new Date(or,6,1);or=qr.getTimezoneOffset();var o0=Tn.getTimezoneOffset(),h0=Math.max(or,o0);h()[nr>>>2>>>0]=60*h0,et()[wt>>>2>>>0]=+(or!=o0),nr=b0=>b0.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1],qr=nr(qr),Tn=nr(Tn),o0<or?(Zy(qr,jt,17),Zy(Tn,tr,17)):(Zy(qr,tr,17),Zy(Tn,jt,17))},c:()=>{vy("")},O:function(nr,wt,jt){nr>>>=0,wt>>>=0,jt>>>=0,E1.length=0;for(var tr;tr=$()[wt++>>>0];){var or=tr!=105;or&=tr!=112,jt+=or&&jt%8?4:0,E1.push(tr==112?h()[jt>>>2>>>0]:tr==105?et()[jt>>>2>>>0]:b()[jt>>>3>>>0]),jt+=or?8:4}return py[nr](...E1)},k:()=>{},i:()=>Date.now(),U:()=>{throw xy+=1,"unwind"},A:function(){return 4294901760},e:()=>performance.timeOrigin+performance.now(),f:()=>jr?(Cp$1(),ar(Lp$1)).cpus().length:navigator.hardwareConcurrency,x:function(nr){nr>>>=0;var wt=$().length;if(nr<=wt||4294901760<nr)return!1;for(var jt=1;4>=jt;jt*=2){var tr=wt*(1+.2/jt);tr=Math.min(tr,nr+100663296);var or=Math;tr=Math.max(nr,tr);e:{or=(or.min.call(or,4294901760,tr+(65536-tr%65536)%65536)-e0.buffer.byteLength+65535)/65536;try{e0.grow(or),Z0();var qr=1;break e}catch{}qr=void 0}if(qr)return!0}return!1},M:zy,N:tv,G:L0,g:F1,m:e1,v:rv,l:Ky,a:e0||g.wasmMemory,w:Wv,d:function(nr,wt,jt,tr){return Wv(nr>>>0,wt>>>0,jt>>>0,tr>>>0)}},P0=function(){function nr(jt,tr){return P0=jt.exports,P0=i1(),T0.ab.push(P0.ya),Yr=P0.za,gy.unshift(P0.V),Sn=tr,yy(),P0}var wt={a:iv};if(J0++,g.instantiateWasm)try{return g.instantiateWasm(wt,nr)}catch(jt){Mo(`Module.instantiateWasm callback failed with error: ${jt}`),$t(jt)}return Iy(wt,function(jt){nr(jt.instance,jt.module)}).catch($t),{}}();g._OrtInit=(nr,wt)=>(g._OrtInit=P0.W)(nr,wt),g._OrtGetLastError=(nr,wt)=>(g._OrtGetLastError=P0.X)(nr,wt),g._OrtCreateSessionOptions=(nr,wt,jt,tr,or,qr,Tn,o0,h0,b0)=>(g._OrtCreateSessionOptions=P0.Y)(nr,wt,jt,tr,or,qr,Tn,o0,h0,b0),g._OrtAppendExecutionProvider=(nr,wt)=>(g._OrtAppendExecutionProvider=P0.Z)(nr,wt),g._OrtAddFreeDimensionOverride=(nr,wt,jt)=>(g._OrtAddFreeDimensionOverride=P0._)(nr,wt,jt),g._OrtAddSessionConfigEntry=(nr,wt,jt)=>(g._OrtAddSessionConfigEntry=P0.$)(nr,wt,jt),g._OrtReleaseSessionOptions=nr=>(g._OrtReleaseSessionOptions=P0.aa)(nr),g._OrtCreateSession=(nr,wt,jt)=>(g._OrtCreateSession=P0.ba)(nr,wt,jt),g._OrtReleaseSession=nr=>(g._OrtReleaseSession=P0.ca)(nr),g._OrtGetInputOutputCount=(nr,wt,jt)=>(g._OrtGetInputOutputCount=P0.da)(nr,wt,jt),g._OrtGetInputName=(nr,wt)=>(g._OrtGetInputName=P0.ea)(nr,wt),g._OrtGetOutputName=(nr,wt)=>(g._OrtGetOutputName=P0.fa)(nr,wt),g._OrtFree=nr=>(g._OrtFree=P0.ga)(nr),g._OrtCreateTensor=(nr,wt,jt,tr,or,qr)=>(g._OrtCreateTensor=P0.ha)(nr,wt,jt,tr,or,qr),g._OrtGetTensorData=(nr,wt,jt,tr,or)=>(g._OrtGetTensorData=P0.ia)(nr,wt,jt,tr,or),g._OrtReleaseTensor=nr=>(g._OrtReleaseTensor=P0.ja)(nr),g._OrtCreateRunOptions=(nr,wt,jt,tr)=>(g._OrtCreateRunOptions=P0.ka)(nr,wt,jt,tr),g._OrtAddRunConfigEntry=(nr,wt,jt)=>(g._OrtAddRunConfigEntry=P0.la)(nr,wt,jt),g._OrtReleaseRunOptions=nr=>(g._OrtReleaseRunOptions=P0.ma)(nr),g._OrtCreateBinding=nr=>(g._OrtCreateBinding=P0.na)(nr),g._OrtBindInput=(nr,wt,jt)=>(g._OrtBindInput=P0.oa)(nr,wt,jt),g._OrtBindOutput=(nr,wt,jt,tr)=>(g._OrtBindOutput=P0.pa)(nr,wt,jt,tr),g._OrtClearBoundOutputs=nr=>(g._OrtClearBoundOutputs=P0.qa)(nr),g._OrtReleaseBinding=nr=>(g._OrtReleaseBinding=P0.ra)(nr),g._OrtRunWithBinding=(nr,wt,jt,tr,or)=>(g._OrtRunWithBinding=P0.sa)(nr,wt,jt,tr,or),g._OrtRun=(nr,wt,jt,tr,or,qr,Tn,o0)=>(g._OrtRun=P0.ta)(nr,wt,jt,tr,or,qr,Tn,o0),g._OrtEndProfiling=nr=>(g._OrtEndProfiling=P0.ua)(nr);var bv=g._pthread_self=()=>(bv=g._pthread_self=P0.va)();g._malloc=nr=>(g._malloc=P0.wa)(nr),g._free=nr=>(g._free=P0.xa)(nr),g.__emscripten_tls_init=()=>(g.__emscripten_tls_init=P0.ya)();var z0=g.__emscripten_thread_init=(nr,wt,jt,tr,or,qr)=>(z0=g.__emscripten_thread_init=P0.Aa)(nr,wt,jt,tr,or,qr);g.__emscripten_thread_crashed=()=>(g.__emscripten_thread_crashed=P0.Ba)();var av=(nr,wt,jt,tr,or)=>(av=P0.Ca)(nr,wt,jt,tr,or),f1=nr=>(f1=P0.Da)(nr),Fy=g.__emscripten_thread_exit=nr=>(Fy=g.__emscripten_thread_exit=P0.Ea)(nr),W1=()=>(W1=P0.Fa)(),M1=nr=>(M1=P0.Ga)(nr),V1=(nr,wt)=>(V1=P0.Ha)(nr,wt),Yy=nr=>(Yy=P0.Ia)(nr),ov=nr=>(ov=P0.Ja)(nr),t1=()=>(t1=P0.Ka)();function i1(){var nr=P0;nr=Object.assign({},nr);var wt=tr=>()=>tr()>>>0,jt=tr=>or=>tr(or)>>>0;return nr.va=wt(nr.va),nr.wa=jt(nr.wa),nr.emscripten_main_runtime_thread_id=wt(nr.emscripten_main_runtime_thread_id),nr.Ja=jt(nr.Ja),nr.Ka=wt(nr.Ka),nr}g.wasmMemory=e0,g.stackSave=()=>t1(),g.stackRestore=nr=>Yy(nr),g.stackAlloc=nr=>ov(nr),g.keepRuntimeAlive=()=>0<xy,g.UTF8ToString=Cy,g.stringToUTF8=Zy,g.lengthBytesUTF8=Oy,g.ExitStatus=n1,g.PThread=T0;var H1;H0=function nr(){H1||y1(),H1||(H0=nr)};function y1(){if(!(0<J0))if(Hr)st(g),Hr||d1(gy),startWorker(g);else{if(g.preRun)for(typeof g.preRun=="function"&&(g.preRun=[g.preRun]);g.preRun.length;)oy.unshift(g.preRun.shift());d1(oy),0<J0||H1||(H1=!0,g.calledRun=!0,t0||(Hr||d1(gy),st(g),Hr||d1(hy)))}}return y1(),vt}})();typeof e=="object"&&typeof i=="object"?i.exports=a:typeof define=="function"&&define.amd&&define([],()=>a)}),Bp$1=me((e,i)=>{i.exports='"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(...e){var a=e.join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,a+`\n`);return}console.error(a)}function threadAlert(...e){var a=e.join(" ");postMessage({cmd:"alert",text:a,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,a)=>{var r=Module.wasmModule;Module.wasmModule=null;var t=new WebAssembly.Instance(r,e);return a(t)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let r=[];self.onmessage=t=>r.push(t),self.startWorker=t=>{Module=t,postMessage({cmd:"loaded"});for(let s of r)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const t of e.data.handlers)Module[t]=(...s)=>{postMessage({cmd:"callHandler",handler:t,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var a=URL.createObjectURL(e.data.urlOrBlob);importScripts(a),URL.revokeObjectURL(a)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(r){if(r!="unwind")throw r}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(r){throw Module.__emscripten_thread_crashed?.(),r}}self.onmessage=handleMessage;\n'}),Rp$1,sg,oa$1,ia$1,So$1,Np$1,ug,lg,fg,Mp$1,De$1,Ur=L(()=>{Rp$1=Pp$1(),sg=kp$1(),ia$1=!1,So$1=!1,Np$1=!1,ug=e=>{if(e===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},lg=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},fg=(e,i)=>e?i?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":i?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Mp$1=async e=>{if(ia$1)return Promise.resolve();if(So$1)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(Np$1)throw new Error("previous call to 'initializeWebAssembly()' failed.");So$1=!0;let i=e.initTimeout,a=e.numThreads,o=e.simd,c=ug(a),s=o&&lg(),d=e.wasmPaths,$=typeof d=="string"?d:void 0,et=fg(s,c),h=typeof d=="object"?d[et]:void 0,b=!1,g=[];if(i>0&&g.push(new Promise(st=>{setTimeout(()=>{b=!0,st()},i)})),g.push(new Promise((st,$t)=>{let vt=c?sg:Rp$1,Ft={locateFile:(Gt,qt)=>c&&Gt.endsWith(".worker.js")&&typeof Blob<"u"?URL.createObjectURL(new Blob([Bp$1()],{type:"text/javascript"})):Gt.endsWith(".wasm")?h||($??qt)+et:qt+Gt};if(c)if(Ft.numThreads=a,typeof Blob>"u")Ft.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let Gt=`var ortWasmThreaded=${vt.toString()};`;Ft.mainScriptUrlOrBlob=new Blob([Gt],{type:"text/javascript"})}vt(Ft).then(Gt=>{So$1=!1,ia$1=!0,oa$1=Gt,st()},Gt=>{So$1=!1,Np$1=!0,$t(Gt)})})),await Promise.race(g),b)throw new Error(`WebAssembly backend initializing failed due to timeout: ${i}ms`)},De$1=()=>{if(ia$1&&oa$1)return oa$1;throw new Error("WebAssembly is not initialized yet.")}}),ve,bn,_e$1,Ao=L(()=>{Ur(),ve=(e,i)=>{let a=De$1(),o=a.lengthBytesUTF8(e)+1,c=a._malloc(o);return a.stringToUTF8(e,c,o),i.push(c),c},bn=(e,i,a,o)=>{if(typeof e=="object"&&e!==null){if(a.has(e))throw new Error("Circular reference in options");a.add(e)}Object.entries(e).forEach(([c,s])=>{let d=i?i+c:c;if(typeof s=="object")bn(s,d+".",a,o);else if(typeof s=="string"||typeof s=="number")o(d,s.toString());else if(typeof s=="boolean")o(d,s?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof s}`)})},_e$1=e=>{let i=De$1(),a=i.stackSave();try{let o=i.stackAlloc(8);i._OrtGetLastError(o,o+4);let c=i.HEAP32[o/4],s=i.HEAPU32[o/4+1],d=s?i.UTF8ToString(s):"";throw new Error(`${e} ERROR_CODE: ${c}, ERROR_MESSAGE: ${d}`)}finally{i.stackRestore(a)}}}),Gp$1,Up$1=L(()=>{Ur(),Ao(),Gp$1=e=>{let i=De$1(),a=0,o=[],c=e||{};try{if((e==null?void 0:e.logSeverityLevel)===void 0)c.logSeverityLevel=2;else if(typeof e.logSeverityLevel!="number"||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if((e==null?void 0:e.logVerbosityLevel)===void 0)c.logVerbosityLevel=0;else if(typeof e.logVerbosityLevel!="number"||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);(e==null?void 0:e.terminate)===void 0&&(c.terminate=!1);let s=0;return(e==null?void 0:e.tag)!==void 0&&(s=ve(e.tag,o)),a=i._OrtCreateRunOptions(c.logSeverityLevel,c.logVerbosityLevel,!!c.terminate,s),a===0&&_e$1("Can't create run options."),(e==null?void 0:e.extra)!==void 0&&bn(e.extra,"",new WeakSet,(d,$)=>{let et=ve(d,o),h=ve($,o);i._OrtAddRunConfigEntry(a,et,h)!==0&&_e$1(`Can't set a run config entry: ${d} - ${$}.`)}),[a,o]}catch(s){throw a!==0&&i._OrtReleaseRunOptions(a),o.forEach(d=>i._free(d)),s}}}),cg,pg,dg,hg,zp$1,Vp$1=L(()=>{Ur(),Ao(),cg=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},pg=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},dg=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let i=e.extra.session;i.use_ort_model_bytes_directly||(i.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(a=>(typeof a=="string"?a:a.name)==="webgpu")&&(e.enableMemPattern=!1)},hg=(e,i,a)=>{for(let o of i){let c=typeof o=="string"?o:o.name;switch(c){case"webnn":if(c="WEBNN",typeof o!="string"){let d=o;if(d!=null&&d.deviceType){let $=ve("deviceType",a),et=ve(d.deviceType,a);De$1()._OrtAddSessionConfigEntry(e,$,et)!==0&&_e$1(`Can't set a session config entry: 'deviceType' - ${d.deviceType}.`)}if(d!=null&&d.numThreads){let $=d.numThreads;(typeof $!="number"||!Number.isInteger($)||$<0)&&($=0);let et=ve("numThreads",a),h=ve($.toString(),a);De$1()._OrtAddSessionConfigEntry(e,et,h)!==0&&_e$1(`Can't set a session config entry: 'numThreads' - ${d.numThreads}.`)}if(d!=null&&d.powerPreference){let $=ve("powerPreference",a),et=ve(d.powerPreference,a);De$1()._OrtAddSessionConfigEntry(e,$,et)!==0&&_e$1(`Can't set a session config entry: 'powerPreference' - ${d.powerPreference}.`)}}break;case"webgpu":if(c="JS",typeof o!="string"){let d=o;if(d!=null&&d.preferredLayout){if(d.preferredLayout!=="NCHW"&&d.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${d.preferredLayout}`);let $=ve("preferredLayout",a),et=ve(d.preferredLayout,a);De$1()._OrtAddSessionConfigEntry(e,$,et)!==0&&_e$1(`Can't set a session config entry: 'preferredLayout' - ${d.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${c}`)}let s=ve(c,a);De$1()._OrtAppendExecutionProvider(e,s)!==0&&_e$1(`Can't append execution provider: ${c}.`)}},zp$1=e=>{let i=De$1(),a=0,o=[],c=e||{};dg(c);try{let s=cg(c.graphOptimizationLevel??"all"),d=pg(c.executionMode??"sequential"),$=typeof c.logId=="string"?ve(c.logId,o):0,et=c.logSeverityLevel??2;if(!Number.isInteger(et)||et<0||et>4)throw new Error(`log serverity level is not valid: ${et}`);let h=c.logVerbosityLevel??0;if(!Number.isInteger(h)||h<0||h>4)throw new Error(`log verbosity level is not valid: ${h}`);let b=typeof c.optimizedModelFilePath=="string"?ve(c.optimizedModelFilePath,o):0;if(a=i._OrtCreateSessionOptions(s,!!c.enableCpuMemArena,!!c.enableMemPattern,d,!!c.enableProfiling,0,$,et,h,b),a===0&&_e$1("Can't create session options."),c.executionProviders&&hg(a,c.executionProviders,o),c.enableGraphCapture!==void 0){if(typeof c.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${c.enableGraphCapture}`);let g=ve("enableGraphCapture",o),st=ve(c.enableGraphCapture.toString(),o);i._OrtAddSessionConfigEntry(a,g,st)!==0&&_e$1(`Can't set a session config entry: 'enableGraphCapture' - ${c.enableGraphCapture}.`)}if(c.freeDimensionOverrides)for(let[g,st]of Object.entries(c.freeDimensionOverrides)){if(typeof g!="string")throw new Error(`free dimension override name must be a string: ${g}`);if(typeof st!="number"||!Number.isInteger(st)||st<0)throw new Error(`free dimension override value must be a non-negative integer: ${st}`);let $t=ve(g,o);i._OrtAddFreeDimensionOverride(a,$t,st)!==0&&_e$1(`Can't set a free dimension override: ${g} - ${st}.`)}return c.extra!==void 0&&bn(c.extra,"",new WeakSet,(g,st)=>{let $t=ve(g,o),vt=ve(st,o);i._OrtAddSessionConfigEntry(a,$t,vt)!==0&&_e$1(`Can't set a session config entry: ${g} - ${st}.`)}),[a,o]}catch(s){throw a!==0&&i._OrtReleaseSessionOptions(a),o.forEach(d=>i._free(d)),s}}}),aa$1,Wp$1,sa$1,Hp$1,qp$1,Po,jp$1,ua$1=L(()=>{aa$1=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},Wp$1=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},sa$1=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],Hp$1=e=>{switch(e){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},qp$1=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},Po=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint8"||e==="bool",jp$1=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${e}`)}}}),gn,la$1=L(()=>{gn=async e=>{if(typeof e=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(e))}catch(i){if(i.code==="ERR_FS_FILE_TOO_LARGE"){let a=(void 0)(e),o=[];for await(let c of a)o.push(c);return new Uint8Array(Buffer.concat(o))}throw i}else{let i=await fetch(e);if(!i.ok)throw new Error(`failed to load external data file: ${e}`);let a=i.headers.get("Content-Length"),o=a?parseInt(a,10):0;if(o<1073741824)return new Uint8Array(await i.arrayBuffer());{if(!i.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let c=i.body.getReader(),s;try{s=new ArrayBuffer(o)}catch($){if($ instanceof RangeError){let et=Math.ceil(o/65536);s=new WebAssembly.Memory({initial:et,maximum:et}).buffer}else throw $}let d=0;for(;;){let{done:$,value:et}=await c.read();if($)break;let h=et.byteLength;new Uint8Array(s,d,h).set(et),d+=h}return new Uint8Array(s,0,o)}}else return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)}}),mg,Xp$1,Kp$1,zr$1,bg,fa$1,Jp$1,Zp$1,Yp$1,Qp$1,ed$1,td$1,rd$1=L(()=>{Up$1(),Vp$1(),ua$1(),Ur(),Ao(),la$1(),mg=(e,i)=>{De$1()._OrtInit(e,i)!==0&&_e$1("Can't initialize onnxruntime.")},Xp$1=async e=>{mg(e.wasm.numThreads,qp$1(e.logLevel))},Kp$1=async(e,i)=>{},zr$1=new Map,bg=e=>{let i=De$1(),a=i.stackSave();try{let o=i.stackAlloc(8);return i._OrtGetInputOutputCount(e,o,o+4)!==0&&_e$1("Can't get session input/output count."),[i.HEAP32[o/4],i.HEAP32[o/4+1]]}finally{i.stackRestore(a)}},fa$1=e=>{let i=De$1(),a=i._malloc(e.byteLength);if(a===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return i.HEAPU8.set(e,a),[a,e.byteLength]},Jp$1=async(e,i)=>{var b;let a,o,c=De$1();Array.isArray(e)?[a,o]=e:e.buffer===c.HEAPU8.buffer?[a,o]=[e.byteOffset,e.byteLength]:[a,o]=fa$1(e);let s=0,d=0,$=[],et=[],h=[];try{if([d,$]=zp$1(i),(i==null?void 0:i.externalData)&&c.mountExternalData){let Lt=[];for(let rr of i.externalData){let jr=typeof rr=="string"?rr:rr.path;Lt.push(gn(typeof rr=="string"?rr:rr.data).then(Hr=>{c.mountExternalData(jr,Hr)}))}await Promise.all(Lt)}s=await c._OrtCreateSession(a,o,d),s===0&&_e$1("Can't create a session.");let[g,st]=bg(s),$t=!!(i!=null&&i.enableGraphCapture),vt=[],Ft=[],Gt=[];for(let Lt=0;Lt<g;Lt++){let rr=c._OrtGetInputName(s,Lt);rr===0&&_e$1("Can't get an input name."),et.push(rr),vt.push(c.UTF8ToString(rr))}for(let Lt=0;Lt<st;Lt++){let rr=c._OrtGetOutputName(s,Lt);rr===0&&_e$1("Can't get an output name."),h.push(rr);let jr=c.UTF8ToString(rr);Ft.push(jr)}let qt=null;return zr$1.set(s,[s,et,h,qt,$t,!1]),[s,vt,Ft]}catch(g){throw et.forEach(st=>c._OrtFree(st)),h.forEach(st=>c._OrtFree(st)),s!==0&&c._OrtReleaseSession(s),g}finally{c._free(a),d!==0&&c._OrtReleaseSessionOptions(d),$.forEach(g=>c._free(g)),(b=c.unmountExternalData)==null||b.call(c)}},Zp$1=e=>{var et;let i=De$1(),a=zr$1.get(e);if(!a)throw new Error(`cannot release session. invalid session id: ${e}`);let[o,c,s,d,$]=a;d&&($&&i._OrtClearBoundOutputs(d.handle),i._OrtReleaseBinding(d.handle)),(et=i.jsepOnReleaseSession)==null||et.call(i,e),c.forEach(h=>i._OrtFree(h)),s.forEach(h=>i._OrtFree(h)),i._OrtReleaseSession(o),zr$1.delete(e)},Yp$1=(e,i,a,o,c,s=!1)=>{if(!e){i.push(0);return}let d=De$1(),$=e[0],et=e[1],h=e[3],b,g;if($==="string"&&h==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(s&&h!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${c} when enableGraphCapture is true.`);if(h==="gpu-buffer"){let vt=e[2].gpuBuffer,Ft=sa$1(aa$1($));g=et.reduce((qt,Lt)=>qt*Lt,1)*Ft;let Gt=d.jsepRegisterBuffer;if(!Gt)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');b=Gt(o,c,vt,g)}else{let vt=e[2];if(Array.isArray(vt)){g=4*vt.length,b=d._malloc(g),a.push(b);let Ft=b/4;for(let Gt=0;Gt<vt.length;Gt++){if(typeof vt[Gt]!="string")throw new TypeError(`tensor data at index ${Gt} is not a string`);d.HEAPU32[Ft++]=ve(vt[Gt],a)}}else g=vt.byteLength,b=d._malloc(g),a.push(b),d.HEAPU8.set(new Uint8Array(vt.buffer,vt.byteOffset,g),b)}let st=d.stackSave(),$t=d.stackAlloc(4*et.length);try{let vt=$t/4;et.forEach(Gt=>d.HEAP32[vt++]=Gt);let Ft=d._OrtCreateTensor(aa$1($),b,g,$t,et.length,jp$1(h));Ft===0&&_e$1(`Can't create tensor for input/output. session=${o}, index=${c}.`),i.push(Ft)}finally{d.stackRestore(st)}},Qp$1=async(e,i,a,o,c,s)=>{var Qo;let d=De$1(),$=zr$1.get(e);if(!$)throw new Error(`cannot run inference. invalid session id: ${e}`);let et=$[0],h=$[1],b=$[2],g=$[3],st=$[4];$[5];let $t=i.length,vt=o.length,Ft=0,Gt=[],qt=[],Lt=[],rr=[],jr=d.stackSave(),Hr=d.stackAlloc($t*4),wn=d.stackAlloc($t*4),_n=d.stackAlloc(vt*4),No=d.stackAlloc(vt*4);try{[Ft,Gt]=Gp$1(s);for(let Mo=0;Mo<$t;Mo++)Yp$1(a[Mo],qt,rr,e,i[Mo],st);for(let Mo=0;Mo<vt;Mo++)Yp$1(c[Mo],Lt,rr,e,$t+o[Mo],st);let Xo=Hr/4,l0=wn/4,v0=_n/4,x0=No/4;for(let Mo=0;Mo<$t;Mo++)d.HEAPU32[Xo++]=qt[Mo],d.HEAPU32[l0++]=h[i[Mo]];for(let Mo=0;Mo<vt;Mo++)d.HEAPU32[v0++]=Lt[Mo],d.HEAPU32[x0++]=b[o[Mo]];(Qo=d.jsepOnRunStart)==null||Qo.call(d,et);let D0;D0=await d._OrtRun(et,wn,Hr,$t,No,vt,_n,Ft),D0!==0&&_e$1("failed to call OrtRun().");let M0=[];for(let Mo=0;Mo<vt;Mo++){let e0=d.HEAPU32[_n/4+Mo];if(e0===Lt[Mo]){M0.push(c[Mo]);continue}let Sn=d.stackSave(),t0=d.stackAlloc(4*4),d0=!1,xn,f0=0;try{d._OrtGetTensorData(e0,t0,t0+4,t0+8,t0+12)!==0&&_e$1(`Can't access output tensor data on index ${Mo}.`);let $0=t0/4,N0=d.HEAPU32[$0++];f0=d.HEAPU32[$0++];let j0=d.HEAPU32[$0++],Z0=d.HEAPU32[$0++],fy=[];for(let hy=0;hy<Z0;hy++)fy.push(d.HEAPU32[j0/4+hy]);d._OrtFree(j0);let oy=fy.reduce((hy,J0)=>hy*J0,1);xn=Wp$1(N0);let gy=g==null?void 0:g.outputPreferredLocations[o[Mo]];if(xn==="string"){if(gy==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let hy=[],J0=f0/4;for(let H0=0;H0<oy;H0++){let yy=d.HEAPU32[J0++],vy=H0===oy-1?void 0:d.HEAPU32[J0]-yy;hy.push(d.UTF8ToString(yy,vy))}M0.push([xn,fy,hy,"cpu"])}else if(gy==="gpu-buffer"&&oy>0){let hy=d.jsepGetBuffer;if(!hy)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let J0=hy(f0),H0=sa$1(N0);if(H0===void 0||!Po(xn))throw new Error(`Unsupported data type: ${xn}`);d0=!0,M0.push([xn,fy,{gpuBuffer:J0,download:d.jsepCreateDownloader(J0,oy*H0,xn),dispose:()=>{d._OrtReleaseTensor(e0)}},"gpu-buffer"])}else{let hy=Hp$1(xn),J0=new hy(oy);new Uint8Array(J0.buffer,J0.byteOffset,J0.byteLength).set(d.HEAPU8.subarray(f0,f0+J0.byteLength)),M0.push([xn,fy,J0,"cpu"])}}finally{d.stackRestore(Sn),xn==="string"&&f0&&d._free(f0),d0||d._OrtReleaseTensor(e0)}}return g&&!st&&(d._OrtClearBoundOutputs(g.handle),zr$1.set(e,[et,h,b,g,st,!1])),M0}finally{d.stackRestore(jr),qt.forEach(Xo=>d._OrtReleaseTensor(Xo)),Lt.forEach(Xo=>d._OrtReleaseTensor(Xo)),rr.forEach(Xo=>d._free(Xo)),Ft!==0&&d._OrtReleaseRunOptions(Ft),Gt.forEach(Xo=>d._free(Xo))}},ed$1=e=>{let i=De$1(),a=zr$1.get(e);if(!a)throw new Error("invalid session id");let o=a[0],c=i._OrtEndProfiling(o);c===0&&_e$1("Can't get an profile file name."),i._OrtFree(c)},td$1=e=>{let i=[];for(let a of e){let o=a[2];!Array.isArray(o)&&"buffer"in o&&i.push(o.buffer)}return i}}),nd$1=me((e,i)=>{i.exports='/*!\n * ONNX Runtime Web v1.18.0\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n"use strict";(()=>{var vt=Object.defineProperty;var qr=Object.getOwnPropertyDescriptor;var Vr=Object.getOwnPropertyNames;var Jr=Object.prototype.hasOwnProperty;var _t=(i,c)=>()=>(i&&(c=i(i=0)),c);var Ke=(i,c)=>()=>(c||i((c={exports:{}}).exports,c),c.exports),Et=(i,c)=>{for(var a in c)vt(i,a,{get:c[a],enumerable:!0})},Xr=(i,c,a,h)=>{if(c&&typeof c=="object"||typeof c=="function")for(let f of Vr(c))!Jr.call(i,f)&&f!==a&&vt(i,f,{get:()=>c[f],enumerable:!(h=qr(c,f))||h.enumerable});return i};var et=i=>Xr(vt({},"__esModule",{value:!0}),i);var St={};Et(St,{createReadStream:()=>lr,readFile:()=>Qr,readFileSync:()=>Zr});var Qr,Zr,lr,At=_t(()=>{Qr=void 0,Zr=void 0,lr=void 0});var Tt={};Et(Tt,{join:()=>Kr});var Kr,Mt=_t(()=>{Kr=void 0});var pr=Ke((dr,Ct)=>{"use strict";var cr=(()=>{var i=typeof document<"u"?document.currentScript?.src:void 0;return typeof __filename<"u"&&(i||=__filename),function(c={}){var a=c,h,f,w=new Promise((t,o)=>{h=t,f=o}),g=Object.assign({},a),s="./this.program",S=typeof window=="object",x=typeof importScripts=="function",H=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",A="",I,V,R;if(H){var B=(At(),et(St)),D=(Mt(),et(Tt));A=x?D.dirname(A)+"/":__dirname+"/",I=(t,o)=>(t=ce(t)?new URL(t):D.normalize(t),B.readFileSync(t,o?void 0:"utf8")),R=t=>(t=I(t,!0),t.buffer||(t=new Uint8Array(t)),t),V=(t,o,u,m=!0)=>{t=ce(t)?new URL(t):D.normalize(t),B.readFile(t,m?void 0:"utf8",(O,E)=>{O?u(O):o(m?E.buffer:E)})},!a.thisProgram&&1<process.argv.length&&(s=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2)}else(S||x)&&(x?A=self.location.href:typeof document<"u"&&document.currentScript&&(A=document.currentScript.src),i&&(A=i),A.startsWith("blob:")?A="":A=A.substr(0,A.replace(/[?#].*/,"").lastIndexOf("/")+1),I=t=>{var o=new XMLHttpRequest;return o.open("GET",t,!1),o.send(null),o.responseText},x&&(R=t=>{var o=new XMLHttpRequest;return o.open("GET",t,!1),o.responseType="arraybuffer",o.send(null),new Uint8Array(o.response)}),V=(t,o,u)=>{var m=new XMLHttpRequest;m.open("GET",t,!0),m.responseType="arraybuffer",m.onload=()=>{m.status==200||m.status==0&&m.response?o(m.response):u()},m.onerror=u,m.send(null)});var T=console.log.bind(console),L=console.error.bind(console);Object.assign(a,g),g=null;var W,de=!1,pe,Z,_,J,Pe;function le(){var t=W.buffer;a.HEAP8=pe=new Int8Array(t),a.HEAP16=new Int16Array(t),a.HEAPU8=Z=new Uint8Array(t),a.HEAPU16=new Uint16Array(t),a.HEAP32=_=new Int32Array(t),a.HEAPU32=J=new Uint32Array(t),a.HEAPF32=new Float32Array(t),a.HEAPF64=Pe=new Float64Array(t)}var Ie=[],ne=[],X=[],we=0,me=null,F=null;function ie(t){throw t="Aborted("+t+")",L(t),de=!0,t=new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info."),f(t),t}var xe=t=>t.startsWith("data:application/octet-stream;base64,"),ce=t=>t.startsWith("file://"),be;if(be="ort-wasm.wasm",!xe(be)){var ae=be;be=a.locateFile?a.locateFile(ae,A):A+ae}function K(t){if(R)return R(t);throw"both async and sync fetching of the wasm failed"}function je(t){if(S||x){if(typeof fetch=="function"&&!ce(t))return fetch(t,{credentials:"same-origin"}).then(o=>{if(!o.ok)throw`failed to load wasm binary file at \'${t}\'`;return o.arrayBuffer()}).catch(()=>K(t));if(V)return new Promise((o,u)=>{V(t,m=>o(new Uint8Array(m)),u)})}return Promise.resolve().then(()=>K(t))}function Oe(t,o,u){return je(t).then(m=>WebAssembly.instantiate(m,o)).then(u,m=>{L(`failed to asynchronously prepare wasm: ${m}`),ie(m)})}function Ue(t,o){var u=be;return typeof WebAssembly.instantiateStreaming!="function"||xe(u)||ce(u)||H||typeof fetch!="function"?Oe(u,t,o):fetch(u,{credentials:"same-origin"}).then(m=>WebAssembly.instantiateStreaming(m,t).then(o,function(O){return L(`wasm streaming compile failed: ${O}`),L("falling back to ArrayBuffer instantiation"),Oe(u,t,o)}))}var ve,Ae={798088:(t,o,u,m)=>{if(typeof a>"u"||!a.ya)return 1;if(t=ue(t>>>0),t.startsWith("./")&&(t=t.substring(2)),t=a.ya.get(t),!t)return 2;if(o>>>=0,u>>>=0,o+u>t.byteLength)return 3;try{return Z.set(t.subarray(o,o+u),m>>>0>>>0),0}catch{return 4}}};class _e{constructor(o){this.wa=o-24}}var ge=0,Be=0,te=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,re=(t,o,u)=>{o>>>=0;var m=o+u;for(u=o;t[u]&&!(u>=m);)++u;if(16<u-o&&t.buffer&&te)return te.decode(t.subarray(o,u));for(m="";o<u;){var O=t[o++];if(O&128){var E=t[o++]&63;if((O&224)==192)m+=String.fromCharCode((O&31)<<6|E);else{var U=t[o++]&63;O=(O&240)==224?(O&15)<<12|E<<6|U:(O&7)<<18|E<<12|U<<6|t[o++]&63,65536>O?m+=String.fromCharCode(O):(O-=65536,m+=String.fromCharCode(55296|O>>10,56320|O&1023))}}else m+=String.fromCharCode(O)}return m},ue=(t,o)=>(t>>>=0)?re(Z,t,o):"",Ee=t=>{for(var o=0,u=0;u<t.length;++u){var m=t.charCodeAt(u);127>=m?o++:2047>=m?o+=2:55296<=m&&57343>=m?(o+=4,++u):o+=3}return o},Se=(t,o,u,m)=>{if(u>>>=0,!(0<m))return 0;var O=u;m=u+m-1;for(var E=0;E<t.length;++E){var U=t.charCodeAt(E);if(55296<=U&&57343>=U){var ee=t.charCodeAt(++E);U=65536+((U&1023)<<10)|ee&1023}if(127>=U){if(u>=m)break;o[u++>>>0]=U}else{if(2047>=U){if(u+1>=m)break;o[u++>>>0]=192|U>>6}else{if(65535>=U){if(u+2>=m)break;o[u++>>>0]=224|U>>12}else{if(u+3>=m)break;o[u++>>>0]=240|U>>18,o[u++>>>0]=128|U>>12&63}o[u++>>>0]=128|U>>6&63}o[u++>>>0]=128|U&63}}return o[u>>>0]=0,u-O},Le=t=>t%4===0&&(t%100!==0||t%400===0),ze=[0,31,60,91,121,152,182,213,244,274,305,335],rt=[0,31,59,90,120,151,181,212,243,273,304,334],Te=[],Ge={},ke=()=>{if(!We){var t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:s||"./this.program"},o;for(o in Ge)Ge[o]===void 0?delete t[o]:t[o]=Ge[o];var u=[];for(o in t)u.push(`${o}=${t[o]}`);We=u}return We},We,nt=[null,[],[]],De=[31,29,31,30,31,30,31,31,30,31,30,31],at=[31,28,31,30,31,30,31,31,30,31,30,31];function G(t){var o=Array(Ee(t)+1);return Se(t,o,0,o.length),o}function qe(t,o,u,m){function O(d,k,$){for(d=typeof d=="number"?d.toString():d||"";d.length<k;)d=$[0]+d;return d}function E(d,k){return O(d,k,"0")}function U(d,k){function $(Ze){return 0>Ze?-1:0<Ze?1:0}var Me;return(Me=$(d.getFullYear()-k.getFullYear()))===0&&(Me=$(d.getMonth()-k.getMonth()))===0&&(Me=$(d.getDate()-k.getDate())),Me}function ee(d){switch(d.getDay()){case 0:return new Date(d.getFullYear()-1,11,29);case 1:return d;case 2:return new Date(d.getFullYear(),0,3);case 3:return new Date(d.getFullYear(),0,2);case 4:return new Date(d.getFullYear(),0,1);case 5:return new Date(d.getFullYear()-1,11,31);case 6:return new Date(d.getFullYear()-1,11,30)}}function ye(d){var k=d.sa;for(d=new Date(new Date(d.ta+1900,0,1).getTime());0<k;){var $=d.getMonth(),Me=(Le(d.getFullYear())?De:at)[$];if(k>Me-d.getDate())k-=Me-d.getDate()+1,d.setDate(1),11>$?d.setMonth($+1):(d.setMonth(0),d.setFullYear(d.getFullYear()+1));else{d.setDate(d.getDate()+k);break}}return $=new Date(d.getFullYear()+1,0,4),k=ee(new Date(d.getFullYear(),0,4)),$=ee($),0>=U(k,d)?0>=U($,d)?d.getFullYear()+1:d.getFullYear():d.getFullYear()-1}t>>>=0,o>>>=0,u>>>=0,m>>>=0;var oe=J[m+40>>>2>>>0];m={Ba:_[m>>>2>>>0],Aa:_[m+4>>>2>>>0],ua:_[m+8>>>2>>>0],xa:_[m+12>>>2>>>0],va:_[m+16>>>2>>>0],ta:_[m+20>>>2>>>0],na:_[m+24>>>2>>>0],sa:_[m+28>>>2>>>0],Da:_[m+32>>>2>>>0],za:_[m+36>>>2>>>0],Ca:oe?ue(oe):""},u=ue(u),oe={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var se in oe)u=u.replace(new RegExp(se,"g"),oe[se]);var Qe="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Re="January February March April May June July August September October November December".split(" ");oe={"%a":d=>Qe[d.na].substring(0,3),"%A":d=>Qe[d.na],"%b":d=>Re[d.va].substring(0,3),"%B":d=>Re[d.va],"%C":d=>E((d.ta+1900)/100|0,2),"%d":d=>E(d.xa,2),"%e":d=>O(d.xa,2," "),"%g":d=>ye(d).toString().substring(2),"%G":ye,"%H":d=>E(d.ua,2),"%I":d=>(d=d.ua,d==0?d=12:12<d&&(d-=12),E(d,2)),"%j":d=>{for(var k=0,$=0;$<=d.va-1;k+=(Le(d.ta+1900)?De:at)[$++]);return E(d.xa+k,3)},"%m":d=>E(d.va+1,2),"%M":d=>E(d.Aa,2),"%n":()=>`\n`,"%p":d=>0<=d.ua&&12>d.ua?"AM":"PM","%S":d=>E(d.Ba,2),"%t":()=>"	","%u":d=>d.na||7,"%U":d=>E(Math.floor((d.sa+7-d.na)/7),2),"%V":d=>{var k=Math.floor((d.sa+7-(d.na+6)%7)/7);if(2>=(d.na+371-d.sa-2)%7&&k++,k)k==53&&($=(d.na+371-d.sa)%7,$==4||$==3&&Le(d.ta)||(k=1));else{k=52;var $=(d.na+7-d.sa-1)%7;($==4||$==5&&Le(d.ta%400-1))&&k++}return E(k,2)},"%w":d=>d.na,"%W":d=>E(Math.floor((d.sa+7-(d.na+6)%7)/7),2),"%y":d=>(d.ta+1900).toString().substring(2),"%Y":d=>d.ta+1900,"%z":d=>{d=d.za;var k=0<=d;return d=Math.abs(d)/60,(k?"+":"-")+("0000"+(d/60*100+d%60)).slice(-4)},"%Z":d=>d.Ca,"%%":()=>"%"},u=u.replace(/%%/g,"\\0\\0");for(se in oe)u.includes(se)&&(u=u.replace(new RegExp(se,"g"),oe[se](m)));return u=u.replace(/\\0\\0/g,"%"),se=G(u),se.length>o?0:(pe.set(se,t>>>0),se.length-1)}var Ve={a:function(t,o,u){t>>>=0;var m=new _e(t);throw J[m.wa+16>>>2>>>0]=0,J[m.wa+4>>>2>>>0]=o>>>0,J[m.wa+8>>>2>>>0]=u>>>0,ge=t,Be++,ge},e:function(){return 0},H:function(){},x:function(){},z:function(){},J:function(){return 0},F:function(){},A:function(){},E:function(){},g:function(){},y:function(){},v:function(){},G:function(){},w:function(){},k:()=>1,I:function(t,o,u){return o>>>=0,Z.copyWithin(t>>>0>>>0,o>>>0,o+(u>>>0)>>>0)},n:function(t,o,u){t=o+2097152>>>0<4194305-!!t?(t>>>0)+4294967296*o:NaN,u>>>=0,t=new Date(1e3*t),_[u>>>2>>>0]=t.getUTCSeconds(),_[u+4>>>2>>>0]=t.getUTCMinutes(),_[u+8>>>2>>>0]=t.getUTCHours(),_[u+12>>>2>>>0]=t.getUTCDate(),_[u+16>>>2>>>0]=t.getUTCMonth(),_[u+20>>>2>>>0]=t.getUTCFullYear()-1900,_[u+24>>>2>>>0]=t.getUTCDay(),_[u+28>>>2>>>0]=(t.getTime()-Date.UTC(t.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},o:function(t,o,u){t=o+2097152>>>0<4194305-!!t?(t>>>0)+4294967296*o:NaN,u>>>=0,t=new Date(1e3*t),_[u>>>2>>>0]=t.getSeconds(),_[u+4>>>2>>>0]=t.getMinutes(),_[u+8>>>2>>>0]=t.getHours(),_[u+12>>>2>>>0]=t.getDate(),_[u+16>>>2>>>0]=t.getMonth(),_[u+20>>>2>>>0]=t.getFullYear()-1900,_[u+24>>>2>>>0]=t.getDay(),_[u+28>>>2>>>0]=(Le(t.getFullYear())?ze:rt)[t.getMonth()]+t.getDate()-1|0,_[u+36>>>2>>>0]=-(60*t.getTimezoneOffset()),o=new Date(t.getFullYear(),6,1).getTimezoneOffset();var m=new Date(t.getFullYear(),0,1).getTimezoneOffset();_[u+32>>>2>>>0]=(o!=m&&t.getTimezoneOffset()==Math.min(m,o))|0},p:function(t){t>>>=0;var o=new Date(_[t+20>>>2>>>0]+1900,_[t+16>>>2>>>0],_[t+12>>>2>>>0],_[t+8>>>2>>>0],_[t+4>>>2>>>0],_[t>>>2>>>0],0),u=_[t+32>>>2>>>0],m=o.getTimezoneOffset(),O=new Date(o.getFullYear(),6,1).getTimezoneOffset(),E=new Date(o.getFullYear(),0,1).getTimezoneOffset(),U=Math.min(E,O);return 0>u?_[t+32>>>2>>>0]=+(O!=E&&U==m):0<u!=(U==m)&&(O=Math.max(E,O),o.setTime(o.getTime()+6e4*((0<u?U:O)-m))),_[t+24>>>2>>>0]=o.getDay(),_[t+28>>>2>>>0]=(Le(o.getFullYear())?ze:rt)[o.getMonth()]+o.getDate()-1|0,_[t>>>2>>>0]=o.getSeconds(),_[t+4>>>2>>>0]=o.getMinutes(),_[t+8>>>2>>>0]=o.getHours(),_[t+12>>>2>>>0]=o.getDate(),_[t+16>>>2>>>0]=o.getMonth(),_[t+20>>>2>>>0]=o.getYear(),t=o.getTime(),t=isNaN(t)?-1:t/1e3,Je((ve=t,1<=+Math.abs(ve)?0<ve?+Math.floor(ve/4294967296)>>>0:~~+Math.ceil((ve-+(~~ve>>>0))/4294967296)>>>0:0)),t>>>0},l:function(){return-52},m:function(){},t:function(t,o,u,m){u>>>=0,m>>>=0;var O=new Date().getFullYear(),E=new Date(O,0,1),U=new Date(O,6,1);O=E.getTimezoneOffset();var ee=U.getTimezoneOffset();J[t>>>0>>>2>>>0]=60*Math.max(O,ee),_[o>>>0>>>2>>>0]=+(O!=ee),t=ye=>ye.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1],E=t(E),U=t(U),ee<O?(Se(E,Z,u,17),Se(U,Z,m,17)):(Se(E,Z,m,17),Se(U,Z,u,17))},d:()=>{ie("")},B:function(t,o,u){t>>>=0,o>>>=0,u>>>=0,Te.length=0;for(var m;m=Z[o++>>>0];){var O=m!=105;O&=m!=112,u+=O&&u%8?4:0,Te.push(m==112?J[u>>>2>>>0]:m==105?_[u>>>2>>>0]:Pe[u>>>3>>>0]),u+=O?8:4}return Ae[t](...Te)},h:()=>Date.now(),u:function(){return 4294901760},b:()=>performance.now(),s:function(t){t>>>=0;var o=Z.length;if(4294901760<t)return!1;for(var u=1;4>=u;u*=2){var m=o*(1+.2/u);m=Math.min(m,t+100663296);var O=Math;m=Math.max(t,m);e:{O=(O.min.call(O,4294901760,m+(65536-m%65536)%65536)-W.buffer.byteLength+65535)/65536;try{W.grow(O),le();var E=1;break e}catch{}E=void 0}if(E)return!0}return!1},C:function(t,o){t>>>=0,o>>>=0;var u=0;return ke().forEach((m,O)=>{var E=o+u;for(O=J[t+4*O>>>2>>>0]=E,E=0;E<m.length;++E)pe[O++>>>0]=m.charCodeAt(E);pe[O>>>0]=0,u+=m.length+1}),0},D:function(t,o){t>>>=0,o>>>=0;var u=ke();J[t>>>2>>>0]=u.length;var m=0;return u.forEach(O=>m+=O.length+1),J[o>>>2>>>0]=m,0},f:()=>52,j:function(){return 52},q:function(){return 70},i:function(t,o,u,m){o>>>=0,u>>>=0,m>>>=0;for(var O=0,E=0;E<u;E++){var U=J[o>>>2>>>0],ee=J[o+4>>>2>>>0];o+=8;for(var ye=0;ye<ee;ye++){var oe=Z[U+ye>>>0],se=nt[t];oe===0||oe===10?((t===1?T:L)(re(se,0)),se.length=0):se.push(oe)}O+=ee}return J[m>>>2>>>0]=O,0},r:qe,c:function(t,o,u,m){return qe(t>>>0,o>>>0,u>>>0,m>>>0)}},P=function(){function t(u){return P=u.exports,P=st(),W=P.K,le(),ne.unshift(P.L),we--,we==0&&(me!==null&&(clearInterval(me),me=null),F&&(u=F,F=null,u())),P}var o={a:Ve};if(we++,a.instantiateWasm)try{return a.instantiateWasm(o,t)}catch(u){L(`Module.instantiateWasm callback failed with error: ${u}`),f(u)}return Ue(o,function(u){t(u.instance)}).catch(f),{}}();a._OrtInit=(t,o)=>(a._OrtInit=P.M)(t,o),a._OrtGetLastError=(t,o)=>(a._OrtGetLastError=P.N)(t,o),a._OrtCreateSessionOptions=(t,o,u,m,O,E,U,ee,ye,oe)=>(a._OrtCreateSessionOptions=P.O)(t,o,u,m,O,E,U,ee,ye,oe),a._OrtAppendExecutionProvider=(t,o)=>(a._OrtAppendExecutionProvider=P.P)(t,o),a._OrtAddFreeDimensionOverride=(t,o,u)=>(a._OrtAddFreeDimensionOverride=P.Q)(t,o,u),a._OrtAddSessionConfigEntry=(t,o,u)=>(a._OrtAddSessionConfigEntry=P.R)(t,o,u),a._OrtReleaseSessionOptions=t=>(a._OrtReleaseSessionOptions=P.S)(t),a._OrtCreateSession=(t,o,u)=>(a._OrtCreateSession=P.T)(t,o,u),a._OrtReleaseSession=t=>(a._OrtReleaseSession=P.U)(t),a._OrtGetInputOutputCount=(t,o,u)=>(a._OrtGetInputOutputCount=P.V)(t,o,u),a._OrtGetInputName=(t,o)=>(a._OrtGetInputName=P.W)(t,o),a._OrtGetOutputName=(t,o)=>(a._OrtGetOutputName=P.X)(t,o),a._OrtFree=t=>(a._OrtFree=P.Y)(t),a._OrtCreateTensor=(t,o,u,m,O,E)=>(a._OrtCreateTensor=P.Z)(t,o,u,m,O,E),a._OrtGetTensorData=(t,o,u,m,O)=>(a._OrtGetTensorData=P._)(t,o,u,m,O),a._OrtReleaseTensor=t=>(a._OrtReleaseTensor=P.$)(t),a._OrtCreateRunOptions=(t,o,u,m)=>(a._OrtCreateRunOptions=P.aa)(t,o,u,m),a._OrtAddRunConfigEntry=(t,o,u)=>(a._OrtAddRunConfigEntry=P.ba)(t,o,u),a._OrtReleaseRunOptions=t=>(a._OrtReleaseRunOptions=P.ca)(t),a._OrtCreateBinding=t=>(a._OrtCreateBinding=P.da)(t),a._OrtBindInput=(t,o,u)=>(a._OrtBindInput=P.ea)(t,o,u),a._OrtBindOutput=(t,o,u,m)=>(a._OrtBindOutput=P.fa)(t,o,u,m),a._OrtClearBoundOutputs=t=>(a._OrtClearBoundOutputs=P.ga)(t),a._OrtReleaseBinding=t=>(a._OrtReleaseBinding=P.ha)(t),a._OrtRunWithBinding=(t,o,u,m,O)=>(a._OrtRunWithBinding=P.ia)(t,o,u,m,O),a._OrtRun=(t,o,u,m,O,E,U,ee)=>(a._OrtRun=P.ja)(t,o,u,m,O,E,U,ee),a._OrtEndProfiling=t=>(a._OrtEndProfiling=P.ka)(t),a._malloc=t=>(a._malloc=P.la)(t),a._free=t=>(a._free=P.ma)(t);var Je=t=>(Je=P.oa)(t),ot=t=>(ot=P.pa)(t),M=t=>(M=P.qa)(t),Ne=()=>(Ne=P.ra)();function st(){var t=P;t=Object.assign({},t);var o=u=>m=>u(m)>>>0;return t.la=o(t.la),t.qa=o(t.qa),t.ra=(u=>()=>u()>>>0)(t.ra),t}a.stackSave=()=>Ne(),a.stackRestore=t=>ot(t),a.stackAlloc=t=>M(t),a.UTF8ToString=ue,a.stringToUTF8=(t,o,u)=>Se(t,Z,o,u),a.lengthBytesUTF8=Ee;var Fe;F=function t(){Fe||Xe(),Fe||(F=t)};function Xe(){if(!(0<we)){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;){var t=a.preRun.shift();Ie.unshift(t)}for(;0<Ie.length;)Ie.shift()(a);if(!(0<we||Fe||(Fe=!0,a.calledRun=!0,de))){for(;0<ne.length;)ne.shift()(a);for(h(a);0<X.length;)X.shift()(a)}}}return Xe(),w}})();typeof dr=="object"&&typeof Ct=="object"?Ct.exports=cr:typeof define=="function"&&define.amd&&define([],()=>cr)});var mr=Ke(()=>{});var gr=Ke(()=>{});var hr={};Et(hr,{cpus:()=>en});var en,br=_t(()=>{en=void 0});var Or=Ke((wr,Dt)=>{"use strict";var yr=(()=>{var i=typeof document<"u"?document.currentScript?.src:void 0;return typeof __filename<"u"&&(i||=__filename),function(c={}){function a(){return X.buffer!=ie.buffer&&K(),ie}function h(){return X.buffer!=ie.buffer&&K(),xe}function f(){return X.buffer!=ie.buffer&&K(),ce}function w(){return X.buffer!=ie.buffer&&K(),be}function g(){return X.buffer!=ie.buffer&&K(),ae}var s=c,S,x,H=new Promise((e,r)=>{S=e,x=r}),A=Object.assign({},s),I="./this.program",V=(e,r)=>{throw r},R=typeof window=="object",B=typeof importScripts=="function",D=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",T=s.ENVIRONMENT_IS_PTHREAD||!1,L="";function W(e){return s.locateFile?s.locateFile(e,L):L+e}var de,pe,Z;if(D){var _=(At(),et(St)),J=(Mt(),et(Tt));L=B?J.dirname(L)+"/":__dirname+"/",de=(e,r)=>(e=ue(e)?new URL(e):J.normalize(e),_.readFileSync(e,r?void 0:"utf8")),Z=e=>(e=de(e,!0),e.buffer||(e=new Uint8Array(e)),e),pe=(e,r,n,l=!0)=>{e=ue(e)?new URL(e):J.normalize(e),_.readFile(e,l?void 0:"utf8",(y,b)=>{y?n(y):r(l?b.buffer:b)})},!s.thisProgram&&1<process.argv.length&&(I=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),V=(e,r)=>{throw process.exitCode=e,r},global.Worker=mr().Worker}else(R||B)&&(B?L=self.location.href:typeof document<"u"&&document.currentScript&&(L=document.currentScript.src),typeof i<"u"&&i&&(L=i),L.startsWith("blob:")?L="":L=L.substr(0,L.replace(/[?#].*/,"").lastIndexOf("/")+1),D||(de=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.send(null),r.responseText},B&&(Z=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),pe=(e,r,n)=>{var l=new XMLHttpRequest;l.open("GET",e,!0),l.responseType="arraybuffer",l.onload=()=>{l.status==200||l.status==0&&l.response?r(l.response):n()},l.onerror=n,l.send(null)}));D&&typeof performance>"u"&&(global.performance=gr().performance);var Pe=console.log.bind(console),le=console.error.bind(console);D&&(Pe=(...e)=>_.writeSync(1,e.join(" ")+`\n`),le=(...e)=>_.writeSync(2,e.join(" ")+`\n`));var Ie=Pe,ne=le;Object.assign(s,A),A=null;var X,we,me=!1,F,ie,xe,ce,be,ae;function K(){var e=X.buffer;s.HEAP8=ie=new Int8Array(e),s.HEAP16=new Int16Array(e),s.HEAPU8=xe=new Uint8Array(e),s.HEAPU16=new Uint16Array(e),s.HEAP32=ce=new Int32Array(e),s.HEAPU32=be=new Uint32Array(e),s.HEAPF32=new Float32Array(e),s.HEAPF64=ae=new Float64Array(e)}var je=16777216;if(T)X=s.wasmMemory;else if(s.wasmMemory)X=s.wasmMemory;else if(X=new WebAssembly.Memory({initial:je/65536,maximum:65536,shared:!0}),!(X.buffer instanceof SharedArrayBuffer))throw ne("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),D&&ne("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");K(),je=X.buffer.byteLength;var Oe=[],Ue=[],ve=[],Ae=0,_e=null,ge=null;function Be(){if(Ae--,Ae==0&&(_e!==null&&(clearInterval(_e),_e=null),ge)){var e=ge;ge=null,e()}}function te(e){throw e="Aborted("+e+")",ne(e),me=!0,F=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),x(e),e}var re=e=>e.startsWith("data:application/octet-stream;base64,"),ue=e=>e.startsWith("file://"),Ee;Ee="ort-wasm-threaded.wasm",re(Ee)||(Ee=W(Ee));function Se(e){if(Z)return Z(e);throw"both async and sync fetching of the wasm failed"}function Le(e){if(R||B){if(typeof fetch=="function"&&!ue(e))return fetch(e,{credentials:"same-origin"}).then(r=>{if(!r.ok)throw`failed to load wasm binary file at \'${e}\'`;return r.arrayBuffer()}).catch(()=>Se(e));if(pe)return new Promise((r,n)=>{pe(e,l=>r(new Uint8Array(l)),n)})}return Promise.resolve().then(()=>Se(e))}function ze(e,r,n){return Le(e).then(l=>WebAssembly.instantiate(l,r)).then(n,l=>{ne(`failed to asynchronously prepare wasm: ${l}`),te(l)})}function rt(e,r){var n=Ee;return typeof WebAssembly.instantiateStreaming!="function"||re(n)||ue(n)||D||typeof fetch!="function"?ze(n,e,r):fetch(n,{credentials:"same-origin"}).then(l=>WebAssembly.instantiateStreaming(l,e).then(r,function(y){return ne(`wasm streaming compile failed: ${y}`),ne("falling back to ArrayBuffer instantiation"),ze(n,e,r)}))}var Te,Ge={799444:(e,r,n,l)=>{if(typeof s>"u"||!s.bb)return 1;if(e=ee(e>>>0),e.startsWith("./")&&(e=e.substring(2)),e=s.bb.get(e),!e)return 2;if(r>>>=0,n>>>=0,l>>>=0,r+n>e.byteLength)return 3;try{return h().set(e.subarray(r,r+n),l>>>0),0}catch{return 4}}};function ke(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}var We=e=>{e.terminate(),e.onmessage=()=>{}},nt=e=>{M.Oa.length==0&&(Je(),M.Xa(M.Oa[0]));var r=M.Oa.pop();if(!r)return 6;M.Pa.push(r),M.La[e.Na]=r,r.Na=e.Na;var n={cmd:"run",start_routine:e.gb,arg:e.cb,pthread_ptr:e.Na};return D&&r.unref(),r.postMessage(n,e.mb),0},De=0,at=e=>{var r=Ot();return e=e(),ft(r),e},G=(e,r,...n)=>at(()=>{for(var l=n.length,y=wt(8*l),b=y>>>3,v=0;v<n.length;v++){var z=n[v];g()[b+v>>>0]=z}return rr(e,0,l,y,r)});function qe(e){if(T)return G(0,1,e);F=e,0<De||(M.hb(),s.onExit?.(e),me=!0),V(e,new ke(e))}var Ve=e=>{if(F=e,T)throw st(e),"unwind";qe(e)};function P(){for(var e=s.numThreads;e--;)Je();Oe.unshift(()=>{Ae++,ot(()=>Be())})}function Je(){var e=W("ort-wasm-threaded.worker.js");e=new Worker(e),M.Oa.push(e)}function ot(e){T?e():Promise.all(M.Oa.map(M.Xa)).then(e)}var M={Oa:[],Pa:[],ab:[],La:{},Va(){T?(M.receiveObjectTransfer=M.fb,M.threadInitTLS=M.$a,M.setExitStatus=M.Za):P()},Za:e=>F=e,pb:["$terminateWorker"],hb:()=>{for(var e of M.Pa)We(e);for(e of M.Oa)We(e);M.Oa=[],M.Pa=[],M.La=[]},Ya:e=>{var r=e.Na;delete M.La[r],M.Oa.push(e),M.Pa.splice(M.Pa.indexOf(e),1),e.Na=0,bt(r)},fb(){},$a(){M.ab.forEach(e=>e())},Xa:e=>new Promise(r=>{e.onmessage=b=>{b=b.data;var v=b.cmd;if(b.targetThread&&b.targetThread!=ut()){var z=M.La[b.targetThread];z?z.postMessage(b,b.transferList):ne(`Internal error! Worker sent a message "${v}" to target pthread ${b.targetThread}, but that thread no longer exists!`)}else v==="checkMailbox"?it():v==="spawnThread"?nt(b):v==="cleanupThread"?M.Ya(M.La[b.thread]):v==="killThread"?(b=b.thread,v=M.La[b],delete M.La[b],We(v),bt(b),M.Pa.splice(M.Pa.indexOf(v),1),v.Na=0):v==="cancelThread"?M.La[b.thread].postMessage({cmd:"cancel"}):v==="loaded"?(e.loaded=!0,D&&!e.Na&&e.unref(),r(e)):v==="alert"?alert(`Thread ${b.threadId}: ${b.text}`):b.target==="setimmediate"?e.postMessage(b):v==="callHandler"?s[b.handler](...b.args):v&&ne(`worker sent an unknown command ${v}`)},e.onerror=b=>{throw ne(`worker sent an error! ${b.filename}:${b.lineno}: ${b.message}`),b},D&&(e.on("message",b=>e.onmessage({data:b})),e.on("error",b=>e.onerror(b)));var n=[],l=["onExit"],y;for(y of l)s.hasOwnProperty(y)&&n.push(y);e.postMessage({cmd:"load",handlers:n,urlOrBlob:s.mainScriptUrlOrBlob||i,wasmMemory:X,wasmModule:we})})};s.PThread=M;var Ne=e=>{for(;0<e.length;)e.shift()(s)};s.establishStackSpace=()=>{var e=ut(),r=w()[e+52>>>2>>>0];e=w()[e+56>>>2>>>0],or(r,r-e),ft(r)};function st(e){if(T)return G(1,0,e);Ve(e)}var Fe=[],Xe;s.invokeEntryPoint=(e,r)=>{De=0;var n=Fe[e];n||(e>=Fe.length&&(Fe.length=e+1),Fe[e]=n=Xe.get(e)),e=n(r),0<De?M.Za(e):yt(e)};class t{constructor(r){this.Ua=r-24}Va(r,n){w()[this.Ua+16>>>2>>>0]=0,w()[this.Ua+4>>>2>>>0]=r,w()[this.Ua+8>>>2>>>0]=n}}var o=0,u=0;function m(e,r,n,l){return T?G(2,1,e,r,n,l):O(e,r,n,l)}function O(e,r,n,l){if(e>>>=0,r>>>=0,n>>>=0,l>>>=0,typeof SharedArrayBuffer>"u")return ne("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var y=[];return T&&y.length===0?m(e,r,n,l):(e={gb:n,Na:e,cb:l,mb:y},T?(e.ob="spawnThread",postMessage(e,y),0):nt(e))}var E=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,U=(e,r,n)=>{r>>>=0;var l=r+n;for(n=r;e[n]&&!(n>=l);)++n;if(16<n-r&&e.buffer&&E)return E.decode(e.buffer instanceof SharedArrayBuffer?e.slice(r,n):e.subarray(r,n));for(l="";r<n;){var y=e[r++];if(y&128){var b=e[r++]&63;if((y&224)==192)l+=String.fromCharCode((y&31)<<6|b);else{var v=e[r++]&63;y=(y&240)==224?(y&15)<<12|b<<6|v:(y&7)<<18|b<<12|v<<6|e[r++]&63,65536>y?l+=String.fromCharCode(y):(y-=65536,l+=String.fromCharCode(55296|y>>10,56320|y&1023))}}else l+=String.fromCharCode(y)}return l},ee=(e,r)=>(e>>>=0)?U(h(),e,r):"";function ye(e,r,n){return T?G(3,1,e,r,n):0}function oe(e,r){if(T)return G(4,1,e,r)}var se=e=>{for(var r=0,n=0;n<e.length;++n){var l=e.charCodeAt(n);127>=l?r++:2047>=l?r+=2:55296<=l&&57343>=l?(r+=4,++n):r+=3}return r},Qe=(e,r,n,l)=>{if(n>>>=0,!(0<l))return 0;var y=n;l=n+l-1;for(var b=0;b<e.length;++b){var v=e.charCodeAt(b);if(55296<=v&&57343>=v){var z=e.charCodeAt(++b);v=65536+((v&1023)<<10)|z&1023}if(127>=v){if(n>=l)break;r[n++>>>0]=v}else{if(2047>=v){if(n+1>=l)break;r[n++>>>0]=192|v>>6}else{if(65535>=v){if(n+2>=l)break;r[n++>>>0]=224|v>>12}else{if(n+3>=l)break;r[n++>>>0]=240|v>>18,r[n++>>>0]=128|v>>12&63}r[n++>>>0]=128|v>>6&63}r[n++>>>0]=128|v&63}}return r[n>>>0]=0,n-y},Re=(e,r,n)=>Qe(e,h(),r,n);function d(e,r){if(T)return G(5,1,e,r)}function k(e,r,n){if(T)return G(6,1,e,r,n)}function $(e,r,n){return T?G(7,1,e,r,n):0}function Me(e,r){if(T)return G(8,1,e,r)}function Ze(e,r,n){if(T)return G(9,1,e,r,n)}function Rt(e,r,n,l){if(T)return G(10,1,e,r,n,l)}function It(e,r,n,l){if(T)return G(11,1,e,r,n,l)}function Bt(e,r,n,l){if(T)return G(12,1,e,r,n,l)}function kt(e){if(T)return G(13,1,e)}function Wt(e,r){if(T)return G(14,1,e,r)}function Nt(e,r,n){if(T)return G(15,1,e,r,n)}function dt(e){e>>>=0,typeof Atomics.nb=="function"&&(Atomics.nb(f(),e>>>2,e).value.then(it),e+=128,Atomics.store(f(),e>>>2,1))}s.__emscripten_thread_mailbox_await=dt;var it=()=>{var e=ut();if(e&&(dt(e),e=nr,!me))try{if(e(),!(0<De))try{T?yt(F):Ve(F)}catch(r){r instanceof ke||r=="unwind"||V(1,r)}}catch(r){r instanceof ke||r=="unwind"||V(1,r)}};s.checkMailbox=it;var pt=[],$e=e=>e%4===0&&(e%100!==0||e%400===0),Ht=[0,31,60,91,121,152,182,213,244,274,305,335],Gt=[0,31,59,90,120,151,181,212,243,273,304,334];function $t(e,r,n,l,y,b,v,z){return T?G(16,1,e,r,n,l,y,b,v,z):-52}function Yt(e,r,n,l,y,b,v){if(T)return G(17,1,e,r,n,l,y,b,v)}var mt=[],gt={},jt=()=>{if(!ht){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:I||"./this.program"},r;for(r in gt)gt[r]===void 0?delete e[r]:e[r]=gt[r];var n=[];for(r in e)n.push(`${r}=${e[r]}`);ht=n}return ht},ht;function zt(e,r){if(T)return G(18,1,e,r);e>>>=0,r>>>=0;var n=0;return jt().forEach((l,y)=>{var b=r+n;for(y=w()[e+4*y>>>2>>>0]=b,b=0;b<l.length;++b)a()[y++>>>0]=l.charCodeAt(b);a()[y>>>0]=0,n+=l.length+1}),0}function qt(e,r){if(T)return G(19,1,e,r);e>>>=0,r>>>=0;var n=jt();w()[e>>>2>>>0]=n.length;var l=0;return n.forEach(y=>l+=y.length+1),w()[r>>>2>>>0]=l,0}function Vt(e){return T?G(20,1,e):52}function Jt(e,r,n,l){return T?G(21,1,e,r,n,l):52}function Xt(e,r,n,l,y){return T?G(22,1,e,r,n,l,y):70}var Hr=[null,[],[]];function Qt(e,r,n,l){if(T)return G(23,1,e,r,n,l);r>>>=0,n>>>=0,l>>>=0;for(var y=0,b=0;b<n;b++){var v=w()[r>>>2>>>0],z=w()[r+4>>>2>>>0];r+=8;for(var Ce=0;Ce<z;Ce++){var fe=h()[v+Ce>>>0],he=Hr[e];fe===0||fe===10?((e===1?Ie:ne)(U(he,0)),he.length=0):he.push(fe)}y+=z}return w()[l>>>2>>>0]=y,0}var Zt=[31,29,31,30,31,30,31,31,30,31,30,31],Kt=[31,28,31,30,31,30,31,31,30,31,30,31];function Gr(e){var r=Array(se(e)+1);return Qe(e,r,0,r.length),r}var $r=(e,r)=>{a().set(e,r>>>0)};function er(e,r,n,l){function y(p,N,q){for(p=typeof p=="number"?p.toString():p||"";p.length<N;)p=q[0]+p;return p}function b(p,N){return y(p,N,"0")}function v(p,N){function q(fr){return 0>fr?-1:0<fr?1:0}var He;return(He=q(p.getFullYear()-N.getFullYear()))===0&&(He=q(p.getMonth()-N.getMonth()))===0&&(He=q(p.getDate()-N.getDate())),He}function z(p){switch(p.getDay()){case 0:return new Date(p.getFullYear()-1,11,29);case 1:return p;case 2:return new Date(p.getFullYear(),0,3);case 3:return new Date(p.getFullYear(),0,2);case 4:return new Date(p.getFullYear(),0,1);case 5:return new Date(p.getFullYear()-1,11,31);case 6:return new Date(p.getFullYear()-1,11,30)}}function Ce(p){var N=p.Qa;for(p=new Date(new Date(p.Ra+1900,0,1).getTime());0<N;){var q=p.getMonth(),He=($e(p.getFullYear())?Zt:Kt)[q];if(N>He-p.getDate())N-=He-p.getDate()+1,p.setDate(1),11>q?p.setMonth(q+1):(p.setMonth(0),p.setFullYear(p.getFullYear()+1));else{p.setDate(p.getDate()+N);break}}return q=new Date(p.getFullYear()+1,0,4),N=z(new Date(p.getFullYear(),0,4)),q=z(q),0>=v(N,p)?0>=v(q,p)?p.getFullYear()+1:p.getFullYear():p.getFullYear()-1}e>>>=0,r>>>=0,n>>>=0,l>>>=0;var fe=w()[l+40>>>2>>>0];l={kb:f()[l>>>2>>>0],jb:f()[l+4>>>2>>>0],Sa:f()[l+8>>>2>>>0],Wa:f()[l+12>>>2>>>0],Ta:f()[l+16>>>2>>>0],Ra:f()[l+20>>>2>>>0],Ma:f()[l+24>>>2>>>0],Qa:f()[l+28>>>2>>>0],qb:f()[l+32>>>2>>>0],ib:f()[l+36>>>2>>>0],lb:fe?ee(fe):""},n=ee(n),fe={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var he in fe)n=n.replace(new RegExp(he,"g"),fe[he]);var ir="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ur="January February March April May June July August September October November December".split(" ");fe={"%a":p=>ir[p.Ma].substring(0,3),"%A":p=>ir[p.Ma],"%b":p=>ur[p.Ta].substring(0,3),"%B":p=>ur[p.Ta],"%C":p=>b((p.Ra+1900)/100|0,2),"%d":p=>b(p.Wa,2),"%e":p=>y(p.Wa,2," "),"%g":p=>Ce(p).toString().substring(2),"%G":Ce,"%H":p=>b(p.Sa,2),"%I":p=>(p=p.Sa,p==0?p=12:12<p&&(p-=12),b(p,2)),"%j":p=>{for(var N=0,q=0;q<=p.Ta-1;N+=($e(p.Ra+1900)?Zt:Kt)[q++]);return b(p.Wa+N,3)},"%m":p=>b(p.Ta+1,2),"%M":p=>b(p.jb,2),"%n":()=>`\n`,"%p":p=>0<=p.Sa&&12>p.Sa?"AM":"PM","%S":p=>b(p.kb,2),"%t":()=>"	","%u":p=>p.Ma||7,"%U":p=>b(Math.floor((p.Qa+7-p.Ma)/7),2),"%V":p=>{var N=Math.floor((p.Qa+7-(p.Ma+6)%7)/7);if(2>=(p.Ma+371-p.Qa-2)%7&&N++,N)N==53&&(q=(p.Ma+371-p.Qa)%7,q==4||q==3&&$e(p.Ra)||(N=1));else{N=52;var q=(p.Ma+7-p.Qa-1)%7;(q==4||q==5&&$e(p.Ra%400-1))&&N++}return b(N,2)},"%w":p=>p.Ma,"%W":p=>b(Math.floor((p.Qa+7-(p.Ma+6)%7)/7),2),"%y":p=>(p.Ra+1900).toString().substring(2),"%Y":p=>p.Ra+1900,"%z":p=>{p=p.ib;var N=0<=p;return p=Math.abs(p)/60,(N?"+":"-")+("0000"+(p/60*100+p%60)).slice(-4)},"%Z":p=>p.lb,"%%":()=>"%"},n=n.replace(/%%/g,"\\0\\0");for(he in fe)n.includes(he)&&(n=n.replace(new RegExp(he,"g"),fe[he](l)));return n=n.replace(/\\0\\0/g,"%"),he=Gr(n),he.length>r?0:($r(he,e),he.length-1)}M.Va();var Yr=[qe,st,m,ye,oe,d,k,$,Me,Ze,Rt,It,Bt,kt,Wt,Nt,$t,Yt,zt,qt,Vt,Jt,Xt,Qt],jr={b:function(e,r,n){throw e>>>=0,new t(e).Va(r>>>0,n>>>0),o=e,u++,o},L:function(e){tr(e>>>0,!B,1,!R,131072,!1),M.$a()},j:function(e){e>>>=0,T?postMessage({cmd:"cleanupThread",thread:e}):M.Ya(M.La[e])},H:O,h:ye,S:oe,D:d,F:k,T:$,Q:Me,J:Ze,P:Rt,n:It,E:Bt,B:kt,R:Wt,C:Nt,p:()=>1,z:function(e,r){e>>>=0,e==r>>>0?setTimeout(it):T?postMessage({targetThread:e,cmd:"checkMailbox"}):(e=M.La[e])&&e.postMessage({cmd:"checkMailbox"})},I:function(e,r,n,l,y){r>>>=0,n>>>=0,pt.length=l,y=y>>>0>>>3;for(var b=0;b<l;b++)pt[b]=g()[y+b>>>0];return e=r?Ge[r]:Yr[e],M.eb=n,n=e(...pt),M.eb=0,n},K:dt,o:function(e){D&&M.La[e>>>0].ref()},s:function(e,r,n){e=r+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*r:NaN,n>>>=0,e=new Date(1e3*e),f()[n>>>2>>>0]=e.getUTCSeconds(),f()[n+4>>>2>>>0]=e.getUTCMinutes(),f()[n+8>>>2>>>0]=e.getUTCHours(),f()[n+12>>>2>>>0]=e.getUTCDate(),f()[n+16>>>2>>>0]=e.getUTCMonth(),f()[n+20>>>2>>>0]=e.getUTCFullYear()-1900,f()[n+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,f()[n+28>>>2>>>0]=e},t:function(e,r,n){e=r+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*r:NaN,n>>>=0,e=new Date(1e3*e),f()[n>>>2>>>0]=e.getSeconds(),f()[n+4>>>2>>>0]=e.getMinutes(),f()[n+8>>>2>>>0]=e.getHours(),f()[n+12>>>2>>>0]=e.getDate(),f()[n+16>>>2>>>0]=e.getMonth(),f()[n+20>>>2>>>0]=e.getFullYear()-1900,f()[n+24>>>2>>>0]=e.getDay(),r=($e(e.getFullYear())?Ht:Gt)[e.getMonth()]+e.getDate()-1|0,f()[n+28>>>2>>>0]=r,f()[n+36>>>2>>>0]=-(60*e.getTimezoneOffset()),r=new Date(e.getFullYear(),6,1).getTimezoneOffset();var l=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=(r!=l&&e.getTimezoneOffset()==Math.min(l,r))|0,f()[n+32>>>2>>>0]=e},u:function(e){e>>>=0;var r=new Date(f()[e+20>>>2>>>0]+1900,f()[e+16>>>2>>>0],f()[e+12>>>2>>>0],f()[e+8>>>2>>>0],f()[e+4>>>2>>>0],f()[e>>>2>>>0],0),n=f()[e+32>>>2>>>0],l=r.getTimezoneOffset(),y=new Date(r.getFullYear(),6,1).getTimezoneOffset(),b=new Date(r.getFullYear(),0,1).getTimezoneOffset(),v=Math.min(b,y);return 0>n?f()[e+32>>>2>>>0]=+(y!=b&&v==l):0<n!=(v==l)&&(y=Math.max(b,y),r.setTime(r.getTime()+6e4*((0<n?v:y)-l))),f()[e+24>>>2>>>0]=r.getDay(),n=($e(r.getFullYear())?Ht:Gt)[r.getMonth()]+r.getDate()-1|0,f()[e+28>>>2>>>0]=n,f()[e>>>2>>>0]=r.getSeconds(),f()[e+4>>>2>>>0]=r.getMinutes(),f()[e+8>>>2>>>0]=r.getHours(),f()[e+12>>>2>>>0]=r.getDate(),f()[e+16>>>2>>>0]=r.getMonth(),f()[e+20>>>2>>>0]=r.getYear(),e=r.getTime(),e=isNaN(e)?-1:e/1e3,ar((Te=e,1<=+Math.abs(Te)?0<Te?+Math.floor(Te/4294967296)>>>0:~~+Math.ceil((Te-+(~~Te>>>0))/4294967296)>>>0:0)),e>>>0},q:$t,r:Yt,y:function(e,r,n,l){e>>>=0,r>>>=0,n>>>=0,l>>>=0;var y=new Date().getFullYear(),b=new Date(y,0,1),v=new Date(y,6,1);y=b.getTimezoneOffset();var z=v.getTimezoneOffset(),Ce=Math.max(y,z);w()[e>>>2>>>0]=60*Ce,f()[r>>>2>>>0]=+(y!=z),e=fe=>fe.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1],b=e(b),v=e(v),z<y?(Re(b,n,17),Re(v,l,17)):(Re(b,l,17),Re(v,n,17))},c:()=>{te("")},O:function(e,r,n){e>>>=0,r>>>=0,n>>>=0,mt.length=0;for(var l;l=h()[r++>>>0];){var y=l!=105;y&=l!=112,n+=y&&n%8?4:0,mt.push(l==112?w()[n>>>2>>>0]:l==105?f()[n>>>2>>>0]:g()[n>>>3>>>0]),n+=y?8:4}return Ge[e](...mt)},k:()=>{},i:()=>Date.now(),U:()=>{throw De+=1,"unwind"},A:function(){return 4294901760},e:()=>performance.timeOrigin+performance.now(),f:()=>D?(br(),et(hr)).cpus().length:navigator.hardwareConcurrency,x:function(e){e>>>=0;var r=h().length;if(e<=r||4294901760<e)return!1;for(var n=1;4>=n;n*=2){var l=r*(1+.2/n);l=Math.min(l,e+100663296);var y=Math;l=Math.max(e,l);e:{y=(y.min.call(y,4294901760,l+(65536-l%65536)%65536)-X.buffer.byteLength+65535)/65536;try{X.grow(y),K();var b=1;break e}catch{}b=void 0}if(b)return!0}return!1},M:zt,N:qt,G:Ve,g:Vt,m:Jt,v:Xt,l:Qt,a:X||s.wasmMemory,w:er,d:function(e,r,n,l){return er(e>>>0,r>>>0,n>>>0,l>>>0)}},C=function(){function e(n,l){return C=n.exports,C=zr(),M.ab.push(C.ya),Xe=C.za,Ue.unshift(C.V),we=l,Be(),C}var r={a:jr};if(Ae++,s.instantiateWasm)try{return s.instantiateWasm(r,e)}catch(n){ne(`Module.instantiateWasm callback failed with error: ${n}`),x(n)}return rt(r,function(n){e(n.instance,n.module)}).catch(x),{}}();s._OrtInit=(e,r)=>(s._OrtInit=C.W)(e,r),s._OrtGetLastError=(e,r)=>(s._OrtGetLastError=C.X)(e,r),s._OrtCreateSessionOptions=(e,r,n,l,y,b,v,z,Ce,fe)=>(s._OrtCreateSessionOptions=C.Y)(e,r,n,l,y,b,v,z,Ce,fe),s._OrtAppendExecutionProvider=(e,r)=>(s._OrtAppendExecutionProvider=C.Z)(e,r),s._OrtAddFreeDimensionOverride=(e,r,n)=>(s._OrtAddFreeDimensionOverride=C._)(e,r,n),s._OrtAddSessionConfigEntry=(e,r,n)=>(s._OrtAddSessionConfigEntry=C.$)(e,r,n),s._OrtReleaseSessionOptions=e=>(s._OrtReleaseSessionOptions=C.aa)(e),s._OrtCreateSession=(e,r,n)=>(s._OrtCreateSession=C.ba)(e,r,n),s._OrtReleaseSession=e=>(s._OrtReleaseSession=C.ca)(e),s._OrtGetInputOutputCount=(e,r,n)=>(s._OrtGetInputOutputCount=C.da)(e,r,n),s._OrtGetInputName=(e,r)=>(s._OrtGetInputName=C.ea)(e,r),s._OrtGetOutputName=(e,r)=>(s._OrtGetOutputName=C.fa)(e,r),s._OrtFree=e=>(s._OrtFree=C.ga)(e),s._OrtCreateTensor=(e,r,n,l,y,b)=>(s._OrtCreateTensor=C.ha)(e,r,n,l,y,b),s._OrtGetTensorData=(e,r,n,l,y)=>(s._OrtGetTensorData=C.ia)(e,r,n,l,y),s._OrtReleaseTensor=e=>(s._OrtReleaseTensor=C.ja)(e),s._OrtCreateRunOptions=(e,r,n,l)=>(s._OrtCreateRunOptions=C.ka)(e,r,n,l),s._OrtAddRunConfigEntry=(e,r,n)=>(s._OrtAddRunConfigEntry=C.la)(e,r,n),s._OrtReleaseRunOptions=e=>(s._OrtReleaseRunOptions=C.ma)(e),s._OrtCreateBinding=e=>(s._OrtCreateBinding=C.na)(e),s._OrtBindInput=(e,r,n)=>(s._OrtBindInput=C.oa)(e,r,n),s._OrtBindOutput=(e,r,n,l)=>(s._OrtBindOutput=C.pa)(e,r,n,l),s._OrtClearBoundOutputs=e=>(s._OrtClearBoundOutputs=C.qa)(e),s._OrtReleaseBinding=e=>(s._OrtReleaseBinding=C.ra)(e),s._OrtRunWithBinding=(e,r,n,l,y)=>(s._OrtRunWithBinding=C.sa)(e,r,n,l,y),s._OrtRun=(e,r,n,l,y,b,v,z)=>(s._OrtRun=C.ta)(e,r,n,l,y,b,v,z),s._OrtEndProfiling=e=>(s._OrtEndProfiling=C.ua)(e);var ut=s._pthread_self=()=>(ut=s._pthread_self=C.va)();s._malloc=e=>(s._malloc=C.wa)(e),s._free=e=>(s._free=C.xa)(e),s.__emscripten_tls_init=()=>(s.__emscripten_tls_init=C.ya)();var tr=s.__emscripten_thread_init=(e,r,n,l,y,b)=>(tr=s.__emscripten_thread_init=C.Aa)(e,r,n,l,y,b);s.__emscripten_thread_crashed=()=>(s.__emscripten_thread_crashed=C.Ba)();var rr=(e,r,n,l,y)=>(rr=C.Ca)(e,r,n,l,y),bt=e=>(bt=C.Da)(e),yt=s.__emscripten_thread_exit=e=>(yt=s.__emscripten_thread_exit=C.Ea)(e),nr=()=>(nr=C.Fa)(),ar=e=>(ar=C.Ga)(e),or=(e,r)=>(or=C.Ha)(e,r),ft=e=>(ft=C.Ia)(e),wt=e=>(wt=C.Ja)(e),Ot=()=>(Ot=C.Ka)();function zr(){var e=C;e=Object.assign({},e);var r=l=>()=>l()>>>0,n=l=>y=>l(y)>>>0;return e.va=r(e.va),e.wa=n(e.wa),e.emscripten_main_runtime_thread_id=r(e.emscripten_main_runtime_thread_id),e.Ja=n(e.Ja),e.Ka=r(e.Ka),e}s.wasmMemory=X,s.stackSave=()=>Ot(),s.stackRestore=e=>ft(e),s.stackAlloc=e=>wt(e),s.keepRuntimeAlive=()=>0<De,s.UTF8ToString=ee,s.stringToUTF8=Re,s.lengthBytesUTF8=se,s.ExitStatus=ke,s.PThread=M;var lt;ge=function e(){lt||sr(),lt||(ge=e)};function sr(){if(!(0<Ae))if(T)S(s),T||Ne(Ue),startWorker(s);else{if(s.preRun)for(typeof s.preRun=="function"&&(s.preRun=[s.preRun]);s.preRun.length;)Oe.unshift(s.preRun.shift());Ne(Oe),0<Ae||lt||(lt=!0,s.calledRun=!0,me||(T||Ne(Ue),S(s),T||Ne(ve)))}}return sr(),H}})();typeof wr=="object"&&typeof Dt=="object"?Dt.exports=yr:typeof define=="function"&&define.amd&&define([],()=>yr)});var vr=Ke((yn,tn)=>{tn.exports=\'"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(...e){var a=e.join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,a+`\\n`);return}console.error(a)}function threadAlert(...e){var a=e.join(" ");postMessage({cmd:"alert",text:a,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,a)=>{var r=Module.wasmModule;Module.wasmModule=null;var t=new WebAssembly.Instance(r,e);return a(t)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let r=[];self.onmessage=t=>r.push(t),self.startWorker=t=>{Module=t,postMessage({cmd:"loaded"});for(let s of r)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const t of e.data.handlers)Module[t]=(...s)=>{postMessage({cmd:"callHandler",handler:t,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var a=URL.createObjectURL(e.data.urlOrBlob);importScripts(a),URL.revokeObjectURL(a)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(r){if(r!="unwind")throw r}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(r){throw Module.__emscripten_thread_crashed?.(),r}}self.onmessage=handleMessage;\\n\'});var Er;Er=pr();var rn=Or(),Ft,Pt=!1,ct=!1,_r=!1,nn=i=>{if(i===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+i+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+i+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},an=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},on=(i,c)=>i?c?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":c?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Sr=async i=>{if(Pt)return Promise.resolve();if(ct)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(_r)throw new Error("previous call to \'initializeWebAssembly()\' failed.");ct=!0;let c=i.initTimeout,a=i.numThreads,h=i.simd,f=nn(a),w=h&&an(),g=i.wasmPaths,s=typeof g=="string"?g:void 0,S=on(w,f),x=typeof g=="object"?g[S]:void 0,H=!1,A=[];if(c>0&&A.push(new Promise(I=>{setTimeout(()=>{H=!0,I()},c)})),A.push(new Promise((I,V)=>{let R=f?rn:Er,B={locateFile:(D,T)=>f&&D.endsWith(".worker.js")&&typeof Blob<"u"?URL.createObjectURL(new Blob([vr()],{type:"text/javascript"})):D.endsWith(".wasm")?x||(s??T)+S:T+D};if(f)if(B.numThreads=a,typeof Blob>"u")B.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let D=`var ortWasmThreaded=${R.toString()};`;B.mainScriptUrlOrBlob=new Blob([D],{type:"text/javascript"})}R(B).then(D=>{ct=!1,Pt=!0,Ft=D,I()},D=>{ct=!1,_r=!0,V(D)})})),await Promise.race(A),H)throw new Error(`WebAssembly backend initializing failed due to timeout: ${c}ms`)},Q=()=>{if(Pt&&Ft)return Ft;throw new Error("WebAssembly is not initialized yet.")};var Y=(i,c)=>{let a=Q(),h=a.lengthBytesUTF8(i)+1,f=a._malloc(h);return a.stringToUTF8(i,f,h),c.push(f),f},tt=(i,c,a,h)=>{if(typeof i=="object"&&i!==null){if(a.has(i))throw new Error("Circular reference in options");a.add(i)}Object.entries(i).forEach(([f,w])=>{let g=c?c+f:f;if(typeof w=="object")tt(w,g+".",a,h);else if(typeof w=="string"||typeof w=="number")h(g,w.toString());else if(typeof w=="boolean")h(g,w?"1":"0");else throw new Error(`Can\'t handle extra config type: ${typeof w}`)})},j=i=>{let c=Q(),a=c.stackSave();try{let h=c.stackAlloc(8);c._OrtGetLastError(h,h+4);let f=c.HEAP32[h/4],w=c.HEAPU32[h/4+1],g=w?c.UTF8ToString(w):"";throw new Error(`${i} ERROR_CODE: ${f}, ERROR_MESSAGE: ${g}`)}finally{c.stackRestore(a)}};var Ar=i=>{let c=Q(),a=0,h=[],f=i||{};try{if(i?.logSeverityLevel===void 0)f.logSeverityLevel=2;else if(typeof i.logSeverityLevel!="number"||!Number.isInteger(i.logSeverityLevel)||i.logSeverityLevel<0||i.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${i.logSeverityLevel}`);if(i?.logVerbosityLevel===void 0)f.logVerbosityLevel=0;else if(typeof i.logVerbosityLevel!="number"||!Number.isInteger(i.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${i.logVerbosityLevel}`);i?.terminate===void 0&&(f.terminate=!1);let w=0;return i?.tag!==void 0&&(w=Y(i.tag,h)),a=c._OrtCreateRunOptions(f.logSeverityLevel,f.logVerbosityLevel,!!f.terminate,w),a===0&&j("Can\'t create run options."),i?.extra!==void 0&&tt(i.extra,"",new WeakSet,(g,s)=>{let S=Y(g,h),x=Y(s,h);c._OrtAddRunConfigEntry(a,S,x)!==0&&j(`Can\'t set a run config entry: ${g} - ${s}.`)}),[a,h]}catch(w){throw a!==0&&c._OrtReleaseRunOptions(a),h.forEach(g=>c._free(g)),w}};var sn=i=>{switch(i){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${i}`)}},un=i=>{switch(i){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${i}`)}},fn=i=>{i.extra||(i.extra={}),i.extra.session||(i.extra.session={});let c=i.extra.session;c.use_ort_model_bytes_directly||(c.use_ort_model_bytes_directly="1"),i.executionProviders&&i.executionProviders.some(a=>(typeof a=="string"?a:a.name)==="webgpu")&&(i.enableMemPattern=!1)},ln=(i,c,a)=>{for(let h of c){let f=typeof h=="string"?h:h.name;switch(f){case"webnn":if(f="WEBNN",typeof h!="string"){let g=h;if(g?.deviceType){let s=Y("deviceType",a),S=Y(g.deviceType,a);Q()._OrtAddSessionConfigEntry(i,s,S)!==0&&j(`Can\'t set a session config entry: \'deviceType\' - ${g.deviceType}.`)}if(g?.numThreads){let s=g.numThreads;(typeof s!="number"||!Number.isInteger(s)||s<0)&&(s=0);let S=Y("numThreads",a),x=Y(s.toString(),a);Q()._OrtAddSessionConfigEntry(i,S,x)!==0&&j(`Can\'t set a session config entry: \'numThreads\' - ${g.numThreads}.`)}if(g?.powerPreference){let s=Y("powerPreference",a),S=Y(g.powerPreference,a);Q()._OrtAddSessionConfigEntry(i,s,S)!==0&&j(`Can\'t set a session config entry: \'powerPreference\' - ${g.powerPreference}.`)}}break;case"webgpu":if(f="JS",typeof h!="string"){let g=h;if(g?.preferredLayout){if(g.preferredLayout!=="NCHW"&&g.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either \'NCHW\' or \'NHWC\': ${g.preferredLayout}`);let s=Y("preferredLayout",a),S=Y(g.preferredLayout,a);Q()._OrtAddSessionConfigEntry(i,s,S)!==0&&j(`Can\'t set a session config entry: \'preferredLayout\' - ${g.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${f}`)}let w=Y(f,a);Q()._OrtAppendExecutionProvider(i,w)!==0&&j(`Can\'t append execution provider: ${f}.`)}},Tr=i=>{let c=Q(),a=0,h=[],f=i||{};fn(f);try{let w=sn(f.graphOptimizationLevel??"all"),g=un(f.executionMode??"sequential"),s=typeof f.logId=="string"?Y(f.logId,h):0,S=f.logSeverityLevel??2;if(!Number.isInteger(S)||S<0||S>4)throw new Error(`log serverity level is not valid: ${S}`);let x=f.logVerbosityLevel??0;if(!Number.isInteger(x)||x<0||x>4)throw new Error(`log verbosity level is not valid: ${x}`);let H=typeof f.optimizedModelFilePath=="string"?Y(f.optimizedModelFilePath,h):0;if(a=c._OrtCreateSessionOptions(w,!!f.enableCpuMemArena,!!f.enableMemPattern,g,!!f.enableProfiling,0,s,S,x,H),a===0&&j("Can\'t create session options."),f.executionProviders&&ln(a,f.executionProviders,h),f.enableGraphCapture!==void 0){if(typeof f.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${f.enableGraphCapture}`);let A=Y("enableGraphCapture",h),I=Y(f.enableGraphCapture.toString(),h);c._OrtAddSessionConfigEntry(a,A,I)!==0&&j(`Can\'t set a session config entry: \'enableGraphCapture\' - ${f.enableGraphCapture}.`)}if(f.freeDimensionOverrides)for(let[A,I]of Object.entries(f.freeDimensionOverrides)){if(typeof A!="string")throw new Error(`free dimension override name must be a string: ${A}`);if(typeof I!="number"||!Number.isInteger(I)||I<0)throw new Error(`free dimension override value must be a non-negative integer: ${I}`);let V=Y(A,h);c._OrtAddFreeDimensionOverride(a,V,I)!==0&&j(`Can\'t set a free dimension override: ${A} - ${I}.`)}return f.extra!==void 0&&tt(f.extra,"",new WeakSet,(A,I)=>{let V=Y(A,h),R=Y(I,h);c._OrtAddSessionConfigEntry(a,V,R)!==0&&j(`Can\'t set a session config entry: ${A} - ${I}.`)}),[a,h]}catch(w){throw a!==0&&c._OrtReleaseSessionOptions(a),h.forEach(g=>c._free(g)),w}};var xt=i=>{switch(i){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${i}`)}},Mr=i=>{switch(i){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${i}`)}},Ut=i=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][i],Cr=i=>{switch(i){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${i}`)}},Dr=i=>{switch(i){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${i}`)}},Fr=i=>i==="float32"||i==="float16"||i==="int32"||i==="int64"||i==="uint32"||i==="uint8"||i==="bool",Pr=i=>{switch(i){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${i}`)}};var xr=async i=>{if(typeof i=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(i))}catch(c){if(c.code==="ERR_FS_FILE_TOO_LARGE"){let a=(void 0)(i),h=[];for await(let f of a)h.push(f);return new Uint8Array(Buffer.concat(h))}throw c}else{let c=await fetch(i);if(!c.ok)throw new Error(`failed to load external data file: ${i}`);let a=c.headers.get("Content-Length"),h=a?parseInt(a,10):0;if(h<1073741824)return new Uint8Array(await c.arrayBuffer());{if(!c.body)throw new Error(`failed to load external data file: ${i}, no response body.`);let f=c.body.getReader(),w;try{w=new ArrayBuffer(h)}catch(s){if(s instanceof RangeError){let S=Math.ceil(h/65536);w=new WebAssembly.Memory({initial:S,maximum:S}).buffer}else throw s}let g=0;for(;;){let{done:s,value:S}=await f.read();if(s)break;let x=S.byteLength;new Uint8Array(w,g,x).set(S),g+=x}return new Uint8Array(w,0,h)}}else return i instanceof Blob?new Uint8Array(await i.arrayBuffer()):i instanceof Uint8Array?i:new Uint8Array(i)};var cn=(i,c)=>{Q()._OrtInit(i,c)!==0&&j("Can\'t initialize onnxruntime.")},Lr=async i=>{cn(i.wasm.numThreads,Dr(i.logLevel))},Rr=async(i,c)=>{},Ye=new Map,dn=i=>{let c=Q(),a=c.stackSave();try{let h=c.stackAlloc(8);return c._OrtGetInputOutputCount(i,h,h+4)!==0&&j("Can\'t get session input/output count."),[c.HEAP32[h/4],c.HEAP32[h/4+1]]}finally{c.stackRestore(a)}},Lt=i=>{let c=Q(),a=c._malloc(i.byteLength);if(a===0)throw new Error(`Can\'t create a session. failed to allocate a buffer of size ${i.byteLength}.`);return c.HEAPU8.set(i,a),[a,i.byteLength]},Ir=async(i,c)=>{let a,h,f=Q();Array.isArray(i)?[a,h]=i:i.buffer===f.HEAPU8.buffer?[a,h]=[i.byteOffset,i.byteLength]:[a,h]=Lt(i);let w=0,g=0,s=0,S=[],x=[],H=[];try{if([g,S]=Tr(c),c?.externalData&&f.mountExternalData){let L=[];for(let W of c.externalData){let de=typeof W=="string"?W:W.path;L.push(xr(typeof W=="string"?W:W.data).then(pe=>{f.mountExternalData(de,pe)}))}await Promise.all(L)}w=await f._OrtCreateSession(a,h,g),w===0&&j("Can\'t create a session.");let[A,I]=dn(w),V=!!c?.enableGraphCapture,R=[],B=[],D=[];for(let L=0;L<A;L++){let W=f._OrtGetInputName(w,L);W===0&&j("Can\'t get an input name."),x.push(W),R.push(f.UTF8ToString(W))}for(let L=0;L<I;L++){let W=f._OrtGetOutputName(w,L);W===0&&j("Can\'t get an output name."),H.push(W);let de=f.UTF8ToString(W);B.push(de)}let T=null;return Ye.set(w,[w,x,H,T,V,!1]),[w,R,B]}catch(A){throw x.forEach(I=>f._OrtFree(I)),H.forEach(I=>f._OrtFree(I)),s!==0&&f._OrtReleaseBinding(s),w!==0&&f._OrtReleaseSession(w),A}finally{f._free(a),g!==0&&f._OrtReleaseSessionOptions(g),S.forEach(A=>f._free(A)),f.unmountExternalData?.()}},Br=i=>{let c=Q(),a=Ye.get(i);if(!a)throw new Error(`cannot release session. invalid session id: ${i}`);let[h,f,w,g,s]=a;g&&(s&&c._OrtClearBoundOutputs(g.handle),c._OrtReleaseBinding(g.handle)),c.jsepOnReleaseSession?.(i),f.forEach(S=>c._OrtFree(S)),w.forEach(S=>c._OrtFree(S)),c._OrtReleaseSession(h),Ye.delete(i)},Ur=(i,c,a,h,f,w=!1)=>{if(!i){c.push(0);return}let g=Q(),s=i[0],S=i[1],x=i[3],H,A;if(s==="string"&&x==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(w&&x!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${f} when enableGraphCapture is true.`);if(x==="gpu-buffer"){let R=i[2].gpuBuffer,B=Ut(xt(s));A=S.reduce((T,L)=>T*L,1)*B;let D=g.jsepRegisterBuffer;if(!D)throw new Error(\'Tensor location "gpu-buffer" is not supported without using WebGPU.\');H=D(h,f,R,A)}else{let R=i[2];if(Array.isArray(R)){A=4*R.length,H=g._malloc(A),a.push(H);let B=H/4;for(let D=0;D<R.length;D++){if(typeof R[D]!="string")throw new TypeError(`tensor data at index ${D} is not a string`);g.HEAPU32[B++]=Y(R[D],a)}}else A=R.byteLength,H=g._malloc(A),a.push(H),g.HEAPU8.set(new Uint8Array(R.buffer,R.byteOffset,A),H)}let I=g.stackSave(),V=g.stackAlloc(4*S.length);try{let R=V/4;S.forEach(D=>g.HEAP32[R++]=D);let B=g._OrtCreateTensor(xt(s),H,A,V,S.length,Pr(x));B===0&&j(`Can\'t create tensor for input/output. session=${h}, index=${f}.`),c.push(B)}finally{g.stackRestore(I)}},kr=async(i,c,a,h,f,w)=>{let g=Q(),s=Ye.get(i);if(!s)throw new Error(`cannot run inference. invalid session id: ${i}`);let S=s[0],x=s[1],H=s[2],A=s[3],I=s[4],V=s[5],R=c.length,B=h.length,D=0,T=[],L=[],W=[],de=[],pe=g.stackSave(),Z=g.stackAlloc(R*4),_=g.stackAlloc(R*4),J=g.stackAlloc(B*4),Pe=g.stackAlloc(B*4);try{[D,T]=Ar(w);for(let F=0;F<R;F++)Ur(a[F],L,de,i,c[F],I);for(let F=0;F<B;F++)Ur(f[F],W,de,i,R+h[F],I);let le=Z/4,Ie=_/4,ne=J/4,X=Pe/4;for(let F=0;F<R;F++)g.HEAPU32[le++]=L[F],g.HEAPU32[Ie++]=x[c[F]];for(let F=0;F<B;F++)g.HEAPU32[ne++]=W[F],g.HEAPU32[X++]=H[h[F]];g.jsepOnRunStart?.(S);let we;we=await g._OrtRun(S,_,Z,R,Pe,B,J,D),we!==0&&j("failed to call OrtRun().");let me=[];for(let F=0;F<B;F++){let ie=g.HEAPU32[J/4+F];if(ie===W[F]){me.push(f[F]);continue}let xe=g.stackSave(),ce=g.stackAlloc(4*4),be=!1,ae,K=0;try{g._OrtGetTensorData(ie,ce,ce+4,ce+8,ce+12)!==0&&j(`Can\'t access output tensor data on index ${F}.`);let Oe=ce/4,Ue=g.HEAPU32[Oe++];K=g.HEAPU32[Oe++];let ve=g.HEAPU32[Oe++],Ae=g.HEAPU32[Oe++],_e=[];for(let te=0;te<Ae;te++)_e.push(g.HEAPU32[ve/4+te]);g._OrtFree(ve);let ge=_e.reduce((te,re)=>te*re,1);ae=Mr(Ue);let Be=A?.outputPreferredLocations[h[F]];if(ae==="string"){if(Be==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let te=[],re=K/4;for(let ue=0;ue<ge;ue++){let Ee=g.HEAPU32[re++],Se=ue===ge-1?void 0:g.HEAPU32[re]-Ee;te.push(g.UTF8ToString(Ee,Se))}me.push([ae,_e,te,"cpu"])}else if(Be==="gpu-buffer"&&ge>0){let te=g.jsepGetBuffer;if(!te)throw new Error(\'preferredLocation "gpu-buffer" is not supported without using WebGPU.\');let re=te(K),ue=Ut(Ue);if(ue===void 0||!Fr(ae))throw new Error(`Unsupported data type: ${ae}`);be=!0,me.push([ae,_e,{gpuBuffer:re,download:g.jsepCreateDownloader(re,ge*ue,ae),dispose:()=>{g._OrtReleaseTensor(ie)}},"gpu-buffer"])}else{let te=Cr(ae),re=new te(ge);new Uint8Array(re.buffer,re.byteOffset,re.byteLength).set(g.HEAPU8.subarray(K,K+re.byteLength)),me.push([ae,_e,re,"cpu"])}}finally{g.stackRestore(xe),ae==="string"&&K&&g._free(K),be||g._OrtReleaseTensor(ie)}}return A&&!I&&(g._OrtClearBoundOutputs(A.handle),Ye.set(i,[S,x,H,A,I,!1])),me}finally{g.stackRestore(pe),L.forEach(le=>g._OrtReleaseTensor(le)),W.forEach(le=>g._OrtReleaseTensor(le)),de.forEach(le=>g._free(le)),D!==0&&g._OrtReleaseRunOptions(D),T.forEach(le=>g._free(le))}},Wr=i=>{let c=Q(),a=Ye.get(i);if(!a)throw new Error("invalid session id");let h=a[0],f=c._OrtEndProfiling(h);f===0&&j("Can\'t get an profile file name."),c._OrtFree(f)},Nr=i=>{let c=[];for(let a of i){let h=a[2];!Array.isArray(h)&&"buffer"in h&&c.push(h.buffer)}return c};self.onmessage=i=>{let{type:c,in:a}=i.data;try{switch(c){case"init-wasm":Sr(a.wasm).then(()=>{Lr(a).then(()=>{postMessage({type:c})},h=>{postMessage({type:c,err:h})})},h=>{postMessage({type:c,err:h})});break;case"init-ep":{let{epName:h,env:f}=a;Rr(f,h).then(()=>{postMessage({type:c})},w=>{postMessage({type:c,err:w})});break}case"copy-from":{let{buffer:h}=a,f=Lt(h);postMessage({type:c,out:f});break}case"create":{let{model:h,options:f}=a;Ir(h,f).then(w=>{postMessage({type:c,out:w})},w=>{postMessage({type:c,err:w})});break}case"release":Br(a),postMessage({type:c});break;case"run":{let{sessionId:h,inputIndices:f,inputs:w,outputIndices:g,options:s}=a;kr(h,f,w,g,new Array(g.length).fill(null),s).then(S=>{S.some(x=>x[3]!=="cpu")?postMessage({type:c,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:c,out:S},Nr([...w,...S]))},S=>{postMessage({type:c,err:S})});break}case"end-profiling":Wr(a),postMessage({type:c});break;default:}}catch(h){postMessage({type:c,err:h})}};})();\n'}),_r,gt$1,yn,Do,Lo,ca$1,pa$1,Vr,Wr,Tg,Eo,od$1,id$2,ad$1,sd$1,ud$1,ld$1,fd$1,da$1=L(()=>{var e;Ot$1(),rd$1(),Ur(),_r=()=>!!Z.wasm.proxy&&typeof document<"u",yn=!1,Do=!1,Lo=!1,pa$1=new Map,Vr=(i,a)=>{let o=pa$1.get(i);o?o.push(a):pa$1.set(i,[a])},Wr=()=>{if(yn||!Do||Lo||!gt$1)throw new Error("worker not ready")},Tg=i=>{switch(i.data.type){case"init-wasm":yn=!1,i.data.err?(Lo=!0,ca$1[1](i.data.err)):(Do=!0,ca$1[0]());break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let a=pa$1.get(i.data.type);i.data.err?a.shift()[1](i.data.err):a.shift()[0](i.data.out);break}}},Eo=typeof document<"u"?(e=document==null?void 0:document.currentScript)==null?void 0:e.src:void 0,od$1=async()=>{if(!Do){if(yn)throw new Error("multiple calls to 'initWasm()' detected.");if(Lo)throw new Error("previous call to 'initWasm()' failed.");if(yn=!0,_r())return Z.wasm.wasmPaths===void 0&&Eo&&Eo.indexOf("blob:")!==0&&(Z.wasm.wasmPaths=Eo.substr(0,+Eo.lastIndexOf("/")+1)),new Promise((i,a)=>{gt$1==null||gt$1.terminate();let o=URL.createObjectURL(new Blob([nd$1()],{type:"text/javascript"}));gt$1=new Worker(o,{name:"ort-wasm-proxy-worker"}),gt$1.onerror=s=>a(s),gt$1.onmessage=Tg,URL.revokeObjectURL(o),ca$1=[i,a];let c={type:"init-wasm",in:Z};gt$1.postMessage(c)});try{await Mp$1(Z.wasm),await Xp$1(Z),Do=!0}catch(i){throw Lo=!0,i}finally{yn=!1}}},id$2=async i=>{if(_r())return Wr(),new Promise((a,o)=>{Vr("init-ep",[a,o]);let c={type:"init-ep",in:{epName:i,env:Z}};gt$1.postMessage(c)});await Kp$1(Z,i)},ad$1=async i=>_r()?(Wr(),new Promise((a,o)=>{Vr("copy-from",[a,o]);let c={type:"copy-from",in:{buffer:i}};gt$1.postMessage(c,[i.buffer])})):fa$1(i),sd$1=async(i,a)=>{if(_r()){if(a!=null&&a.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return Wr(),new Promise((o,c)=>{Vr("create",[o,c]);let s={type:"create",in:{model:i,options:{...a}}},d=[];i instanceof Uint8Array&&d.push(i.buffer),gt$1.postMessage(s,d)})}else return Jp$1(i,a)},ud$1=async i=>{if(_r())return Wr(),new Promise((a,o)=>{Vr("release",[a,o]);let c={type:"release",in:i};gt$1.postMessage(c)});Zp$1(i)},ld$1=async(i,a,o,c,s,d)=>{if(_r()){if(o.some($=>$[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(s.some($=>$))throw new Error("pre-allocated output tensor is not supported for proxy.");return Wr(),new Promise(($,et)=>{Vr("run",[$,et]);let h=o,b={type:"run",in:{sessionId:i,inputIndices:a,inputs:h,outputIndices:c,options:d}};gt$1.postMessage(b,td$1(h))})}else return Qp$1(i,a,o,c,s,d)},fd$1=async i=>{if(_r())return Wr(),new Promise((a,o)=>{Vr("end-profiling",[a,o]);let c={type:"end-profiling",in:i};gt$1.postMessage(c)});ed$1(i)}}),cd$1,xg,Co$1,pd$1=L(()=>{Ot$1(),da$1(),ua$1(),la$1(),cd$1=(e,i)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];default:throw new Error(`invalid data location: ${e.location} for ${i()}`)}},xg=e=>{switch(e[3]){case"cpu":return new Me(e[0],e[2],e[1]);case"gpu-buffer":{let i=e[0];if(!Po(i))throw new Error(`not supported data type: ${i} for deserializing GPU tensor`);let{gpuBuffer:a,download:o,dispose:c}=e[2];return Me.fromGpuBuffer(a,{dataType:i,dims:e[1],download:o,dispose:c})}default:throw new Error(`invalid data location: ${e[3]}`)}},Co$1=class{async fetchModelAndCopyToWasmMemory(e){return ad$1(await gn(e))}async loadModel(e,i){lr$1();let a;typeof e=="string"?typeof process<"u"&&process.versions&&process.versions.node?a=await gn(e):a=await this.fetchModelAndCopyToWasmMemory(e):a=e,[this.sessionId,this.inputNames,this.outputNames]=await sd$1(a,i),fr$1()}async dispose(){return ud$1(this.sessionId)}async run(e,i,a){lr$1();let o=[],c=[];Object.entries(e).forEach(g=>{let st=g[0],$t=g[1],vt=this.inputNames.indexOf(st);if(vt===-1)throw new Error(`invalid input '${st}'`);o.push($t),c.push(vt)});let s=[],d=[];Object.entries(i).forEach(g=>{let st=g[0],$t=g[1],vt=this.outputNames.indexOf(st);if(vt===-1)throw new Error(`invalid output '${st}'`);s.push($t),d.push(vt)});let $=o.map((g,st)=>cd$1(g,()=>`input "${this.inputNames[c[st]]}"`)),et=s.map((g,st)=>g?cd$1(g,()=>`output "${this.outputNames[d[st]]}"`):null),h=await ld$1(this.sessionId,c,$,d,et,a),b={};for(let g=0;g<h.length;g++)b[this.outputNames[d[g]]]=s[g]??xg(h[g]);return fr$1(),b}startProfiling(){}endProfiling(){fd$1(this.sessionId)}}}),wg,Fo,dd$1=L(()=>{Ot$1(),da$1(),pd$1(),wg=()=>{if((typeof Z.wasm.initTimeout!="number"||Z.wasm.initTimeout<0)&&(Z.wasm.initTimeout=0),typeof Z.wasm.simd!="boolean"&&(Z.wasm.simd=!0),typeof Z.wasm.proxy!="boolean"&&(Z.wasm.proxy=!1),typeof Z.wasm.trace!="boolean"&&(Z.wasm.trace=!1),typeof Z.wasm.numThreads!="number"||!Number.isInteger(Z.wasm.numThreads)||Z.wasm.numThreads<=0){(typeof self<"u"&&!self.crossOriginIsolated||typeof process<"u"&&process.versions&&process.versions.node)&&(Z.wasm.numThreads=1);let e=typeof navigator>"u"?(void 0)().length:navigator.hardwareConcurrency;Z.wasm.numThreads=Math.min(4,Math.ceil((e||1)/2))}},Fo=class{async init(e){wg(),await od$1(),await id$2(e)}async createInferenceSessionHandler(e,i){let a=new Co$1;return await a.loadModel(e,i),Promise.resolve(a)}}}),hd$1={};Sr(hd$1,{wasmBackend:()=>vg});var vg,md$1=L(()=>{dd$1(),vg=new Fo});Ot$1();Ot$1();Ot$1();var Ts$1="1.18.0",jO=qo;{let e=(Op$1(),ar(_p$1)).onnxjsBackend;Pr$1("webgl",e,-10)}{let e=(md$1(),ar(hd$1)).wasmBackend;Pr$1("cpu",e,10),Pr$1("wasm",e,10)}Object.defineProperty(Z.versions,"web",{value:Ts$1,enumerable:!0});/*! Bundled license information:

long/index.js:
  (**
   * @license
   * Copyright 2009 The Closure Library Authors
   * Copyright 2020 Daniel Wirtz / The long.js Authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   * SPDX-License-Identifier: Apache-2.0
   *)
*/const ort_cpu=Object.freeze(Object.defineProperty({__proto__:null,get InferenceSession(){return Pd$1},get TRACE(){return ls$1},get TRACE_FUNC_BEGIN(){return lr$1},get TRACE_FUNC_END(){return fr$1},get Tensor(){return Me},get TrainingSession(){return Dd$1},default:jO,get env(){return Z},get registerBackend(){return Pr$1}},Symbol.toStringTag,{value:"Module"}));/*!
 * ONNX Runtime Web v1.18.0
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */var Oi=Object.defineProperty,nc=Object.getOwnPropertyDescriptor,ic=Object.getOwnPropertyNames,oc=Object.prototype.hasOwnProperty,j=(e,i)=>()=>(e&&(i=e(e=0)),i),Er=(e,i)=>()=>(i||e((i={exports:{}}).exports,i),i.exports),kr=(e,i)=>{for(var a in i)Oi(e,a,{get:i[a],enumerable:!0})},ac=(e,i,a,o)=>{if(i&&typeof i=="object"||typeof i=="function")for(let c of ic(i))!oc.call(e,c)&&c!==a&&Oi(e,c,{get:()=>i[c],enumerable:!(o=nc(i,c))||o.enumerable});return e},sr=e=>ac(Oi({},"__esModule",{value:!0}),e),kn,ur,lr,sc,On,Pn=j(()=>{kn=new Map,ur=[],lr=(e,i,a)=>{if(i&&typeof i.init=="function"&&typeof i.createInferenceSessionHandler=="function"){let o=kn.get(e);if(o===void 0)kn.set(e,{backend:i,priority:a});else{if(o.priority>a)return;if(o.priority===a&&o.backend!==i)throw new Error(`cannot register backend "${e}" using priority ${a}`)}if(a>=0){let c=ur.indexOf(e);c!==-1&&ur.splice(c,1);for(let s=0;s<ur.length;s++)if(kn.get(ur[s]).priority<=a){ur.splice(s,0,e);return}ur.push(e)}return}throw new TypeError("not a valid backend")},sc=async e=>{let i=kn.get(e);if(!i)return"backend not found.";if(i.initialized)return i.backend;if(i.aborted)return i.error;{let a=!!i.initPromise;try{return a||(i.initPromise=i.backend.init(e)),await i.initPromise,i.initialized=!0,i.backend}catch(o){return a||(i.error=`${o}`,i.aborted=!0),i.error}finally{delete i.initPromise}}},On=async e=>{let i=e.executionProviders||[],a=i.map(et=>typeof et=="string"?et:et.name),o=a.length===0?ur:a,c,s=[],d=new Set;for(let et of o){let h=await sc(et);typeof h=="string"?s.push({name:et,err:h}):(c||(c=h),c===h&&d.add(et))}if(!c)throw new Error(`no available backend found. ERR: ${s.map(et=>`[${et.name}] ${et.err}`).join(", ")}`);for(let{name:et,err:h}of s)a.includes(et)&&console.warn(`removing requested execution provider "${et}" from session options because it is not available: ${h}`);let $=i.filter(et=>d.has(typeof et=="string"?et:et.name));return[c,new Proxy(e,{get:(et,h)=>h==="executionProviders"?$:Reflect.get(et,h)})]}}),ra=j(()=>{Pn()}),na,ia=j(()=>{na="1.18.0"}),oa,gt,Pi=j(()=>{ia(),oa="warning",gt={wasm:{},webgl:{},webgpu:{},versions:{common:na},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);oa=e}},get logLevel(){return oa}},Object.defineProperty(gt,"logLevel",{enumerable:!0})}),ke,aa=j(()=>{Pi(),ke=gt}),sa,ua,la=j(()=>{sa=(e,i)=>{let a=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);a.width=e.dims[3],a.height=e.dims[2];let o=a.getContext("2d");if(o!=null){let c,s;(i==null?void 0:i.tensorLayout)!==void 0&&i.tensorLayout==="NHWC"?(c=e.dims[2],s=e.dims[3]):(c=e.dims[3],s=e.dims[2]);let d=(i==null?void 0:i.format)!==void 0?i.format:"RGB",$=i==null?void 0:i.norm,et,h;$===void 0||$.mean===void 0?et=[255,255,255,255]:typeof $.mean=="number"?et=[$.mean,$.mean,$.mean,$.mean]:(et=[$.mean[0],$.mean[1],$.mean[2],0],$.mean[3]!==void 0&&(et[3]=$.mean[3])),$===void 0||$.bias===void 0?h=[0,0,0,0]:typeof $.bias=="number"?h=[$.bias,$.bias,$.bias,$.bias]:(h=[$.bias[0],$.bias[1],$.bias[2],0],$.bias[3]!==void 0&&(h[3]=$.bias[3]));let b=s*c,g=0,st=b,$t=b*2,vt=-1;d==="RGBA"?(g=0,st=b,$t=b*2,vt=b*3):d==="RGB"?(g=0,st=b,$t=b*2):d==="RBG"&&(g=0,$t=b,st=b*2);for(let Ft=0;Ft<s;Ft++)for(let Gt=0;Gt<c;Gt++){let qt=(e.data[g++]-h[0])*et[0],Lt=(e.data[st++]-h[1])*et[1],rr=(e.data[$t++]-h[2])*et[2],jr=vt===-1?255:(e.data[vt++]-h[3])*et[3];o.fillStyle="rgba("+qt+","+Lt+","+rr+","+jr+")",o.fillRect(Gt,Ft,1,1)}if("toDataURL"in a)return a.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},ua=(e,i)=>{let a=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),o;if(a!=null){let c,s,d;(i==null?void 0:i.tensorLayout)!==void 0&&i.tensorLayout==="NHWC"?(c=e.dims[2],s=e.dims[1],d=e.dims[3]):(c=e.dims[3],s=e.dims[2],d=e.dims[1]);let $=i!==void 0&&i.format!==void 0?i.format:"RGB",et=i==null?void 0:i.norm,h,b;et===void 0||et.mean===void 0?h=[255,255,255,255]:typeof et.mean=="number"?h=[et.mean,et.mean,et.mean,et.mean]:(h=[et.mean[0],et.mean[1],et.mean[2],255],et.mean[3]!==void 0&&(h[3]=et.mean[3])),et===void 0||et.bias===void 0?b=[0,0,0,0]:typeof et.bias=="number"?b=[et.bias,et.bias,et.bias,et.bias]:(b=[et.bias[0],et.bias[1],et.bias[2],0],et.bias[3]!==void 0&&(b[3]=et.bias[3]));let g=s*c;if(i!==void 0&&(i.format!==void 0&&d===4&&i.format!=="RGBA"||d===3&&i.format!=="RGB"&&i.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let st=4,$t=0,vt=1,Ft=2,Gt=3,qt=0,Lt=g,rr=g*2,jr=-1;$==="RGBA"?(qt=0,Lt=g,rr=g*2,jr=g*3):$==="RGB"?(qt=0,Lt=g,rr=g*2):$==="RBG"&&(qt=0,rr=g,Lt=g*2),o=a.createImageData(c,s);for(let Hr=0;Hr<s*c;$t+=st,vt+=st,Ft+=st,Gt+=st,Hr++)o.data[$t]=(e.data[qt++]-b[0])*h[0],o.data[vt]=(e.data[Lt++]-b[1])*h[1],o.data[Ft]=(e.data[rr++]-b[2])*h[2],o.data[Gt]=jr===-1?255:(e.data[jr++]-b[3])*h[3]}else throw new Error("Can not access image data");return o}}),Ri,da,ca,pa,ma,fa=j(()=>{Rn(),Ri=(e,i)=>{if(e===void 0)throw new Error("Image buffer must be defined");if(i.height===void 0||i.width===void 0)throw new Error("Image height and width must be defined");if(i.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:a,width:o}=i,c=i.norm??{mean:255,bias:0},s,d;typeof c.mean=="number"?s=[c.mean,c.mean,c.mean,c.mean]:s=[c.mean[0],c.mean[1],c.mean[2],c.mean[3]??255],typeof c.bias=="number"?d=[c.bias,c.bias,c.bias,c.bias]:d=[c.bias[0],c.bias[1],c.bias[2],c.bias[3]??0];let $=i.format!==void 0?i.format:"RGBA",et=i.tensorFormat!==void 0&&i.tensorFormat!==void 0?i.tensorFormat:"RGB",h=a*o,b=et==="RGBA"?new Float32Array(h*4):new Float32Array(h*3),g=4,st=0,$t=1,vt=2,Ft=3,Gt=0,qt=h,Lt=h*2,rr=-1;$==="RGB"&&(g=3,st=0,$t=1,vt=2,Ft=-1),et==="RGBA"?rr=h*3:et==="RBG"?(Gt=0,Lt=h,qt=h*2):et==="BGR"&&(Lt=0,qt=h,Gt=h*2);for(let jr=0;jr<h;jr++,st+=g,vt+=g,$t+=g,Ft+=g)b[Gt++]=(e[st]+d[0])/s[0],b[qt++]=(e[$t]+d[1])/s[1],b[Lt++]=(e[vt]+d[2])/s[2],rr!==-1&&Ft!==-1&&(b[rr++]=(e[Ft]+d[3])/s[3]);return et==="RGBA"?new ot("float32",b,[1,4,a,o]):new ot("float32",b,[1,3,a,o])},da=async(e,i)=>{let a=typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement,o=typeof ImageData<"u"&&e instanceof ImageData,c=typeof ImageBitmap<"u"&&e instanceof ImageBitmap,s=typeof e=="string",d,$=i??{},et=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},h=b=>b instanceof HTMLCanvasElement||b instanceof OffscreenCanvas?b.getContext("2d"):null;if(a){let b=et();b.width=e.width,b.height=e.height;let g=h(b);if(g!=null){let st=e.height,$t=e.width;if(i!==void 0&&i.resizedHeight!==void 0&&i.resizedWidth!==void 0&&(st=i.resizedHeight,$t=i.resizedWidth),i!==void 0){if($=i,i.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");$.tensorFormat="RGBA",$.height=st,$.width=$t}else $.tensorFormat="RGBA",$.height=st,$.width=$t;g.drawImage(e,0,0),d=g.getImageData(0,0,$t,st).data}else throw new Error("Can not access image data")}else if(o){let b,g;if(i!==void 0&&i.resizedWidth!==void 0&&i.resizedHeight!==void 0?(b=i.resizedHeight,g=i.resizedWidth):(b=e.height,g=e.width),i!==void 0&&($=i),$.format="RGBA",$.height=b,$.width=g,i!==void 0){let st=et();st.width=g,st.height=b;let $t=h(st);if($t!=null)$t.putImageData(e,0,0),d=$t.getImageData(0,0,g,b).data;else throw new Error("Can not access image data")}else d=e.data}else if(c){if(i===void 0)throw new Error("Please provide image config with format for Imagebitmap");let b=et();b.width=e.width,b.height=e.height;let g=h(b);if(g!=null){let st=e.height,$t=e.width;return g.drawImage(e,0,0,$t,st),d=g.getImageData(0,0,$t,st).data,$.height=st,$.width=$t,Ri(d,$)}else throw new Error("Can not access image data")}else{if(s)return new Promise((b,g)=>{let st=et(),$t=h(st);if(!e||!$t)return g();let vt=new Image;vt.crossOrigin="Anonymous",vt.src=e,vt.onload=()=>{st.width=vt.width,st.height=vt.height,$t.drawImage(vt,0,0,st.width,st.height);let Ft=$t.getImageData(0,0,st.width,st.height);$.height=st.height,$.width=st.width,b(Ri(Ft.data,$))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(d!==void 0)return Ri(d,$);throw new Error("Input data provided is not supported - aborted tensor creation")},ca=(e,i)=>{let{width:a,height:o,download:c,dispose:s}=i,d=[1,o,a,4];return new ot({location:"texture",type:"float32",texture:e,dims:d,download:c,dispose:s})},pa=(e,i)=>{let{dataType:a,dims:o,download:c,dispose:s}=i;return new ot({location:"gpu-buffer",type:a??"float32",gpuBuffer:e,dims:o,download:c,dispose:s})},ma=(e,i,a)=>new ot({location:"cpu-pinned",type:e,data:i,dims:a??[i.length]})}),dr,Qr,ha,ga,ya=j(()=>{dr=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),Qr=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),ha=!1,ga=()=>{if(!ha){ha=!0;let e=typeof BigInt64Array<"u"&&BigInt64Array.from,i=typeof BigUint64Array<"u"&&BigUint64Array.from,a=typeof Float16Array<"u"&&Float16Array.from;e&&(dr.set("int64",BigInt64Array),Qr.set(BigInt64Array,"int64")),i&&(dr.set("uint64",BigUint64Array),Qr.set(BigUint64Array,"uint64")),a?(dr.set("float16",Float16Array),Qr.set(Float16Array,"float16")):dr.set("float16",Uint16Array)}}}),ba,va,wa=j(()=>{Rn(),ba=e=>{let i=1;for(let a=0;a<e.length;a++){let o=e[a];if(typeof o!="number"||!Number.isSafeInteger(o))throw new TypeError(`dims[${a}] must be an integer, got: ${o}`);if(o<0)throw new RangeError(`dims[${a}] must be a non-negative integer, got: ${o}`);i*=o}return i},va=(e,i)=>{switch(e.location){case"cpu":return new ot(e.type,e.data,i);case"cpu-pinned":return new ot({location:"cpu-pinned",data:e.data,type:e.type,dims:i});case"texture":return new ot({location:"texture",texture:e.texture,type:e.type,dims:i});case"gpu-buffer":return new ot({location:"gpu-buffer",gpuBuffer:e.gpuBuffer,type:e.type,dims:i});default:throw new Error(`tensorReshape: tensor location ${e.location} is not supported`)}}}),ot,Rn=j(()=>{la(),fa(),ya(),wa(),ot=class{constructor(e,i,a){ga();let o,c;if(typeof e=="object"&&"location"in e)switch(this.dataLocation=e.location,o=e.type,c=e.dims,e.location){case"cpu-pinned":{let d=dr.get(o);if(!d)throw new TypeError(`unsupported type "${o}" to create tensor from pinned buffer`);if(!(e.data instanceof d))throw new TypeError(`buffer should be of type ${d.name}`);this.cpuData=e.data;break}case"texture":{if(o!=="float32")throw new TypeError(`unsupported type "${o}" to create tensor from texture`);this.gpuTextureData=e.texture,this.downloader=e.download,this.disposer=e.dispose;break}case"gpu-buffer":{if(o!=="float32"&&o!=="float16"&&o!=="int32"&&o!=="int64"&&o!=="uint32"&&o!=="uint8"&&o!=="bool")throw new TypeError(`unsupported type "${o}" to create tensor from gpu buffer`);this.gpuBufferData=e.gpuBuffer,this.downloader=e.download,this.disposer=e.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let d,$;if(typeof e=="string")if(o=e,$=a,e==="string"){if(!Array.isArray(i))throw new TypeError("A string tensor's data must be a string array.");d=i}else{let et=dr.get(e);if(et===void 0)throw new TypeError(`Unsupported tensor type: ${e}.`);if(Array.isArray(i)){if(e==="float16"&&et===Uint16Array)throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");e==="uint64"||e==="int64"?d=et.from(i,BigInt):d=et.from(i)}else if(i instanceof et)d=i;else throw new TypeError(`A ${o} tensor's data must be type of ${et}`)}else if($=i,Array.isArray(e)){if(e.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let et=typeof e[0];if(et==="string")o="string",d=e;else if(et==="boolean")o="bool",d=Uint8Array.from(e);else throw new TypeError(`Invalid element type of data array: ${et}.`)}else{let et=Qr.get(e.constructor);if(et===void 0)throw new TypeError(`Unsupported type for tensor data: ${e.constructor}.`);o=et,d=e}if($===void 0)$=[d.length];else if(!Array.isArray($))throw new TypeError("A tensor's dims must be a number array");c=$,this.cpuData=d,this.dataLocation="cpu"}let s=ba(c);if(this.cpuData&&s!==this.cpuData.length)throw new Error(`Tensor's size(${s}) does not match data length(${this.cpuData.length}).`);this.type=o,this.dims=c,this.size=s}static async fromImage(e,i){return da(e,i)}static fromTexture(e,i){return ca(e,i)}static fromGpuBuffer(e,i){return pa(e,i)}static fromPinnedBuffer(e,i,a){return ma(e,i,a)}toDataURL(e){return sa(this,e)}toImageData(e){return ua(this,e)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}async getData(e){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let i=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=i,e&&this.disposer&&(this.disposer(),this.disposer=void 0),i}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(e){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return va(this,e)}}}),tt,zn=j(()=>{Rn(),tt=ot}),Bn,$a,yt,ut,zi=j(()=>{Pi(),Bn=(e,i)=>{(typeof gt.trace>"u"?!gt.wasm.trace:!gt.trace)||console.timeStamp(`${e}::ORT::${i}`)},$a=(e,i)=>{var c;let a=((c=new Error().stack)==null?void 0:c.split(/\r\n|\r|\n/g))||[],o=!1;for(let s=0;s<a.length;s++){if(o&&!a[s].includes("TRACE_FUNC")){let d=`FUNC_${e}::${a[s].trim().split(" ")[1]}`;i&&(d+=`::${i}`),Bn("CPU",d);return}a[s].includes("TRACE_FUNC")&&(o=!0)}},yt=e=>{(typeof gt.trace>"u"?!gt.wasm.trace:!gt.trace)||$a("BEGIN",e)},ut=e=>{(typeof gt.trace>"u"?!gt.wasm.trace:!gt.trace)||$a("END",e)}}),Dn,_a=j(()=>{Pn(),zn(),zi(),Dn=class Gx{constructor(i){this.handler=i}async run(i,a,o){yt();let c={},s={};if(typeof i!="object"||i===null||i instanceof tt||Array.isArray(i))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let d=!0;if(typeof a=="object"){if(a===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(a instanceof tt)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(a)){if(a.length===0)throw new TypeError("'fetches' cannot be an empty array.");d=!1;for(let h of a){if(typeof h!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(h)===-1)throw new RangeError(`'fetches' contains invalid output name: ${h}.`);c[h]=null}if(typeof o=="object"&&o!==null)s=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else{let h=!1,b=Object.getOwnPropertyNames(a);for(let g of this.outputNames)if(b.indexOf(g)!==-1){let st=a[g];(st===null||st instanceof tt)&&(h=!0,d=!1,c[g]=st)}if(h){if(typeof o=="object"&&o!==null)s=o;else if(typeof o<"u")throw new TypeError("'options' must be an object.")}else s=a}}else if(typeof a<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let h of this.inputNames)if(typeof i[h]>"u")throw new Error(`input '${h}' is missing in 'feeds'.`);if(d)for(let h of this.outputNames)c[h]=null;let $=await this.handler.run(i,c,s),et={};for(let h in $)if(Object.hasOwnProperty.call($,h)){let b=$[h];b instanceof tt?et[h]=b:et[h]=new tt(b.type,b.data,b.dims)}return ut(),et}async release(){return this.handler.dispose()}static async create(i,a,o,c){yt();let s,d={};if(typeof i=="string"){if(s=i,typeof a=="object"&&a!==null)d=a;else if(typeof a<"u")throw new TypeError("'options' must be an object.")}else if(i instanceof Uint8Array){if(s=i,typeof a=="object"&&a!==null)d=a;else if(typeof a<"u")throw new TypeError("'options' must be an object.")}else if(i instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&i instanceof SharedArrayBuffer){let b=i,g=0,st=i.byteLength;if(typeof a=="object"&&a!==null)d=a;else if(typeof a=="number"){if(g=a,!Number.isSafeInteger(g))throw new RangeError("'byteOffset' must be an integer.");if(g<0||g>=b.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${b.byteLength}).`);if(st=i.byteLength-g,typeof o=="number"){if(st=o,!Number.isSafeInteger(st))throw new RangeError("'byteLength' must be an integer.");if(st<=0||g+st>b.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${b.byteLength-g}].`);if(typeof c=="object"&&c!==null)d=c;else if(typeof c<"u")throw new TypeError("'options' must be an object.")}else if(typeof o<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof a<"u")throw new TypeError("'options' must be an object.");s=new Uint8Array(b,g,st)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[$,et]=await On(d),h=await $.createInferenceSessionHandler(s,et);return ut(),new Gx(h)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}}),uc,xa=j(()=>{_a(),uc=Dn}),Sa=j(()=>{}),Ca=j(()=>{}),Ia=j(()=>{}),Ta=j(()=>{}),lc,Mn,Aa=j(()=>{Pn(),zn(),lc="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",Mn=class Zx{constructor(i,a,o){this.handler=i,this.hasOptimizerModel=a,this.hasEvalModel=o}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static async create(i,a){let o=i.evalModel||"",c=i.optimizerModel||"",s=a||{},[d,$]=await On(s);if(d.createTrainingSessionHandler){let et=await d.createTrainingSessionHandler(i.checkpointState,i.trainModel,o,c,$);return new Zx(et,!!i.optimizerModel,!!i.evalModel)}else throw new Error(lc)}typeNarrowingForRunStep(i,a,o,c,s){let d={},$={};if(typeof o!="object"||o===null||o instanceof tt||Array.isArray(o))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let et=!0;if(typeof c=="object"){if(c===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(c instanceof tt)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(c)){if(c.length===0)throw new TypeError("'fetches' cannot be an empty array.");et=!1;for(let h of c){if(typeof h!="string")throw new TypeError("'fetches' must be a string array or an object.");if(a.indexOf(h)===-1)throw new RangeError(`'fetches' contains invalid output name: ${h}.`);d[h]=null}if(typeof s=="object"&&s!==null)$=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else{let h=!1,b=Object.getOwnPropertyNames(c);for(let g of a)if(b.indexOf(g)!==-1){let st=c[g];(st===null||st instanceof tt)&&(h=!0,et=!1,d[g]=st)}if(h){if(typeof s=="object"&&s!==null)$=s;else if(typeof s<"u")throw new TypeError("'options' must be an object.")}else $=c}}else if(typeof c<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let h of i)if(typeof o[h]>"u")throw new Error(`input '${h}' is missing in 'feeds'.`);if(et)for(let h of a)d[h]=null;return[d,$]}convertHandlerReturnTypeToMapOfTensors(i){let a={};for(let o in i)if(Object.hasOwnProperty.call(i,o)){let c=i[o];c instanceof tt?a[o]=c:a[o]=new tt(c.type,c.data,c.dims)}return a}async lazyResetGrad(){await this.handler.lazyResetGrad()}async runTrainStep(i,a,o){let[c,s]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,i,a,o),d=await this.handler.runTrainStep(i,c,s);return this.convertHandlerReturnTypeToMapOfTensors(d)}async runOptimizerStep(i){if(this.hasOptimizerModel)await this.handler.runOptimizerStep(i||{});else throw new Error("This TrainingSession has no OptimizerModel loaded.")}async runEvalStep(i,a,o){if(this.hasEvalModel){let[c,s]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,i,a,o),d=await this.handler.runEvalStep(i,c,s);return this.convertHandlerReturnTypeToMapOfTensors(d)}else throw new Error("This TrainingSession has no EvalModel loaded.")}async getParametersSize(i=!0){return this.handler.getParametersSize(i)}async loadParametersBuffer(i,a=!0){let o=await this.getParametersSize(a);if(i.length!==4*o)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(i,a)}async getContiguousParameters(i=!0){return this.handler.getContiguousParameters(i)}async release(){return this.handler.dispose()}}}),dc,Ea=j(()=>{Aa(),dc=Mn}),Bi={};kr(Bi,{InferenceSession:()=>uc,TRACE:()=>Bn,TRACE_FUNC_BEGIN:()=>yt,TRACE_FUNC_END:()=>ut,Tensor:()=>tt,TrainingSession:()=>dc,env:()=>ke,registerBackend:()=>lr});var _t=j(()=>{ra(),aa(),xa(),zn(),Sa(),Ca(),zi(),Ia(),Ta(),Ea()}),Di={};kr(Di,{createReadStream:()=>Oa,readFile:()=>cc,readFileSync:()=>pc});var cc,pc,Oa,Mi=j(()=>{cc=void 0,pc=void 0,Oa=void 0}),Ui={};kr(Ui,{join:()=>mc});var mc,Wi=j(()=>{mc=void 0}),za=Er((e,i)=>{var a=(()=>{var c;var o=typeof document<"u"?(c=document.currentScript)==null?void 0:c.src:void 0;return typeof __filename<"u"&&(o||(o=__filename)),function(s={}){var d=s,$,et,h=new Promise((wt,jt)=>{$=wt,et=jt});d.mountExternalData=(wt,jt)=>{(d.eb||(d.eb=new Map)).set(wt,jt)},d.unmountExternalData=()=>{delete d.eb};let b=()=>{let wt=(tr,or,qr)=>(...Tn)=>{let o0=Ey,h0=or==null?void 0:or();Tn=tr(...Tn);let b0=or==null?void 0:or();return h0!==b0&&(tr=b0,qr(h0),or=qr=null),Ey!=o0?yv():Tn},jt=tr=>async(...or)=>{var qr;try{if(d.cb)throw Error("Session already started");let Tn=d.cb={xb:or[0],errors:[]},o0=await tr(...or);if(d.cb!==Tn)throw Error("Session mismatch");(qr=d.kb)==null||qr.flush();let h0=Tn.errors;if(0<h0.length){let b0=await Promise.all(h0);if(b0=b0.filter(y0=>y0),0<b0.length)throw Error(b0.join(`
`))}return o0}finally{d.cb=null}};d._OrtCreateSession=wt(d._OrtCreateSession,()=>d._OrtCreateSession,tr=>d._OrtCreateSession=tr),d._OrtRun=jt(wt(d._OrtRun,()=>d._OrtRun,tr=>d._OrtRun=tr)),d._OrtRunWithBinding=jt(wt(d._OrtRunWithBinding,()=>d._OrtRunWithBinding,tr=>d._OrtRunWithBinding=tr)),d._OrtBindInput=wt(d._OrtBindInput,()=>d._OrtBindInput,tr=>d._OrtBindInput=tr),b=void 0};d.jsepInit=(wt,jt)=>{if(b==null||b(),wt==="webgpu"){[d.kb,d.pb,d.tb,d.lb,d.sb,d.Ra,d.ub,d.wb,d.qb,d.rb,d.vb]=jt;let tr=d.kb;d.jsepRegisterBuffer=(or,qr,Tn,o0)=>tr.registerBuffer(or,qr,Tn,o0),d.jsepGetBuffer=or=>tr.getBuffer(or),d.jsepCreateDownloader=(or,qr,Tn)=>tr.createDownloader(or,qr,Tn),d.jsepOnReleaseSession=or=>{tr.onReleaseSession(or)},d.jsepOnRunStart=or=>tr.onRunStart(or)}};var g=Object.assign({},d),st="./this.program",$t=(wt,jt)=>{throw jt},vt=typeof window=="object",Ft=typeof importScripts=="function",Gt=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",qt="",Lt,rr,jr;if(Gt){var Hr=(Mi(),sr(Di)),wn=(Wi(),sr(Ui));qt=Ft?wn.dirname(qt)+"/":__dirname+"/",Lt=(wt,jt)=>(wt=hy(wt)?new URL(wt):wn.normalize(wt),Hr.readFileSync(wt,jt?void 0:"utf8")),jr=wt=>(wt=Lt(wt,!0),wt.buffer||(wt=new Uint8Array(wt)),wt),rr=(wt,jt,tr,or=!0)=>{wt=hy(wt)?new URL(wt):wn.normalize(wt),Hr.readFile(wt,or?void 0:"utf8",(qr,Tn)=>{qr?tr(qr):jt(or?Tn.buffer:Tn)})},!d.thisProgram&&1<process.argv.length&&(st=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),$t=(wt,jt)=>{throw process.exitCode=wt,jt}}else(vt||Ft)&&(Ft?qt=self.location.href:typeof document<"u"&&document.currentScript&&(qt=document.currentScript.src),o&&(qt=o),qt.startsWith("blob:")?qt="":qt=qt.substr(0,qt.replace(/[?#].*/,"").lastIndexOf("/")+1),Lt=wt=>{var jt=new XMLHttpRequest;return jt.open("GET",wt,!1),jt.send(null),jt.responseText},Ft&&(jr=wt=>{var jt=new XMLHttpRequest;return jt.open("GET",wt,!1),jt.responseType="arraybuffer",jt.send(null),new Uint8Array(jt.response)}),rr=(wt,jt,tr)=>{var or=new XMLHttpRequest;or.open("GET",wt,!0),or.responseType="arraybuffer",or.onload=()=>{or.status==200||or.status==0&&or.response?jt(or.response):tr()},or.onerror=tr,or.send(null)});var _n=console.log.bind(console),No=console.error.bind(console);Object.assign(d,g),g=null;var Qo,Xo=!1,l0,v0,x0,D0,M0,Mo,e0,Sn,t0,d0,xn;function f0(){var wt=Qo.buffer;d.HEAP8=v0=new Int8Array(wt),d.HEAP16=D0=new Int16Array(wt),d.HEAPU8=x0=new Uint8Array(wt),d.HEAPU16=M0=new Uint16Array(wt),d.HEAP32=Mo=new Int32Array(wt),d.HEAPU32=e0=new Uint32Array(wt),d.HEAPF32=Sn=new Float32Array(wt),d.HEAPF64=xn=new Float64Array(wt),d.HEAP64=t0=new BigInt64Array(wt),d.HEAPU64=d0=new BigUint64Array(wt)}var $0=[],N0=[],j0=[],Z0=0,fy=null;function oy(wt){throw wt="Aborted("+wt+")",No(wt),Xo=!0,l0=1,wt=new WebAssembly.RuntimeError(wt+". Build with -sASSERTIONS for more info."),et(wt),wt}var gy=wt=>wt.startsWith("data:application/octet-stream;base64,"),hy=wt=>wt.startsWith("file://"),J0;if(J0="ort-wasm-simd.wasm",!gy(J0)){var H0=J0;J0=d.locateFile?d.locateFile(H0,qt):qt+H0}function yy(wt){if(jr)return jr(wt);throw"both async and sync fetching of the wasm failed"}function vy(wt){if(vt||Ft){if(typeof fetch=="function"&&!hy(wt))return fetch(wt,{credentials:"same-origin"}).then(jt=>{if(!jt.ok)throw`failed to load wasm binary file at '${wt}'`;return jt.arrayBuffer()}).catch(()=>yy(wt));if(rr)return new Promise((jt,tr)=>{rr(wt,or=>jt(new Uint8Array(or)),tr)})}return Promise.resolve().then(()=>yy(wt))}function $y(wt,jt,tr){return vy(wt).then(or=>WebAssembly.instantiate(or,jt)).then(tr,or=>{No(`failed to asynchronously prepare wasm: ${or}`),oy(or)})}function o1(wt,jt){var tr=J0;return typeof WebAssembly.instantiateStreaming!="function"||gy(tr)||hy(tr)||Gt||typeof fetch!="function"?$y(tr,wt,jt):fetch(tr,{credentials:"same-origin"}).then(or=>WebAssembly.instantiateStreaming(or,wt).then(jt,function(qr){return No(`wasm streaming compile failed: ${qr}`),No("falling back to ArrayBuffer instantiation"),$y(tr,wt,jt)}))}var _y={824920:(wt,jt,tr,or)=>{if(typeof d>"u"||!d.eb)return 1;if(wt=py(wt>>>0),wt.startsWith("./")&&(wt=wt.substring(2)),wt=d.eb.get(wt),!wt)return 2;if(jt>>>=0,tr>>>=0,jt+tr>wt.byteLength)return 3;try{return x0.set(wt.subarray(jt,jt+tr),or>>>0>>>0),0}catch{return 4}},825421:()=>{d.qb()},825452:()=>{d.rb()},825481:()=>{d.vb()},825506:wt=>d.pb(wt),825539:wt=>d.tb(wt),825571:(wt,jt,tr)=>{d.lb(wt,jt,tr,!0)},825610:(wt,jt,tr)=>{d.lb(wt,jt,tr)},825643:wt=>{d.Ra("Abs",wt,void 0)},825694:wt=>{d.Ra("Neg",wt,void 0)},825745:wt=>{d.Ra("Floor",wt,void 0)},825798:wt=>{d.Ra("Ceil",wt,void 0)},825850:wt=>{d.Ra("Reciprocal",wt,void 0)},825908:wt=>{d.Ra("Sqrt",wt,void 0)},825960:wt=>{d.Ra("Exp",wt,void 0)},826011:wt=>{d.Ra("Erf",wt,void 0)},826062:wt=>{d.Ra("Sigmoid",wt,void 0)},826117:(wt,jt,tr)=>{d.Ra("HardSigmoid",wt,{alpha:jt,beta:tr})},826196:wt=>{d.Ra("Log",wt,void 0)},826247:wt=>{d.Ra("Sin",wt,void 0)},826298:wt=>{d.Ra("Cos",wt,void 0)},826349:wt=>{d.Ra("Tan",wt,void 0)},826400:wt=>{d.Ra("Asin",wt,void 0)},826452:wt=>{d.Ra("Acos",wt,void 0)},826504:wt=>{d.Ra("Atan",wt,void 0)},826556:wt=>{d.Ra("Sinh",wt,void 0)},826608:wt=>{d.Ra("Cosh",wt,void 0)},826660:wt=>{d.Ra("Asinh",wt,void 0)},826713:wt=>{d.Ra("Acosh",wt,void 0)},826766:wt=>{d.Ra("Atanh",wt,void 0)},826819:wt=>{d.Ra("Tanh",wt,void 0)},826871:wt=>{d.Ra("Not",wt,void 0)},826922:(wt,jt,tr)=>{d.Ra("Clip",wt,{min:jt,max:tr})},826991:wt=>{d.Ra("Clip",wt,void 0)},827043:(wt,jt)=>{d.Ra("Elu",wt,{alpha:jt})},827101:wt=>{d.Ra("Relu",wt,void 0)},827153:(wt,jt)=>{d.Ra("LeakyRelu",wt,{alpha:jt})},827217:(wt,jt)=>{d.Ra("ThresholdedRelu",wt,{alpha:jt})},827287:(wt,jt)=>{d.Ra("Cast",wt,{to:jt})},827345:wt=>{d.Ra("Add",wt,void 0)},827396:wt=>{d.Ra("Sub",wt,void 0)},827447:wt=>{d.Ra("Mul",wt,void 0)},827498:wt=>{d.Ra("Div",wt,void 0)},827549:wt=>{d.Ra("Pow",wt,void 0)},827600:wt=>{d.Ra("Equal",wt,void 0)},827653:wt=>{d.Ra("Greater",wt,void 0)},827708:wt=>{d.Ra("GreaterOrEqual",wt,void 0)},827770:wt=>{d.Ra("Less",wt,void 0)},827822:wt=>{d.Ra("LessOrEqual",wt,void 0)},827881:(wt,jt,tr,or,qr)=>{d.Ra("ReduceMean",wt,{keepDims:!!jt,noopWithEmptyAxes:!!tr,axes:or?Array.from(Mo.subarray(or>>>0,qr>>>0)):[]})},828040:(wt,jt,tr,or,qr)=>{d.Ra("ReduceMax",wt,{keepDims:!!jt,noopWithEmptyAxes:!!tr,axes:or?Array.from(Mo.subarray(or>>>0,qr>>>0)):[]})},828198:(wt,jt,tr,or,qr)=>{d.Ra("ReduceMin",wt,{keepDims:!!jt,noopWithEmptyAxes:!!tr,axes:or?Array.from(Mo.subarray(or>>>0,qr>>>0)):[]})},828356:(wt,jt,tr,or,qr)=>{d.Ra("ReduceProd",wt,{keepDims:!!jt,noopWithEmptyAxes:!!tr,axes:or?Array.from(Mo.subarray(or>>>0,qr>>>0)):[]})},828515:(wt,jt,tr,or,qr)=>{d.Ra("ReduceSum",wt,{keepDims:!!jt,noopWithEmptyAxes:!!tr,axes:or?Array.from(Mo.subarray(or>>>0,qr>>>0)):[]})},828673:(wt,jt,tr,or,qr)=>{d.Ra("ReduceL1",wt,{keepDims:!!jt,noopWithEmptyAxes:!!tr,axes:or?Array.from(Mo.subarray(or>>>0,qr>>>0)):[]})},828830:(wt,jt,tr,or,qr)=>{d.Ra("ReduceL2",wt,{keepDims:!!jt,noopWithEmptyAxes:!!tr,axes:or?Array.from(Mo.subarray(or>>>0,qr>>>0)):[]})},828987:(wt,jt,tr,or,qr)=>{d.Ra("ReduceLogSum",wt,{keepDims:!!jt,noopWithEmptyAxes:!!tr,axes:or?Array.from(Mo.subarray(or>>>0,qr>>>0)):[]})},829148:(wt,jt,tr,or,qr)=>{d.Ra("ReduceSumSquare",wt,{keepDims:!!jt,noopWithEmptyAxes:!!tr,axes:or?Array.from(Mo.subarray(or>>>0,qr>>>0)):[]})},829312:(wt,jt,tr,or,qr)=>{d.Ra("ReduceLogSumExp",wt,{keepDims:!!jt,noopWithEmptyAxes:!!tr,axes:or?Array.from(Mo.subarray(or>>>0,qr>>>0)):[]})},829476:wt=>{d.Ra("Where",wt,void 0)},829529:(wt,jt,tr)=>{d.Ra("Transpose",wt,{perm:jt?Array.from(Mo.subarray(jt>>>0,tr>>>0)):[]})},829637:(wt,jt,tr,or)=>{d.Ra("DepthToSpace",wt,{blocksize:jt,mode:py(tr),format:or?"NHWC":"NCHW"})},829770:(wt,jt,tr,or)=>{d.Ra("DepthToSpace",wt,{blocksize:jt,mode:py(tr),format:or?"NHWC":"NCHW"})},829903:(wt,jt,tr,or,qr,Tn,o0,h0,b0,y0,R0,ry,Go,Uo,S0)=>{d.Ra("ConvTranspose",wt,{format:b0?"NHWC":"NCHW",autoPad:jt,dilations:[tr],group:or,kernelShape:[qr],pads:[Tn,o0],strides:[h0],wIsConst:()=>!!v0[y0>>>0],outputPadding:R0?Array.from(Mo.subarray(R0>>>0,ry>>>0)):[],outputShape:Go?Array.from(Mo.subarray(Go>>>0,Uo>>>0)):[],activation:py(S0)})},830304:(wt,jt,tr,or,qr,Tn,o0,h0,b0,y0,R0,ry,Go,Uo)=>{d.Ra("ConvTranspose",wt,{format:h0?"NHWC":"NCHW",autoPad:jt,dilations:Array.from(Mo.subarray(tr>>>0,(tr>>>0)+2>>>0)),group:or,kernelShape:Array.from(Mo.subarray(qr>>>0,(qr>>>0)+2>>>0)),pads:Array.from(Mo.subarray(Tn>>>0,(Tn>>>0)+4>>>0)),strides:Array.from(Mo.subarray(o0>>>0,(o0>>>0)+2>>>0)),wIsConst:()=>!!v0[b0>>>0],outputPadding:y0?Array.from(Mo.subarray(y0>>>0,R0>>>0)):[],outputShape:ry?Array.from(Mo.subarray(ry>>>0,Go>>>0)):[],activation:py(Uo)})},830869:(wt,jt,tr,or,qr,Tn,o0,h0,b0,y0,R0,ry,Go,Uo,S0)=>{d.Ra("ConvTranspose",wt,{format:b0?"NHWC":"NCHW",autoPad:jt,dilations:[tr],group:or,kernelShape:[qr],pads:[Tn,o0],strides:[h0],wIsConst:()=>!!v0[y0>>>0],outputPadding:R0?Array.from(Mo.subarray(R0>>>0,ry>>>0)):[],outputShape:Go?Array.from(Mo.subarray(Go>>>0,Uo>>>0)):[],activation:py(S0)})},831270:(wt,jt,tr,or,qr,Tn,o0,h0,b0,y0,R0,ry,Go,Uo)=>{d.Ra("ConvTranspose",wt,{format:h0?"NHWC":"NCHW",autoPad:jt,dilations:Array.from(Mo.subarray(tr>>>0,(tr>>>0)+2>>>0)),group:or,kernelShape:Array.from(Mo.subarray(qr>>>0,(qr>>>0)+2>>>0)),pads:Array.from(Mo.subarray(Tn>>>0,(Tn>>>0)+4>>>0)),strides:Array.from(Mo.subarray(o0>>>0,(o0>>>0)+2>>>0)),wIsConst:()=>!!v0[b0>>>0],outputPadding:y0?Array.from(Mo.subarray(y0>>>0,R0>>>0)):[],outputShape:ry?Array.from(Mo.subarray(ry>>>0,Go>>>0)):[],activation:py(Uo)})},831835:(wt,jt)=>{d.Ra("GlobalAveragePool",wt,{format:jt?"NHWC":"NCHW"})},831926:(wt,jt,tr,or,qr,Tn,o0,h0,b0,y0,R0,ry,Go,Uo,S0,E0)=>{d.Ra("AveragePool",wt,{format:E0?"NHWC":"NCHW",auto_pad:jt,ceil_mode:tr,count_include_pad:or,storage_order:qr,dilations:[Tn,o0],kernel_shape:[h0,b0],pads:[y0,R0,ry,Go],strides:[Uo,S0]})},832210:(wt,jt)=>{d.Ra("GlobalAveragePool",wt,{format:jt?"NHWC":"NCHW"})},832301:(wt,jt,tr,or,qr,Tn,o0,h0,b0,y0,R0,ry,Go,Uo,S0,E0)=>{d.Ra("AveragePool",wt,{format:E0?"NHWC":"NCHW",auto_pad:jt,ceil_mode:tr,count_include_pad:or,storage_order:qr,dilations:[Tn,o0],kernel_shape:[h0,b0],pads:[y0,R0,ry,Go],strides:[Uo,S0]})},832585:(wt,jt)=>{d.Ra("GlobalMaxPool",wt,{format:jt?"NHWC":"NCHW"})},832672:(wt,jt,tr,or,qr,Tn,o0,h0,b0,y0,R0,ry,Go,Uo,S0,E0)=>{d.Ra("MaxPool",wt,{format:E0?"NHWC":"NCHW",auto_pad:jt,ceil_mode:tr,count_include_pad:or,storage_order:qr,dilations:[Tn,o0],kernel_shape:[h0,b0],pads:[y0,R0,ry,Go],strides:[Uo,S0]})},832952:(wt,jt)=>{d.Ra("GlobalMaxPool",wt,{format:jt?"NHWC":"NCHW"})},833039:(wt,jt,tr,or,qr,Tn,o0,h0,b0,y0,R0,ry,Go,Uo,S0,E0)=>{d.Ra("MaxPool",wt,{format:E0?"NHWC":"NCHW",auto_pad:jt,ceil_mode:tr,count_include_pad:or,storage_order:qr,dilations:[Tn,o0],kernel_shape:[h0,b0],pads:[y0,R0,ry,Go],strides:[Uo,S0]})},833319:(wt,jt,tr,or,qr)=>{d.Ra("Gemm",wt,{alpha:jt,beta:tr,transA:or,transB:qr})},833423:wt=>{d.Ra("MatMul",wt,void 0)},833477:(wt,jt,tr,or)=>{d.Ra("ArgMax",wt,{keepDims:!!jt,selectLastIndex:!!tr,axis:or})},833585:(wt,jt,tr,or)=>{d.Ra("ArgMin",wt,{keepDims:!!jt,selectLastIndex:!!tr,axis:or})},833693:(wt,jt)=>{d.Ra("Softmax",wt,{axis:jt})},833756:(wt,jt)=>{d.Ra("Concat",wt,{axis:jt})},833816:(wt,jt,tr,or,qr)=>{d.Ra("Split",wt,{axis:jt,numOutputs:tr,splitSizes:or?Array.from(Mo.subarray(or>>>0,qr>>>0)):[]})},833956:wt=>{d.Ra("Expand",wt,void 0)},834010:(wt,jt)=>{d.Ra("Gather",wt,{axis:Number(jt)})},834081:(wt,jt)=>{d.Ra("GatherElements",wt,{axis:Number(jt)})},834160:(wt,jt,tr,or,qr,Tn,o0,h0,b0,y0,R0)=>{d.Ra("Resize",wt,{antialias:jt,axes:tr?Array.from(Mo.subarray(tr>>>0,or>>>0)):[],coordinateTransformMode:py(qr),cubicCoeffA:Tn,excludeOutside:o0,extrapolationValue:h0,keepAspectRatioPolicy:py(b0),mode:py(y0),nearestMode:py(R0)})},834506:(wt,jt,tr,or,qr,Tn,o0)=>{d.Ra("Slice",wt,{starts:jt?Array.from(Mo.subarray(jt>>>0,tr>>>0)):[],ends:or?Array.from(Mo.subarray(or>>>0,qr>>>0)):[],axes:Tn?Array.from(Mo.subarray(Tn>>>0,o0>>>0)):[]})},834722:wt=>{d.Ra("Tile",wt,void 0)},834774:(wt,jt,tr,or)=>{d.Ra("LayerNormalization",wt,{axis:jt,epsilon:tr,simplified:!!or})},834885:(wt,jt,tr)=>{d.Ra("InstanceNormalization",wt,{epsilon:jt,format:tr?"NHWC":"NCHW"})},834999:(wt,jt,tr)=>{d.Ra("InstanceNormalization",wt,{epsilon:jt,format:tr?"NHWC":"NCHW"})},835113:wt=>{d.Ra("Range",wt,void 0)},835166:(wt,jt)=>{d.Ra("Einsum",wt,{equation:py(jt)})},835247:(wt,jt,tr,or,qr)=>{d.Ra("Pad",wt,{mode:jt,value:tr,pads:or?Array.from(Mo.subarray(or>>>0,qr>>>0)):[]})},835374:(wt,jt,tr,or,qr,Tn)=>{d.Ra("BatchNormalization",wt,{epsilon:jt,momentum:tr,spatial:!!qr,trainingMode:!!or,format:Tn?"NHWC":"NCHW"})},835543:(wt,jt,tr,or,qr,Tn)=>{d.Ra("BatchNormalization",wt,{epsilon:jt,momentum:tr,spatial:!!qr,trainingMode:!!or,format:Tn?"NHWC":"NCHW"})},835712:(wt,jt,tr)=>{d.Ra("CumSum",wt,{exclusive:Number(jt),reverse:Number(tr)})},835809:(wt,jt,tr,or,qr,Tn,o0,h0,b0)=>{d.Ra("Attention",wt,{numHeads:jt,isUnidirectional:tr,maskFilterValue:or,scale:qr,doRotary:Tn,qkvHiddenSizes:o0?Array.from(Mo.subarray(Number(h0)>>>0,Number(h0)+o0>>>0)):[],pastPresentShareBuffer:!!b0})},836081:wt=>{d.Ra("BiasAdd",wt,void 0)},836136:wt=>{d.Ra("BiasSplitGelu",wt,void 0)},836197:wt=>{d.Ra("FastGelu",wt,void 0)},836253:(wt,jt,tr,or,qr,Tn,o0,h0,b0,y0,R0,ry,Go)=>{d.Ra("Conv",wt,{format:b0?"NHWC":"NCHW",auto_pad:jt,dilations:[tr],group:or,kernel_shape:[qr],pads:Tn?Array.from(Mo.subarray(Tn>>>0,o0>>>0)):[],strides:[h0],w_is_const:()=>!!v0[y0>>>0],activation:py(R0),activation_params:ry?Array.from(Sn.subarray(ry>>>0,Go>>>0)):[]})},836623:(wt,jt,tr,or,qr,Tn,o0,h0,b0,y0,R0,ry,Go,Uo,S0,E0)=>{d.Ra("Conv",wt,{format:ry?"NHWC":"NCHW",auto_pad:jt,dilations:[tr,or],group:qr,kernel_shape:[Tn,o0],pads:h0?Array.from(Mo.subarray(h0>>>0,b0>>>0)):[],strides:[y0,R0],w_is_const:()=>!!v0[Go>>>0],activation:py(Uo),activation_params:S0?Array.from(Sn.subarray(S0>>>0,E0>>>0)):[]})},837014:wt=>{d.Ra("Gelu",wt,void 0)},837066:(wt,jt,tr,or,qr,Tn)=>{d.Ra("MatMulNBits",wt,{k:jt,n:tr,accuracyLevel:or,bits:qr,blockSize:Tn})},837193:(wt,jt,tr,or,qr,Tn)=>{d.Ra("MultiHeadAttention",wt,{numHeads:jt,isUnidirectional:tr,maskFilterValue:or,scale:qr,doRotary:Tn})},837352:(wt,jt,tr,or,qr)=>{d.Ra("RotaryEmbedding",wt,{interleaved:!!jt,numHeads:tr,rotaryEmbeddingDim:or,scale:qr})},837491:(wt,jt,tr)=>{d.Ra("SkipLayerNormalization",wt,{epsilon:jt,simplified:!!tr})},837593:(wt,jt,tr)=>{d.Ra("SkipLayerNormalization",wt,{epsilon:jt,simplified:!!tr})},837695:(wt,jt,tr,or)=>{d.Ra("LayerNormalization",wt,{axis:jt,epsilon:tr,simplified:!!or})},837806:wt=>{d.ub(wt)},837840:(wt,jt)=>d.wb(wt,jt,d.cb.xb,d.cb.errors)};function Gy(wt){this.name="ExitStatus",this.message=`Program terminated with exit(${wt})`,this.status=wt}class fv{constructor(jt){this.hb=jt-24}}var Ly=0,Iy=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Ny=(wt,jt,tr)=>{jt>>>=0;var or=jt+tr;for(tr=jt;wt[tr]&&!(tr>=or);)++tr;if(16<tr-jt&&wt.buffer&&Iy)return Iy.decode(wt.subarray(jt,tr));for(or="";jt<tr;){var qr=wt[jt++];if(qr&128){var Tn=wt[jt++]&63;if((qr&224)==192)or+=String.fromCharCode((qr&31)<<6|Tn);else{var o0=wt[jt++]&63;qr=(qr&240)==224?(qr&15)<<12|Tn<<6|o0:(qr&7)<<18|Tn<<12|o0<<6|wt[jt++]&63,65536>qr?or+=String.fromCharCode(qr):(qr-=65536,or+=String.fromCharCode(55296|qr>>10,56320|qr&1023))}}else or+=String.fromCharCode(qr)}return or},py=(wt,jt)=>(wt>>>=0)?Ny(x0,wt,jt):"",n1=wt=>{for(var jt=0,tr=0;tr<wt.length;++tr){var or=wt.charCodeAt(tr);127>=or?jt++:2047>=or?jt+=2:55296<=or&&57343>=or?(jt+=4,++tr):jt+=3}return jt},Ay=(wt,jt,tr,or)=>{if(tr>>>=0,!(0<or))return 0;var qr=tr;or=tr+or-1;for(var Tn=0;Tn<wt.length;++Tn){var o0=wt.charCodeAt(Tn);if(55296<=o0&&57343>=o0){var h0=wt.charCodeAt(++Tn);o0=65536+((o0&1023)<<10)|h0&1023}if(127>=o0){if(tr>=or)break;jt[tr++>>>0]=o0}else{if(2047>=o0){if(tr+1>=or)break;jt[tr++>>>0]=192|o0>>6}else{if(65535>=o0){if(tr+2>=or)break;jt[tr++>>>0]=224|o0>>12}else{if(tr+3>=or)break;jt[tr++>>>0]=240|o0>>18,jt[tr++>>>0]=128|o0>>12&63}jt[tr++>>>0]=128|o0>>6&63}jt[tr++>>>0]=128|o0&63}}return jt[tr>>>0]=0,tr-qr},s1,xy=wt=>{for(var jt="";x0[wt>>>0];)jt+=s1[x0[wt++>>>0]];return jt},u1={},ay={},qy;function L0(wt,jt,tr={}){var or=jt.name;if(!wt)throw new qy(`type "${or}" must have a positive integer typeid pointer`);if(ay.hasOwnProperty(wt)){if(tr.nb)return;throw new qy(`Cannot register type '${or}' twice`)}ay[wt]=jt,u1.hasOwnProperty(wt)&&(jt=u1[wt],delete u1[wt],jt.forEach(qr=>qr()))}function Dy(wt,jt,tr={}){if(!("argPackAdvance"in jt))throw new TypeError("registerType registeredInstance requires argPackAdvance");return L0(wt,jt,tr)}var l1=(wt,jt,tr)=>{switch(jt){case 1:return tr?or=>v0[or>>>0]:or=>x0[or>>>0];case 2:return tr?or=>D0[or>>>1>>>0]:or=>M0[or>>>1>>>0];case 4:return tr?or=>Mo[or>>>2>>>0]:or=>e0[or>>>2>>>0];case 8:return tr?or=>t0[or>>>3]:or=>d0[or>>>3];default:throw new TypeError(`invalid integer width (${jt}): ${wt}`)}},g1=[],T0=[];function d1(wt){wt>>>=0,9<wt&&--T0[wt+1]===0&&(T0[wt]=void 0,g1.push(wt))}var U0=wt=>{if(!wt)throw new qy("Cannot use deleted val. handle = "+wt);return T0[wt]},Py=wt=>{switch(wt){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let jt=g1.pop()||T0.length;return T0[jt]=wt,T0[jt+1]=1,jt}};function Yr(wt){return this.fromWireType(e0[wt>>>2>>>0])}var Ro={name:"emscripten::val",fromWireType:wt=>{var jt=U0(wt);return d1(wt),jt},toWireType:(wt,jt)=>Py(jt),argPackAdvance:8,readValueFromPointer:Yr,bb:null},Bo=(wt,jt)=>{switch(jt){case 4:return function(tr){return this.fromWireType(Sn[tr>>>2>>>0])};case 8:return function(tr){return this.fromWireType(xn[tr>>>3>>>0])};default:throw new TypeError(`invalid float width (${jt}): ${wt}`)}},a0=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,u0=(wt,jt)=>{for(var tr=wt>>1,or=tr+jt/2;!(tr>=or)&&M0[tr>>>0];)++tr;if(tr<<=1,32<tr-wt&&a0)return a0.decode(x0.subarray(wt>>>0,tr>>>0));for(tr="",or=0;!(or>=jt/2);++or){var qr=D0[wt+2*or>>>1>>>0];if(qr==0)break;tr+=String.fromCharCode(qr)}return tr},O0=(wt,jt,tr)=>{if(tr??(tr=2147483647),2>tr)return 0;tr-=2;var or=jt;tr=tr<2*wt.length?tr/2:wt.length;for(var qr=0;qr<tr;++qr)D0[jt>>>1>>>0]=wt.charCodeAt(qr),jt+=2;return D0[jt>>>1>>>0]=0,jt-or},G0=wt=>2*wt.length,Cy=(wt,jt)=>{for(var tr=0,or="";!(tr>=jt/4);){var qr=Mo[wt+4*tr>>>2>>>0];if(qr==0)break;++tr,65536<=qr?(qr-=65536,or+=String.fromCharCode(55296|qr>>10,56320|qr&1023)):or+=String.fromCharCode(qr)}return or},Uy=(wt,jt,tr)=>{if(jt>>>=0,tr??(tr=2147483647),4>tr)return 0;var or=jt;tr=or+tr-4;for(var qr=0;qr<wt.length;++qr){var Tn=wt.charCodeAt(qr);if(55296<=Tn&&57343>=Tn){var o0=wt.charCodeAt(++qr);Tn=65536+((Tn&1023)<<10)|o0&1023}if(Mo[jt>>>2>>>0]=Tn,jt+=4,jt+4>tr)break}return Mo[jt>>>2>>>0]=0,jt-or},Ry=wt=>{for(var jt=0,tr=0;tr<wt.length;++tr){var or=wt.charCodeAt(tr);55296<=or&&57343>=or&&++tr,jt+=4}return jt},Oy=(wt,jt)=>{var tr=ay[wt];if(tr===void 0)throw wt=av(wt),tr=xy(wt),Fy(wt),new qy(`${jt} has unknown type ${tr}`);return tr},P1=(wt,jt,tr)=>{var or=[];return wt=wt.toWireType(or,tr),or.length&&(e0[jt>>>2>>>0]=Py(or)),wt},Zy=wt=>{try{wt()}catch(jt){oy(jt)}},_g=wt=>{var jt;if(!Xo)try{wt();try{l0=l0=wt=l0,(jt=d.onExit)==null||jt.call(d,wt),Xo=!0,$t(wt,new Gy(wt))}catch(tr){tr instanceof Gy||tr=="unwind"||$t(1,tr)}}catch(tr){tr instanceof Gy||tr=="unwind"||$t(1,tr)}};function ey(){var wt=z0,jt={};for(let[tr,or]of Object.entries(wt))jt[tr]=typeof or=="function"?(...qr)=>{c1.push(tr);try{return or(...qr)}finally{Xo||(c1.pop(),Ey&&ty===1&&c1.length===0&&(ty=0,Zy(ov),typeof Fibers<"u"&&Fibers.Db()))}}:or;return jt}var ty=0,Ey=null,R1=0,c1=[],hv={},mv={},kv=0,Q1=null,gv=[];function yv(){return new Promise((wt,jt)=>{Q1={resolve:wt,reject:jt}})}function J1(){var wt=f1(65548),jt=wt+12;e0[wt>>>2>>>0]=jt,e0[wt+4>>>2>>>0]=jt+65536,jt=c1[0];var tr=hv[jt];return tr===void 0&&(tr=kv++,hv[jt]=tr,mv[tr]=jt),Mo[wt+8>>>2>>>0]=tr,wt}function vv(wt){if(!Xo){if(ty===0){var jt=!1,tr=!1;wt((or=0)=>{if(!Xo&&(R1=or,jt=!0,tr)){ty=2,Zy(()=>t1(Ey)),typeof Browser<"u"&&Browser.ib.mb&&Browser.ib.resume(),or=!1;try{var qr=(0,z0[mv[Mo[Ey+8>>>2>>>0]]])()}catch(h0){qr=h0,or=!0}var Tn=!1;if(!Ey){var o0=Q1;o0&&(Q1=null,(or?o0.reject:o0.resolve)(qr),Tn=!0)}if(or&&!Tn)throw qr}}),tr=!0,jt||(ty=1,Ey=J1(),typeof Browser<"u"&&Browser.ib.mb&&Browser.ib.pause(),Zy(()=>Yy(Ey)))}else ty===2?(ty=0,Zy(i1),Fy(Ey),Ey=null,gv.forEach(_g)):oy(`invalid state: ${ty}`);return R1}}function T1(wt){return vv(jt=>{wt().then(jt)})}var U1=[],Iv={},S1=wt=>{var jt=Iv[wt];return jt===void 0?xy(wt):jt},Jy=()=>typeof globalThis=="object"?globalThis:Function("return this")(),E1=wt=>{var jt=U1.length;return U1.push(wt),jt},ev=(wt,jt)=>{for(var tr=Array(wt),or=0;or<wt;++or)tr[or]=Oy(e0[jt+4*or>>>2>>>0],"parameter "+or);return tr},p1=(wt,jt)=>Object.defineProperty(jt,"name",{value:wt});function Cv(wt){var jt=Function;if(!(jt instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof jt} which is not a function`);var tr=p1(jt.name||"unknownFunctionName",function(){});return tr.prototype=jt.prototype,tr=new tr,wt=jt.apply(tr,wt),wt instanceof Object?wt:tr}var zy=wt=>wt%4===0&&(wt%100!==0||wt%400===0),tv=[0,31,60,91,121,152,182,213,244,274,305,335],F1=[0,31,59,90,120,151,181,212,243,273,304,334],e1=[],rv=(wt,jt)=>{e1.length=0;for(var tr;tr=x0[wt++>>>0];){var or=tr!=105;or&=tr!=112,jt+=or&&jt%8?4:0,e1.push(tr==112?e0[jt>>>2>>>0]:tr==106?t0[jt>>>3]:tr==105?Mo[jt>>>2>>>0]:xn[jt>>>3>>>0]),jt+=or?8:4}return e1},jy={},Ky=()=>{if(!D1){var wt={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:st||"./this.program"},jt;for(jt in jy)jy[jt]===void 0?delete wt[jt]:wt[jt]=jy[jt];var tr=[];for(jt in wt)tr.push(`${jt}=${wt[jt]}`);D1=tr}return D1},D1,Ov=[null,[],[]],Av=[31,29,31,30,31,30,31,31,30,31,30,31],nv=[31,28,31,30,31,30,31,31,30,31,30,31];function Wv(wt){var jt=Array(n1(wt)+1);return Ay(wt,jt,0,jt.length),jt}function Pv(wt,jt,tr,or){function qr(Uo,S0,E0){for(Uo=typeof Uo=="number"?Uo.toString():Uo||"";Uo.length<S0;)Uo=E0[0]+Uo;return Uo}function Tn(Uo,S0){return qr(Uo,S0,"0")}function o0(Uo,S0){function E0(sv){return 0>sv?-1:0<sv?1:0}var ny;return(ny=E0(Uo.getFullYear()-S0.getFullYear()))===0&&(ny=E0(Uo.getMonth()-S0.getMonth()))===0&&(ny=E0(Uo.getDate()-S0.getDate())),ny}function h0(Uo){switch(Uo.getDay()){case 0:return new Date(Uo.getFullYear()-1,11,29);case 1:return Uo;case 2:return new Date(Uo.getFullYear(),0,3);case 3:return new Date(Uo.getFullYear(),0,2);case 4:return new Date(Uo.getFullYear(),0,1);case 5:return new Date(Uo.getFullYear()-1,11,31);case 6:return new Date(Uo.getFullYear()-1,11,30)}}function b0(Uo){var S0=Uo.$a;for(Uo=new Date(new Date(Uo.ab+1900,0,1).getTime());0<S0;){var E0=Uo.getMonth(),ny=(zy(Uo.getFullYear())?Av:nv)[E0];if(S0>ny-Uo.getDate())S0-=ny-Uo.getDate()+1,Uo.setDate(1),11>E0?Uo.setMonth(E0+1):(Uo.setMonth(0),Uo.setFullYear(Uo.getFullYear()+1));else{Uo.setDate(Uo.getDate()+S0);break}}return E0=new Date(Uo.getFullYear()+1,0,4),S0=h0(new Date(Uo.getFullYear(),0,4)),E0=h0(E0),0>=o0(S0,Uo)?0>=o0(E0,Uo)?Uo.getFullYear()+1:Uo.getFullYear():Uo.getFullYear()-1}wt>>>=0,jt>>>=0,tr>>>=0,or>>>=0;var y0=e0[or+40>>>2>>>0];or={Ab:Mo[or>>>2>>>0],zb:Mo[or+4>>>2>>>0],fb:Mo[or+8>>>2>>>0],jb:Mo[or+12>>>2>>>0],gb:Mo[or+16>>>2>>>0],ab:Mo[or+20>>>2>>>0],Va:Mo[or+24>>>2>>>0],$a:Mo[or+28>>>2>>>0],Cb:Mo[or+32>>>2>>>0],yb:Mo[or+36>>>2>>>0],Bb:y0?py(y0):""},tr=py(tr),y0={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var R0 in y0)tr=tr.replace(new RegExp(R0,"g"),y0[R0]);var ry="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Go="January February March April May June July August September October November December".split(" ");y0={"%a":Uo=>ry[Uo.Va].substring(0,3),"%A":Uo=>ry[Uo.Va],"%b":Uo=>Go[Uo.gb].substring(0,3),"%B":Uo=>Go[Uo.gb],"%C":Uo=>Tn((Uo.ab+1900)/100|0,2),"%d":Uo=>Tn(Uo.jb,2),"%e":Uo=>qr(Uo.jb,2," "),"%g":Uo=>b0(Uo).toString().substring(2),"%G":b0,"%H":Uo=>Tn(Uo.fb,2),"%I":Uo=>(Uo=Uo.fb,Uo==0?Uo=12:12<Uo&&(Uo-=12),Tn(Uo,2)),"%j":Uo=>{for(var S0=0,E0=0;E0<=Uo.gb-1;S0+=(zy(Uo.ab+1900)?Av:nv)[E0++]);return Tn(Uo.jb+S0,3)},"%m":Uo=>Tn(Uo.gb+1,2),"%M":Uo=>Tn(Uo.zb,2),"%n":()=>`
`,"%p":Uo=>0<=Uo.fb&&12>Uo.fb?"AM":"PM","%S":Uo=>Tn(Uo.Ab,2),"%t":()=>"	","%u":Uo=>Uo.Va||7,"%U":Uo=>Tn(Math.floor((Uo.$a+7-Uo.Va)/7),2),"%V":Uo=>{var S0=Math.floor((Uo.$a+7-(Uo.Va+6)%7)/7);if(2>=(Uo.Va+371-Uo.$a-2)%7&&S0++,S0)S0==53&&(E0=(Uo.Va+371-Uo.$a)%7,E0==4||E0==3&&zy(Uo.ab)||(S0=1));else{S0=52;var E0=(Uo.Va+7-Uo.$a-1)%7;(E0==4||E0==5&&zy(Uo.ab%400-1))&&S0++}return Tn(S0,2)},"%w":Uo=>Uo.Va,"%W":Uo=>Tn(Math.floor((Uo.$a+7-(Uo.Va+6)%7)/7),2),"%y":Uo=>(Uo.ab+1900).toString().substring(2),"%Y":Uo=>Uo.ab+1900,"%z":Uo=>{Uo=Uo.yb;var S0=0<=Uo;return Uo=Math.abs(Uo)/60,(S0?"+":"-")+("0000"+(Uo/60*100+Uo%60)).slice(-4)},"%Z":Uo=>Uo.Bb,"%%":()=>"%"},tr=tr.replace(/%%/g,"\0\0");for(R0 in y0)tr.includes(R0)&&(tr=tr.replace(new RegExp(R0,"g"),y0[R0](or)));return tr=tr.replace(/\0\0/g,"%"),R0=Wv(tr),R0.length>jt?0:(v0.set(R0,wt>>>0),R0.length-1)}for(var iv=Array(256),P0=0;256>P0;++P0)iv[P0]=String.fromCharCode(P0);s1=iv,qy=d.BindingError=class extends Error{constructor(wt){super(wt),this.name="BindingError"}},d.InternalError=class extends Error{constructor(wt){super(wt),this.name="InternalError"}},T0.push(0,1,void 0,1,null,1,!0,1,!1,1),d.count_emval_handles=()=>T0.length/2-5-g1.length;var bv={ia:function(wt,jt,tr){return T1(async()=>{await d.sb(wt,jt,tr)})},a:function(wt,jt,tr){wt>>>=0;var or=new fv(wt);throw e0[or.hb+16>>>2>>>0]=0,e0[or.hb+4>>>2>>>0]=jt>>>0,e0[or.hb+8>>>2>>>0]=tr>>>0,Ly=wt,Ly},y:function(){return 0},ea:function(){},R:function(){},T:function(){},ga:function(){return 0},ca:function(){},Z:function(){},ba:function(){},G:function(){},S:function(){},P:function(){},da:function(){},Q:function(){},C:function(wt,jt,tr){jt=xy(jt>>>0),Dy(wt>>>0,{name:jt,fromWireType:or=>or,toWireType:function(or,qr){if(typeof qr!="bigint"&&typeof qr!="number")throw qr===null?qr="null":(or=typeof qr,qr=or==="object"||or==="array"||or==="function"?qr.toString():""+qr),new TypeError(`Cannot convert "${qr}" to ${this.name}`);return typeof qr=="number"&&(qr=BigInt(qr)),qr},argPackAdvance:8,readValueFromPointer:l1(jt,tr>>>0,jt.indexOf("u")==-1),bb:null})},K:function(wt,jt,tr,or){jt=xy(jt>>>0),Dy(wt>>>0,{name:jt,fromWireType:function(qr){return!!qr},toWireType:function(qr,Tn){return Tn?tr:or},argPackAdvance:8,readValueFromPointer:function(qr){return this.fromWireType(x0[qr>>>0])},bb:null})},J:function(wt){return Dy(wt>>>0,Ro)},B:function(wt,jt,tr){jt=xy(jt>>>0),Dy(wt>>>0,{name:jt,fromWireType:or=>or,toWireType:(or,qr)=>qr,argPackAdvance:8,readValueFromPointer:Bo(jt,tr>>>0),bb:null})},s:function(wt,jt,tr,or,qr){if(wt>>>=0,tr>>>=0,jt=xy(jt>>>0),qr===-1&&(qr=4294967295),qr=h0=>h0,or===0){var Tn=32-8*tr;qr=h0=>h0<<Tn>>>Tn}var o0=jt.includes("unsigned")?function(h0,b0){return b0>>>0}:function(h0,b0){return b0};Dy(wt,{name:jt,fromWireType:qr,toWireType:o0,argPackAdvance:8,readValueFromPointer:l1(jt,tr,or!==0),bb:null})},o:function(wt,jt,tr){function or(Tn){return new qr(v0.buffer,e0[Tn+4>>>2>>>0],e0[Tn>>>2>>>0])}var qr=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][jt];tr=xy(tr>>>0),Dy(wt>>>0,{name:tr,fromWireType:or,argPackAdvance:8,readValueFromPointer:or},{nb:!0})},D:function(wt,jt){jt=xy(jt>>>0);var tr=jt==="std::string";Dy(wt>>>0,{name:jt,fromWireType:function(or){var qr=e0[or>>>2>>>0],Tn=or+4;if(tr)for(var o0=Tn,h0=0;h0<=qr;++h0){var b0=Tn+h0;if(h0==qr||x0[b0>>>0]==0){if(o0=py(o0,b0-o0),y0===void 0)var y0=o0;else y0+=String.fromCharCode(0),y0+=o0;o0=b0+1}}else{for(y0=Array(qr),h0=0;h0<qr;++h0)y0[h0]=String.fromCharCode(x0[Tn+h0>>>0]);y0=y0.join("")}return Fy(or),y0},toWireType:function(or,qr){qr instanceof ArrayBuffer&&(qr=new Uint8Array(qr));var Tn=typeof qr=="string";if(!(Tn||qr instanceof Uint8Array||qr instanceof Uint8ClampedArray||qr instanceof Int8Array))throw new qy("Cannot pass non-string to std::string");var o0=tr&&Tn?n1(qr):qr.length,h0=f1(4+o0+1),b0=h0+4;if(e0[h0>>>2>>>0]=o0,tr&&Tn)Ay(qr,x0,b0,o0+1);else if(Tn)for(Tn=0;Tn<o0;++Tn){var y0=qr.charCodeAt(Tn);if(255<y0)throw Fy(b0),new qy("String has UTF-16 code units that do not fit in 8 bits");x0[b0+Tn>>>0]=y0}else for(Tn=0;Tn<o0;++Tn)x0[b0+Tn>>>0]=qr[Tn];return or!==null&&or.push(Fy,h0),h0},argPackAdvance:8,readValueFromPointer:Yr,bb(or){Fy(or)}})},x:function(wt,jt,tr){if(jt>>>=0,tr>>>=0,tr=xy(tr),jt===2)var or=u0,qr=O0,Tn=G0,o0=h0=>M0[h0>>>1>>>0];else jt===4&&(or=Cy,qr=Uy,Tn=Ry,o0=h0=>e0[h0>>>2>>>0]);Dy(wt>>>0,{name:tr,fromWireType:h0=>{for(var b0=e0[h0>>>2>>>0],y0,R0=h0+4,ry=0;ry<=b0;++ry){var Go=h0+4+ry*jt;(ry==b0||o0(Go)==0)&&(R0=or(R0,Go-R0),y0===void 0?y0=R0:(y0+=String.fromCharCode(0),y0+=R0),R0=Go+jt)}return Fy(h0),y0},toWireType:(h0,b0)=>{if(typeof b0!="string")throw new qy(`Cannot pass non-string to C++ string type ${tr}`);var y0=Tn(b0),R0=f1(4+y0+jt);return e0[R0>>>2>>>0]=y0/jt,qr(b0,R0+4,y0+jt),h0!==null&&h0.push(Fy,R0),R0},argPackAdvance:8,readValueFromPointer:Yr,bb(h0){Fy(h0)}})},L:function(wt,jt){jt=xy(jt>>>0),Dy(wt>>>0,{ob:!0,name:jt,argPackAdvance:0,fromWireType:()=>{},toWireType:()=>{}})},ha:()=>1,u:function(wt,jt,tr){return jt>>>=0,tr>>>=0,wt=U0(wt>>>0),jt=Oy(jt,"emval::as"),P1(jt,tr,wt)},w:function(wt){return wt>>>=0,T1(()=>(wt=U0(wt),wt.then(Py)))},n:function(wt,jt,tr,or){return tr>>>=0,or>>>=0,wt=U1[wt>>>0],jt=U0(jt>>>0),wt(null,jt,tr,or)},j:function(wt,jt,tr,or,qr){return tr>>>=0,or>>>=0,qr>>>=0,wt=U1[wt>>>0],jt=U0(jt>>>0),tr=S1(tr),wt(jt,jt[tr],or,qr)},b:d1,A:function(wt,jt){return jt>>>=0,wt=U0(wt>>>0),jt=U0(jt),wt==jt},m:function(wt){return wt>>>=0,wt===0?Py(Jy()):(wt=S1(wt),Py(Jy()[wt]))},i:function(wt,jt,tr){jt=ev(wt,jt>>>0);var or=jt.shift();wt--;var qr=`return function (obj, func, destructorsRef, args) {
`,Tn=0,o0=[];tr===0&&o0.push("obj");for(var h0=["retType"],b0=[or],y0=0;y0<wt;++y0)o0.push("arg"+y0),h0.push("argType"+y0),b0.push(jt[y0]),qr+=`  var arg${y0} = argType${y0}.readValueFromPointer(args${Tn?"+"+Tn:""});
`,Tn+=jt[y0].argPackAdvance;return qr+=`  var rv = ${tr===1?"new func":"func.call"}(${o0.join(", ")});
`,or.ob||(h0.push("emval_returnValue"),b0.push(P1),qr+=`  return emval_returnValue(retType, destructorsRef, rv);
`),h0.push(qr+`};
`),wt=Cv(h0)(...b0),tr=`methodCaller<(${jt.map(R0=>R0.name).join(", ")}) => ${or.name}>`,E1(p1(tr,wt))},r:function(wt,jt){return jt>>>=0,wt=U0(wt>>>0),jt=U0(jt),Py(wt[jt])},e:function(wt){wt>>>=0,9<wt&&(T0[wt+1]+=1)},t:function(){return Py([])},l:function(wt){wt=U0(wt>>>0);for(var jt=Array(wt.length),tr=0;tr<wt.length;tr++)jt[tr]=wt[tr];return Py(jt)},f:function(wt){return Py(S1(wt>>>0))},k:function(){return Py({})},h:function(wt){wt>>>=0;for(var jt=U0(wt);jt.length;){var tr=jt.pop();jt.pop()(tr)}d1(wt)},g:function(wt,jt,tr){jt>>>=0,tr>>>=0,wt=U0(wt>>>0),jt=U0(jt),tr=U0(tr),wt[jt]=tr},c:function(wt,jt){return jt>>>=0,wt=Oy(wt>>>0,"_emval_take_value"),wt=wt.readValueFromPointer(jt),Py(wt)},W:function(wt,jt){wt=-9007199254740992>wt||9007199254740992<wt?NaN:Number(wt),jt>>>=0,wt=new Date(1e3*wt),Mo[jt>>>2>>>0]=wt.getUTCSeconds(),Mo[jt+4>>>2>>>0]=wt.getUTCMinutes(),Mo[jt+8>>>2>>>0]=wt.getUTCHours(),Mo[jt+12>>>2>>>0]=wt.getUTCDate(),Mo[jt+16>>>2>>>0]=wt.getUTCMonth(),Mo[jt+20>>>2>>>0]=wt.getUTCFullYear()-1900,Mo[jt+24>>>2>>>0]=wt.getUTCDay(),Mo[jt+28>>>2>>>0]=(wt.getTime()-Date.UTC(wt.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},X:function(wt,jt){wt=-9007199254740992>wt||9007199254740992<wt?NaN:Number(wt),jt>>>=0,wt=new Date(1e3*wt),Mo[jt>>>2>>>0]=wt.getSeconds(),Mo[jt+4>>>2>>>0]=wt.getMinutes(),Mo[jt+8>>>2>>>0]=wt.getHours(),Mo[jt+12>>>2>>>0]=wt.getDate(),Mo[jt+16>>>2>>>0]=wt.getMonth(),Mo[jt+20>>>2>>>0]=wt.getFullYear()-1900,Mo[jt+24>>>2>>>0]=wt.getDay(),Mo[jt+28>>>2>>>0]=(zy(wt.getFullYear())?tv:F1)[wt.getMonth()]+wt.getDate()-1|0,Mo[jt+36>>>2>>>0]=-(60*wt.getTimezoneOffset());var tr=new Date(wt.getFullYear(),6,1).getTimezoneOffset(),or=new Date(wt.getFullYear(),0,1).getTimezoneOffset();Mo[jt+32>>>2>>>0]=(tr!=or&&wt.getTimezoneOffset()==Math.min(or,tr))|0},Y:function(wt){wt>>>=0;var jt=new Date(Mo[wt+20>>>2>>>0]+1900,Mo[wt+16>>>2>>>0],Mo[wt+12>>>2>>>0],Mo[wt+8>>>2>>>0],Mo[wt+4>>>2>>>0],Mo[wt>>>2>>>0],0),tr=Mo[wt+32>>>2>>>0],or=jt.getTimezoneOffset(),qr=new Date(jt.getFullYear(),6,1).getTimezoneOffset(),Tn=new Date(jt.getFullYear(),0,1).getTimezoneOffset(),o0=Math.min(Tn,qr);return 0>tr?Mo[wt+32>>>2>>>0]=+(qr!=Tn&&o0==or):0<tr!=(o0==or)&&(qr=Math.max(Tn,qr),jt.setTime(jt.getTime()+6e4*((0<tr?o0:qr)-or))),Mo[wt+24>>>2>>>0]=jt.getDay(),Mo[wt+28>>>2>>>0]=(zy(jt.getFullYear())?tv:F1)[jt.getMonth()]+jt.getDate()-1|0,Mo[wt>>>2>>>0]=jt.getSeconds(),Mo[wt+4>>>2>>>0]=jt.getMinutes(),Mo[wt+8>>>2>>>0]=jt.getHours(),Mo[wt+12>>>2>>>0]=jt.getDate(),Mo[wt+16>>>2>>>0]=jt.getMonth(),Mo[wt+20>>>2>>>0]=jt.getYear(),wt=jt.getTime(),BigInt(isNaN(wt)?-1:wt/1e3)},U:function(){return-52},V:function(){},N:function(wt,jt,tr,or){tr>>>=0,or>>>=0;var qr=new Date().getFullYear(),Tn=new Date(qr,0,1),o0=new Date(qr,6,1);qr=Tn.getTimezoneOffset();var h0=o0.getTimezoneOffset();e0[wt>>>0>>>2>>>0]=60*Math.max(qr,h0),Mo[jt>>>0>>>2>>>0]=+(qr!=h0),wt=b0=>b0.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1],Tn=wt(Tn),o0=wt(o0),h0<qr?(Ay(Tn,x0,tr,17),Ay(o0,x0,or,17)):(Ay(Tn,x0,or,17),Ay(o0,x0,tr,17))},v:()=>{oy("")},d:function(wt,jt,tr){return wt>>>=0,jt=rv(jt>>>0,tr>>>0),_y[wt](...jt)},I:function(wt,jt,tr){return wt>>>=0,jt=rv(jt>>>0,tr>>>0),_y[wt](...jt)},H:()=>Date.now(),O:function(){return 4294901760},q:()=>performance.now(),M:function(wt){wt>>>=0;var jt=x0.length;if(4294901760<wt)return!1;for(var tr=1;4>=tr;tr*=2){var or=jt*(1+.2/tr);or=Math.min(or,wt+100663296);var qr=Math;or=Math.max(wt,or);e:{qr=(qr.min.call(qr,4294901760,or+(65536-or%65536)%65536)-Qo.buffer.byteLength+65535)/65536;try{Qo.grow(qr),f0();var Tn=1;break e}catch{}Tn=void 0}if(Tn)return!0}return!1},$:function(wt,jt){wt>>>=0,jt>>>=0;var tr=0;return Ky().forEach((or,qr)=>{var Tn=jt+tr;for(qr=e0[wt+4*qr>>>2>>>0]=Tn,Tn=0;Tn<or.length;++Tn)v0[qr++>>>0]=or.charCodeAt(Tn);v0[qr>>>0]=0,tr+=or.length+1}),0},aa:function(wt,jt){wt>>>=0,jt>>>=0;var tr=Ky();e0[wt>>>2>>>0]=tr.length;var or=0;return tr.forEach(qr=>or+=qr.length+1),e0[jt>>>2>>>0]=or,0},z:()=>52,F:function(){return 52},_:function(){return 70},E:function(wt,jt,tr,or){jt>>>=0,tr>>>=0,or>>>=0;for(var qr=0,Tn=0;Tn<tr;Tn++){var o0=e0[jt>>>2>>>0],h0=e0[jt+4>>>2>>>0];jt+=8;for(var b0=0;b0<h0;b0++){var y0=x0[o0+b0>>>0],R0=Ov[wt];y0===0||y0===10?((wt===1?_n:No)(Ny(R0,0)),R0.length=0):R0.push(y0)}qr+=h0}return e0[or>>>2>>>0]=qr,0},fa:Pv,p:function(wt,jt,tr,or){return Pv(wt>>>0,jt>>>0,tr>>>0,or>>>0)}},z0=function(){function wt(tr){return z0=tr.exports,z0=ey(),z0=H1(),Qo=z0.ja,f0(),N0.unshift(z0.ka),Z0--,Z0==0&&fy&&(tr=fy,fy=null,tr()),z0}var jt={a:bv};if(Z0++,d.instantiateWasm)try{return d.instantiateWasm(jt,wt)}catch(tr){No(`Module.instantiateWasm callback failed with error: ${tr}`),et(tr)}return o1(jt,function(tr){wt(tr.instance)}).catch(et),{}}(),av=wt=>(av=z0.la)(wt);d._OrtInit=(wt,jt)=>(d._OrtInit=z0.ma)(wt,jt),d._OrtGetLastError=(wt,jt)=>(d._OrtGetLastError=z0.na)(wt,jt),d._OrtCreateSessionOptions=(wt,jt,tr,or,qr,Tn,o0,h0,b0,y0)=>(d._OrtCreateSessionOptions=z0.oa)(wt,jt,tr,or,qr,Tn,o0,h0,b0,y0),d._OrtAppendExecutionProvider=(wt,jt)=>(d._OrtAppendExecutionProvider=z0.pa)(wt,jt),d._OrtAddFreeDimensionOverride=(wt,jt,tr)=>(d._OrtAddFreeDimensionOverride=z0.qa)(wt,jt,tr),d._OrtAddSessionConfigEntry=(wt,jt,tr)=>(d._OrtAddSessionConfigEntry=z0.ra)(wt,jt,tr),d._OrtReleaseSessionOptions=wt=>(d._OrtReleaseSessionOptions=z0.sa)(wt),d._OrtCreateSession=(wt,jt,tr)=>(d._OrtCreateSession=z0.ta)(wt,jt,tr),d._OrtReleaseSession=wt=>(d._OrtReleaseSession=z0.ua)(wt),d._OrtGetInputOutputCount=(wt,jt,tr)=>(d._OrtGetInputOutputCount=z0.va)(wt,jt,tr),d._OrtGetInputName=(wt,jt)=>(d._OrtGetInputName=z0.wa)(wt,jt),d._OrtGetOutputName=(wt,jt)=>(d._OrtGetOutputName=z0.xa)(wt,jt),d._OrtFree=wt=>(d._OrtFree=z0.ya)(wt),d._OrtCreateTensor=(wt,jt,tr,or,qr,Tn)=>(d._OrtCreateTensor=z0.za)(wt,jt,tr,or,qr,Tn),d._OrtGetTensorData=(wt,jt,tr,or,qr)=>(d._OrtGetTensorData=z0.Aa)(wt,jt,tr,or,qr),d._OrtReleaseTensor=wt=>(d._OrtReleaseTensor=z0.Ba)(wt),d._OrtCreateRunOptions=(wt,jt,tr,or)=>(d._OrtCreateRunOptions=z0.Ca)(wt,jt,tr,or),d._OrtAddRunConfigEntry=(wt,jt,tr)=>(d._OrtAddRunConfigEntry=z0.Da)(wt,jt,tr),d._OrtReleaseRunOptions=wt=>(d._OrtReleaseRunOptions=z0.Ea)(wt),d._OrtCreateBinding=wt=>(d._OrtCreateBinding=z0.Fa)(wt),d._OrtBindInput=(wt,jt,tr)=>(d._OrtBindInput=z0.Ga)(wt,jt,tr),d._OrtBindOutput=(wt,jt,tr,or)=>(d._OrtBindOutput=z0.Ha)(wt,jt,tr,or),d._OrtClearBoundOutputs=wt=>(d._OrtClearBoundOutputs=z0.Ia)(wt),d._OrtReleaseBinding=wt=>(d._OrtReleaseBinding=z0.Ja)(wt),d._OrtRunWithBinding=(wt,jt,tr,or,qr)=>(d._OrtRunWithBinding=z0.Ka)(wt,jt,tr,or,qr),d._OrtRun=(wt,jt,tr,or,qr,Tn,o0,h0)=>(d._OrtRun=z0.La)(wt,jt,tr,or,qr,Tn,o0,h0),d._OrtEndProfiling=wt=>(d._OrtEndProfiling=z0.Ma)(wt),d._JsepOutput=(wt,jt,tr)=>(d._JsepOutput=z0.Na)(wt,jt,tr),d._JsepGetNodeName=wt=>(d._JsepGetNodeName=z0.Oa)(wt);var f1=d._malloc=wt=>(f1=d._malloc=z0.Pa)(wt),Fy=d._free=wt=>(Fy=d._free=z0.Qa)(wt),W1=wt=>(W1=z0.Sa)(wt),M1=wt=>(M1=z0.Ta)(wt),V1=()=>(V1=z0.Ua)(),Yy=wt=>(Yy=z0.Wa)(wt),ov=()=>(ov=z0.Xa)(),t1=wt=>(t1=z0.Ya)(wt),i1=()=>(i1=z0.Za)();d.___start_em_js=837952,d.___stop_em_js=838113;function H1(){var wt=z0;wt=Object.assign({},wt);var jt=tr=>or=>tr(or)>>>0;return wt.la=jt(wt.la),wt.Pa=jt(wt.Pa),wt.Ta=jt(wt.Ta),wt.Ua=(tr=>()=>tr()>>>0)(wt.Ua),wt}d.stackSave=()=>V1(),d.stackRestore=wt=>W1(wt),d.stackAlloc=wt=>M1(wt),d.UTF8ToString=py,d.stringToUTF8=(wt,jt,tr)=>Ay(wt,x0,jt,tr),d.lengthBytesUTF8=n1;var y1;fy=function wt(){y1||nr(),y1||(fy=wt)};function nr(){if(!(0<Z0)){if(d.preRun)for(typeof d.preRun=="function"&&(d.preRun=[d.preRun]);d.preRun.length;){var wt=d.preRun.shift();$0.unshift(wt)}for(;0<$0.length;)$0.shift()(d);if(!(0<Z0||y1||(y1=!0,d.calledRun=!0,Xo))){for(;0<N0.length;)N0.shift()(d);for($(d);0<j0.length;)j0.shift()(d)}}}return nr(),h}})();typeof e=="object"&&typeof i=="object"?i.exports=a:typeof define=="function"&&define.amd&&define([],()=>a)}),Ba=Er(()=>{}),Da=Er(()=>{}),Ma={};kr(Ma,{cpus:()=>fc});var fc,Ua=j(()=>{fc=void 0}),Va=Er((e,i)=>{var a=(()=>{var c;var o=typeof document<"u"?(c=document.currentScript)==null?void 0:c.src:void 0;return typeof __filename<"u"&&(o||(o=__filename)),function(s={}){function d(){return xn.buffer!=j0.buffer&&$y(),j0}function $(){return xn.buffer!=j0.buffer&&$y(),Z0}function et(){return xn.buffer!=j0.buffer&&$y(),fy}function h(){return xn.buffer!=j0.buffer&&$y(),oy}function b(){return xn.buffer!=j0.buffer&&$y(),gy}function g(){return xn.buffer!=j0.buffer&&$y(),hy}function st(){return xn.buffer!=j0.buffer&&$y(),J0}function $t(){return xn.buffer!=j0.buffer&&$y(),vy}var vt=s,Ft,Gt,qt=new Promise((Ct,Ht)=>{Ft=Ct,Gt=Ht});vt.mountExternalData=(Ct,Ht)=>{(vt.Db||(vt.Db=new Map)).set(Ct,Ht)},vt.unmountExternalData=()=>{delete vt.Db};let Lt=()=>{let Ct=(ir,Lr,Xr)=>(...An)=>{let i0=i1,g0=Lr==null?void 0:Lr();An=ir(...An);let k0=Lr==null?void 0:Lr();return g0!==k0&&(ir=k0,Xr(g0),Lr=Xr=null),i1!=i0?qr():An},Ht=ir=>async(...Lr)=>{var Xr;try{if(vt.Cb)throw Error("Session already started");let An=vt.Cb={ec:Lr[0],errors:[]},i0=await ir(...Lr);if(vt.Cb!==An)throw Error("Session mismatch");(Xr=vt.Kb)==null||Xr.flush();let g0=An.errors;if(0<g0.length){let k0=await Promise.all(g0);if(k0=k0.filter(w0=>w0),0<k0.length)throw Error(k0.join(`
`))}return i0}finally{vt.Cb=null}};vt._OrtCreateSession=Ct(vt._OrtCreateSession,()=>vt._OrtCreateSession,ir=>vt._OrtCreateSession=ir),vt._OrtRun=Ht(Ct(vt._OrtRun,()=>vt._OrtRun,ir=>vt._OrtRun=ir)),vt._OrtRunWithBinding=Ht(Ct(vt._OrtRunWithBinding,()=>vt._OrtRunWithBinding,ir=>vt._OrtRunWithBinding=ir)),vt._OrtBindInput=Ct(vt._OrtBindInput,()=>vt._OrtBindInput,ir=>vt._OrtBindInput=ir),Lt=void 0};vt.jsepInit=(Ct,Ht)=>{if(Lt==null||Lt(),Ct==="webgpu"){[vt.Kb,vt.Wb,vt.$b,vt.Lb,vt.Zb,vt.ob,vt.ac,vt.cc,vt.Xb,vt.Yb,vt.bc]=Ht;let ir=vt.Kb;vt.jsepRegisterBuffer=(Lr,Xr,An,i0)=>ir.registerBuffer(Lr,Xr,An,i0),vt.jsepGetBuffer=Lr=>ir.getBuffer(Lr),vt.jsepCreateDownloader=(Lr,Xr,An)=>ir.createDownloader(Lr,Xr,An),vt.jsepOnReleaseSession=Lr=>{ir.onReleaseSession(Lr)},vt.jsepOnRunStart=Lr=>ir.onRunStart(Lr)}};var rr=Object.assign({},vt),jr="./this.program",Hr=(Ct,Ht)=>{throw Ht},wn=typeof window=="object",_n=typeof importScripts=="function",No=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",Qo=vt.ENVIRONMENT_IS_PTHREAD||!1,Xo="";function l0(Ct){return vt.locateFile?vt.locateFile(Ct,Xo):Xo+Ct}var v0,x0,D0;if(No){var M0=(Mi(),sr(Di)),Mo=(Wi(),sr(Ui));Xo=_n?Mo.dirname(Xo)+"/":__dirname+"/",v0=(Ct,Ht)=>(Ct=Ay(Ct)?new URL(Ct):Mo.normalize(Ct),M0.readFileSync(Ct,Ht?void 0:"utf8")),D0=Ct=>(Ct=v0(Ct,!0),Ct.buffer||(Ct=new Uint8Array(Ct)),Ct),x0=(Ct,Ht,ir,Lr=!0)=>{Ct=Ay(Ct)?new URL(Ct):Mo.normalize(Ct),M0.readFile(Ct,Lr?void 0:"utf8",(Xr,An)=>{Xr?ir(Xr):Ht(Lr?An.buffer:An)})},!vt.thisProgram&&1<process.argv.length&&(jr=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),Hr=(Ct,Ht)=>{throw process.exitCode=Ct,Ht},global.Worker=Ba().Worker}else(wn||_n)&&(_n?Xo=self.location.href:typeof document<"u"&&document.currentScript&&(Xo=document.currentScript.src),typeof o<"u"&&o&&(Xo=o),Xo.startsWith("blob:")?Xo="":Xo=Xo.substr(0,Xo.replace(/[?#].*/,"").lastIndexOf("/")+1),No||(v0=Ct=>{var Ht=new XMLHttpRequest;return Ht.open("GET",Ct,!1),Ht.send(null),Ht.responseText},_n&&(D0=Ct=>{var Ht=new XMLHttpRequest;return Ht.open("GET",Ct,!1),Ht.responseType="arraybuffer",Ht.send(null),new Uint8Array(Ht.response)}),x0=(Ct,Ht,ir)=>{var Lr=new XMLHttpRequest;Lr.open("GET",Ct,!0),Lr.responseType="arraybuffer",Lr.onload=()=>{Lr.status==200||Lr.status==0&&Lr.response?Ht(Lr.response):ir()},Lr.onerror=ir,Lr.send(null)}));No&&typeof performance>"u"&&(global.performance=Da().performance);var e0=console.log.bind(console),Sn=console.error.bind(console);No&&(e0=(...Ct)=>M0.writeSync(1,Ct.join(" ")+`
`),Sn=(...Ct)=>M0.writeSync(2,Ct.join(" ")+`
`));var t0=e0,d0=Sn;Object.assign(vt,rr),rr=null;var xn,f0,$0=!1,N0,j0,Z0,fy,oy,gy,hy,J0,H0,yy,vy;function $y(){var Ct=xn.buffer;vt.HEAP8=j0=new Int8Array(Ct),vt.HEAP16=fy=new Int16Array(Ct),vt.HEAPU8=Z0=new Uint8Array(Ct),vt.HEAPU16=oy=new Uint16Array(Ct),vt.HEAP32=gy=new Int32Array(Ct),vt.HEAPU32=hy=new Uint32Array(Ct),vt.HEAPF32=J0=new Float32Array(Ct),vt.HEAPF64=vy=new Float64Array(Ct),vt.HEAP64=H0=new BigInt64Array(Ct),vt.HEAPU64=yy=new BigUint64Array(Ct)}var o1=16777216;if(Qo)xn=vt.wasmMemory;else if(vt.wasmMemory)xn=vt.wasmMemory;else if(xn=new WebAssembly.Memory({initial:o1/65536,maximum:65536,shared:!0}),!(xn.buffer instanceof SharedArrayBuffer))throw d0("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),No&&d0("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");$y(),o1=xn.buffer.byteLength;var _y=[],Gy=[],fv=[],Ly=0,Iy=null;function Ny(){if(Ly--,Ly==0&&Iy){var Ct=Iy;Iy=null,Ct()}}function py(Ct){throw Ct="Aborted("+Ct+")",d0(Ct),$0=!0,N0=1,Ct=new WebAssembly.RuntimeError(Ct+". Build with -sASSERTIONS for more info."),Gt(Ct),Ct}var n1=Ct=>Ct.startsWith("data:application/octet-stream;base64,"),Ay=Ct=>Ct.startsWith("file://"),s1;s1="ort-wasm-simd-threaded.wasm",n1(s1)||(s1=l0(s1));function xy(Ct){if(D0)return D0(Ct);throw"both async and sync fetching of the wasm failed"}function u1(Ct){if(wn||_n){if(typeof fetch=="function"&&!Ay(Ct))return fetch(Ct,{credentials:"same-origin"}).then(Ht=>{if(!Ht.ok)throw`failed to load wasm binary file at '${Ct}'`;return Ht.arrayBuffer()}).catch(()=>xy(Ct));if(x0)return new Promise((Ht,ir)=>{x0(Ct,Lr=>Ht(new Uint8Array(Lr)),ir)})}return Promise.resolve().then(()=>xy(Ct))}function ay(Ct,Ht,ir){return u1(Ct).then(Lr=>WebAssembly.instantiate(Lr,Ht)).then(ir,Lr=>{d0(`failed to asynchronously prepare wasm: ${Lr}`),py(Lr)})}function qy(Ct,Ht){var ir=s1;return typeof WebAssembly.instantiateStreaming!="function"||n1(ir)||Ay(ir)||No||typeof fetch!="function"?ay(ir,Ct,Ht):fetch(ir,{credentials:"same-origin"}).then(Lr=>WebAssembly.instantiateStreaming(Lr,Ct).then(Ht,function(Xr){return d0(`wasm streaming compile failed: ${Xr}`),d0("falling back to ArrayBuffer instantiation"),ay(ir,Ct,Ht)}))}var L0={826468:(Ct,Ht,ir,Lr)=>{if(typeof vt>"u"||!vt.Db)return 1;if(Ct=_g(Ct>>>0),Ct.startsWith("./")&&(Ct=Ct.substring(2)),Ct=vt.Db.get(Ct),!Ct)return 2;if(Ht>>>=0,ir>>>=0,Lr>>>=0,Ht+ir>Ct.byteLength)return 3;try{return $().set(Ct.subarray(Ht,Ht+ir),Lr>>>0),0}catch{return 4}},826969:()=>{vt.Xb()},827e3:()=>{vt.Yb()},827029:()=>{vt.bc()},827054:Ct=>vt.Wb(Ct),827087:Ct=>vt.$b(Ct),827119:(Ct,Ht,ir)=>{vt.Lb(Ct,Ht,ir,!0)},827158:(Ct,Ht,ir)=>{vt.Lb(Ct,Ht,ir)},827191:Ct=>{vt.ob("Abs",Ct,void 0)},827242:Ct=>{vt.ob("Neg",Ct,void 0)},827293:Ct=>{vt.ob("Floor",Ct,void 0)},827346:Ct=>{vt.ob("Ceil",Ct,void 0)},827398:Ct=>{vt.ob("Reciprocal",Ct,void 0)},827456:Ct=>{vt.ob("Sqrt",Ct,void 0)},827508:Ct=>{vt.ob("Exp",Ct,void 0)},827559:Ct=>{vt.ob("Erf",Ct,void 0)},827610:Ct=>{vt.ob("Sigmoid",Ct,void 0)},827665:(Ct,Ht,ir)=>{vt.ob("HardSigmoid",Ct,{alpha:Ht,beta:ir})},827744:Ct=>{vt.ob("Log",Ct,void 0)},827795:Ct=>{vt.ob("Sin",Ct,void 0)},827846:Ct=>{vt.ob("Cos",Ct,void 0)},827897:Ct=>{vt.ob("Tan",Ct,void 0)},827948:Ct=>{vt.ob("Asin",Ct,void 0)},828e3:Ct=>{vt.ob("Acos",Ct,void 0)},828052:Ct=>{vt.ob("Atan",Ct,void 0)},828104:Ct=>{vt.ob("Sinh",Ct,void 0)},828156:Ct=>{vt.ob("Cosh",Ct,void 0)},828208:Ct=>{vt.ob("Asinh",Ct,void 0)},828261:Ct=>{vt.ob("Acosh",Ct,void 0)},828314:Ct=>{vt.ob("Atanh",Ct,void 0)},828367:Ct=>{vt.ob("Tanh",Ct,void 0)},828419:Ct=>{vt.ob("Not",Ct,void 0)},828470:(Ct,Ht,ir)=>{vt.ob("Clip",Ct,{min:Ht,max:ir})},828539:Ct=>{vt.ob("Clip",Ct,void 0)},828591:(Ct,Ht)=>{vt.ob("Elu",Ct,{alpha:Ht})},828649:Ct=>{vt.ob("Relu",Ct,void 0)},828701:(Ct,Ht)=>{vt.ob("LeakyRelu",Ct,{alpha:Ht})},828765:(Ct,Ht)=>{vt.ob("ThresholdedRelu",Ct,{alpha:Ht})},828835:(Ct,Ht)=>{vt.ob("Cast",Ct,{to:Ht})},828893:Ct=>{vt.ob("Add",Ct,void 0)},828944:Ct=>{vt.ob("Sub",Ct,void 0)},828995:Ct=>{vt.ob("Mul",Ct,void 0)},829046:Ct=>{vt.ob("Div",Ct,void 0)},829097:Ct=>{vt.ob("Pow",Ct,void 0)},829148:Ct=>{vt.ob("Equal",Ct,void 0)},829201:Ct=>{vt.ob("Greater",Ct,void 0)},829256:Ct=>{vt.ob("GreaterOrEqual",Ct,void 0)},829318:Ct=>{vt.ob("Less",Ct,void 0)},829370:Ct=>{vt.ob("LessOrEqual",Ct,void 0)},829429:(Ct,Ht,ir,Lr,Xr)=>{vt.ob("ReduceMean",Ct,{keepDims:!!Ht,noopWithEmptyAxes:!!ir,axes:Lr?Array.from(b().subarray(Lr>>>0,Xr>>>0)):[]})},829588:(Ct,Ht,ir,Lr,Xr)=>{vt.ob("ReduceMax",Ct,{keepDims:!!Ht,noopWithEmptyAxes:!!ir,axes:Lr?Array.from(b().subarray(Lr>>>0,Xr>>>0)):[]})},829746:(Ct,Ht,ir,Lr,Xr)=>{vt.ob("ReduceMin",Ct,{keepDims:!!Ht,noopWithEmptyAxes:!!ir,axes:Lr?Array.from(b().subarray(Lr>>>0,Xr>>>0)):[]})},829904:(Ct,Ht,ir,Lr,Xr)=>{vt.ob("ReduceProd",Ct,{keepDims:!!Ht,noopWithEmptyAxes:!!ir,axes:Lr?Array.from(b().subarray(Lr>>>0,Xr>>>0)):[]})},830063:(Ct,Ht,ir,Lr,Xr)=>{vt.ob("ReduceSum",Ct,{keepDims:!!Ht,noopWithEmptyAxes:!!ir,axes:Lr?Array.from(b().subarray(Lr>>>0,Xr>>>0)):[]})},830221:(Ct,Ht,ir,Lr,Xr)=>{vt.ob("ReduceL1",Ct,{keepDims:!!Ht,noopWithEmptyAxes:!!ir,axes:Lr?Array.from(b().subarray(Lr>>>0,Xr>>>0)):[]})},830378:(Ct,Ht,ir,Lr,Xr)=>{vt.ob("ReduceL2",Ct,{keepDims:!!Ht,noopWithEmptyAxes:!!ir,axes:Lr?Array.from(b().subarray(Lr>>>0,Xr>>>0)):[]})},830535:(Ct,Ht,ir,Lr,Xr)=>{vt.ob("ReduceLogSum",Ct,{keepDims:!!Ht,noopWithEmptyAxes:!!ir,axes:Lr?Array.from(b().subarray(Lr>>>0,Xr>>>0)):[]})},830696:(Ct,Ht,ir,Lr,Xr)=>{vt.ob("ReduceSumSquare",Ct,{keepDims:!!Ht,noopWithEmptyAxes:!!ir,axes:Lr?Array.from(b().subarray(Lr>>>0,Xr>>>0)):[]})},830860:(Ct,Ht,ir,Lr,Xr)=>{vt.ob("ReduceLogSumExp",Ct,{keepDims:!!Ht,noopWithEmptyAxes:!!ir,axes:Lr?Array.from(b().subarray(Lr>>>0,Xr>>>0)):[]})},831024:Ct=>{vt.ob("Where",Ct,void 0)},831077:(Ct,Ht,ir)=>{vt.ob("Transpose",Ct,{perm:Ht?Array.from(b().subarray(Ht>>>0,ir>>>0)):[]})},831185:(Ct,Ht,ir,Lr)=>{vt.ob("DepthToSpace",Ct,{blocksize:Ht,mode:_g(ir),format:Lr?"NHWC":"NCHW"})},831318:(Ct,Ht,ir,Lr)=>{vt.ob("DepthToSpace",Ct,{blocksize:Ht,mode:_g(ir),format:Lr?"NHWC":"NCHW"})},831451:(Ct,Ht,ir,Lr,Xr,An,i0,g0,k0,w0,B0,my,dy,n0,q0)=>{vt.ob("ConvTranspose",Ct,{format:k0?"NHWC":"NCHW",autoPad:Ht,dilations:[ir],group:Lr,kernelShape:[Xr],pads:[An,i0],strides:[g0],wIsConst:()=>!!d()[w0>>>0],outputPadding:B0?Array.from(b().subarray(B0>>>0,my>>>0)):[],outputShape:dy?Array.from(b().subarray(dy>>>0,n0>>>0)):[],activation:_g(q0)})},831852:(Ct,Ht,ir,Lr,Xr,An,i0,g0,k0,w0,B0,my,dy,n0)=>{vt.ob("ConvTranspose",Ct,{format:g0?"NHWC":"NCHW",autoPad:Ht,dilations:Array.from(b().subarray(ir>>>0,(ir>>>0)+2>>>0)),group:Lr,kernelShape:Array.from(b().subarray(Xr>>>0,(Xr>>>0)+2>>>0)),pads:Array.from(b().subarray(An>>>0,(An>>>0)+4>>>0)),strides:Array.from(b().subarray(i0>>>0,(i0>>>0)+2>>>0)),wIsConst:()=>!!d()[k0>>>0],outputPadding:w0?Array.from(b().subarray(w0>>>0,B0>>>0)):[],outputShape:my?Array.from(b().subarray(my>>>0,dy>>>0)):[],activation:_g(n0)})},832417:(Ct,Ht,ir,Lr,Xr,An,i0,g0,k0,w0,B0,my,dy,n0,q0)=>{vt.ob("ConvTranspose",Ct,{format:k0?"NHWC":"NCHW",autoPad:Ht,dilations:[ir],group:Lr,kernelShape:[Xr],pads:[An,i0],strides:[g0],wIsConst:()=>!!d()[w0>>>0],outputPadding:B0?Array.from(b().subarray(B0>>>0,my>>>0)):[],outputShape:dy?Array.from(b().subarray(dy>>>0,n0>>>0)):[],activation:_g(q0)})},832818:(Ct,Ht,ir,Lr,Xr,An,i0,g0,k0,w0,B0,my,dy,n0)=>{vt.ob("ConvTranspose",Ct,{format:g0?"NHWC":"NCHW",autoPad:Ht,dilations:Array.from(b().subarray(ir>>>0,(ir>>>0)+2>>>0)),group:Lr,kernelShape:Array.from(b().subarray(Xr>>>0,(Xr>>>0)+2>>>0)),pads:Array.from(b().subarray(An>>>0,(An>>>0)+4>>>0)),strides:Array.from(b().subarray(i0>>>0,(i0>>>0)+2>>>0)),wIsConst:()=>!!d()[k0>>>0],outputPadding:w0?Array.from(b().subarray(w0>>>0,B0>>>0)):[],outputShape:my?Array.from(b().subarray(my>>>0,dy>>>0)):[],activation:_g(n0)})},833383:(Ct,Ht)=>{vt.ob("GlobalAveragePool",Ct,{format:Ht?"NHWC":"NCHW"})},833474:(Ct,Ht,ir,Lr,Xr,An,i0,g0,k0,w0,B0,my,dy,n0,q0,uy)=>{vt.ob("AveragePool",Ct,{format:uy?"NHWC":"NCHW",auto_pad:Ht,ceil_mode:ir,count_include_pad:Lr,storage_order:Xr,dilations:[An,i0],kernel_shape:[g0,k0],pads:[w0,B0,my,dy],strides:[n0,q0]})},833758:(Ct,Ht)=>{vt.ob("GlobalAveragePool",Ct,{format:Ht?"NHWC":"NCHW"})},833849:(Ct,Ht,ir,Lr,Xr,An,i0,g0,k0,w0,B0,my,dy,n0,q0,uy)=>{vt.ob("AveragePool",Ct,{format:uy?"NHWC":"NCHW",auto_pad:Ht,ceil_mode:ir,count_include_pad:Lr,storage_order:Xr,dilations:[An,i0],kernel_shape:[g0,k0],pads:[w0,B0,my,dy],strides:[n0,q0]})},834133:(Ct,Ht)=>{vt.ob("GlobalMaxPool",Ct,{format:Ht?"NHWC":"NCHW"})},834220:(Ct,Ht,ir,Lr,Xr,An,i0,g0,k0,w0,B0,my,dy,n0,q0,uy)=>{vt.ob("MaxPool",Ct,{format:uy?"NHWC":"NCHW",auto_pad:Ht,ceil_mode:ir,count_include_pad:Lr,storage_order:Xr,dilations:[An,i0],kernel_shape:[g0,k0],pads:[w0,B0,my,dy],strides:[n0,q0]})},834500:(Ct,Ht)=>{vt.ob("GlobalMaxPool",Ct,{format:Ht?"NHWC":"NCHW"})},834587:(Ct,Ht,ir,Lr,Xr,An,i0,g0,k0,w0,B0,my,dy,n0,q0,uy)=>{vt.ob("MaxPool",Ct,{format:uy?"NHWC":"NCHW",auto_pad:Ht,ceil_mode:ir,count_include_pad:Lr,storage_order:Xr,dilations:[An,i0],kernel_shape:[g0,k0],pads:[w0,B0,my,dy],strides:[n0,q0]})},834867:(Ct,Ht,ir,Lr,Xr)=>{vt.ob("Gemm",Ct,{alpha:Ht,beta:ir,transA:Lr,transB:Xr})},834971:Ct=>{vt.ob("MatMul",Ct,void 0)},835025:(Ct,Ht,ir,Lr)=>{vt.ob("ArgMax",Ct,{keepDims:!!Ht,selectLastIndex:!!ir,axis:Lr})},835133:(Ct,Ht,ir,Lr)=>{vt.ob("ArgMin",Ct,{keepDims:!!Ht,selectLastIndex:!!ir,axis:Lr})},835241:(Ct,Ht)=>{vt.ob("Softmax",Ct,{axis:Ht})},835304:(Ct,Ht)=>{vt.ob("Concat",Ct,{axis:Ht})},835364:(Ct,Ht,ir,Lr,Xr)=>{vt.ob("Split",Ct,{axis:Ht,numOutputs:ir,splitSizes:Lr?Array.from(b().subarray(Lr>>>0,Xr>>>0)):[]})},835504:Ct=>{vt.ob("Expand",Ct,void 0)},835558:(Ct,Ht)=>{vt.ob("Gather",Ct,{axis:Number(Ht)})},835629:(Ct,Ht)=>{vt.ob("GatherElements",Ct,{axis:Number(Ht)})},835708:(Ct,Ht,ir,Lr,Xr,An,i0,g0,k0,w0,B0)=>{vt.ob("Resize",Ct,{antialias:Ht,axes:ir?Array.from(b().subarray(ir>>>0,Lr>>>0)):[],coordinateTransformMode:_g(Xr),cubicCoeffA:An,excludeOutside:i0,extrapolationValue:g0,keepAspectRatioPolicy:_g(k0),mode:_g(w0),nearestMode:_g(B0)})},836054:(Ct,Ht,ir,Lr,Xr,An,i0)=>{vt.ob("Slice",Ct,{starts:Ht?Array.from(b().subarray(Ht>>>0,ir>>>0)):[],ends:Lr?Array.from(b().subarray(Lr>>>0,Xr>>>0)):[],axes:An?Array.from(b().subarray(An>>>0,i0>>>0)):[]})},836270:Ct=>{vt.ob("Tile",Ct,void 0)},836322:(Ct,Ht,ir,Lr)=>{vt.ob("LayerNormalization",Ct,{axis:Ht,epsilon:ir,simplified:!!Lr})},836433:(Ct,Ht,ir)=>{vt.ob("InstanceNormalization",Ct,{epsilon:Ht,format:ir?"NHWC":"NCHW"})},836547:(Ct,Ht,ir)=>{vt.ob("InstanceNormalization",Ct,{epsilon:Ht,format:ir?"NHWC":"NCHW"})},836661:Ct=>{vt.ob("Range",Ct,void 0)},836714:(Ct,Ht)=>{vt.ob("Einsum",Ct,{equation:_g(Ht)})},836795:(Ct,Ht,ir,Lr,Xr)=>{vt.ob("Pad",Ct,{mode:Ht,value:ir,pads:Lr?Array.from(b().subarray(Lr>>>0,Xr>>>0)):[]})},836922:(Ct,Ht,ir,Lr,Xr,An)=>{vt.ob("BatchNormalization",Ct,{epsilon:Ht,momentum:ir,spatial:!!Xr,trainingMode:!!Lr,format:An?"NHWC":"NCHW"})},837091:(Ct,Ht,ir,Lr,Xr,An)=>{vt.ob("BatchNormalization",Ct,{epsilon:Ht,momentum:ir,spatial:!!Xr,trainingMode:!!Lr,format:An?"NHWC":"NCHW"})},837260:(Ct,Ht,ir)=>{vt.ob("CumSum",Ct,{exclusive:Number(Ht),reverse:Number(ir)})},837357:(Ct,Ht,ir,Lr,Xr,An,i0,g0,k0)=>{vt.ob("Attention",Ct,{numHeads:Ht,isUnidirectional:ir,maskFilterValue:Lr,scale:Xr,doRotary:An,qkvHiddenSizes:i0?Array.from(b().subarray(Number(g0)>>>0,Number(g0)+i0>>>0)):[],pastPresentShareBuffer:!!k0})},837629:Ct=>{vt.ob("BiasAdd",Ct,void 0)},837684:Ct=>{vt.ob("BiasSplitGelu",Ct,void 0)},837745:Ct=>{vt.ob("FastGelu",Ct,void 0)},837801:(Ct,Ht,ir,Lr,Xr,An,i0,g0,k0,w0,B0,my,dy)=>{vt.ob("Conv",Ct,{format:k0?"NHWC":"NCHW",auto_pad:Ht,dilations:[ir],group:Lr,kernel_shape:[Xr],pads:An?Array.from(b().subarray(An>>>0,i0>>>0)):[],strides:[g0],w_is_const:()=>!!d()[w0>>>0],activation:_g(B0),activation_params:my?Array.from(st().subarray(my>>>0,dy>>>0)):[]})},838171:(Ct,Ht,ir,Lr,Xr,An,i0,g0,k0,w0,B0,my,dy,n0,q0,uy)=>{vt.ob("Conv",Ct,{format:my?"NHWC":"NCHW",auto_pad:Ht,dilations:[ir,Lr],group:Xr,kernel_shape:[An,i0],pads:g0?Array.from(b().subarray(g0>>>0,k0>>>0)):[],strides:[w0,B0],w_is_const:()=>!!d()[dy>>>0],activation:_g(n0),activation_params:q0?Array.from(st().subarray(q0>>>0,uy>>>0)):[]})},838562:Ct=>{vt.ob("Gelu",Ct,void 0)},838614:(Ct,Ht,ir,Lr,Xr,An)=>{vt.ob("MatMulNBits",Ct,{k:Ht,n:ir,accuracyLevel:Lr,bits:Xr,blockSize:An})},838741:(Ct,Ht,ir,Lr,Xr,An)=>{vt.ob("MultiHeadAttention",Ct,{numHeads:Ht,isUnidirectional:ir,maskFilterValue:Lr,scale:Xr,doRotary:An})},838900:(Ct,Ht,ir,Lr,Xr)=>{vt.ob("RotaryEmbedding",Ct,{interleaved:!!Ht,numHeads:ir,rotaryEmbeddingDim:Lr,scale:Xr})},839039:(Ct,Ht,ir)=>{vt.ob("SkipLayerNormalization",Ct,{epsilon:Ht,simplified:!!ir})},839141:(Ct,Ht,ir)=>{vt.ob("SkipLayerNormalization",Ct,{epsilon:Ht,simplified:!!ir})},839243:(Ct,Ht,ir,Lr)=>{vt.ob("LayerNormalization",Ct,{axis:Ht,epsilon:ir,simplified:!!Lr})},839354:Ct=>{vt.ac(Ct)},839388:(Ct,Ht)=>vt.cc(Ct,Ht,vt.Cb.ec,vt.Cb.errors)};function Dy(Ct){this.name="ExitStatus",this.message=`Program terminated with exit(${Ct})`,this.status=Ct}var l1=Ct=>{Ct.terminate(),Ct.onmessage=()=>{}},g1=Ct=>{u0.xb.length==0&&(Bo(),u0.Mb(u0.xb[0]));var Ht=u0.xb.pop();if(!Ht)return 6;u0.yb.push(Ht),u0.ub[Ct.wb]=Ht,Ht.wb=Ct.wb;var ir={cmd:"run",start_routine:Ct.fc,arg:Ct.Rb,pthread_ptr:Ct.wb};return No&&Ht.unref(),Ht.postMessage(ir,Ct.mc),0},T0=0,d1=Ct=>{var Ht=z$();return Ct=Ct(),Rv(Ht),Ct},U0=(Ct,Ht,...ir)=>d1(()=>{for(var Lr=2*ir.length,Xr=_v(8*Lr),An=Xr>>>3,i0=0;i0<ir.length;i0++){var g0=ir[i0];typeof g0=="bigint"?(H0[An+2*i0]=1n,H0[An+2*i0+1]=g0):(H0[An+2*i0]=0n,$t()[An+2*i0+1>>>0]=g0)}return c$(Ct,0,Lr,Xr,Ht)});function Py(Ct){var Ht;if(Qo)return U0(0,1,Ct);N0=Ct,0<T0||(u0.hc(),(Ht=vt.onExit)==null||Ht.call(vt,Ct),$0=!0),Hr(Ct,new Dy(Ct))}var Yr=Ct=>{if(N0=Ct,Qo)throw G0(Ct),"unwind";Py(Ct)};function Ro(){for(var Ct=vt.numThreads;Ct--;)Bo();_y.unshift(()=>{Ly++,a0(()=>Ny())})}function Bo(){var Ct=l0("ort-wasm-simd-threaded.worker.js");Ct=new Worker(Ct),u0.xb.push(Ct)}function a0(Ct){Qo?Ct():Promise.all(u0.xb.map(u0.Mb)).then(Ct)}var u0={xb:[],yb:[],Qb:[],ub:{},Gb(){Qo?(u0.receiveObjectTransfer=u0.dc,u0.threadInitTLS=u0.Pb,u0.setExitStatus=u0.Ob):Ro()},Ob:Ct=>N0=Ct,pc:["$terminateWorker"],hc:()=>{for(var Ct of u0.yb)l1(Ct);for(Ct of u0.xb)l1(Ct);u0.xb=[],u0.yb=[],u0.ub=[]},Nb:Ct=>{var Ht=Ct.wb;delete u0.ub[Ht],u0.xb.push(Ct),u0.yb.splice(u0.yb.indexOf(Ct),1),Ct.wb=0,D$(Ht)},dc(){},Pb(){u0.Qb.forEach(Ct=>Ct())},Mb:Ct=>new Promise(Ht=>{Ct.onmessage=An=>{An=An.data;var i0=An.cmd;if(An.targetThread&&An.targetThread!=Ty()){var g0=u0.ub[An.targetThread];g0?g0.postMessage(An,An.transferList):d0(`Internal error! Worker sent a message "${i0}" to target pthread ${An.targetThread}, but that thread no longer exists!`)}else i0==="checkMailbox"?Fy():i0==="spawnThread"?g1(An):i0==="cleanupThread"?u0.Nb(u0.ub[An.thread]):i0==="killThread"?(An=An.thread,i0=u0.ub[An],delete u0.ub[An],l1(i0),D$(An),u0.yb.splice(u0.yb.indexOf(i0),1),i0.wb=0):i0==="cancelThread"?u0.ub[An.thread].postMessage({cmd:"cancel"}):i0==="loaded"?(Ct.loaded=!0,No&&!Ct.wb&&Ct.unref(),Ht(Ct)):i0==="alert"?alert(`Thread ${An.threadId}: ${An.text}`):An.target==="setimmediate"?Ct.postMessage(An):i0==="callHandler"?vt[An.handler](...An.args):i0&&d0(`worker sent an unknown command ${i0}`)},Ct.onerror=An=>{throw d0(`worker sent an error! ${An.filename}:${An.lineno}: ${An.message}`),An},No&&(Ct.on("message",An=>Ct.onmessage({data:An})),Ct.on("error",An=>Ct.onerror(An)));var ir=[],Lr=["onExit"],Xr;for(Xr of Lr)vt.hasOwnProperty(Xr)&&ir.push(Xr);Ct.postMessage({cmd:"load",handlers:ir,urlOrBlob:vt.mainScriptUrlOrBlob||o,wasmMemory:xn,wasmModule:f0})})};vt.PThread=u0;var O0=Ct=>{for(;0<Ct.length;)Ct.shift()(vt)};vt.establishStackSpace=()=>{var Ct=Ty(),Ht=g()[Ct+52>>>2>>>0];Ct=g()[Ct+56>>>2>>>0],N$(Ht,Ht-Ct),Rv(Ht)};function G0(Ct){if(Qo)return U0(1,0,Ct);Yr(Ct)}vt.invokeEntryPoint=(Ct,Ht)=>{T0=0,Ct=j$(Ct,Ht),0<T0?u0.Ob(Ct):M$(Ct)};class Cy{constructor(Ht){this.Ib=Ht-24}Gb(Ht,ir){g()[this.Ib+16>>>2>>>0]=0,g()[this.Ib+4>>>2>>>0]=Ht,g()[this.Ib+8>>>2>>>0]=ir}}var Uy=0;function Ry(Ct,Ht,ir,Lr){return Qo?U0(2,1,Ct,Ht,ir,Lr):Oy(Ct,Ht,ir,Lr)}function Oy(Ct,Ht,ir,Lr){if(Ct>>>=0,Ht>>>=0,ir>>>=0,Lr>>>=0,typeof SharedArrayBuffer>"u")return d0("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var Xr=[];return Qo&&Xr.length===0?Ry(Ct,Ht,ir,Lr):(Ct={fc:ir,wb:Ct,Rb:Lr,mc:Xr},Qo?(Ct.oc="spawnThread",postMessage(Ct,Xr),0):g1(Ct))}var P1=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Zy=(Ct,Ht,ir)=>{Ht>>>=0;var Lr=Ht+ir;for(ir=Ht;Ct[ir]&&!(ir>=Lr);)++ir;if(16<ir-Ht&&Ct.buffer&&P1)return P1.decode(Ct.buffer instanceof SharedArrayBuffer?Ct.slice(Ht,ir):Ct.subarray(Ht,ir));for(Lr="";Ht<ir;){var Xr=Ct[Ht++];if(Xr&128){var An=Ct[Ht++]&63;if((Xr&224)==192)Lr+=String.fromCharCode((Xr&31)<<6|An);else{var i0=Ct[Ht++]&63;Xr=(Xr&240)==224?(Xr&15)<<12|An<<6|i0:(Xr&7)<<18|An<<12|i0<<6|Ct[Ht++]&63,65536>Xr?Lr+=String.fromCharCode(Xr):(Xr-=65536,Lr+=String.fromCharCode(55296|Xr>>10,56320|Xr&1023))}}else Lr+=String.fromCharCode(Xr)}return Lr},_g=(Ct,Ht)=>(Ct>>>=0)?Zy($(),Ct,Ht):"";function ey(Ct,Ht,ir){return Qo?U0(3,1,Ct,Ht,ir):0}function ty(Ct,Ht){if(Qo)return U0(4,1,Ct,Ht)}var Ey=Ct=>{for(var Ht=0,ir=0;ir<Ct.length;++ir){var Lr=Ct.charCodeAt(ir);127>=Lr?Ht++:2047>=Lr?Ht+=2:55296<=Lr&&57343>=Lr?(Ht+=4,++ir):Ht+=3}return Ht},R1=(Ct,Ht,ir,Lr)=>{if(ir>>>=0,!(0<Lr))return 0;var Xr=ir;Lr=ir+Lr-1;for(var An=0;An<Ct.length;++An){var i0=Ct.charCodeAt(An);if(55296<=i0&&57343>=i0){var g0=Ct.charCodeAt(++An);i0=65536+((i0&1023)<<10)|g0&1023}if(127>=i0){if(ir>=Lr)break;Ht[ir++>>>0]=i0}else{if(2047>=i0){if(ir+1>=Lr)break;Ht[ir++>>>0]=192|i0>>6}else{if(65535>=i0){if(ir+2>=Lr)break;Ht[ir++>>>0]=224|i0>>12}else{if(ir+3>=Lr)break;Ht[ir++>>>0]=240|i0>>18,Ht[ir++>>>0]=128|i0>>12&63}Ht[ir++>>>0]=128|i0>>6&63}Ht[ir++>>>0]=128|i0&63}}return Ht[ir>>>0]=0,ir-Xr},c1=(Ct,Ht,ir)=>R1(Ct,$(),Ht,ir);function hv(Ct,Ht){if(Qo)return U0(5,1,Ct,Ht)}function mv(Ct,Ht,ir){if(Qo)return U0(6,1,Ct,Ht,ir)}function kv(Ct,Ht,ir){return Qo?U0(7,1,Ct,Ht,ir):0}function Q1(Ct,Ht){if(Qo)return U0(8,1,Ct,Ht)}function gv(Ct,Ht,ir){if(Qo)return U0(9,1,Ct,Ht,ir)}function yv(Ct,Ht,ir,Lr){if(Qo)return U0(10,1,Ct,Ht,ir,Lr)}function J1(Ct,Ht,ir,Lr){if(Qo)return U0(11,1,Ct,Ht,ir,Lr)}function vv(Ct,Ht,ir,Lr){if(Qo)return U0(12,1,Ct,Ht,ir,Lr)}function T1(Ct){if(Qo)return U0(13,1,Ct)}function U1(Ct,Ht){if(Qo)return U0(14,1,Ct,Ht)}function Iv(Ct,Ht,ir){if(Qo)return U0(15,1,Ct,Ht,ir)}var S1,Jy=Ct=>{for(var Ht="";$()[Ct>>>0];)Ht+=S1[$()[Ct++>>>0]];return Ht},E1={},ev={},p1;function Cv(Ct,Ht,ir={}){var Lr=Ht.name;if(!Ct)throw new p1(`type "${Lr}" must have a positive integer typeid pointer`);if(ev.hasOwnProperty(Ct)){if(ir.Ub)return;throw new p1(`Cannot register type '${Lr}' twice`)}ev[Ct]=Ht,E1.hasOwnProperty(Ct)&&(Ht=E1[Ct],delete E1[Ct],Ht.forEach(Xr=>Xr()))}function zy(Ct,Ht,ir={}){if(!("argPackAdvance"in Ht))throw new TypeError("registerType registeredInstance requires argPackAdvance");return Cv(Ct,Ht,ir)}var tv=(Ct,Ht,ir)=>{switch(Ht){case 1:return ir?Lr=>d()[Lr>>>0]:Lr=>$()[Lr>>>0];case 2:return ir?Lr=>et()[Lr>>>1>>>0]:Lr=>h()[Lr>>>1>>>0];case 4:return ir?Lr=>b()[Lr>>>2>>>0]:Lr=>g()[Lr>>>2>>>0];case 8:return ir?Lr=>H0[Lr>>>3]:Lr=>yy[Lr>>>3];default:throw new TypeError(`invalid integer width (${Ht}): ${Ct}`)}},F1=[],e1=[];function rv(Ct){Ct>>>=0,9<Ct&&--e1[Ct+1]===0&&(e1[Ct]=void 0,F1.push(Ct))}var jy=Ct=>{if(!Ct)throw new p1("Cannot use deleted val. handle = "+Ct);return e1[Ct]},Ky=Ct=>{switch(Ct){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let Ht=F1.pop()||e1.length;return e1[Ht]=Ct,e1[Ht+1]=1,Ht}};function D1(Ct){return this.fromWireType(g()[Ct>>>2>>>0])}var Ov={name:"emscripten::val",fromWireType:Ct=>{var Ht=jy(Ct);return rv(Ct),Ht},toWireType:(Ct,Ht)=>Ky(Ht),argPackAdvance:8,readValueFromPointer:D1,Bb:null},Av=(Ct,Ht)=>{switch(Ht){case 4:return function(ir){return this.fromWireType(st()[ir>>>2>>>0])};case 8:return function(ir){return this.fromWireType($t()[ir>>>3>>>0])};default:throw new TypeError(`invalid float width (${Ht}): ${Ct}`)}},nv=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Wv=(Ct,Ht)=>{for(var ir=Ct>>1,Lr=ir+Ht/2;!(ir>=Lr)&&h()[ir>>>0];)++ir;if(ir<<=1,32<ir-Ct&&nv)return nv.decode($().slice(Ct,ir));for(ir="",Lr=0;!(Lr>=Ht/2);++Lr){var Xr=et()[Ct+2*Lr>>>1>>>0];if(Xr==0)break;ir+=String.fromCharCode(Xr)}return ir},Pv=(Ct,Ht,ir)=>{if(ir??(ir=2147483647),2>ir)return 0;ir-=2;var Lr=Ht;ir=ir<2*Ct.length?ir/2:Ct.length;for(var Xr=0;Xr<ir;++Xr){var An=Ct.charCodeAt(Xr);et()[Ht>>>1>>>0]=An,Ht+=2}return et()[Ht>>>1>>>0]=0,Ht-Lr},iv=Ct=>2*Ct.length,P0=(Ct,Ht)=>{for(var ir=0,Lr="";!(ir>=Ht/4);){var Xr=b()[Ct+4*ir>>>2>>>0];if(Xr==0)break;++ir,65536<=Xr?(Xr-=65536,Lr+=String.fromCharCode(55296|Xr>>10,56320|Xr&1023)):Lr+=String.fromCharCode(Xr)}return Lr},bv=(Ct,Ht,ir)=>{if(Ht>>>=0,ir??(ir=2147483647),4>ir)return 0;var Lr=Ht;ir=Lr+ir-4;for(var Xr=0;Xr<Ct.length;++Xr){var An=Ct.charCodeAt(Xr);if(55296<=An&&57343>=An){var i0=Ct.charCodeAt(++Xr);An=65536+((An&1023)<<10)|i0&1023}if(b()[Ht>>>2>>>0]=An,Ht+=4,Ht+4>ir)break}return b()[Ht>>>2>>>0]=0,Ht-Lr},z0=Ct=>{for(var Ht=0,ir=0;ir<Ct.length;++ir){var Lr=Ct.charCodeAt(ir);55296<=Lr&&57343>=Lr&&++ir,Ht+=4}return Ht},av=Ct=>{if(!$0)try{if(Ct(),!(0<T0))try{Qo?M$(N0):Yr(N0)}catch(Ht){Ht instanceof Dy||Ht=="unwind"||Hr(1,Ht)}}catch(Ht){Ht instanceof Dy||Ht=="unwind"||Hr(1,Ht)}};function f1(Ct){Ct>>>=0,typeof Atomics.nc=="function"&&(Atomics.nc(b(),Ct>>>2,Ct).value.then(Fy),Ct+=128,Atomics.store(b(),Ct>>>2,1))}vt.__emscripten_thread_mailbox_await=f1;var Fy=()=>{var Ct=Ty();Ct&&(f1(Ct),av(mw))};vt.checkMailbox=Fy;var W1=[],M1=(Ct,Ht)=>{var ir=ev[Ct];if(ir===void 0)throw Ct=d$(Ct),ir=Jy(Ct),k1(Ct),new p1(`${Ht} has unknown type ${ir}`);return ir},V1=(Ct,Ht,ir)=>{var Lr=[];return Ct=Ct.toWireType(Lr,ir),Lr.length&&(g()[Ht>>>2>>>0]=Ky(Lr)),Ct},Yy=Ct=>{try{Ct()}catch(Ht){py(Ht)}};function ov(){var Ct=C0,Ht={};for(let[ir,Lr]of Object.entries(Ct))Ht[ir]=typeof Lr=="function"?(...Xr)=>{y1.push(ir);try{return Lr(...Xr)}finally{$0||(y1.pop(),i1&&t1===1&&y1.length===0&&(t1=0,T0+=1,Yy(p$),typeof Fibers<"u"&&Fibers.rc()))}}:Lr;return Ht}var t1=0,i1=null,H1=0,y1=[],nr={},wt={},jt=0,tr=null,or=[];function qr(){return new Promise((Ct,Ht)=>{tr={resolve:Ct,reject:Ht}})}function Tn(){var Ct=N1(65548),Ht=Ct+12;g()[Ct>>>2>>>0]=Ht,g()[Ct+4>>>2>>>0]=Ht+65536,Ht=y1[0];var ir=nr[Ht];return ir===void 0&&(ir=jt++,nr[Ht]=ir,wt[ir]=Ht),Ht=ir,b()[Ct+8>>>2>>>0]=Ht,Ct}function o0(){var Ct=b()[i1+8>>>2>>>0];return Ct=C0[wt[Ct]],--T0,Ct()}function h0(Ct){if(!$0){if(t1===0){var Ht=!1,ir=!1;Ct((Lr=0)=>{if(!$0&&(H1=Lr,Ht=!0,ir)){t1=2,Yy(()=>f$(i1)),typeof Browser<"u"&&Browser.Hb.Tb&&Browser.Hb.resume(),Lr=!1;try{var Xr=o0()}catch(g0){Xr=g0,Lr=!0}var An=!1;if(!i1){var i0=tr;i0&&(tr=null,(Lr?i0.reject:i0.resolve)(Xr),An=!0)}if(Lr&&!An)throw Xr}}),ir=!0,Ht||(t1=1,i1=Tn(),typeof Browser<"u"&&Browser.Hb.Tb&&Browser.Hb.pause(),Yy(()=>B$(i1)))}else t1===2?(t1=0,Yy(L$),k1(i1),i1=null,or.forEach(av)):py(`invalid state: ${t1}`);return H1}}function b0(Ct){return h0(Ht=>{Ct().then(Ht)})}var y0=[],R0={},ry=Ct=>{var Ht=R0[Ct];return Ht===void 0?Jy(Ct):Ht},Go=()=>typeof globalThis=="object"?globalThis:Function("return this")(),Uo=Ct=>{var Ht=y0.length;return y0.push(Ct),Ht},S0=(Ct,Ht)=>{for(var ir=Array(Ct),Lr=0;Lr<Ct;++Lr)ir[Lr]=M1(g()[Ht+4*Lr>>>2>>>0],"parameter "+Lr);return ir},E0=(Ct,Ht)=>Object.defineProperty(Ht,"name",{value:Ct});function ny(Ct){var Ht=Function;if(!(Ht instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof Ht} which is not a function`);var ir=E0(Ht.name||"unknownFunctionName",function(){});return ir.prototype=Ht.prototype,ir=new ir,Ct=Ht.apply(ir,Ct),Ct instanceof Object?Ct:ir}var sv=Ct=>Ct%4===0&&(Ct%100!==0||Ct%400===0),ow=[0,31,60,91,121,152,182,213,244,274,305,335],sw=[0,31,59,90,120,151,181,212,243,273,304,334];function uw(Ct,Ht,ir,Lr,Xr,An,i0){return Qo?U0(16,1,Ct,Ht,ir,Lr,Xr,An,i0):-52}function lw(Ct,Ht,ir,Lr,Xr,An){if(Qo)return U0(17,1,Ct,Ht,ir,Lr,Xr,An)}var E$=[],k$=(Ct,Ht)=>{E$.length=0;for(var ir;ir=$()[Ct++>>>0];){var Lr=ir!=105;Lr&=ir!=112,Ht+=Lr&&Ht%8?4:0,E$.push(ir==112?g()[Ht>>>2>>>0]:ir==106?H0[Ht>>>3]:ir==105?b()[Ht>>>2>>>0]:$t()[Ht>>>3>>>0]),Ht+=Lr?8:4}return E$},I$={},Wy=()=>{if(!Jv){var Ct={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:jr||"./this.program"},Ht;for(Ht in I$)I$[Ht]===void 0?delete Ct[Ht]:Ct[Ht]=I$[Ht];var ir=[];for(Ht in Ct)ir.push(`${Ht}=${Ct[Ht]}`);Jv=ir}return Jv},Jv;function $v(Ct,Ht){if(Qo)return U0(18,1,Ct,Ht);Ct>>>=0,Ht>>>=0;var ir=0;return Wy().forEach((Lr,Xr)=>{var An=Ht+ir;for(Xr=g()[Ct+4*Xr>>>2>>>0]=An,An=0;An<Lr.length;++An)d()[Xr++>>>0]=Lr.charCodeAt(An);d()[Xr>>>0]=0,ir+=Lr.length+1}),0}function C$(Ct,Ht){if(Qo)return U0(19,1,Ct,Ht);Ct>>>=0,Ht>>>=0;var ir=Wy();g()[Ct>>>2>>>0]=ir.length;var Lr=0;return ir.forEach(Xr=>Lr+=Xr.length+1),g()[Ht>>>2>>>0]=Lr,0}function u$(Ct){return Qo?U0(20,1,Ct):52}function v1(Ct,Ht,ir,Lr){return Qo?U0(21,1,Ct,Ht,ir,Lr):52}function O$(Ct,Ht,ir,Lr){return Qo?U0(22,1,Ct,Ht,ir,Lr):70}var dw=[null,[],[]];function A$(Ct,Ht,ir,Lr){if(Qo)return U0(23,1,Ct,Ht,ir,Lr);Ht>>>=0,ir>>>=0,Lr>>>=0;for(var Xr=0,An=0;An<ir;An++){var i0=g()[Ht>>>2>>>0],g0=g()[Ht+4>>>2>>>0];Ht+=8;for(var k0=0;k0<g0;k0++){var w0=$()[i0+k0>>>0],B0=dw[Ct];w0===0||w0===10?((Ct===1?t0:d0)(Zy(B0,0)),B0.length=0):B0.push(w0)}Xr+=g0}return g()[Lr>>>2>>>0]=Xr,0}var P$=[31,29,31,30,31,30,31,31,30,31,30,31],R$=[31,28,31,30,31,30,31,31,30,31,30,31];function cw(Ct){var Ht=Array(Ey(Ct)+1);return R1(Ct,Ht,0,Ht.length),Ht}var b1=(Ct,Ht)=>{d().set(Ct,Ht>>>0)};function pw(Ct,Ht,ir,Lr){function Xr(n0,q0,uy){for(n0=typeof n0=="number"?n0.toString():n0||"";n0.length<q0;)n0=uy[0]+n0;return n0}function An(n0,q0){return Xr(n0,q0,"0")}function i0(n0,q0){function uy(uv){return 0>uv?-1:0<uv?1:0}var xv;return(xv=uy(n0.getFullYear()-q0.getFullYear()))===0&&(xv=uy(n0.getMonth()-q0.getMonth()))===0&&(xv=uy(n0.getDate()-q0.getDate())),xv}function g0(n0){switch(n0.getDay()){case 0:return new Date(n0.getFullYear()-1,11,29);case 1:return n0;case 2:return new Date(n0.getFullYear(),0,3);case 3:return new Date(n0.getFullYear(),0,2);case 4:return new Date(n0.getFullYear(),0,1);case 5:return new Date(n0.getFullYear()-1,11,31);case 6:return new Date(n0.getFullYear()-1,11,30)}}function k0(n0){var q0=n0.zb;for(n0=new Date(new Date(n0.Ab+1900,0,1).getTime());0<q0;){var uy=n0.getMonth(),xv=(sv(n0.getFullYear())?P$:R$)[uy];if(q0>xv-n0.getDate())q0-=xv-n0.getDate()+1,n0.setDate(1),11>uy?n0.setMonth(uy+1):(n0.setMonth(0),n0.setFullYear(n0.getFullYear()+1));else{n0.setDate(n0.getDate()+q0);break}}return uy=new Date(n0.getFullYear()+1,0,4),q0=g0(new Date(n0.getFullYear(),0,4)),uy=g0(uy),0>=i0(q0,n0)?0>=i0(uy,n0)?n0.getFullYear()+1:n0.getFullYear():n0.getFullYear()-1}Ct>>>=0,Ht>>>=0,ir>>>=0,Lr>>>=0;var w0=g()[Lr+40>>>2>>>0];Lr={kc:b()[Lr>>>2>>>0],jc:b()[Lr+4>>>2>>>0],Eb:b()[Lr+8>>>2>>>0],Jb:b()[Lr+12>>>2>>>0],Fb:b()[Lr+16>>>2>>>0],Ab:b()[Lr+20>>>2>>>0],vb:b()[Lr+24>>>2>>>0],zb:b()[Lr+28>>>2>>>0],qc:b()[Lr+32>>>2>>>0],ic:b()[Lr+36>>>2>>>0],lc:w0?_g(w0):""},ir=_g(ir),w0={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var B0 in w0)ir=ir.replace(new RegExp(B0,"g"),w0[B0]);var my="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),dy="January February March April May June July August September October November December".split(" ");w0={"%a":n0=>my[n0.vb].substring(0,3),"%A":n0=>my[n0.vb],"%b":n0=>dy[n0.Fb].substring(0,3),"%B":n0=>dy[n0.Fb],"%C":n0=>An((n0.Ab+1900)/100|0,2),"%d":n0=>An(n0.Jb,2),"%e":n0=>Xr(n0.Jb,2," "),"%g":n0=>k0(n0).toString().substring(2),"%G":k0,"%H":n0=>An(n0.Eb,2),"%I":n0=>(n0=n0.Eb,n0==0?n0=12:12<n0&&(n0-=12),An(n0,2)),"%j":n0=>{for(var q0=0,uy=0;uy<=n0.Fb-1;q0+=(sv(n0.Ab+1900)?P$:R$)[uy++]);return An(n0.Jb+q0,3)},"%m":n0=>An(n0.Fb+1,2),"%M":n0=>An(n0.jc,2),"%n":()=>`
`,"%p":n0=>0<=n0.Eb&&12>n0.Eb?"AM":"PM","%S":n0=>An(n0.kc,2),"%t":()=>"	","%u":n0=>n0.vb||7,"%U":n0=>An(Math.floor((n0.zb+7-n0.vb)/7),2),"%V":n0=>{var q0=Math.floor((n0.zb+7-(n0.vb+6)%7)/7);if(2>=(n0.vb+371-n0.zb-2)%7&&q0++,q0)q0==53&&(uy=(n0.vb+371-n0.zb)%7,uy==4||uy==3&&sv(n0.Ab)||(q0=1));else{q0=52;var uy=(n0.vb+7-n0.zb-1)%7;(uy==4||uy==5&&sv(n0.Ab%400-1))&&q0++}return An(q0,2)},"%w":n0=>n0.vb,"%W":n0=>An(Math.floor((n0.zb+7-(n0.vb+6)%7)/7),2),"%y":n0=>(n0.Ab+1900).toString().substring(2),"%Y":n0=>n0.Ab+1900,"%z":n0=>{n0=n0.ic;var q0=0<=n0;return n0=Math.abs(n0)/60,(q0?"+":"-")+("0000"+(n0/60*100+n0%60)).slice(-4)},"%Z":n0=>n0.lc,"%%":()=>"%"},ir=ir.replace(/%%/g,"\0\0");for(B0 in w0)ir.includes(B0)&&(ir=ir.replace(new RegExp(B0,"g"),w0[B0](Lr)));return ir=ir.replace(/\0\0/g,"%"),B0=cw(ir),B0.length>Ht?0:(b1(B0,Ct),B0.length-1)}u0.Gb();for(var $1=Array(256),l$=0;256>l$;++l$)$1[l$]=String.fromCharCode(l$);S1=$1,p1=vt.BindingError=class extends Error{constructor(Ct){super(Ct),this.name="BindingError"}},vt.InternalError=class extends Error{constructor(Ct){super(Ct),this.name="InternalError"}},e1.push(0,1,void 0,1,null,1,!0,1,!1,1),vt.count_emval_handles=()=>e1.length/2-5-F1.length;var fw=[Py,G0,Ry,ey,ty,hv,mv,kv,Q1,gv,yv,J1,vv,T1,U1,Iv,uw,lw,$v,C$,u$,v1,O$,A$],wv={ua:function(Ct,Ht,ir){return b0(async()=>{await vt.Zb(Ct,Ht,ir)})},b:function(Ct,Ht,ir){throw Ct>>>=0,new Cy(Ct).Gb(Ht>>>0,ir>>>0),Uy=Ct,Uy},ia:function(Ct){hw(Ct>>>0,!_n,1,!wn,131072,!1),u0.Pb()},G:function(Ct){Ct>>>=0,Qo?postMessage({cmd:"cleanupThread",thread:Ct}):u0.Nb(u0.ub[Ct])},_:Oy,A:ey,pa:ty,W:hv,Y:mv,qa:kv,na:Q1,fa:gv,ma:yv,K:J1,X:vv,U:T1,oa:U1,V:Iv,E:function(Ct,Ht,ir){Ct>>>=0,ir>>>=0,Ht=Jy(Ht>>>0),zy(Ct,{name:Ht,fromWireType:Lr=>Lr,toWireType:function(Lr,Xr){if(typeof Xr!="bigint"&&typeof Xr!="number")throw Xr===null?Xr="null":(Lr=typeof Xr,Xr=Lr==="object"||Lr==="array"||Lr==="function"?Xr.toString():""+Xr),new TypeError(`Cannot convert "${Xr}" to ${this.name}`);return typeof Xr=="number"&&(Xr=BigInt(Xr)),Xr},argPackAdvance:8,readValueFromPointer:tv(Ht,ir,Ht.indexOf("u")==-1),Bb:null})},O:function(Ct,Ht,ir,Lr){Ct>>>=0,Ht=Jy(Ht>>>0),zy(Ct,{name:Ht,fromWireType:function(Xr){return!!Xr},toWireType:function(Xr,An){return An?ir:Lr},argPackAdvance:8,readValueFromPointer:function(Xr){return this.fromWireType($()[Xr>>>0])},Bb:null})},N:function(Ct){return zy(Ct>>>0,Ov)},D:function(Ct,Ht,ir){Ct>>>=0,ir>>>=0,Ht=Jy(Ht>>>0),zy(Ct,{name:Ht,fromWireType:Lr=>Lr,toWireType:(Lr,Xr)=>Xr,argPackAdvance:8,readValueFromPointer:Av(Ht,ir),Bb:null})},t:function(Ct,Ht,ir,Lr,Xr){if(Ct>>>=0,ir>>>=0,Ht=Jy(Ht>>>0),Xr===-1&&(Xr=4294967295),Xr=g0=>g0,Lr===0){var An=32-8*ir;Xr=g0=>g0<<An>>>An}var i0=Ht.includes("unsigned")?function(g0,k0){return k0>>>0}:function(g0,k0){return k0};zy(Ct,{name:Ht,fromWireType:Xr,toWireType:i0,argPackAdvance:8,readValueFromPointer:tv(Ht,ir,Lr!==0),Bb:null})},p:function(Ct,Ht,ir){function Lr(An){var i0=g()[An>>>2>>>0];return An=g()[An+4>>>2>>>0],new Xr(d().buffer,An,i0)}Ct>>>=0;var Xr=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][Ht];ir=Jy(ir>>>0),zy(Ct,{name:ir,fromWireType:Lr,argPackAdvance:8,readValueFromPointer:Lr},{Ub:!0})},F:function(Ct,Ht){Ct>>>=0,Ht=Jy(Ht>>>0);var ir=Ht==="std::string";zy(Ct,{name:Ht,fromWireType:function(Lr){var Xr=g()[Lr>>>2>>>0],An=Lr+4;if(ir)for(var i0=An,g0=0;g0<=Xr;++g0){var k0=An+g0;if(g0==Xr||$()[k0>>>0]==0){if(i0=_g(i0,k0-i0),w0===void 0)var w0=i0;else w0+=String.fromCharCode(0),w0+=i0;i0=k0+1}}else{for(w0=Array(Xr),g0=0;g0<Xr;++g0)w0[g0]=String.fromCharCode($()[An+g0>>>0]);w0=w0.join("")}return k1(Lr),w0},toWireType:function(Lr,Xr){Xr instanceof ArrayBuffer&&(Xr=new Uint8Array(Xr));var An=typeof Xr=="string";if(!(An||Xr instanceof Uint8Array||Xr instanceof Uint8ClampedArray||Xr instanceof Int8Array))throw new p1("Cannot pass non-string to std::string");var i0=ir&&An?Ey(Xr):Xr.length,g0=N1(4+i0+1),k0=g0+4;if(g()[g0>>>2>>>0]=i0,ir&&An)c1(Xr,k0,i0+1);else if(An)for(An=0;An<i0;++An){var w0=Xr.charCodeAt(An);if(255<w0)throw k1(k0),new p1("String has UTF-16 code units that do not fit in 8 bits");$()[k0+An>>>0]=w0}else for(An=0;An<i0;++An)$()[k0+An>>>0]=Xr[An];return Lr!==null&&Lr.push(k1,g0),g0},argPackAdvance:8,readValueFromPointer:D1,Bb(Lr){k1(Lr)}})},z:function(Ct,Ht,ir){if(Ct>>>=0,Ht>>>=0,ir>>>=0,ir=Jy(ir),Ht===2)var Lr=Wv,Xr=Pv,An=iv,i0=g0=>h()[g0>>>1>>>0];else Ht===4&&(Lr=P0,Xr=bv,An=z0,i0=g0=>g()[g0>>>2>>>0]);zy(Ct,{name:ir,fromWireType:g0=>{for(var k0=g()[g0>>>2>>>0],w0,B0=g0+4,my=0;my<=k0;++my){var dy=g0+4+my*Ht;(my==k0||i0(dy)==0)&&(B0=Lr(B0,dy-B0),w0===void 0?w0=B0:(w0+=String.fromCharCode(0),w0+=B0),B0=dy+Ht)}return k1(g0),w0},toWireType:(g0,k0)=>{if(typeof k0!="string")throw new p1(`Cannot pass non-string to C++ string type ${ir}`);var w0=An(k0),B0=N1(4+w0+Ht);return g()[B0>>>2>>>0]=w0/Ht,Xr(k0,B0+4,w0+Ht),g0!==null&&g0.push(k1,B0),B0},argPackAdvance:8,readValueFromPointer:D1,Bb(g0){k1(g0)}})},P:function(Ct,Ht){Ct>>>=0,Ht=Jy(Ht>>>0),zy(Ct,{Vb:!0,name:Ht,argPackAdvance:0,fromWireType:()=>{},toWireType:()=>{}})},ta:()=>1,S:function(Ct,Ht){Ct>>>=0,Ct==Ht>>>0?setTimeout(Fy):Qo?postMessage({targetThread:Ct,cmd:"checkMailbox"}):(Ct=u0.ub[Ct])&&Ct.postMessage({cmd:"checkMailbox"})},$:function(Ct,Ht,ir,Lr,Xr){Ht>>>=0,ir>>>=0,Lr/=2,W1.length=Lr,Xr=Xr>>>0>>>3;for(var An=0;An<Lr;An++)W1[An]=H0[Xr+2*An]?H0[Xr+2*An+1]:$t()[Xr+2*An+1>>>0];return Ct=Ht?L0[Ht]:fw[Ct],u0.Sb=ir,ir=Ct(...W1),u0.Sb=0,ir},ha:f1,sa:function(Ct){No&&u0.ub[Ct>>>0].ref()},w:function(Ct,Ht,ir){return Ht>>>=0,ir>>>=0,Ct=jy(Ct>>>0),Ht=M1(Ht,"emval::as"),V1(Ht,ir,Ct)},y:function(Ct){return Ct>>>=0,b0(()=>(Ct=jy(Ct),Ct.then(Ky)))},o:function(Ct,Ht,ir,Lr){return ir>>>=0,Lr>>>=0,Ct=y0[Ct>>>0],Ht=jy(Ht>>>0),Ct(null,Ht,ir,Lr)},k:function(Ct,Ht,ir,Lr,Xr){return ir>>>=0,Lr>>>=0,Xr>>>=0,Ct=y0[Ct>>>0],Ht=jy(Ht>>>0),ir=ry(ir),Ct(Ht,Ht[ir],Lr,Xr)},c:rv,C:function(Ct,Ht){return Ht>>>=0,Ct=jy(Ct>>>0),Ht=jy(Ht),Ct==Ht},n:function(Ct){return Ct>>>=0,Ct===0?Ky(Go()):(Ct=ry(Ct),Ky(Go()[Ct]))},j:function(Ct,Ht,ir){Ht=S0(Ct,Ht>>>0);var Lr=Ht.shift();Ct--;var Xr=`return function (obj, func, destructorsRef, args) {
`,An=0,i0=[];ir===0&&i0.push("obj");for(var g0=["retType"],k0=[Lr],w0=0;w0<Ct;++w0)i0.push("arg"+w0),g0.push("argType"+w0),k0.push(Ht[w0]),Xr+=`  var arg${w0} = argType${w0}.readValueFromPointer(args${An?"+"+An:""});
`,An+=Ht[w0].argPackAdvance;return Xr+=`  var rv = ${ir===1?"new func":"func.call"}(${i0.join(", ")});
`,Lr.Vb||(g0.push("emval_returnValue"),k0.push(V1),Xr+=`  return emval_returnValue(retType, destructorsRef, rv);
`),g0.push(Xr+`};
`),Ct=ny(g0)(...k0),ir=`methodCaller<(${Ht.map(B0=>B0.name).join(", ")}) => ${Lr.name}>`,Uo(E0(ir,Ct))},s:function(Ct,Ht){return Ht>>>=0,Ct=jy(Ct>>>0),Ht=jy(Ht),Ky(Ct[Ht])},d:function(Ct){Ct>>>=0,9<Ct&&(e1[Ct+1]+=1)},v:function(){return Ky([])},m:function(Ct){Ct=jy(Ct>>>0);for(var Ht=Array(Ct.length),ir=0;ir<Ct.length;ir++)Ht[ir]=Ct[ir];return Ky(Ht)},g:function(Ct){return Ky(ry(Ct>>>0))},l:function(){return Ky({})},i:function(Ct){Ct>>>=0;for(var Ht=jy(Ct);Ht.length;){var ir=Ht.pop();Ht.pop()(ir)}rv(Ct)},h:function(Ct,Ht,ir){Ht>>>=0,ir>>>=0,Ct=jy(Ct>>>0),Ht=jy(Ht),ir=jy(ir),Ct[Ht]=ir},e:function(Ct,Ht){return Ht>>>=0,Ct=M1(Ct>>>0,"_emval_take_value"),Ct=Ct.readValueFromPointer(Ht),Ky(Ct)},ca:function(Ct,Ht){Ct=-9007199254740992>Ct||9007199254740992<Ct?NaN:Number(Ct),Ht>>>=0,Ct=new Date(1e3*Ct),b()[Ht>>>2>>>0]=Ct.getUTCSeconds(),b()[Ht+4>>>2>>>0]=Ct.getUTCMinutes(),b()[Ht+8>>>2>>>0]=Ct.getUTCHours(),b()[Ht+12>>>2>>>0]=Ct.getUTCDate(),b()[Ht+16>>>2>>>0]=Ct.getUTCMonth(),b()[Ht+20>>>2>>>0]=Ct.getUTCFullYear()-1900,b()[Ht+24>>>2>>>0]=Ct.getUTCDay(),Ct=(Ct.getTime()-Date.UTC(Ct.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,b()[Ht+28>>>2>>>0]=Ct},da:function(Ct,Ht){Ct=-9007199254740992>Ct||9007199254740992<Ct?NaN:Number(Ct),Ht>>>=0,Ct=new Date(1e3*Ct),b()[Ht>>>2>>>0]=Ct.getSeconds(),b()[Ht+4>>>2>>>0]=Ct.getMinutes(),b()[Ht+8>>>2>>>0]=Ct.getHours(),b()[Ht+12>>>2>>>0]=Ct.getDate(),b()[Ht+16>>>2>>>0]=Ct.getMonth(),b()[Ht+20>>>2>>>0]=Ct.getFullYear()-1900,b()[Ht+24>>>2>>>0]=Ct.getDay();var ir=(sv(Ct.getFullYear())?ow:sw)[Ct.getMonth()]+Ct.getDate()-1|0;b()[Ht+28>>>2>>>0]=ir,b()[Ht+36>>>2>>>0]=-(60*Ct.getTimezoneOffset()),ir=new Date(Ct.getFullYear(),6,1).getTimezoneOffset();var Lr=new Date(Ct.getFullYear(),0,1).getTimezoneOffset();Ct=(ir!=Lr&&Ct.getTimezoneOffset()==Math.min(Lr,ir))|0,b()[Ht+32>>>2>>>0]=Ct},ea:function(Ct){Ct>>>=0;var Ht=new Date(b()[Ct+20>>>2>>>0]+1900,b()[Ct+16>>>2>>>0],b()[Ct+12>>>2>>>0],b()[Ct+8>>>2>>>0],b()[Ct+4>>>2>>>0],b()[Ct>>>2>>>0],0),ir=b()[Ct+32>>>2>>>0],Lr=Ht.getTimezoneOffset(),Xr=new Date(Ht.getFullYear(),6,1).getTimezoneOffset(),An=new Date(Ht.getFullYear(),0,1).getTimezoneOffset(),i0=Math.min(An,Xr);return 0>ir?b()[Ct+32>>>2>>>0]=+(Xr!=An&&i0==Lr):0<ir!=(i0==Lr)&&(Xr=Math.max(An,Xr),Ht.setTime(Ht.getTime()+6e4*((0<ir?i0:Xr)-Lr))),b()[Ct+24>>>2>>>0]=Ht.getDay(),ir=(sv(Ht.getFullYear())?ow:sw)[Ht.getMonth()]+Ht.getDate()-1|0,b()[Ct+28>>>2>>>0]=ir,b()[Ct>>>2>>>0]=Ht.getSeconds(),b()[Ct+4>>>2>>>0]=Ht.getMinutes(),b()[Ct+8>>>2>>>0]=Ht.getHours(),b()[Ct+12>>>2>>>0]=Ht.getDate(),b()[Ct+16>>>2>>>0]=Ht.getMonth(),b()[Ct+20>>>2>>>0]=Ht.getYear(),Ct=Ht.getTime(),BigInt(isNaN(Ct)?-1:Ct/1e3)},aa:uw,ba:lw,R:function(Ct,Ht,ir,Lr){Ct>>>=0,Ht>>>=0,ir>>>=0,Lr>>>=0;var Xr=new Date().getFullYear(),An=new Date(Xr,0,1),i0=new Date(Xr,6,1);Xr=An.getTimezoneOffset();var g0=i0.getTimezoneOffset(),k0=Math.max(Xr,g0);g()[Ct>>>2>>>0]=60*k0,b()[Ht>>>2>>>0]=+(Xr!=g0),Ct=w0=>w0.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1],An=Ct(An),i0=Ct(i0),g0<Xr?(c1(An,ir,17),c1(i0,Lr,17)):(c1(An,Lr,17),c1(i0,ir,17))},q:()=>{py("")},f:function(Ct,Ht,ir){return Ct>>>=0,Ht=k$(Ht>>>0,ir>>>0),L0[Ct](...Ht)},M:function(Ct,Ht,ir){return Ct>>>=0,Ht=k$(Ht>>>0,ir>>>0),L0[Ct](...Ht)},H:()=>{},L:()=>Date.now(),ra:()=>{throw T0+=1,"unwind"},T:function(){return 4294901760},u:()=>performance.timeOrigin+performance.now(),x:()=>No?(Ua(),sr(Ma)).cpus().length:navigator.hardwareConcurrency,Q:function(Ct){Ct>>>=0;var Ht=$().length;if(Ct<=Ht||4294901760<Ct)return!1;for(var ir=1;4>=ir;ir*=2){var Lr=Ht*(1+.2/ir);Lr=Math.min(Lr,Ct+100663296);var Xr=Math;Lr=Math.max(Ct,Lr);e:{Xr=(Xr.min.call(Xr,4294901760,Lr+(65536-Lr%65536)%65536)-xn.buffer.byteLength+65535)/65536;try{xn.grow(Xr),$y();var An=1;break e}catch{}An=void 0}if(An)return!0}return!1},ja:$v,la:C$,Z:Yr,B:u$,J:v1,ga:O$,I:A$,a:xn||vt.wasmMemory,ka:pw,r:function(Ct,Ht,ir,Lr){return pw(Ct>>>0,Ht>>>0,ir>>>0,Lr>>>0)}},C0=function(){function Ct(ir,Lr){return C0=ir.exports,C0=ov(),C0=t2(),u0.Qb.push(C0.cb),Gy.unshift(C0.va),f0=Lr,Ny(),C0}var Ht={a:wv};if(Ly++,vt.instantiateWasm)try{return vt.instantiateWasm(Ht,Ct)}catch(ir){d0(`Module.instantiateWasm callback failed with error: ${ir}`),Gt(ir)}return qy(Ht,function(ir){Ct(ir.instance,ir.module)}).catch(Gt),{}}(),d$=Ct=>(d$=C0.wa)(Ct);vt.__embind_initialize_bindings=()=>(vt.__embind_initialize_bindings=C0.xa)(),vt._OrtInit=(Ct,Ht)=>(vt._OrtInit=C0.ya)(Ct,Ht),vt._OrtGetLastError=(Ct,Ht)=>(vt._OrtGetLastError=C0.za)(Ct,Ht),vt._OrtCreateSessionOptions=(Ct,Ht,ir,Lr,Xr,An,i0,g0,k0,w0)=>(vt._OrtCreateSessionOptions=C0.Aa)(Ct,Ht,ir,Lr,Xr,An,i0,g0,k0,w0),vt._OrtAppendExecutionProvider=(Ct,Ht)=>(vt._OrtAppendExecutionProvider=C0.Ba)(Ct,Ht),vt._OrtAddFreeDimensionOverride=(Ct,Ht,ir)=>(vt._OrtAddFreeDimensionOverride=C0.Ca)(Ct,Ht,ir),vt._OrtAddSessionConfigEntry=(Ct,Ht,ir)=>(vt._OrtAddSessionConfigEntry=C0.Da)(Ct,Ht,ir),vt._OrtReleaseSessionOptions=Ct=>(vt._OrtReleaseSessionOptions=C0.Ea)(Ct),vt._OrtCreateSession=(Ct,Ht,ir)=>(vt._OrtCreateSession=C0.Fa)(Ct,Ht,ir),vt._OrtReleaseSession=Ct=>(vt._OrtReleaseSession=C0.Ga)(Ct),vt._OrtGetInputOutputCount=(Ct,Ht,ir)=>(vt._OrtGetInputOutputCount=C0.Ha)(Ct,Ht,ir),vt._OrtGetInputName=(Ct,Ht)=>(vt._OrtGetInputName=C0.Ia)(Ct,Ht),vt._OrtGetOutputName=(Ct,Ht)=>(vt._OrtGetOutputName=C0.Ja)(Ct,Ht),vt._OrtFree=Ct=>(vt._OrtFree=C0.Ka)(Ct),vt._OrtCreateTensor=(Ct,Ht,ir,Lr,Xr,An)=>(vt._OrtCreateTensor=C0.La)(Ct,Ht,ir,Lr,Xr,An),vt._OrtGetTensorData=(Ct,Ht,ir,Lr,Xr)=>(vt._OrtGetTensorData=C0.Ma)(Ct,Ht,ir,Lr,Xr),vt._OrtReleaseTensor=Ct=>(vt._OrtReleaseTensor=C0.Na)(Ct),vt._OrtCreateRunOptions=(Ct,Ht,ir,Lr)=>(vt._OrtCreateRunOptions=C0.Oa)(Ct,Ht,ir,Lr),vt._OrtAddRunConfigEntry=(Ct,Ht,ir)=>(vt._OrtAddRunConfigEntry=C0.Pa)(Ct,Ht,ir),vt._OrtReleaseRunOptions=Ct=>(vt._OrtReleaseRunOptions=C0.Qa)(Ct),vt._OrtCreateBinding=Ct=>(vt._OrtCreateBinding=C0.Ra)(Ct),vt._OrtBindInput=(Ct,Ht,ir)=>(vt._OrtBindInput=C0.Sa)(Ct,Ht,ir),vt._OrtBindOutput=(Ct,Ht,ir,Lr)=>(vt._OrtBindOutput=C0.Ta)(Ct,Ht,ir,Lr),vt._OrtClearBoundOutputs=Ct=>(vt._OrtClearBoundOutputs=C0.Ua)(Ct),vt._OrtReleaseBinding=Ct=>(vt._OrtReleaseBinding=C0.Va)(Ct),vt._OrtRunWithBinding=(Ct,Ht,ir,Lr,Xr)=>(vt._OrtRunWithBinding=C0.Wa)(Ct,Ht,ir,Lr,Xr),vt._OrtRun=(Ct,Ht,ir,Lr,Xr,An,i0,g0)=>(vt._OrtRun=C0.Xa)(Ct,Ht,ir,Lr,Xr,An,i0,g0),vt._OrtEndProfiling=Ct=>(vt._OrtEndProfiling=C0.Ya)(Ct),vt._JsepOutput=(Ct,Ht,ir)=>(vt._JsepOutput=C0.Za)(Ct,Ht,ir),vt._JsepGetNodeName=Ct=>(vt._JsepGetNodeName=C0._a)(Ct);var Ty=vt._pthread_self=()=>(Ty=vt._pthread_self=C0.$a)(),N1=vt._malloc=Ct=>(N1=vt._malloc=C0.ab)(Ct),k1=vt._free=Ct=>(k1=vt._free=C0.bb)(Ct);vt.__emscripten_tls_init=()=>(vt.__emscripten_tls_init=C0.cb)();var hw=vt.__emscripten_thread_init=(Ct,Ht,ir,Lr,Xr,An)=>(hw=vt.__emscripten_thread_init=C0.eb)(Ct,Ht,ir,Lr,Xr,An);vt.__emscripten_thread_crashed=()=>(vt.__emscripten_thread_crashed=C0.fb)();var c$=(Ct,Ht,ir,Lr,Xr)=>(c$=C0.gb)(Ct,Ht,ir,Lr,Xr),D$=Ct=>(D$=C0.hb)(Ct),M$=vt.__emscripten_thread_exit=Ct=>(M$=vt.__emscripten_thread_exit=C0.ib)(Ct),mw=()=>(mw=C0.jb)(),N$=(Ct,Ht)=>(N$=C0.kb)(Ct,Ht),Rv=Ct=>(Rv=C0.lb)(Ct),_v=Ct=>(_v=C0.mb)(Ct),z$=()=>(z$=C0.nb)(),j$=vt.dynCall_ii=(Ct,Ht)=>(j$=vt.dynCall_ii=C0.pb)(Ct,Ht),B$=Ct=>(B$=C0.qb)(Ct),p$=()=>(p$=C0.rb)(),f$=Ct=>(f$=C0.sb)(Ct),L$=()=>(L$=C0.tb)();vt.___start_em_js=839500,vt.___stop_em_js=839661;function t2(){var Ct=C0;Ct=Object.assign({},Ct);var Ht=Lr=>Xr=>Lr(Xr)>>>0,ir=Lr=>()=>Lr()>>>0;return Ct.wa=Ht(Ct.wa),Ct.$a=ir(Ct.$a),Ct.ab=Ht(Ct.ab),Ct.emscripten_main_runtime_thread_id=ir(Ct.emscripten_main_runtime_thread_id),Ct.mb=Ht(Ct.mb),Ct.nb=ir(Ct.nb),Ct}vt.wasmMemory=xn,vt.stackSave=()=>z$(),vt.stackRestore=Ct=>Rv(Ct),vt.stackAlloc=Ct=>_v(Ct),vt.keepRuntimeAlive=()=>0<T0,vt.UTF8ToString=_g,vt.stringToUTF8=c1,vt.lengthBytesUTF8=Ey,vt.ExitStatus=Dy,vt.PThread=u0;var Vv;Iy=function Ct(){Vv||m$(),Vv||(Iy=Ct)};function m$(){if(!(0<Ly))if(Qo)Ft(vt),Qo||O0(Gy),startWorker(vt);else{if(vt.preRun)for(typeof vt.preRun=="function"&&(vt.preRun=[vt.preRun]);vt.preRun.length;)_y.unshift(vt.preRun.shift());O0(_y),0<Ly||Vv||(Vv=!0,vt.calledRun=!0,$0||(Qo||O0(Gy),Ft(vt),Qo||O0(fv)))}}return m$(),qt}})();typeof e=="object"&&typeof i=="object"?i.exports=a:typeof define=="function"&&define.amd&&define([],()=>a)}),Ha=Er((e,i)=>{i.exports='"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(...e){var a=e.join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,a+`\n`);return}console.error(a)}function threadAlert(...e){var a=e.join(" ");postMessage({cmd:"alert",text:a,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,a)=>{var r=Module.wasmModule;Module.wasmModule=null;var t=new WebAssembly.Instance(r,e);return a(t)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let r=[];self.onmessage=t=>r.push(t),self.startWorker=t=>{Module=t,postMessage({cmd:"loaded"});for(let s of r)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const t of e.data.handlers)Module[t]=(...s)=>{postMessage({cmd:"callHandler",handler:t,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var a=URL.createObjectURL(e.data.urlOrBlob);importScripts(a),URL.revokeObjectURL(a)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(r){if(r!="unwind")throw r}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(r){throw Module.__emscripten_thread_crashed?.(),r}}self.onmessage=handleMessage;\n'}),La,gc,Hi,Gi,Un,Ga,yc,bc,vc,Fa,Fe,Or=j(()=>{La=za(),gc=Va(),Gi=!1,Un=!1,Ga=!1,yc=e=>{if(e===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},bc=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},vc=(e,i)=>e?i?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":i?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Fa=async e=>{if(Gi)return Promise.resolve();if(Un)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(Ga)throw new Error("previous call to 'initializeWebAssembly()' failed.");Un=!0;let i=e.initTimeout,a=e.numThreads,o=e.simd,c=yc(a),s=o&&bc(),d=e.wasmPaths,$=typeof d=="string"?d:void 0,et=vc(s,c),h=typeof d=="object"?d[et]:void 0,b=!1,g=[];if(i>0&&g.push(new Promise(st=>{setTimeout(()=>{b=!0,st()},i)})),g.push(new Promise((st,$t)=>{let vt=c?gc:La,Ft={locateFile:(Gt,qt)=>{if(c&&Gt.endsWith(".worker.js")&&typeof Blob<"u")return URL.createObjectURL(new Blob([Ha()],{type:"text/javascript"}));if(Gt.endsWith(".wasm")){if(h)return h;let Lt=$??qt;return et==="ort-wasm-simd.wasm"?Lt+"ort-wasm-simd.jsep.wasm":et==="ort-wasm-simd-threaded.wasm"?Lt+"ort-wasm-simd-threaded.jsep.wasm":Lt+et}return qt+Gt}};if(c)if(Ft.numThreads=a,typeof Blob>"u")Ft.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let Gt=`var ortWasmThreaded=${vt.toString()};`;Ft.mainScriptUrlOrBlob=new Blob([Gt],{type:"text/javascript"})}vt(Ft).then(Gt=>{Un=!1,Gi=!0,Hi=Gt,st()},Gt=>{Un=!1,Ga=!0,$t(Gt)})})),await Promise.race(g),b)throw new Error(`WebAssembly backend initializing failed due to timeout: ${i}ms`)},Fe=()=>{if(Gi&&Hi)return Hi;throw new Error("WebAssembly is not initialized yet.")}}),qe,Jr,We,Wn=j(()=>{Or(),qe=(e,i)=>{let a=Fe(),o=a.lengthBytesUTF8(e)+1,c=a._malloc(o);return a.stringToUTF8(e,c,o),i.push(c),c},Jr=(e,i,a,o)=>{if(typeof e=="object"&&e!==null){if(a.has(e))throw new Error("Circular reference in options");a.add(e)}Object.entries(e).forEach(([c,s])=>{let d=i?i+c:c;if(typeof s=="object")Jr(s,d+".",a,o);else if(typeof s=="string"||typeof s=="number")o(d,s.toString());else if(typeof s=="boolean")o(d,s?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof s}`)})},We=e=>{let i=Fe(),a=i.stackSave();try{let o=i.stackAlloc(8);i._OrtGetLastError(o,o+4);let c=i.HEAP32[o/4],s=i.HEAPU32[o/4+1],d=s?i.UTF8ToString(s):"";throw new Error(`${e} ERROR_CODE: ${c}, ERROR_MESSAGE: ${d}`)}finally{i.stackRestore(a)}}}),qa,ja=j(()=>{Or(),Wn(),qa=e=>{let i=Fe(),a=0,o=[],c=e||{};try{if((e==null?void 0:e.logSeverityLevel)===void 0)c.logSeverityLevel=2;else if(typeof e.logSeverityLevel!="number"||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if((e==null?void 0:e.logVerbosityLevel)===void 0)c.logVerbosityLevel=0;else if(typeof e.logVerbosityLevel!="number"||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);(e==null?void 0:e.terminate)===void 0&&(c.terminate=!1);let s=0;return(e==null?void 0:e.tag)!==void 0&&(s=qe(e.tag,o)),a=i._OrtCreateRunOptions(c.logSeverityLevel,c.logVerbosityLevel,!!c.terminate,s),a===0&&We("Can't create run options."),(e==null?void 0:e.extra)!==void 0&&Jr(e.extra,"",new WeakSet,(d,$)=>{let et=qe(d,o),h=qe($,o);i._OrtAddRunConfigEntry(a,et,h)!==0&&We(`Can't set a run config entry: ${d} - ${$}.`)}),[a,o]}catch(s){throw a!==0&&i._OrtReleaseRunOptions(a),o.forEach(d=>i._free(d)),s}}}),wc,$c,_c,xc,Ka,Ya=j(()=>{Or(),Wn(),wc=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},$c=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},_c=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let i=e.extra.session;i.use_ort_model_bytes_directly||(i.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(a=>(typeof a=="string"?a:a.name)==="webgpu")&&(e.enableMemPattern=!1)},xc=(e,i,a)=>{for(let o of i){let c=typeof o=="string"?o:o.name;switch(c){case"webnn":if(c="WEBNN",typeof o!="string"){let d=o;if(d!=null&&d.deviceType){let $=qe("deviceType",a),et=qe(d.deviceType,a);Fe()._OrtAddSessionConfigEntry(e,$,et)!==0&&We(`Can't set a session config entry: 'deviceType' - ${d.deviceType}.`)}if(d!=null&&d.numThreads){let $=d.numThreads;(typeof $!="number"||!Number.isInteger($)||$<0)&&($=0);let et=qe("numThreads",a),h=qe($.toString(),a);Fe()._OrtAddSessionConfigEntry(e,et,h)!==0&&We(`Can't set a session config entry: 'numThreads' - ${d.numThreads}.`)}if(d!=null&&d.powerPreference){let $=qe("powerPreference",a),et=qe(d.powerPreference,a);Fe()._OrtAddSessionConfigEntry(e,$,et)!==0&&We(`Can't set a session config entry: 'powerPreference' - ${d.powerPreference}.`)}}break;case"webgpu":if(c="JS",typeof o!="string"){let d=o;if(d!=null&&d.preferredLayout){if(d.preferredLayout!=="NCHW"&&d.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${d.preferredLayout}`);let $=qe("preferredLayout",a),et=qe(d.preferredLayout,a);Fe()._OrtAddSessionConfigEntry(e,$,et)!==0&&We(`Can't set a session config entry: 'preferredLayout' - ${d.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${c}`)}let s=qe(c,a);Fe()._OrtAppendExecutionProvider(e,s)!==0&&We(`Can't append execution provider: ${c}.`)}},Ka=e=>{let i=Fe(),a=0,o=[],c=e||{};_c(c);try{let s=wc(c.graphOptimizationLevel??"all"),d=$c(c.executionMode??"sequential"),$=typeof c.logId=="string"?qe(c.logId,o):0,et=c.logSeverityLevel??2;if(!Number.isInteger(et)||et<0||et>4)throw new Error(`log serverity level is not valid: ${et}`);let h=c.logVerbosityLevel??0;if(!Number.isInteger(h)||h<0||h>4)throw new Error(`log verbosity level is not valid: ${h}`);let b=typeof c.optimizedModelFilePath=="string"?qe(c.optimizedModelFilePath,o):0;if(a=i._OrtCreateSessionOptions(s,!!c.enableCpuMemArena,!!c.enableMemPattern,d,!!c.enableProfiling,0,$,et,h,b),a===0&&We("Can't create session options."),c.executionProviders&&xc(a,c.executionProviders,o),c.enableGraphCapture!==void 0){if(typeof c.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${c.enableGraphCapture}`);let g=qe("enableGraphCapture",o),st=qe(c.enableGraphCapture.toString(),o);i._OrtAddSessionConfigEntry(a,g,st)!==0&&We(`Can't set a session config entry: 'enableGraphCapture' - ${c.enableGraphCapture}.`)}if(c.freeDimensionOverrides)for(let[g,st]of Object.entries(c.freeDimensionOverrides)){if(typeof g!="string")throw new Error(`free dimension override name must be a string: ${g}`);if(typeof st!="number"||!Number.isInteger(st)||st<0)throw new Error(`free dimension override value must be a non-negative integer: ${st}`);let $t=qe(g,o);i._OrtAddFreeDimensionOverride(a,$t,st)!==0&&We(`Can't set a free dimension override: ${g} - ${st}.`)}return c.extra!==void 0&&Jr(c.extra,"",new WeakSet,(g,st)=>{let $t=qe(g,o),vt=qe(st,o);i._OrtAddSessionConfigEntry(a,$t,vt)!==0&&We(`Can't set a session config entry: ${g} - ${st}.`)}),[a,o]}catch(s){throw a!==0&&i._OrtReleaseSessionOptions(a),o.forEach(d=>i._free(d)),s}}}),Li,Yt,cr,Nn,en,Vn,Fi,ye=j(()=>{Li=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},Yt=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},cr=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],Nn=e=>{switch(e){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},en=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},Vn=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint8"||e==="bool",Fi=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${e}`)}}}),tn,qi=j(()=>{tn=async e=>{if(typeof e=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(e))}catch(i){if(i.code==="ERR_FS_FILE_TOO_LARGE"){let a=(void 0)(e),o=[];for await(let c of a)o.push(c);return new Uint8Array(Buffer.concat(o))}throw i}else{let i=await fetch(e);if(!i.ok)throw new Error(`failed to load external data file: ${e}`);let a=i.headers.get("Content-Length"),o=a?parseInt(a,10):0;if(o<1073741824)return new Uint8Array(await i.arrayBuffer());{if(!i.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let c=i.body.getReader(),s;try{s=new ArrayBuffer(o)}catch($){if($ instanceof RangeError){let et=Math.ceil(o/65536);s=new WebAssembly.Memory({initial:et,maximum:et}).buffer}else throw $}let d=0;for(;;){let{done:$,value:et}=await c.read();if($)break;let h=et.byteLength;new Uint8Array(s,d,h).set(et),d+=h}return new Uint8Array(s,0,o)}}else return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)}}),Sc,Cc,Xa,Za,Qa,Ic,Ne,Xt=j(()=>{ye(),Sc=["V","I","W","E","F"],Cc=(e,i)=>{console.log(`[${Sc[e]},${new Date().toISOString()}]${i}`)},Qa=(e,i)=>{Xa=e,Za=i},Ic=(e,i)=>{let a=en(e),o=en(Xa);a>=o&&Cc(a,typeof i=="function"?i():i)},Ne=(...e)=>{Za&&Ic(...e)}}),Ja,es=j(()=>{ye(),Ja=(e,i)=>new(Nn(i))(e)}),Hn=j(()=>{}),ts,ji,Ki,Tc,Ac,rs,Xi,Yi,is,os=j(()=>{Xt(),Hn(),ts=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[12582912,10],[16777216,10],[26214400,15],[33554432,22],[44236800,2],[58982400,6],[67108864,6],[134217728,6],[167772160,6]]),ji=[],Ki=e=>Math.ceil(e/16)*16,Tc=e=>{for(let i=0;i<ji.length;i++){let a=ji[i];if(e<=a)return a}return Math.ceil(e/16)*16},Ac=1,rs=()=>Ac++,Xi=async(e,i,a,o)=>{let c=Ki(a),s=e.device.createBuffer({size:c,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let d=e.getCommandEncoder();e.endComputePass(),d.copyBufferToBuffer(i,0,s,0,c),e.flush(),await s.mapAsync(GPUMapMode.READ);let $=s.getMappedRange();if(o){let et=o();return et.set(new Uint8Array($,0,a)),et}else return new Uint8Array($.slice(0,a))}finally{s.destroy()}},Yi=class{constructor(e){this.backend=e,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersForUploadingPending=[],this.buffersPending=[],this.externalBuffers=new Map,this.capturedPendingBuffers=new Map;for(let[i]of ts)ji.push(i),this.freeBuffers.set(i,[]),this.freeUniformBuffers.set(i,[])}upload(e,i){let a=i.buffer,o=i.byteOffset,c=i.byteLength,s=Ki(c),d=this.storageCache.get(e);if(!d)throw new Error("gpu data for uploading does not exist");if(d.originalSize!==c)throw new Error(`inconsistent data size. gpu data size=${d.originalSize}, data size=${c}`);let $=this.backend.device.createBuffer({mappedAtCreation:!0,size:s,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),et=$.getMappedRange();new Uint8Array(et).set(new Uint8Array(a,o,c)),$.unmap();let h=this.backend.getCommandEncoder();this.backend.endComputePass(),h.copyBufferToBuffer($,0,d.gpuData.buffer,0,s),Ne("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${e})`),this.buffersForUploadingPending.push($)}memcpy(e,i){let a=this.storageCache.get(e);if(!a)throw new Error("source gpu data for memcpy does not exist");let o=this.storageCache.get(i);if(!o)throw new Error("destination gpu data for memcpy does not exist");if(a.originalSize!==o.originalSize)throw new Error("inconsistent source and destination gpu data size");let c=Ki(a.originalSize),s=this.backend.getCommandEncoder();this.backend.endComputePass(),s.copyBufferToBuffer(a.gpuData.buffer,0,o.gpuData.buffer,0,c)}registerExternalBuffer(e,i,a){let o;if(a){if(o=this.externalBuffers.get(a),o===void 0)throw new Error("previous buffer is not registered");if(e===a)return Ne("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${i}) => id=${o}, buffer is the same, skip.`),o;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error(`Registering a different external buffer under graph capture mode is not supported yet.
             Please use the previous external buffer!`);this.externalBuffers.delete(a)}else o=rs();return this.storageCache.set(o,{gpuData:{id:o,type:0,buffer:e},originalSize:i}),this.externalBuffers.set(e,o),Ne("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${i}) => id=${o}, registered.`),o}unregisterExternalBuffer(e){let i=this.externalBuffers.get(e);i!==void 0&&(this.storageCache.delete(i),this.externalBuffers.delete(e),Ne("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${i}`))}create(e,i=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let a=Tc(e),o,c=(i&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,s=(i&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(c||s){let $=(c?this.freeBuffers:this.freeUniformBuffers).get(a);$?$.length>0?o=$.pop():o=this.backend.device.createBuffer({size:a,usage:i}):o=this.backend.device.createBuffer({size:a,usage:i})}else o=this.backend.device.createBuffer({size:a,usage:i});let d={id:rs(),type:0,buffer:o};return this.storageCache.set(d.id,{gpuData:d,originalSize:e}),Ne("verbose",()=>`[WebGPU] GpuDataManager.create(size=${e}) => id=${d.id}`),d}get(e){var i;return(i=this.storageCache.get(e))==null?void 0:i.gpuData}release(e){let i=this.storageCache.get(e);if(!i)throw new Error("releasing data does not exist");return Ne("verbose",()=>`[WebGPU] GpuDataManager.release(id=${e}), gpuDataId=${i.gpuData.id}`),this.storageCache.delete(e),this.buffersPending.push(i.gpuData.buffer),i.originalSize}async download(e,i){let a=this.storageCache.get(e);if(!a)throw new Error("data does not exist");await Xi(this.backend,a.gpuData.buffer,a.originalSize,i)}refreshPendingBuffers(){for(let e of this.buffersForUploadingPending)e.destroy();if(this.buffersForUploadingPending=[],this.buffersPending.length!==0)if(this.backend.sessionStatus==="default"){for(let e of this.buffersPending){let i=ts.get(e.size);if((e.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let a=this.freeBuffers.get(e.size)||[];i===void 0||a.length>=i?e.destroy():a.push(e)}else if((e.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let a=this.freeUniformBuffers.get(e.size)||[];i===void 0||a.length>=i?e.destroy():a.push(e)}else e.destroy()}this.buffersPending=[]}else{let e=this.capturedPendingBuffers.get(this.backend.currentSessionId);e||(e=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,e));for(let i of this.buffersPending)e.push(i);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(e=>{e.forEach(i=>{i.destroy()})}),this.freeUniformBuffers.forEach(e=>{e.forEach(i=>{i.destroy()})}),this.storageCache.forEach(e=>{e.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(e=>{e.forEach(i=>{i.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onReleaseSession(e){let i=this.capturedPendingBuffers.get(e);i&&(i.forEach(a=>{a.destroy()}),this.capturedPendingBuffers.delete(e))}},is=(...e)=>new Yi(...e)}),Zi,we,Ze=j(()=>{Zi=class{constructor(e){Object.assign(this,e)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(e=>`${this[e]}`).join(";")),this.key}},we=e=>new Zi(e)}),Qi,zt,M,pr,Gn,Ln,Fn,xe=j(()=>{Qi=class{static calcMatMulShape(e,i){return e[1]!==i[0]?void 0:[e[0],i[1]]}},zt=class{static calcShape(e,i,a=!1){let o=e.length,c=i.length;if(o===0)return i;if(c===0)return e;let s=Math.max(e.length,i.length),d=new Array(s);if(a){if(o<2||c<2)return;let $=Qi.calcMatMulShape([e[o-2],e[o-1]],[i[c-2],i[c-1]]);if($===void 0)return;[d[s-2],d[s-1]]=$}for(let $=a?3:1;$<=s;$++){let et=o-$<0?1:e[o-$],h=c-$<0?1:i[c-$];if(et!==h&&et>1&&h>1)return;let b=Math.max(et,h);if(et&&h)d[s-$]=Math.max(et,h);else{if(b>1)return;d[s-$]=0}}return d}static isValidBroadcast(e,i){let a=e.length,o=i.length;if(a>o)return!1;for(let c=1;c<=a;c++)if(e[a-c]!==1&&e[a-c]!==i[o-c])return!1;return!0}},M=class e2{static size(i){return e2.getSizeFromDimensionRange(i,0,i.length)}static convertShape(i,a=4){let o=i.length;if(o===0)return[];let c=new Array(o),s=o-1;for(;s>=0;){if(i[s]%a===0){c[s]=i[s]/a;break}if(a%i[s]!==0)throw new Error("cannot convert shape");c[s]=1,a/=i[s],s--}for(s--;s>=0;s--)c[s]=i[s];return c}static sizeFromDimension(i,a){if(a<0||a>i.length)throw new Error(`invalid dimension of ${a} for sizeFromDimension as Tensor has ${i.length} dimensions.`);return e2.getSizeFromDimensionRange(i,a,i.length)}static sizeToDimension(i,a){if(a<0||a>i.length)throw new Error(`invalid dimension of ${a} for sizeToDimension as Tensor has ${i.length} dimensions.`);return e2.getSizeFromDimensionRange(i,0,a)}static getSizeFromDimensionRange(i,a,o){let c=1;for(let s=a;s<o;s++){if(i[s]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");c*=i[s]}return c}static computeStrides(i){let a=i.length;if(a===0)return[];if(a===1)return[1];let o=new Array(a);o[a-1]=1,o[a-2]=i[a-1];for(let c=a-3;c>=0;--c)o[c]=o[c+1]*i[c+1];return o}static normalizeAxis(i,a){if(i<-a&&i>=a)throw new Error("unsupported axis for this operation.");return i<0?i+a:i}static normalizeAxes(i,a){return i.map(o=>this.normalizeAxis(o,a??i.length))}static sortBasedOnPerm(i,a){return a?a.map(o=>i[o]):i.slice().reverse()}static padShape(i,a){let o=i.length;return i.map((c,s)=>c+a[s]+a[s+o])}static areEqual(i,a){return i.length!==a.length?!1:i.every((o,c)=>o===a[c])}},pr=class aw{static adjustPoolAttributes(i,a,o,c,s,d){if(!i&&o.length!==a.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(i)for(let $=0;$<a.length-2;$++)$>=o.length?o.push(a[$+2]):o[$]=a[$+2];for(let $=0;$<o.length;$++)if($<c.length){if(c[$]<0)throw new Error("strides should be greater than or equal to 1")}else c.push(1);for(let $=0;$<o.length;$++)if($<s.length){if(s[$]<0)throw new Error("dilations should be greater than or equal to 1")}else s.push(1);for(let $=0;$<o.length*2;$++)if($<d.length){if(d[$]<0)throw new Error("pad should be greater than or equal to 1")}else d.push(0);for(let $=0;$<o.length;$++){if(o[$]<=0)throw new Error("kernel shapes need to be greater than 0");if(d[$]>=o[$]||d[$+o.length]>=o[$])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(i,a,o,c,s,d,$){if($){if(s.length!==2*(i.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(a.length!==i.length-2)throw new Error("length of strides should be the length of data dimensions");if(c.length!==i.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let et=0;et<i.length-2;et++)aw.adjustPadAndReturnShape(i[et+(d?1:2)],a[et],o[et],c[et],s,et,et+i.length-2,$)}}static computePoolOutputShape(i,a,o,c,s,d,$){if(a.length<=0)throw new Error("input shape must be of size greater than 0");let et=[a[0],a[1]];return aw.computeShapeHelper(i,a,et,o,c,s,d,$),et}static computeConvOutputShape(i,a,o,c,s,d,$){if(i.length<=0||a.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let et=[i[0],a[0]];return aw.computeShapeHelper(!1,i,et,o,c,s,d,$),et}static computeShapeHelper(i,a,o,c,s,d,$,et){if(i)for(let h=0;h<a.length-2;h++)o.push(1);else for(let h=0;h<a.length-2;h++)o.push(aw.adjustPadAndReturnShape(a[h+2],c[h],s[h],d[h],$,h,h+a.length-2,et))}static adjustPadAndReturnShape(i,a,o,c,s,d,$,et){let h=o*(c-1)+1;if(et&&et!=="NOTSET")switch(et){case"VALID":return s[d]=0,s[$]=0,Math.floor((i-h)/a+1);case"SAME_LOWER":case"SAME_UPPER":if(o!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let b=((i+a-1)/a-1)*a+c-i;return s[d]=Math.floor(et==="SAME_LOWER"?(b+1)/2:b/2),s[$]=b-s[d],Math.floor((i+b-c)/a+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((i+s[d]+s[$]-h)/a+1)}},Gn=class{static getShapeOfGemmResult(e,i,a,o,c){if(e.length!==2||a.length!==2)throw new Error("shape need to be of size 2");let s,d,$;i?(s=e[1],d=e[0]):(s=e[0],d=e[1]);let et=-1;if(o?($=a[0],et=1):($=a[1],et=0),a[et]!==d)throw new Error("dimension mismatch");if(s<=0||$<=0||d<=0)throw new Error("invalid shape specified");if(c&&!zt.isValidBroadcast(c,[s,$]))throw new Error("gemm: invalid bias shape for broadcast");return[s,$,d]}},Ln=-34028234663852886e22,Fn=34028234663852886e22}),mr,eo,De,rt,X,Ue,At,fr,Et,fe,to$1,U,K,qn,Ji,as,Pr,_e=j(()=>{ye(),xe(),mr=64,eo=(e,i)=>{if(i===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(e){case 10:return i>1?`vec${i}<f16>`:"f16";case 1:return i>1?`vec${i}<f32>`:"f32";case 6:return i>1?`vec${i}<i32>`:"i32";case 12:return i>1?`vec${i}<u32>`:"u32";case 7:if(i>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(i>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(i!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];default:throw new Error(`Unknown data type: ${e}`)}},De=(e,i=1)=>{let a=eo(e,i);return typeof a=="string"?a:a[0]},rt=(e,i=1)=>{let a=eo(e,i);return typeof a=="string"?a:a[1]},X=(...e)=>{let i=[];return e.forEach(a=>{a.length!==0&&i.push({type:12,data:a},{type:12,data:M.computeStrides(a)})}),i},Ue=e=>e%4===0?4:e%2===0?2:1,At=(e="f32",i,a="0")=>!i||i===1?`${e}(${a})`:`vec${i}<${e}>(${a})`,fr=(e,i,a)=>e==="f32"?a:i===1?`f32(${a})`:`vec${i}<f32>(${a})`,Et=(e,i)=>i===4?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:i===2?`(${e}.x + ${e}.y)`:i===3?`(${e}.x + ${e}.y + ${e}.z)`:e,fe=(e,i,a,o)=>e.startsWith("uniforms.")&&a>4?typeof i=="string"?o==="f16"?`${e}[(${i}) / 8][(${i}) % 8 / 4][(${i}) % 8 % 4]`:`${e}[(${i}) / 4][(${i}) % 4]`:o==="f16"?`${e}[${Math.floor(i/8)}][${Math.floor(i%8/4)}][${i%8%4}]`:`${e}[${Math.floor(i/4)}][${i%4}]`:a>1?`${e}[${i}]`:e,to$1=(e,i,a,o,c)=>{let s=typeof a=="number",d=s?a:a.length,$=[...new Array(d).keys()],et=d<2?"u32":d<=4?`vec${d}<u32>`:`array<u32, ${d}>`,h=eo(i,c),b=typeof h=="string"?h:h[1],g=typeof h=="string"?h:h[0],st={indices:et,value:b,storage:g,tensor:i},$t=xn=>typeof xn=="string"?xn:`${xn}u`,vt={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},Ft=s?"uniforms.":"",Gt=`${Ft}${e}_shape`,qt=`${Ft}${e}_strides`,Lt="";for(let xn=0;xn<d-1;xn++)Lt+=`
    let dim${xn} = current / ${fe(qt,xn,d)};
    let rest${xn} = current % ${fe(qt,xn,d)};
    indices[${xn}] = dim${xn};
    current = rest${xn};
    `;Lt+=`indices[${d-1}] = current;`;let rr=d<2?"":`
  fn o2i_${e}(offset: u32) -> ${st.indices} {
    var indices: ${st.indices};
    var current = offset;
    ${Lt}
    return indices;
  }`,jr=xn=>(vt.offsetToIndices=!0,d<2?xn:`o2i_${e}(${xn})`),Hr=[];if(d>=2)for(let xn=d-1;xn>=0;xn--)Hr.push(`${fe(qt,xn,d)} * (indices[${xn}])`);let wn=d<2?"":`
  fn i2o_${e}(indices: ${st.indices}) -> u32 {
    return ${Hr.join("+")};
  }`,_n=xn=>(vt.indicesToOffset=!0,d<2?xn:`i2o_${e}(${xn})`),No=(...xn)=>d===0?"0u":`${st.indices}(${xn.map($t).join(",")})`,Qo=(xn,f0)=>d<2?`${xn}`:`${fe(xn,f0,d)}`,Xo=(xn,f0,$0)=>d<2?`${xn}=${$0};`:`${fe(xn,f0,d)}=${$0};`,l0={},v0=(xn,f0)=>{vt.broadcastedIndicesToOffset=!0;let $0=`${f0.name}broadcastedIndicesTo${e}Offset`;if($0 in l0)return`${$0}(${xn})`;let N0=[];for(let j0=d-1;j0>=0;j0--){let Z0=f0.indicesGet("outputIndices",j0+f0.rank-d);N0.push(`${Qo(qt,j0)} * (${Z0} % ${Qo(Gt,j0)})`)}return l0[$0]=`fn ${$0}(outputIndices: ${f0.type.indices}) -> u32 {
             return ${N0.length>0?N0.join("+"):"0u"};
           }`,`${$0}(${xn})`},x0=(xn,f0)=>(()=>{if(st.storage===st.value)return`${e}[${xn}]=${f0};`;if(st.storage==="vec2<u32>"&&st.value==="i32")return`${e}[${xn}]=vec2<u32>(u32(${f0}), select(0u, 0xFFFFFFFFu, ${f0} < 0));`;if(st.storage==="vec2<u32>"&&st.value==="u32")return`${e}[${xn}]=vec2<u32>(u32(${f0}), 0u);`;if(st.storage==="u32"&&st.value==="vec4<bool>")return`${e}[${xn}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${f0}));`;throw new Error(`not supported combination of storage type ${st.storage} and value type ${st.value} yet`)})(),D0=xn=>(()=>{if(st.storage===st.value)return`${e}[${xn}]`;if(st.storage==="vec2<u32>"&&st.value==="i32")return`i32(${e}[${xn}].x)`;if(st.storage==="vec2<u32>"&&st.value==="u32")return`u32(${e}[${xn}].x)`;if(st.storage==="u32"&&st.value==="vec4<bool>")return`vec4<bool>(bool(${e}[${xn}] & 0xFFu), bool(${e}[${xn}] & 0xFF00u), bool(${e}[${xn}] & 0xFF0000u), bool(${e}[${xn}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${st.storage} and value type ${st.value} yet`)})(),M0=d<2?"":`
  fn get_${e}ByIndices(indices: ${st.indices}) -> ${b} {
    return ${D0(`i2o_${e}(indices)`)};
  }`,Mo=d<2?"":(()=>{let xn=$.map($0=>`d${$0}: u32`).join(", "),f0=$.map($0=>`d${$0}`).join(", ");return`
  fn get_${e}(${xn}) -> ${b} {
    return get_${e}ByIndices(${No(f0)});
  }`})(),e0=(...xn)=>{if(xn.length!==d)throw new Error(`indices length must be ${d}`);let f0=xn.map($t).join(",");return d===0?D0("0u"):d===1?D0(f0[0]):(vt.get=!0,vt.getByIndices=!0,vt.indicesToOffset=!0,`get_${e}(${f0})`)},Sn=xn=>d<2?D0(xn):(vt.getByIndices=!0,vt.indicesToOffset=!0,`get_${e}ByIndices(${xn})`),t0=d<2?"":`
  fn set_${e}ByIndices(indices: ${st.indices}, value: ${b}) {
    ${x0(`i2o_${e}(indices)`,"value")}
  }`,d0=d<2?"":(()=>{let xn=$.map($0=>`d${$0}: u32`).join(", "),f0=$.map($0=>`d${$0}`).join(", ");return`
  fn set_${e}(${xn}, value: ${b}) {
    set_${e}ByIndices(${No(f0)}, value);
  }`})();return{impl:()=>{let xn=[],f0=!1;return vt.offsetToIndices&&(xn.push(rr),f0=!0),vt.indicesToOffset&&(xn.push(wn),f0=!0),vt.broadcastedIndicesToOffset&&(Object.values(l0).forEach($0=>xn.push($0)),f0=!0),vt.set&&(xn.push(d0),f0=!0),vt.setByIndices&&(xn.push(t0),f0=!0),vt.get&&(xn.push(Mo),f0=!0),vt.getByIndices&&(xn.push(M0),f0=!0),!s&&f0&&xn.unshift(`const ${Gt} = ${st.indices}(${a.join(",")});`,`const ${qt} = ${st.indices}(${M.computeStrides(a).join(",")});`),xn.join(`
`)},type:st,offsetToIndices:jr,indicesToOffset:_n,broadcastedIndicesToOffset:v0,indices:No,indicesGet:Qo,indicesSet:Xo,set:(...xn)=>{if(xn.length!==d+1)throw new Error(`indices length must be ${d}`);let f0=xn[d];if(typeof f0!="string")throw new Error("value must be string");let $0=xn.slice(0,d).map($t).join(",");return d===0?x0("0u",f0):d===1?x0($0[0],f0):(vt.set=!0,vt.setByIndices=!0,vt.indicesToOffset=!0,`set_${e}(${$0}, ${f0})`)},setByOffset:x0,setByIndices:(xn,f0)=>d<2?x0(xn,f0):(vt.setByIndices=!0,vt.indicesToOffset=!0,`set_${e}ByIndices(${xn}, ${f0});`),get:e0,getByOffset:D0,getByIndices:Sn,usage:o,name:e,strides:qt,shape:Gt,rank:d}},U=(e,i,a,o=1)=>to$1(e,i,a,"input",o),K=(e,i,a,o=1)=>to$1(e,i,a,"output",o),qn=(e,i,a,o=1)=>to$1(e,i,a,"internal",o),Ji=class{constructor(e,i){this.normalizedDispatchGroup=e,this.limits=i,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(e){return`if (global_idx >= ${typeof e=="number"?`${e}u`:e}) { return; }`}mainStart(e=mr){let i=typeof e=="number"?e:e[0],a=typeof e=="number"?1:e[1],o=typeof e=="number"?1:e[2];if(i>this.limits.maxComputeWorkgroupSizeX||a>this.limits.maxComputeWorkgroupSizeY||o>this.limits.maxComputeWorkgroupSizeZ)throw new Error(`workgroup size [${i}, ${a}, ${o}] exceeds the maximum workgroup size [${this.limits.maxComputeWorkgroupSizeX}, ${this.limits.maxComputeWorkgroupSizeY}, ${this.limits.maxComputeWorkgroupSizeZ}].`);if(i*a*o>this.limits.maxComputeInvocationsPerWorkgroup)throw new Error(`workgroup size [${i}, ${a}, ${o}] exceeds the maximum workgroup invocations ${this.limits.maxComputeInvocationsPerWorkgroup}.`);let c=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,s=c?`@builtin(global_invocation_id) global_id : vec3<u32>,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(global_invocation_id) global_id : vec3<u32>,
                                             @builtin(local_invocation_id) local_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(num_workgroups) num_workgroups : vec3<u32>`,d=c?"let global_idx = global_id.x; let local_idx = local_id.x;":`let global_idx = (workgroup_id.z * num_workgroups[0] * num_workgroups[1] +
          workgroup_id.y * num_workgroups[0] + workgroup_id.x) * ${i*a*o}u + local_idx;`;return`@compute @workgroup_size(${i}, ${a}, ${o})
  fn main(${s}) {
    ${d}
  `}appendVariableUniforms(e){e.rank!==0&&(e.shape.startsWith("uniforms.")&&this.uniforms.push({name:e.shape.replace("uniforms.",""),type:"u32",length:e.rank}),e.strides.startsWith("uniforms.")&&this.uniforms.push({name:e.strides.replace("uniforms.",""),type:"u32",length:e.rank}))}declareVariable(e,i){if(e.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(e),this.appendVariableUniforms(e);let a=e.usage==="input"?"read":"read_write",o=e.type.storage;return`@group(0) @binding(${i}) var<storage, ${a}> ${e.name}: array<${o}>;`}declareVariables(...e){return e.map(i=>this.declareVariable(i,this.variableIndex++)).join(`
`)}registerInternalVariable(e){if(e.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(e),this.appendVariableUniforms(e)}registerInternalVariables(...e){return e.forEach(i=>this.registerInternalVariable(i)),this}registerUniform(e,i,a=1){return this.uniforms.push({name:e,type:i,length:a}),this}registerUniforms(e){return this.uniforms=this.uniforms.concat(e),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let e=[];for(let{name:i,type:a,length:o}of this.uniforms)if(o&&o>4)a==="f16"?e.push(`@align(16) ${i}:array<mat2x4<${a}>, ${Math.ceil(o/8)}>`):e.push(`${i}:array<vec4<${a}>, ${Math.ceil(o/4)}>`);else{let c=o==null||o===1?a:`vec${o}<${a}>`;e.push(`${i}:${c}`)}return`
      struct Uniforms { ${e.join(", ")} };
      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(e=>e.impl()).join(`
`)+this.internalVariables.map(e=>e.impl()).join(`
`)}get variablesInfo(){if(this.uniforms.length===0)return;let e=i=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(i)];return this.uniforms.map(i=>[e(i.type),i.length??1])}},as=(e,i)=>new Ji(e,i),Pr=(e,i)=>{let a=e.length,o=[];for(let c=0;c<a;c++){let s=a-1-c,d=e[s]||1;(i[i.length-1-c]||1)>1&&d===1&&o.unshift(s)}return o}}),Ec,ss,kc,Oc,xt,us,ls,Rr=j(()=>{ye(),xe(),Ze(),_e(),Ec=e=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.")},ss=(e,i)=>i&&i.length!==e?[...new Array(e).keys()].reverse():i,kc=(e,i)=>M.sortBasedOnPerm(e,ss(e.length,i)),Oc=(e,i,a,o)=>{let c=[];c.push(`fn perm(i: ${o.type.indices}) -> ${a.type.indices} {
    var a: ${a.type.indices};`);for(let s=0;s<i;++s)c.push(a.indicesSet("a",e[s],`i[${s}]`));return c.push("return a;}"),c.join(`
`)},xt=(e,i)=>{let a=e.dataType,o=e.dims.length,c=ss(o,i),s=kc(e.dims,c),d=K("output",a,s.length),$=U("a",a,o),et=h=>`
  ${h.registerUniform("output_size","u32").declareVariables($,d)}

  ${Oc(c,o,$,d)}

  ${h.mainStart()}
    ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${d.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${d.setByOffset("global_idx",$.getByIndices("aIndices"))}
  }`;return{name:"Transpose",shaderCache:{hint:`${i}`,inputDependencies:["rank"]},getRunData:h=>{let b=M.size(s);return{outputs:[{dims:s,dataType:h[0].dataType}],dispatchGroup:{x:Math.ceil(b/64)},programUniforms:[{type:12,data:b},...X(h[0].dims,s)]}},getShaderSource:et}},us=(e,i)=>{Ec(e.inputs),e.compute(xt(e.inputs[0],i.perm))},ls=e=>we({perm:e.perm})}),Pc,Rc,zc,Bc,Dc,Mc,Uc,Wc,Nc,Vc,Bt,ds,cs,ps,ms,fs,hs,gs,ys,bs,vs,ws=j(()=>{ye(),xe(),_e(),jn(),Rr(),Pc={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},Rc={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},zc={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},Bc={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},Dc=(e,i)=>{let a=[];for(let o=i-e;o<i;++o)a.push(o);return a},Mc=(e,i)=>{let a=[],o=e.length;for(let s=0;s<o;s++)i.indexOf(s)===-1&&a.push(e[s]);let c=i.map(s=>e[s]);return[a,c]},Uc=(e,i)=>{let a=e.length+i.length,o=[],c=0;for(let s=0;s<a;s++)i.indexOf(s)===-1?o.push(e[c++]):o.push(1);return o},Wc=(e,i)=>{for(let a=0;a<e.length;++a)if(e[e.length-a-1]!==i-1-a)return!1;return!0},Nc=(e,i)=>{let a=[];if(!Wc(e,i)){for(let o=0;o<i;++o)e.indexOf(o)===-1&&a.push(o);e.forEach(o=>a.push(o))}return a},Vc=(e,i,a,o,c,s,d)=>{let $=a[0].dims,et=M.size(s),h=M.size(d),b=U("_A",a[0].dataType,$),g=K("output",c,s),st=32,$t=`
          var<workgroup> aBestValues : array<f32, ${st}>;
       `;return{name:e,shaderCache:i,getShaderSource:vt=>`
        ${vt.registerUniform("reduceSize","u32").declareVariables(b,g)}
        ${$t}
        fn DIV_CEIL(a : u32, b : u32) -> u32 {
          return ((a - 1u) / b + 1u);
         }
         ${vt.mainStart(st)}

          let outputIndex = global_idx / ${st};
          let offset = outputIndex * uniforms.reduceSize;

          var bestValue = f32(${zc[o]});
          let Length = uniforms.reduceSize;
          for (var k = local_idx; k < Length; k = k + ${st}) {
           let candidate = f32(${b.getByOffset("offset + k")});
           bestValue = ${Pc[o]};
          }
          aBestValues[local_idx] = bestValue;
          workgroupBarrier();

         var reduceSize = min(Length, ${st}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (local_idx < currentSize) {
            let candidate = aBestValues[local_idx + interval];
            bestValue = ${Rc[o]};
            aBestValues[local_idx] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (local_idx == 0u) {
          ${g.setByOffset("outputIndex",`${o==="mean"?`${g.type.storage}(bestValue / f32(uniforms.reduceSize))`:`${g.type.storage}(${Bc[o]})`}`)};
         }
        }`,getRunData:()=>({outputs:[{dims:s,dataType:c}],dispatchGroup:{x:et},programUniforms:[{type:12,data:h}]})}},Bt=(e,i,a,o)=>{let c=e.inputs.length===1?a:ro(e.inputs,a),s=c.axes;s.length===0&&!c.noopWithEmptyAxes&&(s=e.inputs[0].dims.map(($t,vt)=>vt));let d=M.normalizeAxes(s,e.inputs[0].dims.length),$=d,et=e.inputs[0],h=Nc($,e.inputs[0].dims.length);h.length>0&&(et=e.compute(xt(e.inputs[0],h),{inputs:[0],outputs:[-1]})[0],$=Dc($.length,et.dims.length));let[b,g]=Mc(et.dims,$),st=b;c.keepDims&&(st=Uc(b,d)),e.compute(Vc(i,{hint:c.cacheKey,inputDependencies:["type"]},[et],o,e.inputs[0].dataType,st,g),{inputs:[et]})},ds=(e,i)=>{Bt(e,"ReduceMeanShared",i,"mean")},cs=(e,i)=>{Bt(e,"ReduceL1Shared",i,"l1")},ps=(e,i)=>{Bt(e,"ReduceL2Shared",i,"l2")},ms=(e,i)=>{Bt(e,"ReduceLogSumExpShared",i,"logSumExp")},fs=(e,i)=>{Bt(e,"ReduceMaxShared",i,"max")},hs=(e,i)=>{Bt(e,"ReduceMinShared",i,"min")},gs=(e,i)=>{Bt(e,"ReduceProdShared",i,"prod")},ys=(e,i)=>{Bt(e,"ReduceSumShared",i,"sum")},bs=(e,i)=>{Bt(e,"ReduceSumSquareShared",i,"sumSquare")},vs=(e,i)=>{Bt(e,"ReduceLogSumShared",i,"logSum")}}),Dt,Hc,Kn,ro,Mt,Gc,Lc,Fc,qc,jc,Kc,Yc,Xc,Zc,Qc,Ut,$s,_s,xs,Ss,Cs,Is,Ts,As,Es,ks,jn=j(()=>{ye(),xe(),Ze(),_e(),ws(),Dt=e=>{if(!e||e.length===0||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(e.length===2&&e[1].dims.length!==1)throw new Error("Invalid axes input dims.")},Hc=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],Kn=(e,i,a,o,c,s,d=!1,$=!1)=>{let et=[],h=a[0].dims,b=h.length,g=M.normalizeAxes(c,b),st=!$&&g.length===0;h.forEach((Ft,Gt)=>{st||g.indexOf(Gt)>=0?d&&et.push(1):et.push(Ft)});let $t=et.length,vt=M.size(et);return{name:e,shaderCache:i,getShaderSource:Ft=>{let Gt=[],qt=U("_A",a[0].dataType,b),Lt=K("output",s,$t),rr=o(qt,Lt,g),jr=rr[2];for(let Hr=0,wn=0;Hr<b;Hr++)st||g.indexOf(Hr)>=0?(d&&wn++,jr=`for(var j${Hr}: u32 = 0; j${Hr} < ${h[Hr]}; j${Hr}++) {
                  ${rr[2].includes("last_index")?`let last_index = j${Hr};`:""}
                  ${qt.indicesSet("input_indices",Hr,`j${Hr}`)}
                  ${jr}
                }`):(Gt.push(`${qt.indicesSet("input_indices",Hr,Lt.indicesGet("output_indices",wn))};`),wn++);return`

        ${Ft.registerUniform("output_size","u32").declareVariables(qt,Lt)}

        ${Ft.mainStart()}
          ${Ft.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          var input_indices: ${qt.type.indices};
          let output_indices = ${Lt.offsetToIndices("global_idx")};

          ${Gt.join(`
`)}
          ${rr[0]}       // init ops for reduce max/min
          ${rr[1]}
          ${jr}
          ${rr[3]}
          ${rr.length===4?Lt.setByOffset("global_idx","value"):rr.slice(4).join(`
`)}
        }`},getRunData:()=>({outputs:[{dims:et,dataType:s}],dispatchGroup:{x:Math.ceil(vt/64)},programUniforms:[{type:12,data:vt},...X(h,et)]})}},ro=(e,i)=>{let a=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach(o=>a.push(Number(o))),we({axes:a,keepDims:i.keepDims,noopWithEmptyAxes:i.noopWithEmptyAxes})},Mt=(e,i,a,o)=>{let c=e.inputs,s=c.length===1?a:ro(c,a);e.compute(Kn(i,{hint:s.cacheKey,inputDependencies:["rank"]},[c[0]],s.noopWithEmptyAxes&&s.axes.length===0?Hc:o,s.axes,c[0].dataType,s.keepDims,s.noopWithEmptyAxes),{inputs:[0]})},Gc=(e,i)=>{Dt(e.inputs),Mt(e,"ReduceLogSum",i,(a,o)=>[`var value = ${o.type.storage}(0);`,"",`value += ${a.getByIndices("input_indices")};`,"value = log(value);"])},Lc=(e,i)=>{Dt(e.inputs),Mt(e,"ReduceL1",i,(a,o)=>[`var value = ${o.type.storage}(0);`,"",`value += abs(${a.getByIndices("input_indices")});`,""])},Fc=(e,i)=>{Dt(e.inputs),Mt(e,"ReduceL2",i,(a,o)=>[`var t = ${o.type.value}(0); var value = ${o.type.value}(0);`,"",`t = ${a.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},qc=(e,i)=>{Dt(e.inputs),Mt(e,"ReduceLogSumExp",i,(a,o)=>[`var value = ${o.type.storage}(0);`,"",`value += exp(${a.getByIndices("input_indices")});`,"value = log(value);"])},jc=(e,i)=>{Dt(e.inputs),Mt(e,"ReduceMax",i,(a,o,c)=>{let s=[];for(let d=0;d<a.rank;d++)(c.indexOf(d)>=0||c.length===0)&&s.push(a.indicesSet("input_indices",d,0));return[`${s.join(`
`)}`,`var value = ${a.getByIndices("input_indices")};`,`value = max(value, ${a.getByIndices("input_indices")});`,""]})},Kc=(e,i)=>{Dt(e.inputs),Mt(e,"ReduceMean",i,(a,o,c)=>{let s=1;for(let d=0;d<a.rank;d++)(c.indexOf(d)>=0||c.length===0)&&(s*=e.inputs[0].dims[d]);return["var sum = f32(0);","",`sum += f32(${a.getByIndices("input_indices")});`,`let value = ${o.type.value}(sum / ${s});`]})},Yc=(e,i)=>{Dt(e.inputs),Mt(e,"ReduceMin",i,(a,o,c)=>{let s=[];for(let d=0;d<a.rank;d++)(c.indexOf(d)>=0||c.length===0)&&s.push(`input_indices[${d}] = 0;`);return[`${s.join(`
`)}`,`var value = ${a.getByIndices("input_indices")};`,`value = min(value, ${a.getByIndices("input_indices")});`,""]})},Xc=(e,i)=>{Dt(e.inputs),Mt(e,"ReduceProd",i,(a,o)=>[`var value = ${o.type.storage}(1);`,"",`value *= ${a.getByIndices("input_indices")};`,""])},Zc=(e,i)=>{Dt(e.inputs),Mt(e,"ReduceSum",i,(a,o)=>[`var value = ${o.type.storage}(0);`,"",`value += ${a.getByIndices("input_indices")};`,""])},Qc=(e,i)=>{Dt(e.inputs),Mt(e,"ReduceSumSquare",i,(a,o)=>[`var t = ${o.type.value}(0); var value = ${o.type.value}(0);`,"",`t = ${a.getByIndices("input_indices")}; value += t * t;`,""])},Ut=(e,i,a)=>{if(i.length===0)return a;let o=1,c=1;for(let s=0;s<i.length;s++)i.indexOf(s)===-1?o*=e[s]:c*=e[s];return c<32&&o>1024},$s=(e,i)=>{Ut(e.inputs[0].dims,i.axes,i.noopWithEmptyAxes)?Kc(e,i):ds(e,i)},_s=(e,i)=>{Ut(e.inputs[0].dims,i.axes,i.noopWithEmptyAxes)?Lc(e,i):cs(e,i)},xs=(e,i)=>{Ut(e.inputs[0].dims,i.axes,i.noopWithEmptyAxes)?Fc(e,i):ps(e,i)},Ss=(e,i)=>{Ut(e.inputs[0].dims,i.axes,i.noopWithEmptyAxes)?qc(e,i):ms(e,i)},Cs=(e,i)=>{Ut(e.inputs[0].dims,i.axes,i.noopWithEmptyAxes)?jc(e,i):fs(e,i)},Is=(e,i)=>{Ut(e.inputs[0].dims,i.axes,i.noopWithEmptyAxes)?Yc(e,i):hs(e,i)},Ts=(e,i)=>{Ut(e.inputs[0].dims,i.axes,i.noopWithEmptyAxes)?Xc(e,i):gs(e,i)},As=(e,i)=>{Ut(e.inputs[0].dims,i.axes,i.noopWithEmptyAxes)?Zc(e,i):ys(e,i)},Es=(e,i)=>{Ut(e.inputs[0].dims,i.axes,i.noopWithEmptyAxes)?Qc(e,i):bs(e,i)},ks=(e,i)=>{Ut(e.inputs[0].dims,i.axes,i.noopWithEmptyAxes)?Gc(e,i):vs(e,i)}}),Os,Ps,Rs,no,zs=j(()=>{ye(),Ze(),jn(),Os=e=>{if(!e||e.length===0||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(e[0].dataType!==1)throw new Error("Invalid input type.")},Ps=(e,i)=>{Os(e.inputs);let a=(o,c,s)=>{let d=[];for(let $=0;$<o.rank;$++)(s.indexOf($)>=0||s.length===0)&&d.push(`input_indices[${$}] = 0;`);return[`${d.join(`
`)}`,`var value = ${o.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${o.getByIndices("input_indices")} ${i.selectLastIndex>0?"<=":"<"} value) {
         value = ${o.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",c.setByOffset("global_idx","best_index")]};e.compute(Kn("ArgMin",{hint:i.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],a,[i.axis],7,i.keepDims),{inputs:[0]})},Rs=(e,i)=>{Os(e.inputs);let a=(o,c,s)=>{let d=[];for(let $=0;$<o.rank;$++)(s.indexOf($)>=0||s.length===0)&&d.push(`input_indices[${$}] = 0;`);return[`${d.join(`
`)}`,`var value = ${o.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${o.getByIndices("input_indices")} ${i.selectLastIndex>0?">=":">"} value) {
         value = ${o.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",c.setByOffset("global_idx","best_index")]};e.compute(Kn("argMax",{hint:i.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],a,[i.axis],7,i.keepDims),{inputs:[0]})},no=e=>we(e)}),Jc,ep,tp,Yn,Bs,Ds,io=j(()=>{ye(),xe(),Ze(),_e(),Jc=(e,i)=>{if(!e||e.length<1)throw new Error("too few inputs");let a=0,o=e[a],c=o.dataType,s=o.dims.length;e.forEach((d,$)=>{if($!==a){if(d.dataType!==c)throw new Error("input tensors should be one type");if(d.dims.length!==s)throw new Error("input tensors should have the same shape");d.dims.forEach((et,h)=>{if(h!==i&&et!==o.dims[h])throw new Error("non concat dimensions must match")})}})},ep=(e,i)=>`
  fn calculateInputIndex(index: u32) -> u32 {
    let sizeInConcatAxis = array<u32, ${e}u>(${i});
    for (var i: u32 = 0u; i < ${e}; i += 1u ) {
      if (index < sizeInConcatAxis[i]) {
        return i;
      }
    }
    return ${e}u;
  }`,tp=(e,i)=>{let a=e.length,o=[];for(let c=0;c<a;++c){let s=i.setByOffset("global_idx",e[c].getByIndices("indices"));a===1?o.push(s):c===0?o.push(`if (inputIndex == ${c}u) { ${s} }`):c===a-1?o.push(`else { ${s} }`):o.push(`else if (inputIndex == ${c}) { ${s} }`)}return o.join(`
`)},Yn=(e,i,a,o)=>{let c=M.size(a),s=new Array(e.length),d=new Array(e.length),$=0,et=[],h=[],b=[{type:12,data:c}];for(let Ft=0;Ft<e.length;++Ft)$+=e[Ft].dims[i],s[Ft]=$,h.push(e[Ft].dims.length),d[Ft]=U(`input${Ft}`,o,h[Ft]),et.push("rank"),b.push({type:12,data:s[Ft]});for(let Ft=0;Ft<e.length;++Ft)b.push(...X(e[Ft].dims));b.push(...X(a));let g=K("output",o,a.length),st=g.indicesGet("indices",i),$t=Array.from(Array(s.length).keys()).map(Ft=>`uniforms.sizeInConcatAxis${Ft}`).join(","),vt=Ft=>`

  ${(()=>{Ft.registerUniform("outputSize","u32");for(let Gt=0;Gt<e.length;Gt++)Ft.registerUniform(`sizeInConcatAxis${Gt}`,"u32");return Ft.declareVariables(...d,g)})()}

  ${ep(s.length,$t)}

  ${Ft.mainStart()}
    ${Ft.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

    var indices = ${g.offsetToIndices("global_idx")};

    let inputIndex = calculateInputIndex(${st});
    if (inputIndex != 0u) {
      let sizeInConcatAxis = array<u32, ${s.length}u>(${$t});
      ${st} -= sizeInConcatAxis[inputIndex - 1u];
    }

    ${tp(d,g)}
  }`;return{name:"Concat",shaderCache:{hint:`${i}`,inputDependencies:et},getRunData:()=>({outputs:[{dims:a,dataType:o}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:b}),getShaderSource:vt}},Bs=(e,i)=>{let a=e.inputs,o=a[0].dims,c=M.normalizeAxis(i.axis,o.length);Jc(a,c);let s=o.slice();s[c]=a.reduce(($,et)=>$+(et.dims.length>c?et.dims[c]:0),0);let d=a.filter($=>M.size($.dims)>0);e.compute(Yn(d,c,s,a[0].dataType),{inputs:d})},Ds=e=>we({axis:e.axis})}),rp,np,ip,op,Xn,ap,Ms,oo=j(()=>{ye(),Hn(),_e(),io(),rp=(e,i)=>{let a=e[0],o=e[1],c=e[2],s=e[3],d=e[4],$=e[5];if(d&&$)throw new Error("Attention cannot have both past and relative_position_bias");if(a.dims.length!==3)throw new Error('Input "input" must have 3 dimensions');let et=a.dims[0],h=a.dims[1],b=a.dims[2];if(c.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimensions');if(o.dims.length!==2)throw new Error('Input "weights" is expected to have 2 dimensions');if(o.dims[0]!==b)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(c.dims[0]!==o.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let g=c.dims[0]/3,st=g,$t=st;if(i.qkvHiddenSizes.length>0){if(i.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let rr of i.qkvHiddenSizes)if(rr%i.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");g=i.qkvHiddenSizes[0],st=i.qkvHiddenSizes[1],$t=i.qkvHiddenSizes[2]}let vt=h;if(g!==st)throw new Error("qkv_hidden_sizes first element should be same as the second");if(c.dims[0]!==g+st+$t)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let Ft=0;if(d){if(st!==$t)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(d.dims.length!==5)throw new Error('Input "past" must have 5 dimensions');if(d.dims[0]!==2)throw new Error('Input "past" first dimension must be 2');if(d.dims[1]!==et)throw new Error('Input "past" second dimension must be batch_size');if(d.dims[2]!==i.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(d.dims[4]!==st/i.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');i.pastPresentShareBuffer||(Ft=d.dims[3])}let Gt=vt+Ft,qt=-1,Lt=0;if(s)throw new Error("Mask not supported");if(d)throw new Error("past is not supported");return{batchSize:et,sequenceLength:h,pastSequenceLength:Ft,kvSequenceLength:vt,totalSequenceLength:Gt,maxSequenceLength:qt,inputHiddenSize:b,hiddenSize:g,vHiddenSize:$t,headSize:Math.floor(g/i.numHeads),vHeadSize:Math.floor($t/i.numHeads),numHeads:i.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:i.maskFilterValue,maskType:Lt,scale:i.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},np=(e,i,a,o)=>{let c=Ue(o),s=64,d=o/c;d<s?s=1:d/8<64&&(s=Math.ceil(d/8));let $=Math.ceil(o/c/s),et=[{type:i.dataType,data:1/o},{type:12,data:d},{type:12,data:$}],h=De(i.dataType,c),b=rt(1,c),g=st=>{let $t=K("x",i.dataType,i.dims,c),vt=[{name:"d_inv",type:rt(i.dataType)},{name:"d_comp",type:"u32"},{name:"elements_per_thread",type:"u32"}];return`
  var<workgroup> thread_max: array<f32, ${s}>;
  var<workgroup> thread_sum: array<f32, ${s}>;
  ${st.registerUniforms(vt).declareVariables($t)}
  ${st.mainStart([s,1,1])}
    let local_offset = local_idx * uniforms.elements_per_thread;
    let offset = workgroup_id.x * uniforms.d_comp + local_offset;

    var thread_max_vector = ${b}(-3.402823e+38f);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < uniforms.d_comp; i++) {
      thread_max_vector = max(${b}(x[offset + i]), thread_max_vector);
    }
    thread_max[local_idx] = ${(()=>{switch(c){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw new Error(`Unsupported components: ${c}`)}})()};
    workgroupBarrier();

    var max_value =  f32(-3.402823e+38f);
    for (var i = 0u; i < ${s}; i++) {
      max_value = max(thread_max[i], max_value);
    }

    var sum_vector = ${b}(0);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < uniforms.d_comp; i++) {
      sum_vector += exp(${b}(x[offset + i]) - max_value);
    }
    thread_sum[local_idx] = ${(()=>{switch(c){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw new Error(`Unsupported components: ${c}`)}})()};
    workgroupBarrier();

    var sum: f32 = 0;
    for (var i = 0u; i < ${s}; i++) {
      sum += thread_sum[i];
    }

    if (sum == 0) {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < uniforms.d_comp; i++) {
        x[offset + i] = ${$t.type.value}(uniforms.d_inv);
      }
    } else {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < uniforms.d_comp; i++) {
        var f32input = ${b}(x[offset + i]);
        x[offset + i] = ${$t.type.value}(exp(f32input - max_value) / sum);
      }
    }
  }`};return{name:"AttentionProbsSoftmax",shaderCache:{hint:`${s};${h};${c}`},getShaderSource:g,getRunData:()=>({outputs:[],dispatchGroup:{x:a},programUniforms:et})}},ip=(e,i,a,o,c,s,d)=>{let $=d+c.kvSequenceLength,et=[c.batchSize,c.numHeads,c.sequenceLength,$],h=s.scale===0?1/Math.sqrt(c.headSize):s.scale,b=Ue(c.headSize),g=c.headSize/b,st=12,$t={x:Math.ceil($/st),y:Math.ceil(c.sequenceLength/st),z:c.batchSize*c.numHeads},vt=[{type:12,data:c.sequenceLength},{type:12,data:g},{type:12,data:$},{type:12,data:c.numHeads},{type:1,data:h}],Ft=o?["type","type","type"]:["type","type"],Gt=qt=>{let Lt=U("q",i.dataType,i.dims,b),rr=U("key",a.dataType,a.dims,b),jr=[Lt,rr];o&&jr.push(U("relative_position_bias",o.dataType,o.dims));let Hr=K("output",i.dataType,et),wn=rt(1,b),_n=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"alpha",type:"f32"}];return`
  const TILE_SIZE = ${st}u;

  var<workgroup> tileQ: array<${Lt.type.storage}, ${st*st}>;
  var<workgroup> tileK: array<${Lt.type.storage}, ${st*st}>;
  ${qt.registerUniforms(_n).declareVariables(...jr,Hr)}
  ${qt.mainStart([st,st,1])}
    // x holds the N and y holds the M
    let headIdx = workgroup_id.z;
    let m = workgroup_id.y * TILE_SIZE;
    let n = workgroup_id.x * TILE_SIZE;
    let qOffset = uniforms.M * uniforms.K * headIdx + m * uniforms.K;
    let kOffset = uniforms.N * uniforms.K * headIdx + n * uniforms.K;

    var value = ${wn}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];
      }
      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {
        tileK[TILE_SIZE * local_id.y + local_id.x] = key[kOffset + local_id.y * uniforms.K + w + local_id.x];
      }
      workgroupBarrier();

      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {
        value += ${wn}(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);
      }

      workgroupBarrier();
    }

    let headOffset = headIdx * uniforms.M * uniforms.N;
    if (global_id.y < uniforms.M && global_id.x < uniforms.N) {
      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;
      var sum: f32 = ${(()=>{switch(b){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw new Error(`Unsupported components: ${b}`)}})()};
        output[outputIdx] = ${Hr.type.value} (sum * uniforms.alpha) + ${o?"relative_position_bias[outputIdx]":"0.0"};
    }
  }`};return{name:"AttentionProbs",shaderCache:{hint:`${b}`,inputDependencies:Ft},getRunData:()=>({outputs:[{dims:et,dataType:i.dataType,gpuDataType:0}],dispatchGroup:$t,programUniforms:vt}),getShaderSource:Gt}},op=(e,i,a,o,c)=>{let s=c+o.kvSequenceLength,d=[o.batchSize,o.sequenceLength,o.vHiddenSize],$=12,et={x:Math.ceil(o.vHeadSize/$),y:Math.ceil(o.sequenceLength/$),z:o.batchSize*o.numHeads},h=[{type:12,data:o.sequenceLength},{type:12,data:s},{type:12,data:o.vHeadSize},{type:12,data:o.numHeads},{type:12,data:o.vHiddenSize}];return{name:"AttentionScore",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:d,dataType:i.dataType,gpuDataType:0}],dispatchGroup:et,programUniforms:h}),getShaderSource:b=>{let g=U("probs",i.dataType,i.dims),st=U("v",a.dataType,a.dims),$t=K("output",i.dataType,d),vt=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"v_hidden_size",type:"u32"}];return`
  const TILE_SIZE = ${$}u;
  var<workgroup> tileQ: array<${g.type.value}, ${$*$}>;
  var<workgroup> tileK: array<${g.type.value}, ${$*$}>;
  ${b.registerUniforms(vt).declareVariables(g,st,$t)}
  ${b.mainStart([$,$,1])}
   let headIdx = workgroup_id.z;
   let m = global_id.y;
   let n = global_id.x;

   let offsetA = headIdx * (uniforms.M * uniforms.K) + m * uniforms.K;
   let offsetB = headIdx * (uniforms.N * uniforms.K) + n;

   var value = ${g.type.storage}(0);
   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
     if (m < uniforms.M && w + local_id.x < uniforms.K) {
       tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];
     }
     if (n < uniforms.N && w + local_id.y < uniforms.K) {
       tileK[TILE_SIZE * local_id.y + local_id.x] = v[offsetB + (w + local_id.y) * uniforms.N];
     }
     workgroupBarrier();
     for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {
       value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * k + local_id.x];
     }
     workgroupBarrier();
   }

   // we need to transpose output from BNSH_v to BSND_v
   let batchIdx = workgroup_id.z / uniforms.num_heads;
   let currentBatchHeadNumber = workgroup_id.z % uniforms.num_heads;
   if (m < uniforms.M && n < uniforms.N) {
     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size
       + currentBatchHeadNumber * uniforms.N + n;
     output[outputIdx] = value;
   }
  }`}}},Xn=(e,i,a,o,c,s,d,$,et,h,b)=>{let g=e.outputCount>1,st=e.outputCount>2,$t=g&&st?h.pastSequenceLength:0,vt=$t+h.kvSequenceLength,Ft=[h.batchSize,h.numHeads,vt,h.headSize],Gt=d?[d,a]:[a],qt=g?e.compute(Yn(Gt,2,Ft,a.dataType),{inputs:Gt,outputs:[1]})[0]:a,Lt=[h.batchSize,h.numHeads,vt,h.headSize],rr=$?[$,o]:[o],jr=st?e.compute(Yn(rr,2,Lt,o.dataType),{inputs:rr,outputs:[2]})[0]:o,Hr=[i,qt];et&&Hr.push(et);let wn=e.compute(ip(e,i,qt,et,h,b,$t),{inputs:Hr,outputs:[-1]})[0];e.compute(np(e,wn,h.batchSize*h.numHeads*h.sequenceLength,vt),{inputs:[wn],outputs:[]});let _n=[wn,jr];e.compute(op(e,wn,jr,h,$t),{inputs:_n,outputs:[0]})},ap=(e,i)=>{let a=[i.batchSize,i.numHeads,i.sequenceLength,i.headSize],o=i.sequenceLength,c=i.inputHiddenSize,s=i.headSize,d=12,$={x:Math.ceil(i.headSize/d),y:Math.ceil(i.sequenceLength/d),z:i.batchSize*i.numHeads},et=[e.inputs[0],e.inputs[1],e.inputs[2]],h=[{type:12,data:o},{type:12,data:c},{type:12,data:s},{type:12,data:i.numHeads},{type:12,data:i.headSize},{type:12,data:i.hiddenSize},{type:12,data:i.hiddenSize+i.hiddenSize+i.vHiddenSize}],b=g=>{let st=K("output_q",et[0].dataType,a),$t=K("output_k",et[0].dataType,a),vt=K("output_v",et[0].dataType,a),Ft=U("input",et[0].dataType,et[0].dims),Gt=U("weight",et[1].dataType,et[1].dims),qt=U("bias",et[2].dataType,et[2].dims),Lt=Ft.type.storage,rr=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`
  const TILE_SIZE = ${d}u;
  var<workgroup> tileInput: array<${Lt}, ${d*d}>;
  var<workgroup> tileWeightQ: array<${Lt}, ${d*d}>;
  var<workgroup> tileWeightK: array<${Lt}, ${d*d}>;
  var<workgroup> tileWeightV: array<${Lt}, ${d*d}>;
  ${g.registerUniforms(rr).declareVariables(Ft,Gt,qt,st,$t,vt)}
  ${g.mainStart([d,d,1])}
    let batchIndex = workgroup_id.z / uniforms.num_heads;
    let headNumber = workgroup_id.z % uniforms.num_heads;
    let m = global_id.y;
    let n = global_id.x;

    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;
    let biasOffsetQ = headNumber * uniforms.head_size;
    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;
    let biasOffsetV = uniforms.hidden_size + biasOffsetK;

    var valueQ = ${Lt}(0);
    var valueK = ${Lt}(0);
    var valueV = ${Lt}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        let offset = n + (w + local_id.y) * uniforms.ldb;
        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];
        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];
        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];
      }
      workgroupBarrier();
      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {
        let inputTileOffset = TILE_SIZE * local_id.y + k;
        let weightTileOffset = TILE_SIZE * k + local_id.x;
        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];
        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];
        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];
      }

      workgroupBarrier();
    }

    let headOffset = (m * uniforms.N + n) % uniforms.head_size;
    valueQ += bias[headOffset + biasOffsetQ];
    valueK += bias[headOffset + biasOffsetK];
    valueV += bias[headOffset + biasOffsetV];

    let offset = workgroup_id.z * uniforms.M * uniforms.N;
    if (m < uniforms.M && n < uniforms.N) {
      let outputIdx = offset + m * uniforms.N + n;
      output_q[outputIdx] = valueQ;
      output_k[outputIdx] = valueK;
      output_v[outputIdx] = valueV;
    }
  }`};return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:a,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:a,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:a,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:$,programUniforms:h}),getShaderSource:b},{inputs:et,outputs:[-1,-1,-1]})},Ms=(e,i)=>{let a=rp(e.inputs,i),[o,c,s]=ap(e,a);return Xn(e,o,c,s,e.inputs[4],void 0,void 0,void 0,e.inputs[5],a,i)}}),sp,up,lp,Us,Ws=j(()=>{_t(),ye(),xe(),Ze(),_e(),sp=(e,i)=>{if(!e||e.length!==5)throw new Error("BatchNormalization requires 5 inputs");let a=(o,c,s)=>{let d=c.length;if(d!==o.length)throw new Error(`${s}: num dimensions != ${d}`);c.forEach(($,et)=>{if($!==o[et])throw new Error(`${s}: dim[${et}] do not match`)})};if(e[0].dims.length>1){let o=i.format==="NHWC"?i.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,i.spatial?2:void 0);a(e[1].dims,o,"Invalid input scale"),a(e[2].dims,o,"Invalid input B"),a(e[3].dims,o,"Invalid input mean"),a(e[4].dims,o,"Invalid input var")}else a(e[1].dims,[1],"Invalid input scale"),a(e[2].dims,[1],"Invalid input B"),a(e[3].dims,[1],"Invalid input mean"),a(e[4].dims,[1],"Invalid input var")},up=(e,i)=>{let{epsilon:a,spatial:o,format:c}=i,s=e[0].dims,d=o?Ue(s[s.length-1]):1,$=c==="NHWC"&&s.length>1?d:1,et=M.size(s)/d,h=o,b=h?s.length:s,g=U("x",e[0].dataType,e[0].dims,d),st=U("scale",e[1].dataType,e[1].dims,$),$t=U("bias",e[2].dataType,e[2].dims,$),vt=U("inputMean",e[3].dataType,e[3].dims,$),Ft=U("inputVar",e[4].dataType,e[4].dims,$),Gt=K("y",e[0].dataType,b,d),qt=()=>{let rr="";if(o)rr=`let cOffset = ${s.length===1?"0u":c==="NHWC"?`outputIndices[${s.length-1}] / ${d}`:"outputIndices[1]"};`;else if(c==="NCHW")rr=`
            ${Gt.indicesSet("outputIndices","0","0")}
            let cOffset = ${Gt.indicesToOffset("outputIndices")};`;else{rr=`var cIndices = ${st.type.indices}(0);
                       cIndices[0] = outputIndices[${s.length-1}];`;for(let jr=1;jr<st.rank;jr++)rr+=`cIndices[${jr}] = outputIndices[${jr}];`;rr+=`let cOffset = ${st.indicesToOffset("cIndices")};`}return rr},Lt=rr=>`
  const epsilon = ${a};
  ${rr.registerUniform("outputSize","u32").declareVariables(g,st,$t,vt,Ft,Gt)}
  ${rr.mainStart()}
  ${rr.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
    var outputIndices = ${Gt.offsetToIndices(`global_idx * ${d}`)};
    ${qt()}
    let scale = ${st.getByOffset("cOffset")};
    let bias = ${$t.getByOffset("cOffset")};
    let inputMean = ${vt.getByOffset("cOffset")};
    let inputVar = ${Ft.getByOffset("cOffset")};
    let x = ${g.getByOffset("global_idx")};
    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;
    ${Gt.setByOffset("global_idx","value")}
  }`;return{name:"BatchNormalization",shaderCache:{hint:`${i.epsilon}_${i.format}_${o}_${d}`,inputDependencies:h?["rank","type","type","type","type"]:void 0},getShaderSource:Lt,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(et/64)},programUniforms:h?[{type:12,data:et},...X(s)]:[{type:12,data:et}]})}},lp=e=>we(e),Us=(e,i)=>{let{inputs:a,outputCount:o}=e,c=lp({...i,outputCount:o});if(ke.webgpu.validateInputContent&&sp(a,c),i.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(up(a,c))}}),dp,cp,Ns,Vs=j(()=>{xe(),_e(),dp=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},cp=e=>{let i=e[0].dims,a=e[0].dims[2],o=M.size(i)/4,c=e[0].dataType,s=U("input",c,i,4),d=U("bias",c,[a],4),$=U("residual",c,i,4),et=K("output",c,i,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)}}),getShaderSource:h=>`
  const channels = ${a}u / 4;
  ${h.declareVariables(s,d,$,et)}

  ${h.mainStart()}
    ${h.guardAgainstOutOfBoundsWorkgroupSizes(o)}
    let value = ${s.getByOffset("global_idx")}
      + ${d.getByOffset("global_idx % channels")} + ${$.getByOffset("global_idx")};
    ${et.setByOffset("global_idx","value")}
  }`}},Ns=e=>{dp(e.inputs),e.compute(cp(e.inputs))}}),pp,Pe,Hs,Gs,Ls,Fs,qs,js,Ks,Ys,Xs,mp,Zs,Qs,Js,eu,Zn,tu,Qn,ru,nu,iu,ou,au,su,uu,lu,du,cu,pu,mu,fu,hu,gu,yu,bu,vu,ao,so,wu,$u,_u,Jn=j(()=>{ye(),xe(),Ze(),_e(),pp=(e,i,a,o,c,s)=>{let d=Math.ceil(i/4),$="";typeof c=="string"?$=`${c}(a)`:$=c("a");let et=U("inputData",a,[d],4),h=K("outputData",o,[d],4);return`
      ${e.registerUniform("vec_size","u32").declareVariables(et,h)}

  ${s??""}

  ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}

    let a = ${et.getByOffset("global_idx")};
    ${h.setByOffset("global_idx",$)}
  }`},Pe=(e,i,a,o,c,s=e.dataType)=>({name:i,shaderCache:{hint:c,inputDependencies:["type"]},getShaderSource:d=>pp(d,M.size(e.dims),e.dataType,s,a,o),getRunData:d=>({outputs:[{dims:e.dims,dataType:s}],dispatchGroup:{x:Math.ceil(M.size(d[0].dims)/64/4)},programUniforms:[{type:12,data:Math.ceil(M.size(e.dims)/4)}]})}),Hs=e=>{e.compute(Pe(e.inputs[0],"Abs","abs"))},Gs=e=>{e.compute(Pe(e.inputs[0],"Acos","acos"))},Ls=e=>{e.compute(Pe(e.inputs[0],"Acosh","acosh"))},Fs=e=>{e.compute(Pe(e.inputs[0],"Asin","asin"))},qs=e=>{e.compute(Pe(e.inputs[0],"Asinh","asinh"))},js=e=>{e.compute(Pe(e.inputs[0],"Atan","atan"))},Ks=e=>{e.compute(Pe(e.inputs[0],"Atanh","atanh"))},Ys=e=>we(e),Xs=(e,i)=>{let a;switch(i.to){case 10:a="vec4<f16>";break;case 1:a="vec4<f32>";break;case 12:a="vec4<u32>";break;case 6:a="vec4<i32>";break;case 9:a="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute 'to' from 'Cast' operator): ${i.to}`)}e.compute(Pe(e.inputs[0],"Cast",a,void 0,i.cacheKey,i.to))},mp=e=>{let i=e.length>=2&&e[1].data!==0?e[1].getFloat32Array()[0]:Ln,a=e.length>=3&&e[2].data!==0?e[2].getFloat32Array()[0]:Fn;return we({min:i,max:a})},Zs=(e,i)=>{let a=e.inputs.length===1?i:mp(e.inputs),o=rt(e.inputs[0].dataType);e.compute(Pe(e.inputs[0],"Clip",c=>`clamp(${c}, clip_min_, clip_max_)`,`
    const clip_min_: vec4<${o}> = vec4(${o}(${a.min}));
    const clip_max_: vec4<${o}> = vec4(${o}(${a.max}));
`,a.cacheKey),{inputs:[0]})},Qs=e=>{e.compute(Pe(e.inputs[0],"Ceil","ceil"))},Js=e=>{e.compute(Pe(e.inputs[0],"Cos","cos"))},eu=e=>{e.compute(Pe(e.inputs[0],"Cosh","cosh"))},Zn=e=>we(e),tu=(e,i)=>{let a=rt(e.inputs[0].dataType);e.compute(Pe(e.inputs[0],"Elu",o=>`elu_vf32(${o})`,`
  const elu_alpha_ = ${a}(${i.alpha});

  fn elu_f32(a: ${a}) -> ${a} {
  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);
  }

  fn elu_vf32(v: vec4<${a}>) -> vec4<${a}> {
  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));
  }`,i.cacheKey))},Qn=(e="f32")=>`
const r0: ${e} = 0.3275911;
const r1: ${e} = 0.254829592;
const r2: ${e} = -0.284496736;
const r3: ${e} = 1.421413741;
const r4: ${e} = -1.453152027;
const r5: ${e} = 1.061405429;

fn erf_vf32(v: vec4<${e}>) -> vec4<${e}> {
  let absv = abs(v);
  let x = 1.0 / (1.0 + r0 * absv);
  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));
}`,ru=e=>{let i=rt(e.inputs[0].dataType);e.compute(Pe(e.inputs[0],"Erf",a=>`erf_vf32(${a})`,Qn(i)))},nu=e=>{e.compute(Pe(e.inputs[0],"Exp","exp"))},iu=e=>{e.compute(Pe(e.inputs[0],"Floor","floor"))},ou=e=>{let i=rt(e.inputs[0].dataType);e.compute(Pe(e.inputs[0],"Gelu",a=>`0.5 * ${a} * (1.0 + erf_vf32(${a} * 0.7071067811865475))`,Qn(i)))},au=(e,i)=>{let a=rt(e.inputs[0].dataType);e.compute(Pe(e.inputs[0],"LeakyRelu",o=>`select(leaky_relu_alpha_ * ${o}, ${o}, ${o} >= vec4<${a}>(0.0))`,`const leaky_relu_alpha_ = ${a}(${i.alpha});`,i.cacheKey))},su=e=>{e.compute(Pe(e.inputs[0],"Not",i=>`!${i}`))},uu=e=>{e.compute(Pe(e.inputs[0],"Neg",i=>`-${i}`))},lu=e=>{e.compute(Pe(e.inputs[0],"Reciprocal",i=>`1.0/${i}`))},du=e=>{let i=rt(e.inputs[0].dataType);e.compute(Pe(e.inputs[0],"Relu",a=>`select(vec4<${i}>(0.0), ${a}, ${a} > vec4<${i}>(0.0))`))},cu=e=>{e.compute(Pe(e.inputs[0],"Sigmoid",i=>`(1.0 / (1.0 + exp(-${i})))`))},pu=e=>we(e),mu=(e,i)=>{let a=rt(e.inputs[0].dataType);e.compute(Pe(e.inputs[0],"HardSigmoid",o=>`max(vec4<${a}>(0.0), min(vec4<${a}>(1.0), ${i.alpha} * ${o} + vec4<${a}>(${i.beta})))`,void 0,i.cacheKey))},fu=e=>{e.compute(Pe(e.inputs[0],"Sin","sin"))},hu=e=>{e.compute(Pe(e.inputs[0],"Sinh","sinh"))},gu=e=>{e.compute(Pe(e.inputs[0],"Sqrt","sqrt"))},yu=e=>{e.compute(Pe(e.inputs[0],"Tan","tan"))},bu=e=>`sign(${e}) * (1 - exp(-2 * abs(${e}))) / (1 + exp(-2 * abs(${e})))`,vu=e=>{e.compute(Pe(e.inputs[0],"Tanh",bu))},ao=(e="f32")=>`
const fast_gelu_a: ${e} = 0.5;
const fast_gelu_b: ${e} = 0.7978845608028654;
const fast_gelu_c: ${e} = 0.035677408136300125;

fn tanh_v(v: vec4<${e}>) -> vec4<${e}> {
  return ${bu("v")};
}
`,so=e=>`(fast_gelu_a + fast_gelu_a * tanh_v(${e} * (fast_gelu_c * ${e} * ${e} + fast_gelu_b))) * ${e}`,wu=e=>{let i=rt(e.inputs[0].dataType);e.compute(Pe(e.inputs[0],"FastGelu",so,ao(i),void 0,e.inputs[0].dataType))},$u=(e,i)=>{let a=rt(e.inputs[0].dataType);return e.compute(Pe(e.inputs[0],"ThresholdedRelu",o=>`select(vec4<${a}>(0.0), ${o}, ${o} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${a}>(${i.alpha});`,i.cacheKey)),0},_u=e=>{e.compute(Pe(e.inputs[0],"Log","log"))}}),fp,hp,Su,Cu=j(()=>{xe(),_e(),Jn(),fp=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},hp=e=>{let i=e[0].dims.slice();i[2]=i[2]/2;let a=U("input",e[0].dataType,e[0].dims,4),o=U("bias",e[0].dataType,[e[0].dims[2]],4),c=K("output",e[0].dataType,i,4),s=M.size(i)/4,d=De(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:i,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(s/64)}}),getShaderSource:$=>`
  const M_SQRT2 = sqrt(2.0);
  const halfChannels = ${e[0].dims[2]/4/2}u;

  ${$.declareVariables(a,o,c)}

  ${Qn(d)}

  ${$.mainStart()}
    ${$.guardAgainstOutOfBoundsWorkgroupSizes(s)}
    let biasIdx = global_idx % halfChannels;
    let batchIndex = global_idx / halfChannels;
    let inputOffset = biasIdx + batchIndex * halfChannels * 2;
    let valueLeft = input[inputOffset] + bias[biasIdx];
    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];
    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);

    ${c.setByOffset("global_idx","valueLeft * geluRight")}
  }`}},Su=e=>{fp(e.inputs),e.compute(hp(e.inputs))}}),gp,yp,Wt,Iu,Tu,Au,Eu,ku,Ou,Pu,Ru,zu,Bu,Du=j(()=>{ye(),xe(),_e(),gp=(e,i,a,o,c,s,d,$,et,h,b,g)=>{let st,$t;typeof $=="string"?st=$t=(Lt,rr)=>`${$}((${Lt}),(${rr}))`:typeof $=="function"?st=$t=$:(st=$.scalar,$t=$.vector);let vt=K("outputData",b,o.length,4),Ft=U("aData",et,i.length,4),Gt=U("bData",h,a.length,4),qt;if(c)if(s){let Lt=M.size(i)===1,rr=M.size(a)===1,jr=i.length>0&&i[i.length-1]%4===0,Hr=a.length>0&&a[a.length-1]%4===0;Lt||rr?qt=vt.setByOffset("global_idx",$t(Lt?`${Ft.type.value}(${Ft.getByOffset("0")}.x)`:Ft.getByOffset("global_idx"),rr?`${Gt.type.value}(${Gt.getByOffset("0")}.x)`:Gt.getByOffset("global_idx"))):qt=`
            let outputIndices = ${vt.offsetToIndices("global_idx * 4u")};
            let offsetA = ${Ft.broadcastedIndicesToOffset("outputIndices",vt)};
            let offsetB = ${Gt.broadcastedIndicesToOffset("outputIndices",vt)};
            ${vt.setByOffset("global_idx",$t(d||jr?Ft.getByOffset("offsetA / 4u"):`${Ft.type.value}(${Ft.getByOffset("offsetA / 4u")}[offsetA % 4u])`,d||Hr?Gt.getByOffset("offsetB / 4u"):`${Gt.type.value}(${Gt.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}
          `}else qt=vt.setByOffset("global_idx",$t(Ft.getByOffset("global_idx"),Gt.getByOffset("global_idx")));else{if(!s)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let Lt=(rr,jr,Hr="")=>{let wn=`aData[indexA${jr}][componentA${jr}]`,_n=`bData[indexB${jr}][componentB${jr}]`;return`
            let outputIndices${jr} = ${vt.offsetToIndices(`global_idx * 4u + ${jr}u`)};
            let offsetA${jr} = ${Ft.broadcastedIndicesToOffset(`outputIndices${jr}`,vt)};
            let offsetB${jr} = ${Gt.broadcastedIndicesToOffset(`outputIndices${jr}`,vt)};
            let indexA${jr} = offsetA${jr} / 4u;
            let indexB${jr} = offsetB${jr} / 4u;
            let componentA${jr} = offsetA${jr} % 4u;
            let componentB${jr} = offsetB${jr} % 4u;
            ${rr}[${jr}] = ${Hr}(${st(wn,_n)});
          `};b===9?qt=`
            var data = vec4<u32>(0);
            ${Lt("data",0,"u32")}
            ${Lt("data",1,"u32")}
            ${Lt("data",2,"u32")}
            ${Lt("data",3,"u32")}
            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:qt=`
            ${Lt("outputData[global_idx]",0)}
            ${Lt("outputData[global_idx]",1)}
            ${Lt("outputData[global_idx]",2)}
            ${Lt("outputData[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables(Ft,Gt,vt)}

        ${g??""}

        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${qt}
      }`},yp=(e,i,a,o,c,s,d=a.dataType)=>{let $=!M.areEqual(a.dims,o.dims),et=a.dims,h=M.size(a.dims),b=!1,g=!1,st=[$];if($){let $t=zt.calcShape(a.dims,o.dims,!1);if(!$t)throw new Error("Can't perform binary op on the given tensors");et=$t,h=M.size(et);let vt=M.size(a.dims)===1,Ft=M.size(o.dims)===1,Gt=a.dims.length>0&&a.dims[a.dims.length-1]%4===0,qt=o.dims.length>0&&o.dims[o.dims.length-1]%4===0;st.push(vt),st.push(Ft),st.push(Gt),st.push(qt);let Lt=1;for(let rr=1;rr<et.length;rr++){let jr=a.dims[a.dims.length-rr]??1,Hr=o.dims[o.dims.length-rr]??1;if(jr===Hr)Lt*=jr;else break}Lt%4===0?(g=!0,b=!0):(vt||Ft||Gt||qt)&&(b=!0)}else b=!0;return st.push(b),{name:e,shaderCache:{hint:i+st.map($t=>$t.toString()).join("_"),inputDependencies:["rank","rank"]},getShaderSource:$t=>gp($t,a.dims,o.dims,et,b,$,g,c,a.dataType,o.dataType,d,s),getRunData:()=>({outputs:[{dims:et,dataType:d}],dispatchGroup:{x:Math.ceil(h/64/4)},programUniforms:[{type:12,data:Math.ceil(M.size(et)/4)},...X(a.dims,o.dims,et)]})}},Wt=(e,i,a,o,c,s)=>{e.compute(yp(i,c??"",e.inputs[0],e.inputs[1],a,o,s))},Iu=e=>{Wt(e,"Add",(i,a)=>`${i}+${a}`)},Tu=e=>{Wt(e,"Div",(i,a)=>`${i}/${a}`)},Au=e=>{Wt(e,"Equal",{scalar:(i,a)=>`u32(${i}==${a})`,vector:(i,a)=>`vec4<u32>(${i}==${a})`},void 0,void 0,9)},Eu=e=>{Wt(e,"Mul",(i,a)=>`${i}*${a}`)},ku=e=>{let i=U("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;Wt(e,"Pow",{scalar:(a,o)=>`pow_custom(${a},${o})`,vector:(a,o)=>`pow_vector_custom(${a},${o})`},`
    fn pow_custom(a : ${i}, b : ${i}) -> ${i} {
      if (b == ${i}(0.0)) {
        return ${i}(1.0);
      } else if (a < ${i}(0.0) && f32(b) != floor(f32(b))) {
        return ${i}(pow(f32(a), f32(b))); // NaN
      }
      return select(sign(a), ${i}(1.0), round(f32(abs(b) % ${i}(2.0))) != 1.0) * ${i}(${i==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));
    }
    fn pow_vector_custom(a : vec4<${i}>, b : vec4<${i}>) -> vec4<${i}> {
      // TODO: implement vectorized pow
      return vec4<${i}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));
    }
      `)},Ou=e=>{Wt(e,"Sub",(i,a)=>`${i}-${a}`)},Pu=e=>{Wt(e,"Greater",{scalar:(i,a)=>`u32(${i}>${a})`,vector:(i,a)=>`vec4<u32>(${i}>${a})`},void 0,void 0,9)},Ru=e=>{Wt(e,"Less",{scalar:(i,a)=>`u32(${i}<${a})`,vector:(i,a)=>`vec4<u32>(${i}<${a})`},void 0,void 0,9)},zu=e=>{Wt(e,"GreaterOrEqual",{scalar:(i,a)=>`u32(${i}>=${a})`,vector:(i,a)=>`vec4<u32>(${i}>=${a})`},void 0,void 0,9)},Bu=e=>{Wt(e,"LessOrEqual",{scalar:(i,a)=>`u32(${i}<=${a})`,vector:(i,a)=>`vec4<u32>(${i}<=${a})`},void 0,void 0,9)}}),kt,Ot,Pt,ei,Zt=j(()=>{ye(),xe(),kt=(e,i,a="f32")=>{switch(e.activation){case"Relu":return`value = max(value, ${i}(0.0));`;case"Sigmoid":return`value = (${i}(1.0) / (${i}(1.0) + exp(-value)));`;case"Clip":return`value = clamp(value, ${i}(${a}(uniforms.clip_min)), ${i}(${a}(uniforms.clip_max)));`;case"HardSigmoid":return`value = max(${i}(0.0), min(${i}(1.0), ${a}(uniforms.alpha) * value + ${a}(uniforms.beta)));`;case"LeakyRelu":return`value = select(${a}(uniforms.alpha) * value, value, value >= ${i}(0.0));`;case"":return"";default:throw new Error(`Unsupported activation ${e.activation}`)}},Ot=(e,i)=>{e.activation==="Clip"?i.push({type:1,data:e.clipMax},{type:1,data:e.clipMin}):e.activation==="HardSigmoid"?i.push({type:1,data:e.alpha},{type:1,data:e.beta}):e.activation==="LeakyRelu"&&i.push({type:1,data:e.alpha})},Pt=(e,i)=>{e.activation==="Clip"?i.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):e.activation==="HardSigmoid"?i.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):e.activation==="LeakyRelu"&&i.push({name:"alpha",type:"f32"})},ei=e=>{let i=(e==null?void 0:e.activation)||"";if(i==="HardSigmoid"){let[a,o]=(e==null?void 0:e.activation_params)||[.2,.5];return{activation:i,alpha:a,beta:o}}else if(i==="Clip"){let[a,o]=(e==null?void 0:e.activation_params)||[Ln,Fn];return{activation:i,clipMax:o,clipMin:a}}else if(i==="LeakyRelu"){let[a]=(e==null?void 0:e.activation_params)||[.01];return{activation:i,alpha:a}}return{activation:i}}}),nt,ti,ri=j(()=>{nt=(e,i)=>{switch(e){case 1:return i;case 2:return`vec2<${i}>`;case 3:return`vec3<${i}>`;case 4:return`vec4<${i}>`;default:throw new Error(`${e}-component is not supported.`)}},ti=e=>`
      ${e?"value = value + getBiasByOutputCoords(coords);":""}
      `}),ni,uo=j(()=>{ni=e=>`
fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
}
fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));
}
`}),vp,wp,rn,Mu,$p,nn,_p,ii,on=j(()=>{ye(),xe(),_e(),Zt(),ri(),vp=(e,i)=>e?`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          kStart + inputRow,
          globalRowStart / innerElementSize + inputCol${i?", batchIndices":""});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          globalRow + innerRow,
          kStart / innerElementSize + inputCol${i?", batchIndices":""});
        `,wp=(e,i)=>e?`
        let ACached0 = mm_Asub[k * innerElementSize][localRow];
        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];
        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];
        ${i===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}
        for (var i = 0; i < rowPerThread; i = i + 1) {
          acc[i] = BCached0 * ACached0[i] + acc[i];
          acc[i] = BCached1 * ACached1[i] + acc[i];
          acc[i] = BCached2 * ACached2[i] + acc[i];
          ${i===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}
        }`:`
        for (var i = 0; i < rowPerThread; i = i + 1) {
          let ACached = mm_Asub[tileRow + i][k];
          acc[i] = BCached0 * ACached.x + acc[i];
          acc[i] = BCached1 * ACached.y + acc[i];
          acc[i] = BCached2 * ACached.z + acc[i];
          ${i===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}
        }`,rn=(e,i,a="f32",o,c=!1,s=32,d=!1,$=32)=>{let et=i[1]*e[1],h=i[0]*e[0],b=c?et:s,g=c?s:et,st=b/i[0],$t=s/i[1];if(!((c&&st===4&&e[1]===4||!c&&(st===3||st===4))&&b%i[0]===0&&s%i[1]===0&&e[0]===4))throw new Error(`If transposeA ${c} is true, innerElementSize ${st} and workPerThread[1] ${e[1]} must be 4.
      Otherwise, innerElementSize ${st} must be 3 or 4.
  tileAWidth ${b} must be divisible by workgroupSize[0]${i[0]}. tileInner ${s} must be divisible by workgroupSize[1] ${i[1]}. colPerThread ${e[0]} must be 4.`);return`
var<workgroup> mm_Asub: array<array<vec${st}<${a}>, ${b/st}>, ${g}>;
var<workgroup> mm_Bsub: array<array<vec4<${a}>, ${h/e[0]}>, ${s}>;

const rowPerThread = ${e[1]};
const colPerThread = ${e[0]};
const innerElementSize = ${st};
const tileInner = ${s};

@compute @workgroup_size(${i[0]}, ${i[1]}, ${i[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
  let localRow = i32(localId.y);
  let tileRow = localRow * rowPerThread;
  let tileCol = i32(localId.x);

  let globalRow =i32(globalId.y) * rowPerThread;
  let globalCol = i32(globalId.x);
  let batch = ${d?"0":"i32(globalId.z)"};
  ${o?`let batchIndices = ${o.offsetToIndices("u32(batch)")};`:""}
  let globalRowStart = i32(workgroupId.y) * ${et};

  let num_tiles = ${d?`${Math.ceil($/s)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
  var kStart = ${d?`i32(globalId.z) * ${$}`:"0"};

  var acc: array<vec4<${a}>, rowPerThread>;

  // Loop over shared dimension.
  let tileRowB = localRow * ${$t};
  for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let inputRow = tileRow + innerRow;
          let inputCol = tileCol;
          ${vp(c,o)}
      }

      // Load one tile of B into local memory.
      for (var innerRow = 0; innerRow < ${$t}; innerRow = innerRow + 1) {
          let inputRow = tileRowB + innerRow;
          let inputCol = tileCol;
          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${o?", batchIndices":""});
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {
          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];
          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];
          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];
          ${st===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}

          ${wp(c,st)}
      }

      workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
  }
}`},Mu=(e,i)=>e?`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              kStart + inputRow,
              globalRowStart + inputCol${i?", batchIndices":""});
            `:`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              globalRowStart + inputRow,
              kStart + inputCol${i?", batchIndices":""});
            `,$p=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",nn=(e,i,a="f32",o,c=!1,s=32,d=!1,$=32,et=!1)=>{let h=e[1]*i[1],b=e[0]*i[0],g=c?h:s,st=c?s:h;if(!(st%i[1]===0&&g%i[0]===0&&s%i[1]===0))throw new Error(`tileAHight ${st} must be divisible by workgroupSize[1]${i[1]}, tileAWidth ${g} must be divisible by workgroupSize[0]${i[0]}, tileInner ${s} must be divisible by workgroupSize[1]${i[1]}`);let $t=st/i[1],vt=g/i[0],Ft=s/i[1],Gt=et?`
    let localRow = i32(localId.y);
    let localCol = i32(localId.x);
    let globalRowStart = i32(workgroupId.y) * ${h};
    let globalColStart = i32(workgroupId.x) * ${b};

    // Loop over shared dimension.
    for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var inputRow = localRow; inputRow < ${st}; inputRow = inputRow + ${i[1]}) {
        for (var inputCol = localCol; inputCol < ${g}; inputCol = inputCol + ${i[0]}) {
          ${Mu(c,o)}
        }
      }
      // Load one tile of B into local memory.
      for (var inputRow = localRow; inputRow < ${s}; inputRow = inputRow + ${i[1]}) {
            for (var inputCol = localCol; inputCol < ${b}; inputCol = inputCol + ${i[0]}) {
          mm_Bsub[inputRow][inputCol] = mm_readB(batch,
            kStart + inputRow,
            globalColStart + inputCol${o?", batchIndices":""});
        }
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      var BCached : array<${a}, colPerThread>;
      for (var k = 0; k < tileInner; k = k + 1) {
        for (var inner = 0; inner < colPerThread; inner = inner + 1) {
          BCached[inner] = mm_Bsub[k][localCol + inner * ${i[0]}];
        }
        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let ACached = ${c?`mm_Asub[k][localRow + innerRow * ${i[1]}];`:`mm_Asub[localRow + innerRow * ${i[1]}][k];`}
          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
            acc[innerRow][innerCol] = acc[innerRow][innerCol] +
                ACached * BCached[innerCol];
          }
        }
      }
      workgroupBarrier();
    }
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      let gRow = globalRowStart + localRow + innerRow * ${i[1]};
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        let gCol = globalColStart + localCol + innerCol * ${i[0]};
        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
      }
    }
    `:`
let tileRow = i32(localId.y) * rowPerThread;
let tileCol = i32(localId.x) * colPerThread;

let globalRow = i32(globalId.y) * rowPerThread;
let globalCol = i32(globalId.x) * colPerThread;
let globalRowStart = i32(workgroupId.y) * ${h};

let tileRowA = i32(localId.y) * ${$t};
let tileColA = i32(localId.x) * ${vt};
let tileRowB = i32(localId.y) * ${Ft};
// Loop over shared dimension.
for (var t = 0; t < num_tiles; t = t + 1) {
  // Load one tile of A into local memory.
  for (var innerRow = 0; innerRow < ${$t}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < ${vt}; innerCol = innerCol + 1) {
      let inputRow = tileRowA + innerRow;
      let inputCol = tileColA + innerCol;
      ${Mu(c,o)}
    }
  }

  // Load one tile of B into local memory.
  for (var innerRow = 0; innerRow < ${Ft}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
      let inputRow = tileRowB + innerRow;
      let inputCol = tileCol + innerCol;
      mm_Bsub[inputRow][inputCol] = mm_readB(batch,
        kStart + inputRow,
        globalCol + innerCol${o?", batchIndices":""});
    }
  }
  kStart = kStart + tileInner;
  workgroupBarrier();

  // Compute acc values for a single thread.
  var BCached : array<${a}, colPerThread>;
  for (var k = 0; k < tileInner; k = k + 1) {
    for (var inner = 0; inner < colPerThread; inner = inner + 1) {
      BCached[inner] = mm_Bsub[k][tileCol + inner];
    }

    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      ${$p(c)}
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];
      }
    }
  }

  workgroupBarrier();
}

for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
    mm_write(batch, globalRow + innerRow, globalCol + innerCol,
        acc[innerRow][innerCol]);
  }
}
`;return`
  var<workgroup> mm_Asub : array<array<${a}, ${g}>, ${st}>;
  var<workgroup> mm_Bsub : array<array<${a}, ${b}>, ${s}>;
  const rowPerThread = ${e[1]};
  const colPerThread = ${e[0]};
  const tileInner = ${s};

@compute @workgroup_size(${i[0]}, ${i[1]}, ${i[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
    let batch = ${d?"0":"i32(globalId.z)"};
    ${o?`let batchIndices = ${o.offsetToIndices("u32(batch)")};`:""}
    let num_tiles = ${d?`${Math.ceil($/s)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
    var kStart = ${d?`i32(globalId.z) * ${$}`:"0"};

    var acc : array<array<${a}, colPerThread>, rowPerThread>;

    // Without this initialization strange values show up in acc.
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = 0.0;
      }
    }
    ${Gt}
  }
`},_p=(e,i,a,o,c,s=!1)=>{let[d,$,et]=c,[h,b,g,st]=o,$t=Pr(d,et),vt=Pr($,et),Ft=De(o[0].type.tensor),Gt=()=>{let Lt=b.rank,rr=h.rank,jr=`var aIndices: ${b.type.indices};`;for(let Hr=Lt-2-1,wn=rr-1;Hr>=0;Hr--,wn--)jr+=`
aIndices[${Hr}] = ${rr>1?`batchIndices[${wn}]`:"batchIndices"};`;return $t.forEach(Hr=>{jr+=`
aIndices[${Hr}] = 0;`}),jr+=`
aIndices[${Lt-2}] = u32(row);
                   aIndices[${Lt-1}] = u32(colIn);`,jr},qt=()=>{let Lt=g.rank,rr=h.rank,jr=`var bIndices: ${g.type.indices};`;for(let Hr=Lt-2-1,wn=rr-1;Hr>=0;Hr--,wn--)jr+=`
bIndices[${Hr}] = ${rr>1?`batchIndices[${wn}]`:"batchIndices"};`;return vt.forEach(Hr=>{jr+=`
bIndices[${Hr}] = 0;`}),jr+=`
bIndices[${Lt-2}] = u32(row);
                   bIndices[${Lt-1}] = u32(colIn);`,jr};return`
    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${h.type.indices}) -> ${nt(e,Ft)} {
      var value = ${nt(e,Ft)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)
      {
        ${Gt()}
        value = ${b.getByIndices("aIndices")};
      }
      return value;
    }

    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${h.type.indices}) -> ${nt(e,Ft)} {
      var value = ${nt(e,Ft)}(0.0);
      let col = colIn * ${e};
      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)
      {
        ${qt()}
        value = ${g.getByIndices("bIndices")};
      }
      return value;
    }

    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${nt(e,Ft)}) {
      let col = colIn * ${e};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {
        var value = valueIn;
        let coords = vec3<i32>(batch, row, colIn);
        ${i?`value = value + ${s?"bias[colIn]":`${nt(e,Ft)}(bias[row])`};`:""}
        ${a}
        ${st.setByIndices("vec3<u32>(coords)","value")}
      }
    }
    `},ii=(e,i,a,o,c=!1)=>{let s=e[0].dims,d=e[1].dims,$=s.slice(0,-2),et=d.slice(0,-2),h=o?o.slice(0,-2):a.slice(0,-2),b=M.size(h),g=s[s.length-2],st=s[s.length-1],$t=d[d.length-1],vt=st%4===0&&$t%4===0,Ft=g<=8?[4,1,1]:[4,4,1],Gt=[8,8,1],qt=[Math.ceil($t/Gt[0]/Ft[0]),Math.ceil(g/Gt[1]/Ft[1]),Math.ceil(b/Gt[2]/Ft[2])],Lt=vt?4:1,rr=[...$,g,st/Lt],jr=rr.length,Hr=[...et,st,$t/Lt],wn=Hr.length,_n=[b,g,$t/Lt],No=[{type:6,data:g},{type:6,data:$t},{type:6,data:st}];Ot(i,No),No.push(...X(h,rr,Hr));let Qo=["rank","rank"],Xo=e.length>2;Xo&&(No.push(...X(e[2].dims)),Qo.push("rank")),No.push(...X(_n));let l0=v0=>{let x0=h.length,D0=qn("batchDims",e[0].dataType,x0,1),M0=De(e[0].dataType),Mo=U("a",e[0].dataType,jr,Lt),e0=U("b",e[1].dataType,wn,Lt),Sn=K("result",e[0].dataType,_n.length,Lt),t0=[Mo,e0];if(Xo){let N0=c?Lt:1;t0.push(U("bias",e[2].dataType,e[2].dims.length,N0))}let d0=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];Pt(i,d0);let xn=De(Sn.type.tensor),f0=kt(i,Sn.type.value,xn),$0=_p(Lt,Xo,f0,[D0,Mo,e0,Sn],[$,et,h],c);return`
  ${v0.registerUniforms(d0).registerInternalVariables(D0).declareVariables(...t0,Sn)}
  ${$0}
  ${vt?rn(Ft,Gt,M0,D0):nn(Ft,Gt,M0,D0)}
                   `};return{name:"MatMul",shaderCache:{hint:`${Ft};${i.activation};${vt};${c}`,inputDependencies:Qo},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:qt[0],y:qt[1],z:qt[2]},programUniforms:No}),getShaderSource:l0}}}),xp,Uu,Wu=j(()=>{ye(),Xt(),_e(),Zt(),ri(),uo(),on(),xp=(e,i,a,o,c=!1,s,d=4,$=4,et=4,h="f32")=>{let b=Qo=>{switch(Qo){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${h}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${Qo} is not supported.`)}},g=Qo=>{switch(Qo){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${Qo} is not supported.`)}},st=e?`
    let coord = vec4<i32>(batch, xRow, xCol, xCh);
    `:`
    let coord = vec4<i32>(batch, xCh, xRow, xCol);
    `,$t=e?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,vt=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",Ft=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",Gt=e?"row":"col",qt=e?"col":"row",Lt=`
    let inChannels = i32(uniforms.w_shape[2]);
    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
    let outRow = ${Gt} / outWidth;
    let outCol = ${Gt} % outWidth;

    let WRow = ${qt} / (i32(uniforms.w_shape[1]) * inChannels);
    let WCol = ${qt} / inChannels % i32(uniforms.w_shape[1]);
    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];
    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];
    let xCh = ${qt} % inChannels;
    var resData = ${nt(d,h)}(0.0);
    // The bounds checking is always needed since we use it to pad zero for
    // the 'same' padding type.
    if (xRow >= 0 && xRow < ${vt} && xCol >= 0 && xCol < ${Ft}) {
      ${st}
      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));
      ${b(d)}
    }
    return resData;`,rr=e?i&&o?`
    let col = colIn * ${d};
    ${Lt}`:`
    let col = colIn * ${d};
    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {
      ${Lt}
    }
    return ${nt(d,h)}(0.0);`:o&&a?`
    let col = colIn * ${d};
    ${Lt}`:`
    let col = colIn * ${d};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${Lt}
    }
    return ${nt(d,h)}(0.0);`,jr=`${g($)}`,Hr=nt(et,h),wn=nt(e?d:$,h),_n=nt(e?$:d,h),No=kt(s,Hr,h);return`
    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${wn} {
      ${e?rr:jr}
    }

    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${_n} {
      ${e?jr:rr}
    }

    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${Hr}) {
      let col = colIn * ${et};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)
      {
      var value = valueIn;
      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      ${$t}
      ${ti(c)}
      ${No}
      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
      }
    }`},Uu=(e,i,a,o,c,s,d,$)=>{let et=i.format==="NHWC",h=et?e[0].dims[3]:e[0].dims[1],b=a[0],g=et?a[2]:a[3],st=et?a[1]:a[2],$t=et?a[3]:a[1],vt=et&&(h%4===0||h%3===0)&&$t%4===0,Ft=et?$t:g*st,Gt=et?g*st:$t,qt=[8,8,1],Lt=o<=8?[4,1,1]:[4,4,1],rr=[Math.ceil(Ft/qt[0]/Lt[0]),Math.ceil(Gt/qt[1]/Lt[1]),Math.ceil(b/qt[2]/Lt[2])];Ne("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${rr}`);let jr=vt?et&&h%4!==0?3:4:1,Hr=qt[1]*Lt[1],wn=qt[0]*Lt[0],_n=Math.max(qt[0]*jr,qt[1]),No=o%Hr===0,Qo=c%wn===0,Xo=s%_n===0,l0=vt?[jr,4,4]:[1,1,1],v0=[{type:6,data:o},{type:6,data:c},{type:6,data:s},{type:6,data:[i.pads[0],i.pads[1]]},{type:6,data:i.strides},{type:6,data:i.dilations}];Ot(i,v0),v0.push(...X(e[0].dims,e[1].dims));let x0=["rank","rank"];d&&(v0.push(...X(e[2].dims)),x0.push("rank")),v0.push(...X(a));let D0=M0=>{let Mo=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];Pt(i,Mo);let e0=vt?4:1,Sn=De(e[0].dataType),t0=`
      fn setOutputAtIndex(flatIndex : i32, value : ${vt?`vec4<${Sn}>`:Sn}) {
        result[flatIndex] = ${vt?`vec4<${Sn}>`:Sn}(value);
      }
      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${vt?`vec4<${Sn}>`:Sn}) {
        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));
        setOutputAtIndex(flatIndex ${vt?"/ 4":""}, value);
      }`,d0=U("x",e[0].dataType,e[0].dims.length,jr===3?1:jr),xn=U("w",e[1].dataType,e[1].dims.length,e0),f0=[d0,xn],$0=K("result",e[0].dataType,a.length,e0);if(d){let N0=U("bias",e[2].dataType,e[2].dims.length,e0);f0.push(N0),t0+=`
        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${vt?`vec4<${Sn}>`:Sn} {
          return bias[coords.${et?"w":"y"}${vt?"/ 4":""}];
        }`}return`
        ${ni("uniforms.result_strides")}
        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,
        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,
        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };
        ${M0.registerUniforms(Mo).declareVariables(...f0,$0)}
        ${t0}
        ${xp(et,No,Qo,Xo,d,i,l0[0],l0[1],l0[2],Sn)}
        ${vt?rn(Lt,qt,Sn,void 0,!et,_n):nn(Lt,qt,Sn,void 0,!et,_n,!1,void 0,$)}`};return{name:"Conv2DMatMul",shaderCache:{hint:`${i.cacheKey};${jr};${vt};${No};${Qo};${Xo};${Hr};${wn};${_n}`,inputDependencies:x0},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:rr[0],y:rr[1],z:rr[2]},programUniforms:v0}),getShaderSource:D0}}}),lo,Nu,Vu=j(()=>{ye(),xe(),_e(),co(),Zt(),lo=(e,i,a)=>{let o=e.length>2,c=o?"value += b[output_channel];":"",s=e[0].dims,d=e[1].dims,$=d[0]/i.group,et=i.format==="NHWC",h=oi(s,d,i.dilations,i.pads,i.strides,et),b=M.size(h),g=[{type:12,data:b},{type:12,data:i.dilations},{type:12,data:[i.strides[0],i.strides[1]]},{type:12,data:[i.pads[0],i.pads[1]]},{type:12,data:$}];Ot(i,g),g.push(...X(s,d));let st=["rank","rank"];o&&(g.push(...X(e[2].dims)),st.push("rank")),g.push(...X(h));let $t=vt=>{let Ft=K("output",e[0].dataType,h.length),Gt=De(Ft.type.tensor),qt=kt(i,Ft.type.value,Gt),Lt=U("x",e[0].dataType,s.length),rr=U("w",e[1].dataType,d.length),jr=[Lt,rr];o&&jr.push(U("b",e[2].dataType,e[2].dims.length));let Hr=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:i.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];return Pt(i,Hr),`
  ${vt.registerUniforms(Hr).declareVariables(...jr,Ft)}

  ${vt.mainStart()}
    ${vt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let outputIndices = ${Ft.offsetToIndices("global_idx")};
    let batch: u32 = outputIndices[0];
    let output_channel: u32 = outputIndices[${et?3:1}];
    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${et?1:2}], outputIndices[${et?2:3}]) * uniforms.strides - uniforms.pads;
    let group_id: u32 = output_channel / uniforms.output_channels_per_group;

    var value: ${Ft.type.value} = ${Ft.type.value}(0);
    for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {
      let input_channel = group_id * uniforms.w_shape[1] + wInChannel;
      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {
        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

        if (xHeight < 0u || xHeight >= uniforms.x_shape[${et?1:2}]) {
          continue;
        }

        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {
          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
          if (xWidth < 0u || xWidth >= uniforms.x_shape[${et?2:3}]) {
            continue;
          }

          let xVal = ${et?Lt.get("batch","xHeight","xWidth","input_channel"):Lt.get("batch","input_channel","xHeight","xWidth")};
          let wVal = ${rr.get("output_channel","wInChannel","wHeight","wWidth")};
          value += xVal*wVal;
        }
      }
    }
    ${c}
    ${qt}
    ${Ft.setByOffset("global_idx","value")}
  }`};return{name:"GroupedConv",shaderCache:{hint:i.cacheKey,inputDependencies:st},getRunData:()=>({outputs:[{dims:a?a(h):h,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(b/64)},programUniforms:g}),getShaderSource:$t}},Nu=(e,i,a)=>{let o=e.length>2,c=Ue(a[3]),s=Ue(a[2]),d=M.size(a)/c/s,$=[e[0].dims[0],e[0].dims[1],e[0].dims[2],e[0].dims[3]/c],et=[e[1].dims[0],e[1].dims[1],e[1].dims[2],e[1].dims[3]/c],h=[a[0],a[1],a[2],a[3]/c],b=[{type:12,data:d},{type:6,data:[i.strides[0],i.strides[1]]},{type:6,data:[i.pads[0],i.pads[1]]}];Ot(i,b),b.push(...X($,et,h));let g=(s-1)*i.strides[1]+et[1],st=$t=>{let vt=K("output",e[0].dataType,h.length,c),Ft=De(vt.type.tensor),Gt=kt(i,vt.type.value,Ft),qt=U("x",e[0].dataType,$.length,c),Lt=U("w",e[1].dataType,et.length,c),rr=[qt,Lt];o&&rr.push(U("b",e[2].dataType,e[2].dims,c));let jr=o?"value += b[output_channel];":"",Hr=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return Pt(i,Hr),`
  ${$t.registerUniforms(Hr).declareVariables(...rr,vt)}
  ${$t.mainStart()}
    ${$t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let width0 = uniforms.output_shape[3];
    let output_channel = global_idx % width0;
    var index1 = global_idx / width0;
    let width1 = uniforms.output_shape[2] / ${s}u;
    let col = (index1 % width1) * ${s}u;
    index1 = index1 / width1;
    let row = index1 % uniforms.output_shape[1];
    let batch = index1 / uniforms.output_shape[1];

    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;

    var x_vals: array<${qt.type.value}, ${g}>;
    var values: array<${vt.type.value}, ${s}>;
    let input_channel = output_channel;
    // Use constant instead of uniform can give better performance for w's height/width.
    for (var w_height: u32 = 0u; w_height < ${et[0]}; w_height++) {
      let x_height = x_corner.x + i32(w_height);
      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {
        for (var i = 0; i < ${g}; i++) {
          let x_width = x_corner.y + i;
          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {
            x_vals[i] = ${qt.get("batch","u32(x_height)","u32(x_width)","input_channel")};
          } else {
            x_vals[i] = ${qt.type.value}(0);
          }
        }
        for (var w_width: u32 = 0u; w_width < ${et[1]}; w_width++) {
          let w_val = ${Lt.get("w_height","w_width","0","output_channel")};
          for (var i = 0u; i < ${s}u; i++) {
            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);
          }
        }
      }
    }

    for (var i = 0u; i < ${s}u; i++) {
      var value = values[i];
      ${jr}
      ${Gt}
      ${vt.set("batch","row","col + i","output_channel","value")};
    }
  }`};return{name:"GroupedConv-Vectorize",shaderCache:{hint:`${i.cacheKey};${c};${s};${g};${et[0]};${et[1]}`,inputDependencies:o?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:b}),getShaderSource:st}}}),po,Sp,Hu,mo=j(()=>{ye(),xe(),on(),_e(),Zt(),po=(e,i,a,o,c=!1)=>{let s=e[0].dims,d=e[1].dims,$=s[s.length-2],et=d[d.length-1],h=s[s.length-1],b=Ue(et),g=Ue(h),st=Ue($),$t=M.size(a)/b/st,vt=e.length>2,Ft=o?o.slice(0,-2):a.slice(0,-2),Gt=[M.size(Ft),$,et],qt=[{type:12,data:$t},{type:12,data:$},{type:12,data:et},{type:12,data:h}];Ot(i,qt),qt.push(...X(Ft,s,d)),vt&&qt.push(...X(e[2].dims)),qt.push(...X(Gt));let Lt=rr=>{let jr=qn("batch_dims",e[0].dataType,Ft.length),Hr=U("a",e[0].dataType,s.length,g),wn=U("b",e[1].dataType,d.length,b),_n=K("output",e[0].dataType,Gt.length,b),No=De(_n.type.tensor),Qo=kt(i,_n.type.value,No),Xo=[Hr,wn],l0="";if(vt){let t0=c?b:1;Xo.push(U("bias",e[2].dataType,e[2].dims.length,t0)),l0=`${c?`value += bias[col / ${t0}];`:`value += ${_n.type.value}(bias[row + i]);`}`}let v0=s.slice(0,-2),x0=d.slice(0,-2),D0=Pr(v0,Ft),M0=Pr(x0,Ft),Mo=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];Pt(i,Mo);let e0=(t0,d0)=>{let xn=t0.rank,f0=t0.name;if(xn===2)return`var ${f0}_indices = ${t0.type.indices}(0u, 0u);`;let $0=jr.rank,N0=`var ${f0}_indices: ${t0.type.indices};`;for(let j0=xn-2-1,Z0=$0-1;j0>=0;j0--,Z0--)N0+=`
${f0}_indices[${j0}] = ${$0>1?`batch_indices[${Z0}]`:"batch_indices"};`;return d0.forEach(j0=>{N0+=`
${f0}_indices[${j0}] = 0;`}),N0+=`${f0}_indices[${xn-2}] = 0u;
                     ${f0}_indices[${xn-1}] = 0u;`,N0},Sn=()=>{let t0=`var a_data: ${Hr.type.value};`;for(let d0=0;d0<g;d0++)t0+=`
              let b_data${d0} = b[(b_offset + (k + ${d0}) * uniforms.N + col) / ${b}];`;for(let d0=0;d0<st;d0++){t0+=`a_data = a[(a_offset + (row + ${d0}) * uniforms.K + k) / ${g}];`;for(let xn=0;xn<g;xn++)t0+=`
            values[${d0}] = fma(${wn.type.value}(a_data${g===1?"":`[${xn}]`}), b_data${xn}, values[${d0}]);
`}return t0};return`
  ${rr.registerUniforms(Mo).registerInternalVariables(jr).declareVariables(...Xo,_n)}
  ${rr.mainStart()}
    ${rr.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let col = (global_idx % (uniforms.N / ${b})) * ${b};
    var index1 = global_idx / (uniforms.N / ${b});
    let stride1 = uniforms.M / ${st};
    let row = (index1 % stride1) * ${st};
    let batch = index1 / stride1;

    ${a.length===2?"":`let batch_indices = ${jr.offsetToIndices("batch")};`}
    ${e0(Hr,D0)}
    let a_offset = ${Hr.indicesToOffset("a_indices")};
    ${e0(wn,M0)}
    let b_offset = ${wn.indicesToOffset("b_indices")};
    var values: array<${_n.type.value}, ${st}>;
    for (var k: u32 = 0u; k < uniforms.K; k = k + ${g}) {
      ${Sn()}
    }
    for (var i = 0u; i < ${st}u; i++) {
      var value = values[i];
      ${l0}
      ${Qo}
      let cur_indices = ${_n.type.indices}(batch, row + i, col);
      let offset = ${_n.indicesToOffset("cur_indices")};
      ${_n.setByOffset(`offset / ${b}`,"value")};
    }
  }
  `};return{name:"MatMulNaive",shaderCache:{hint:`${i.activation};${b};${g};${st};${c}`,inputDependencies:vt?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil($t/64)},programUniforms:qt}),getShaderSource:Lt}},Sp=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},Hu=e=>{Sp(e.inputs);let i=zt.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!i)throw new Error("Can't use matmul on the given tensors");let a=i[i.length-1],o=e.inputs[0].dims[e.inputs[0].dims.length-1];a<8&&o<8?e.compute(po(e.inputs,{activation:""},i)):e.compute(ii(e.inputs,{activation:""},i))}}),oi,fo,Cp,Gu,ho,Ip,Tp,go,co=j(()=>{xe(),Wu(),on(),Vu(),Zt(),mo(),Rr(),oi=(e,i,a,o,c,s)=>{let d=e[0],$=e.slice(s?1:2,s?3:4),et=$.length,h=i[0],b=i.slice(2).map((st,$t)=>st+(st-1)*(a[$t]-1)),g=$.map((st,$t)=>st+o[$t]+o[$t+et]).map((st,$t)=>Math.floor((st-b[$t]+c[$t])/c[$t]));return g.splice(0,0,d),g.splice(s?3:1,0,h),g},fo=[2,3,1,0],Cp=(e,i)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support conv 1D and 2D");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let a=e[0].dims[i.format==="NHWC"?e[0].dims.length-1:1],o=e[1].dims[1]*i.group;if(a!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(e.length===3&&(e[2].dims.length!==1||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let c=e[0].dims.length-2;if(i.dilations.length!==c)throw new Error(`dilations should be ${c}D`);if(i.strides.length!==c)throw new Error(`strides should be ${c}D`);if(i.pads.length!==c*2)throw new Error(`pads should be ${c*2}D`);if(i.kernelShape.length!==0&&i.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},Gu=(e,i)=>{let a=e.kernelShape.slice();for(let s=2;s<i[1].dims.length;++s)a[s-2]===0&&(a[s-2]=i[1].dims[s]);let o=e.pads.slice();pr.adjustPadsBasedOnAutoPad(i[0].dims,e.strides,e.dilations,a,o,e.format==="NHWC",e.autoPad);let c=Object.assign({},e);return Object.assign(c,{kernelShape:a,pads:o}),c},ho=e=>{let i=ei(e),a=e.format,o=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],c=e.dilations,s=e.group,d=e.kernel_shape,$=e.pads,et=e.strides,h=e.w_is_const();return{autoPad:o,format:a,dilations:c,group:s,kernelShape:d,pads:$,strides:et,wIsConst:h,...i,cacheKey:`${e.format};${i.activation};`}},Ip=(e,i,a)=>{let o=Gu(a,i),c=a.format==="NHWC";if(a.group!==1){if(!e.adapterInfo.isArchitecture("ampere")&&c&&i[1].dims[0]===a.group&&i[1].dims[1]===1&&a.dilations[0]===1&&a.dilations[1]===1){let wn=oi(i[0].dims,i[1].dims,a.dilations,o.pads,a.strides,c),_n=e.kernelCustomData.wT??e.compute(xt(i[1],fo),{inputs:[1],outputs:[a.wIsConst?-2:-1]})[0];a.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=_n);let No=[i[0],_n];i.length===3&&No.push(i[2]),e.compute(Nu(No,o,wn),{inputs:No})}else e.compute(lo(i,o));return}let s=i.length===3,d=i[0].dims[c?1:2],$=i[0].dims[c?2:3],et=i[0].dims[c?3:1],h=i[1].dims[2],b=i[1].dims[3],g=oi(i[0].dims,i[1].dims,a.dilations,o.pads,a.strides,c),st=g[c?1:2],$t=g[c?2:3],vt=g[c?3:1],Ft=c&&h===d&&b===$&&a.pads[0]===0&&a.pads[1]===0;if(Ft||h===1&&b===1&&a.dilations[0]===1&&a.dilations[1]===1&&a.strides[0]===1&&a.strides[1]===1&&a.pads[0]===0&&a.pads[1]===0){let wn=g[0],_n,No,Qo,Xo=[];if(c){let x0=e.kernelCustomData.wT??e.compute(xt(i[1],fo),{inputs:[1],outputs:[a.wIsConst?-2:-1]})[0];if(a.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=x0),Ft){let D0=d*$*et;_n=i[0].reshape([1,wn,D0]),No=x0.reshape([1,D0,vt]),Qo=[1,wn,vt]}else _n=i[0].reshape([wn,d*$,et]),No=x0.reshape([1,et,vt]),Qo=[wn,st*$t,vt];Xo.push(_n),Xo.push(No)}else _n=i[0].reshape([wn,et,d*$]),No=i[1].reshape([1,vt,et]),Qo=[wn,vt,st*$t],Xo.push(No),Xo.push(_n);s&&Xo.push(i[2]);let l0=Qo[2],v0=Xo[0].dims[Xo[0].dims.length-1];l0<8&&v0<8?e.compute(po(Xo,o,g,Qo,c),{inputs:Xo}):e.compute(ii(Xo,o,g,Qo,c),{inputs:Xo});return}let Gt=!0,qt=e.kernelCustomData.wT??e.compute(xt(i[1],fo),{inputs:[1],outputs:[a.wIsConst?-2:-1]})[0];a.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=qt);let Lt=[i[0],qt];s&&Lt.push(i[2]);let rr=c?st*$t:vt,jr=c?vt:st*$t,Hr=h*b*et;e.compute(Uu(Lt,o,g,rr,jr,Hr,s,Gt),{inputs:Lt})},Tp=(e,i)=>{let a=i.format==="NHWC",o=[e.inputs[0].reshape(a?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&o.push(e.inputs[2]);let c=[0,i.pads[0],0,i.pads[1]],s=[1].concat(i.strides),d=[1].concat(i.dilations),$=[1].concat(i.kernelShape),et=Gu({...i,pads:c,strides:s,dilations:d,kernelShape:$},o);e.compute(lo(o,et,h=>a?[h[0],h[2],h[3]]:[]))},go=(e,i)=>{Cp(e.inputs,i),e.inputs[0].dims.length===3?Tp(e,i):Ip(e,e.inputs,i)}}),Ap,Lu,Fu=j(()=>{ye(),Xt(),_e(),Zt(),ri(),uo(),on(),Ap=(e,i=!1,a,o,c=4)=>{let s=Gt=>{switch(Gt){case 1:return"return w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];";case 4:return`
            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);
            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);
            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);
            let v0 = w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];
            let v1 = w[getIndexFromCoords4D(coord1, vec4<i32>(uniforms.w_shape))];
            let v2 = w[getIndexFromCoords4D(coord2, vec4<i32>(uniforms.w_shape))];
            let v3 = w[getIndexFromCoords4D(coord3, vec4<i32>(uniforms.w_shape))];
            return ${o}(v0, v1, v2, v3);
            `;default:throw new Error(`innerElementSize ${Gt} is not supported.`)}},d=e?`
      let coord = vec4<i32>(batch, iXR, iXC, xCh);
      `:`
      let coord = vec4<i32>(batch, xCh, iXR, iXC);
      `,$=e?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,et=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",h=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",b=e?"row":"col",g=e?"col":"row",st=`
      let inChannels = ${e?"i32(uniforms.x_shape[3])":"i32(uniforms.x_shape[1])"};
      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      let outRow = ${b} / outWidth;
      let outCol = ${b} % outWidth;

      let WRow = ${g} / (uniforms.filter_dims[1] * inChannels);
      let WCol = ${g} / inChannels % uniforms.filter_dims[1];
      let xR = f32(outRow - uniforms.pads[0] + uniforms.dilations[0] * WRow) / f32(uniforms.strides[0]);
      let xC = f32(outCol - uniforms.pads[1] + uniforms.dilations[1] * WCol) / f32(uniforms.strides[1]);
      if (xR < 0.0 || xR >= f32(${et}) || fract(xR) > 0.0) {
        return ${o}(0.0);
      }
      if (xC < 0.0 || xC >= f32(${h}) || fract(xC) > 0.0) {
        return ${o}(0.0);
      }
      let iXR = i32(xR);
      let iXC = i32(xC);
      let xCh = ${g} % inChannels;
      ${d}
      return x[getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape))/${c}];`,$t=e?`
      let col = colIn * ${c};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {
        ${st}
      }
      return ${o}(0.0);`:`
      let col = colIn * ${c};
      if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
        ${st}
      }
      return ${o}(0.0);`,vt=`
      let col = colIn * ${c};
      let inChannels = ${e?"i32(uniforms.x_shape[3])":"i32(uniforms.x_shape[1])"};
      let coordX = uniforms.filter_dims[0] - 1 - row / (uniforms.filter_dims[1] * inChannels);
      let coordY = uniforms.filter_dims[1] - 1 - (row / inChannels) % uniforms.filter_dims[1];
      if (${e?"row < uniforms.dim_inner && col < uniforms.dim_b_outer":"row < uniforms.dim_inner && col < uniforms.dim_a_outer"}  && coordX >= 0 && coordY >= 0) {
        let rowInner = row % inChannels;
        let coord = vec4<i32>(coordX, coordY, col, rowInner);
        ${s(c)}
      }
      return ${o}(0.0);
      `,Ft=kt(a,o);return`
  fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${o} {
    ${e?$t:vt}
  }

  fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${o} {
    ${e?vt:$t}
  }

  fn mm_write(batch: i32, row : i32, colIn : i32, valueInput : ${o}) {
    let col = colIn * ${c};
    if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {
      var value = valueInput;
      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      ${$}
      ${ti(i)}
      ${Ft}
      result[getIndexFromCoords4D(coords, vec4<i32>(uniforms.result_shape))/${c}] = value;
    }
  }`},Lu=(e,i,a,o,c,s,d,$)=>{let et=i.format==="NHWC",h=et?e[0].dims[3]:e[0].dims[1],b=a[0],g=et?a[2]:a[3],st=et?a[1]:a[2],$t=et?a[3]:a[1],vt=et&&h%4===0&&h%3&&$t%4===0,Ft=et?$t:g*st,Gt=et?g*st:$t,qt=[8,8,1],Lt=o<=8?[4,1,1]:[4,4,1],rr=[Math.ceil(Ft/qt[0]/Lt[0]),Math.ceil(Gt/qt[1]/Lt[1]),Math.ceil(b/qt[2]/Lt[2])];Ne("verbose",()=>`[conv_backprop_mm_webgpu] dispatch = ${rr}`);let jr=vt?4:1,Hr=Math.max(qt[0]*jr,qt[1]),wn=vt?4:1,_n=[i.kernelShape[et?1:2],i.kernelShape[et?2:3]],No=[_n[0]+(i.dilations[0]<=1?0:(_n[0]-1)*(i.dilations[0]-1)),_n[1]+(i.dilations[1]<=1?0:(_n[1]-1)*(i.dilations[1]-1))],Qo=[No[0]-1-Math.floor((i.pads[0]+i.pads[2])/2),No[1]-1-Math.floor((i.pads[1]+i.pads[3])/2)],Xo=[{type:6,data:o},{type:6,data:c},{type:6,data:s},{type:6,data:i.strides},{type:6,data:i.dilations},{type:6,data:_n},{type:6,data:Qo}];Ot(i,Xo),Xo.push(...X(e[0].dims,e[1].dims));let l0=["rank","rank"];d&&(Xo.push(...X(e[2].dims)),l0.push("rank")),Xo.push(...X(a));let v0=x0=>{let D0=U("x",e[0].dataType,e[0].dims.length,wn),M0=U("w",e[1].dataType,e[1].dims.length,1),Mo=K("result",e[0].dataType,a.length,wn),e0=[D0,M0],Sn="";if(d){let xn=U("bias",e[2].dataType,e[2].dims.length,wn);e0.push(xn),Sn+=`
          fn getBiasByOutputCoords(coords : vec4<i32>) -> ${xn.type.value} {
            return bias[coords.${et?"w":"y"}${vt?"/ 4":""}];
          }`}let t0=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"strides",type:"i32",length:2},{name:"dilations",type:"i32",length:2},{name:"filter_dims",type:"i32",length:_n.length},{name:"pads",type:"i32",length:Qo.length}];Pt(i,t0);let d0=De(e[0].dataType,1);if(d0!=="f16"&&d0!=="f32")throw new Error(`elemType ${d0} is not supported.`);return`
        ${ni("uniforms.result_strides")}
        ${x0.registerUniforms(t0).declareVariables(...e0,Mo)};
        ${Sn}
        ${Ap(et,d,i,D0.type.value,jr)}
        ${vt?rn(Lt,qt,d0,void 0,!et,Hr):nn(Lt,qt,d0,void 0,!et,Hr,!1,void 0,$)}`};return{name:"Conv2DTransposeMatMul",shaderCache:{hint:`${i.cacheKey};${Lt};${qt};${vt}`,inputDependencies:l0},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:rr[0],y:rr[1],z:rr[2]},programUniforms:Xo}),getShaderSource:v0}}}),Ep,yo,qu=j(()=>{ye(),Xt(),xe(),_e(),Ep=(e,i,a,o,c,s=!1,d,$,et=!1)=>{let h=et?1:2,b=et?2:3,g=et?3:1,st=s?2:1,$t=`
  fn setOutputAtIndex(flatIndex : u32, value : ${s?`vec4<${d}>`:d}) {
    result[flatIndex] = ${s?`vec4<${d}>`:d}(value);
  }`;o&&($t+=`
    fn getBiasByOutputCoords(coords : vec4<u32>) -> ${s?`vec4<${d}>`:d} {
      return bias[coords.${et?"w":"y"}${s?"/ 4":""}];
    }`);let vt=s?4:1,Ft=U("W",i[1].dataType,i[1].dims.length,vt),Gt=U("Dy",i[0].dataType,i[0].dims.length,vt),qt=[Gt,Ft];o&&qt.push(U("bias",i[2].dataType,[a[g]].length,vt));let Lt=K("result",i[0].dataType,a.length,vt),rr=`{
        let batch: u32 = ${c?"global_id.z":"workgroup_id.z"} / uniforms.result_shape[1];
        let r = ${c?"global_id.z":"workgroup_id.z"} % uniforms.result_shape[1];
        let c = ${c?"global_id.y":"workgroup_id.y"} * ${st};
        let d1: u32 = ${c?"global_id.x":"workgroup_id.x"} * 4;

        let dyCorner = vec2<i32>(i32(r), i32(c)) - vec2<i32>(uniforms.pads);

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        var dotProd: array<vec4<${d}>, ${st}>;
        for (var i = 0; i < ${st}; i++) {
          dotProd[i] = vec4<${d}>(0.0);
        }
        for (var wR: u32 = 0; wR < uniforms.filter_dims[0]; wR = wR + 1) {
          var dyR = (${d}(dyCorner.x) + ${d}(wR)) / ${d}(uniforms.strides.x);
          let wRPerm = uniforms.filter_dims[0] - 1 - wR;
          if (dyR < 0.0 || dyR >= ${d}(uniforms.Dy_shape[1]) ||
              fract(dyR) > 0.0 || wRPerm < 0) {
            continue;
          }
          let idyR: u32 = u32(dyR);

          for (var wC: u32 = 0; wC < uniforms.filter_dims[1]; wC = wC + 1) {
            let dyC = (${d}(dyCorner.y) + ${d}(wC)) / ${d}(uniforms.strides.y);
            let dyC2 = (${d}(dyCorner.y) + 1.0 + ${d}(wC)) / ${d}(uniforms.strides.y);
            let wCPerm = uniforms.filter_dims[1] - 1 - wC;
            if (wCPerm < 0) {
              continue;
            }
            var bDyCVal = true;
            var bDyCVal2 = true;
            if (dyC < 0.0 || dyC >= ${d}(uniforms.Dy_shape[2]) ||
                fract(dyC) > 0.0) {
              bDyCVal = false;
            }
            if (dyC2 < 0.0 || dyC2 >= ${d}(uniforms.Dy_shape[2]) ||
                fract(dyC2) > 0.0) {
              bDyCVal2 = false;
            }

            let idyC: u32 = u32(dyC);
            let idyC2: u32 = u32(dyC2);
            if (bDyCVal && bDyCVal2) {
              let d2Length = uniforms.Dy_shape[3];
              for (var d2 :u32 = 0; d2 < d2Length; d2 = d2 + 4) {
                let wValue0 = ${Ft.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};
                let wValue1 = ${Ft.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};
                let wValue2 = ${Ft.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};
                let wValue3 = ${Ft.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};

                var xValue = ${Gt.get("batch","idyR","idyC","d2")};
                let tmpval = vec4<${d}>(dot(xValue, wValue0),
                                      dot(xValue, wValue1),
                                      dot(xValue, wValue2),
                                      dot(xValue, wValue3));
                dotProd[0] = dotProd[0] + tmpval;

                xValue =  ${Gt.get("batch","idyR","idyC2","d2")};

                dotProd[1] = dotProd[1] + vec4<${d}>(dot(xValue, wValue0),
                                                    dot(xValue, wValue1),
                                                    dot(xValue, wValue2),
                                                    dot(xValue, wValue3));
              }
            } else if (bDyCVal) {
              let d2Length = uniforms.Dy_shape[${g}];
              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {
                let wValue0 = ${Ft.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};
                let wValue1 = ${Ft.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};
                let wValue2 = ${Ft.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};
                let wValue3 = ${Ft.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};

                var xValue = ${Gt.get("batch","idyR","idyC","d2")};
                let tmpval = vec4<${d}>(dot(xValue, wValue0),
                                      dot(xValue, wValue1),
                                      dot(xValue, wValue2),
                                      dot(xValue, wValue3));
                dotProd[0] = dotProd[0] + tmpval;
              }
            } else if (bDyCVal2) {
              let d2Length = uniforms.Dy_shape[3];
              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {
                let wValue0 = ${Ft.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};
                let wValue1 = ${Ft.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};
                let wValue2 = ${Ft.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};
                let wValue3 = ${Ft.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};

                var xValue = ${Gt.get("batch","idyR","idyC2","d2")};
                let tmpval = vec4<${d}>(dot(xValue, wValue0),
                                      dot(xValue, wValue1),
                                      dot(xValue, wValue2),
                                      dot(xValue, wValue3));
                dotProd[1] = dotProd[1] + tmpval;
              }
            }
          }
        }

        for (var i: u32 = 0; i < ${st}; i = i + 1) {
          let value = dotProd[i] + ${o?"bias[c+i]":`vec4<${d}>(0.0)`};
          ${Lt.set("batch","r","c + i","d1","value")};
        }
      }`,jr=`
          let outputIndices = ${Lt.offsetToIndices("global_idx")};
          let batch = ${Lt.indicesGet("outputIndices",0)};
          let d1 = ${Lt.indicesGet("outputIndices",g)};
          let r = ${Lt.indicesGet("outputIndices",h)};
          let c = ${Lt.indicesGet("outputIndices",b)};
          let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;
          let dyRCorner = dyCorner.x;
          let dyCCorner = dyCorner.y;
          let groupId = d1 / uniforms.output_channels_per_group;
          let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;
          // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
          // ? = to be determined. : = across all values in that axis.
          var dotProd = ${d}(0.0);
          for (var wR: u32 = 0; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {
            if (wR % uniforms.dilations.x != 0) {
              continue;
            }
            let dyR = (${d}(dyRCorner) + ${d}(wR)) / ${d}(uniforms.strides[0]);
            let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;
            if (dyR < 0.0 || dyR >= ${d}(uniforms.Dy_shape[${h}]) || fract(dyR) > 0.0 ||
                wRPerm < 0) {
              continue;
            }
            let idyR: u32 = u32(dyR);

            for (var wC: u32 = 0; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {
              if (wC % uniforms.dilations.y != 0) {
                continue;
              }
              let dyC = (${d}(dyCCorner) + ${d}(wC)) / ${d}(uniforms.strides.y);
              let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;
              if (dyC < 0.0 || dyC >= ${d}(uniforms.Dy_shape[${b}]) ||
                  fract(dyC) > 0.0 || wCPerm < 0) {
                continue;
              }
              let idyC: u32 = u32(dyC);
              var inputChannel = groupId * uniforms.input_channels_per_group;
              for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group; d2 = d2 + 1) {
                let xValue = ${et?Gt.get("batch","idyR","idyC","inputChannel"):Gt.get("batch","inputChannel","idyR","idyC")};
                let wValue = ${Ft.get("inputChannel","wOutChannel","u32(wRPerm)","u32(wCPerm)")};
                dotProd = dotProd + xValue * wValue;
                inputChannel = inputChannel + 1;
              }
            }
          }
          let value = dotProd + ${o?"bias[d1]":`${d}(0.0)`};
          ${Lt.setByOffset("global_idx","value")};
        `;return`
  ${e.registerUniforms($).declareVariables(...qt,Lt)}
  ${$t}

    ${e.mainStart()}
    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")};
  ${s?rr:jr}}`},yo=(e,i,a)=>{let o=e.length>2,c=i.outputShape,s=M.size(c),d=[Math.ceil(s/64),1,1];Ne("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${d}`);let $=i.format==="NHWC",et=["rank","rank"],h=[i.strides[0],i.strides[1]],b=[i.kernelShape[$?1:2],i.kernelShape[$?2:3]],g=[i.dilations[0],i.dilations[1]],st=[b[0]+(i.dilations[0]<=1?0:(i.kernelShape[$?1:2]-1)*(i.dilations[0]-1)),b[1]+(i.dilations[1]<=1?0:(i.kernelShape[$?2:3]-1)*(i.dilations[1]-1))],$t=[st[0]-1-Math.floor((i.pads[0]+i.pads[2])/2),st[1]-1-Math.floor(i.pads[1]+i.pads[3])/2],vt=!1,Ft=i.group,Gt=e[1].dims,qt=Gt[0]/Ft,Lt=Gt[1],rr=[{type:12,data:s},{type:12,data:h},{type:12,data:b},{type:12,data:g},{type:12,data:st},{type:6,data:$t},{type:12,data:qt},{type:12,data:Lt},...X(e[0].dims,e[1].dims)];o&&(rr.push(...X(e[2].dims)),et.push("rank")),rr.push(...X(c));let jr=d[1]===1&&d[2]===1,Hr=wn=>{let _n=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:h.length},{name:"filter_dims",type:"u32",length:b.length},{name:"dilations",type:"u32",length:b.length},{name:"effective_filter_dims",type:"u32",length:st.length},{name:"pads",type:"i32",length:$t.length},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],No=De(e[0].dataType);return`${Ep(wn,e,c,o,jr,vt,No,_n,$)}`};return{name:"ConvTranspose2D",shaderCache:{hint:`${i.cacheKey};`,inputDependencies:et},getRunData:()=>({dispatchGroup:{x:d[0],y:d[1],z:d[2]},outputs:[{dims:a?a(c):c,dataType:e[0].dataType}],programUniforms:rr}),getShaderSource:Hr}}}),kp,Op,Pp,ju,Ku,Rp,zp,Bp,Dp,Yu,Xu=j(()=>{Fu(),qu(),Zt(),Rr(),kp=(e,i,a,o,c,s)=>(e-1)*i+a+(o-1)*c+1-s,Op=(e,i,a,o,c)=>{let s=Math.floor(e/2);i==="SAME_UPPER"?(a[o]=s,a[c]=e-s):i==="SAME_LOWER"&&(a[o]=e-s,a[c]=s)},Pp=(e,i,a,o,c,s,d,$,et,h)=>{let b=e.length-2,g=h.length===0;if(et.length===0)for(let vt=0;vt<b;++vt)et.push(0);let st=e[0],$t=i[$?3:1]*c;for(let vt=0,Ft=e.length-b-($?1:0);vt<b;++vt,++Ft){let Gt=e[Ft],qt=g?Gt*d[vt]:h[vt],Lt=kp(Gt,d[vt],s[vt],i[Ft],a[vt],qt);Op(Lt,o,s,vt,vt+b),g&&h.push(d[vt]*(Gt-1)+et[vt]+(i[Ft]-1)*a[vt]+1-s[vt]-s[vt+b])}h.splice(0,0,st),h.splice($?3:1,0,$t)},ju=(e,i)=>{let a=e.kernelShape.slice();if(e.kernelShape.length===0||e.kernelShape.reduce((g,st)=>g*st,1)===0){a.length=0;for(let g=2;g<i[1].dims.length;++g)a.push(i[1].dims[g])}let o=e.format==="NHWC";a.splice(0,0,i[1].dims[0]),a.splice(o?3:1,0,i[1].dims[1]);let c=e.pads.slice(),s=e.outputShape.slice(),d=e.outputPadding.slice(),$=i[0].dims,et=e.dilations.slice();if(et.reduce((g,st)=>g+st,0)===0){let g=i[0].dims.length-2;et=new Array(g).fill(1)}let h=e.strides.slice();if(h.reduce((g,st)=>g+st,0)===0){let g=i[0].dims.length-2;h=new Array(g).fill(1)}Pp($,a,et,e.autoPad,e.group,c,h,o,d,s);let b=Object.assign({},e);return Object.assign(b,{kernelShape:a,pads:c,outputPadding:d,outputShape:s,dilations:et,strides:h}),b},Ku=e=>{let i=ei(e),a=e.format,o=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],c=e.dilations,s=e.group,d=e.kernelShape,$=e.pads,et=e.strides,h=e.wIsConst(),b=e.outputPadding,g=e.outputShape;return{autoPad:o,format:a,dilations:c,group:s,kernelShape:d,outputPadding:b,outputShape:g,pads:$,strides:et,wIsConst:h,...i,cacheKey:`${e.format};${i.activation};`}},Rp=(e,i)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let a=e[0].dims[i.format==="NHWC"?e[0].dims.length-1:1],o=e[1].dims[0];if(a!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let c=e[1].dims[1]*i.group;if(e.length===3&&(e[2].dims.length!==1||e[2].dims[0]!==c))throw new Error("invalid bias");let s=e[0].dims.length-2;if(i.dilations.reduce((d,$)=>d+$,0)>0&&i.dilations.length!==s)throw new Error(`dilations should be ${s}D`);if(i.strides.reduce((d,$)=>d+$,0)>0&&i.strides.length!==s)throw new Error(`strides should be ${s}D`);if(i.pads.reduce((d,$)=>d+$,0)>0&&i.pads.length!==s*2)throw new Error(`pads should be ${s*2}D`);if(i.outputPadding.length!==s&&i.outputPadding.length!==0)throw new Error(`output_padding should be ${s}D`);if(i.kernelShape.reduce((d,$)=>d+$,0)>0&&i.kernelShape.length!==0&&i.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(i.outputShape.length!==0&&i.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},zp=[2,3,1,0],Bp=(e,i,a)=>{let o=ju(a,i),c=a.format==="NHWC",s=o.outputShape,d=s[c?3:1],$=i[0].dims[c?3:1];if(o.group!==1||d===1&&$===1){e.compute(yo(i,o));return}let et=s[c?1:2],h=s[c?2:3],b=i[1].dims[2],g=i[1].dims[3],st=c?et*h:d,$t=c?d:et*h,vt=b*g*$,Ft=!0,Gt=e.kernelCustomData.wT??e.compute(xt(i[1],zp),{inputs:[1],outputs:[a.wIsConst?-2:-1]})[0];a.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=Gt);let qt=[i[0],Gt],Lt=i.length===3;Lt&&(!c&&i[2].dims.length===1?qt.push(i[2].reshape([i[2].dims[0],1,1])):qt.push(i[2])),e.compute(Lu(qt,o,s,st,$t,vt,Lt,Ft),{inputs:qt})},Dp=(e,i)=>{let a=i.format==="NHWC",o=[e.inputs[0].reshape(a?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&o.push(e.inputs[2]);let c=i.kernelShape;(c.length===0||c[0]===0)&&(c=[e.inputs[1].dims[2]]);let s=i.dilations;(s.length===0||s[0]===0)&&(s=[1]);let d=i.strides;(d.length===0||d[0]===0)&&(d=[1]);let $=i.pads;$.length===0&&($=[0,0]),$=[0,$[0],0,$[1]],d=[1].concat(d),s=[1].concat(s),c=[1].concat(c);let et=ju({...i,pads:$,strides:d,dilations:s,kernelShape:c},o);e.compute(yo(o,et,h=>a?[h[0],h[2],h[3]]:[h[0],h[1],h[3]]))},Yu=(e,i)=>{Rp(e.inputs,i),e.inputs[0].dims.length===3?Dp(e,i):Bp(e,e.inputs,i)}}),Mp,Zu,Qu,Ju=j(()=>{ye(),xe(),Ze(),_e(),Mp=(e,i,a,o)=>{let c=M.size(i),s=i.length,d=U("input",e,s),$=K("output",e,s),et=a.dataType===6?a.getInt32Array()[0]:Number(a.getBigInt64Array()[0]),h=M.normalizeAxis(et,s),b=g=>{let st=` i32(${d.indicesGet("inputIndices","uniforms.axis")}) `,$t=fe("uniforms.input_shape","uniforms.axis",s),vt=o.reverse?st+(o.exclusive?" + 1":""):"0",Ft=o.reverse?$t:st+(o.exclusive?"":" + 1");return`
                ${g.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(d,$)}
                ${g.mainStart()}
                  ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
                  var inputIndices = ${$.offsetToIndices("global_idx")};
                  var sum = ${$.type.value}(0);
                  let first : i32 = ${vt};
                  let last : i32 = ${Ft};
                  for (var i : i32 = first; i < last; i++) {
                    ${d.indicesSet("inputIndices","uniforms.axis","u32(i)")};
                    sum = sum + ${d.getByIndices("inputIndices")};
                  }
                  ${$.setByOffset("global_idx","sum")};
                }`};return{name:"CumSum",shaderCache:{hint:o.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:i,dataType:e}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:[{type:12,data:c},{type:12,data:h},...X(i,i)]}),getShaderSource:b}},Zu=(e,i)=>{let a=e.inputs[0].dims,o=e.inputs[0].dataType,c=e.inputs[1];e.compute(Mp(o,a,c,i),{inputs:[0]})},Qu=e=>{let i=e.exclusive===1,a=e.reverse===1;return we({exclusive:i,reverse:a})}}),Up,Wp,Np,el,tl,rl=j(()=>{ye(),xe(),Ze(),_e(),Up=e=>{if(!e||e.length!==1)throw new Error("DepthToSpace requires 1 input.");if(e[0].dims.length!==4)throw new Error("DepthToSpace requires 4D input.")},Wp=(e,i,a,o)=>{let c=[];c.push(`fn perm(i: ${o.type.indices}) -> ${a.type.indices} {
    var a: ${a.type.indices};`);for(let s=0;s<i;++s)c.push(a.indicesSet("a",e[s],`i[${s}]`));return c.push("return a;}"),c.join(`
`)},Np=(e,i)=>{let a,o,c,s,d,$,et=i.format==="NHWC",h=i.blocksize,b=i.mode==="DCR";et?([a,o,c,s]=e.dims,d=b?[a,o,c,h,h,s/h**2]:[a,o,c,s/h**2,h,h],$=b?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([a,o,c,s]=[e.dims[0],e.dims[2],e.dims[3],e.dims[1]],d=b?[a,h,h,s/h**2,o,c]:[a,s/h**2,h,h,o,c],$=b?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let g=e.reshape(d),st=g.dims.length,$t=e.dataType,vt=U("a",$t,st),Ft=K("output",$t,st),Gt=qt=>`
  ${qt.registerUniform("output_size","u32").declareVariables(vt,Ft)}

  ${Wp($,st,vt,Ft)}

  ${qt.mainStart()}
    ${qt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${Ft.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${Ft.setByOffset("global_idx",vt.getByIndices("aIndices"))}
  }`;return{name:"DepthToSpace",shaderCache:{hint:`${e.dims};${i.blocksize};${i.mode}`,inputDependencies:["rank"]},getRunData:qt=>{let Lt=et?[a,o*h,c*h,s/h**2]:[a,s/h**2,o*h,c*h],rr=M.size(Lt),jr=g.dims,Hr=M.sortBasedOnPerm(jr,$);return{outputs:[{dims:Lt,dataType:qt[0].dataType}],dispatchGroup:{x:Math.ceil(rr/64)},programUniforms:[{type:12,data:rr},...X(jr,Hr)]}},getShaderSource:Gt}},el=(e,i)=>{Up(e.inputs),e.compute(Np(e.inputs[0],i))},tl=e=>we({blocksize:e.blocksize,mode:e.mode,format:e.format})}),bo,ai,nl,Vp,Hp,vo,wo,il,Gp,ol,al,sl=j(()=>{ye(),xe(),Ze(),_e(),bo="[a-zA-Z]|\\.\\.\\.",ai="("+bo+")+",nl="^"+ai+"$",Vp="("+ai+",)*"+ai,Hp="^"+Vp+"$",vo=class{constructor(e=-1){this.symbolToIndices=new Map,this.inputIndex=e}addSymbol(e,i){let a=this.symbolToIndices.get(e);a===void 0?a=[i]:a.push(i),this.symbolToIndices.set(e,a)}},wo=class{constructor(e,i){var c;this.equation=i,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[a,o]=i.includes("->")?i.split("->",2):[i,""];if(!a.match(RegExp(Hp)))throw new Error("Invalid LHS term");if(a.split(",").forEach((s,d)=>{let $=e[d].dims.slice();if(!s.match(RegExp(nl)))throw new Error("Invalid LHS term");let et=this.processTerm(s,!0,$,d);this.lhs.push(et)}),o==="")o+=[...this.symbolToInfo.entries()].filter(([s,d])=>d.count===1||s==="...").map(([s])=>s).join("");else if(!o.match(RegExp(ai)))throw new Error("Invalid RHS");(c=o.match(RegExp(bo,"g")))==null||c.forEach(s=>{if(s==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let d=this.symbolToInfo.get(s);if(d===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(d.dimValue)}}),this.rhs=this.processTerm(o,!1,this.outputDims)}addSymbol(e,i,a){let o=this.symbolToInfo.get(e);if(o!==void 0){if(o.dimValue!==i&&o.count!==1)throw new Error("Dimension mismatch");o.count++,o.inputIndices.push(a)}else o={count:1,dimValue:i,inputIndices:[a]};this.symbolToInfo.set(e,o)}processTerm(e,i,a,o=-1){let c=a.length,s=!1,d=[],$=0;if(!e.match(RegExp(nl))&&!i&&e!=="")throw new Error("Invalid LHS term");let et=e.match(RegExp(bo,"g")),h=new vo(o);return et==null||et.forEach((b,g)=>{if(b==="..."){if(s)throw new Error("Only one ellipsis is allowed per input term");s=!0;let st=c-et.length+1;if(st<0)throw new Error("Ellipsis out of bounds");if(d=a.slice($,$+st),this.hasEllipsis){if(this.ellipsisDims.length!==d.length||this.ellipsisDims.toString()!==d.toString())throw new Error("Ellipsis dimensions mismatch")}else if(i)this.hasEllipsis=!0,this.ellipsisDims=d;else throw new Error("Ellipsis must be specified in the LHS");for(let $t=0;$t<d.length;$t++){let vt=String.fromCharCode("0".charCodeAt(0)+$t);h.addSymbol(vt,g+$t),this.addSymbol(vt,a[$++],o)}}else h.addSymbol(b,g+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(b,a[$++],o)}),h}},il=e=>e+"_max",Gp=(e,i,a,o)=>{let c=e.map(h=>h.length).map((h,b)=>U(`input${b}`,i,h)),s=M.size(o),d=K("output",i,o.length),$=[...a.symbolToInfo.keys()].filter(h=>!a.rhs.symbolToIndices.has(h)),et=h=>{let b=[],g="var prod = 1.0;",st="var sum = 0.0;",$t="sum += prod;",vt=[],Ft=[],Gt=[],qt=[],Lt=a.symbolToInfo.size===a.rhs.symbolToIndices.size;a.symbolToInfo.forEach((jr,Hr)=>{var wn;if(a.rhs.symbolToIndices.has(Hr)){let _n=(wn=a.rhs.symbolToIndices.get(Hr))==null?void 0:wn[0];_n!==void 0&&a.lhs.forEach((No,Qo)=>{if(jr.inputIndices.includes(Qo)){let Xo=No.symbolToIndices.get(Hr);if(Xo===void 0)throw new Error("Invalid symbol error");Xo.forEach(l0=>{b.push(`${c[Qo].indicesSet(`input${Qo}Indices`,l0,d.indicesGet("outputIndices",_n))}`)})}})}else a.lhs.forEach((_n,No)=>{if(jr.inputIndices.includes(No)){let Qo=_n.symbolToIndices.get(Hr);if(Qo===void 0)throw new Error("Invalid symbol error");Qo.forEach(Xo=>{vt.push(`${c[No].indicesSet(`input${No}Indices`,Xo,`${Hr}`)}`)}),qt.push(`prod *= ${c[No].getByIndices(`input${No}Indices`)};`)}}),Ft.push(`for(var ${Hr}: u32 = 0; ${Hr} < uniforms.${il(Hr)}; ${Hr}++) {`),Gt.push("}")});let rr=Lt?[...b,`let sum = ${c.map((jr,Hr)=>jr.getByIndices(`input${Hr}Indices`)).join(" * ")};`]:[...b,st,...Ft,...vt,g,...qt,$t,...Gt];return`
            ${h.registerUniforms($.map(jr=>({name:`${il(jr)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...c,d)}

            ${h.mainStart()}
            ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
            var outputIndices = ${d.offsetToIndices("global_idx")};
            ${c.map((jr,Hr)=>`var input${Hr}Indices: ${c[Hr].type.indices};`).join(`
`)}
            ${rr.join(`
`)};
            ${d.setByOffset("global_idx","sum")};
          }`};return{name:"Einsum",shaderCache:{hint:a.equation,inputDependencies:e.map(()=>"rank")},getRunData:()=>{let h=$.filter(g=>a.symbolToInfo.has(g)).map(g=>{var st;return{type:12,data:((st=a.symbolToInfo.get(g))==null?void 0:st.dimValue)||0}});h.push({type:12,data:s});let b=e.map((g,st)=>[...X(g)]).reduce((g,st)=>g.concat(st),h);return b.push(...X(o)),{outputs:[{dims:o,dataType:i}],dispatchGroup:{x:Math.ceil(s/64)},programUniforms:b}},getShaderSource:et}},ol=(e,i)=>{let a=new wo(e.inputs,i.equation),o=a.outputDims,c=e.inputs.map((s,d)=>s.dims);e.compute(Gp(c,e.inputs[0].dataType,a,o))},al=e=>{let i=e.equation.replace(/\s+/g,"");return we({equation:i})}}),Lp,ul,Fp,qp,ll,dl=j(()=>{ye(),xe(),_e(),Lp=e=>{if(!e||e.length!==2)throw new Error("Expand requires 2 input.");let i=e[0].dims,a=Array.from(e[1].getBigInt64Array(),Number),o=a.length<i.length?0:a.length-i.length,c=i.length<a.length?0:i.length-a.length;for(;o<a.length&&c<i.length;++o,++c)if(a[o]!==i[c]&&a[o]!==1&&i[c]!==1)throw new Error("Expand requires shape to be broadcastable to input")},ul=(e,i)=>{let a=e.length-i.length,o=[];for(let c=0;c<a;++c)o.push(e[c]);for(let c=0;c<i.length;++c)o.push(i[c]===1?e[c+a]:i[c]);return o},Fp=(e,i)=>e.length>i.length?ul(e,i):ul(i,e),qp=e=>{let i=e[0].dims,a=Array.from(e[1].getBigInt64Array(),Number),o=Fp(i,a),c=e[0].dataType,s=c===9?4:1,d=Math.ceil(M.size(o)/s),$=h=>{let b=U("input",c,i.length,s),g=K("output",c,o.length,s),st;if(c===9){let $t=(vt,Ft,Gt="")=>`
          let outputIndices${Ft} = ${g.offsetToIndices(`outputOffset + ${Ft}u`)};
          let offset${Ft} = ${b.broadcastedIndicesToOffset(`outputIndices${Ft}`,g)};
          let index${Ft} = offset${Ft} / 4u;
          let component${Ft} = offset${Ft} % 4u;
          ${vt}[${Ft}] = ${Gt}(${b.getByOffset(`index${Ft}`)}[component${Ft}]);
        `;st=`
        let outputOffset = global_idx * ${s};
        var data = vec4<u32>(0);
        ${$t("data",0,"u32")}
        ${$t("data",1,"u32")}
        ${$t("data",2,"u32")}
        ${$t("data",3,"u32")}
        ${g.setByOffset("global_idx","data")}
      }`}else st=`
        let outputIndices = ${g.offsetToIndices("global_idx")};
        let inputOffset = ${b.broadcastedIndicesToOffset("outputIndices",g)};
        ${g.setByOffset("global_idx",b.getByOffset("inputOffset"))}
      }`;return`
    ${h.registerUniform("vec_size","u32").declareVariables(b,g)}
    ${h.mainStart()}
    ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
    ${st}`},et=[{type:12,data:d},...X(i,o)];return{name:"Expand",shaderCache:{hint:`${o.length}`,inputDependencies:["rank"]},getShaderSource:$,getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:et})}},ll=e=>{Lp(e.inputs),e.compute(qp(e.inputs),{inputs:[0]})}}),jp,cl,pl=j(()=>{ye(),xe(),_e(),Jn(),jp=e=>{let i=e[0].dataType,a=M.size(e[0].dims),o=M.size(e[1].dims),c=o%4===0,s=d=>{let $=U("x",i,[1],4),et=U("bias",i,[1],4),h=K("y",i,[1],4),b=[{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}],g=$t=>`
      let bias${$t}_offset: u32 = (global_idx * 4 + ${$t}) % uniforms.bias_size;
      let bias${$t} = ${et.getByOffset(`bias${$t}_offset / 4`)}[bias${$t}_offset % 4];`,st=c?`
      let bias = ${et.getByOffset("global_idx % (uniforms.bias_size / 4)")};`:`${g(0)}${g(1)}${g(2)}${g(3)}
      let bias = ${$.type.value}(bias0, bias1, bias2, bias3);`;return`${d.registerUniforms(b).declareVariables($,et,h)}

    ${ao(rt(i))}

    ${d.mainStart(mr)}
      ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size")}

      let x = ${$.getByOffset("global_idx")};
      ${st}
      let x_in = x + bias;
      ${h.setByOffset("global_idx",so("x_in"))}
    }`};return{name:"FastGeluWithBias",shaderCache:{hint:`${c}`,inputDependencies:["type","type"]},getShaderSource:s,getRunData:d=>({outputs:[{dims:d[0].dims,dataType:d[0].dataType}],programUniforms:[{type:12,data:Math.ceil(a/4)},{type:12,data:o}],dispatchGroup:{x:Math.ceil(a/mr/4)}})}},cl=e=>{e.inputs.length<2||M.size(e.inputs[1].dims)===0?wu(e):e.compute(jp(e.inputs))}}),Kp,Yp,ml,fl,hl=j(()=>{ye(),xe(),Ze(),_e(),Kp=e=>{if(!e||e.length!==2)throw new Error("Gather requires 2 inputs.")},Yp=(e,i)=>{let a=e[0].dims,o=e[1].dims,c=a.length,s=M.normalizeAxis(i.axis,c),d=a.slice(0);d.splice(s,1,...o);let $=a[s],et=e[0].dataType===9?4:1,h=Math.ceil(M.size(d)/et),b=[{type:12,data:h},{type:6,data:$},{type:12,data:s},...X(e[0].dims,e[1].dims,d)],g=st=>{let $t=U("data",e[0].dataType,e[0].dims.length,et),vt=U("inputIndices",e[1].dataType,e[1].dims.length),Ft=K("output",e[0].dataType,d.length,et),Gt=Lt=>{let rr=o.length,jr=`var indicesIndices${Lt}  = ${vt.type.indices}(0);`;for(let Hr=0;Hr<rr;Hr++)jr+=`${rr>1?`indicesIndices${Lt}[${Hr}]`:`indicesIndices${Lt}`} = ${d.length>1?`outputIndices${Lt}[uniforms.axis + ${Hr}]`:`outputIndices${Lt}`};`;jr+=`
          var idx${Lt} = ${vt.getByIndices(`indicesIndices${Lt}`)};
          if (idx${Lt} < 0) {
            idx${Lt} = idx${Lt} + uniforms.axisDimLimit;
          }
          var dataIndices${Lt} : ${$t.type.indices};
        `;for(let Hr=0,wn=0;Hr<c;Hr++)Hr===s?(jr+=`${c>1?`dataIndices${Lt}[${Hr}]`:`dataIndices${Lt}`} = u32(idx${Lt});`,wn+=rr):(jr+=`${c>1?`dataIndices${Lt}[${Hr}]`:`dataIndices${Lt}`} = ${d.length>1?`outputIndices${Lt}[${wn}]`:`outputIndices${Lt}`};`,wn++);return jr},qt;if(e[0].dataType===9){let Lt=(rr,jr,Hr="")=>`
          let outputIndices${jr} = ${Ft.offsetToIndices(`outputOffset + ${jr}u`)};
          ${Gt(jr)};
          let offset${jr} = ${$t.indicesToOffset(`dataIndices${jr}`)};
          let index${jr} = offset${jr} / 4u;
          let component${jr} = offset${jr} % 4u;
          ${rr}[${jr}] = ${Hr}(${$t.getByOffset(`index${jr}`)}[component${jr}]);
        `;qt=`
        let outputOffset = global_idx * ${et};
        var value = vec4<u32>(0);
        ${Lt("value",0,"u32")}
        ${Lt("value",1,"u32")}
        ${Lt("value",2,"u32")}
        ${Lt("value",3,"u32")}
        ${Ft.setByOffset("global_idx","value")}
      `}else qt=`
      let outputIndices = ${Ft.offsetToIndices("global_idx")};
      ${Gt("")};
      let value = ${$t.getByIndices("dataIndices")};
      ${Ft.setByOffset("global_idx","value")};
      `;return`
      ${st.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables($t,vt,Ft)}
      ${st.mainStart()}
        ${st.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        ${qt}
      }`};return{name:"Gather",shaderCache:{hint:i.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:d,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:b}),getShaderSource:g}},ml=e=>we({axis:e.axis}),fl=(e,i)=>{let a=e.inputs;Kp(a),e.compute(Yp(e.inputs,i))}}),Xp,Zp,gl,yl,bl=j(()=>{ye(),xe(),Ze(),_e(),Xp=e=>{if(!e||e.length!==2)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error(`GatherElements requires that the data input and
                     indices input tensors be of same rank.`)},Zp=(e,i)=>{let a=e[0].dims,o=e[0].dataType,c=a.length,s=e[1].dims,d=e[1].dataType,$=M.normalizeAxis(i.axis,c),et=a[$],h=s.slice(0),b=M.size(h),g=U("input",o,c),st=U("indicesInput",d,s.length),$t=K("output",o,h.length),vt=[{type:12,data:b},{type:6,data:et},{type:12,data:$}];return vt.push(...X(a,s,h)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:h,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(b/64)},programUniforms:vt}),getShaderSource:Ft=>`
      ${Ft.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(g,st,$t)}
      ${Ft.mainStart()}
      ${Ft.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

      let outputIndices = ${$t.offsetToIndices("global_idx")};

      var idx = ${st.getByOffset("global_idx")};
      if (idx < 0) {
        idx = idx + uniforms.axisDimLimit;
      }
      var inputIndices = ${g.type.indices}(outputIndices);
      ${g.indicesSet("inputIndices","uniforms.axis","u32(idx)")};
      let value = ${g.getByIndices("inputIndices")};

      ${$t.setByOffset("global_idx","value")};
  }`}},gl=e=>we({axis:e.axis}),yl=(e,i)=>{let a=e.inputs;Xp(a),e.compute(Zp(e.inputs,i))}}),Qp,Jp,vl,wl,$l=j(()=>{ye(),xe(),_e(),Qp=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(e.length===3&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},Jp=(e,i)=>{let a=e[0].dims.slice(),o=e[1].dims.slice(),[c,s,d]=Gn.getShapeOfGemmResult(a,i.transA,o,i.transB,e.length===3?e[2].dims:void 0),$=[c,s];if(!$)throw new Error("Can't use gemm on the given tensors");let et=M.size($),h=[{type:12,data:et},{type:12,data:c},{type:12,data:s},{type:12,data:d},{type:1,data:i.alpha},{type:1,data:i.beta}],b=["type","type"];e.length===3&&(h.push(...X(e[2].dims)),b.push("rank")),h.push(...X($));let g=st=>{let $t="";i.transA&&i.transB?$t="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":i.transA&&!i.transB?$t="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!i.transA&&i.transB?$t="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!i.transA&&!i.transB&&($t="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let vt=i.alpha===1?"":"value *= uniforms.alpha;",Ft=U("a",e[0].dataType,e[0].dims),Gt=U("b",e[1].dataType,e[1].dims),qt=Ft.type.value,Lt=null,rr=[Ft,Gt];e.length===3&&(Lt=U("c",e[2].dataType,e[2].dims.length),rr.push(Lt));let jr=K("output",e[0].dataType,$.length);rr.push(jr);let Hr=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`
  ${st.registerUniforms(Hr).declareVariables(...rr)}

  ${st.mainStart()}
    ${st.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let m = global_idx / uniforms.N;
    let n = global_idx % uniforms.N;

    var value = ${qt}(0);
    for (var k: u32 = 0u; k < uniforms.K; k++) {
      ${$t}
    }

    ${vt}
    ${(()=>Lt!=null?`let cOffset = ${Lt.broadcastedIndicesToOffset("vec2(m, n)",jr)}; value += ${qt}(uniforms.beta) * ${Lt.getByOffset("cOffset")};`:"")()}
    output[global_idx] = value;
  }`};return{name:"Gemm",shaderCache:{hint:`${i.cacheKey}`,inputDependencies:b},getRunData:()=>({outputs:[{dims:$,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(et/64)},programUniforms:h}),getShaderSource:g}},vl=e=>{let i=e.transA,a=e.transB,o=e.alpha,c=e.beta;return{transA:i,transB:a,alpha:o,beta:c,cacheKey:`${e.transA};${e.transB};${e.alpha===1}`}},wl=(e,i)=>{Qp(e.inputs),e.compute(Jp(e.inputs,i))}}),em,tm,rm,_l,xl=j(()=>{ye(),xe(),_e(),em=(e,i)=>{let a=e[0].dims,o=a,c=2,s=M.sizeToDimension(a,c),d=M.sizeFromDimension(a,c),$=Ue(d),et=d/$,h=[a[0],a[1],et],b=["rank","type","type"],g=[{type:12,data:d},{type:12,data:et}];g.push(...X(h,h));let st=$t=>{let vt=U("x",e[0].dataType,h.length,$),Ft=U("scale",e[1].dataType,e[1].dims),Gt=U("bias",e[2].dataType,e[2].dims),qt=K("output",e[0].dataType,h.length,$),Lt=[vt,Ft,Gt,qt],rr=vt.type.value,jr=$===1?"f32":`vec${$}<f32>`,Hr=64,wn=[{name:"normSize",type:"u32"},{name:"normPackedSize",type:"u32"}];return`
  var<workgroup> meanShared : f32;
  var<workgroup> squaredNormShared : f32;
  var<workgroup> workgroupShared : array<${jr}, ${Hr}>;
  const workgroupSize = ${Hr}u;
  ${$t.registerUniforms(wn).declareVariables(...Lt)}
  ${$t.mainStart(Hr)}
    let norm = global_idx / workgroupSize;
    let batch = norm / uniforms.x_shape[1];
    let channel = norm % uniforms.x_shape[1];
    let localIndex = local_id.x;

    // initialize workgroup memory
    var initial = ${jr}(0);
    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {
      initial = initial + ${jr}(${vt.get("batch","channel","h")});
    }
    workgroupShared[localIndex] = initial;
    workgroupBarrier();

    // Calculate the mean of current channel data.
    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {
      if (localIndex < currSize) {
        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];
      }
      workgroupBarrier();
    }
    if (localIndex == 0) {
      meanShared = ${Et("workgroupShared[0]",$)} / f32(uniforms.normSize);
    }
    workgroupBarrier();

    // reinitialize workgroup memory.
    initial = ${jr}(0);
    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {
      let deviation =  ${jr}(${vt.get("batch","channel","h")}) - ${jr}(meanShared);
      initial = initial + deviation * deviation;
    }
    workgroupShared[localIndex] = initial;
    workgroupBarrier();

    // Calculate the sum of square of deviation of current channel data.
    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {
      if (localIndex < currSize) {
        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];
      }
      workgroupBarrier();
    }
    if (localIndex == 0) {
      squaredNormShared = ${Et("workgroupShared[0]",$)};
    }
    workgroupBarrier();

    let invStdDev = inverseSqrt(squaredNormShared / f32(uniforms.normSize) + f32(${i.epsilon}));
    let channelScale = invStdDev * f32(${Ft.getByOffset("channel")});
    let channelShift = f32(${Gt.getByOffset("channel")}) - meanShared * channelScale;
    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {
      let value = ${vt.get("batch","channel","h")} * ${rr}(${jr}(channelScale)) + ${rr}(${jr}(channelShift));
      ${qt.set("batch","channel","h","value")};
    }
  }`};return{name:"InstanceNormalization",shaderCache:{hint:`${i.epsilon};${$}`,inputDependencies:b},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:s},programUniforms:g}),getShaderSource:st}},tm=(e,i,a,o,c,s,d,$)=>{let et=Ue(d),h=64,b=et===1?"vec2f":`mat2x${et}f`,g=et===1?"f32":`vec${et}f`,st=(wn,_n)=>`${b}(${wn}, ${_n})`,$t=c*d/et,vt=Math.ceil(s/h),Ft=["type"],Gt=[{type:12,data:vt},{type:12,data:s},{type:12,data:Math.floor(d/et)},{type:12,data:Math.floor(s*d/et)}],qt=wn=>{let _n=U("input",i.dataType,i.dims,et);return`
  ${wn.declareVariables(_n)}
  @group(0) @binding(1) var<storage, read_write> output : array<${b}>;
  struct Uniforms {wg_size:u32, H:u32, C:u32, image_size:u32};
  @group(0) @binding(2) var<uniform> uniforms: Uniforms;

  ${wn.mainStart(h)}
    let currentImageNumber = global_idx / ${h} / uniforms.C;
    let currentChannelNumber = (global_idx / ${h}) % uniforms.C;
    let wgOffset = local_id.x * uniforms.wg_size;
    if (wgOffset >= uniforms.H) {
        return;
    }
    let wgMax = min(wgOffset + uniforms.wg_size, uniforms.H);

    let offset = currentImageNumber * uniforms.image_size + currentChannelNumber;
    var sum = ${At("f32",et)};
    var squaredSum = ${At("f32",et)};
    for (var i: u32 = wgOffset; i < wgMax; i++) {
        let value = ${g}(input[offset + i * uniforms.C]);
        sum += value;
        squaredSum += value * value;
    }
    output[global_idx] = ${st("sum","squaredSum")};
  }`},Lt=e.compute({name:"InstanceNormComputeMean",shaderCache:{hint:`${et}`,inputDependencies:Ft},getRunData:()=>({outputs:[{dims:[c,d,h,2],dataType:1}],dispatchGroup:{x:c*d/et},programUniforms:Gt}),getShaderSource:qt},{inputs:[i],outputs:[-1]})[0],rr=[{type:12,data:$t},{type:12,data:s},{type:12,data:Math.floor(d/et)},{type:12,data:Math.floor(h*d/et)}],jr=["type","type","type"],Hr=wn=>{let _n=U("scale",a.dataType,a.dims,et),No=U("bias",o.dataType,o.dims,et);return`
  @group(0) @binding(0) var<storage, read> input : array<${b}>;
  @group(0) @binding(1) var<storage, read> scale : array<${_n.type.storage}>;
  @group(0) @binding(2) var<storage, read> bias : array<${No.type.storage}>;
  @group(0) @binding(3) var<storage, read_write> output : array<${b}>;
  struct Uniforms {units_of_work : u32, H: u32, C : u32, image_size : u32};
  @group(0) @binding(4) var<uniform> uniforms: Uniforms;

  ${wn.mainStart()}
    ${wn.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.units_of_work")}
    let currentImageNumber = global_idx / uniforms.C;
    let currentChannelNumber = global_idx % uniforms.C;

    let offset = currentImageNumber * uniforms.image_size;
    var sum = ${At("f32",et)};
    var squaredSum = ${At("f32",et)};
    for (var i: u32 = 0; i < min(${h}, uniforms.H); i++) {
        let value = input[offset + i + currentChannelNumber * ${h}];
        sum += value[0];
        squaredSum += value[1];
    }
    sum = sum / f32(uniforms.H);
    squaredSum = squaredSum / f32(uniforms.H);
    let invStdDev = inverseSqrt(squaredSum - sum * sum + f32(${$}));
    let channelScale = invStdDev * ${g}(scale[currentChannelNumber]);
    let channelShift = ${g}(bias[currentChannelNumber]) - sum * channelScale;

    output[global_idx] = ${st("channelScale","channelShift")};
  }`};return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${et};${$}`,inputDependencies:jr},getRunData:()=>({outputs:[{dims:[c,d,2],dataType:1}],dispatchGroup:{x:Math.ceil($t/64)},programUniforms:rr}),getShaderSource:Hr},{inputs:[Lt,a,o],outputs:[-1]})[0]},rm=(e,i,a)=>{let o=i[0].dims,c=o,s=o[0],d=o[o.length-1],$=M.sizeFromDimension(o,1)/d,et=Ue(d),h=M.size(c)/et,b=[{type:12,data:$},{type:12,data:Math.floor(d/et)}],g=["type","type"],st=tm(e,i[0],i[1],i[2],s,$,d,a.epsilon),$t=vt=>{let Ft=De(i[0].dataType),Gt=et===1?"vec2f":`mat2x${et}f`,qt=et===1?Ft:`vec${et}<${Ft}>`,Lt=U("input",i[0].dataType,i[0].dims,et),rr=K("output",i[0].dataType,c,et);return`
  @group(0) @binding(0) var<storage, read> input : array<${Lt.type.storage}>;
  @group(0) @binding(1) var<storage, read> scaleInput : array<${Gt}>;
  @group(0) @binding(2) var<storage, read_write> output : array<${rr.type.storage}>;
  struct Uniforms {H: u32, C : u32};
  @group(0) @binding(3) var<uniform> uniforms: Uniforms;

  ${vt.mainStart()}
    let currentImageNumber = global_idx / (uniforms.C * uniforms.H);
    let currentChannelNumber = global_idx % uniforms.C;

    let scaleOffset = currentImageNumber * uniforms.C + currentChannelNumber;
    let scale = scaleInput[scaleOffset];
    output[global_idx] = fma(input[global_idx], ${qt}(scale[0]), ${qt}(scale[1]));
  }`};e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${et}`,inputDependencies:g},getRunData:()=>({outputs:[{dims:c,dataType:i[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:b}),getShaderSource:$t},{inputs:[i[0],st]})},_l=(e,i)=>{i.format==="NHWC"?rm(e,e.inputs,i):e.compute(em(e.inputs,i))}}),nm,im,Sl,Cl=j(()=>{ye(),xe(),_e(),nm=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},im=(e,i,a)=>{let o=i.simplified,c=e[0].dims,s=e[1],d=!o&&e[2],$=c,et=M.normalizeAxis(i.axis,c.length),h=M.sizeToDimension(c,et),b=M.sizeFromDimension(c,et),g=M.size(s.dims),st=d?M.size(d.dims):0;if(g!==b||d&&st!==b)throw new Error(`Size of X.shape()[axis:] == ${b}.
       Size of scale and bias (if provided) must match this.
       Got scale size of ${g} and bias size of ${st}`);let $t=[];for(let Hr=0;Hr<c.length;++Hr)Hr<et?$t.push(c[Hr]):$t.push(1);let vt=Ue(b),Ft=["type","type"],Gt=[{type:12,data:h},{type:1,data:b},{type:12,data:Math.floor(b/vt)},{type:1,data:i.epsilon}];d&&Ft.push("type");let qt=a>1,Lt=a>2,rr=Hr=>{let wn=De(e[0].dataType),_n=[U("x",e[0].dataType,e[0].dims,vt),U("scale",s.dataType,s.dims,vt)];d&&_n.push(U("bias",d.dataType,d.dims,vt)),_n.push(K("output",e[0].dataType,$,vt)),qt&&_n.push(K("mean_data_output",1,$t)),Lt&&_n.push(K("inv_std_output",1,$t));let No=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`
  ${Hr.registerUniforms(No).declareVariables(..._n)}
  ${Hr.mainStart()}
    ${Hr.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}
    let offset = global_idx * uniforms.norm_size_vectorized;
    var mean_vector = ${At("f32",vt)};
    var mean_square_vector = ${At("f32",vt)};

    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {
      let value = ${fr(wn,vt,"x[h + offset]")};
      mean_vector += value;
      mean_square_vector += value * value;
    }
    let mean = ${Et("mean_vector",vt)} / uniforms.norm_size;
    let inv_std_dev = inverseSqrt(${Et("mean_square_vector",vt)} / uniforms.norm_size ${o?"":"- mean * mean"} + uniforms.epsilon);

    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {
      let f32input = ${fr(wn,vt,"x[j + offset]")};
      let f32scale = ${fr(wn,vt,"scale[j]")};
      output[j + offset] = ${_n[0].type.value}((f32input ${o?"":"- mean"}) * inv_std_dev * f32scale
        ${d?`+ ${fr(wn,vt,"bias[j]")}`:""}
      );
    }

    ${qt?"mean_data_output[global_idx] = mean":""};
    ${Lt?"inv_std_output[global_idx] = inv_std_dev":""};
  }`},jr=[{dims:$,dataType:e[0].dataType}];return qt&&jr.push({dims:$t,dataType:1}),Lt&&jr.push({dims:$t,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${vt};${a};${o}`,inputDependencies:Ft},getRunData:()=>({outputs:jr,dispatchGroup:{x:Math.ceil(h/64)},programUniforms:Gt}),getShaderSource:rr}},Sl=(e,i)=>{nm(e.inputs),e.compute(im(e.inputs,i,e.outputCount))}}),om,am,Il,Tl,Al=j(()=>{ye(),xe(),Ze(),_e(),om=(e,i)=>{if(e.length<3||e.length>4)throw new Error("MatMulNBits requires 3 or 4 inputs");let a=e[0],o=a.dims.length;if(a.dims[o-1]!==i.k)throw new Error("The last dim of input shape does not match the k value");let c=Math.floor((i.k+i.blockSize-1)/i.blockSize),s=i.blockSize/8*i.bits,d=e[1];if(!M.areEqual(d.dims,[i.n,c,s]))throw new Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let $=e[2].dims;if(M.size($)!==i.n*c)throw new Error("scales input size error.");if(e.length===4){let et=e[3].dims,h=i.bits>4?i.n*c:i.n*Math.floor((c+1)/2);if(M.size(et)!==h)throw new Error("zeroPoints input size error.")}},am=(e,i,a,o)=>{let c=e[0].dims,s=c.length,d=Math.floor((i.k+i.blockSize-1)/i.blockSize),$=c[s-2],et=i.k,h=i.n,b=c.slice(0,s-2),g=M.size(b),st=i.blockSize/8*i.bits/4,$t=e[0].dataType,vt=Ue($),Ft=Ue(i.k),Gt=Ue(st),qt=cr($t),Lt=$*d*qt,rr=Math.floor(o/Lt),jr=d<=a[0]&&rr>0,Hr=!jr||rr>=4?Ue(h):rr>=2&&Ue(h)>=2?2:1,wn=b.concat([$,h]),_n=M.size(wn)/Hr/vt,No=jr?[]:[{type:12,data:_n},{type:12,data:i.blockSize}],Qo=[g,$,et/Ft],Xo=M.convertShape(e[1].dims).slice();Xo.splice(-1,1,st/Gt),No.push(...X(Qo)),No.push(...X(Xo)),No.push(...X(e[2].dims)),e.length===4&&No.push(...X(M.convertShape(e[3].dims)));let l0=[g,$,h/Hr];No.push(...X(l0));let v0=x0=>{let D0=Qo.length,M0=U("a",e[0].dataType,D0,Ft),Mo=U("b",12,Xo.length,Gt),e0=U("scales",e[2].dataType,e[2].dims.length),Sn=[M0,Mo,e0],t0=e.length===4?U("zero_points",12,e[3].dims.length):void 0;t0&&Sn.push(t0);let d0=l0.length,xn=K("output",e[0].dataType,d0,Hr),f0=[{name:"output_size",type:"u32"},{name:"block_size",type:"u32"}],$0=De(e[0].dataType),N0=(()=>{switch(Ft){case 1:return`array<${$0}, 8>`;case 2:return`mat4x2<${$0}>`;case 4:return`mat2x4<${$0}>`;default:throw new Error(`${Ft}-component is not supported.`)}})(),j0=`
        for (var word: u32 = 0; word < ${st}; word += ${Gt}) {
          ${Mo.indicesSet("b_indices","2","word")};
          let b_data = ${Mo.getByIndices("b_indices")};
          for (var i: u32 = 0; i < ${Gt}; i++) {
            let b_value: u32 = ${Gt===1?"b_data":"b_data[word + i]"};
            let b_mask: u32 = 0x0F0F0F0Fu;
            let b_value_lower: vec4<u32> = unpack4xU8(b_value & b_mask);
            let b_value_upper: vec4<u32> = unpack4xU8((b_value >> 4) & b_mask);
            let b_quantized_values = ${N0}(${Array.from({length:4},(fy,oy)=>`${$0}(b_value_lower[${oy}]), ${$0}(b_value_upper[${oy}])`).join(", ")});
            let b_dequantized_values = ${(()=>Ft===1?`${N0}(${Array.from({length:8},(fy,oy)=>`(b_quantized_values[${oy}] - zero_point) * scale`).join(", ")});`:`(b_quantized_values - ${N0}(${Array(8).fill("zero_point").join(",")})) * scale;`)()};
            // Number of B elements per 32-bit word is 32/bits = 32/4 = 8
            for (var m: u32 = 0; m < ${jr?$:vt}u; m++) {
              ${M0.indicesSet("a_indices",D0-2,jr?"m":`row * ${vt} + m`)};
              ${M0.indicesSet("a_indices",D0-1,"word_offset")};
              var input_offset = ${M0.indicesToOffset("a_indices")};
              var a_data: ${N0};
              for (var j: u32 = 0; j < ${8/Ft}; j++) {
                a_data[j] = ${M0.getByOffset("input_offset")};
                input_offset++;
              }
              ${jr?"workgroup_shared[workgroup_shared_offset + m]":"output_values[m]"}${Hr>1?"[c]":""} += ${Array.from({length:8/Ft},(fy,oy)=>`${Ft===1?`a_data[${oy}] * b_dequantized_values[${oy}]`:`dot(a_data[${oy}], b_dequantized_values[${oy}])`}`).join(" + ")};
            }
            word_offset += ${8/Ft};
          }
        }`,Z0=t0?`
          zero_point_offset += 4;
          if (zero_point_offset == 32) {
            zero_point_offset = 0;
            zero_point_index++;
            zero_point_word = ${t0.getByOffset("zero_point_index")};
          }`:"";return jr?`
        var<workgroup> workgroup_shared: array<${xn.type.value}, ${$*d}>;
        ${x0.declareVariables(...Sn,xn)}
        ${x0.mainStart([d,1,1])}
          var a_indices: ${M0.type.indices};
          var block = local_id.x;
          var col = workgroup_id.y;
          var batch = workgroup_id.z;
          ${M0.indicesSet("a_indices","0","batch")};
          // Two zero points are packed into one byte when uniforms.bits is 4.
          for (var c: u32 = 0; c < ${Hr}; c++) {
            let col_times_components_plus_c = col * ${Hr} + c;
              ${t0?`
            var zero_point_bytes_per_col: u32 = (${d} + 1) / 2;
            var zero_point_byte_count: u32 = col_times_components_plus_c * zero_point_bytes_per_col + (block >> 0x1u);
            var zero_point_word_index: u32 = zero_point_byte_count >> 0x2u;
            var zero_point_byte_offset: u32 = zero_point_byte_count & 0x3u;
            var zero_point_nibble_offset: u32 = block & 0x1u;
            var zero_point_bits_offset: u32 = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            var zero_point_word: u32 = ${t0.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;`:""}
            var b_indices: ${Mo.type.indices};
            ${Mo.indicesSet("b_indices","0","col_times_components_plus_c")};
            // The scale and zero points are computed per block.
            var scales_index = col_times_components_plus_c * ${d} + block;
            let scale = ${e0.getByOffset("scales_index")};
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${$0}(${t0?"(zero_point_word) & 0xFu":8});
            ${Mo.indicesSet("b_indices","1","block")};
            var word_offset: u32 = block * ${i.blockSize/Ft};
            var workgroup_shared_offset: u32 = block * ${$};
            ${j0}
          }
          workgroupBarrier();
          if (local_id.x == 0u) {
            var output_indices: ${xn.type.indices};
            ${xn.indicesSet("output_indices","0","batch")};
            ${xn.indicesSet("output_indices",d0-1,"col")};
            ${xn.indicesSet("output_indices",d0-2,"0")};
            var output_offset = ${xn.indicesToOffset("output_indices")};
            for (var m: u32 = 0u; m < ${$}u; m++) {
              var output_value: ${xn.type.value} = ${xn.type.value}(0);
              var workgroup_shared_offset: u32 = m;
              for (var b: u32 = 0u; b < ${d}u; b++) {
                output_value += workgroup_shared[workgroup_shared_offset];
                workgroup_shared_offset += ${$};
              }
              ${xn.setByOffset("output_offset","output_value")};
              output_offset += ${h/Hr};
            }
          }
        }`:`
        ${x0.registerUniforms(f0).declareVariables(...Sn,xn)}
        ${x0.mainStart()}
          ${x0.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          var output_values: array<${xn.type.value}, ${vt}>;
          var output_indices = ${xn.offsetToIndices("global_idx")};
          var col = ${xn.indicesGet("output_indices",d0-1)};
          var row = ${xn.indicesGet("output_indices",d0-2)};
          var a_indices: ${M0.type.indices} = output_indices;
          // Two zero points are packed into one byte because uniforms.bits <= 4.
          // zero_point_offset is either 0 or 4. It is bit offset within one byte.
          // TODO support zero_point_offset for bits > 4
          ${t0?`
          var zero_point_abs_offset = col * ${Hr} * ((${d} + 1) / 2);
          var zero_point_index: u32 = zero_point_abs_offset / 4;
          var zero_point_word: u32 = ${t0.getByOffset("zero_point_index")};
          var zero_point_offset: u32 = (zero_point_abs_offset % 4) * 8;`:""}
          var scale_index = col * ${d*Hr};
          var b_indices: ${Mo.type.indices};
          for (var c: u32 = 0; c < ${Hr}; c++) {
            ${Mo.indicesSet("b_indices","0",`col * ${Hr} + c`)};
            var block_offset: u32 = 0;
            for (var block: u32 = 0; block < ${d}; block++) {
              // The scale and zero points are computed per block.
              let scale = ${e0.getByOffset("scale_index")};
              // The default zero point is 8 for unsigned 4-bit quantization.
              let zero_point = ${$0}(${t0?"extractBits(zero_point_word, zero_point_offset, 4)":8});
              ${Mo.indicesSet("b_indices","1","block")};
              var word_offset: u32 = block_offset;
              ${j0}
              scale_index++;
              ${Z0}
              block_offset += uniforms.block_size / ${Ft};
            }
            // Drop the trailing 4 bits if the zero_poit_offset is not a byte boundary to align with the next byte.
            ${t0?`if (zero_point_offset % 8 > 0) {
                ${Z0}
              }`:""}
            }
            for (var k: u32 = 0u; k < ${vt}u; k++) {
              ${xn.indicesSet("output_indices",d0-2,`${vt} * row + k`)};
              ${xn.setByIndices("output_indices","output_values[k]")}
            }
        }`};return{name:jr?"BlockwiseMatMulNBits":"MatMulNBits",shaderCache:{hint:`${i.cacheKey};${$};${$t};${e.length}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:wn,dataType:$t}],name:jr?"BlockwiseMatMulNBits":"MatMulNBits",dispatchGroup:jr?{x:1,y:Math.ceil(h/Hr),z:g}:{x:Math.ceil(_n/64)},programUniforms:No}),getShaderSource:v0}},Il=(e,i)=>{om(e.inputs,i);let a=e.getMaxComputeWorkgroupSizes(),o=e.getMaxComputeWorkgroupStoragesize();e.compute(am(e.inputs,i,a,o))},Tl=e=>we(e)}),lt,sm,kl,El,um,$o,Ol,Pl=j(()=>{ye(),xe(),Ze(),Hn(),oo(),_e(),Rr(),lt=(e,i)=>e.length>i&&e[i].dims.length>0&&M.size(e[i].dims)>0?e[i]:void 0,sm=(e,i)=>{let a=e[0],o=lt(e,1),c=lt(e,2),s=lt(e,3),d=lt(e,4),$=lt(e,5),et=lt(e,6),h=lt(e,7);if(a.dims.length!==3&&a.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let b=!1,g=a.dims[0],st=a.dims[1],$t=a.dims.length===3?b?a.dims[2]/3:a.dims[2]:i.numHeads*a.dims[4],vt=st,Ft=0,Gt=0,qt=Math.floor($t/i.numHeads);if(et&&h){if(et.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(et.dims[0]!==g||et.dims[1]!==i.numHeads||et.dims[3]!==qt)throw new Error('Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)');if(h.dims[0]!==g||h.dims[1]!==i.numHeads||h.dims[3]!==qt)throw new Error('Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)');if(et.dims[2]!==h.dims[2])throw new Error('Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)');if(h.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');Ft=et.dims[2],Gt=et.dims[2]}else if(et||h)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let Lt;if(o){if(a.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(o.dims.length<3||o.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(a.dims[0]!==o.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(o.dims.length===3){if(o.dims[2]!==a.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');Lt=2,vt=o.dims[1]}else if(o.dims.length===5){if(o.dims[2]!==i.numHeads||o.dims[3]!==2||o.dims[4]!==qt)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(c)throw new Error('Expect "value" be none when "key" has packed kv format.');Lt=5,vt=o.dims[1]}else{if(o.dims[1]!==i.numHeads||o.dims[3]!==qt)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');Lt=0,vt=o.dims[2]}}else{if(a.dims.length!==3&&a.dims.length!==5)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(a.dims.length===5&&(a.dims[2]!==i.numHeads||a.dims[3]!==3))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');Lt=3}if(s){if(s.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimension');if(c&&a.dims.length===5&&a.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let rr=0;if(d){rr=8;let No=d.dims;throw No.length===1?No[0]===g?rr=1:No[0]===3*g+2&&(rr=3):No.length===2&&No[0]===g&&No[1]===vt&&(rr=5),rr===8?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, kv_sequence_length)'):new Error("Mask not supported")}let jr=!1,Hr=$t;if(c){if(c.dims.length!==3&&c.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(a.dims[0]!==c.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(c.dims.length===3){if(vt!==c.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');Hr=c.dims[2]}else{if(vt!==c.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');Hr=c.dims[1]*c.dims[3],jr=!0}}let wn=Ft+vt,_n=!1;if(d)throw new Error("Key padding mask is not supported");if($){if($.dims.length!==4)throw new Error('Input "relative_position_bias" is expected to have 4 dimensions');if($.dims[0]!==g&&$.dims[0]!==1||$.dims[1]!==i.numHeads||$.dims[2]!==st||$.dims[3]!==wn)throw new Error('Input "relative_position_bias" shape (batch_size, 1, sequence_length, kv_sequence_length)')}return{batchSize:g,sequenceLength:st,pastSequenceLength:Ft,kvSequenceLength:vt,totalSequenceLength:wn,maxSequenceLength:Gt,inputHiddenSize:0,hiddenSize:$t,vHiddenSize:Hr,headSize:qt,vHeadSize:Math.floor(Hr/i.numHeads),numHeads:i.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:i.maskFilterValue,maskType:rr,scale:i.scale,broadcastResPosBias:_n,passPastInKv:jr,qkvFormat:Lt}},kl=e=>we({...e}),El=we({perm:[0,2,1,3]}),um=(e,i,a,o,c,s,d)=>{let $=[o,c,s],et=M.size($),h=[{type:12,data:et},{type:12,data:d},{type:12,data:s}],b=g=>{let st=K("qkv_with_bias",i.dataType,$),$t=U("qkv",i.dataType,$),vt=U("bias",a.dataType,$),Ft=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`
  ${g.registerUniforms(Ft).declareVariables($t,vt,st)}
  ${g.mainStart()}
    ${g.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;

    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];
  }`};return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:$,dataType:i.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(et/64)},programUniforms:h}),getShaderSource:b},{inputs:[i,a],outputs:[-1]})[0]},$o=(e,i,a,o,c,s,d,$)=>{let et=s;if(d){if(o===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return et=um(e,s,d,i,o,a*c,$),et=et.reshape([i,o,a,c]),e.compute(xt(et,El.perm),{inputs:[et],outputs:[-1]})[0]}else return s.dims.length===3&&(et=s.reshape([i,o,a,c])),e.compute(xt(et,El.perm),{inputs:[et],outputs:[-1]})[0]},Ol=(e,i)=>{let a=sm(e.inputs,i),o=e.inputs[0],c=lt(e.inputs,1),s=lt(e.inputs,2),d=lt(e.inputs,3),$=lt(e.inputs,4),et=lt(e.inputs,5),h=lt(e.inputs,6),b=lt(e.inputs,7);if(o.dims.length===5)throw new Error("Packed QKV is not implemented");if((c==null?void 0:c.dims.length)===5)throw new Error("Packed KV is not implemented");let g=c&&s&&c.dims.length===4&&s.dims.length===4,st=$o(e,a.batchSize,a.numHeads,a.sequenceLength,a.headSize,o,d,0);if(g)return Xn(e,st,c,s,$,void 0,h,b,et,a,i);if(!c||!s)throw new Error("key and value must be provided");let $t=$o(e,a.batchSize,a.numHeads,a.kvSequenceLength,a.headSize,c,d,a.hiddenSize),vt=$o(e,a.batchSize,a.numHeads,a.kvSequenceLength,a.vHeadSize,s,d,2*a.hiddenSize);Xn(e,st,$t,vt,$,void 0,h,b,et,a,i)}}),lm,dm,cm,pm,mm,fm,hm,gm,Rl,zl=j(()=>{ye(),xe(),_e(),lm=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(e[0].dataType!==1&&e[0].dataType!==10)throw new Error("Input type must be float or float16.");if(e.length>=2){let i=e[0].dims.length*2===e[1].dims[0];if(e.length===4&&(i=e[3].dims[0]*2===e[1].dims[0]),!i)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},dm=(e,i,a)=>{let o="";for(let c=i-1;c>=0;--c)o+=`
            k = i32(${e.indicesGet("indices",c)}) - ${fe("uniforms.pads",c,a)};
            if (k < 0) {
              break;
            }
            if (k >= i32(${fe("uniforms.x_shape",c,i)})) {
              break;
            }
            offset += k * i32(${fe("uniforms.x_strides",c,i)});
        `;return`
          value = ${e.type.value}(uniforms.constant_value);
          for (var i = 0; i < 1; i++) {
            var offset = 0;
            var k = 0;
            ${o}
            value = x[offset];
          }
      `},cm=(e,i,a)=>{let o="";for(let c=i-1;c>=0;--c)o+=`
                k = i32(${e.indicesGet("indices",c)}) - ${fe("uniforms.pads",c,a)};
                if (k < 0) {
                  k = -k;
                }
                {
                  let _2n_1 = 2 * (i32(${fe("uniforms.x_shape",c,i)}) - 1);
                  k = k % _2n_1;
                  if(k >= i32(${fe("uniforms.x_shape",c,i)})) {
                    k = _2n_1 - k;
                  }
                }
                offset += k * i32(${fe("uniforms.x_strides",c,i)});
            `;return`
              var offset = 0;
              var k = 0;
              ${o}
              value = x[offset];
          `},pm=(e,i,a)=>{let o="";for(let c=i-1;c>=0;--c)o+=`
                k = i32(${e.indicesGet("indices",c)}) - ${fe("uniforms.pads",c,a)};
                if (k < 0) {
                  k = 0;
                }
                if (k >= i32(${fe("uniforms.x_shape",c,i)})) {
                  k = i32(${fe("uniforms.x_shape",c,i)}) - 1;
                }
                offset += k * i32(${fe("uniforms.x_strides",c,i)});
            `;return`
              var offset = 0;
              var k = 0;
              ${o}
              value = x[offset];
          `},mm=(e,i,a)=>{let o="";for(let c=i-1;c>=0;--c)o+=`
                k = i32(${e.indicesGet("indices",c)}) - ${fe("uniforms.pads",c,a)};
                if (k < 0)  {
                  k += i32(${fe("uniforms.x_shape",c,i)}]);
                }
                if (k >= i32(${fe("uniforms.x_shape",c,i)})) {
                  k -= i32(${fe("uniforms.x_shape",c,i)});
                }
                offset += k * i32(${fe("uniforms.x_strides",c,i)});
            `;return`
              var offset = 0;
              var k = 0;
              ${o}
              value = x[offset];
          `},fm=(e,i,a)=>{switch(a.mode){case 0:return dm(e,i,a.pads.length);case 1:return cm(e,i,a.pads.length);case 2:return pm(e,i,a.pads.length);case 3:return mm(e,i,a.pads.length);default:throw new Error("Invalid mode")}},hm=(e,i)=>{let a=M.padShape(e[0].dims.slice(),i.pads),o=e[0].dims,c=M.size(a),s=[{type:12,data:c},{type:6,data:i.pads}];i.mode===0&&s.push({type:e[0].dataType,data:i.value}),s.push(...X(e[0].dims,a));let d=["rank"],$=et=>{let h=K("output",e[0].dataType,a.length),b=U("x",e[0].dataType,o.length),g=b.type.value,st=fm(h,o.length,i),$t=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:i.pads.length}];return i.mode===0&&$t.push({name:"constant_value",type:g}),`
            ${et.registerUniforms($t).declareVariables(b,h)}
            ${et.mainStart()}
            ${et.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

            let indices = ${h.offsetToIndices("global_idx")};

            var value = ${g}(0);
            ${st}
            output[global_idx] = value;
        }`};return{name:"Pad",shaderCache:{hint:`${i.mode}`,inputDependencies:d},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(M.size(a)/64)},programUniforms:s}),getShaderSource:$}},gm=(e,i)=>{if(e.length>1){let a=e[1].getBigInt64Array(),o=e.length>=3&&e[2].data?e[2].getFloat32Array()[0]:0,c=e[0].dims.length,s=new Int32Array(2*c).fill(0);if(e.length>=4){let $=e[3].getBigInt64Array();for(let et=0;et<$.length;et++)s[Number($[et])]=Number(a[et]),s[Number($[et])+c]=Number(a[et+$.length])}else a.forEach(($,et)=>s[Number(et)]=Number($));let d=[];return s.forEach($=>d.push($)),{mode:i.mode,value:o,pads:d}}else return i},Rl=(e,i)=>{lm(e.inputs);let a=gm(e.inputs,i);e.compute(hm(e.inputs,a),{inputs:[0]})}}),si,Bl,Dl,Ml,Ul,ym,bm,Wl,Nl,Vl,Hl,Gl,Ll,Fl,ql,jl,Kl,Yl,Xl,Zl=j(()=>{_t(),ye(),xe(),_e(),si=e=>{if(ke.webgpu.validateInputContent&&(!e||e.length!==1))throw new Error("Pool ops requires 1 input.")},Bl=(e,i,a)=>{let o=i.format==="NHWC",c=e.dims.slice();o&&c.splice(1,0,c.pop());let s=Object.hasOwnProperty.call(i,"dilations"),d=i.kernelShape.slice(),$=i.strides.slice(),et=s?i.dilations.slice():[],h=i.pads.slice();pr.adjustPoolAttributes(a,c,d,$,et,h);let b=pr.computePoolOutputShape(a,c,$,et,d,h,i.autoPad),g=Object.assign({},i);s?Object.assign(g,{kernelShape:d,strides:$,pads:h,dilations:et,cacheKey:i.cacheKey}):Object.assign(g,{kernelShape:d,strides:$,pads:h,cacheKey:i.cacheKey});let st=b.slice();return st.push(st.splice(1,1)[0]),[g,o?st:b]},Dl=(e,i)=>{let a=i.format==="NHWC",o=M.size(e),c=M.size(i.kernelShape),s=[{type:12,data:o},{type:12,data:c}],d=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(i.kernelShape.length<=2){let $=i.kernelShape[i.kernelShape.length-1],et=i.strides[i.strides.length-1],h=i.pads[i.pads.length/2-1],b=i.pads[i.pads.length-1],g=!!(h+b);s.push({type:12,data:$},{type:12,data:et},{type:12,data:h},{type:12,data:b}),d.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let st=!1;if(i.kernelShape.length===2){let $t=i.kernelShape[i.kernelShape.length-2],vt=i.strides[i.strides.length-2],Ft=i.pads[i.pads.length/2-2],Gt=i.pads[i.pads.length-2];st=!!(Ft+Gt),s.push({type:12,data:$t},{type:12,data:vt},{type:12,data:Ft},{type:12,data:Gt}),d.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[s,d,!0,g,st]}else{if(a)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let $=M.computeStrides(i.kernelShape);s.push({type:12,data:$},{type:12,data:i.pads},{type:12,data:i.strides}),d.push({name:"kernelStrides",type:"u32",length:$.length},{name:"pads",type:"u32",length:i.pads.length},{name:"strides",type:"u32",length:i.strides.length});let et=i.pads.reduce((h,b)=>h+b);return[s,d,!!et,!1,!1]}},Ml=(e,i,a,o,c,s,d,$,et,h,b,g)=>{let st=c.format==="NHWC",$t=i.type.value,vt=K("output",i.type.tensor,o);if(c.kernelShape.length<=2){let Ft="",Gt="",qt="",Lt=a-(st?2:1);if(b?Ft=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${Lt}] = indices[${Lt}] * uniforms.sw - uniforms.pwStart + i;
                  if (xIndices[${Lt}] < 0 || xIndices[${Lt}]
                      >= uniforms.x_shape[${Lt}]) {
                    pad++;
                    continue;
                  }
                  let x_val = x[${i.indicesToOffset("xIndices")}];
                  ${s}
                }`:Ft=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${Lt}] = indices[${Lt}] * uniforms.sw - uniforms.pwStart + i;
                  let x_val = x[${i.indicesToOffset("xIndices")}];
                  ${s}
                }`,c.kernelShape.length===2){let rr=a-(st?3:2);g?Gt=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${rr}] = indices[${rr}] * uniforms.sh - uniforms.phStart + j;
                  if (xIndices[${rr}] < 0 || xIndices[${rr}] >= uniforms.x_shape[${rr}]) {
                    pad += i32(uniforms.kw);
                    continue;
                  }
              `:Gt=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${rr}] = indices[${rr}] * uniforms.sh - uniforms.phStart + j;
                `,qt=`
              }
            `}return`
            ${e.registerUniforms(et).declareVariables(i,vt)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

              let indices = ${vt.offsetToIndices("global_idx")};
              var xIndices = ${vt.offsetToIndices("global_idx")};

              var value = ${$t}(${$});
              var pad = 0;
              ${Gt}
              ${Ft}
              ${qt}
              ${d}

              output[global_idx] = value;
            }`}else{if(st)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let Ft=c.kernelShape.length,Gt=c.pads.length,qt="";return h?qt=`
                if (xIndices[j] >= uniforms.x_shape[j]) {
                  pad++;
                  isPad = true;
                  break;
                }
              }
              if (!isPad) {
                let x_val = x[${i.indicesToOffset("xIndices")}];
                ${s}
              }`:qt=`
              }
              let x_val = x[${i.indicesToOffset("xIndices")}];
              ${s}
            `,`
            ${e.registerUniforms(et).declareVariables(i,vt)}

            ${e.mainStart()}
              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
              let indices = ${vt.offsetToIndices("global_idx")};
              var xIndices = ${vt.offsetToIndices("global_idx")};

              var offsets: array<u32, ${Ft}>;

              var value = ${$t}(${$});
              var pad = 0;
              var isPad = false;

              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {
                var offset = i;
                for (var j = 0u; j < ${Ft-1}u; j++) {
                  offsets[j] = offset / ${fe("uniforms.kernelStrides","j",Ft)};
                  offset -= offsets[j] * ${fe("uniforms.kernelStrides","j",Ft)};
                }
                offsets[${Ft-1}] = offset;

                isPad = false;
                for (var j = ${a-Ft}u; j < ${a}u; j++) {
                  xIndices[j] = indices[j] * ${fe("uniforms.strides",`j - ${a-Ft}u`,Ft)}
                    + offsets[j - ${a-Ft}u] - ${fe("uniforms.pads","j - 2u",Gt)};
                  ${qt}
              }
              ${d}

              output[global_idx] = value;
            }`}},Ul=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,ym=e=>`${Ul(e)};${e.countIncludePad}`,bm=e=>`${Ul(e)};${e.storageOrder};${e.dilations}`,Wl=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),Nl=(e,i,a,o)=>{let[c,s]=Bl(i,o,a),d=U("x",i.dataType,i.dims.length),$=d.type.value,et="value += x_val;",h="";c.countIncludePad?h+=`value /= ${$}(uniforms.kernelSize);`:h+=`value /= ${$}(i32(uniforms.kernelSize) - pad);`;let[b,g,st,$t,vt]=Dl(s,c);b.push(...X(i.dims,s));let Ft=["rank"];return{name:e,shaderCache:{hint:`${o.cacheKey};${st};${$t};${vt}`,inputDependencies:Ft},getRunData:()=>({outputs:[{dims:s,dataType:i.dataType}],dispatchGroup:{x:Math.ceil(M.size(s)/64)},programUniforms:b}),getShaderSource:Gt=>Ml(Gt,d,i.dims.length,s.length,c,et,h,0,g,st,$t,vt)}},Vl=e=>{let i=e.count_include_pad!==0,a=Wl(e);if(a.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let o={countIncludePad:i,...a,cacheKey:""};return{...o,cacheKey:ym(o)}},Hl=(e,i)=>{si(e.inputs),e.compute(Nl("AveragePool",e.inputs[0],!1,i))},Gl={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},Ll=e=>{let i=e.format;return{format:i,...Gl,cacheKey:i}},Fl=(e,i)=>{si(e.inputs),e.compute(Nl("GlobalAveragePool",e.inputs[0],!0,i))},ql=(e,i,a,o)=>{let[c,s]=Bl(i,o,a),d=`
      value = max(x_val, value);
    `,$="",et=U("x",i.dataType,i.dims.length),h=["rank"],[b,g,st,$t,vt]=Dl(s,c);return b.push(...X(i.dims,s)),{name:e,shaderCache:{hint:`${o.cacheKey};${st};${$t};${vt}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:s,dataType:i.dataType}],dispatchGroup:{x:Math.ceil(M.size(s)/64)},programUniforms:b}),getShaderSource:Ft=>Ml(Ft,et,i.dims.length,s.length,c,d,$,i.dataType===10?-65504:-1e5,g,st,$t,vt)}},jl=(e,i)=>{si(e.inputs),e.compute(ql("MaxPool",e.inputs[0],!1,i))},Kl=e=>{let i=e.storage_order,a=e.dilations,o=Wl(e);if(i!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(o.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let c={storageOrder:i,dilations:a,...o,cacheKey:""};return{...c,cacheKey:bm(c)}},Yl=e=>{let i=e.format;return{format:i,...Gl,cacheKey:i}},Xl=(e,i)=>{si(e.inputs),e.compute(ql("GlobalMaxPool",e.inputs[0],!0,i))}}),wm,$m,Ql,Jl=j(()=>{_t(),ye(),_e(),wm=(e,i,a)=>{let o=e===i,c=e<i&&a<0,s=e>i&&a>0;if(o||c||s)throw new Error("Range these inputs' contents are invalid.")},$m=(e,i,a,o)=>{let c=Math.abs(Math.ceil((i-e)/a)),s=[c],d=c,$=[{type:12,data:d},{type:o,data:e},{type:o,data:a},...X(s)],et=h=>{let b=K("output",o,s.length),g=b.type.value,st=[{name:"outputSize",type:"u32"},{name:"start",type:g},{name:"delta",type:g}];return`
        ${h.registerUniforms(st).declareVariables(b)}
        ${h.mainStart()}
        ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        output[global_idx] = uniforms.start + ${g}(global_idx) * uniforms.delta;
      }`};return{name:"Range",shaderCache:{hint:`${o}`},getShaderSource:et,getRunData:()=>({outputs:[{dims:s,dataType:o}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:$})}},Ql=e=>{let i=0,a=0,o=0;e.inputs[0].dataType===6?(i=e.inputs[0].getInt32Array()[0],a=e.inputs[1].getInt32Array()[0],o=e.inputs[2].getInt32Array()[0]):e.inputs[0].dataType===1&&(i=e.inputs[0].getFloat32Array()[0],a=e.inputs[1].getFloat32Array()[0],o=e.inputs[2].getFloat32Array()[0]),ke.webgpu.validateInputContent&&wm(i,a,o),e.compute($m(i,a,o,e.inputs[0].dataType),{inputs:[]})}}),_m,xm,Sm,Cm,Im,Tm,Am,Em,km,Om,Pm,ed,Rm,zm,Bm,Dm,Mm,td,rd,nd=j(()=>{ye(),xe(),Ze(),_e(),_m=(e,i)=>{if(e.every(a=>a>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),e.length>0){if(i.mode==="linear"){if(!(e.length===2||e.length===3||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1||e.length===5&&e[0]===1&&e[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and
            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(i.mode==="cubic"&&!(e.length===2||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},xm=(e,i,a)=>{i.every(c=>c>=0&&c<a||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let o=new Array(a).fill(1);return i.forEach((c,s)=>o[c]=e[s]),o},Sm=(e,i,a,o,c,s)=>{let[d,$,et]=a>10?[1,2,3]:[-1,e.length>1?1:-1,-1],h=e[0].dims.length;if(d>0&&e.length>d&&e[d].dims.length>0)e[d].getFloat32Array().forEach(b=>s.push(b));else if(i.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if($>0&&e.length>$&&e[$].dims.length>0){if(e[$].getFloat32Array().forEach(b=>o.push(b)),o.length!==0&&o.length!==h&&a>=18&&o.length!==i.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");_m(o,i),i.axes.length>0&&xm(o,i.axes,h).forEach((b,g)=>o[g]=b)}if(et>0&&e.length>et&&(e[et].getBigInt64Array().forEach(b=>c.push(Number(b))),c.length!==h||a>=18&&c.length===i.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(i.axes.length>0){if(o.length!==i.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(c.length!==i.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(typeof o<"u"&&typeof c<"u"&&o.length>0&&c.length>h)throw new Error("Resize requires only of scales or sizes to be specified")},Cm=(e,i)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,
     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${i} { `+(()=>{switch(e){case"asymmetric":return`return ${i}(xResized) / ${i}(xScale);`;case"pytorch_half_pixel":return`if (lengthResized > 1) {
                    return (${i}(xResized) + 0.5) / ${i}(xScale) - 0.5;
                  } else {
                    return 0.0;
                  }`;case"tf_half_pixel_for_nn":return`return (${i}(xResized) + 0.5) / ${i}(xScale);`;case"align_corners":return`if (lengthResized == 1) {
                    return 0.0;
                  } else {
                    // The whole part and the fractional part are calculated separately due to inaccuracy of floating
                    // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an
                    // offset-by-one error later in floor().
                    let whole = ${i}(xResized * (lengthOriginal - 1) / (lengthResized - 1));
                    let fract =
                        ${i}(xResized * (lengthOriginal - 1) % (lengthResized - 1)) / ${i}(lengthResized - 1);
                    return whole + fract;
                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {
                    return ${i}(roiStart) * ${i}(lengthOriginal - 1) +
                        (${i}(xResized) * ${i}(roiEnd - roiStart) * ${i}(lengthOriginal - 1)) /
                        ${i}(lengthResized - 1);
                  } else {
                    return 0.5 * ${i}(roiStart + roiEnd) * ${i}(lengthOriginal - 1);
                  }`;case"half_pixel_symmetric":return`const outputWidth = ${i}xScale * ${i}(lengthResized);
                  const adjustment = ${i}(lengthResized) / outputWidth;
                  const center = ${i}(lengthOriginal) / 2;
                  const offset = center * (1 - adjustment);
                  return offset + ((${i}(xResized) + 0.5) / ${i}(xScale)) - 0.5;`;case"half_pixel":return`return ((${i}(xResized) + 0.5) / ${i}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",Im=(e,i,a)=>`fn getNearestPixelFromOriginal(xOriginal: ${a}, isDownSample: bool) -> ${a} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";case"simple":default:if(i<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${e} is not supported`)}})()+"}",Tm=(e,i,a)=>{let o=new Array(a).fill(0).concat(new Array(a).fill(1)),c=e.length===0?o:e.slice();return i.length>0?(i.forEach((s,d)=>{o[s]=c[d],o[d+a]=c[i.length+d]}),o):c},Am=(e,i,a,o)=>{let c=[];if(a.length>0)if(o.length>0){if(e.forEach(s=>c.push(s)),Math.max(...o)>e.length)throw new Error("axes is out of bound");o.forEach((s,d)=>c[s]=a[d])}else a.forEach(s=>c.push(s));else{if(i.length===0)throw new Error("Resize requires either scales or sizes.");c=e.map((s,d)=>Math.round(s*i[d]))}return c},Em=(e,i,a)=>{let o=(()=>{switch(a.keepAspectRatioPolicy){case"not_larger":return a.axes.length>0?Math.min(...a.axes.map(s=>i[s]),Number.MAX_VALUE):Math.min(...i,Number.MAX_VALUE);case"not_smaller":return a.axes.length>0?Math.max(...a.axes.map(s=>i[s]),Number.MIN_VALUE):Math.max(...i,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${a.keepAspectRatioPolicy} is not supported`)}})();i.fill(1,0,i.length);let c=e.slice();return a.axes.length>0?(a.axes.forEach(s=>i[s]=o),a.axes.forEach(s=>c[s]=Math.round(e[s]*i[s]))):(i.fill(o,0,i.length),c.forEach((s,d)=>c[d]=Math.round(s*i[d]))),c},km=(e,i,a,o,c)=>`
    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${a.length}> {
      var original_indices: array<${e.type.value}, ${a.length}>;
      for (var i:u32 = 0; i < ${a.length}; i++) {
        var output_index = ${e.indicesGet("output_indices","i")};
        var scale = ${fe("uniforms.scales","i",o)};
        var roi_low = ${fe("uniforms.roi","i",c)};
        var roi_hi = ${fe("uniforms.roi",`i + ${i.length}`,c)};
        if (scale == 1.0) {
          original_indices[i] = ${e.type.value}(output_index);
        } else {
          var input_shape_i = ${fe("uniforms.input_shape","i",i.length)};
          var output_shape_i = ${fe("uniforms.output_shape","i",a.length)};
          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                           input_shape_i, roi_low, roi_hi);
        }
      }
      return original_indices;
    }`,Om=(e,i,a,o,c,s,d)=>`
    fn calculateInputIndicesFromOutputIndices(output_indices: ${i.type.indices}) -> ${e.type.indices} {
      var input_indices: ${e.type.indices};
      for (var i:u32 = 0; i < ${o.length}; i++) {
        var output_index = ${i.indicesGet("output_indices","i")};
        var input_index: u32;
        var scale = ${fe("uniforms.scales","i",c)};
        if (scale == 1.0) {
          input_index = output_index;
        } else {
          var roi_low = ${fe("uniforms.roi","i",s)};
          var roi_hi = ${fe("uniforms.roi",`i + ${a.length}`,s)};
          var input_shape_i = ${fe("uniforms.input_shape","i",a.length)};
          var output_shape_i = ${fe("uniforms.output_shape","i",o.length)};
          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                        input_shape_i, roi_low, roi_hi);
          if (!${d} || (original_idx >= 0 && original_idx < ${i.type.value}(input_shape_i))) {
            if (original_idx < 0) {
              input_index = 0;
            } else if (original_idx > ${i.type.value}(input_shape_i - 1)) {
              input_index = input_shape_i - 1;
            } else {
              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));
            }
          } else {
            input_index = u32(original_idx);
          }
        }
        ${e.indicesSet("input_indices","i"," input_index")}
      }
      return input_indices;
    }`,Pm=(e,i)=>`
    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {
      for (var i:u32 = 0; i < ${i.length}; i++) {
        var input_index = ${e.indicesGet("input_indices","i")};
        if (input_index < 0 || input_index >= ${fe("uniforms.input_shape","i",i.length)}) {
          return false;
        }
      }
      return true;
    }`,ed=(e,i,a,o)=>e.rank>o?`
    ${e.indicesSet("input_indices",i,"channel")};
    ${e.indicesSet("input_indices",a,"batch")};
`:"",Rm=(e,i,a,o,c)=>{let[s,d,$,et]=a.length===2?[-1,0,1,-1]:[0,2,3,1],h=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${h} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",d,`max(0, min(row, ${a[d]} - 1))`)};
      ${e.indicesSet("input_indices",$,`max(0, min(col, ${a[$]} - 1))`)};
      ${ed(e,et,s,2)}
      return ${e.getByIndices("input_indices")};
    }

    fn bilinearInterpolation(output_indices: ${i.type.indices}) -> ${h} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var row:${h} = originalIndices[${d}];
      var col:${h} = originalIndices[${$}];
      ${o?`if (row < 0 || row > (${a[d]} - 1) || col < 0 || col > (${a[$]} - 1)) {
        return ${c};
      }`:""};
      row = max(0, min(row, ${a[d]} - 1));
      col = max(0, min(col, ${a[$]} - 1));
      var row1: u32 = u32(row);
      var col1: u32 = u32(col);
      var row2: u32 = u32(row + 1);
      var col2: u32 = u32(col + 1);
      var channel: u32 = ${a.length>2?`u32(originalIndices[${et}])`:"0"};
      var batch: u32 =  ${a.length>2?`u32(originalIndices[${s}])`:"0"};
      var x11: ${h} = getInputValue(batch, channel, row1, col1);
      var x12: ${h} = getInputValue(batch, channel, row1, col2);
      var x21: ${h} = getInputValue(batch, channel, row2, col1);
      var x22: ${h} = getInputValue(batch, channel, row2, col2);
      var dx1: ${h} = abs(row - ${h}(row1));
      var dx2: ${h} = abs(${h}(row2) - row);
      var dy1: ${h} = abs(col - ${h}(col1));
      var dy2: ${h} = abs(${h}(col2) - col);
      if (row1 == row2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (col1 == col2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);
    }`},zm=(e,i,a,o,c,s,d,$,et,h)=>{let b=a.length===2,[g,st]=b?[0,1]:[2,3],$t=e.type.value,vt=Ft=>{let Gt=Ft===g?"row":"col";return`
      fn ${Gt}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${i.type.indices}) -> ${$t} {
        var output_index = ${i.indicesGet("output_indices",Ft)};
        var originalIdx: ${$t} = getOriginalCoordinateFromResizedCoordinate(output_index, ${c[Ft]},
        ${o[Ft]}, ${a[Ft]}, ${s[Ft]}, ${s[Ft]} + ${a.length});
        var fractOriginalIdx: ${$t} = originalIdx - floor(originalIdx);
        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);

        if (${$} && (originalIdx < 0 || originalIdx > (${a[Ft]} - 1))) {
          return ${et};
        }
        var data: array<${$t}, 4> = array<${$t}, 4>(0.0, 0.0, 0.0, 0.0);
        for (var i: i32 = -1; i < 3; i++) {
          var ${Gt}: ${$t} = originalIdx + ${$t}(i);
          if (${Gt} < 0 || ${Gt} >= ${a[Ft]}) {
            ${(()=>h?`coefs[i + 1] = 0.0;
                        continue;`:$?`return ${et};`:`${Gt} = max(0, min(${Gt}, ${a[Ft]} - 1));`)()};
          }
        var input_indices_copy: ${e.type.indices} = input_indices;
          ${e.indicesSet("input_indices_copy",Ft,`u32(${Gt})`)};
          data[i + 1] = ${Ft===g?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};
        }
        return cubicInterpolation1D(data, coefs);
      }`};return`
    ${vt(g)};
    ${vt(st)};
  fn getCubicInterpolationCoefs(s: ${$t}) -> array<${$t}, 4> {
    var absS = abs(s);
    var coeffs: array<${$t}, 4> = array<${$t}, 4>(0.0, 0.0, 0.0, 0.0);
    var oneMinusAbsS: ${$t} = 1.0 - absS;
    var twoMinusAbsS: ${$t} = 2.0 - absS;
    var onePlusAbsS: ${$t} = 1.0 + absS;
    coeffs[0] = ((${d} * onePlusAbsS - 5 * ${d}) * onePlusAbsS + 8 * ${d}) * onePlusAbsS - 4 * ${d};
    coeffs[1] = ((${d} + 2) * absS - (${d} + 3)) * absS * absS + 1;
    coeffs[2] = ((${d} + 2) * oneMinusAbsS - (${d} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;
    coeffs[3] = ((${d} * twoMinusAbsS - 5 * ${d}) * twoMinusAbsS + 8 * ${d}) * twoMinusAbsS - 4 * ${d};
    return coeffs;
  }

  fn cubicInterpolation1D(x: array<${$t}, 4>, coefs: array<${$t}, 4>) -> ${$t} {
    var coefsSum: ${$t} = coefs[0] + coefs[1] + coefs[2] + coefs[3];
    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;
  }

  fn bicubicInterpolation(output_indices: ${i.type.indices}) -> ${$t} {
    var input_indices: ${e.type.indices} = output_indices;
    return colCubicInterpolation(input_indices, output_indices);
  }
    `},Bm=(e,i,a,o,c)=>{let[s,d,$,et,h]=a.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],b=e.type.value;return`
    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${b} {
      var input_indices: ${e.type.indices};
      ${e.indicesSet("input_indices",d,`max(0, min(depth, ${a[d]} - 1))`)};
      ${e.indicesSet("input_indices",$,`max(0, min(height, ${a[$]} - 1))`)};
      ${e.indicesSet("input_indices",et,`max(0, min(width, ${a[et]} - 1))`)};
      ${ed(e,h,s,3)}
      return ${e.getByIndices("input_indices")};
    }

    fn trilinearInterpolation(output_indices: ${i.type.indices}) -> ${b} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var depth:${b} = originalIndices[${d}];
      var height:${b} = originalIndices[${$}];
      var width:${b} = originalIndices[${et}];
      ${o?`if (depth < 0 || depth > (${a[d]} - 1) || height < 0 || height > (${a[$]} - 1) || width < 0 || (width > ${a[et]} - 1)) {
      return ${c};
        }`:""};

    depth = max(0, min(depth, ${a[d]} - 1));
      height = max(0, min(height, ${a[$]} - 1));
      width = max(0, min(width, ${a[et]} - 1));
      var depth1: u32 = u32(depth);
      var height1: u32 = u32(height);
      var width1: u32 = u32(width);
      var depth2: u32 = u32(depth + 1);
      var height2: u32 = u32(height + 1);
      var width2: u32 = u32(width + 1);
      var channel: u32 = ${a.length>3?`u32(originalIndices[${h}])`:"0"};
      var batch: u32 =  ${a.length>3?`u32(originalIndices[${s}])`:"0"};

      var x111: ${b} = getInputValue(batch, channel, depth1, height1, width1);
      var x112: ${b} = getInputValue(batch, channel, depth1, height1, width2);
      var x121: ${b} = getInputValue(batch, channel, depth1, height2, width1);
      var x122: ${b} = getInputValue(batch, channel, depth1, height2, width2);
      var x211: ${b} = getInputValue(batch, channel, depth2, height1, width1);
      var x212: ${b} = getInputValue(batch, channel, depth2, height1, width2);
      var x221: ${b} = getInputValue(batch, channel, depth2, height2, width1);
      var x222: ${b} = getInputValue(batch, channel, depth2, height2, width2);
      var dx1: ${b} = abs(depth - ${b}(depth1));
      var dx2: ${b} = abs(${b}(depth2) - depth);
      var dy1: ${b} = abs(height - ${b}(height1));
      var dy2: ${b} = abs(${b}(height2) - height);
      var dz1: ${b} = abs(width - ${b}(width1));
      var dz2: ${b} = abs(${b}(width2) - width);
      if (depth1 == depth2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (height1 == height2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      if (width1 == width2) {
        dz1 = 0.5;
        dz2 = 0.5;
      }
      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +
              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);
    }`},Dm=(e,i,a,o,c,s)=>{let d=e.dims,$=Tm(s,i.axes,d.length),et=Am(d,o,c,i.axes),h=o.slice();o.length===0&&(h=d.map((Lt,rr)=>Lt===0?1:et[rr]/Lt),i.keepAspectRatioPolicy!=="stretch"&&(et=Em(d,h,i)));let b=K("output",e.dataType,et.length),g=U("input",e.dataType,d.length),st=M.size(et),$t=d.length===et.length&&d.every((Lt,rr)=>Lt===et[rr]),vt=i.coordinateTransformMode==="tf_crop_and_resize",Ft=i.extrapolationValue,Gt=g.type.value,qt=Lt=>`
      ${$t?"":`
      ${Cm(i.coordinateTransformMode,Gt)};
      ${(()=>{switch(i.mode){case"nearest":return`
              ${Pm(g,d)};
              ${Im(i.nearestMode,a,Gt)};
              ${Om(g,b,d,et,h.length,$.length,vt)};
              `;case"linear":return`
              ${km(b,d,et,h.length,$.length)};
              ${(()=>{if(d.length===2||d.length===4)return`${Rm(g,b,d,vt,Ft)}`;if(d.length===3||d.length===5)return`${Bm(g,b,d,vt,Ft)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};
            `;case"cubic":return`
            ${(()=>{if(d.length===2||d.length===4)return`${zm(g,b,d,et,h,$,i.cubicCoeffA,vt,i.extrapolationValue,i.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};
            `;default:throw Error("Invalid resize mode")}})()};
      `}
      ${Lt.registerUniform("output_size","u32").registerUniform("scales","f32",h.length).registerUniform("roi","f32",$.length).declareVariables(g,b)}
      ${Lt.mainStart()}
        ${Lt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
        ${$t?"output[global_idx] = input[global_idx];":`
        let output_indices = ${b.offsetToIndices("global_idx")};
        var input_indices: ${g.type.indices};
        ${(()=>{switch(i.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);
                if (checkInputIndices(input_indices)) {
                  output[global_idx] = ${g.getByIndices("input_indices")};
                } else {
                  output[global_idx] = ${i.extrapolationValue};
                }`;case"linear":return`output[global_idx] = ${d.length===2||d.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${i.mode}`)}})()};
`}
      }`;return{name:"Resize",shaderCache:{hint:`${i.cacheKey}|${a}|${h.length>0?h:""}|${c.length>0?c:""}|${$.length>0?$:""}|${$t}|${d}`,inputDependencies:["rank"]},getShaderSource:qt,getRunData:()=>({outputs:[{dims:et,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(st/64)},programUniforms:[{type:12,data:st},{type:1,data:h},{type:1,data:$},...X(d,et)]})}},Mm=e=>{let i=e.customDataBuffer;return new Uint32Array(i,i.byteOffset,1)[0]},td=(e,i)=>{let a=[],o=[],c=[],s=Mm(e);if(i.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");Sm(e.inputs,i,s,a,o,c),e.compute(Dm(e.inputs[0],i,s,a,o,c),{inputs:[0]})},rd=e=>{let i=e.antialias,a=e.axes,o=e.coordinateTransformMode,c=e.cubicCoeffA,s=e.excludeOutside!==0,d=e.extrapolationValue,$=e.keepAspectRatioPolicy,et=e.mode,h=e.nearestMode===""?"simple":e.nearestMode;return we({antialias:i,axes:a,coordinateTransformMode:o,cubicCoeffA:c,excludeOutside:s,extrapolationValue:d,keepAspectRatioPolicy:$,mode:et,nearestMode:h})}}),Um,Wm,id$1,od=j(()=>{ye(),xe(),Ze(),_e(),Um=(e,i)=>{let[a,o,c,s]=e,{numHeads:d,rotaryEmbeddingDim:$}=i;if(a.dims.length!==3&&a.dims.length!==4)throw new Error(`Input 'x' is expected to have 3 or 4 dimensions, got ${a.dims.length}`);if(!M.areEqual(o.dims,[])&&!M.areEqual(o.dims,[1])&&o.dims.length!==2)throw new Error(`Input 'position_ids' is expected to have 0, 1, or 2 dimensions, got ${o.dims.length}`);if(c.dims.length!==2)throw new Error(`Input 'cos_cache' is expected to have 2 dimensions, got ${c.dims.length}`);if(s.dims.length!==2)throw new Error(`Input 'sin_cache' is expected to have 2 dimensions, got ${s.dims.length}`);if(!M.areEqual(c.dims,s.dims))throw new Error("Inputs 'cos_cache' and 'sin_cache' are expected to have the same shape");if($>0&&d===0)throw new Error("num_heads must be provided if rotary_embedding_dim is specified");let et=a.dims[0],h=a.dims[a.dims.length-2],b=c.dims[0],g=M.sizeFromDimension(a.dims,1)/h,st=$===0?c.dims[1]*2:g/d;if($>st)throw new Error("rotary_embedding_dim must be less than or equal to head_size");if(o.dims.length===2){if(et!==o.dims[0])throw new Error(`Input 'position_ids' dimension 0 should be of size batch_size, got ${o.dims[0]}`);if(h!==o.dims[1])throw new Error(`Input 'position_ids' dimension 1 should be of size sequence_length, got ${o.dims[1]}`)}if(st/2!==c.dims[1]&&$/2!==c.dims[1])throw new Error(`Input 'cos_cache' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ${c.dims[1]}`);if(h>b)throw new Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},Wm=(e,i)=>{let{interleaved:a,numHeads:o,rotaryEmbeddingDim:c,scale:s}=i,d=e[0].dims[0],$=M.sizeFromDimension(e[0].dims,1),et=e[0].dims[e[0].dims.length-2],h=$/et,b=e[2].dims[1],g=c===0?b*2:h/o,st=new Array(d,et,h/g,g-b),$t=M.computeStrides(st),vt=[{type:1,data:s},{type:12,data:st},{type:12,data:$t},...e[0].dims.length===3?new Array({type:12,data:[$,h,g,1]}):[],...e[0].dims.length===4?new Array({type:12,data:[$,g,et*g,1]}):[],...X(e[0].dims,e[1].dims,e[2].dims,e[3].dims,e[0].dims)],Ft=Gt=>{let qt=U("input",e[0].dataType,e[0].dims.length),Lt=U("position_ids",e[1].dataType,e[1].dims.length),rr=U("cos_cache",e[2].dataType,e[2].dims.length),jr=U("sin_cache",e[3].dataType,e[3].dims.length),Hr=K("output",e[0].dataType,e[0].dims.length);return Gt.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:st.length},{name:"global_strides",type:"u32",length:$t.length},{name:"input_output_strides",type:"u32",length:$t.length}]),`
        ${Gt.declareVariables(qt,Lt,rr,jr,Hr)}

        ${Gt.mainStart(mr)}
          let half_rotary_emb_dim = uniforms.${rr.name}_shape[1];
          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;
          let size = uniforms.global_shape[0] * uniforms.global_strides[0];
          ${Gt.guardAgainstOutOfBoundsWorkgroupSizes("size")}

          if (bsnh[3] < half_rotary_emb_dim) {
            let position_ids_idx =
                ${Lt.broadcastedIndicesToOffset("bsnh.xy",K("",Lt.type.tensor,2))};
            let position_id =
                u32(${Lt.getByOffset("position_ids_idx")}) + select(0, bsnh[1], position_ids_idx == 0);
            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ${a});
            let j = i + select(half_rotary_emb_dim, 1, ${a});
            let re = ${qt.getByOffset("i")} * ${rr.get("position_id","bsnh[3]")} -
                ${qt.getByOffset("j")} * ${jr.get("position_id","bsnh[3]")};
            ${Hr.setByOffset("i","re")}
            let im = ${qt.getByOffset("i")} * ${jr.get("position_id","bsnh[3]")} +
                ${qt.getByOffset("j")} * ${rr.get("position_id","bsnh[3]")};
            ${Hr.setByOffset("j","im")}
          } else {
            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;
            ${Hr.setByOffset("k",qt.getByOffset("k"))}
          }
        }`};return{name:"RotaryEmbedding",shaderCache:{hint:we({interleaved:a}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:Ft,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(M.size(st)/mr)},programUniforms:vt})}},id$1=(e,i)=>{Um(e.inputs,i),e.compute(Wm(e.inputs,i))}}),Nm,Vm,ad,sd=j(()=>{ye(),xe(),_e(),Nm=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let i=e[0],a=e[1],o=e[2];if(i.dataType!==a.dataType||i.dataType!==o.dataType)throw new Error("All inputs must have the same data type");if(i.dims.length!==3&&i.dims.length!==2)throw new Error("Input must be 2D or 3D");if(a.dims.length!==3&&a.dims.length!==2)throw new Error("Skip must be 2D or 3D");let c=i.dims[i.dims.length-1],s=i.dims[i.dims.length-2];if(a.dims[a.dims.length-1]!==c)throw new Error("Skip must have the same hidden size as input");if(a.dims[a.dims.length-2]!==s)throw new Error("Skip must have the same sequence length as input");if(o.dims.length!==1)throw new Error("Gamma must be 1D");if(o.dims[o.dims.length-1]!==c)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let d=e[3];if(d.dims.length!==1)throw new Error("Beta must be 1D");if(d.dims[d.dims.length-1]!==c)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let d=e[4];if(d.dims.length!==1)throw new Error("Bias must be 1D");if(d.dims[d.dims.length-1]!==c)throw new Error("Bias must have the same hidden size as input")}},Vm=(e,i,a,o)=>{let c=i.simplified,s=e[0].dims,d=M.size(s),$=s,et=d,h=s.slice(-1)[0],b=o?s.slice(0,-1).concat(1):[],g=!c&&e.length>3,st=e.length>4,$t=o&&a>1,vt=o&&a>2,Ft=a>3,Gt=Ue(h),qt=[{type:12,data:et},{type:12,data:Gt},{type:12,data:h},{type:1,data:i.epsilon}],Lt=jr=>{let Hr=[{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}],wn=[U("x",e[0].dataType,e[0].dims,Gt),U("skip",e[1].dataType,e[1].dims,Gt),U("gamma",e[2].dataType,e[2].dims,Gt)];g&&wn.push(U("beta",e[3].dataType,e[3].dims,Gt)),st&&wn.push(U("bias",e[4].dataType,e[4].dims,Gt)),wn.push(K("output",e[0].dataType,$,Gt)),$t&&wn.push(K("mean_output",1,b)),vt&&wn.push(K("inv_std_output",1,b)),Ft&&wn.push(K("input_skip_bias_sum",e[0].dataType,$,Gt));let _n=De(e[0].dataType);return`

      ${jr.registerUniforms(Hr).declareVariables(...wn)}

      ${jr.mainStart()}
        ${jr.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size / uniforms.hidden_size")}
        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;
        let offset = global_idx * hidden_size_vectorized;
        var sum = ${At("f32",Gt)};
        var squareSum = ${At("f32",Gt)};
        for (var i: u32 = 0; i < hidden_size_vectorized; i++) {
          let skip_value = skip[offset + i];
          let bias_value = ${st?"bias[i]":_n+"(0.0)"};
          let input_value = x[offset + i];
          let value = input_value + skip_value + bias_value;
          ${Ft?"input_skip_bias_sum[offset + i] = value;":""}
          output[offset + i] = value;
          let f32_value = ${fr(_n,Gt,"value")};
          sum += f32_value;
          squareSum += f32_value * f32_value;
        }
        let mean = ${Et("sum",Gt)} / f32(uniforms.hidden_size);
        let inv_std_dev = inverseSqrt(${Et("squareSum",Gt)} / f32(uniforms.hidden_size) ${c?"":"- mean * mean"} + uniforms.epsilon);
        ${$t?"mean_output[global_idx] = mean;":""}
        ${vt?"inv_std_output[global_idx] = inv_std_dev;":""}
        for (var i: u32 = 0; i < hidden_size_vectorized; i++) {
          output[offset + i] = (output[offset + i] ${c?"":`- ${_n}(mean)`}) * ${_n}(inv_std_dev) * gamma[i] ${g?"+ beta[i]":""};
        }
      }`},rr=[{dims:$,dataType:e[0].dataType}];return a>1&&rr.push({dims:b,dataType:1}),a>2&&rr.push({dims:b,dataType:1}),a>3&&rr.push({dims:s,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:`${Gt};${$t};${vt};${Ft}`,inputDependencies:e.map((jr,Hr)=>"type")},getShaderSource:Lt,getRunData:()=>({outputs:rr,dispatchGroup:{x:Math.ceil(et/h/64)},programUniforms:qt})}},ad=(e,i)=>{Nm(e.inputs);let a=[0];e.outputCount>1&&a.push(-3),e.outputCount>2&&a.push(-3),e.outputCount>3&&a.push(3),e.compute(Vm(e.inputs,i,e.outputCount,!1),{outputs:a})}}),Hm,ui,Gm,ud,Lm,Fm,ld,dd,cd=j(()=>{ye(),xe(),Ze(),_e(),Hm=(e,i)=>{if(!e||e.length<1)throw new Error("too few inputs");if(i.axes.length!==0){if(i.axes.length!==i.starts.length||i.axes.length!==i.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(i.starts.length!==i.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach((a,o)=>{if(e[o+1].dataType!==6&&e[o+1].dataType!==7)throw new Error(`Input ${o} must be an array of int32 or int64`)})},ui=(e,i)=>{let a=[];if(e.length>i)if(e[i].dataType===7)e[i].getBigInt64Array().forEach(o=>a.push(Number(o)));else if(e[i].dataType===6)e[i].getInt32Array().forEach(o=>a.push(Number(o)));else throw new Error(`Input ${i} must be an array of int32 or int64`);return a},Gm=(e,i)=>{if(e.length>1){let a=ui(e,1),o=ui(e,2),c=ui(e,3);return c.length===0&&(c=[...Array(e[0].dims.length).keys()]),we({starts:a,ends:o,axes:c})}else return i},ud=(e,i,a,o,c)=>{let s=e;return e<0&&(s+=a[o[i]]),c[i]<0?Math.max(0,Math.min(s,a[o[i]]-1)):Math.max(0,Math.min(s,a[o[i]]))},Lm=(e,i,a)=>`fn calculateInputIndices(output_indices: ${i.type.indices}) -> ${e.type.indices} {
          var input_indices: ${e.type.indices};
          var carry = 0u;
          for (var i = ${a.length}; i >= 0; i--) {
            let input_shape_i = ${fe("uniforms.input_shape","i",a.length)};
            let steps_i = ${fe("uniforms.steps","i",a.length)};
            let signs_i = ${fe("uniforms.signs","i",a.length)};
            let starts_i = ${fe("uniforms.starts","i",a.length)};
            var output_index = ${i.indicesGet("output_indices","i")};
            var input_index = output_index * steps_i + starts_i + carry;
            carry = input_index / input_shape_i;
            input_index = input_index % input_shape_i;
            if (signs_i < 0) {
              input_index = input_shape_i - input_index - 1u + starts_i;
            }
            ${e.indicesSet("input_indices","i","input_index")};
          }
          return input_indices;
      }`,Fm=(e,i)=>{let a=e[0].dims,o=M.size(a),c=i.axes.length>0?M.normalizeAxes(i.axes,a.length):[...Array(a.length).keys()],s=ui(e,4);s.forEach(qt=>qt!==0||(()=>{throw new Error("step cannot be 0")})),s.length===0&&(s=Array(c.length).fill(1));let d=i.starts.map((qt,Lt)=>ud(qt,Lt,a,c,s)),$=i.ends.map((qt,Lt)=>ud(qt,Lt,a,c,s));if(c.length!==d.length||c.length!==$.length)throw new Error("start, ends and axes should have the same number of elements");if(c.length!==a.length)for(let qt=0;qt<a.length;++qt)c.includes(qt)||(d.splice(qt,0,0),$.splice(qt,0,a[qt]),s.splice(qt,0,1));let et=s.map(qt=>Math.sign(qt));s.forEach((qt,Lt,rr)=>{if(qt<0){let jr=($[Lt]-d[Lt])/qt,Hr=d[Lt],wn=Hr+jr*s[Lt];d[Lt]=wn,$[Lt]=Hr,rr[Lt]=-qt}});let h=a.slice(0);c.forEach((qt,Lt)=>{h[qt]=Math.ceil(($[qt]-d[qt])/s[qt])});let b={dims:h,dataType:e[0].dataType},g=K("output",e[0].dataType,h.length),st=U("input",e[0].dataType,e[0].dims.length),$t=M.size(h),vt=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:d.length},{name:"signs",type:"i32",length:et.length},{name:"steps",type:"u32",length:s.length}],Ft=[{type:12,data:$t},{type:12,data:d},{type:6,data:et},{type:12,data:s},...X(e[0].dims,h)],Gt=qt=>`
      ${qt.registerUniforms(vt).declareVariables(st,g)}
        ${Lm(st,g,a)}
        ${qt.mainStart()}
          ${qt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
          let output_indices = ${g.offsetToIndices("global_idx")};
          let input_indices = calculateInputIndices(output_indices);
          ${g.setByOffset("global_idx",st.getByIndices("input_indices"))}
      }`;return{name:"Slice",shaderCache:{hint:`${et.length}_${d.length}_${s.length}`,inputDependencies:["rank"]},getShaderSource:Gt,getRunData:()=>({outputs:[b],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:Ft})}},ld=(e,i)=>{Hm(e.inputs,i);let a=Gm(e.inputs,i);e.compute(Fm(e.inputs,a),{inputs:[0]})},dd=e=>{let i=e.starts,a=e.ends,o=e.axes;return we({starts:i,ends:a,axes:o})}}),qm,jm,pd,md,fd=j(()=>{ye(),xe(),Ze(),_e(),qm=e=>{if(!e||e.length!==1)throw new Error("Softmax op requires 1 input.")},jm=(e,i)=>{let a=e.dims,o=M.size(a),c=64,s=i.axis;if(s<0&&(s=a.length+s),s<a.length-1)throw new Error("softmax only supports last axis for now.");let d=a[s],$=o/d,et=Ue(d),h=d/et,b=(Gt,qt)=>qt===4?`max(max(${Gt}.x, ${Gt}.y), max(${Gt}.z, ${Gt}.w))`:qt===2?`max(${Gt}.x, ${Gt}.y)`:qt===3?`max(max(${Gt}.x, ${Gt}.y), ${Gt}.z)`:Gt,g=U("x",e.dataType,e.dims,et),st=K("result",e.dataType,e.dims,et),$t=g.type.value,vt=De(e.dataType)==="f32"?`var threadMax = ${$t}(-3.402823e+38f);`:`var threadMax = ${$t}(-65504.0h);`,Ft=Gt=>`
      var<workgroup> rowMaxShared : ${$t};
      var<workgroup> rowSumShared : ${$t};
      var<workgroup> threadShared : array<${$t}, ${c}>;

      fn getValue(row: i32, col: i32, row_stride: i32) -> ${$t} {
        let index = row * row_stride + col;
        return x[index];
      }

      fn setValue(row: i32, col: i32, row_stride: i32, value: ${$t}) {
        let index = row * row_stride + col;
        result[index] = value;
      }
      ${Gt.registerUniform("packedCols","i32").declareVariables(g,st)}
      ${Gt.mainStart()}
        let gindex = i32(global_idx);
        let lindex = i32(local_idx);
        const wg = ${c};
        let row = gindex / wg;
        let cols = uniforms.packedCols;
        let row_stride : i32 = uniforms.packedCols;

        // find the rows max
        ${vt}
        for (var col = lindex; col < cols; col += wg) {
          let value = getValue(row, col, row_stride);
          threadMax = max(threadMax, value);
        }
        if (lindex < cols) {
          threadShared[lindex] = threadMax;
        }
        workgroupBarrier();

        var reduceSize = min(cols, wg);
        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
          reduceSize = currSize + (reduceSize & 1);
          if (lindex < currSize) {
            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowMaxShared = ${$t}(${b("threadShared[0]",et)});
        }
        workgroupBarrier();

        // find the rows sum
        var threadSum = ${$t}(0.0);
        for (var col = lindex; col < cols; col += wg) {
          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);
          threadSum += subExp;
        }
        threadShared[lindex] = threadSum;
        workgroupBarrier();

        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {
          if (lindex < currSize) {
            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowSumShared = ${$t}(${Et("threadShared[0]",et)});
        }
        workgroupBarrier();

        // calculate final value for each element in the row
        for (var col = lindex; col < cols; col += wg) {
          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;
          setValue(row, col, row_stride, value);
        }
      }`;return{name:"Softmax",shaderCache:{hint:`${et}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:a,dataType:e.dataType}],dispatchGroup:{x:$},programUniforms:[{type:6,data:h}]}),getShaderSource:Ft}},pd=(e,i)=>{qm(e.inputs),e.compute(jm(e.inputs[0],i))},md=e=>we({axis:e.axis})}),Km,Ym,Xm,Zm,Qm,hd,gd,yd=j(()=>{ye(),xe(),Ze(),_e(),Km=e=>{if(!e||e.length<1)throw new Error("too few inputs")},Ym=(e,i)=>{let a=[],o=i.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach(c=>a.push(Number(c))),o=a.length),we({numOutputs:o,axis:i.axis,splitSizes:a})},Xm=e=>`
fn calculateOutputIndex(index: u32) -> u32 {
    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {
    if (index < ${fe("uniforms.size_in_split_axis","i",e)}) {
        return i;
    }
    }
    return ${e}u;
}`,Zm=e=>{let i=e.length,a=[];for(let o=0;o<i;++o){let c=e[o].setByIndices("indices","input[global_idx]");i===1?a.push(c):o===0?a.push(`if (output_number == ${o}u) { ${c} }`):o===i-1?a.push(`else { ${c} }`):a.push(`else if (output_number == ${o}) { ${c} }`)}return`
      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {
        ${a.join(`
`)}
      }`},Qm=(e,i)=>{let a=e[0].dims,o=M.size(a),c=e[0].dataType,s=M.normalizeAxis(i.axis,a.length),d=new Array(i.numOutputs),$=U("input",c,a.length),et=new Array(i.numOutputs),h=[],b=[],g=0,st=[{type:12,data:o}];for(let vt=0;vt<i.numOutputs;vt++){g+=i.splitSizes[vt],et[vt]=g;let Ft=a.slice();Ft[i.axis]=i.splitSizes[vt],b.push(Ft),d[vt]=K(`output${vt}`,c,Ft.length),h.push({dims:b[vt],dataType:e[0].dataType})}st.push({type:12,data:et},...X(a,...b));let $t=vt=>`
  ${vt.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",et.length).declareVariables($,...d)}
  ${Xm(et.length)}
  ${Zm(d)}

  ${vt.mainStart()}
    ${vt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}

    var indices = ${$.offsetToIndices("global_idx")};
    var index = ${$.indicesGet("indices",s)};
    let output_number = calculateOutputIndex(index);
    if (output_number != 0) {
      index -= ${fe("uniforms.size_in_split_axis","output_number - 1u",et.length)};
      ${$.indicesSet("indices",s,"index")};
    }
    writeBufferData(output_number, indices, global_idx);
  }`;return{name:"Split",shaderCache:{hint:i.cacheKey,inputDependencies:["rank"]},getShaderSource:$t,getRunData:()=>({outputs:h,dispatchGroup:{x:Math.ceil(o/64)},programUniforms:st})}},hd=(e,i)=>{Km(e.inputs);let a=e.inputs.length===1?i:Ym(e.inputs,i);e.compute(Qm(e.inputs,a),{inputs:[0]})},gd=e=>{let i=e.axis,a=e.splitSizes,o=e.numOutputs<0?a.length:e.numOutputs;if(o!==a.length)throw new Error("numOutputs and splitSizes lengh must be equal");return we({axis:i,numOutputs:o,splitSizes:a})}}),bd,Jm,ef,tf,vd,wd=j(()=>{ye(),xe(),_e(),bd=e=>Array.from(e.getBigInt64Array(),Number),Jm=e=>{if(!e||e.length!==2)throw new Error("Tile requires 2 inputs.");if(e[0].dataType!==1&&e[0].dataType!==6&&e[0].dataType!==12)throw new Error("Tile only support float, int32, and uint32 data types");if(e[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(e[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(bd(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},ef=(e,i)=>{let a=[];for(let o=0;o<e.length;++o)a.push(e[o]*i[o]);return a},tf=e=>{let i=e[0].dims,a=bd(e[1]),o=ef(i,a),c=M.size(o),s=e[0].dataType,d=U("input",s,i.length),$=K("output",s,o.length),et=h=>`
      const inputShape = ${d.indices(...i)};
      ${h.registerUniform("output_size","u32").declareVariables(d,$)}
      ${h.mainStart()}
      ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let output_indices = ${$.offsetToIndices("global_idx")};
      var input_indices: ${d.type.indices};
      for (var i = 0; i < ${i.length}; i++) {
        let input_dim_i = ${d.indicesGet("uniforms.input_shape","i")};
        let input_dim_value = ${$.indicesGet("output_indices","i")}  % input_dim_i;

        ${d.indicesSet("input_indices","i","input_dim_value")}
      }
      ${$.setByOffset("global_idx",d.getByIndices("input_indices"))}
    }`;return{name:"Tile",shaderCache:{hint:`${a}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(c/64)},programUniforms:[{type:12,data:c},...X(e[0].dims,o)]}),getShaderSource:et}},vd=e=>{Jm(e.inputs),e.compute(tf(e.inputs),{inputs:[0]})}}),rf,nf,$d,_d=j(()=>{ye(),xe(),_e(),rf=(e,i,a,o,c)=>{let s=K("output_data",c,a.length,4),d=U("a_data",i[1].dataType,i[1].dims.length,4),$=U("b_data",i[2].dataType,i[2].dims.length,4),et=U("c_data",i[0].dataType,i[0].dims.length,4),h,b=(g,st,$t)=>`select(${st}, ${g}, ${$t})`;if(!o)h=s.setByOffset("global_idx",b(d.getByOffset("global_idx"),$.getByOffset("global_idx"),et.getByOffset("global_idx")));else{let g=(st,$t,vt="")=>{let Ft=`a_data[index_a${$t}][component_a${$t}]`,Gt=`b_data[index_b${$t}][component_b${$t}]`,qt=`bool(c_data[index_c${$t}] & (0xffu << (component_c${$t} * 8)))`;return`
            let output_indices${$t} = ${s.offsetToIndices(`global_idx * 4u + ${$t}u`)};
            let offset_a${$t} = ${d.broadcastedIndicesToOffset(`output_indices${$t}`,s)};
            let offset_b${$t} = ${$.broadcastedIndicesToOffset(`output_indices${$t}`,s)};
            let offset_c${$t} = ${et.broadcastedIndicesToOffset(`output_indices${$t}`,s)};
            let index_a${$t} = offset_a${$t} / 4u;
            let index_b${$t} = offset_b${$t} / 4u;
            let index_c${$t} = offset_c${$t} / 4u;
            let component_a${$t} = offset_a${$t} % 4u;
            let component_b${$t} = offset_b${$t} % 4u;
            let component_c${$t} = offset_c${$t} % 4u;
            ${st}[${$t}] = ${vt}(${b(Ft,Gt,qt)});
          `};c===9?h=`
            var data = vec4<u32>(0);
            ${g("data",0,"u32")}
            ${g("data",1,"u32")}
            ${g("data",2,"u32")}
            ${g("data",3,"u32")}
            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:h=`
            ${g("output_data[global_idx]",0)}
            ${g("output_data[global_idx]",1)}
            ${g("output_data[global_idx]",2)}
            ${g("output_data[global_idx]",3)}
          `}return`
        ${e.registerUniform("vec_size","u32").declareVariables(et,d,$,s)}
        ${e.mainStart()}
        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${h}
      }`},nf=e=>{let i=e[1].dims,a=e[2].dims,o=e[0].dims,c=e[1].dataType,s=!(M.areEqual(i,a)&&M.areEqual(a,o)),d=i,$=M.size(i);if(s){let h=zt.calcShape(zt.calcShape(i,a,!1),o,!1);if(!h)throw new Error("Can't perform where op on the given tensors");d=h,$=M.size(d)}let et=Math.ceil($/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:h=>rf(h,e,d,s,c),getRunData:()=>({outputs:[{dims:d,dataType:c}],dispatchGroup:{x:Math.ceil($/64/4)},programUniforms:[{type:12,data:et},...X(o,i,a,d)]})}},$d=e=>{e.compute(nf(e.inputs))}}),xd,Sd=j(()=>{zs(),oo(),Ws(),Vs(),Cu(),Du(),io(),co(),Xu(),Ju(),rl(),sl(),dl(),pl(),hl(),bl(),$l(),xl(),Cl(),mo(),Al(),Pl(),zl(),Zl(),Jl(),jn(),nd(),od(),sd(),cd(),fd(),yd(),wd(),Rr(),Jn(),_d(),xd=new Map([["Abs",[Hs]],["Acos",[Gs]],["Acosh",[Ls]],["Add",[Iu]],["ArgMax",[Rs,no]],["ArgMin",[Ps,no]],["Asin",[Fs]],["Asinh",[qs]],["Atan",[js]],["Atanh",[Ks]],["Attention",[Ms]],["AveragePool",[Hl,Vl]],["BatchNormalization",[Us]],["BiasAdd",[Ns]],["BiasSplitGelu",[Su]],["Cast",[Xs,Ys]],["Ceil",[Qs]],["Clip",[Zs]],["Concat",[Bs,Ds]],["Conv",[go,ho]],["ConvTranspose",[Yu,Ku]],["Cos",[Js]],["Cosh",[eu]],["CumSum",[Zu,Qu]],["DepthToSpace",[el,tl]],["Div",[Tu]],["Einsum",[ol,al]],["Elu",[tu,Zn]],["Equal",[Au]],["Erf",[ru]],["Exp",[nu]],["Expand",[ll]],["FastGelu",[cl]],["Floor",[iu]],["FusedConv",[go,ho]],["Gather",[fl,ml]],["GatherElements",[yl,gl]],["Gelu",[ou]],["Gemm",[wl,vl]],["GlobalAveragePool",[Fl,Ll]],["GlobalMaxPool",[Xl,Yl]],["Greater",[Pu]],["GreaterOrEqual",[zu]],["HardSigmoid",[mu,pu]],["InstanceNormalization",[_l]],["LayerNormalization",[Sl]],["LeakyRelu",[au,Zn]],["Less",[Ru]],["LessOrEqual",[Bu]],["Log",[_u]],["MatMul",[Hu]],["MatMulNBits",[Il,Tl]],["MaxPool",[jl,Kl]],["Mul",[Eu]],["MultiHeadAttention",[Ol,kl]],["Neg",[uu]],["Not",[su]],["Pad",[Rl]],["Pow",[ku]],["Range",[Ql]],["Reciprocal",[lu]],["ReduceMin",[Is]],["ReduceMean",[$s]],["ReduceMax",[Cs]],["ReduceSum",[As]],["ReduceProd",[Ts]],["ReduceL1",[_s]],["ReduceL2",[xs]],["ReduceLogSum",[ks]],["ReduceLogSumExp",[Ss]],["ReduceSumSquare",[Es]],["Relu",[du]],["Resize",[td,rd]],["RotaryEmbedding",[id$1]],["Sigmoid",[cu]],["Sin",[fu]],["Sinh",[hu]],["Slice",[ld,dd]],["SkipLayerNormalization",[ad]],["Split",[hd,gd]],["Sqrt",[gu]],["Softmax",[pd,md]],["Sub",[Ou]],["Tan",[yu]],["Tanh",[vu]],["ThresholdedRelu",[$u,Zn]],["Tile",[vd]],["Transpose",[us,ls]],["Where",[$d]]])}),li,Cd=j(()=>{_t(),Xt(),_e(),li=class{constructor(e){this.backend=e,this.repo=new Map,this.attributesBound=!1}getArtifact(e){return this.repo.get(e)}setArtifact(e,i){this.repo.set(e,i)}run(e,i,a,o,c){yt(e.programInfo.name);let s=this.backend.device,d=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2);let $=[];for(let h of i)$.push({binding:$.length,resource:{buffer:h.buffer}});for(let h of a)$.push({binding:$.length,resource:{buffer:h.buffer}});c&&$.push({binding:$.length,resource:c});let et=s.createBindGroup({layout:e.computePipeline.getBindGroupLayout(0),entries:$,label:e.programInfo.name});if(this.backend.sessionStatus==="capturing"){let h={kernelId:this.backend.currentKernelId,computePipeline:e.computePipeline,bindGroup:et,dispatchGroup:o};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(h)}d.setPipeline(e.computePipeline),d.setBindGroup(0,et),d.dispatchWorkgroups(...o),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),ut(e.programInfo.name)}dispose(){}build(e,i){yt(e.name);let a=this.backend.device,o=[];a.features.has("shader-f16")&&o.push("enable f16;");let c=as(i,this.backend.device.limits),s=e.getShaderSource(c),d=`${o.join(`
`)}
${c.additionalImplementations}
${s}`,$=a.createShaderModule({code:d,label:e.name});Ne("verbose",()=>`[WebGPU] ${e.name} shader code: ${d}`);let et=a.createComputePipeline({compute:{module:$,entryPoint:"main"},layout:"auto",label:e.name});return ut(e.name),{programInfo:e,computePipeline:et,uniformVariablesInfo:c.variablesInfo}}normalizeDispatchGroupSize(e){let i=typeof e=="number"?e:e.x,a=typeof e=="number"?1:e.y||1,o=typeof e=="number"?1:e.z||1,c=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(i<=c&&a<=c&&o<=c)return[i,a,o];let s=i*a*o,d=Math.ceil(Math.sqrt(s));if(d>c){if(d=Math.ceil(Math.cbrt(s)),d>c)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[d,d,d]}else return[d,d,1]}}}),of,af,_o,di,Id=j(()=>{_t(),ye(),Xt(),es(),os(),Sd(),Cd(),of=(e,i)=>{if(i.length!==e.length)throw new Error(`inputDependencies length ${i.length} is not equal to inputTensors length ${e.length}.`);let a=[];for(let o=0;o<e.length;++o){let c=e[o].dataType;switch(i[o]){case"none":{a.push("");break}case"type":{a.push(`${c}`);break}case"rank":{let s=e[o].dims.length;a.push(`${c};${s}`);break}case"dims":{let s=e[o].dims.join(",");a.push(`${c};${s}`);break}default:throw new Error(`unsupported input dependency: ${i[o]}`)}}return a.join("|")},af=(e,i,a)=>{var c,s;let o=e.name;return(c=e.shaderCache)!=null&&c.hint&&(o+="["+e.shaderCache.hint+"]"),o+=":"+a+`:${of(i,((s=e.shaderCache)==null?void 0:s.inputDependencies)??new Array(i.length).fill("dims"))}`,o},_o=class{constructor(e){e&&(this.architecture=e.architecture,this.vendor=e.vendor)}isArchitecture(e){return this.architecture===e}isVendor(e){return this.vendor===e}},di=class{constructor(){this.currentSessionId=null,this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionStatus="default",this.capturedCommandList=new Map,this.capturedPendingKernels=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let e=this.kernelCustomData.get(this.currentKernelId);return e||(e={},this.kernelCustomData.set(this.currentKernelId,e)),e}async initialize(e,i){this.env=e;let a=[],o={requiredLimits:{maxComputeWorkgroupStorageSize:i.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:i.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:i.limits.maxStorageBufferBindingSize,maxBufferSize:i.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:i.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:i.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:i.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:i.limits.maxComputeWorkgroupSizeZ},requiredFeatures:a};i.features.has("chromium-experimental-timestamp-query-inside-passes")?a.push("chromium-experimental-timestamp-query-inside-passes"):i.features.has("timestamp-query")&&a.push("timestamp-query"),i.features.has("shader-f16")&&a.push("shader-f16"),this.device=await i.requestDevice(o),this.adapterInfo=new _o(await i.requestAdapterInfo()),this.gpuDataManager=is(this),this.programManager=new li(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,Qa(e.logLevel,!!e.debug),this.device.onuncapturederror=c=>{c.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${c.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:i,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let e=this.getCommandEncoder(),i={};this.queryType==="at-passes"&&(i.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=e.beginComputePass(i)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;yt(),this.endComputePass();let e;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),e=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(e,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,e,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&e.mapAsync(GPUMapMode.READ).then(()=>{var o;let i=new BigUint64Array(e.getMappedRange()),a=this.pendingQueries.get(e);for(let c=0;c<i.length/2;c++){let s=a[c],d=s.kernelId,$=this.kernels.get(d),et=$.kernelType,h=$.kernelName,b=s.programName,g=s.inputTensorViews,st=s.outputTensorViews,$t=i[c*2],vt=i[c*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=$t);let Ft=Number($t-this.queryTimeBase),Gt=Number(vt-this.queryTimeBase);if(!Number.isSafeInteger(Ft)||!Number.isSafeInteger(Gt))throw new RangeError("incorrect timestamp range");if((o=this.env.webgpu.profiling)!=null&&o.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:g.map(qt=>({dims:qt.dims,dataType:Yt(qt.dataType)})),outputsMetadata:st.map(qt=>({dims:qt.dims,dataType:Yt(qt.dataType)})),kernelId:d,kernelType:et,kernelName:h,programName:b,startTime:Ft,endTime:Gt});else{let qt="";g.forEach((rr,jr)=>{qt+=`input[${jr}]: [${rr.dims}] | ${Yt(rr.dataType)}, `});let Lt="";st.forEach((rr,jr)=>{Lt+=`output[${jr}]: [${rr.dims}] | ${Yt(rr.dataType)}, `}),console.log(`[profiling] kernel "${d}|${et}|${h}|${b}" ${qt}${Lt}execution time: ${Gt-Ft} ns`)}Bn("GPU",`${b}::${$t}::${vt}`)}e.unmap(),this.pendingQueries.delete(e)}),ut()}run(e,i,a,o,c,s){yt(e.name);let d=[];for(let Lt=0;Lt<i.length;++Lt){let rr=i[Lt].data;if(rr===0)continue;let jr=this.gpuDataManager.get(rr);if(!jr)throw new Error(`no GPU data for input: ${rr}`);d.push(jr)}let{outputs:$,dispatchGroup:et,programUniforms:h}=e.getRunData(i),b=a.length===0?$.map((Lt,rr)=>rr):a;if(b.length!==$.length)throw new Error(`Output size ${b.length} must be equal to ${$.length}.`);let g=[],st=[];for(let Lt=0;Lt<$.length;++Lt){if(!Number.isInteger(b[Lt])||b[Lt]<-3||b[Lt]>=s)throw new Error(`Invalid output index: ${b[Lt]}`);if(b[Lt]===-3)continue;let rr=b[Lt]===-1,jr=b[Lt]===-2,Hr=rr||jr?c($[Lt].dataType,$[Lt].dims):o(b[Lt],$[Lt].dataType,$[Lt].dims);if(g.push(Hr),Hr.data===0)continue;let wn=this.gpuDataManager.get(Hr.data);if(!wn)throw new Error(`no GPU data for output: ${Hr.data}`);if(rr&&this.temporaryData.push(wn),jr){let _n=this.kernelPersistentData.get(this.currentKernelId);_n||(_n=[],this.kernelPersistentData.set(this.currentKernelId,_n)),_n.push(wn)}st.push(wn)}if(d.length!==i.length||st.length!==g.length){if(st.length===0)return ut(e.name),g;throw new Error(`Program ${e.name} has zero-sized tensor(s) in inputs or outputs. This is not supported now.`)}let $t;if(h){let Lt=0,rr=[];h.forEach(_n=>{let No=typeof _n.data=="number"?[_n.data]:_n.data;if(No.length===0)return;let Qo=_n.type===10?2:4,Xo,l0;_n.type===10?(l0=No.length>4?16:No.length>2?8:No.length*Qo,Xo=No.length>4?16:Qo*No.length):(l0=No.length<=2?No.length*Qo:16,Xo=16),Lt=Math.ceil(Lt/l0)*l0,rr.push(Lt);let v0=_n.type===10?8:4;Lt+=No.length>4?Math.ceil(No.length/v0)*Xo:No.length*Qo});let jr=16;Lt=Math.ceil(Lt/jr)*jr;let Hr=new ArrayBuffer(Lt);h.forEach((_n,No)=>{let Qo=rr[No],Xo=typeof _n.data=="number"?[_n.data]:_n.data;if(_n.type===6)new Int32Array(Hr,Qo,Xo.length).set(Xo);else if(_n.type===12)new Uint32Array(Hr,Qo,Xo.length).set(Xo);else if(_n.type===10)new Uint16Array(Hr,Qo,Xo.length).set(Xo);else if(_n.type===1)new Float32Array(Hr,Qo,Xo.length).set(Xo);else throw new Error(`Unsupported uniform type: ${Yt(_n.type)}`)});let wn=this.gpuDataManager.create(Lt,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(wn.buffer,0,Hr,0,Lt),this.gpuDataManager.release(wn.id),$t={offset:0,size:Lt,buffer:wn.buffer}}let vt=this.programManager.normalizeDispatchGroupSize(et),Ft=vt[1]===1&&vt[2]===1,Gt=af(e,i,Ft),qt=this.programManager.getArtifact(Gt);if(qt||(qt=this.programManager.build(e,vt),this.programManager.setArtifact(Gt,qt),Ne("info",()=>`[artifact] key: ${Gt}, programName: ${e.name}`)),h&&qt.uniformVariablesInfo){if(h.length!==qt.uniformVariablesInfo.length)throw new Error(`Uniform variables count mismatch: expect ${qt.uniformVariablesInfo.length}, got ${h.length} in program "${qt.programInfo.name}".`);for(let Lt=0;Lt<h.length;Lt++){let rr=h[Lt],jr=rr.type,Hr=typeof rr.data=="number"?1:rr.data.length,[wn,_n]=qt.uniformVariablesInfo[Lt];if(jr!==wn||Hr!==_n)throw new Error(`Uniform variable ${Lt} mismatch: expect type ${wn} with size ${_n}, got type ${jr} with size ${Hr} in program "${qt.programInfo.name}".`)}}if(Ne("info",()=>`[ProgramManager] run "${e.name}" (key=${Gt}) with ${vt[0]}x${vt[1]}x${vt[2]}`),this.queryType!=="none"||this.sessionStatus==="capturing"){let Lt={kernelId:this.currentKernelId,programName:qt.programInfo.name,inputTensorViews:i,outputTensorViews:g};this.pendingKernels.push(Lt),this.sessionStatus==="capturing"&&this.capturedPendingKernels.get(this.currentSessionId).push(Lt)}return this.programManager.run(qt,d,st,vt,$t),ut(e.name),g}upload(e,i){this.gpuDataManager.upload(e,i)}memcpy(e,i){this.gpuDataManager.memcpy(e,i)}async download(e,i){await this.gpuDataManager.download(e,i)}alloc(e){return this.gpuDataManager.create(e).id}free(e){return this.gpuDataManager.release(e)}createKernel(e,i,a,o){let c=xd.get(e);if(!c)throw new Error(`kernel not implemented: ${e}`);let s={kernelType:e,kernelName:o,kernelEntry:c[0],attributes:[c[1],a]};this.kernels.set(i,s)}releaseKernel(e){let i=this.kernelPersistentData.get(e);if(i){for(let a of i)this.gpuDataManager.release(a.id);this.kernelPersistentData.delete(e)}this.kernelCustomData.delete(e),this.kernels.delete(e)}computeKernel(e,i,a){let o=this.kernels.get(e);if(!o)throw new Error(`kernel not created: ${e}`);let c=o.kernelType,s=o.kernelName,d=o.kernelEntry,$=o.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${c}] ${s}" is not allowed to be called recursively`);this.currentKernelId=e,$[0]&&($[1]=$[0]($[1]),$[0]=void 0),Ne("info",()=>`[WebGPU] Start to run kernel "[${c}] ${s}"...`);let et=this.env.debug;this.temporaryData=[];try{return et&&this.device.pushErrorScope("validation"),d(i,$[1]),0}catch(h){return a.push(Promise.resolve(`[WebGPU] Kernel "[${c}] ${s}" failed. ${h}`)),1}finally{et&&a.push(this.device.popErrorScope().then(h=>h?`GPU validation error for kernel "[${c}] ${s}": ${h.message}`:null));for(let h of this.temporaryData)this.gpuDataManager.release(h.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(e,i,a,o){let c=this.sessionExternalDataMapping.get(e);c||(c=new Map,this.sessionExternalDataMapping.set(e,c));let s=c.get(i),d=this.gpuDataManager.registerExternalBuffer(a,o,s==null?void 0:s[1]);return c.set(i,[d,a]),d}unregisterBuffers(e){let i=this.sessionExternalDataMapping.get(e);i&&(i.forEach(a=>this.gpuDataManager.unregisterExternalBuffer(a[1])),this.sessionExternalDataMapping.delete(e))}getBuffer(e){let i=this.gpuDataManager.get(e);if(!i)throw new Error(`no GPU data for buffer: ${e}`);return i.buffer}createDownloader(e,i,a){return async()=>{let o=await Xi(this,e,i);return Ja(o.buffer,a)}}writeTimestamp(e){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,e)}setQueryType(){var e;this.queryType="none",(((e=this.env.webgpu.profiling)==null?void 0:e.mode)==="default"||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){Ne("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){Ne("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){Ne("info","replay"),this.sessionStatus="replaying";let e=this.capturedCommandList.get(this.currentSessionId),i=this.capturedPendingKernels.get(this.currentSessionId),a=e.length;this.pendingKernels=[];for(let o=0;o<a;o++){let c=this.getComputePassEncoder(),s=e[o];this.writeTimestamp(this.pendingDispatchNumber*2),c.setPipeline(s.computePipeline),c.setBindGroup(0,s.bindGroup),c.dispatchWorkgroups(...s.dispatchGroup),this.writeTimestamp(this.pendingDispatchNumber*2+1),this.pendingDispatchNumber++,this.queryType!=="none"&&this.pendingKernels.push(i[o]),(this.pendingDispatchNumber>=this.maxDispatchNumber||this.queryType==="at-passes")&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onReleaseSession(e){this.unregisterBuffers(e),this.capturedCommandList.has(e)&&this.capturedCommandList.delete(e),this.capturedPendingKernels.has(e)&&this.capturedPendingKernels.delete(e),this.gpuDataManager.onReleaseSession(e)}onRunStart(e){this.currentSessionId=e,this.setQueryType()}}}),Td={};kr(Td,{init:()=>sf});var an,xo,sf,Ad=j(()=>{ye(),Id(),Xt(),xe(),an=class qx{constructor(i,a,o,c){this.module=i,this.dataType=a,this.data=o,this.dims=c}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let i=M.size(this.dims);return i===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,i)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let i=M.size(this.dims);return i===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,i)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let i=M.size(this.dims);return i===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,i)}reshape(i){if(M.size(i)!==M.size(this.dims))throw new Error("Invalid new shape");return new qx(this.module,this.dataType,this.data,i)}},xo=class{constructor(e,i,a){this.module=e,this.backend=i,this.customDataOffset=0,this.customDataSize=0,this.adapterInfo=i.adapterInfo;let o=e.HEAPU32,c=a>>>2;this.opKernelContext=o[c++];let s=o[c++];this.outputCount=o[c++],this.customDataOffset=o[c++],this.customDataSize=o[c++];let d=[];for(let $=0;$<s;$++){let et=o[c++],h=o[c++],b=o[c++],g=[];for(let st=0;st<b;st++)g.push(o[c++]);d.push(new an(e,et,h,g))}this.inputs=d}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}getMaxComputeWorkgroupSizes(){return[this.backend.device.limits.maxComputeWorkgroupSizeX,this.backend.device.limits.maxComputeWorkgroupSizeY,this.backend.device.limits.maxComputeWorkgroupSizeZ]}getMaxComputeWorkgroupStoragesize(){return this.backend.device.limits.maxComputeWorkgroupStorageSize}compute(e,i){var d;let a=((d=i==null?void 0:i.inputs)==null?void 0:d.map($=>typeof $=="number"?this.inputs[$]:$))??this.inputs,o=(i==null?void 0:i.outputs)??[],c=($,et,h)=>new an(this.module,et,this.output($,h),h),s=($,et)=>{let h=cr($);if(!h)throw new Error(`Unsupported data type: ${$}`);let b=h*M.size(et),g=b>0?this.backend.gpuDataManager.create(b).id:0;return new an(this.module,$,g,et)};return this.backend.run(e,a,o,c,s,this.outputCount)}output(e,i){let a=this.module.stackSave();try{let o=this.module.stackAlloc((1+i.length)*4),c=o>>2;this.module.HEAPU32[c++]=i.length;for(let s=0;s<i.length;s++)this.module.HEAPU32[c++]=i[s];return this.module._JsepOutput(this.opKernelContext,e,o)}catch(o){throw new Error(`Failed to generate kernel's output[${e}] with dims [${i}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${o}`)}finally{this.module.stackRestore(a)}}},sf=async(e,i,a,o)=>{let c=i.jsepInit;if(!c)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if(e==="webgpu"){let s=new di;await s.initialize(a,o),c("webgpu",[s,d=>s.alloc(d),d=>s.free(d),(d,$,et,h=!1)=>{if(h)Ne("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${d}, dst=${$}, size=${et}`),s.memcpy(d,$);else{Ne("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${d}, gpuDataId=${$}, size=${et}`);let b=i.HEAPU8.subarray(d>>>0,(d>>>0)+et);s.upload($,b)}},async(d,$,et)=>{Ne("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${d}, dataOffset=${$}, size=${et}`),await s.download(d,()=>i.HEAPU8.subarray($>>>0,($>>>0)+et))},(d,$,et)=>s.createKernel(d,$,et,i.UTF8ToString(i._JsepGetNodeName($))),d=>s.releaseKernel(d),(d,$,et,h)=>{Ne("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${et}, kernel=${d}, contextDataOffset=${$}`);let b=new xo(i,s,$);return s.computeKernel(d,b,h)},()=>s.captureBegin(),()=>s.captureEnd(),()=>s.replay()])}else c("webnn")}}),uf,kd,Od,hr,lf,So,Pd,Rd,Ed,zd,Bd,Dd,Md=j(()=>{ja(),Ya(),ye(),Or(),Wn(),qi(),uf=(e,i)=>{Fe()._OrtInit(e,i)!==0&&We("Can't initialize onnxruntime.")},kd=async e=>{uf(e.wasm.numThreads,en(e.logLevel))},Od=async(e,i)=>{{let a=(Ad(),sr(Td)).init;if(i==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let o=e.webgpu.adapter;if(o){if(typeof o.limits!="object"||typeof o.features!="object"||typeof o.requestDevice!="function")throw new Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let c=e.webgpu.powerPreference;if(c!==void 0&&c!=="low-power"&&c!=="high-performance")throw new Error(`Invalid powerPreference setting: "${c}"`);let s=e.webgpu.forceFallbackAdapter;if(s!==void 0&&typeof s!="boolean")throw new Error(`Invalid forceFallbackAdapter setting: "${s}"`);if(o=await navigator.gpu.requestAdapter({powerPreference:c,forceFallbackAdapter:s}),!o)throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.')}if(!e.wasm.simd)throw new Error("Not supported for WebGPU=ON and SIMD=OFF. Please set `env.wasm.simd` to true when using `webgpu` EP");await a("webgpu",Fe(),e,o)}if(i==="webnn"){if(typeof navigator>"u"||!navigator.ml)throw new Error("WebNN is not supported in current environment");await a("webnn",Fe(),e)}}},hr=new Map,lf=e=>{let i=Fe(),a=i.stackSave();try{let o=i.stackAlloc(8);return i._OrtGetInputOutputCount(e,o,o+4)!==0&&We("Can't get session input/output count."),[i.HEAP32[o/4],i.HEAP32[o/4+1]]}finally{i.stackRestore(a)}},So=e=>{let i=Fe(),a=i._malloc(e.byteLength);if(a===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${e.byteLength}.`);return i.HEAPU8.set(e,a),[a,e.byteLength]},Pd=async(e,i)=>{var g,st;let a,o,c=Fe();Array.isArray(e)?[a,o]=e:e.buffer===c.HEAPU8.buffer?[a,o]=[e.byteOffset,e.byteLength]:[a,o]=So(e);let s=0,d=0,$=0,et=[],h=[],b=[];try{if([d,et]=Ka(i),(i==null?void 0:i.externalData)&&c.mountExternalData){let jr=[];for(let Hr of i.externalData){let wn=typeof Hr=="string"?Hr:Hr.path;jr.push(tn(typeof Hr=="string"?Hr:Hr.data).then(_n=>{c.mountExternalData(wn,_n)}))}await Promise.all(jr)}s=await c._OrtCreateSession(a,o,d),s===0&&We("Can't create a session.");let[$t,vt]=lf(s),Ft=!!(i!=null&&i.enableGraphCapture),Gt=[],qt=[],Lt=[];for(let jr=0;jr<$t;jr++){let Hr=c._OrtGetInputName(s,jr);Hr===0&&We("Can't get an input name."),h.push(Hr),Gt.push(c.UTF8ToString(Hr))}for(let jr=0;jr<vt;jr++){let Hr=c._OrtGetOutputName(s,jr);Hr===0&&We("Can't get an output name."),b.push(Hr);let wn=c.UTF8ToString(Hr);qt.push(wn);{if(Ft&&(i==null?void 0:i.preferredOutputLocation)===void 0){Lt.push("gpu-buffer");continue}let _n=typeof(i==null?void 0:i.preferredOutputLocation)=="string"?i.preferredOutputLocation:((g=i==null?void 0:i.preferredOutputLocation)==null?void 0:g[wn])??"cpu";if(_n!=="cpu"&&_n!=="cpu-pinned"&&_n!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${_n}.`);if(Ft&&_n!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${_n}. Only 'gpu-buffer' location is supported when enableGraphCapture is true.`);Lt.push(_n)}}let rr=null;return Lt.some(jr=>jr==="gpu-buffer")&&($=c._OrtCreateBinding(s),$===0&&We("Can't create IO binding."),rr={handle:$,outputPreferredLocations:Lt,outputPreferredLocationsEncoded:Lt.map(jr=>Fi(jr))}),hr.set(s,[s,h,b,rr,Ft,!1]),[s,Gt,qt]}catch($t){throw h.forEach(vt=>c._OrtFree(vt)),b.forEach(vt=>c._OrtFree(vt)),$!==0&&c._OrtReleaseBinding($),s!==0&&c._OrtReleaseSession(s),$t}finally{c._free(a),d!==0&&c._OrtReleaseSessionOptions(d),et.forEach($t=>c._free($t)),(st=c.unmountExternalData)==null||st.call(c)}},Rd=e=>{var et;let i=Fe(),a=hr.get(e);if(!a)throw new Error(`cannot release session. invalid session id: ${e}`);let[o,c,s,d,$]=a;d&&($&&i._OrtClearBoundOutputs(d.handle),i._OrtReleaseBinding(d.handle)),(et=i.jsepOnReleaseSession)==null||et.call(i,e),c.forEach(h=>i._OrtFree(h)),s.forEach(h=>i._OrtFree(h)),i._OrtReleaseSession(o),hr.delete(e)},Ed=(e,i,a,o,c,s=!1)=>{if(!e){i.push(0);return}let d=Fe(),$=e[0],et=e[1],h=e[3],b,g;if($==="string"&&h==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(s&&h!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${c} when enableGraphCapture is true.`);if(h==="gpu-buffer"){let vt=e[2].gpuBuffer,Ft=cr(Li($));g=et.reduce((qt,Lt)=>qt*Lt,1)*Ft;let Gt=d.jsepRegisterBuffer;if(!Gt)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');b=Gt(o,c,vt,g)}else{let vt=e[2];if(Array.isArray(vt)){g=4*vt.length,b=d._malloc(g),a.push(b);let Ft=b/4;for(let Gt=0;Gt<vt.length;Gt++){if(typeof vt[Gt]!="string")throw new TypeError(`tensor data at index ${Gt} is not a string`);d.HEAPU32[Ft++]=qe(vt[Gt],a)}}else g=vt.byteLength,b=d._malloc(g),a.push(b),d.HEAPU8.set(new Uint8Array(vt.buffer,vt.byteOffset,g),b)}let st=d.stackSave(),$t=d.stackAlloc(4*et.length);try{let vt=$t/4;et.forEach(Gt=>d.HEAP32[vt++]=Gt);let Ft=d._OrtCreateTensor(Li($),b,g,$t,et.length,Fi(h));Ft===0&&We(`Can't create tensor for input/output. session=${o}, index=${c}.`),i.push(Ft)}finally{d.stackRestore(st)}},zd=async(e,i,a,o,c,s)=>{var Xo,l0;let d=Fe(),$=hr.get(e);if(!$)throw new Error(`cannot run inference. invalid session id: ${e}`);let et=$[0],h=$[1],b=$[2],g=$[3],st=$[4],$t=$[5],vt=i.length,Ft=o.length,Gt=0,qt=[],Lt=[],rr=[],jr=[],Hr=d.stackSave(),wn=d.stackAlloc(vt*4),_n=d.stackAlloc(vt*4),No=d.stackAlloc(Ft*4),Qo=d.stackAlloc(Ft*4);try{[Gt,qt]=qa(s);for(let Sn=0;Sn<vt;Sn++)Ed(a[Sn],Lt,jr,e,i[Sn],st);for(let Sn=0;Sn<Ft;Sn++)Ed(c[Sn],rr,jr,e,vt+o[Sn],st);let v0=wn/4,x0=_n/4,D0=No/4,M0=Qo/4;for(let Sn=0;Sn<vt;Sn++)d.HEAPU32[v0++]=Lt[Sn],d.HEAPU32[x0++]=h[i[Sn]];for(let Sn=0;Sn<Ft;Sn++)d.HEAPU32[D0++]=rr[Sn],d.HEAPU32[M0++]=b[o[Sn]];if(g&&!$t){let{handle:Sn,outputPreferredLocations:t0,outputPreferredLocationsEncoded:d0}=g;if(h.length!==vt)throw new Error(`input count from feeds (${vt}) is expected to be always equal to model's input count (${h.length}).`);for(let xn=0;xn<vt;xn++){let f0=i[xn];await d._OrtBindInput(Sn,h[f0],Lt[xn])!==0&&We(`Can't bind input[${xn}] for session=${e}.`)}for(let xn=0;xn<Ft;xn++){let f0=o[xn];(Xo=c[xn])!=null&&Xo[3]?d._OrtBindOutput(Sn,b[f0],rr[xn],0)!==0&&We(`Can't bind pre-allocated output[${xn}] for session=${e}.`):d._OrtBindOutput(Sn,b[f0],0,d0[f0])!==0&&We(`Can't bind output[${xn}] to ${t0[xn]} for session=${e}.`)}hr.set(e,[et,h,b,g,st,!0])}(l0=d.jsepOnRunStart)==null||l0.call(d,et);let Mo;g?Mo=await d._OrtRunWithBinding(et,g.handle,Ft,No,Gt):Mo=await d._OrtRun(et,_n,wn,vt,Qo,Ft,No,Gt),Mo!==0&&We("failed to call OrtRun().");let e0=[];for(let Sn=0;Sn<Ft;Sn++){let t0=d.HEAPU32[No/4+Sn];if(t0===rr[Sn]){e0.push(c[Sn]);continue}let d0=d.stackSave(),xn=d.stackAlloc(4*4),f0=!1,$0,N0=0;try{d._OrtGetTensorData(t0,xn,xn+4,xn+8,xn+12)!==0&&We(`Can't access output tensor data on index ${Sn}.`);let j0=xn/4,Z0=d.HEAPU32[j0++];N0=d.HEAPU32[j0++];let fy=d.HEAPU32[j0++],oy=d.HEAPU32[j0++],gy=[];for(let H0=0;H0<oy;H0++)gy.push(d.HEAPU32[fy/4+H0]);d._OrtFree(fy);let hy=gy.reduce((H0,yy)=>H0*yy,1);$0=Yt(Z0);let J0=g==null?void 0:g.outputPreferredLocations[o[Sn]];if($0==="string"){if(J0==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let H0=[],yy=N0/4;for(let vy=0;vy<hy;vy++){let $y=d.HEAPU32[yy++],o1=vy===hy-1?void 0:d.HEAPU32[yy]-$y;H0.push(d.UTF8ToString($y,o1))}e0.push([$0,gy,H0,"cpu"])}else if(J0==="gpu-buffer"&&hy>0){let H0=d.jsepGetBuffer;if(!H0)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let yy=H0(N0),vy=cr(Z0);if(vy===void 0||!Vn($0))throw new Error(`Unsupported data type: ${$0}`);f0=!0,e0.push([$0,gy,{gpuBuffer:yy,download:d.jsepCreateDownloader(yy,hy*vy,$0),dispose:()=>{d._OrtReleaseTensor(t0)}},"gpu-buffer"])}else{let H0=Nn($0),yy=new H0(hy);new Uint8Array(yy.buffer,yy.byteOffset,yy.byteLength).set(d.HEAPU8.subarray(N0,N0+yy.byteLength)),e0.push([$0,gy,yy,"cpu"])}}finally{d.stackRestore(d0),$0==="string"&&N0&&d._free(N0),f0||d._OrtReleaseTensor(t0)}}return g&&!st&&(d._OrtClearBoundOutputs(g.handle),hr.set(e,[et,h,b,g,st,!1])),e0}finally{d.stackRestore(Hr),Lt.forEach(v0=>d._OrtReleaseTensor(v0)),rr.forEach(v0=>d._OrtReleaseTensor(v0)),jr.forEach(v0=>d._free(v0)),Gt!==0&&d._OrtReleaseRunOptions(Gt),qt.forEach(v0=>d._free(v0))}},Bd=e=>{let i=Fe(),a=hr.get(e);if(!a)throw new Error("invalid session id");let o=a[0],c=i._OrtEndProfiling(o);c===0&&We("Can't get an profile file name."),i._OrtFree(c)},Dd=e=>{let i=[];for(let a of e){let o=a[2];!Array.isArray(o)&&"buffer"in o&&i.push(o.buffer)}return i}}),Ud=Er((e,i)=>{i.exports='/*!\n * ONNX Runtime Web v1.18.0\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n"use strict";(()=>{var ao=Object.defineProperty;var nl=Object.getOwnPropertyDescriptor;var ol=Object.getOwnPropertyNames;var il=Object.prototype.hasOwnProperty;var Y=(e,t)=>()=>(e&&(t=e(e=0)),t);var Wr=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),gn=(e,t)=>{for(var r in t)ao(e,r,{get:t[r],enumerable:!0})},al=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of ol(t))!il.call(e,i)&&i!==r&&ao(e,i,{get:()=>t[i],enumerable:!(o=nl(t,i))||o.enumerable});return e};var wr=e=>al(ao({},"__esModule",{value:!0}),e);var so={};gn(so,{createReadStream:()=>Ai,readFile:()=>sl,readFileSync:()=>ul});var sl,ul,Ai,uo=Y(()=>{sl=void 0,ul=void 0,Ai=void 0});var lo={};gn(lo,{join:()=>dl});var dl,co=Y(()=>{dl=void 0});var Ei=Wr((Ti,po)=>{"use strict";var Ii=(()=>{var e=typeof document<"u"?document.currentScript?.src:void 0;return typeof __filename<"u"&&(e||=__filename),function(t={}){var r=t,o,i,u=new Promise((s,m)=>{o=s,i=m});r.mountExternalData=(s,m)=>{(r.eb||(r.eb=new Map)).set(s,m)},r.unmountExternalData=()=>{delete r.eb};let a=()=>{let s=(g,$,T)=>(...B)=>{let H=dt,q=$?.();B=g(...B);let te=$?.();return q!==te&&(g=te,T(q),$=T=null),dt!=H?tn():B},m=g=>async(...$)=>{try{if(r.cb)throw Error("Session already started");let T=r.cb={xb:$[0],errors:[]},B=await g(...$);if(r.cb!==T)throw Error("Session mismatch");r.kb?.flush();let H=T.errors;if(0<H.length){let q=await Promise.all(H);if(q=q.filter(te=>te),0<q.length)throw Error(q.join(`\n`))}return B}finally{r.cb=null}};r._OrtCreateSession=s(r._OrtCreateSession,()=>r._OrtCreateSession,g=>r._OrtCreateSession=g),r._OrtRun=m(s(r._OrtRun,()=>r._OrtRun,g=>r._OrtRun=g)),r._OrtRunWithBinding=m(s(r._OrtRunWithBinding,()=>r._OrtRunWithBinding,g=>r._OrtRunWithBinding=g)),r._OrtBindInput=s(r._OrtBindInput,()=>r._OrtBindInput,g=>r._OrtBindInput=g),a=void 0};r.jsepInit=(s,m)=>{if(a?.(),s==="webgpu"){[r.kb,r.pb,r.tb,r.lb,r.sb,r.Ra,r.ub,r.wb,r.qb,r.rb,r.vb]=m;let g=r.kb;r.jsepRegisterBuffer=($,T,B,H)=>g.registerBuffer($,T,B,H),r.jsepGetBuffer=$=>g.getBuffer($),r.jsepCreateDownloader=($,T,B)=>g.createDownloader($,T,B),r.jsepOnReleaseSession=$=>{g.onReleaseSession($)},r.jsepOnRunStart=$=>g.onRunStart($)}};var c=Object.assign({},r),p="./this.program",h=(s,m)=>{throw m},d=typeof window=="object",y=typeof importScripts=="function",w=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",_="",v,S,A;if(w){var I=(uo(),wr(so)),x=(co(),wr(lo));_=y?x.dirname(_)+"/":__dirname+"/",v=(s,m)=>(s=Ke(s)?new URL(s):x.normalize(s),I.readFileSync(s,m?void 0:"utf8")),A=s=>(s=v(s,!0),s.buffer||(s=new Uint8Array(s)),s),S=(s,m,g,$=!0)=>{s=Ke(s)?new URL(s):x.normalize(s),I.readFile(s,$?void 0:"utf8",(T,B)=>{T?g(T):m($?B.buffer:B)})},!r.thisProgram&&1<process.argv.length&&(p=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),h=(s,m)=>{throw process.exitCode=s,m}}else(d||y)&&(y?_=self.location.href:typeof document<"u"&&document.currentScript&&(_=document.currentScript.src),e&&(_=e),_.startsWith("blob:")?_="":_=_.substr(0,_.replace(/[?#].*/,"").lastIndexOf("/")+1),v=s=>{var m=new XMLHttpRequest;return m.open("GET",s,!1),m.send(null),m.responseText},y&&(A=s=>{var m=new XMLHttpRequest;return m.open("GET",s,!1),m.responseType="arraybuffer",m.send(null),new Uint8Array(m.response)}),S=(s,m,g)=>{var $=new XMLHttpRequest;$.open("GET",s,!0),$.responseType="arraybuffer",$.onload=()=>{$.status==200||$.status==0&&$.response?m($.response):g()},$.onerror=g,$.send(null)});var E=console.log.bind(console),P=console.error.bind(console);Object.assign(r,c),c=null;var O,R=!1,L,N,K,Q,he,W,se,Ce,We,ee,ae;function Ae(){var s=O.buffer;r.HEAP8=N=new Int8Array(s),r.HEAP16=Q=new Int16Array(s),r.HEAPU8=K=new Uint8Array(s),r.HEAPU16=he=new Uint16Array(s),r.HEAP32=W=new Int32Array(s),r.HEAPU32=se=new Uint32Array(s),r.HEAPF32=Ce=new Float32Array(s),r.HEAPF64=ae=new Float64Array(s),r.HEAP64=We=new BigInt64Array(s),r.HEAPU64=ee=new BigUint64Array(s)}var me=[],ie=[],ue=[],le=0,qe=null,G=null;function ne(s){throw s="Aborted("+s+")",P(s),R=!0,L=1,s=new WebAssembly.RuntimeError(s+". Build with -sASSERTIONS for more info."),i(s),s}var xe=s=>s.startsWith("data:application/octet-stream;base64,"),Ke=s=>s.startsWith("file://"),Be;if(Be="ort-wasm-simd.wasm",!xe(Be)){var Ge=Be;Be=r.locateFile?r.locateFile(Ge,_):_+Ge}function Ut(s){if(A)return A(s);throw"both async and sync fetching of the wasm failed"}function Ne(s){if(d||y){if(typeof fetch=="function"&&!Ke(s))return fetch(s,{credentials:"same-origin"}).then(m=>{if(!m.ok)throw`failed to load wasm binary file at \'${s}\'`;return m.arrayBuffer()}).catch(()=>Ut(s));if(S)return new Promise((m,g)=>{S(s,$=>m(new Uint8Array($)),g)})}return Promise.resolve().then(()=>Ut(s))}function Ye(s,m,g){return Ne(s).then($=>WebAssembly.instantiate($,m)).then(g,$=>{P(`failed to asynchronously prepare wasm: ${$}`),ne($)})}function mt(s,m){var g=Be;return typeof WebAssembly.instantiateStreaming!="function"||xe(g)||Ke(g)||w||typeof fetch!="function"?Ye(g,s,m):fetch(g,{credentials:"same-origin"}).then($=>WebAssembly.instantiateStreaming($,s).then(m,function(T){return P(`wasm streaming compile failed: ${T}`),P("falling back to ArrayBuffer instantiation"),Ye(g,s,m)}))}var Rt={824920:(s,m,g,$)=>{if(typeof r>"u"||!r.eb)return 1;if(s=je(s>>>0),s.startsWith("./")&&(s=s.substring(2)),s=r.eb.get(s),!s)return 2;if(m>>>=0,g>>>=0,m+g>s.byteLength)return 3;try{return K.set(s.subarray(m,m+g),$>>>0>>>0),0}catch{return 4}},825421:()=>{r.qb()},825452:()=>{r.rb()},825481:()=>{r.vb()},825506:s=>r.pb(s),825539:s=>r.tb(s),825571:(s,m,g)=>{r.lb(s,m,g,!0)},825610:(s,m,g)=>{r.lb(s,m,g)},825643:s=>{r.Ra("Abs",s,void 0)},825694:s=>{r.Ra("Neg",s,void 0)},825745:s=>{r.Ra("Floor",s,void 0)},825798:s=>{r.Ra("Ceil",s,void 0)},825850:s=>{r.Ra("Reciprocal",s,void 0)},825908:s=>{r.Ra("Sqrt",s,void 0)},825960:s=>{r.Ra("Exp",s,void 0)},826011:s=>{r.Ra("Erf",s,void 0)},826062:s=>{r.Ra("Sigmoid",s,void 0)},826117:(s,m,g)=>{r.Ra("HardSigmoid",s,{alpha:m,beta:g})},826196:s=>{r.Ra("Log",s,void 0)},826247:s=>{r.Ra("Sin",s,void 0)},826298:s=>{r.Ra("Cos",s,void 0)},826349:s=>{r.Ra("Tan",s,void 0)},826400:s=>{r.Ra("Asin",s,void 0)},826452:s=>{r.Ra("Acos",s,void 0)},826504:s=>{r.Ra("Atan",s,void 0)},826556:s=>{r.Ra("Sinh",s,void 0)},826608:s=>{r.Ra("Cosh",s,void 0)},826660:s=>{r.Ra("Asinh",s,void 0)},826713:s=>{r.Ra("Acosh",s,void 0)},826766:s=>{r.Ra("Atanh",s,void 0)},826819:s=>{r.Ra("Tanh",s,void 0)},826871:s=>{r.Ra("Not",s,void 0)},826922:(s,m,g)=>{r.Ra("Clip",s,{min:m,max:g})},826991:s=>{r.Ra("Clip",s,void 0)},827043:(s,m)=>{r.Ra("Elu",s,{alpha:m})},827101:s=>{r.Ra("Relu",s,void 0)},827153:(s,m)=>{r.Ra("LeakyRelu",s,{alpha:m})},827217:(s,m)=>{r.Ra("ThresholdedRelu",s,{alpha:m})},827287:(s,m)=>{r.Ra("Cast",s,{to:m})},827345:s=>{r.Ra("Add",s,void 0)},827396:s=>{r.Ra("Sub",s,void 0)},827447:s=>{r.Ra("Mul",s,void 0)},827498:s=>{r.Ra("Div",s,void 0)},827549:s=>{r.Ra("Pow",s,void 0)},827600:s=>{r.Ra("Equal",s,void 0)},827653:s=>{r.Ra("Greater",s,void 0)},827708:s=>{r.Ra("GreaterOrEqual",s,void 0)},827770:s=>{r.Ra("Less",s,void 0)},827822:s=>{r.Ra("LessOrEqual",s,void 0)},827881:(s,m,g,$,T)=>{r.Ra("ReduceMean",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},828040:(s,m,g,$,T)=>{r.Ra("ReduceMax",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},828198:(s,m,g,$,T)=>{r.Ra("ReduceMin",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},828356:(s,m,g,$,T)=>{r.Ra("ReduceProd",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},828515:(s,m,g,$,T)=>{r.Ra("ReduceSum",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},828673:(s,m,g,$,T)=>{r.Ra("ReduceL1",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},828830:(s,m,g,$,T)=>{r.Ra("ReduceL2",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},828987:(s,m,g,$,T)=>{r.Ra("ReduceLogSum",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},829148:(s,m,g,$,T)=>{r.Ra("ReduceSumSquare",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},829312:(s,m,g,$,T)=>{r.Ra("ReduceLogSumExp",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},829476:s=>{r.Ra("Where",s,void 0)},829529:(s,m,g)=>{r.Ra("Transpose",s,{perm:m?Array.from(W.subarray(m>>>0,g>>>0)):[]})},829637:(s,m,g,$)=>{r.Ra("DepthToSpace",s,{blocksize:m,mode:je(g),format:$?"NHWC":"NCHW"})},829770:(s,m,g,$)=>{r.Ra("DepthToSpace",s,{blocksize:m,mode:je(g),format:$?"NHWC":"NCHW"})},829903:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D,be)=>{r.Ra("ConvTranspose",s,{format:te?"NHWC":"NCHW",autoPad:m,dilations:[g],group:$,kernelShape:[T],pads:[B,H],strides:[q],wIsConst:()=>!!N[X>>>0],outputPadding:de?Array.from(W.subarray(de>>>0,Ee>>>0)):[],outputShape:Oe?Array.from(W.subarray(Oe>>>0,D>>>0)):[],activation:je(be)})},830304:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D)=>{r.Ra("ConvTranspose",s,{format:q?"NHWC":"NCHW",autoPad:m,dilations:Array.from(W.subarray(g>>>0,(g>>>0)+2>>>0)),group:$,kernelShape:Array.from(W.subarray(T>>>0,(T>>>0)+2>>>0)),pads:Array.from(W.subarray(B>>>0,(B>>>0)+4>>>0)),strides:Array.from(W.subarray(H>>>0,(H>>>0)+2>>>0)),wIsConst:()=>!!N[te>>>0],outputPadding:X?Array.from(W.subarray(X>>>0,de>>>0)):[],outputShape:Ee?Array.from(W.subarray(Ee>>>0,Oe>>>0)):[],activation:je(D)})},830869:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D,be)=>{r.Ra("ConvTranspose",s,{format:te?"NHWC":"NCHW",autoPad:m,dilations:[g],group:$,kernelShape:[T],pads:[B,H],strides:[q],wIsConst:()=>!!N[X>>>0],outputPadding:de?Array.from(W.subarray(de>>>0,Ee>>>0)):[],outputShape:Oe?Array.from(W.subarray(Oe>>>0,D>>>0)):[],activation:je(be)})},831270:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D)=>{r.Ra("ConvTranspose",s,{format:q?"NHWC":"NCHW",autoPad:m,dilations:Array.from(W.subarray(g>>>0,(g>>>0)+2>>>0)),group:$,kernelShape:Array.from(W.subarray(T>>>0,(T>>>0)+2>>>0)),pads:Array.from(W.subarray(B>>>0,(B>>>0)+4>>>0)),strides:Array.from(W.subarray(H>>>0,(H>>>0)+2>>>0)),wIsConst:()=>!!N[te>>>0],outputPadding:X?Array.from(W.subarray(X>>>0,de>>>0)):[],outputShape:Ee?Array.from(W.subarray(Ee>>>0,Oe>>>0)):[],activation:je(D)})},831835:(s,m)=>{r.Ra("GlobalAveragePool",s,{format:m?"NHWC":"NCHW"})},831926:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D,be,Ie)=>{r.Ra("AveragePool",s,{format:Ie?"NHWC":"NCHW",auto_pad:m,ceil_mode:g,count_include_pad:$,storage_order:T,dilations:[B,H],kernel_shape:[q,te],pads:[X,de,Ee,Oe],strides:[D,be]})},832210:(s,m)=>{r.Ra("GlobalAveragePool",s,{format:m?"NHWC":"NCHW"})},832301:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D,be,Ie)=>{r.Ra("AveragePool",s,{format:Ie?"NHWC":"NCHW",auto_pad:m,ceil_mode:g,count_include_pad:$,storage_order:T,dilations:[B,H],kernel_shape:[q,te],pads:[X,de,Ee,Oe],strides:[D,be]})},832585:(s,m)=>{r.Ra("GlobalMaxPool",s,{format:m?"NHWC":"NCHW"})},832672:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D,be,Ie)=>{r.Ra("MaxPool",s,{format:Ie?"NHWC":"NCHW",auto_pad:m,ceil_mode:g,count_include_pad:$,storage_order:T,dilations:[B,H],kernel_shape:[q,te],pads:[X,de,Ee,Oe],strides:[D,be]})},832952:(s,m)=>{r.Ra("GlobalMaxPool",s,{format:m?"NHWC":"NCHW"})},833039:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D,be,Ie)=>{r.Ra("MaxPool",s,{format:Ie?"NHWC":"NCHW",auto_pad:m,ceil_mode:g,count_include_pad:$,storage_order:T,dilations:[B,H],kernel_shape:[q,te],pads:[X,de,Ee,Oe],strides:[D,be]})},833319:(s,m,g,$,T)=>{r.Ra("Gemm",s,{alpha:m,beta:g,transA:$,transB:T})},833423:s=>{r.Ra("MatMul",s,void 0)},833477:(s,m,g,$)=>{r.Ra("ArgMax",s,{keepDims:!!m,selectLastIndex:!!g,axis:$})},833585:(s,m,g,$)=>{r.Ra("ArgMin",s,{keepDims:!!m,selectLastIndex:!!g,axis:$})},833693:(s,m)=>{r.Ra("Softmax",s,{axis:m})},833756:(s,m)=>{r.Ra("Concat",s,{axis:m})},833816:(s,m,g,$,T)=>{r.Ra("Split",s,{axis:m,numOutputs:g,splitSizes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},833956:s=>{r.Ra("Expand",s,void 0)},834010:(s,m)=>{r.Ra("Gather",s,{axis:Number(m)})},834081:(s,m)=>{r.Ra("GatherElements",s,{axis:Number(m)})},834160:(s,m,g,$,T,B,H,q,te,X,de)=>{r.Ra("Resize",s,{antialias:m,axes:g?Array.from(W.subarray(g>>>0,$>>>0)):[],coordinateTransformMode:je(T),cubicCoeffA:B,excludeOutside:H,extrapolationValue:q,keepAspectRatioPolicy:je(te),mode:je(X),nearestMode:je(de)})},834506:(s,m,g,$,T,B,H)=>{r.Ra("Slice",s,{starts:m?Array.from(W.subarray(m>>>0,g>>>0)):[],ends:$?Array.from(W.subarray($>>>0,T>>>0)):[],axes:B?Array.from(W.subarray(B>>>0,H>>>0)):[]})},834722:s=>{r.Ra("Tile",s,void 0)},834774:(s,m,g,$)=>{r.Ra("LayerNormalization",s,{axis:m,epsilon:g,simplified:!!$})},834885:(s,m,g)=>{r.Ra("InstanceNormalization",s,{epsilon:m,format:g?"NHWC":"NCHW"})},834999:(s,m,g)=>{r.Ra("InstanceNormalization",s,{epsilon:m,format:g?"NHWC":"NCHW"})},835113:s=>{r.Ra("Range",s,void 0)},835166:(s,m)=>{r.Ra("Einsum",s,{equation:je(m)})},835247:(s,m,g,$,T)=>{r.Ra("Pad",s,{mode:m,value:g,pads:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},835374:(s,m,g,$,T,B)=>{r.Ra("BatchNormalization",s,{epsilon:m,momentum:g,spatial:!!T,trainingMode:!!$,format:B?"NHWC":"NCHW"})},835543:(s,m,g,$,T,B)=>{r.Ra("BatchNormalization",s,{epsilon:m,momentum:g,spatial:!!T,trainingMode:!!$,format:B?"NHWC":"NCHW"})},835712:(s,m,g)=>{r.Ra("CumSum",s,{exclusive:Number(m),reverse:Number(g)})},835809:(s,m,g,$,T,B,H,q,te)=>{r.Ra("Attention",s,{numHeads:m,isUnidirectional:g,maskFilterValue:$,scale:T,doRotary:B,qkvHiddenSizes:H?Array.from(W.subarray(Number(q)>>>0,Number(q)+H>>>0)):[],pastPresentShareBuffer:!!te})},836081:s=>{r.Ra("BiasAdd",s,void 0)},836136:s=>{r.Ra("BiasSplitGelu",s,void 0)},836197:s=>{r.Ra("FastGelu",s,void 0)},836253:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe)=>{r.Ra("Conv",s,{format:te?"NHWC":"NCHW",auto_pad:m,dilations:[g],group:$,kernel_shape:[T],pads:B?Array.from(W.subarray(B>>>0,H>>>0)):[],strides:[q],w_is_const:()=>!!N[X>>>0],activation:je(de),activation_params:Ee?Array.from(Ce.subarray(Ee>>>0,Oe>>>0)):[]})},836623:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D,be,Ie)=>{r.Ra("Conv",s,{format:Ee?"NHWC":"NCHW",auto_pad:m,dilations:[g,$],group:T,kernel_shape:[B,H],pads:q?Array.from(W.subarray(q>>>0,te>>>0)):[],strides:[X,de],w_is_const:()=>!!N[Oe>>>0],activation:je(D),activation_params:be?Array.from(Ce.subarray(be>>>0,Ie>>>0)):[]})},837014:s=>{r.Ra("Gelu",s,void 0)},837066:(s,m,g,$,T,B)=>{r.Ra("MatMulNBits",s,{k:m,n:g,accuracyLevel:$,bits:T,blockSize:B})},837193:(s,m,g,$,T,B)=>{r.Ra("MultiHeadAttention",s,{numHeads:m,isUnidirectional:g,maskFilterValue:$,scale:T,doRotary:B})},837352:(s,m,g,$,T)=>{r.Ra("RotaryEmbedding",s,{interleaved:!!m,numHeads:g,rotaryEmbeddingDim:$,scale:T})},837491:(s,m,g)=>{r.Ra("SkipLayerNormalization",s,{epsilon:m,simplified:!!g})},837593:(s,m,g)=>{r.Ra("SkipLayerNormalization",s,{epsilon:m,simplified:!!g})},837695:(s,m,g,$)=>{r.Ra("LayerNormalization",s,{axis:m,epsilon:g,simplified:!!$})},837806:s=>{r.ub(s)},837840:(s,m)=>r.wb(s,m,r.cb.xb,r.cb.errors)};function qt(s){this.name="ExitStatus",this.message=`Program terminated with exit(${s})`,this.status=s}class Vt{constructor(m){this.hb=m-24}}var sr=0,jt=0,xr=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Kt=(s,m,g)=>{m>>>=0;var $=m+g;for(g=m;s[g]&&!(g>=$);)++g;if(16<g-m&&s.buffer&&xr)return xr.decode(s.subarray(m,g));for($="";m<g;){var T=s[m++];if(T&128){var B=s[m++]&63;if((T&224)==192)$+=String.fromCharCode((T&31)<<6|B);else{var H=s[m++]&63;T=(T&240)==224?(T&15)<<12|B<<6|H:(T&7)<<18|B<<12|H<<6|s[m++]&63,65536>T?$+=String.fromCharCode(T):(T-=65536,$+=String.fromCharCode(55296|T>>10,56320|T&1023))}}else $+=String.fromCharCode(T)}return $},je=(s,m)=>(s>>>=0)?Kt(K,s,m):"",Wt=s=>{for(var m=0,g=0;g<s.length;++g){var $=s.charCodeAt(g);127>=$?m++:2047>=$?m+=2:55296<=$&&57343>=$?(m+=4,++g):m+=3}return m},at=(s,m,g,$)=>{if(g>>>=0,!(0<$))return 0;var T=g;$=g+$-1;for(var B=0;B<s.length;++B){var H=s.charCodeAt(B);if(55296<=H&&57343>=H){var q=s.charCodeAt(++B);H=65536+((H&1023)<<10)|q&1023}if(127>=H){if(g>=$)break;m[g++>>>0]=H}else{if(2047>=H){if(g+1>=$)break;m[g++>>>0]=192|H>>6}else{if(65535>=H){if(g+2>=$)break;m[g++>>>0]=224|H>>12}else{if(g+3>=$)break;m[g++>>>0]=240|H>>18,m[g++>>>0]=128|H>>12&63}m[g++>>>0]=128|H>>6&63}m[g++>>>0]=128|H&63}}return m[g>>>0]=0,g-T},Cr,ft=s=>{for(var m="";K[s>>>0];)m+=Cr[K[s++>>>0]];return m},ur={},Ar={},Ir={},st;function Tr(s,m,g={}){var $=m.name;if(!s)throw new st(`type "${$}" must have a positive integer typeid pointer`);if(Ar.hasOwnProperty(s)){if(g.nb)return;throw new st(`Cannot register type \'${$}\' twice`)}Ar[s]=m,delete Ir[s],ur.hasOwnProperty(s)&&(m=ur[s],delete ur[s],m.forEach(T=>T()))}function ht(s,m,g={}){if(!("argPackAdvance"in m))throw new TypeError("registerType registeredInstance requires argPackAdvance");return Tr(s,m,g)}var bt=(s,m,g)=>{switch(m){case 1:return g?$=>N[$>>>0]:$=>K[$>>>0];case 2:return g?$=>Q[$>>>1>>>0]:$=>he[$>>>1>>>0];case 4:return g?$=>W[$>>>2>>>0]:$=>se[$>>>2>>>0];case 8:return g?$=>We[$>>>3]:$=>ee[$>>>3];default:throw new TypeError(`invalid integer width (${m}): ${s}`)}},Er=[],Te=[];function dr(s){s>>>=0,9<s&&--Te[s+1]===0&&(Te[s]=void 0,Er.push(s))}var Xe=s=>{if(!s)throw new st("Cannot use deleted val. handle = "+s);return Te[s]},ut=s=>{switch(s){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let m=Er.pop()||Te.length;return Te[m]=s,Te[m+1]=1,m}};function lr(s){return this.fromWireType(se[s>>>2>>>0])}var Fn={name:"emscripten::val",fromWireType:s=>{var m=Xe(s);return dr(s),m},toWireType:(s,m)=>ut(m),argPackAdvance:8,readValueFromPointer:lr,bb:null},ge=(s,m)=>{switch(m){case 4:return function(g){return this.fromWireType(Ce[g>>>2>>>0])};case 8:return function(g){return this.fromWireType(ae[g>>>3>>>0])};default:throw new TypeError(`invalid float width (${m}): ${s}`)}},Yt=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,jr=(s,m)=>{for(var g=s>>1,$=g+m/2;!(g>=$)&&he[g>>>0];)++g;if(g<<=1,32<g-s&&Yt)return Yt.decode(K.subarray(s>>>0,g>>>0));for(g="",$=0;!($>=m/2);++$){var T=Q[s+2*$>>>1>>>0];if(T==0)break;g+=String.fromCharCode(T)}return g},qn=(s,m,g)=>{if(g??=2147483647,2>g)return 0;g-=2;var $=m;g=g<2*s.length?g/2:s.length;for(var T=0;T<g;++T)Q[m>>>1>>>0]=s.charCodeAt(T),m+=2;return Q[m>>>1>>>0]=0,m-$},Kr=s=>2*s.length,jn=(s,m)=>{for(var g=0,$="";!(g>=m/4);){var T=W[s+4*g>>>2>>>0];if(T==0)break;++g,65536<=T?(T-=65536,$+=String.fromCharCode(55296|T>>10,56320|T&1023)):$+=String.fromCharCode(T)}return $},Yr=(s,m,g)=>{if(m>>>=0,g??=2147483647,4>g)return 0;var $=m;g=$+g-4;for(var T=0;T<s.length;++T){var B=s.charCodeAt(T);if(55296<=B&&57343>=B){var H=s.charCodeAt(++T);B=65536+((B&1023)<<10)|H&1023}if(W[m>>>2>>>0]=B,m+=4,m+4>g)break}return W[m>>>2>>>0]=0,m-$},Zr=s=>{for(var m=0,g=0;g<s.length;++g){var $=s.charCodeAt(g);55296<=$&&57343>=$&&++g,m+=4}return m},cr=(s,m)=>{var g=Ar[s];if(g===void 0)throw s=Mr(s),g=ft(s),rt(s),new st(`${m} has unknown type ${g}`);return g},Pr=(s,m,g)=>{var $=[];return s=s.toWireType($,g),$.length&&(se[m>>>2>>>0]=ut($)),s},He=s=>{try{s()}catch(m){ne(m)}},Xr=s=>{if(!R)try{s();try{L=L=s=L,r.onExit?.(s),R=!0,h(s,new qt(s))}catch(m){m instanceof qt||m=="unwind"||h(1,m)}}catch(m){m instanceof qt||m=="unwind"||h(1,m)}};function Qr(){var s=pe,m={};for(let[g,$]of Object.entries(s))m[g]=typeof $=="function"?(...T)=>{Zt.push(g);try{return $(...T)}finally{R||(Zt.pop(),dt&&gt===1&&Zt.length===0&&(gt=0,He(dn),typeof Fibers<"u"&&Fibers.Db()))}}:$;return m}var gt=0,dt=null,Bt=0,Zt=[],kr={},Or={},Jr=0,pr=null,en=[];function tn(){return new Promise((s,m)=>{pr={resolve:s,reject:m}})}function rn(){var s=Nt(65548),m=s+12;se[s>>>2>>>0]=m,se[s+4>>>2>>>0]=m+65536,m=Zt[0];var g=kr[m];return g===void 0&&(g=Jr++,kr[m]=g,Or[g]=m),W[s+8>>>2>>>0]=g,s}function nn(s){if(!R){if(gt===0){var m=!1,g=!1;s(($=0)=>{if(!R&&(Bt=$,m=!0,g)){gt=2,He(()=>vt(dt)),typeof Browser<"u"&&Browser.ib.mb&&Browser.ib.resume(),$=!1;try{var T=(0,pe[Or[W[dt+8>>>2>>>0]]])()}catch(q){T=q,$=!0}var B=!1;if(!dt){var H=pr;H&&(pr=null,($?H.reject:H.resolve)(T),B=!0)}if($&&!B)throw T}}),g=!0,m||(gt=1,dt=rn(),typeof Browser<"u"&&Browser.ib.mb&&Browser.ib.pause(),He(()=>Jt(dt)))}else gt===2?(gt=0,He(ct),rt(dt),dt=null,en.forEach(Xr)):ne(`invalid state: ${gt}`);return Bt}}function Rr(s){return nn(m=>{s().then(m)})}var Xt=[],on={},nt=s=>{var m=on[s];return m===void 0?ft(s):m},mr=()=>typeof globalThis=="object"?globalThis:Function("return this")(),Br=s=>{var m=Xt.length;return Xt.push(s),m},Kn=(s,m)=>{for(var g=Array(s),$=0;$<s;++$)g[$]=cr(se[m+4*$>>>2>>>0],"parameter "+$);return g},wt=(s,m)=>Object.defineProperty(m,"name",{value:s});function Yn(s){var m=Function;if(!(m instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof m} which is not a function`);var g=wt(m.name||"unknownFunctionName",function(){});return g.prototype=m.prototype,g=new g,s=m.apply(g,s),s instanceof Object?s:g}var Je=s=>s%4===0&&(s%100!==0||s%400===0),Dr=[0,31,60,91,121,152,182,213,244,274,305,335],fr=[0,31,59,90,120,151,181,212,243,273,304,334],lt=[],hr=(s,m)=>{lt.length=0;for(var g;g=K[s++>>>0];){var $=g!=105;$&=g!=112,m+=$&&m%8?4:0,lt.push(g==112?se[m>>>2>>>0]:g==106?We[m>>>3]:g==105?W[m>>>2>>>0]:ae[m>>>3>>>0]),m+=$?8:4}return lt},Qe={},ot=()=>{if(!Qt){var s={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:p||"./this.program"},m;for(m in Qe)Qe[m]===void 0?delete s[m]:s[m]=Qe[m];var g=[];for(m in s)g.push(`${m}=${s[m]}`);Qt=g}return Qt},Qt,Zn=[null,[],[]],an=[31,29,31,30,31,30,31,31,30,31,30,31],zr=[31,28,31,30,31,30,31,31,30,31,30,31];function Xn(s){var m=Array(Wt(s)+1);return at(s,m,0,m.length),m}function sn(s,m,g,$){function T(D,be,Ie){for(D=typeof D=="number"?D.toString():D||"";D.length<be;)D=Ie[0]+D;return D}function B(D,be){return T(D,be,"0")}function H(D,be){function Ie(Mt){return 0>Mt?-1:0<Mt?1:0}var zt;return(zt=Ie(D.getFullYear()-be.getFullYear()))===0&&(zt=Ie(D.getMonth()-be.getMonth()))===0&&(zt=Ie(D.getDate()-be.getDate())),zt}function q(D){switch(D.getDay()){case 0:return new Date(D.getFullYear()-1,11,29);case 1:return D;case 2:return new Date(D.getFullYear(),0,3);case 3:return new Date(D.getFullYear(),0,2);case 4:return new Date(D.getFullYear(),0,1);case 5:return new Date(D.getFullYear()-1,11,31);case 6:return new Date(D.getFullYear()-1,11,30)}}function te(D){var be=D.$a;for(D=new Date(new Date(D.ab+1900,0,1).getTime());0<be;){var Ie=D.getMonth(),zt=(Je(D.getFullYear())?an:zr)[Ie];if(be>zt-D.getDate())be-=zt-D.getDate()+1,D.setDate(1),11>Ie?D.setMonth(Ie+1):(D.setMonth(0),D.setFullYear(D.getFullYear()+1));else{D.setDate(D.getDate()+be);break}}return Ie=new Date(D.getFullYear()+1,0,4),be=q(new Date(D.getFullYear(),0,4)),Ie=q(Ie),0>=H(be,D)?0>=H(Ie,D)?D.getFullYear()+1:D.getFullYear():D.getFullYear()-1}s>>>=0,m>>>=0,g>>>=0,$>>>=0;var X=se[$+40>>>2>>>0];$={Ab:W[$>>>2>>>0],zb:W[$+4>>>2>>>0],fb:W[$+8>>>2>>>0],jb:W[$+12>>>2>>>0],gb:W[$+16>>>2>>>0],ab:W[$+20>>>2>>>0],Va:W[$+24>>>2>>>0],$a:W[$+28>>>2>>>0],Cb:W[$+32>>>2>>>0],yb:W[$+36>>>2>>>0],Bb:X?je(X):""},g=je(g),X={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var de in X)g=g.replace(new RegExp(de,"g"),X[de]);var Ee="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Oe="January February March April May June July August September October November December".split(" ");X={"%a":D=>Ee[D.Va].substring(0,3),"%A":D=>Ee[D.Va],"%b":D=>Oe[D.gb].substring(0,3),"%B":D=>Oe[D.gb],"%C":D=>B((D.ab+1900)/100|0,2),"%d":D=>B(D.jb,2),"%e":D=>T(D.jb,2," "),"%g":D=>te(D).toString().substring(2),"%G":te,"%H":D=>B(D.fb,2),"%I":D=>(D=D.fb,D==0?D=12:12<D&&(D-=12),B(D,2)),"%j":D=>{for(var be=0,Ie=0;Ie<=D.gb-1;be+=(Je(D.ab+1900)?an:zr)[Ie++]);return B(D.jb+be,3)},"%m":D=>B(D.gb+1,2),"%M":D=>B(D.zb,2),"%n":()=>`\n`,"%p":D=>0<=D.fb&&12>D.fb?"AM":"PM","%S":D=>B(D.Ab,2),"%t":()=>"	","%u":D=>D.Va||7,"%U":D=>B(Math.floor((D.$a+7-D.Va)/7),2),"%V":D=>{var be=Math.floor((D.$a+7-(D.Va+6)%7)/7);if(2>=(D.Va+371-D.$a-2)%7&&be++,be)be==53&&(Ie=(D.Va+371-D.$a)%7,Ie==4||Ie==3&&Je(D.ab)||(be=1));else{be=52;var Ie=(D.Va+7-D.$a-1)%7;(Ie==4||Ie==5&&Je(D.ab%400-1))&&be++}return B(be,2)},"%w":D=>D.Va,"%W":D=>B(Math.floor((D.$a+7-(D.Va+6)%7)/7),2),"%y":D=>(D.ab+1900).toString().substring(2),"%Y":D=>D.ab+1900,"%z":D=>{D=D.yb;var be=0<=D;return D=Math.abs(D)/60,(be?"+":"-")+("0000"+(D/60*100+D%60)).slice(-4)},"%Z":D=>D.Bb,"%%":()=>"%"},g=g.replace(/%%/g,"\\0\\0");for(de in X)g.includes(de)&&(g=g.replace(new RegExp(de,"g"),X[de]($)));return g=g.replace(/\\0\\0/g,"%"),de=Xn(g),de.length>m?0:(N.set(de,s>>>0),de.length-1)}for(var un=Array(256),gr=0;256>gr;++gr)un[gr]=String.fromCharCode(gr);Cr=un,st=r.BindingError=class extends Error{constructor(s){super(s),this.name="BindingError"}},r.InternalError=class extends Error{constructor(s){super(s),this.name="InternalError"}},Te.push(0,1,void 0,1,null,1,!0,1,!1,1),r.count_emval_handles=()=>Te.length/2-5-Er.length;var Qn={ia:function(s,m,g){return Rr(async()=>{await r.sb(s,m,g)})},a:function(s,m,g){s>>>=0;var $=new Vt(s);throw se[$.hb+16>>>2>>>0]=0,se[$.hb+4>>>2>>>0]=m>>>0,se[$.hb+8>>>2>>>0]=g>>>0,sr=s,jt++,sr},y:function(){return 0},ea:function(){},R:function(){},T:function(){},ga:function(){return 0},ca:function(){},Z:function(){},ba:function(){},G:function(){},S:function(){},P:function(){},da:function(){},Q:function(){},C:function(s,m,g){m=ft(m>>>0),ht(s>>>0,{name:m,fromWireType:$=>$,toWireType:function($,T){if(typeof T!="bigint"&&typeof T!="number")throw T===null?T="null":($=typeof T,T=$==="object"||$==="array"||$==="function"?T.toString():""+T),new TypeError(`Cannot convert "${T}" to ${this.name}`);return typeof T=="number"&&(T=BigInt(T)),T},argPackAdvance:8,readValueFromPointer:bt(m,g>>>0,m.indexOf("u")==-1),bb:null})},K:function(s,m,g,$){m=ft(m>>>0),ht(s>>>0,{name:m,fromWireType:function(T){return!!T},toWireType:function(T,B){return B?g:$},argPackAdvance:8,readValueFromPointer:function(T){return this.fromWireType(K[T>>>0])},bb:null})},J:function(s){return ht(s>>>0,Fn)},B:function(s,m,g){m=ft(m>>>0),ht(s>>>0,{name:m,fromWireType:$=>$,toWireType:($,T)=>T,argPackAdvance:8,readValueFromPointer:ge(m,g>>>0),bb:null})},s:function(s,m,g,$,T){if(s>>>=0,g>>>=0,m=ft(m>>>0),T===-1&&(T=4294967295),T=q=>q,$===0){var B=32-8*g;T=q=>q<<B>>>B}var H=m.includes("unsigned")?function(q,te){return te>>>0}:function(q,te){return te};ht(s,{name:m,fromWireType:T,toWireType:H,argPackAdvance:8,readValueFromPointer:bt(m,g,$!==0),bb:null})},o:function(s,m,g){function $(B){return new T(N.buffer,se[B+4>>>2>>>0],se[B>>>2>>>0])}var T=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][m];g=ft(g>>>0),ht(s>>>0,{name:g,fromWireType:$,argPackAdvance:8,readValueFromPointer:$},{nb:!0})},D:function(s,m){m=ft(m>>>0);var g=m==="std::string";ht(s>>>0,{name:m,fromWireType:function($){var T=se[$>>>2>>>0],B=$+4;if(g)for(var H=B,q=0;q<=T;++q){var te=B+q;if(q==T||K[te>>>0]==0){if(H=je(H,te-H),X===void 0)var X=H;else X+=String.fromCharCode(0),X+=H;H=te+1}}else{for(X=Array(T),q=0;q<T;++q)X[q]=String.fromCharCode(K[B+q>>>0]);X=X.join("")}return rt($),X},toWireType:function($,T){T instanceof ArrayBuffer&&(T=new Uint8Array(T));var B=typeof T=="string";if(!(B||T instanceof Uint8Array||T instanceof Uint8ClampedArray||T instanceof Int8Array))throw new st("Cannot pass non-string to std::string");var H=g&&B?Wt(T):T.length,q=Nt(4+H+1),te=q+4;if(se[q>>>2>>>0]=H,g&&B)at(T,K,te,H+1);else if(B)for(B=0;B<H;++B){var X=T.charCodeAt(B);if(255<X)throw rt(te),new st("String has UTF-16 code units that do not fit in 8 bits");K[te+B>>>0]=X}else for(B=0;B<H;++B)K[te+B>>>0]=T[B];return $!==null&&$.push(rt,q),q},argPackAdvance:8,readValueFromPointer:lr,bb($){rt($)}})},x:function(s,m,g){if(m>>>=0,g>>>=0,g=ft(g),m===2)var $=jr,T=qn,B=Kr,H=q=>he[q>>>1>>>0];else m===4&&($=jn,T=Yr,B=Zr,H=q=>se[q>>>2>>>0]);ht(s>>>0,{name:g,fromWireType:q=>{for(var te=se[q>>>2>>>0],X,de=q+4,Ee=0;Ee<=te;++Ee){var Oe=q+4+Ee*m;(Ee==te||H(Oe)==0)&&(de=$(de,Oe-de),X===void 0?X=de:(X+=String.fromCharCode(0),X+=de),de=Oe+m)}return rt(q),X},toWireType:(q,te)=>{if(typeof te!="string")throw new st(`Cannot pass non-string to C++ string type ${g}`);var X=B(te),de=Nt(4+X+m);return se[de>>>2>>>0]=X/m,T(te,de+4,X+m),q!==null&&q.push(rt,de),de},argPackAdvance:8,readValueFromPointer:lr,bb(q){rt(q)}})},L:function(s,m){m=ft(m>>>0),ht(s>>>0,{ob:!0,name:m,argPackAdvance:0,fromWireType:()=>{},toWireType:()=>{}})},ha:()=>1,u:function(s,m,g){return m>>>=0,g>>>=0,s=Xe(s>>>0),m=cr(m,"emval::as"),Pr(m,g,s)},w:function(s){return s>>>=0,Rr(()=>(s=Xe(s),s.then(ut)))},n:function(s,m,g,$){return g>>>=0,$>>>=0,s=Xt[s>>>0],m=Xe(m>>>0),s(null,m,g,$)},j:function(s,m,g,$,T){return g>>>=0,$>>>=0,T>>>=0,s=Xt[s>>>0],m=Xe(m>>>0),g=nt(g),s(m,m[g],$,T)},b:dr,A:function(s,m){return m>>>=0,s=Xe(s>>>0),m=Xe(m),s==m},m:function(s){return s>>>=0,s===0?ut(mr()):(s=nt(s),ut(mr()[s]))},i:function(s,m,g){m=Kn(s,m>>>0);var $=m.shift();s--;var T=`return function (obj, func, destructorsRef, args) {\n`,B=0,H=[];g===0&&H.push("obj");for(var q=["retType"],te=[$],X=0;X<s;++X)H.push("arg"+X),q.push("argType"+X),te.push(m[X]),T+=`  var arg${X} = argType${X}.readValueFromPointer(args${B?"+"+B:""});\n`,B+=m[X].argPackAdvance;return T+=`  var rv = ${g===1?"new func":"func.call"}(${H.join(", ")});\n`,$.ob||(q.push("emval_returnValue"),te.push(Pr),T+=`  return emval_returnValue(retType, destructorsRef, rv);\n`),q.push(T+`};\n`),s=Yn(q)(...te),g=`methodCaller<(${m.map(de=>de.name).join(", ")}) => ${$.name}>`,Br(wt(g,s))},r:function(s,m){return m>>>=0,s=Xe(s>>>0),m=Xe(m),ut(s[m])},e:function(s){s>>>=0,9<s&&(Te[s+1]+=1)},t:function(){return ut([])},l:function(s){s=Xe(s>>>0);for(var m=Array(s.length),g=0;g<s.length;g++)m[g]=s[g];return ut(m)},f:function(s){return ut(nt(s>>>0))},k:function(){return ut({})},h:function(s){s>>>=0;for(var m=Xe(s);m.length;){var g=m.pop();m.pop()(g)}dr(s)},g:function(s,m,g){m>>>=0,g>>>=0,s=Xe(s>>>0),m=Xe(m),g=Xe(g),s[m]=g},c:function(s,m){return m>>>=0,s=cr(s>>>0,"_emval_take_value"),s=s.readValueFromPointer(m),ut(s)},W:function(s,m){s=-9007199254740992>s||9007199254740992<s?NaN:Number(s),m>>>=0,s=new Date(1e3*s),W[m>>>2>>>0]=s.getUTCSeconds(),W[m+4>>>2>>>0]=s.getUTCMinutes(),W[m+8>>>2>>>0]=s.getUTCHours(),W[m+12>>>2>>>0]=s.getUTCDate(),W[m+16>>>2>>>0]=s.getUTCMonth(),W[m+20>>>2>>>0]=s.getUTCFullYear()-1900,W[m+24>>>2>>>0]=s.getUTCDay(),W[m+28>>>2>>>0]=(s.getTime()-Date.UTC(s.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},X:function(s,m){s=-9007199254740992>s||9007199254740992<s?NaN:Number(s),m>>>=0,s=new Date(1e3*s),W[m>>>2>>>0]=s.getSeconds(),W[m+4>>>2>>>0]=s.getMinutes(),W[m+8>>>2>>>0]=s.getHours(),W[m+12>>>2>>>0]=s.getDate(),W[m+16>>>2>>>0]=s.getMonth(),W[m+20>>>2>>>0]=s.getFullYear()-1900,W[m+24>>>2>>>0]=s.getDay(),W[m+28>>>2>>>0]=(Je(s.getFullYear())?Dr:fr)[s.getMonth()]+s.getDate()-1|0,W[m+36>>>2>>>0]=-(60*s.getTimezoneOffset());var g=new Date(s.getFullYear(),6,1).getTimezoneOffset(),$=new Date(s.getFullYear(),0,1).getTimezoneOffset();W[m+32>>>2>>>0]=(g!=$&&s.getTimezoneOffset()==Math.min($,g))|0},Y:function(s){s>>>=0;var m=new Date(W[s+20>>>2>>>0]+1900,W[s+16>>>2>>>0],W[s+12>>>2>>>0],W[s+8>>>2>>>0],W[s+4>>>2>>>0],W[s>>>2>>>0],0),g=W[s+32>>>2>>>0],$=m.getTimezoneOffset(),T=new Date(m.getFullYear(),6,1).getTimezoneOffset(),B=new Date(m.getFullYear(),0,1).getTimezoneOffset(),H=Math.min(B,T);return 0>g?W[s+32>>>2>>>0]=+(T!=B&&H==$):0<g!=(H==$)&&(T=Math.max(B,T),m.setTime(m.getTime()+6e4*((0<g?H:T)-$))),W[s+24>>>2>>>0]=m.getDay(),W[s+28>>>2>>>0]=(Je(m.getFullYear())?Dr:fr)[m.getMonth()]+m.getDate()-1|0,W[s>>>2>>>0]=m.getSeconds(),W[s+4>>>2>>>0]=m.getMinutes(),W[s+8>>>2>>>0]=m.getHours(),W[s+12>>>2>>>0]=m.getDate(),W[s+16>>>2>>>0]=m.getMonth(),W[s+20>>>2>>>0]=m.getYear(),s=m.getTime(),BigInt(isNaN(s)?-1:s/1e3)},U:function(){return-52},V:function(){},N:function(s,m,g,$){g>>>=0,$>>>=0;var T=new Date().getFullYear(),B=new Date(T,0,1),H=new Date(T,6,1);T=B.getTimezoneOffset();var q=H.getTimezoneOffset();se[s>>>0>>>2>>>0]=60*Math.max(T,q),W[m>>>0>>>2>>>0]=+(T!=q),s=te=>te.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1],B=s(B),H=s(H),q<T?(at(B,K,g,17),at(H,K,$,17)):(at(B,K,$,17),at(H,K,g,17))},v:()=>{ne("")},d:function(s,m,g){return s>>>=0,m=hr(m>>>0,g>>>0),Rt[s](...m)},I:function(s,m,g){return s>>>=0,m=hr(m>>>0,g>>>0),Rt[s](...m)},H:()=>Date.now(),O:function(){return 4294901760},q:()=>performance.now(),M:function(s){s>>>=0;var m=K.length;if(4294901760<s)return!1;for(var g=1;4>=g;g*=2){var $=m*(1+.2/g);$=Math.min($,s+100663296);var T=Math;$=Math.max(s,$);e:{T=(T.min.call(T,4294901760,$+(65536-$%65536)%65536)-O.buffer.byteLength+65535)/65536;try{O.grow(T),Ae();var B=1;break e}catch{}B=void 0}if(B)return!0}return!1},$:function(s,m){s>>>=0,m>>>=0;var g=0;return ot().forEach(($,T)=>{var B=m+g;for(T=se[s+4*T>>>2>>>0]=B,B=0;B<$.length;++B)N[T++>>>0]=$.charCodeAt(B);N[T>>>0]=0,g+=$.length+1}),0},aa:function(s,m){s>>>=0,m>>>=0;var g=ot();se[s>>>2>>>0]=g.length;var $=0;return g.forEach(T=>$+=T.length+1),se[m>>>2>>>0]=$,0},z:()=>52,F:function(){return 52},_:function(){return 70},E:function(s,m,g,$){m>>>=0,g>>>=0,$>>>=0;for(var T=0,B=0;B<g;B++){var H=se[m>>>2>>>0],q=se[m+4>>>2>>>0];m+=8;for(var te=0;te<q;te++){var X=K[H+te>>>0],de=Zn[s];X===0||X===10?((s===1?E:P)(Kt(de,0)),de.length=0):de.push(X)}T+=q}return se[$>>>2>>>0]=T,0},fa:sn,p:function(s,m,g,$){return sn(s>>>0,m>>>0,g>>>0,$>>>0)}},pe=function(){function s(g){return pe=g.exports,pe=Qr(),pe=ln(),O=pe.ja,Ae(),ie.unshift(pe.ka),le--,le==0&&(qe!==null&&(clearInterval(qe),qe=null),G&&(g=G,G=null,g())),pe}var m={a:Qn};if(le++,r.instantiateWasm)try{return r.instantiateWasm(m,s)}catch(g){P(`Module.instantiateWasm callback failed with error: ${g}`),i(g)}return mt(m,function(g){s(g.instance)}).catch(i),{}}(),Mr=s=>(Mr=pe.la)(s);r._OrtInit=(s,m)=>(r._OrtInit=pe.ma)(s,m),r._OrtGetLastError=(s,m)=>(r._OrtGetLastError=pe.na)(s,m),r._OrtCreateSessionOptions=(s,m,g,$,T,B,H,q,te,X)=>(r._OrtCreateSessionOptions=pe.oa)(s,m,g,$,T,B,H,q,te,X),r._OrtAppendExecutionProvider=(s,m)=>(r._OrtAppendExecutionProvider=pe.pa)(s,m),r._OrtAddFreeDimensionOverride=(s,m,g)=>(r._OrtAddFreeDimensionOverride=pe.qa)(s,m,g),r._OrtAddSessionConfigEntry=(s,m,g)=>(r._OrtAddSessionConfigEntry=pe.ra)(s,m,g),r._OrtReleaseSessionOptions=s=>(r._OrtReleaseSessionOptions=pe.sa)(s),r._OrtCreateSession=(s,m,g)=>(r._OrtCreateSession=pe.ta)(s,m,g),r._OrtReleaseSession=s=>(r._OrtReleaseSession=pe.ua)(s),r._OrtGetInputOutputCount=(s,m,g)=>(r._OrtGetInputOutputCount=pe.va)(s,m,g),r._OrtGetInputName=(s,m)=>(r._OrtGetInputName=pe.wa)(s,m),r._OrtGetOutputName=(s,m)=>(r._OrtGetOutputName=pe.xa)(s,m),r._OrtFree=s=>(r._OrtFree=pe.ya)(s),r._OrtCreateTensor=(s,m,g,$,T,B)=>(r._OrtCreateTensor=pe.za)(s,m,g,$,T,B),r._OrtGetTensorData=(s,m,g,$,T)=>(r._OrtGetTensorData=pe.Aa)(s,m,g,$,T),r._OrtReleaseTensor=s=>(r._OrtReleaseTensor=pe.Ba)(s),r._OrtCreateRunOptions=(s,m,g,$)=>(r._OrtCreateRunOptions=pe.Ca)(s,m,g,$),r._OrtAddRunConfigEntry=(s,m,g)=>(r._OrtAddRunConfigEntry=pe.Da)(s,m,g),r._OrtReleaseRunOptions=s=>(r._OrtReleaseRunOptions=pe.Ea)(s),r._OrtCreateBinding=s=>(r._OrtCreateBinding=pe.Fa)(s),r._OrtBindInput=(s,m,g)=>(r._OrtBindInput=pe.Ga)(s,m,g),r._OrtBindOutput=(s,m,g,$)=>(r._OrtBindOutput=pe.Ha)(s,m,g,$),r._OrtClearBoundOutputs=s=>(r._OrtClearBoundOutputs=pe.Ia)(s),r._OrtReleaseBinding=s=>(r._OrtReleaseBinding=pe.Ja)(s),r._OrtRunWithBinding=(s,m,g,$,T)=>(r._OrtRunWithBinding=pe.Ka)(s,m,g,$,T),r._OrtRun=(s,m,g,$,T,B,H,q)=>(r._OrtRun=pe.La)(s,m,g,$,T,B,H,q),r._OrtEndProfiling=s=>(r._OrtEndProfiling=pe.Ma)(s),r._JsepOutput=(s,m,g)=>(r._JsepOutput=pe.Na)(s,m,g),r._JsepGetNodeName=s=>(r._JsepGetNodeName=pe.Oa)(s);var Nt=r._malloc=s=>(Nt=r._malloc=pe.Pa)(s),rt=r._free=s=>(rt=r._free=pe.Qa)(s),yr=s=>(yr=pe.Sa)(s),br=s=>(br=pe.Ta)(s),Ur=()=>(Ur=pe.Ua)(),Jt=s=>(Jt=pe.Wa)(s),dn=()=>(dn=pe.Xa)(),vt=s=>(vt=pe.Ya)(s),ct=()=>(ct=pe.Za)();r.___start_em_js=837952,r.___stop_em_js=838113;function ln(){var s=pe;s=Object.assign({},s);var m=g=>$=>g($)>>>0;return s.la=m(s.la),s.Pa=m(s.Pa),s.Ta=m(s.Ta),s.Ua=(g=>()=>g()>>>0)(s.Ua),s}r.stackSave=()=>Ur(),r.stackRestore=s=>yr(s),r.stackAlloc=s=>br(s),r.UTF8ToString=je,r.stringToUTF8=(s,m,g)=>at(s,K,m,g),r.lengthBytesUTF8=Wt;var Dt;G=function s(){Dt||Vr(),Dt||(G=s)};function Vr(){if(!(0<le)){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;){var s=r.preRun.shift();me.unshift(s)}for(;0<me.length;)me.shift()(r);if(!(0<le||Dt||(Dt=!0,r.calledRun=!0,R))){for(;0<ie.length;)ie.shift()(r);for(o(r);0<ue.length;)ue.shift()(r)}}}return Vr(),u}})();typeof Ti=="object"&&typeof po=="object"?po.exports=Ii:typeof define=="function"&&define.amd&&define([],()=>Ii)});var Pi=Wr(()=>{});var ki=Wr(()=>{});var Oi={};gn(Oi,{cpus:()=>ll});var ll,Ri=Y(()=>{ll=void 0});var zi=Wr((Di,mo)=>{"use strict";var Bi=(()=>{var e=typeof document<"u"?document.currentScript?.src:void 0;return typeof __filename<"u"&&(e||=__filename),function(t={}){function r(){return ae.buffer!=ue.buffer&&Ne(),ue}function o(){return ae.buffer!=ue.buffer&&Ne(),le}function i(){return ae.buffer!=ue.buffer&&Ne(),qe}function u(){return ae.buffer!=ue.buffer&&Ne(),G}function a(){return ae.buffer!=ue.buffer&&Ne(),ne}function c(){return ae.buffer!=ue.buffer&&Ne(),xe}function p(){return ae.buffer!=ue.buffer&&Ne(),Ke}function h(){return ae.buffer!=ue.buffer&&Ne(),Ut}var d=t,y,w,_=new Promise((n,l)=>{y=n,w=l});d.mountExternalData=(n,l)=>{(d.Db||(d.Db=new Map)).set(n,l)},d.unmountExternalData=()=>{delete d.Db};let v=()=>{let n=(f,b,C)=>(...k)=>{let V=ct,F=b?.();k=f(...k);let re=b?.();return F!==re&&(f=re,C(F),b=C=null),ct!=V?T():k},l=f=>async(...b)=>{try{if(d.Cb)throw Error("Session already started");let C=d.Cb={ec:b[0],errors:[]},k=await f(...b);if(d.Cb!==C)throw Error("Session mismatch");d.Kb?.flush();let V=C.errors;if(0<V.length){let F=await Promise.all(V);if(F=F.filter(re=>re),0<F.length)throw Error(F.join(`\n`))}return k}finally{d.Cb=null}};d._OrtCreateSession=n(d._OrtCreateSession,()=>d._OrtCreateSession,f=>d._OrtCreateSession=f),d._OrtRun=l(n(d._OrtRun,()=>d._OrtRun,f=>d._OrtRun=f)),d._OrtRunWithBinding=l(n(d._OrtRunWithBinding,()=>d._OrtRunWithBinding,f=>d._OrtRunWithBinding=f)),d._OrtBindInput=n(d._OrtBindInput,()=>d._OrtBindInput,f=>d._OrtBindInput=f),v=void 0};d.jsepInit=(n,l)=>{if(v?.(),n==="webgpu"){[d.Kb,d.Wb,d.$b,d.Lb,d.Zb,d.ob,d.ac,d.cc,d.Xb,d.Yb,d.bc]=l;let f=d.Kb;d.jsepRegisterBuffer=(b,C,k,V)=>f.registerBuffer(b,C,k,V),d.jsepGetBuffer=b=>f.getBuffer(b),d.jsepCreateDownloader=(b,C,k)=>f.createDownloader(b,C,k),d.jsepOnReleaseSession=b=>{f.onReleaseSession(b)},d.jsepOnRunStart=b=>f.onRunStart(b)}};var S=Object.assign({},d),A="./this.program",I=(n,l)=>{throw l},x=typeof window=="object",E=typeof importScripts=="function",P=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",O=d.ENVIRONMENT_IS_PTHREAD||!1,R="";function L(n){return d.locateFile?d.locateFile(n,R):R+n}var N,K,Q;if(P){var he=(uo(),wr(so)),W=(co(),wr(lo));R=E?W.dirname(R)+"/":__dirname+"/",N=(n,l)=>(n=Wt(n)?new URL(n):W.normalize(n),he.readFileSync(n,l?void 0:"utf8")),Q=n=>(n=N(n,!0),n.buffer||(n=new Uint8Array(n)),n),K=(n,l,f,b=!0)=>{n=Wt(n)?new URL(n):W.normalize(n),he.readFile(n,b?void 0:"utf8",(C,k)=>{C?f(C):l(b?k.buffer:k)})},!d.thisProgram&&1<process.argv.length&&(A=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),I=(n,l)=>{throw process.exitCode=n,l},global.Worker=Pi().Worker}else(x||E)&&(E?R=self.location.href:typeof document<"u"&&document.currentScript&&(R=document.currentScript.src),typeof e<"u"&&e&&(R=e),R.startsWith("blob:")?R="":R=R.substr(0,R.replace(/[?#].*/,"").lastIndexOf("/")+1),P||(N=n=>{var l=new XMLHttpRequest;return l.open("GET",n,!1),l.send(null),l.responseText},E&&(Q=n=>{var l=new XMLHttpRequest;return l.open("GET",n,!1),l.responseType="arraybuffer",l.send(null),new Uint8Array(l.response)}),K=(n,l,f)=>{var b=new XMLHttpRequest;b.open("GET",n,!0),b.responseType="arraybuffer",b.onload=()=>{b.status==200||b.status==0&&b.response?l(b.response):f()},b.onerror=f,b.send(null)}));P&&typeof performance>"u"&&(global.performance=ki().performance);var se=console.log.bind(console),Ce=console.error.bind(console);P&&(se=(...n)=>he.writeSync(1,n.join(" ")+`\n`),Ce=(...n)=>he.writeSync(2,n.join(" ")+`\n`));var We=se,ee=Ce;Object.assign(d,S),S=null;var ae,Ae,me=!1,ie,ue,le,qe,G,ne,xe,Ke,Be,Ge,Ut;function Ne(){var n=ae.buffer;d.HEAP8=ue=new Int8Array(n),d.HEAP16=qe=new Int16Array(n),d.HEAPU8=le=new Uint8Array(n),d.HEAPU16=G=new Uint16Array(n),d.HEAP32=ne=new Int32Array(n),d.HEAPU32=xe=new Uint32Array(n),d.HEAPF32=Ke=new Float32Array(n),d.HEAPF64=Ut=new Float64Array(n),d.HEAP64=Be=new BigInt64Array(n),d.HEAPU64=Ge=new BigUint64Array(n)}var Ye=16777216;if(O)ae=d.wasmMemory;else if(d.wasmMemory)ae=d.wasmMemory;else if(ae=new WebAssembly.Memory({initial:Ye/65536,maximum:65536,shared:!0}),!(ae.buffer instanceof SharedArrayBuffer))throw ee("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),P&&ee("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");Ne(),Ye=ae.buffer.byteLength;var mt=[],Rt=[],qt=[],Vt=0,sr=null,jt=null;function xr(){if(Vt--,Vt==0&&(sr!==null&&(clearInterval(sr),sr=null),jt)){var n=jt;jt=null,n()}}function Kt(n){throw n="Aborted("+n+")",ee(n),me=!0,ie=1,n=new WebAssembly.RuntimeError(n+". Build with -sASSERTIONS for more info."),w(n),n}var je=n=>n.startsWith("data:application/octet-stream;base64,"),Wt=n=>n.startsWith("file://"),at;at="ort-wasm-simd-threaded.wasm",je(at)||(at=L(at));function Cr(n){if(Q)return Q(n);throw"both async and sync fetching of the wasm failed"}function ft(n){if(x||E){if(typeof fetch=="function"&&!Wt(n))return fetch(n,{credentials:"same-origin"}).then(l=>{if(!l.ok)throw`failed to load wasm binary file at \'${n}\'`;return l.arrayBuffer()}).catch(()=>Cr(n));if(K)return new Promise((l,f)=>{K(n,b=>l(new Uint8Array(b)),f)})}return Promise.resolve().then(()=>Cr(n))}function ur(n,l,f){return ft(n).then(b=>WebAssembly.instantiate(b,l)).then(f,b=>{ee(`failed to asynchronously prepare wasm: ${b}`),Kt(b)})}function Ar(n,l){var f=at;return typeof WebAssembly.instantiateStreaming!="function"||je(f)||Wt(f)||P||typeof fetch!="function"?ur(f,n,l):fetch(f,{credentials:"same-origin"}).then(b=>WebAssembly.instantiateStreaming(b,n).then(l,function(C){return ee(`wasm streaming compile failed: ${C}`),ee("falling back to ArrayBuffer instantiation"),ur(f,n,l)}))}var Ir={826468:(n,l,f,b)=>{if(typeof d>"u"||!d.Db)return 1;if(n=He(n>>>0),n.startsWith("./")&&(n=n.substring(2)),n=d.Db.get(n),!n)return 2;if(l>>>=0,f>>>=0,b>>>=0,l+f>n.byteLength)return 3;try{return o().set(n.subarray(l,l+f),b>>>0),0}catch{return 4}},826969:()=>{d.Xb()},827e3:()=>{d.Yb()},827029:()=>{d.bc()},827054:n=>d.Wb(n),827087:n=>d.$b(n),827119:(n,l,f)=>{d.Lb(n,l,f,!0)},827158:(n,l,f)=>{d.Lb(n,l,f)},827191:n=>{d.ob("Abs",n,void 0)},827242:n=>{d.ob("Neg",n,void 0)},827293:n=>{d.ob("Floor",n,void 0)},827346:n=>{d.ob("Ceil",n,void 0)},827398:n=>{d.ob("Reciprocal",n,void 0)},827456:n=>{d.ob("Sqrt",n,void 0)},827508:n=>{d.ob("Exp",n,void 0)},827559:n=>{d.ob("Erf",n,void 0)},827610:n=>{d.ob("Sigmoid",n,void 0)},827665:(n,l,f)=>{d.ob("HardSigmoid",n,{alpha:l,beta:f})},827744:n=>{d.ob("Log",n,void 0)},827795:n=>{d.ob("Sin",n,void 0)},827846:n=>{d.ob("Cos",n,void 0)},827897:n=>{d.ob("Tan",n,void 0)},827948:n=>{d.ob("Asin",n,void 0)},828e3:n=>{d.ob("Acos",n,void 0)},828052:n=>{d.ob("Atan",n,void 0)},828104:n=>{d.ob("Sinh",n,void 0)},828156:n=>{d.ob("Cosh",n,void 0)},828208:n=>{d.ob("Asinh",n,void 0)},828261:n=>{d.ob("Acosh",n,void 0)},828314:n=>{d.ob("Atanh",n,void 0)},828367:n=>{d.ob("Tanh",n,void 0)},828419:n=>{d.ob("Not",n,void 0)},828470:(n,l,f)=>{d.ob("Clip",n,{min:l,max:f})},828539:n=>{d.ob("Clip",n,void 0)},828591:(n,l)=>{d.ob("Elu",n,{alpha:l})},828649:n=>{d.ob("Relu",n,void 0)},828701:(n,l)=>{d.ob("LeakyRelu",n,{alpha:l})},828765:(n,l)=>{d.ob("ThresholdedRelu",n,{alpha:l})},828835:(n,l)=>{d.ob("Cast",n,{to:l})},828893:n=>{d.ob("Add",n,void 0)},828944:n=>{d.ob("Sub",n,void 0)},828995:n=>{d.ob("Mul",n,void 0)},829046:n=>{d.ob("Div",n,void 0)},829097:n=>{d.ob("Pow",n,void 0)},829148:n=>{d.ob("Equal",n,void 0)},829201:n=>{d.ob("Greater",n,void 0)},829256:n=>{d.ob("GreaterOrEqual",n,void 0)},829318:n=>{d.ob("Less",n,void 0)},829370:n=>{d.ob("LessOrEqual",n,void 0)},829429:(n,l,f,b,C)=>{d.ob("ReduceMean",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},829588:(n,l,f,b,C)=>{d.ob("ReduceMax",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},829746:(n,l,f,b,C)=>{d.ob("ReduceMin",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},829904:(n,l,f,b,C)=>{d.ob("ReduceProd",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},830063:(n,l,f,b,C)=>{d.ob("ReduceSum",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},830221:(n,l,f,b,C)=>{d.ob("ReduceL1",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},830378:(n,l,f,b,C)=>{d.ob("ReduceL2",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},830535:(n,l,f,b,C)=>{d.ob("ReduceLogSum",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},830696:(n,l,f,b,C)=>{d.ob("ReduceSumSquare",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},830860:(n,l,f,b,C)=>{d.ob("ReduceLogSumExp",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},831024:n=>{d.ob("Where",n,void 0)},831077:(n,l,f)=>{d.ob("Transpose",n,{perm:l?Array.from(a().subarray(l>>>0,f>>>0)):[]})},831185:(n,l,f,b)=>{d.ob("DepthToSpace",n,{blocksize:l,mode:He(f),format:b?"NHWC":"NCHW"})},831318:(n,l,f,b)=>{d.ob("DepthToSpace",n,{blocksize:l,mode:He(f),format:b?"NHWC":"NCHW"})},831451:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z,we)=>{d.ob("ConvTranspose",n,{format:re?"NHWC":"NCHW",autoPad:l,dilations:[f],group:b,kernelShape:[C],pads:[k,V],strides:[F],wIsConst:()=>!!r()[J>>>0],outputPadding:ce?Array.from(a().subarray(ce>>>0,Re>>>0)):[],outputShape:ze?Array.from(a().subarray(ze>>>0,z>>>0)):[],activation:He(we)})},831852:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z)=>{d.ob("ConvTranspose",n,{format:F?"NHWC":"NCHW",autoPad:l,dilations:Array.from(a().subarray(f>>>0,(f>>>0)+2>>>0)),group:b,kernelShape:Array.from(a().subarray(C>>>0,(C>>>0)+2>>>0)),pads:Array.from(a().subarray(k>>>0,(k>>>0)+4>>>0)),strides:Array.from(a().subarray(V>>>0,(V>>>0)+2>>>0)),wIsConst:()=>!!r()[re>>>0],outputPadding:J?Array.from(a().subarray(J>>>0,ce>>>0)):[],outputShape:Re?Array.from(a().subarray(Re>>>0,ze>>>0)):[],activation:He(z)})},832417:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z,we)=>{d.ob("ConvTranspose",n,{format:re?"NHWC":"NCHW",autoPad:l,dilations:[f],group:b,kernelShape:[C],pads:[k,V],strides:[F],wIsConst:()=>!!r()[J>>>0],outputPadding:ce?Array.from(a().subarray(ce>>>0,Re>>>0)):[],outputShape:ze?Array.from(a().subarray(ze>>>0,z>>>0)):[],activation:He(we)})},832818:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z)=>{d.ob("ConvTranspose",n,{format:F?"NHWC":"NCHW",autoPad:l,dilations:Array.from(a().subarray(f>>>0,(f>>>0)+2>>>0)),group:b,kernelShape:Array.from(a().subarray(C>>>0,(C>>>0)+2>>>0)),pads:Array.from(a().subarray(k>>>0,(k>>>0)+4>>>0)),strides:Array.from(a().subarray(V>>>0,(V>>>0)+2>>>0)),wIsConst:()=>!!r()[re>>>0],outputPadding:J?Array.from(a().subarray(J>>>0,ce>>>0)):[],outputShape:Re?Array.from(a().subarray(Re>>>0,ze>>>0)):[],activation:He(z)})},833383:(n,l)=>{d.ob("GlobalAveragePool",n,{format:l?"NHWC":"NCHW"})},833474:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z,we,Pe)=>{d.ob("AveragePool",n,{format:Pe?"NHWC":"NCHW",auto_pad:l,ceil_mode:f,count_include_pad:b,storage_order:C,dilations:[k,V],kernel_shape:[F,re],pads:[J,ce,Re,ze],strides:[z,we]})},833758:(n,l)=>{d.ob("GlobalAveragePool",n,{format:l?"NHWC":"NCHW"})},833849:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z,we,Pe)=>{d.ob("AveragePool",n,{format:Pe?"NHWC":"NCHW",auto_pad:l,ceil_mode:f,count_include_pad:b,storage_order:C,dilations:[k,V],kernel_shape:[F,re],pads:[J,ce,Re,ze],strides:[z,we]})},834133:(n,l)=>{d.ob("GlobalMaxPool",n,{format:l?"NHWC":"NCHW"})},834220:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z,we,Pe)=>{d.ob("MaxPool",n,{format:Pe?"NHWC":"NCHW",auto_pad:l,ceil_mode:f,count_include_pad:b,storage_order:C,dilations:[k,V],kernel_shape:[F,re],pads:[J,ce,Re,ze],strides:[z,we]})},834500:(n,l)=>{d.ob("GlobalMaxPool",n,{format:l?"NHWC":"NCHW"})},834587:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z,we,Pe)=>{d.ob("MaxPool",n,{format:Pe?"NHWC":"NCHW",auto_pad:l,ceil_mode:f,count_include_pad:b,storage_order:C,dilations:[k,V],kernel_shape:[F,re],pads:[J,ce,Re,ze],strides:[z,we]})},834867:(n,l,f,b,C)=>{d.ob("Gemm",n,{alpha:l,beta:f,transA:b,transB:C})},834971:n=>{d.ob("MatMul",n,void 0)},835025:(n,l,f,b)=>{d.ob("ArgMax",n,{keepDims:!!l,selectLastIndex:!!f,axis:b})},835133:(n,l,f,b)=>{d.ob("ArgMin",n,{keepDims:!!l,selectLastIndex:!!f,axis:b})},835241:(n,l)=>{d.ob("Softmax",n,{axis:l})},835304:(n,l)=>{d.ob("Concat",n,{axis:l})},835364:(n,l,f,b,C)=>{d.ob("Split",n,{axis:l,numOutputs:f,splitSizes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},835504:n=>{d.ob("Expand",n,void 0)},835558:(n,l)=>{d.ob("Gather",n,{axis:Number(l)})},835629:(n,l)=>{d.ob("GatherElements",n,{axis:Number(l)})},835708:(n,l,f,b,C,k,V,F,re,J,ce)=>{d.ob("Resize",n,{antialias:l,axes:f?Array.from(a().subarray(f>>>0,b>>>0)):[],coordinateTransformMode:He(C),cubicCoeffA:k,excludeOutside:V,extrapolationValue:F,keepAspectRatioPolicy:He(re),mode:He(J),nearestMode:He(ce)})},836054:(n,l,f,b,C,k,V)=>{d.ob("Slice",n,{starts:l?Array.from(a().subarray(l>>>0,f>>>0)):[],ends:b?Array.from(a().subarray(b>>>0,C>>>0)):[],axes:k?Array.from(a().subarray(k>>>0,V>>>0)):[]})},836270:n=>{d.ob("Tile",n,void 0)},836322:(n,l,f,b)=>{d.ob("LayerNormalization",n,{axis:l,epsilon:f,simplified:!!b})},836433:(n,l,f)=>{d.ob("InstanceNormalization",n,{epsilon:l,format:f?"NHWC":"NCHW"})},836547:(n,l,f)=>{d.ob("InstanceNormalization",n,{epsilon:l,format:f?"NHWC":"NCHW"})},836661:n=>{d.ob("Range",n,void 0)},836714:(n,l)=>{d.ob("Einsum",n,{equation:He(l)})},836795:(n,l,f,b,C)=>{d.ob("Pad",n,{mode:l,value:f,pads:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},836922:(n,l,f,b,C,k)=>{d.ob("BatchNormalization",n,{epsilon:l,momentum:f,spatial:!!C,trainingMode:!!b,format:k?"NHWC":"NCHW"})},837091:(n,l,f,b,C,k)=>{d.ob("BatchNormalization",n,{epsilon:l,momentum:f,spatial:!!C,trainingMode:!!b,format:k?"NHWC":"NCHW"})},837260:(n,l,f)=>{d.ob("CumSum",n,{exclusive:Number(l),reverse:Number(f)})},837357:(n,l,f,b,C,k,V,F,re)=>{d.ob("Attention",n,{numHeads:l,isUnidirectional:f,maskFilterValue:b,scale:C,doRotary:k,qkvHiddenSizes:V?Array.from(a().subarray(Number(F)>>>0,Number(F)+V>>>0)):[],pastPresentShareBuffer:!!re})},837629:n=>{d.ob("BiasAdd",n,void 0)},837684:n=>{d.ob("BiasSplitGelu",n,void 0)},837745:n=>{d.ob("FastGelu",n,void 0)},837801:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze)=>{d.ob("Conv",n,{format:re?"NHWC":"NCHW",auto_pad:l,dilations:[f],group:b,kernel_shape:[C],pads:k?Array.from(a().subarray(k>>>0,V>>>0)):[],strides:[F],w_is_const:()=>!!r()[J>>>0],activation:He(ce),activation_params:Re?Array.from(p().subarray(Re>>>0,ze>>>0)):[]})},838171:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z,we,Pe)=>{d.ob("Conv",n,{format:Re?"NHWC":"NCHW",auto_pad:l,dilations:[f,b],group:C,kernel_shape:[k,V],pads:F?Array.from(a().subarray(F>>>0,re>>>0)):[],strides:[J,ce],w_is_const:()=>!!r()[ze>>>0],activation:He(z),activation_params:we?Array.from(p().subarray(we>>>0,Pe>>>0)):[]})},838562:n=>{d.ob("Gelu",n,void 0)},838614:(n,l,f,b,C,k)=>{d.ob("MatMulNBits",n,{k:l,n:f,accuracyLevel:b,bits:C,blockSize:k})},838741:(n,l,f,b,C,k)=>{d.ob("MultiHeadAttention",n,{numHeads:l,isUnidirectional:f,maskFilterValue:b,scale:C,doRotary:k})},838900:(n,l,f,b,C)=>{d.ob("RotaryEmbedding",n,{interleaved:!!l,numHeads:f,rotaryEmbeddingDim:b,scale:C})},839039:(n,l,f)=>{d.ob("SkipLayerNormalization",n,{epsilon:l,simplified:!!f})},839141:(n,l,f)=>{d.ob("SkipLayerNormalization",n,{epsilon:l,simplified:!!f})},839243:(n,l,f,b)=>{d.ob("LayerNormalization",n,{axis:l,epsilon:f,simplified:!!b})},839354:n=>{d.ac(n)},839388:(n,l)=>d.cc(n,l,d.Cb.ec,d.Cb.errors)};function st(n){this.name="ExitStatus",this.message=`Program terminated with exit(${n})`,this.status=n}var Tr=n=>{n.terminate(),n.onmessage=()=>{}},ht=n=>{ge.xb.length==0&&(lr(),ge.Mb(ge.xb[0]));var l=ge.xb.pop();if(!l)return 6;ge.yb.push(l),ge.ub[n.wb]=l,l.wb=n.wb;var f={cmd:"run",start_routine:n.fc,arg:n.Rb,pthread_ptr:n.wb};return P&&l.unref(),l.postMessage(f,n.mc),0},bt=0,Er=n=>{var l=io();return n=n(),fn(l),n},Te=(n,l,...f)=>Er(()=>{for(var b=2*f.length,C=oo(8*b),k=C>>>3,V=0;V<f.length;V++){var F=f[V];typeof F=="bigint"?(Be[k+2*V]=1n,Be[k+2*V+1]=F):(Be[k+2*V]=0n,h()[k+2*V+1>>>0]=F)}return gi(n,0,b,C,l)});function dr(n){if(O)return Te(0,1,n);ie=n,0<bt||(ge.hc(),d.onExit?.(n),me=!0),I(n,new st(n))}var Xe=n=>{if(ie=n,O)throw jr(n),"unwind";dr(n)};function ut(){for(var n=d.numThreads;n--;)lr();mt.unshift(()=>{Vt++,Fn(()=>xr())})}function lr(){var n=L("ort-wasm-simd-threaded.worker.js");n=new Worker(n),ge.xb.push(n)}function Fn(n){O?n():Promise.all(ge.xb.map(ge.Mb)).then(n)}var ge={xb:[],yb:[],Qb:[],ub:{},Gb(){O?(ge.receiveObjectTransfer=ge.dc,ge.threadInitTLS=ge.Pb,ge.setExitStatus=ge.Ob):ut()},Ob:n=>ie=n,pc:["$terminateWorker"],hc:()=>{for(var n of ge.yb)Tr(n);for(n of ge.xb)Tr(n);ge.xb=[],ge.yb=[],ge.ub=[]},Nb:n=>{var l=n.wb;delete ge.ub[l],ge.xb.push(n),ge.yb.splice(ge.yb.indexOf(n),1),n.wb=0,ro(l)},dc(){},Pb(){ge.Qb.forEach(n=>n())},Mb:n=>new Promise(l=>{n.onmessage=k=>{k=k.data;var V=k.cmd;if(k.targetThread&&k.targetThread!=pn()){var F=ge.ub[k.targetThread];F?F.postMessage(k,k.transferList):ee(`Internal error! Worker sent a message "${V}" to target pthread ${k.targetThread}, but that thread no longer exists!`)}else V==="checkMailbox"?rt():V==="spawnThread"?ht(k):V==="cleanupThread"?ge.Nb(ge.ub[k.thread]):V==="killThread"?(k=k.thread,V=ge.ub[k],delete ge.ub[k],Tr(V),ro(k),ge.yb.splice(ge.yb.indexOf(V),1),V.wb=0):V==="cancelThread"?ge.ub[k.thread].postMessage({cmd:"cancel"}):V==="loaded"?(n.loaded=!0,P&&!n.wb&&n.unref(),l(n)):V==="alert"?alert(`Thread ${k.threadId}: ${k.text}`):k.target==="setimmediate"?n.postMessage(k):V==="callHandler"?d[k.handler](...k.args):V&&ee(`worker sent an unknown command ${V}`)},n.onerror=k=>{throw ee(`worker sent an error! ${k.filename}:${k.lineno}: ${k.message}`),k},P&&(n.on("message",k=>n.onmessage({data:k})),n.on("error",k=>n.onerror(k)));var f=[],b=["onExit"],C;for(C of b)d.hasOwnProperty(C)&&f.push(C);n.postMessage({cmd:"load",handlers:f,urlOrBlob:d.mainScriptUrlOrBlob||e,wasmMemory:ae,wasmModule:Ae})})};d.PThread=ge;var Yt=n=>{for(;0<n.length;)n.shift()(d)};d.establishStackSpace=()=>{var n=pn(),l=c()[n+52>>>2>>>0];n=c()[n+56>>>2>>>0],bi(l,l-n),fn(l)};function jr(n){if(O)return Te(1,0,n);Xe(n)}d.invokeEntryPoint=(n,l)=>{bt=0,n=wi(n,l),0<bt?ge.Ob(n):no(n)};class qn{constructor(l){this.Ib=l-24}Gb(l,f){c()[this.Ib+16>>>2>>>0]=0,c()[this.Ib+4>>>2>>>0]=l,c()[this.Ib+8>>>2>>>0]=f}}var Kr=0,jn=0;function Yr(n,l,f,b){return O?Te(2,1,n,l,f,b):Zr(n,l,f,b)}function Zr(n,l,f,b){if(n>>>=0,l>>>=0,f>>>=0,b>>>=0,typeof SharedArrayBuffer>"u")return ee("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var C=[];return O&&C.length===0?Yr(n,l,f,b):(n={fc:f,wb:n,Rb:b,mc:C},O?(n.oc="spawnThread",postMessage(n,C),0):ht(n))}var cr=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Pr=(n,l,f)=>{l>>>=0;var b=l+f;for(f=l;n[f]&&!(f>=b);)++f;if(16<f-l&&n.buffer&&cr)return cr.decode(n.buffer instanceof SharedArrayBuffer?n.slice(l,f):n.subarray(l,f));for(b="";l<f;){var C=n[l++];if(C&128){var k=n[l++]&63;if((C&224)==192)b+=String.fromCharCode((C&31)<<6|k);else{var V=n[l++]&63;C=(C&240)==224?(C&15)<<12|k<<6|V:(C&7)<<18|k<<12|V<<6|n[l++]&63,65536>C?b+=String.fromCharCode(C):(C-=65536,b+=String.fromCharCode(55296|C>>10,56320|C&1023))}}else b+=String.fromCharCode(C)}return b},He=(n,l)=>(n>>>=0)?Pr(o(),n,l):"";function Xr(n,l,f){return O?Te(3,1,n,l,f):0}function Qr(n,l){if(O)return Te(4,1,n,l)}var gt=n=>{for(var l=0,f=0;f<n.length;++f){var b=n.charCodeAt(f);127>=b?l++:2047>=b?l+=2:55296<=b&&57343>=b?(l+=4,++f):l+=3}return l},dt=(n,l,f,b)=>{if(f>>>=0,!(0<b))return 0;var C=f;b=f+b-1;for(var k=0;k<n.length;++k){var V=n.charCodeAt(k);if(55296<=V&&57343>=V){var F=n.charCodeAt(++k);V=65536+((V&1023)<<10)|F&1023}if(127>=V){if(f>=b)break;l[f++>>>0]=V}else{if(2047>=V){if(f+1>=b)break;l[f++>>>0]=192|V>>6}else{if(65535>=V){if(f+2>=b)break;l[f++>>>0]=224|V>>12}else{if(f+3>=b)break;l[f++>>>0]=240|V>>18,l[f++>>>0]=128|V>>12&63}l[f++>>>0]=128|V>>6&63}l[f++>>>0]=128|V&63}}return l[f>>>0]=0,f-C},Bt=(n,l,f)=>dt(n,o(),l,f);function Zt(n,l){if(O)return Te(5,1,n,l)}function kr(n,l,f){if(O)return Te(6,1,n,l,f)}function Or(n,l,f){return O?Te(7,1,n,l,f):0}function Jr(n,l){if(O)return Te(8,1,n,l)}function pr(n,l,f){if(O)return Te(9,1,n,l,f)}function en(n,l,f,b){if(O)return Te(10,1,n,l,f,b)}function tn(n,l,f,b){if(O)return Te(11,1,n,l,f,b)}function rn(n,l,f,b){if(O)return Te(12,1,n,l,f,b)}function nn(n){if(O)return Te(13,1,n)}function Rr(n,l){if(O)return Te(14,1,n,l)}function Xt(n,l,f){if(O)return Te(15,1,n,l,f)}var on,nt=n=>{for(var l="";o()[n>>>0];)l+=on[o()[n++>>>0]];return l},mr={},Br={},Kn={},wt;function Yn(n,l,f={}){var b=l.name;if(!n)throw new wt(`type "${b}" must have a positive integer typeid pointer`);if(Br.hasOwnProperty(n)){if(f.Ub)return;throw new wt(`Cannot register type \'${b}\' twice`)}Br[n]=l,delete Kn[n],mr.hasOwnProperty(n)&&(l=mr[n],delete mr[n],l.forEach(C=>C()))}function Je(n,l,f={}){if(!("argPackAdvance"in l))throw new TypeError("registerType registeredInstance requires argPackAdvance");return Yn(n,l,f)}var Dr=(n,l,f)=>{switch(l){case 1:return f?b=>r()[b>>>0]:b=>o()[b>>>0];case 2:return f?b=>i()[b>>>1>>>0]:b=>u()[b>>>1>>>0];case 4:return f?b=>a()[b>>>2>>>0]:b=>c()[b>>>2>>>0];case 8:return f?b=>Be[b>>>3]:b=>Ge[b>>>3];default:throw new TypeError(`invalid integer width (${l}): ${n}`)}},fr=[],lt=[];function hr(n){n>>>=0,9<n&&--lt[n+1]===0&&(lt[n]=void 0,fr.push(n))}var Qe=n=>{if(!n)throw new wt("Cannot use deleted val. handle = "+n);return lt[n]},ot=n=>{switch(n){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let l=fr.pop()||lt.length;return lt[l]=n,lt[l+1]=1,l}};function Qt(n){return this.fromWireType(c()[n>>>2>>>0])}var Zn={name:"emscripten::val",fromWireType:n=>{var l=Qe(n);return hr(n),l},toWireType:(n,l)=>ot(l),argPackAdvance:8,readValueFromPointer:Qt,Bb:null},an=(n,l)=>{switch(l){case 4:return function(f){return this.fromWireType(p()[f>>>2>>>0])};case 8:return function(f){return this.fromWireType(h()[f>>>3>>>0])};default:throw new TypeError(`invalid float width (${l}): ${n}`)}},zr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Xn=(n,l)=>{for(var f=n>>1,b=f+l/2;!(f>=b)&&u()[f>>>0];)++f;if(f<<=1,32<f-n&&zr)return zr.decode(o().slice(n,f));for(f="",b=0;!(b>=l/2);++b){var C=i()[n+2*b>>>1>>>0];if(C==0)break;f+=String.fromCharCode(C)}return f},sn=(n,l,f)=>{if(f??=2147483647,2>f)return 0;f-=2;var b=l;f=f<2*n.length?f/2:n.length;for(var C=0;C<f;++C){var k=n.charCodeAt(C);i()[l>>>1>>>0]=k,l+=2}return i()[l>>>1>>>0]=0,l-b},un=n=>2*n.length,gr=(n,l)=>{for(var f=0,b="";!(f>=l/4);){var C=a()[n+4*f>>>2>>>0];if(C==0)break;++f,65536<=C?(C-=65536,b+=String.fromCharCode(55296|C>>10,56320|C&1023)):b+=String.fromCharCode(C)}return b},Qn=(n,l,f)=>{if(l>>>=0,f??=2147483647,4>f)return 0;var b=l;f=b+f-4;for(var C=0;C<n.length;++C){var k=n.charCodeAt(C);if(55296<=k&&57343>=k){var V=n.charCodeAt(++C);k=65536+((k&1023)<<10)|V&1023}if(a()[l>>>2>>>0]=k,l+=4,l+4>f)break}return a()[l>>>2>>>0]=0,l-b},pe=n=>{for(var l=0,f=0;f<n.length;++f){var b=n.charCodeAt(f);55296<=b&&57343>=b&&++f,l+=4}return l},Mr=n=>{if(!me)try{if(n(),!(0<bt))try{O?no(ie):Xe(ie)}catch(l){l instanceof st||l=="unwind"||I(1,l)}}catch(l){l instanceof st||l=="unwind"||I(1,l)}};function Nt(n){n>>>=0,typeof Atomics.nc=="function"&&(Atomics.nc(a(),n>>>2,n).value.then(rt),n+=128,Atomics.store(a(),n>>>2,1))}d.__emscripten_thread_mailbox_await=Nt;var rt=()=>{var n=pn();n&&(Nt(n),Mr(yi))};d.checkMailbox=rt;var yr=[],br=(n,l)=>{var f=Br[n];if(f===void 0)throw n=fi(n),f=nt(n),At(n),new wt(`${l} has unknown type ${f}`);return f},Ur=(n,l,f)=>{var b=[];return n=n.toWireType(b,f),b.length&&(c()[l>>>2>>>0]=ot(b)),n},Jt=n=>{try{n()}catch(l){Kt(l)}};function dn(){var n=oe,l={};for(let[f,b]of Object.entries(n))l[f]=typeof b=="function"?(...C)=>{Dt.push(f);try{return b(...C)}finally{me||(Dt.pop(),ct&&vt===1&&Dt.length===0&&(vt=0,bt+=1,Jt($i),typeof Fibers<"u"&&Fibers.rc()))}}:b;return l}var vt=0,ct=null,ln=0,Dt=[],Vr={},s={},m=0,g=null,$=[];function T(){return new Promise((n,l)=>{g={resolve:n,reject:l}})}function B(){var n=mn(65548),l=n+12;c()[n>>>2>>>0]=l,c()[n+4>>>2>>>0]=l+65536,l=Dt[0];var f=Vr[l];return f===void 0&&(f=m++,Vr[l]=f,s[f]=l),l=f,a()[n+8>>>2>>>0]=l,n}function H(){var n=a()[ct+8>>>2>>>0];return n=oe[s[n]],--bt,n()}function q(n){if(!me){if(vt===0){var l=!1,f=!1;n((b=0)=>{if(!me&&(ln=b,l=!0,f)){vt=2,Jt(()=>_i(ct)),typeof Browser<"u"&&Browser.Hb.Tb&&Browser.Hb.resume(),b=!1;try{var C=H()}catch(F){C=F,b=!0}var k=!1;if(!ct){var V=g;V&&(g=null,(b?V.reject:V.resolve)(C),k=!0)}if(b&&!k)throw C}}),f=!0,l||(vt=1,ct=B(),typeof Browser<"u"&&Browser.Hb.Tb&&Browser.Hb.pause(),Jt(()=>vi(ct)))}else vt===2?(vt=0,Jt(Si),At(ct),ct=null,$.forEach(Mr)):Kt(`invalid state: ${vt}`);return ln}}function te(n){return q(l=>{n().then(l)})}var X=[],de={},Ee=n=>{var l=de[n];return l===void 0?nt(n):l},Oe=()=>typeof globalThis=="object"?globalThis:Function("return this")(),D=n=>{var l=X.length;return X.push(n),l},be=(n,l)=>{for(var f=Array(n),b=0;b<n;++b)f[b]=br(c()[l+4*b>>>2>>>0],"parameter "+b);return f},Ie=(n,l)=>Object.defineProperty(l,"name",{value:n});function zt(n){var l=Function;if(!(l instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof l} which is not a function`);var f=Ie(l.name||"unknownFunctionName",function(){});return f.prototype=l.prototype,f=new f,n=l.apply(f,n),n instanceof Object?n:f}var Mt=n=>n%4===0&&(n%100!==0||n%400===0),Qo=[0,31,60,91,121,152,182,213,244,274,305,335],Jo=[0,31,59,90,120,151,181,212,243,273,304,334];function ei(n,l,f,b,C,k,V){return O?Te(16,1,n,l,f,b,C,k,V):-52}function ti(n,l,f,b,C,k){if(O)return Te(17,1,n,l,f,b,C,k)}var Jn=[],ri=(n,l)=>{Jn.length=0;for(var f;f=o()[n++>>>0];){var b=f!=105;b&=f!=112,l+=b&&l%8?4:0,Jn.push(f==112?c()[l>>>2>>>0]:f==106?Be[l>>>3]:f==105?a()[l>>>2>>>0]:h()[l>>>3>>>0]),l+=b?8:4}return Jn},eo={},ni=()=>{if(!to){var n={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:A||"./this.program"},l;for(l in eo)eo[l]===void 0?delete n[l]:n[l]=eo[l];var f=[];for(l in n)f.push(`${l}=${n[l]}`);to=f}return to},to;function oi(n,l){if(O)return Te(18,1,n,l);n>>>=0,l>>>=0;var f=0;return ni().forEach((b,C)=>{var k=l+f;for(C=c()[n+4*C>>>2>>>0]=k,k=0;k<b.length;++k)r()[C++>>>0]=b.charCodeAt(k);r()[C>>>0]=0,f+=b.length+1}),0}function ii(n,l){if(O)return Te(19,1,n,l);n>>>=0,l>>>=0;var f=ni();c()[n>>>2>>>0]=f.length;var b=0;return f.forEach(C=>b+=C.length+1),c()[l>>>2>>>0]=b,0}function ai(n){return O?Te(20,1,n):52}function si(n,l,f,b){return O?Te(21,1,n,l,f,b):52}function ui(n,l,f,b){return O?Te(22,1,n,l,f,b):70}var Xd=[null,[],[]];function di(n,l,f,b){if(O)return Te(23,1,n,l,f,b);l>>>=0,f>>>=0,b>>>=0;for(var C=0,k=0;k<f;k++){var V=c()[l>>>2>>>0],F=c()[l+4>>>2>>>0];l+=8;for(var re=0;re<F;re++){var J=o()[V+re>>>0],ce=Xd[n];J===0||J===10?((n===1?We:ee)(Pr(ce,0)),ce.length=0):ce.push(J)}C+=F}return c()[b>>>2>>>0]=C,0}var li=[31,29,31,30,31,30,31,31,30,31,30,31],ci=[31,28,31,30,31,30,31,31,30,31,30,31];function Qd(n){var l=Array(gt(n)+1);return dt(n,l,0,l.length),l}var Jd=(n,l)=>{r().set(n,l>>>0)};function pi(n,l,f,b){function C(z,we,Pe){for(z=typeof z=="number"?z.toString():z||"";z.length<we;)z=Pe[0]+z;return z}function k(z,we){return C(z,we,"0")}function V(z,we){function Pe(Ci){return 0>Ci?-1:0<Ci?1:0}var er;return(er=Pe(z.getFullYear()-we.getFullYear()))===0&&(er=Pe(z.getMonth()-we.getMonth()))===0&&(er=Pe(z.getDate()-we.getDate())),er}function F(z){switch(z.getDay()){case 0:return new Date(z.getFullYear()-1,11,29);case 1:return z;case 2:return new Date(z.getFullYear(),0,3);case 3:return new Date(z.getFullYear(),0,2);case 4:return new Date(z.getFullYear(),0,1);case 5:return new Date(z.getFullYear()-1,11,31);case 6:return new Date(z.getFullYear()-1,11,30)}}function re(z){var we=z.zb;for(z=new Date(new Date(z.Ab+1900,0,1).getTime());0<we;){var Pe=z.getMonth(),er=(Mt(z.getFullYear())?li:ci)[Pe];if(we>er-z.getDate())we-=er-z.getDate()+1,z.setDate(1),11>Pe?z.setMonth(Pe+1):(z.setMonth(0),z.setFullYear(z.getFullYear()+1));else{z.setDate(z.getDate()+we);break}}return Pe=new Date(z.getFullYear()+1,0,4),we=F(new Date(z.getFullYear(),0,4)),Pe=F(Pe),0>=V(we,z)?0>=V(Pe,z)?z.getFullYear()+1:z.getFullYear():z.getFullYear()-1}n>>>=0,l>>>=0,f>>>=0,b>>>=0;var J=c()[b+40>>>2>>>0];b={kc:a()[b>>>2>>>0],jc:a()[b+4>>>2>>>0],Eb:a()[b+8>>>2>>>0],Jb:a()[b+12>>>2>>>0],Fb:a()[b+16>>>2>>>0],Ab:a()[b+20>>>2>>>0],vb:a()[b+24>>>2>>>0],zb:a()[b+28>>>2>>>0],qc:a()[b+32>>>2>>>0],ic:a()[b+36>>>2>>>0],lc:J?He(J):""},f=He(f),J={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var ce in J)f=f.replace(new RegExp(ce,"g"),J[ce]);var Re="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ze="January February March April May June July August September October November December".split(" ");J={"%a":z=>Re[z.vb].substring(0,3),"%A":z=>Re[z.vb],"%b":z=>ze[z.Fb].substring(0,3),"%B":z=>ze[z.Fb],"%C":z=>k((z.Ab+1900)/100|0,2),"%d":z=>k(z.Jb,2),"%e":z=>C(z.Jb,2," "),"%g":z=>re(z).toString().substring(2),"%G":re,"%H":z=>k(z.Eb,2),"%I":z=>(z=z.Eb,z==0?z=12:12<z&&(z-=12),k(z,2)),"%j":z=>{for(var we=0,Pe=0;Pe<=z.Fb-1;we+=(Mt(z.Ab+1900)?li:ci)[Pe++]);return k(z.Jb+we,3)},"%m":z=>k(z.Fb+1,2),"%M":z=>k(z.jc,2),"%n":()=>`\n`,"%p":z=>0<=z.Eb&&12>z.Eb?"AM":"PM","%S":z=>k(z.kc,2),"%t":()=>"	","%u":z=>z.vb||7,"%U":z=>k(Math.floor((z.zb+7-z.vb)/7),2),"%V":z=>{var we=Math.floor((z.zb+7-(z.vb+6)%7)/7);if(2>=(z.vb+371-z.zb-2)%7&&we++,we)we==53&&(Pe=(z.vb+371-z.zb)%7,Pe==4||Pe==3&&Mt(z.Ab)||(we=1));else{we=52;var Pe=(z.vb+7-z.zb-1)%7;(Pe==4||Pe==5&&Mt(z.Ab%400-1))&&we++}return k(we,2)},"%w":z=>z.vb,"%W":z=>k(Math.floor((z.zb+7-(z.vb+6)%7)/7),2),"%y":z=>(z.Ab+1900).toString().substring(2),"%Y":z=>z.Ab+1900,"%z":z=>{z=z.ic;var we=0<=z;return z=Math.abs(z)/60,(we?"+":"-")+("0000"+(z/60*100+z%60)).slice(-4)},"%Z":z=>z.lc,"%%":()=>"%"},f=f.replace(/%%/g,"\\0\\0");for(ce in J)f.includes(ce)&&(f=f.replace(new RegExp(ce,"g"),J[ce](b)));return f=f.replace(/\\0\\0/g,"%"),ce=Qd(f),ce.length>l?0:(Jd(ce,n),ce.length-1)}ge.Gb();for(var mi=Array(256),cn=0;256>cn;++cn)mi[cn]=String.fromCharCode(cn);on=mi,wt=d.BindingError=class extends Error{constructor(n){super(n),this.name="BindingError"}},d.InternalError=class extends Error{constructor(n){super(n),this.name="InternalError"}},lt.push(0,1,void 0,1,null,1,!0,1,!1,1),d.count_emval_handles=()=>lt.length/2-5-fr.length;var el=[dr,jr,Yr,Xr,Qr,Zt,kr,Or,Jr,pr,en,tn,rn,nn,Rr,Xt,ei,ti,oi,ii,ai,si,ui,di],tl={ua:function(n,l,f){return te(async()=>{await d.Zb(n,l,f)})},b:function(n,l,f){throw n>>>=0,new qn(n).Gb(l>>>0,f>>>0),Kr=n,jn++,Kr},ia:function(n){hi(n>>>0,!E,1,!x,131072,!1),ge.Pb()},G:function(n){n>>>=0,O?postMessage({cmd:"cleanupThread",thread:n}):ge.Nb(ge.ub[n])},_:Zr,A:Xr,pa:Qr,W:Zt,Y:kr,qa:Or,na:Jr,fa:pr,ma:en,K:tn,X:rn,U:nn,oa:Rr,V:Xt,E:function(n,l,f){n>>>=0,f>>>=0,l=nt(l>>>0),Je(n,{name:l,fromWireType:b=>b,toWireType:function(b,C){if(typeof C!="bigint"&&typeof C!="number")throw C===null?C="null":(b=typeof C,C=b==="object"||b==="array"||b==="function"?C.toString():""+C),new TypeError(`Cannot convert "${C}" to ${this.name}`);return typeof C=="number"&&(C=BigInt(C)),C},argPackAdvance:8,readValueFromPointer:Dr(l,f,l.indexOf("u")==-1),Bb:null})},O:function(n,l,f,b){n>>>=0,l=nt(l>>>0),Je(n,{name:l,fromWireType:function(C){return!!C},toWireType:function(C,k){return k?f:b},argPackAdvance:8,readValueFromPointer:function(C){return this.fromWireType(o()[C>>>0])},Bb:null})},N:function(n){return Je(n>>>0,Zn)},D:function(n,l,f){n>>>=0,f>>>=0,l=nt(l>>>0),Je(n,{name:l,fromWireType:b=>b,toWireType:(b,C)=>C,argPackAdvance:8,readValueFromPointer:an(l,f),Bb:null})},t:function(n,l,f,b,C){if(n>>>=0,f>>>=0,l=nt(l>>>0),C===-1&&(C=4294967295),C=F=>F,b===0){var k=32-8*f;C=F=>F<<k>>>k}var V=l.includes("unsigned")?function(F,re){return re>>>0}:function(F,re){return re};Je(n,{name:l,fromWireType:C,toWireType:V,argPackAdvance:8,readValueFromPointer:Dr(l,f,b!==0),Bb:null})},p:function(n,l,f){function b(k){var V=c()[k>>>2>>>0];return k=c()[k+4>>>2>>>0],new C(r().buffer,k,V)}n>>>=0;var C=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][l];f=nt(f>>>0),Je(n,{name:f,fromWireType:b,argPackAdvance:8,readValueFromPointer:b},{Ub:!0})},F:function(n,l){n>>>=0,l=nt(l>>>0);var f=l==="std::string";Je(n,{name:l,fromWireType:function(b){var C=c()[b>>>2>>>0],k=b+4;if(f)for(var V=k,F=0;F<=C;++F){var re=k+F;if(F==C||o()[re>>>0]==0){if(V=He(V,re-V),J===void 0)var J=V;else J+=String.fromCharCode(0),J+=V;V=re+1}}else{for(J=Array(C),F=0;F<C;++F)J[F]=String.fromCharCode(o()[k+F>>>0]);J=J.join("")}return At(b),J},toWireType:function(b,C){C instanceof ArrayBuffer&&(C=new Uint8Array(C));var k=typeof C=="string";if(!(k||C instanceof Uint8Array||C instanceof Uint8ClampedArray||C instanceof Int8Array))throw new wt("Cannot pass non-string to std::string");var V=f&&k?gt(C):C.length,F=mn(4+V+1),re=F+4;if(c()[F>>>2>>>0]=V,f&&k)Bt(C,re,V+1);else if(k)for(k=0;k<V;++k){var J=C.charCodeAt(k);if(255<J)throw At(re),new wt("String has UTF-16 code units that do not fit in 8 bits");o()[re+k>>>0]=J}else for(k=0;k<V;++k)o()[re+k>>>0]=C[k];return b!==null&&b.push(At,F),F},argPackAdvance:8,readValueFromPointer:Qt,Bb(b){At(b)}})},z:function(n,l,f){if(n>>>=0,l>>>=0,f>>>=0,f=nt(f),l===2)var b=Xn,C=sn,k=un,V=F=>u()[F>>>1>>>0];else l===4&&(b=gr,C=Qn,k=pe,V=F=>c()[F>>>2>>>0]);Je(n,{name:f,fromWireType:F=>{for(var re=c()[F>>>2>>>0],J,ce=F+4,Re=0;Re<=re;++Re){var ze=F+4+Re*l;(Re==re||V(ze)==0)&&(ce=b(ce,ze-ce),J===void 0?J=ce:(J+=String.fromCharCode(0),J+=ce),ce=ze+l)}return At(F),J},toWireType:(F,re)=>{if(typeof re!="string")throw new wt(`Cannot pass non-string to C++ string type ${f}`);var J=k(re),ce=mn(4+J+l);return c()[ce>>>2>>>0]=J/l,C(re,ce+4,J+l),F!==null&&F.push(At,ce),ce},argPackAdvance:8,readValueFromPointer:Qt,Bb(F){At(F)}})},P:function(n,l){n>>>=0,l=nt(l>>>0),Je(n,{Vb:!0,name:l,argPackAdvance:0,fromWireType:()=>{},toWireType:()=>{}})},ta:()=>1,S:function(n,l){n>>>=0,n==l>>>0?setTimeout(rt):O?postMessage({targetThread:n,cmd:"checkMailbox"}):(n=ge.ub[n])&&n.postMessage({cmd:"checkMailbox"})},$:function(n,l,f,b,C){l>>>=0,f>>>=0,b/=2,yr.length=b,C=C>>>0>>>3;for(var k=0;k<b;k++)yr[k]=Be[C+2*k]?Be[C+2*k+1]:h()[C+2*k+1>>>0];return n=l?Ir[l]:el[n],ge.Sb=f,f=n(...yr),ge.Sb=0,f},ha:Nt,sa:function(n){P&&ge.ub[n>>>0].ref()},w:function(n,l,f){return l>>>=0,f>>>=0,n=Qe(n>>>0),l=br(l,"emval::as"),Ur(l,f,n)},y:function(n){return n>>>=0,te(()=>(n=Qe(n),n.then(ot)))},o:function(n,l,f,b){return f>>>=0,b>>>=0,n=X[n>>>0],l=Qe(l>>>0),n(null,l,f,b)},k:function(n,l,f,b,C){return f>>>=0,b>>>=0,C>>>=0,n=X[n>>>0],l=Qe(l>>>0),f=Ee(f),n(l,l[f],b,C)},c:hr,C:function(n,l){return l>>>=0,n=Qe(n>>>0),l=Qe(l),n==l},n:function(n){return n>>>=0,n===0?ot(Oe()):(n=Ee(n),ot(Oe()[n]))},j:function(n,l,f){l=be(n,l>>>0);var b=l.shift();n--;var C=`return function (obj, func, destructorsRef, args) {\n`,k=0,V=[];f===0&&V.push("obj");for(var F=["retType"],re=[b],J=0;J<n;++J)V.push("arg"+J),F.push("argType"+J),re.push(l[J]),C+=`  var arg${J} = argType${J}.readValueFromPointer(args${k?"+"+k:""});\n`,k+=l[J].argPackAdvance;return C+=`  var rv = ${f===1?"new func":"func.call"}(${V.join(", ")});\n`,b.Vb||(F.push("emval_returnValue"),re.push(Ur),C+=`  return emval_returnValue(retType, destructorsRef, rv);\n`),F.push(C+`};\n`),n=zt(F)(...re),f=`methodCaller<(${l.map(ce=>ce.name).join(", ")}) => ${b.name}>`,D(Ie(f,n))},s:function(n,l){return l>>>=0,n=Qe(n>>>0),l=Qe(l),ot(n[l])},d:function(n){n>>>=0,9<n&&(lt[n+1]+=1)},v:function(){return ot([])},m:function(n){n=Qe(n>>>0);for(var l=Array(n.length),f=0;f<n.length;f++)l[f]=n[f];return ot(l)},g:function(n){return ot(Ee(n>>>0))},l:function(){return ot({})},i:function(n){n>>>=0;for(var l=Qe(n);l.length;){var f=l.pop();l.pop()(f)}hr(n)},h:function(n,l,f){l>>>=0,f>>>=0,n=Qe(n>>>0),l=Qe(l),f=Qe(f),n[l]=f},e:function(n,l){return l>>>=0,n=br(n>>>0,"_emval_take_value"),n=n.readValueFromPointer(l),ot(n)},ca:function(n,l){n=-9007199254740992>n||9007199254740992<n?NaN:Number(n),l>>>=0,n=new Date(1e3*n),a()[l>>>2>>>0]=n.getUTCSeconds(),a()[l+4>>>2>>>0]=n.getUTCMinutes(),a()[l+8>>>2>>>0]=n.getUTCHours(),a()[l+12>>>2>>>0]=n.getUTCDate(),a()[l+16>>>2>>>0]=n.getUTCMonth(),a()[l+20>>>2>>>0]=n.getUTCFullYear()-1900,a()[l+24>>>2>>>0]=n.getUTCDay(),n=(n.getTime()-Date.UTC(n.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,a()[l+28>>>2>>>0]=n},da:function(n,l){n=-9007199254740992>n||9007199254740992<n?NaN:Number(n),l>>>=0,n=new Date(1e3*n),a()[l>>>2>>>0]=n.getSeconds(),a()[l+4>>>2>>>0]=n.getMinutes(),a()[l+8>>>2>>>0]=n.getHours(),a()[l+12>>>2>>>0]=n.getDate(),a()[l+16>>>2>>>0]=n.getMonth(),a()[l+20>>>2>>>0]=n.getFullYear()-1900,a()[l+24>>>2>>>0]=n.getDay();var f=(Mt(n.getFullYear())?Qo:Jo)[n.getMonth()]+n.getDate()-1|0;a()[l+28>>>2>>>0]=f,a()[l+36>>>2>>>0]=-(60*n.getTimezoneOffset()),f=new Date(n.getFullYear(),6,1).getTimezoneOffset();var b=new Date(n.getFullYear(),0,1).getTimezoneOffset();n=(f!=b&&n.getTimezoneOffset()==Math.min(b,f))|0,a()[l+32>>>2>>>0]=n},ea:function(n){n>>>=0;var l=new Date(a()[n+20>>>2>>>0]+1900,a()[n+16>>>2>>>0],a()[n+12>>>2>>>0],a()[n+8>>>2>>>0],a()[n+4>>>2>>>0],a()[n>>>2>>>0],0),f=a()[n+32>>>2>>>0],b=l.getTimezoneOffset(),C=new Date(l.getFullYear(),6,1).getTimezoneOffset(),k=new Date(l.getFullYear(),0,1).getTimezoneOffset(),V=Math.min(k,C);return 0>f?a()[n+32>>>2>>>0]=+(C!=k&&V==b):0<f!=(V==b)&&(C=Math.max(k,C),l.setTime(l.getTime()+6e4*((0<f?V:C)-b))),a()[n+24>>>2>>>0]=l.getDay(),f=(Mt(l.getFullYear())?Qo:Jo)[l.getMonth()]+l.getDate()-1|0,a()[n+28>>>2>>>0]=f,a()[n>>>2>>>0]=l.getSeconds(),a()[n+4>>>2>>>0]=l.getMinutes(),a()[n+8>>>2>>>0]=l.getHours(),a()[n+12>>>2>>>0]=l.getDate(),a()[n+16>>>2>>>0]=l.getMonth(),a()[n+20>>>2>>>0]=l.getYear(),n=l.getTime(),BigInt(isNaN(n)?-1:n/1e3)},aa:ei,ba:ti,R:function(n,l,f,b){n>>>=0,l>>>=0,f>>>=0,b>>>=0;var C=new Date().getFullYear(),k=new Date(C,0,1),V=new Date(C,6,1);C=k.getTimezoneOffset();var F=V.getTimezoneOffset(),re=Math.max(C,F);c()[n>>>2>>>0]=60*re,a()[l>>>2>>>0]=+(C!=F),n=J=>J.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1],k=n(k),V=n(V),F<C?(Bt(k,f,17),Bt(V,b,17)):(Bt(k,b,17),Bt(V,f,17))},q:()=>{Kt("")},f:function(n,l,f){return n>>>=0,l=ri(l>>>0,f>>>0),Ir[n](...l)},M:function(n,l,f){return n>>>=0,l=ri(l>>>0,f>>>0),Ir[n](...l)},H:()=>{},L:()=>Date.now(),ra:()=>{throw bt+=1,"unwind"},T:function(){return 4294901760},u:()=>performance.timeOrigin+performance.now(),x:()=>P?(Ri(),wr(Oi)).cpus().length:navigator.hardwareConcurrency,Q:function(n){n>>>=0;var l=o().length;if(n<=l||4294901760<n)return!1;for(var f=1;4>=f;f*=2){var b=l*(1+.2/f);b=Math.min(b,n+100663296);var C=Math;b=Math.max(n,b);e:{C=(C.min.call(C,4294901760,b+(65536-b%65536)%65536)-ae.buffer.byteLength+65535)/65536;try{ae.grow(C),Ne();var k=1;break e}catch{}k=void 0}if(k)return!0}return!1},ja:oi,la:ii,Z:Xe,B:ai,J:si,ga:ui,I:di,a:ae||d.wasmMemory,ka:pi,r:function(n,l,f,b){return pi(n>>>0,l>>>0,f>>>0,b>>>0)}},oe=function(){function n(f,b){return oe=f.exports,oe=dn(),oe=rl(),ge.Qb.push(oe.cb),Rt.unshift(oe.va),Ae=b,xr(),oe}var l={a:tl};if(Vt++,d.instantiateWasm)try{return d.instantiateWasm(l,n)}catch(f){ee(`Module.instantiateWasm callback failed with error: ${f}`),w(f)}return Ar(l,function(f){n(f.instance,f.module)}).catch(w),{}}(),fi=n=>(fi=oe.wa)(n);d.__embind_initialize_bindings=()=>(d.__embind_initialize_bindings=oe.xa)(),d._OrtInit=(n,l)=>(d._OrtInit=oe.ya)(n,l),d._OrtGetLastError=(n,l)=>(d._OrtGetLastError=oe.za)(n,l),d._OrtCreateSessionOptions=(n,l,f,b,C,k,V,F,re,J)=>(d._OrtCreateSessionOptions=oe.Aa)(n,l,f,b,C,k,V,F,re,J),d._OrtAppendExecutionProvider=(n,l)=>(d._OrtAppendExecutionProvider=oe.Ba)(n,l),d._OrtAddFreeDimensionOverride=(n,l,f)=>(d._OrtAddFreeDimensionOverride=oe.Ca)(n,l,f),d._OrtAddSessionConfigEntry=(n,l,f)=>(d._OrtAddSessionConfigEntry=oe.Da)(n,l,f),d._OrtReleaseSessionOptions=n=>(d._OrtReleaseSessionOptions=oe.Ea)(n),d._OrtCreateSession=(n,l,f)=>(d._OrtCreateSession=oe.Fa)(n,l,f),d._OrtReleaseSession=n=>(d._OrtReleaseSession=oe.Ga)(n),d._OrtGetInputOutputCount=(n,l,f)=>(d._OrtGetInputOutputCount=oe.Ha)(n,l,f),d._OrtGetInputName=(n,l)=>(d._OrtGetInputName=oe.Ia)(n,l),d._OrtGetOutputName=(n,l)=>(d._OrtGetOutputName=oe.Ja)(n,l),d._OrtFree=n=>(d._OrtFree=oe.Ka)(n),d._OrtCreateTensor=(n,l,f,b,C,k)=>(d._OrtCreateTensor=oe.La)(n,l,f,b,C,k),d._OrtGetTensorData=(n,l,f,b,C)=>(d._OrtGetTensorData=oe.Ma)(n,l,f,b,C),d._OrtReleaseTensor=n=>(d._OrtReleaseTensor=oe.Na)(n),d._OrtCreateRunOptions=(n,l,f,b)=>(d._OrtCreateRunOptions=oe.Oa)(n,l,f,b),d._OrtAddRunConfigEntry=(n,l,f)=>(d._OrtAddRunConfigEntry=oe.Pa)(n,l,f),d._OrtReleaseRunOptions=n=>(d._OrtReleaseRunOptions=oe.Qa)(n),d._OrtCreateBinding=n=>(d._OrtCreateBinding=oe.Ra)(n),d._OrtBindInput=(n,l,f)=>(d._OrtBindInput=oe.Sa)(n,l,f),d._OrtBindOutput=(n,l,f,b)=>(d._OrtBindOutput=oe.Ta)(n,l,f,b),d._OrtClearBoundOutputs=n=>(d._OrtClearBoundOutputs=oe.Ua)(n),d._OrtReleaseBinding=n=>(d._OrtReleaseBinding=oe.Va)(n),d._OrtRunWithBinding=(n,l,f,b,C)=>(d._OrtRunWithBinding=oe.Wa)(n,l,f,b,C),d._OrtRun=(n,l,f,b,C,k,V,F)=>(d._OrtRun=oe.Xa)(n,l,f,b,C,k,V,F),d._OrtEndProfiling=n=>(d._OrtEndProfiling=oe.Ya)(n),d._JsepOutput=(n,l,f)=>(d._JsepOutput=oe.Za)(n,l,f),d._JsepGetNodeName=n=>(d._JsepGetNodeName=oe._a)(n);var pn=d._pthread_self=()=>(pn=d._pthread_self=oe.$a)(),mn=d._malloc=n=>(mn=d._malloc=oe.ab)(n),At=d._free=n=>(At=d._free=oe.bb)(n);d.__emscripten_tls_init=()=>(d.__emscripten_tls_init=oe.cb)();var hi=d.__emscripten_thread_init=(n,l,f,b,C,k)=>(hi=d.__emscripten_thread_init=oe.eb)(n,l,f,b,C,k);d.__emscripten_thread_crashed=()=>(d.__emscripten_thread_crashed=oe.fb)();var gi=(n,l,f,b,C)=>(gi=oe.gb)(n,l,f,b,C),ro=n=>(ro=oe.hb)(n),no=d.__emscripten_thread_exit=n=>(no=d.__emscripten_thread_exit=oe.ib)(n),yi=()=>(yi=oe.jb)(),bi=(n,l)=>(bi=oe.kb)(n,l),fn=n=>(fn=oe.lb)(n),oo=n=>(oo=oe.mb)(n),io=()=>(io=oe.nb)(),wi=d.dynCall_ii=(n,l)=>(wi=d.dynCall_ii=oe.pb)(n,l),vi=n=>(vi=oe.qb)(n),$i=()=>($i=oe.rb)(),_i=n=>(_i=oe.sb)(n),Si=()=>(Si=oe.tb)();d.___start_em_js=839500,d.___stop_em_js=839661;function rl(){var n=oe;n=Object.assign({},n);var l=b=>C=>b(C)>>>0,f=b=>()=>b()>>>0;return n.wa=l(n.wa),n.$a=f(n.$a),n.ab=l(n.ab),n.emscripten_main_runtime_thread_id=f(n.emscripten_main_runtime_thread_id),n.mb=l(n.mb),n.nb=f(n.nb),n}d.wasmMemory=ae,d.stackSave=()=>io(),d.stackRestore=n=>fn(n),d.stackAlloc=n=>oo(n),d.keepRuntimeAlive=()=>0<bt,d.UTF8ToString=He,d.stringToUTF8=Bt,d.lengthBytesUTF8=gt,d.ExitStatus=st,d.PThread=ge;var hn;jt=function n(){hn||xi(),hn||(jt=n)};function xi(){if(!(0<Vt))if(O)y(d),O||Yt(Rt),startWorker(d);else{if(d.preRun)for(typeof d.preRun=="function"&&(d.preRun=[d.preRun]);d.preRun.length;)mt.unshift(d.preRun.shift());Yt(mt),0<Vt||hn||(hn=!0,d.calledRun=!0,me||(O||Yt(Rt),y(d),O||Yt(qt)))}}return xi(),_}})();typeof Di=="object"&&typeof mo=="object"?mo.exports=Bi:typeof define=="function"&&define.amd&&define([],()=>Bi)});var Mi=Wr((gm,cl)=>{cl.exports=\'"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(...e){var a=e.join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,a+`\\n`);return}console.error(a)}function threadAlert(...e){var a=e.join(" ");postMessage({cmd:"alert",text:a,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,a)=>{var r=Module.wasmModule;Module.wasmModule=null;var t=new WebAssembly.Instance(r,e);return a(t)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let r=[];self.onmessage=t=>r.push(t),self.startWorker=t=>{Module=t,postMessage({cmd:"loaded"});for(let s of r)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const t of e.data.handlers)Module[t]=(...s)=>{postMessage({cmd:"callHandler",handler:t,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var a=URL.createObjectURL(e.data.urlOrBlob);importScripts(a),URL.revokeObjectURL(a)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(r){if(r!="unwind")throw r}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(r){throw Module.__emscripten_thread_crashed?.(),r}}self.onmessage=handleMessage;\\n\'});var go,Gt,tr,bn,Gr,Hi,yo,ye=Y(()=>{"use strict";go=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},Gt=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},tr=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],bn=e=>{switch(e){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},Gr=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},Hi=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint8"||e==="bool",yo=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${e}`)}}});var wn=Y(()=>{"use strict"});var Fi=Y(()=>{"use strict";wn()});var qi,ji=Y(()=>{"use strict";qi="1.18.0"});var Ki,pt,bo=Y(()=>{"use strict";ji();Ki="warning",pt={wasm:{},webgl:{},webgpu:{},versions:{common:qi},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);Ki=e}},get logLevel(){return Ki}};Object.defineProperty(pt,"logLevel",{enumerable:!0})});var vr,Yi=Y(()=>{"use strict";bo();vr=pt});var Zi=Y(()=>{"use strict"});var Xi=Y(()=>{"use strict";vn()});var Ji=Y(()=>{"use strict"});var ea=Y(()=>{"use strict";vn()});var vn=Y(()=>{"use strict";Zi();Xi();Ji();ea()});var $n=Y(()=>{"use strict";vn()});var wo,ta,rr,Ht,vo=Y(()=>{"use strict";bo();wo=(e,t)=>{(typeof pt.trace>"u"?!pt.wasm.trace:!pt.trace)||console.timeStamp(`${e}::ORT::${t}`)},ta=(e,t)=>{let r=new Error().stack?.split(/\\r\\n|\\r|\\n/g)||[],o=!1;for(let i=0;i<r.length;i++){if(o&&!r[i].includes("TRACE_FUNC")){let u=`FUNC_${e}::${r[i].trim().split(" ")[1]}`;t&&(u+=`::${t}`),wo("CPU",u);return}r[i].includes("TRACE_FUNC")&&(o=!0)}},rr=e=>{(typeof pt.trace>"u"?!pt.wasm.trace:!pt.trace)||ta("BEGIN",e)},Ht=e=>{(typeof pt.trace>"u"?!pt.wasm.trace:!pt.trace)||ta("END",e)}});var ra=Y(()=>{"use strict";wn();$n();vo()});var na=Y(()=>{"use strict";ra()});var oa=Y(()=>{"use strict"});var ia=Y(()=>{"use strict"});var aa=Y(()=>{"use strict"});var sa=Y(()=>{"use strict"});var ua=Y(()=>{"use strict";wn();$n()});var da=Y(()=>{"use strict";ua()});var $r=Y(()=>{"use strict";Fi();Yi();na();$n();oa();ia();vo();aa();sa();da()});var _l,Sl,la,ca,pa,xl,Ve,Lt=Y(()=>{"use strict";ye();_l=["V","I","W","E","F"],Sl=(e,t)=>{console.log(`[${_l[e]},${new Date().toISOString()}]${t}`)},pa=(e,t)=>{la=e,ca=t},xl=(e,t)=>{let r=Gr(e),o=Gr(la);r>=o&&Sl(r,typeof t=="function"?t():t)},Ve=(...e)=>{ca&&xl(...e)}});var ma,fa=Y(()=>{"use strict";ye();ma=(e,t)=>new(bn(t))(e)});var _n=Y(()=>{"use strict"});var ha,$o,_o,Cl,Al,ga,xo,So,ba,wa=Y(()=>{"use strict";Lt();_n();ha=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[12582912,10],[16777216,10],[26214400,15],[33554432,22],[44236800,2],[58982400,6],[67108864,6],[134217728,6],[167772160,6]]),$o=[],_o=e=>Math.ceil(e/16)*16,Cl=e=>{for(let t=0;t<$o.length;t++){let r=$o[t];if(e<=r)return r}return Math.ceil(e/16)*16},Al=1,ga=()=>Al++,xo=async(e,t,r,o)=>{let i=_o(r),u=e.device.createBuffer({size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let a=e.getCommandEncoder();e.endComputePass(),a.copyBufferToBuffer(t,0,u,0,i),e.flush(),await u.mapAsync(GPUMapMode.READ);let c=u.getMappedRange();if(o){let p=o();return p.set(new Uint8Array(c,0,r)),p}else return new Uint8Array(c.slice(0,r))}finally{u.destroy()}},So=class{constructor(t){this.backend=t;this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersForUploadingPending=[],this.buffersPending=[],this.externalBuffers=new Map,this.capturedPendingBuffers=new Map;for(let[r]of ha)$o.push(r),this.freeBuffers.set(r,[]),this.freeUniformBuffers.set(r,[])}upload(t,r){let o=r.buffer,i=r.byteOffset,u=r.byteLength,a=_o(u),c=this.storageCache.get(t);if(!c)throw new Error("gpu data for uploading does not exist");if(c.originalSize!==u)throw new Error(`inconsistent data size. gpu data size=${c.originalSize}, data size=${u}`);let p=this.backend.device.createBuffer({mappedAtCreation:!0,size:a,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),h=p.getMappedRange();new Uint8Array(h).set(new Uint8Array(o,i,u)),p.unmap();let d=this.backend.getCommandEncoder();this.backend.endComputePass(),d.copyBufferToBuffer(p,0,c.gpuData.buffer,0,a),Ve("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${t})`),this.buffersForUploadingPending.push(p)}memcpy(t,r){let o=this.storageCache.get(t);if(!o)throw new Error("source gpu data for memcpy does not exist");let i=this.storageCache.get(r);if(!i)throw new Error("destination gpu data for memcpy does not exist");if(o.originalSize!==i.originalSize)throw new Error("inconsistent source and destination gpu data size");let u=_o(o.originalSize),a=this.backend.getCommandEncoder();this.backend.endComputePass(),a.copyBufferToBuffer(o.gpuData.buffer,0,i.gpuData.buffer,0,u)}registerExternalBuffer(t,r,o){let i;if(o){if(i=this.externalBuffers.get(o),i===void 0)throw new Error("previous buffer is not registered");if(t===o)return Ve("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${r}) => id=${i}, buffer is the same, skip.`),i;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error(`Registering a different external buffer under graph capture mode is not supported yet.\n             Please use the previous external buffer!`);this.externalBuffers.delete(o)}else i=ga();return this.storageCache.set(i,{gpuData:{id:i,type:0,buffer:t},originalSize:r}),this.externalBuffers.set(t,i),Ve("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${r}) => id=${i}, registered.`),i}unregisterExternalBuffer(t){let r=this.externalBuffers.get(t);r!==void 0&&(this.storageCache.delete(r),this.externalBuffers.delete(t),Ve("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${r}`))}create(t,r=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let o=Cl(t),i,u=(r&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,a=(r&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(u||a){let h=(u?this.freeBuffers:this.freeUniformBuffers).get(o);h?h.length>0?i=h.pop():i=this.backend.device.createBuffer({size:o,usage:r}):i=this.backend.device.createBuffer({size:o,usage:r})}else i=this.backend.device.createBuffer({size:o,usage:r});let c={id:ga(),type:0,buffer:i};return this.storageCache.set(c.id,{gpuData:c,originalSize:t}),Ve("verbose",()=>`[WebGPU] GpuDataManager.create(size=${t}) => id=${c.id}`),c}get(t){return this.storageCache.get(t)?.gpuData}release(t){let r=this.storageCache.get(t);if(!r)throw new Error("releasing data does not exist");return Ve("verbose",()=>`[WebGPU] GpuDataManager.release(id=${t}), gpuDataId=${r.gpuData.id}`),this.storageCache.delete(t),this.buffersPending.push(r.gpuData.buffer),r.originalSize}async download(t,r){let o=this.storageCache.get(t);if(!o)throw new Error("data does not exist");await xo(this.backend,o.gpuData.buffer,o.originalSize,r)}refreshPendingBuffers(){for(let t of this.buffersForUploadingPending)t.destroy();if(this.buffersForUploadingPending=[],this.buffersPending.length!==0)if(this.backend.sessionStatus==="default"){for(let t of this.buffersPending){let r=ha.get(t.size);if((t.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let o=this.freeBuffers.get(t.size)||[];r===void 0||o.length>=r?t.destroy():o.push(t)}else if((t.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let o=this.freeUniformBuffers.get(t.size)||[];r===void 0||o.length>=r?t.destroy():o.push(t)}else t.destroy()}this.buffersPending=[]}else{let t=this.capturedPendingBuffers.get(this.backend.currentSessionId);t||(t=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,t));for(let r of this.buffersPending)t.push(r);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(t=>{t.forEach(r=>{r.destroy()})}),this.freeUniformBuffers.forEach(t=>{t.forEach(r=>{r.destroy()})}),this.storageCache.forEach(t=>{t.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(t=>{t.forEach(r=>{r.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onReleaseSession(t){let r=this.capturedPendingBuffers.get(t);r&&(r.forEach(o=>{o.destroy()}),this.capturedPendingBuffers.delete(t))}},ba=(...e)=>new So(...e)});var Co,ve,Ze=Y(()=>{"use strict";Co=class{constructor(t){Object.assign(this,t)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(t=>`${this[t]}`).join(";")),this.key}},ve=e=>new Co(e)});var Ao,It,M,nr,Sn,xn,Cn,Se=Y(()=>{"use strict";Ao=class{static calcMatMulShape(t,r){return t[1]!==r[0]?void 0:[t[0],r[1]]}},It=class{static calcShape(t,r,o=!1){let i=t.length,u=r.length;if(i===0)return r;if(u===0)return t;let a=Math.max(t.length,r.length),c=new Array(a);if(o){if(i<2||u<2)return;let p=Ao.calcMatMulShape([t[i-2],t[i-1]],[r[u-2],r[u-1]]);if(p===void 0)return;[c[a-2],c[a-1]]=p}for(let p=o?3:1;p<=a;p++){let h=i-p<0?1:t[i-p],d=u-p<0?1:r[u-p];if(h!==d&&h>1&&d>1)return;let y=Math.max(h,d);if(h&&d)c[a-p]=Math.max(h,d);else{if(y>1)return;c[a-p]=0}}return c}static isValidBroadcast(t,r){let o=t.length,i=r.length;if(o>i)return!1;for(let u=1;u<=o;u++)if(t[o-u]!==1&&t[o-u]!==r[i-u])return!1;return!0}},M=class e{static size(t){return e.getSizeFromDimensionRange(t,0,t.length)}static convertShape(t,r=4){let o=t.length;if(o===0)return[];let i=new Array(o),u=o-1;for(;u>=0;){if(t[u]%r===0){i[u]=t[u]/r;break}if(r%t[u]!==0)throw new Error("cannot convert shape");i[u]=1,r/=t[u],u--}for(u--;u>=0;u--)i[u]=t[u];return i}static sizeFromDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,r,t.length)}static sizeToDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeToDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,0,r)}static getSizeFromDimensionRange(t,r,o){let i=1;for(let u=r;u<o;u++){if(t[u]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");i*=t[u]}return i}static computeStrides(t){let r=t.length;if(r===0)return[];if(r===1)return[1];let o=new Array(r);o[r-1]=1,o[r-2]=t[r-1];for(let i=r-3;i>=0;--i)o[i]=o[i+1]*t[i+1];return o}static normalizeAxis(t,r){if(t<-r&&t>=r)throw new Error("unsupported axis for this operation.");return t<0?t+r:t}static normalizeAxes(t,r){return t.map(o=>this.normalizeAxis(o,r??t.length))}static sortBasedOnPerm(t,r){return r?r.map(o=>t[o]):t.slice().reverse()}static padShape(t,r){let o=t.length;return t.map((i,u)=>i+r[u]+r[u+o])}static areEqual(t,r){return t.length!==r.length?!1:t.every((o,i)=>o===r[i])}},nr=class e{static adjustPoolAttributes(t,r,o,i,u,a){if(!t&&o.length!==r.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(t)for(let c=0;c<r.length-2;c++)c>=o.length?o.push(r[c+2]):o[c]=r[c+2];for(let c=0;c<o.length;c++)if(c<i.length){if(i[c]<0)throw new Error("strides should be greater than or equal to 1")}else i.push(1);for(let c=0;c<o.length;c++)if(c<u.length){if(u[c]<0)throw new Error("dilations should be greater than or equal to 1")}else u.push(1);for(let c=0;c<o.length*2;c++)if(c<a.length){if(a[c]<0)throw new Error("pad should be greater than or equal to 1")}else a.push(0);for(let c=0;c<o.length;c++){if(o[c]<=0)throw new Error("kernel shapes need to be greater than 0");if(a[c]>=o[c]||a[c+o.length]>=o[c])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,r,o,i,u,a,c){if(c){if(u.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(r.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let p=0;p<t.length-2;p++)e.adjustPadAndReturnShape(t[p+(a?1:2)],r[p],o[p],i[p],u,p,p+t.length-2,c)}}static computePoolOutputShape(t,r,o,i,u,a,c){if(r.length<=0)throw new Error("input shape must be of size greater than 0");let p=[r[0],r[1]];return e.computeShapeHelper(t,r,p,o,i,u,a,c),p}static computeConvOutputShape(t,r,o,i,u,a,c){if(t.length<=0||r.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let p=[t[0],r[0]];return e.computeShapeHelper(!1,t,p,o,i,u,a,c),p}static computeShapeHelper(t,r,o,i,u,a,c,p){if(t)for(let h=0;h<r.length-2;h++)o.push(1);else for(let h=0;h<r.length-2;h++)o.push(e.adjustPadAndReturnShape(r[h+2],i[h],u[h],a[h],c,h,h+r.length-2,p))}static adjustPadAndReturnShape(t,r,o,i,u,a,c,p){let h=o*(i-1)+1;if(p&&p!=="NOTSET")switch(p){case"VALID":return u[a]=0,u[c]=0,Math.floor((t-h)/r+1);case"SAME_LOWER":case"SAME_UPPER":if(o!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let y=((t+r-1)/r-1)*r+i-t;return u[a]=Math.floor(p==="SAME_LOWER"?(y+1)/2:y/2),u[c]=y-u[a],Math.floor((t+y-i)/r+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((t+u[a]+u[c]-h)/r+1)}},Sn=class{static getShapeOfGemmResult(t,r,o,i,u){if(t.length!==2||o.length!==2)throw new Error("shape need to be of size 2");let a,c,p;r?(a=t[1],c=t[0]):(a=t[0],c=t[1]);let h=-1;if(i?(p=o[0],h=1):(p=o[1],h=0),o[h]!==c)throw new Error("dimension mismatch");if(a<=0||p<=0||c<=0)throw new Error("invalid shape specified");if(u&&!It.isValidBroadcast(u,[a,p]))throw new Error("gemm: invalid bias shape for broadcast");return[a,p,c]}},xn=-34028234663852886e22,Cn=34028234663852886e22});var or,To,De,et,Z,Me,$t,ir,_t,fe,Eo,U,j,An,Io,va,_r,_e=Y(()=>{"use strict";ye();Se();or=64,To=(e,t)=>{if(t===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(e){case 10:return t>1?`vec${t}<f16>`:"f16";case 1:return t>1?`vec${t}<f32>`:"f32";case 6:return t>1?`vec${t}<i32>`:"i32";case 12:return t>1?`vec${t}<u32>`:"u32";case 7:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(t!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];default:throw new Error(`Unknown data type: ${e}`)}},De=(e,t=1)=>{let r=To(e,t);return typeof r=="string"?r:r[0]},et=(e,t=1)=>{let r=To(e,t);return typeof r=="string"?r:r[1]},Z=(...e)=>{let t=[];return e.forEach(r=>{r.length!==0&&t.push({type:12,data:r},{type:12,data:M.computeStrides(r)})}),t},Me=e=>e%4===0?4:e%2===0?2:1,$t=(e="f32",t,r="0")=>!t||t===1?`${e}(${r})`:`vec${t}<${e}>(${r})`,ir=(e,t,r)=>e==="f32"?r:t===1?`f32(${r})`:`vec${t}<f32>(${r})`,_t=(e,t)=>t===4?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:t===2?`(${e}.x + ${e}.y)`:t===3?`(${e}.x + ${e}.y + ${e}.z)`:e,fe=(e,t,r,o)=>e.startsWith("uniforms.")&&r>4?typeof t=="string"?o==="f16"?`${e}[(${t}) / 8][(${t}) % 8 / 4][(${t}) % 8 % 4]`:`${e}[(${t}) / 4][(${t}) % 4]`:o==="f16"?`${e}[${Math.floor(t/8)}][${Math.floor(t%8/4)}][${t%8%4}]`:`${e}[${Math.floor(t/4)}][${t%4}]`:r>1?`${e}[${t}]`:e,Eo=(e,t,r,o,i)=>{let u=typeof r=="number",a=u?r:r.length,c=[...new Array(a).keys()],p=a<2?"u32":a<=4?`vec${a}<u32>`:`array<u32, ${a}>`,h=To(t,i),d=typeof h=="string"?h:h[1],y=typeof h=="string"?h:h[0],w={indices:p,value:d,storage:y,tensor:t},_=G=>typeof G=="string"?G:`${G}u`,v={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},S=u?"uniforms.":"",A=`${S}${e}_shape`,I=`${S}${e}_strides`,x="";for(let G=0;G<a-1;G++)x+=`\n    let dim${G} = current / ${fe(I,G,a)};\n    let rest${G} = current % ${fe(I,G,a)};\n    indices[${G}] = dim${G};\n    current = rest${G};\n    `;x+=`indices[${a-1}] = current;`;let E=a<2?"":`\n  fn o2i_${e}(offset: u32) -> ${w.indices} {\n    var indices: ${w.indices};\n    var current = offset;\n    ${x}\n    return indices;\n  }`,P=G=>(v.offsetToIndices=!0,a<2?G:`o2i_${e}(${G})`),O=[];if(a>=2)for(let G=a-1;G>=0;G--)O.push(`${fe(I,G,a)} * (indices[${G}])`);let R=a<2?"":`\n  fn i2o_${e}(indices: ${w.indices}) -> u32 {\n    return ${O.join("+")};\n  }`,L=G=>(v.indicesToOffset=!0,a<2?G:`i2o_${e}(${G})`),N=(...G)=>a===0?"0u":`${w.indices}(${G.map(_).join(",")})`,K=(G,ne)=>a<2?`${G}`:`${fe(G,ne,a)}`,Q=(G,ne,xe)=>a<2?`${G}=${xe};`:`${fe(G,ne,a)}=${xe};`,he={},W=(G,ne)=>{v.broadcastedIndicesToOffset=!0;let xe=`${ne.name}broadcastedIndicesTo${e}Offset`;if(xe in he)return`${xe}(${G})`;let Ke=[];for(let Be=a-1;Be>=0;Be--){let Ge=ne.indicesGet("outputIndices",Be+ne.rank-a);Ke.push(`${K(I,Be)} * (${Ge} % ${K(A,Be)})`)}return he[xe]=`fn ${xe}(outputIndices: ${ne.type.indices}) -> u32 {\n             return ${Ke.length>0?Ke.join("+"):"0u"};\n           }`,`${xe}(${G})`},se=(G,ne)=>(()=>{if(w.storage===w.value)return`${e}[${G}]=${ne};`;if(w.storage==="vec2<u32>"&&w.value==="i32")return`${e}[${G}]=vec2<u32>(u32(${ne}), select(0u, 0xFFFFFFFFu, ${ne} < 0));`;if(w.storage==="vec2<u32>"&&w.value==="u32")return`${e}[${G}]=vec2<u32>(u32(${ne}), 0u);`;if(w.storage==="u32"&&w.value==="vec4<bool>")return`${e}[${G}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${ne}));`;throw new Error(`not supported combination of storage type ${w.storage} and value type ${w.value} yet`)})(),Ce=G=>(()=>{if(w.storage===w.value)return`${e}[${G}]`;if(w.storage==="vec2<u32>"&&w.value==="i32")return`i32(${e}[${G}].x)`;if(w.storage==="vec2<u32>"&&w.value==="u32")return`u32(${e}[${G}].x)`;if(w.storage==="u32"&&w.value==="vec4<bool>")return`vec4<bool>(bool(${e}[${G}] & 0xFFu), bool(${e}[${G}] & 0xFF00u), bool(${e}[${G}] & 0xFF0000u), bool(${e}[${G}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${w.storage} and value type ${w.value} yet`)})(),We=a<2?"":`\n  fn get_${e}ByIndices(indices: ${w.indices}) -> ${d} {\n    return ${Ce(`i2o_${e}(indices)`)};\n  }`,ee=a<2?"":(()=>{let G=c.map(xe=>`d${xe}: u32`).join(", "),ne=c.map(xe=>`d${xe}`).join(", ");return`\n  fn get_${e}(${G}) -> ${d} {\n    return get_${e}ByIndices(${N(ne)});\n  }`})(),ae=(...G)=>{if(G.length!==a)throw new Error(`indices length must be ${a}`);let ne=G.map(_).join(",");return a===0?Ce("0u"):a===1?Ce(ne[0]):(v.get=!0,v.getByIndices=!0,v.indicesToOffset=!0,`get_${e}(${ne})`)},Ae=G=>a<2?Ce(G):(v.getByIndices=!0,v.indicesToOffset=!0,`get_${e}ByIndices(${G})`),me=a<2?"":`\n  fn set_${e}ByIndices(indices: ${w.indices}, value: ${d}) {\n    ${se(`i2o_${e}(indices)`,"value")}\n  }`,ie=a<2?"":(()=>{let G=c.map(xe=>`d${xe}: u32`).join(", "),ne=c.map(xe=>`d${xe}`).join(", ");return`\n  fn set_${e}(${G}, value: ${d}) {\n    set_${e}ByIndices(${N(ne)}, value);\n  }`})();return{impl:()=>{let G=[],ne=!1;return v.offsetToIndices&&(G.push(E),ne=!0),v.indicesToOffset&&(G.push(R),ne=!0),v.broadcastedIndicesToOffset&&(Object.values(he).forEach(xe=>G.push(xe)),ne=!0),v.set&&(G.push(ie),ne=!0),v.setByIndices&&(G.push(me),ne=!0),v.get&&(G.push(ee),ne=!0),v.getByIndices&&(G.push(We),ne=!0),!u&&ne&&G.unshift(`const ${A} = ${w.indices}(${r.join(",")});`,`const ${I} = ${w.indices}(${M.computeStrides(r).join(",")});`),G.join(`\n`)},type:w,offsetToIndices:P,indicesToOffset:L,broadcastedIndicesToOffset:W,indices:N,indicesGet:K,indicesSet:Q,set:(...G)=>{if(G.length!==a+1)throw new Error(`indices length must be ${a}`);let ne=G[a];if(typeof ne!="string")throw new Error("value must be string");let xe=G.slice(0,a).map(_).join(",");return a===0?se("0u",ne):a===1?se(xe[0],ne):(v.set=!0,v.setByIndices=!0,v.indicesToOffset=!0,`set_${e}(${xe}, ${ne})`)},setByOffset:se,setByIndices:(G,ne)=>a<2?se(G,ne):(v.setByIndices=!0,v.indicesToOffset=!0,`set_${e}ByIndices(${G}, ${ne});`),get:ae,getByOffset:Ce,getByIndices:Ae,usage:o,name:e,strides:I,shape:A,rank:a}},U=(e,t,r,o=1)=>Eo(e,t,r,"input",o),j=(e,t,r,o=1)=>Eo(e,t,r,"output",o),An=(e,t,r,o=1)=>Eo(e,t,r,"internal",o),Io=class{constructor(t,r){this.normalizedDispatchGroup=t;this.limits=r;this.internalVariables=[];this.variables=[];this.uniforms=[];this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(t){return`if (global_idx >= ${typeof t=="number"?`${t}u`:t}) { return; }`}mainStart(t=or){let r=typeof t=="number"?t:t[0],o=typeof t=="number"?1:t[1],i=typeof t=="number"?1:t[2];if(r>this.limits.maxComputeWorkgroupSizeX||o>this.limits.maxComputeWorkgroupSizeY||i>this.limits.maxComputeWorkgroupSizeZ)throw new Error(`workgroup size [${r}, ${o}, ${i}] exceeds the maximum workgroup size [${this.limits.maxComputeWorkgroupSizeX}, ${this.limits.maxComputeWorkgroupSizeY}, ${this.limits.maxComputeWorkgroupSizeZ}].`);if(r*o*i>this.limits.maxComputeInvocationsPerWorkgroup)throw new Error(`workgroup size [${r}, ${o}, ${i}] exceeds the maximum workgroup invocations ${this.limits.maxComputeInvocationsPerWorkgroup}.`);let u=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,a=u?`@builtin(global_invocation_id) global_id : vec3<u32>,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(global_invocation_id) global_id : vec3<u32>,\n                                             @builtin(local_invocation_id) local_id : vec3<u32>,\n    @builtin(local_invocation_index) local_idx : u32,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(num_workgroups) num_workgroups : vec3<u32>`,c=u?"let global_idx = global_id.x; let local_idx = local_id.x;":`let global_idx = (workgroup_id.z * num_workgroups[0] * num_workgroups[1] +\n          workgroup_id.y * num_workgroups[0] + workgroup_id.x) * ${r*o*i}u + local_idx;`;return`@compute @workgroup_size(${r}, ${o}, ${i})\n  fn main(${a}) {\n    ${c}\n  `}appendVariableUniforms(t){t.rank!==0&&(t.shape.startsWith("uniforms.")&&this.uniforms.push({name:t.shape.replace("uniforms.",""),type:"u32",length:t.rank}),t.strides.startsWith("uniforms.")&&this.uniforms.push({name:t.strides.replace("uniforms.",""),type:"u32",length:t.rank}))}declareVariable(t,r){if(t.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(t),this.appendVariableUniforms(t);let o=t.usage==="input"?"read":"read_write",i=t.type.storage;return`@group(0) @binding(${r}) var<storage, ${o}> ${t.name}: array<${i}>;`}declareVariables(...t){return t.map(r=>this.declareVariable(r,this.variableIndex++)).join(`\n`)}registerInternalVariable(t){if(t.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(t),this.appendVariableUniforms(t)}registerInternalVariables(...t){return t.forEach(r=>this.registerInternalVariable(r)),this}registerUniform(t,r,o=1){return this.uniforms.push({name:t,type:r,length:o}),this}registerUniforms(t){return this.uniforms=this.uniforms.concat(t),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let t=[];for(let{name:r,type:o,length:i}of this.uniforms)if(i&&i>4)o==="f16"?t.push(`@align(16) ${r}:array<mat2x4<${o}>, ${Math.ceil(i/8)}>`):t.push(`${r}:array<vec4<${o}>, ${Math.ceil(i/4)}>`);else{let u=i==null||i===1?o:`vec${i}<${o}>`;t.push(`${r}:${u}`)}return`\n      struct Uniforms { ${t.join(", ")} };\n      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(t=>t.impl()).join(`\n`)+this.internalVariables.map(t=>t.impl()).join(`\n`)}get variablesInfo(){if(this.uniforms.length===0)return;let t=r=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(r)];return this.uniforms.map(r=>[t(r.type),r.length??1])}},va=(e,t)=>new Io(e,t),_r=(e,t)=>{let r=e.length,o=[];for(let i=0;i<r;i++){let u=r-1-i,a=e[u]||1;(t[t.length-1-i]||1)>1&&a===1&&o.unshift(u)}return o}});var Il,$a,Tl,El,yt,_a,Sa,Sr=Y(()=>{"use strict";ye();Se();Ze();_e();Il=e=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.")},$a=(e,t)=>t&&t.length!==e?[...new Array(e).keys()].reverse():t,Tl=(e,t)=>M.sortBasedOnPerm(e,$a(e.length,t)),El=(e,t,r,o)=>{let i=[];i.push(`fn perm(i: ${o.type.indices}) -> ${r.type.indices} {\n    var a: ${r.type.indices};`);for(let u=0;u<t;++u)i.push(r.indicesSet("a",e[u],`i[${u}]`));return i.push("return a;}"),i.join(`\n`)},yt=(e,t)=>{let r=e.dataType,o=e.dims.length,i=$a(o,t),u=Tl(e.dims,i),a=j("output",r,u.length),c=U("a",r,o),p=h=>`\n  ${h.registerUniform("output_size","u32").declareVariables(c,a)}\n\n  ${El(i,o,c,a)}\n\n  ${h.mainStart()}\n    ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let indices = ${a.offsetToIndices("global_idx")};\n    let aIndices = perm(indices);\n\n    ${a.setByOffset("global_idx",c.getByIndices("aIndices"))}\n  }`;return{name:"Transpose",shaderCache:{hint:`${t}`,inputDependencies:["rank"]},getRunData:h=>{let d=M.size(u);return{outputs:[{dims:u,dataType:h[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:[{type:12,data:d},...Z(h[0].dims,u)]}},getShaderSource:p}},_a=(e,t)=>{Il(e.inputs),e.compute(yt(e.inputs[0],t.perm))},Sa=e=>ve({perm:e.perm})});var Pl,kl,Ol,Rl,Bl,Dl,zl,Ml,Ul,Vl,Tt,xa,Ca,Aa,Ia,Ta,Ea,Pa,ka,Oa,Ra,Ba=Y(()=>{"use strict";ye();Se();_e();In();Sr();Pl={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},kl={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},Ol={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},Rl={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},Bl=(e,t)=>{let r=[];for(let o=t-e;o<t;++o)r.push(o);return r},Dl=(e,t)=>{let r=[],o=e.length;for(let u=0;u<o;u++)t.indexOf(u)===-1&&r.push(e[u]);let i=t.map(u=>e[u]);return[r,i]},zl=(e,t)=>{let r=e.length+t.length,o=[],i=0;for(let u=0;u<r;u++)t.indexOf(u)===-1?o.push(e[i++]):o.push(1);return o},Ml=(e,t)=>{for(let r=0;r<e.length;++r)if(e[e.length-r-1]!==t-1-r)return!1;return!0},Ul=(e,t)=>{let r=[];if(!Ml(e,t)){for(let o=0;o<t;++o)e.indexOf(o)===-1&&r.push(o);e.forEach(o=>r.push(o))}return r},Vl=(e,t,r,o,i,u,a)=>{let c=r[0].dims,p=M.size(u),h=M.size(a),d=U("_A",r[0].dataType,c),y=j("output",i,u),w=32,_=`\n          var<workgroup> aBestValues : array<f32, ${w}>;\n       `;return{name:e,shaderCache:t,getShaderSource:S=>`\n        ${S.registerUniform("reduceSize","u32").declareVariables(d,y)}\n        ${_}\n        fn DIV_CEIL(a : u32, b : u32) -> u32 {\n          return ((a - 1u) / b + 1u);\n         }\n         ${S.mainStart(w)}\n\n          let outputIndex = global_idx / ${w};\n          let offset = outputIndex * uniforms.reduceSize;\n\n          var bestValue = f32(${Ol[o]});\n          let Length = uniforms.reduceSize;\n          for (var k = local_idx; k < Length; k = k + ${w}) {\n           let candidate = f32(${d.getByOffset("offset + k")});\n           bestValue = ${Pl[o]};\n          }\n          aBestValues[local_idx] = bestValue;\n          workgroupBarrier();\n\n         var reduceSize = min(Length, ${w}u);\n         for (var currentSize = reduceSize / 2u; reduceSize > 1u;\n             currentSize = reduceSize / 2u) {\n           let interval = DIV_CEIL(reduceSize, 2u);\n           if (local_idx < currentSize) {\n            let candidate = aBestValues[local_idx + interval];\n            bestValue = ${kl[o]};\n            aBestValues[local_idx] = bestValue;\n           }\n           reduceSize = interval;\n           workgroupBarrier();\n         }\n\n         if (local_idx == 0u) {\n          ${y.setByOffset("outputIndex",`${o==="mean"?`${y.type.storage}(bestValue / f32(uniforms.reduceSize))`:`${y.type.storage}(${Rl[o]})`}`)};\n         }\n        }`,getRunData:()=>({outputs:[{dims:u,dataType:i}],dispatchGroup:{x:p},programUniforms:[{type:12,data:h}]})}},Tt=(e,t,r,o)=>{let i=e.inputs.length===1?r:Po(e.inputs,r),u=i.axes;u.length===0&&!i.noopWithEmptyAxes&&(u=e.inputs[0].dims.map((_,v)=>v));let a=M.normalizeAxes(u,e.inputs[0].dims.length),c=a,p=e.inputs[0],h=Ul(c,e.inputs[0].dims.length);h.length>0&&(p=e.compute(yt(e.inputs[0],h),{inputs:[0],outputs:[-1]})[0],c=Bl(c.length,p.dims.length));let[d,y]=Dl(p.dims,c),w=d;i.keepDims&&(w=zl(d,a)),e.compute(Vl(t,{hint:i.cacheKey,inputDependencies:["type"]},[p],o,e.inputs[0].dataType,w,y),{inputs:[p]})},xa=(e,t)=>{Tt(e,"ReduceMeanShared",t,"mean")},Ca=(e,t)=>{Tt(e,"ReduceL1Shared",t,"l1")},Aa=(e,t)=>{Tt(e,"ReduceL2Shared",t,"l2")},Ia=(e,t)=>{Tt(e,"ReduceLogSumExpShared",t,"logSumExp")},Ta=(e,t)=>{Tt(e,"ReduceMaxShared",t,"max")},Ea=(e,t)=>{Tt(e,"ReduceMinShared",t,"min")},Pa=(e,t)=>{Tt(e,"ReduceProdShared",t,"prod")},ka=(e,t)=>{Tt(e,"ReduceSumShared",t,"sum")},Oa=(e,t)=>{Tt(e,"ReduceSumSquareShared",t,"sumSquare")},Ra=(e,t)=>{Tt(e,"ReduceLogSumShared",t,"logSum")}});var Et,Wl,Tn,Po,Pt,Nl,Gl,Hl,Ll,Fl,ql,jl,Kl,Yl,Zl,kt,Da,za,Ma,Ua,Va,Wa,Na,Ga,Ha,La,In=Y(()=>{"use strict";ye();Se();Ze();_e();Ba();Et=e=>{if(!e||e.length===0||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(e.length===2&&e[1].dims.length!==1)throw new Error("Invalid axes input dims.")},Wl=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],Tn=(e,t,r,o,i,u,a=!1,c=!1)=>{let p=[],h=r[0].dims,d=h.length,y=M.normalizeAxes(i,d),w=!c&&y.length===0;h.forEach((A,I)=>{w||y.indexOf(I)>=0?a&&p.push(1):p.push(A)});let _=p.length,v=M.size(p);return{name:e,shaderCache:t,getShaderSource:A=>{let I=[],x=U("_A",r[0].dataType,d),E=j("output",u,_),P=o(x,E,y),O=P[2];for(let R=0,L=0;R<d;R++)w||y.indexOf(R)>=0?(a&&L++,O=`for(var j${R}: u32 = 0; j${R} < ${h[R]}; j${R}++) {\n                  ${P[2].includes("last_index")?`let last_index = j${R};`:""}\n                  ${x.indicesSet("input_indices",R,`j${R}`)}\n                  ${O}\n                }`):(I.push(`${x.indicesSet("input_indices",R,E.indicesGet("output_indices",L))};`),L++);return`\n\n        ${A.registerUniform("output_size","u32").declareVariables(x,E)}\n\n        ${A.mainStart()}\n          ${A.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n          var input_indices: ${x.type.indices};\n          let output_indices = ${E.offsetToIndices("global_idx")};\n\n          ${I.join(`\n`)}\n          ${P[0]}       // init ops for reduce max/min\n          ${P[1]}\n          ${O}\n          ${P[3]}\n          ${P.length===4?E.setByOffset("global_idx","value"):P.slice(4).join(`\n`)}\n        }`},getRunData:()=>({outputs:[{dims:p,dataType:u}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:[{type:12,data:v},...Z(h,p)]})}},Po=(e,t)=>{let r=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach(o=>r.push(Number(o))),ve({axes:r,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes})},Pt=(e,t,r,o)=>{let i=e.inputs,u=i.length===1?r:Po(i,r);e.compute(Tn(t,{hint:u.cacheKey,inputDependencies:["rank"]},[i[0]],u.noopWithEmptyAxes&&u.axes.length===0?Wl:o,u.axes,i[0].dataType,u.keepDims,u.noopWithEmptyAxes),{inputs:[0]})},Nl=(e,t)=>{Et(e.inputs),Pt(e,"ReduceLogSum",t,(o,i)=>[`var value = ${i.type.storage}(0);`,"",`value += ${o.getByIndices("input_indices")};`,"value = log(value);"])},Gl=(e,t)=>{Et(e.inputs),Pt(e,"ReduceL1",t,(o,i)=>[`var value = ${i.type.storage}(0);`,"",`value += abs(${o.getByIndices("input_indices")});`,""])},Hl=(e,t)=>{Et(e.inputs),Pt(e,"ReduceL2",t,(o,i)=>[`var t = ${i.type.value}(0); var value = ${i.type.value}(0);`,"",`t = ${o.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},Ll=(e,t)=>{Et(e.inputs),Pt(e,"ReduceLogSumExp",t,(o,i)=>[`var value = ${i.type.storage}(0);`,"",`value += exp(${o.getByIndices("input_indices")});`,"value = log(value);"])},Fl=(e,t)=>{Et(e.inputs),Pt(e,"ReduceMax",t,(o,i,u)=>{let a=[];for(let c=0;c<o.rank;c++)(u.indexOf(c)>=0||u.length===0)&&a.push(o.indicesSet("input_indices",c,0));return[`${a.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};`,`value = max(value, ${o.getByIndices("input_indices")});`,""]})},ql=(e,t)=>{Et(e.inputs),Pt(e,"ReduceMean",t,(o,i,u)=>{let a=1;for(let c=0;c<o.rank;c++)(u.indexOf(c)>=0||u.length===0)&&(a*=e.inputs[0].dims[c]);return["var sum = f32(0);","",`sum += f32(${o.getByIndices("input_indices")});`,`let value = ${i.type.value}(sum / ${a});`]})},jl=(e,t)=>{Et(e.inputs),Pt(e,"ReduceMin",t,(o,i,u)=>{let a=[];for(let c=0;c<o.rank;c++)(u.indexOf(c)>=0||u.length===0)&&a.push(`input_indices[${c}] = 0;`);return[`${a.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};`,`value = min(value, ${o.getByIndices("input_indices")});`,""]})},Kl=(e,t)=>{Et(e.inputs),Pt(e,"ReduceProd",t,(o,i)=>[`var value = ${i.type.storage}(1);`,"",`value *= ${o.getByIndices("input_indices")};`,""])},Yl=(e,t)=>{Et(e.inputs),Pt(e,"ReduceSum",t,(o,i)=>[`var value = ${i.type.storage}(0);`,"",`value += ${o.getByIndices("input_indices")};`,""])},Zl=(e,t)=>{Et(e.inputs),Pt(e,"ReduceSumSquare",t,(o,i)=>[`var t = ${i.type.value}(0); var value = ${i.type.value}(0);`,"",`t = ${o.getByIndices("input_indices")}; value += t * t;`,""])},kt=(e,t,r)=>{if(t.length===0)return r;let o=1,i=1;for(let u=0;u<t.length;u++)t.indexOf(u)===-1?o*=e[u]:i*=e[u];return i<32&&o>1024},Da=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?ql(e,t):xa(e,t)},za=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Gl(e,t):Ca(e,t)},Ma=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Hl(e,t):Aa(e,t)},Ua=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Ll(e,t):Ia(e,t)},Va=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Fl(e,t):Ta(e,t)},Wa=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?jl(e,t):Ea(e,t)},Na=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Kl(e,t):Pa(e,t)},Ga=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Yl(e,t):ka(e,t)},Ha=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Zl(e,t):Oa(e,t)},La=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Nl(e,t):Ra(e,t)}});var Fa,qa,ja,ko,Ka=Y(()=>{"use strict";ye();Ze();In();Fa=e=>{if(!e||e.length===0||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(e[0].dataType!==1)throw new Error("Invalid input type.")},qa=(e,t)=>{Fa(e.inputs);let r=(o,i,u)=>{let a=[];for(let c=0;c<o.rank;c++)(u.indexOf(c)>=0||u.length===0)&&a.push(`input_indices[${c}] = 0;`);return[`${a.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};\nvar best_index : i32 = 0;`,`if (${o.getByIndices("input_indices")} ${t.selectLastIndex>0?"<=":"<"} value) {\n         value = ${o.getByIndices("input_indices")};\n         best_index = i32(last_index);\n       }`,"",i.setByOffset("global_idx","best_index")]};e.compute(Tn("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},ja=(e,t)=>{Fa(e.inputs);let r=(o,i,u)=>{let a=[];for(let c=0;c<o.rank;c++)(u.indexOf(c)>=0||u.length===0)&&a.push(`input_indices[${c}] = 0;`);return[`${a.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};\nvar best_index : i32 = 0;`,`if (${o.getByIndices("input_indices")} ${t.selectLastIndex>0?">=":">"} value) {\n         value = ${o.getByIndices("input_indices")};\n         best_index = i32(last_index);\n       }`,"",i.setByOffset("global_idx","best_index")]};e.compute(Tn("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},ko=e=>ve(e)});var Xl,Ql,Jl,En,Ya,Za,Oo=Y(()=>{"use strict";ye();Se();Ze();_e();Xl=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");let r=0,o=e[r],i=o.dataType,u=o.dims.length;e.forEach((a,c)=>{if(c!==r){if(a.dataType!==i)throw new Error("input tensors should be one type");if(a.dims.length!==u)throw new Error("input tensors should have the same shape");a.dims.forEach((p,h)=>{if(h!==t&&p!==o.dims[h])throw new Error("non concat dimensions must match")})}})},Ql=(e,t)=>`\n  fn calculateInputIndex(index: u32) -> u32 {\n    let sizeInConcatAxis = array<u32, ${e}u>(${t});\n    for (var i: u32 = 0u; i < ${e}; i += 1u ) {\n      if (index < sizeInConcatAxis[i]) {\n        return i;\n      }\n    }\n    return ${e}u;\n  }`,Jl=(e,t)=>{let r=e.length,o=[];for(let i=0;i<r;++i){let u=t.setByOffset("global_idx",e[i].getByIndices("indices"));r===1?o.push(u):i===0?o.push(`if (inputIndex == ${i}u) { ${u} }`):i===r-1?o.push(`else { ${u} }`):o.push(`else if (inputIndex == ${i}) { ${u} }`)}return o.join(`\n`)},En=(e,t,r,o)=>{let i=M.size(r),u=new Array(e.length),a=new Array(e.length),c=0,p=[],h=[],d=[{type:12,data:i}];for(let S=0;S<e.length;++S)c+=e[S].dims[t],u[S]=c,h.push(e[S].dims.length),a[S]=U(`input${S}`,o,h[S]),p.push("rank"),d.push({type:12,data:u[S]});for(let S=0;S<e.length;++S)d.push(...Z(e[S].dims));d.push(...Z(r));let y=j("output",o,r.length),w=y.indicesGet("indices",t),_=Array.from(Array(u.length).keys()).map(S=>`uniforms.sizeInConcatAxis${S}`).join(","),v=S=>`\n\n  ${(()=>{S.registerUniform("outputSize","u32");for(let A=0;A<e.length;A++)S.registerUniform(`sizeInConcatAxis${A}`,"u32");return S.declareVariables(...a,y)})()}\n\n  ${Ql(u.length,_)}\n\n  ${S.mainStart()}\n    ${S.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n    var indices = ${y.offsetToIndices("global_idx")};\n\n    let inputIndex = calculateInputIndex(${w});\n    if (inputIndex != 0u) {\n      let sizeInConcatAxis = array<u32, ${u.length}u>(${_});\n      ${w} -= sizeInConcatAxis[inputIndex - 1u];\n    }\n\n    ${Jl(a,y)}\n  }`;return{name:"Concat",shaderCache:{hint:`${t}`,inputDependencies:p},getRunData:()=>({outputs:[{dims:r,dataType:o}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:d}),getShaderSource:v}},Ya=(e,t)=>{let r=e.inputs,o=r[0].dims,i=M.normalizeAxis(t.axis,o.length);Xl(r,i);let u=o.slice();u[i]=r.reduce((c,p)=>c+(p.dims.length>i?p.dims[i]:0),0);let a=r.filter(c=>M.size(c.dims)>0);e.compute(En(a,i,u,r[0].dataType),{inputs:a})},Za=e=>ve({axis:e.axis})});var ec,tc,rc,nc,Pn,oc,Xa,Ro=Y(()=>{"use strict";ye();_n();_e();Oo();ec=(e,t)=>{let r=e[0],o=e[1],i=e[2],u=e[3],a=e[4],c=e[5];if(a&&c)throw new Error("Attention cannot have both past and relative_position_bias");if(r.dims.length!==3)throw new Error(\'Input "input" must have 3 dimensions\');let p=r.dims[0],h=r.dims[1],d=r.dims[2];if(i.dims.length!==1)throw new Error(\'Input "bias" is expected to have 1 dimensions\');if(o.dims.length!==2)throw new Error(\'Input "weights" is expected to have 2 dimensions\');if(o.dims[0]!==d)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(i.dims[0]!==o.dims[1])throw new Error(\'Input "bias" dimension 0 should have same length as dimension 1 of input "weights"\');let y=i.dims[0]/3,w=y,_=w;if(t.qkvHiddenSizes.length>0){if(t.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let E of t.qkvHiddenSizes)if(E%t.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");y=t.qkvHiddenSizes[0],w=t.qkvHiddenSizes[1],_=t.qkvHiddenSizes[2]}let v=h;if(y!==w)throw new Error("qkv_hidden_sizes first element should be same as the second");if(i.dims[0]!==y+w+_)throw new Error(\'Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes\');let S=0;if(a){if(w!==_)throw new Error(\'Input "past" expect k_hidden_size == v_hidden_size\');if(a.dims.length!==5)throw new Error(\'Input "past" must have 5 dimensions\');if(a.dims[0]!==2)throw new Error(\'Input "past" first dimension must be 2\');if(a.dims[1]!==p)throw new Error(\'Input "past" second dimension must be batch_size\');if(a.dims[2]!==t.numHeads)throw new Error(\'Input "past" third dimension must be num_heads\');if(a.dims[4]!==w/t.numHeads)throw new Error(\'Input "past" fifth dimension must be k_hidden_size / num_heads\');t.pastPresentShareBuffer||(S=a.dims[3])}let A=v+S,I=-1,x=0;if(u)throw new Error("Mask not supported");if(a)throw new Error("past is not supported");return{batchSize:p,sequenceLength:h,pastSequenceLength:S,kvSequenceLength:v,totalSequenceLength:A,maxSequenceLength:I,inputHiddenSize:d,hiddenSize:y,vHiddenSize:_,headSize:Math.floor(y/t.numHeads),vHeadSize:Math.floor(_/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:x,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},tc=(e,t,r,o)=>{let i=Me(o),u=64,a=o/i;a<u?u=1:a/8<64&&(u=Math.ceil(a/8));let c=Math.ceil(o/i/u),p=[{type:t.dataType,data:1/o},{type:12,data:a},{type:12,data:c}],h=De(t.dataType,i),d=et(1,i),y=w=>{let _=j("x",t.dataType,t.dims,i),S=[{name:"d_inv",type:et(t.dataType)},{name:"d_comp",type:"u32"},{name:"elements_per_thread",type:"u32"}];return`\n  var<workgroup> thread_max: array<f32, ${u}>;\n  var<workgroup> thread_sum: array<f32, ${u}>;\n  ${w.registerUniforms(S).declareVariables(_)}\n  ${w.mainStart([u,1,1])}\n    let local_offset = local_idx * uniforms.elements_per_thread;\n    let offset = workgroup_id.x * uniforms.d_comp + local_offset;\n\n    var thread_max_vector = ${d}(-3.402823e+38f);\n    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < uniforms.d_comp; i++) {\n      thread_max_vector = max(${d}(x[offset + i]), thread_max_vector);\n    }\n    thread_max[local_idx] = ${(()=>{switch(i){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw new Error(`Unsupported components: ${i}`)}})()};\n    workgroupBarrier();\n\n    var max_value =  f32(-3.402823e+38f);\n    for (var i = 0u; i < ${u}; i++) {\n      max_value = max(thread_max[i], max_value);\n    }\n\n    var sum_vector = ${d}(0);\n    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < uniforms.d_comp; i++) {\n      sum_vector += exp(${d}(x[offset + i]) - max_value);\n    }\n    thread_sum[local_idx] = ${(()=>{switch(i){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw new Error(`Unsupported components: ${i}`)}})()};\n    workgroupBarrier();\n\n    var sum: f32 = 0;\n    for (var i = 0u; i < ${u}; i++) {\n      sum += thread_sum[i];\n    }\n\n    if (sum == 0) {\n      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < uniforms.d_comp; i++) {\n        x[offset + i] = ${_.type.value}(uniforms.d_inv);\n      }\n    } else {\n      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < uniforms.d_comp; i++) {\n        var f32input = ${d}(x[offset + i]);\n        x[offset + i] = ${_.type.value}(exp(f32input - max_value) / sum);\n      }\n    }\n  }`};return{name:"AttentionProbsSoftmax",shaderCache:{hint:`${u};${h};${i}`},getShaderSource:y,getRunData:()=>({outputs:[],dispatchGroup:{x:r},programUniforms:p})}},rc=(e,t,r,o,i,u,a)=>{let c=a+i.kvSequenceLength,p=[i.batchSize,i.numHeads,i.sequenceLength,c],h=u.scale===0?1/Math.sqrt(i.headSize):u.scale,d=Me(i.headSize),y=i.headSize/d,w=12,_={x:Math.ceil(c/w),y:Math.ceil(i.sequenceLength/w),z:i.batchSize*i.numHeads},v=[{type:12,data:i.sequenceLength},{type:12,data:y},{type:12,data:c},{type:12,data:i.numHeads},{type:1,data:h}],S=o?["type","type","type"]:["type","type"],A=I=>{let x=U("q",t.dataType,t.dims,d),E=U("key",r.dataType,r.dims,d),P=[x,E];o&&P.push(U("relative_position_bias",o.dataType,o.dims));let O=j("output",t.dataType,p),R=et(1,d),L=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"alpha",type:"f32"}];return`\n  const TILE_SIZE = ${w}u;\n\n  var<workgroup> tileQ: array<${x.type.storage}, ${w*w}>;\n  var<workgroup> tileK: array<${x.type.storage}, ${w*w}>;\n  ${I.registerUniforms(L).declareVariables(...P,O)}\n  ${I.mainStart([w,w,1])}\n    // x holds the N and y holds the M\n    let headIdx = workgroup_id.z;\n    let m = workgroup_id.y * TILE_SIZE;\n    let n = workgroup_id.x * TILE_SIZE;\n    let qOffset = uniforms.M * uniforms.K * headIdx + m * uniforms.K;\n    let kOffset = uniforms.N * uniforms.K * headIdx + n * uniforms.K;\n\n    var value = ${R}(0);\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {\n        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {\n        tileK[TILE_SIZE * local_id.y + local_id.x] = key[kOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      workgroupBarrier();\n\n      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {\n        value += ${R}(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = headIdx * uniforms.M * uniforms.N;\n    if (global_id.y < uniforms.M && global_id.x < uniforms.N) {\n      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;\n      var sum: f32 = ${(()=>{switch(d){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw new Error(`Unsupported components: ${d}`)}})()};\n        output[outputIdx] = ${O.type.value} (sum * uniforms.alpha) + ${o?"relative_position_bias[outputIdx]":"0.0"};\n    }\n  }`};return{name:"AttentionProbs",shaderCache:{hint:`${d}`,inputDependencies:S},getRunData:()=>({outputs:[{dims:p,dataType:t.dataType,gpuDataType:0}],dispatchGroup:_,programUniforms:v}),getShaderSource:A}},nc=(e,t,r,o,i)=>{let u=i+o.kvSequenceLength,a=[o.batchSize,o.sequenceLength,o.vHiddenSize],c=12,p={x:Math.ceil(o.vHeadSize/c),y:Math.ceil(o.sequenceLength/c),z:o.batchSize*o.numHeads},h=[{type:12,data:o.sequenceLength},{type:12,data:u},{type:12,data:o.vHeadSize},{type:12,data:o.numHeads},{type:12,data:o.vHiddenSize}];return{name:"AttentionScore",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:a,dataType:t.dataType,gpuDataType:0}],dispatchGroup:p,programUniforms:h}),getShaderSource:w=>{let _=U("probs",t.dataType,t.dims),v=U("v",r.dataType,r.dims),S=j("output",t.dataType,a),A=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"v_hidden_size",type:"u32"}];return`\n  const TILE_SIZE = ${c}u;\n  var<workgroup> tileQ: array<${_.type.value}, ${c*c}>;\n  var<workgroup> tileK: array<${_.type.value}, ${c*c}>;\n  ${w.registerUniforms(A).declareVariables(_,v,S)}\n  ${w.mainStart([c,c,1])}\n   let headIdx = workgroup_id.z;\n   let m = global_id.y;\n   let n = global_id.x;\n\n   let offsetA = headIdx * (uniforms.M * uniforms.K) + m * uniforms.K;\n   let offsetB = headIdx * (uniforms.N * uniforms.K) + n;\n\n   var value = ${_.type.storage}(0);\n   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n     if (m < uniforms.M && w + local_id.x < uniforms.K) {\n       tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];\n     }\n     if (n < uniforms.N && w + local_id.y < uniforms.K) {\n       tileK[TILE_SIZE * local_id.y + local_id.x] = v[offsetB + (w + local_id.y) * uniforms.N];\n     }\n     workgroupBarrier();\n     for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {\n       value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * k + local_id.x];\n     }\n     workgroupBarrier();\n   }\n\n   // we need to transpose output from BNSH_v to BSND_v\n   let batchIdx = workgroup_id.z / uniforms.num_heads;\n   let currentBatchHeadNumber = workgroup_id.z % uniforms.num_heads;\n   if (m < uniforms.M && n < uniforms.N) {\n     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size\n       + currentBatchHeadNumber * uniforms.N + n;\n     output[outputIdx] = value;\n   }\n  }`}}},Pn=(e,t,r,o,i,u,a,c,p,h,d)=>{let y=e.outputCount>1,w=e.outputCount>2,_=y&&w?h.pastSequenceLength:0,v=_+h.kvSequenceLength,S=[h.batchSize,h.numHeads,v,h.headSize],A=a?[a,r]:[r],I=y?e.compute(En(A,2,S,r.dataType),{inputs:A,outputs:[1]})[0]:r,x=[h.batchSize,h.numHeads,v,h.headSize],E=c?[c,o]:[o],P=w?e.compute(En(E,2,x,o.dataType),{inputs:E,outputs:[2]})[0]:o,O=[t,I];p&&O.push(p);let R=e.compute(rc(e,t,I,p,h,d,_),{inputs:O,outputs:[-1]})[0];e.compute(tc(e,R,h.batchSize*h.numHeads*h.sequenceLength,v),{inputs:[R],outputs:[]});let L=[R,P];e.compute(nc(e,R,P,h,_),{inputs:L,outputs:[0]})},oc=(e,t)=>{let r=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],o=t.sequenceLength,i=t.inputHiddenSize,u=t.headSize,a=12,c={x:Math.ceil(t.headSize/a),y:Math.ceil(t.sequenceLength/a),z:t.batchSize*t.numHeads},p=[e.inputs[0],e.inputs[1],e.inputs[2]],h=[{type:12,data:o},{type:12,data:i},{type:12,data:u},{type:12,data:t.numHeads},{type:12,data:t.headSize},{type:12,data:t.hiddenSize},{type:12,data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}],d=y=>{let w=j("output_q",p[0].dataType,r),_=j("output_k",p[0].dataType,r),v=j("output_v",p[0].dataType,r),S=U("input",p[0].dataType,p[0].dims),A=U("weight",p[1].dataType,p[1].dims),I=U("bias",p[2].dataType,p[2].dims),x=S.type.storage,E=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`\n  const TILE_SIZE = ${a}u;\n  var<workgroup> tileInput: array<${x}, ${a*a}>;\n  var<workgroup> tileWeightQ: array<${x}, ${a*a}>;\n  var<workgroup> tileWeightK: array<${x}, ${a*a}>;\n  var<workgroup> tileWeightV: array<${x}, ${a*a}>;\n  ${y.registerUniforms(E).declareVariables(S,A,I,w,_,v)}\n  ${y.mainStart([a,a,1])}\n    let batchIndex = workgroup_id.z / uniforms.num_heads;\n    let headNumber = workgroup_id.z % uniforms.num_heads;\n    let m = global_id.y;\n    let n = global_id.x;\n\n    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;\n    let biasOffsetQ = headNumber * uniforms.head_size;\n    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;\n    let biasOffsetV = uniforms.hidden_size + biasOffsetK;\n\n    var valueQ = ${x}(0);\n    var valueK = ${x}(0);\n    var valueV = ${x}(0);\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m < uniforms.M && w + local_id.x < uniforms.K) {\n        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];\n      }\n      if (n < uniforms.N && w + local_id.y < uniforms.K) {\n        let offset = n + (w + local_id.y) * uniforms.ldb;\n        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];\n        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];\n        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];\n      }\n      workgroupBarrier();\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        let inputTileOffset = TILE_SIZE * local_id.y + k;\n        let weightTileOffset = TILE_SIZE * k + local_id.x;\n        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];\n        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];\n        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = (m * uniforms.N + n) % uniforms.head_size;\n    valueQ += bias[headOffset + biasOffsetQ];\n    valueK += bias[headOffset + biasOffsetK];\n    valueV += bias[headOffset + biasOffsetV];\n\n    let offset = workgroup_id.z * uniforms.M * uniforms.N;\n    if (m < uniforms.M && n < uniforms.N) {\n      let outputIdx = offset + m * uniforms.N + n;\n      output_q[outputIdx] = valueQ;\n      output_k[outputIdx] = valueK;\n      output_v[outputIdx] = valueV;\n    }\n  }`};return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:c,programUniforms:h}),getShaderSource:d},{inputs:p,outputs:[-1,-1,-1]})},Xa=(e,t)=>{let r=ec(e.inputs,t),[o,i,u]=oc(e,r);return Pn(e,o,i,u,e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t)}});var ic,ac,sc,Qa,Ja=Y(()=>{"use strict";$r();ye();Se();Ze();_e();ic=(e,t)=>{if(!e||e.length!==5)throw new Error("BatchNormalization requires 5 inputs");let r=(o,i,u)=>{let a=i.length;if(a!==o.length)throw new Error(`${u}: num dimensions != ${a}`);i.forEach((c,p)=>{if(c!==o[p])throw new Error(`${u}: dim[${p}] do not match`)})};if(e[0].dims.length>1){let o=t.format==="NHWC"?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);r(e[1].dims,o,"Invalid input scale"),r(e[2].dims,o,"Invalid input B"),r(e[3].dims,o,"Invalid input mean"),r(e[4].dims,o,"Invalid input var")}else r(e[1].dims,[1],"Invalid input scale"),r(e[2].dims,[1],"Invalid input B"),r(e[3].dims,[1],"Invalid input mean"),r(e[4].dims,[1],"Invalid input var")},ac=(e,t)=>{let{epsilon:r,spatial:o,format:i}=t,u=e[0].dims,a=o?Me(u[u.length-1]):1,c=i==="NHWC"&&u.length>1?a:1,p=M.size(u)/a,h=o,d=h?u.length:u,y=U("x",e[0].dataType,e[0].dims,a),w=U("scale",e[1].dataType,e[1].dims,c),_=U("bias",e[2].dataType,e[2].dims,c),v=U("inputMean",e[3].dataType,e[3].dims,c),S=U("inputVar",e[4].dataType,e[4].dims,c),A=j("y",e[0].dataType,d,a),I=()=>{let E="";if(o)E=`let cOffset = ${u.length===1?"0u":i==="NHWC"?`outputIndices[${u.length-1}] / ${a}`:"outputIndices[1]"};`;else if(i==="NCHW")E=`\n            ${A.indicesSet("outputIndices","0","0")}\n            let cOffset = ${A.indicesToOffset("outputIndices")};`;else{E=`var cIndices = ${w.type.indices}(0);\n                       cIndices[0] = outputIndices[${u.length-1}];`;for(let P=1;P<w.rank;P++)E+=`cIndices[${P}] = outputIndices[${P}];`;E+=`let cOffset = ${w.indicesToOffset("cIndices")};`}return E},x=E=>`\n  const epsilon = ${r};\n  ${E.registerUniform("outputSize","u32").declareVariables(y,w,_,v,S,A)}\n  ${E.mainStart()}\n  ${E.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n    var outputIndices = ${A.offsetToIndices(`global_idx * ${a}`)};\n    ${I()}\n    let scale = ${w.getByOffset("cOffset")};\n    let bias = ${_.getByOffset("cOffset")};\n    let inputMean = ${v.getByOffset("cOffset")};\n    let inputVar = ${S.getByOffset("cOffset")};\n    let x = ${y.getByOffset("global_idx")};\n    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;\n    ${A.setByOffset("global_idx","value")}\n  }`;return{name:"BatchNormalization",shaderCache:{hint:`${t.epsilon}_${t.format}_${o}_${a}`,inputDependencies:h?["rank","type","type","type","type"]:void 0},getShaderSource:x,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:h?[{type:12,data:p},...Z(u)]:[{type:12,data:p}]})}},sc=e=>ve(e),Qa=(e,t)=>{let{inputs:r,outputCount:o}=e,i=sc({...t,outputCount:o});if(vr.webgpu.validateInputContent&&ic(r,i),t.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(ac(r,i))}});var uc,dc,es,ts=Y(()=>{"use strict";Se();_e();uc=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},dc=e=>{let t=e[0].dims,r=e[0].dims[2],o=M.size(t)/4,i=e[0].dataType,u=U("input",i,t,4),a=U("bias",i,[r],4),c=U("residual",i,t,4),p=j("output",i,t,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)}}),getShaderSource:d=>`\n  const channels = ${r}u / 4;\n  ${d.declareVariables(u,a,c,p)}\n\n  ${d.mainStart()}\n    ${d.guardAgainstOutOfBoundsWorkgroupSizes(o)}\n    let value = ${u.getByOffset("global_idx")}\n      + ${a.getByOffset("global_idx % channels")} + ${c.getByOffset("global_idx")};\n    ${p.setByOffset("global_idx","value")}\n  }`}},es=e=>{uc(e.inputs),e.compute(dc(e.inputs))}});var lc,ke,rs,ns,os,is,as,ss,us,ds,ls,cc,cs,ps,ms,fs,kn,hs,On,gs,ys,bs,ws,vs,$s,_s,Ss,xs,Cs,As,Is,Ts,Es,Ps,ks,Os,Rs,Bo,Do,Bs,Ds,zs,Rn=Y(()=>{"use strict";ye();Se();Ze();_e();lc=(e,t,r,o,i,u)=>{let a=Math.ceil(t/4),c="";typeof i=="string"?c=`${i}(a)`:c=i("a");let p=U("inputData",r,[a],4),h=j("outputData",o,[a],4);return`\n      ${e.registerUniform("vec_size","u32").declareVariables(p,h)}\n\n  ${u??""}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n\n    let a = ${p.getByOffset("global_idx")};\n    ${h.setByOffset("global_idx",c)}\n  }`},ke=(e,t,r,o,i,u=e.dataType)=>({name:t,shaderCache:{hint:i,inputDependencies:["type"]},getShaderSource:a=>lc(a,M.size(e.dims),e.dataType,u,r,o),getRunData:a=>({outputs:[{dims:e.dims,dataType:u}],dispatchGroup:{x:Math.ceil(M.size(a[0].dims)/64/4)},programUniforms:[{type:12,data:Math.ceil(M.size(e.dims)/4)}]})}),rs=e=>{e.compute(ke(e.inputs[0],"Abs","abs"))},ns=e=>{e.compute(ke(e.inputs[0],"Acos","acos"))},os=e=>{e.compute(ke(e.inputs[0],"Acosh","acosh"))},is=e=>{e.compute(ke(e.inputs[0],"Asin","asin"))},as=e=>{e.compute(ke(e.inputs[0],"Asinh","asinh"))},ss=e=>{e.compute(ke(e.inputs[0],"Atan","atan"))},us=e=>{e.compute(ke(e.inputs[0],"Atanh","atanh"))},ds=e=>ve(e),ls=(e,t)=>{let r;switch(t.to){case 10:r="vec4<f16>";break;case 1:r="vec4<f32>";break;case 12:r="vec4<u32>";break;case 6:r="vec4<i32>";break;case 9:r="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute \'to\' from \'Cast\' operator): ${t.to}`)}e.compute(ke(e.inputs[0],"Cast",r,void 0,t.cacheKey,t.to))},cc=e=>{let t=e.length>=2&&e[1].data!==0?e[1].getFloat32Array()[0]:xn,r=e.length>=3&&e[2].data!==0?e[2].getFloat32Array()[0]:Cn;return ve({min:t,max:r})},cs=(e,t)=>{let r=e.inputs.length===1?t:cc(e.inputs),o=et(e.inputs[0].dataType);e.compute(ke(e.inputs[0],"Clip",i=>`clamp(${i}, clip_min_, clip_max_)`,`\n    const clip_min_: vec4<${o}> = vec4(${o}(${r.min}));\n    const clip_max_: vec4<${o}> = vec4(${o}(${r.max}));\n`,r.cacheKey),{inputs:[0]})},ps=e=>{e.compute(ke(e.inputs[0],"Ceil","ceil"))},ms=e=>{e.compute(ke(e.inputs[0],"Cos","cos"))},fs=e=>{e.compute(ke(e.inputs[0],"Cosh","cosh"))},kn=e=>ve(e),hs=(e,t)=>{let r=et(e.inputs[0].dataType);e.compute(ke(e.inputs[0],"Elu",o=>`elu_vf32(${o})`,`\n  const elu_alpha_ = ${r}(${t.alpha});\n\n  fn elu_f32(a: ${r}) -> ${r} {\n  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);\n  }\n\n  fn elu_vf32(v: vec4<${r}>) -> vec4<${r}> {\n  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));\n  }`,t.cacheKey))},On=(e="f32")=>`\nconst r0: ${e} = 0.3275911;\nconst r1: ${e} = 0.254829592;\nconst r2: ${e} = -0.284496736;\nconst r3: ${e} = 1.421413741;\nconst r4: ${e} = -1.453152027;\nconst r5: ${e} = 1.061405429;\n\nfn erf_vf32(v: vec4<${e}>) -> vec4<${e}> {\n  let absv = abs(v);\n  let x = 1.0 / (1.0 + r0 * absv);\n  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));\n}`,gs=e=>{let t=et(e.inputs[0].dataType);e.compute(ke(e.inputs[0],"Erf",r=>`erf_vf32(${r})`,On(t)))},ys=e=>{e.compute(ke(e.inputs[0],"Exp","exp"))},bs=e=>{e.compute(ke(e.inputs[0],"Floor","floor"))},ws=e=>{let t=et(e.inputs[0].dataType);e.compute(ke(e.inputs[0],"Gelu",r=>`0.5 * ${r} * (1.0 + erf_vf32(${r} * 0.7071067811865475))`,On(t)))},vs=(e,t)=>{let r=et(e.inputs[0].dataType);e.compute(ke(e.inputs[0],"LeakyRelu",o=>`select(leaky_relu_alpha_ * ${o}, ${o}, ${o} >= vec4<${r}>(0.0))`,`const leaky_relu_alpha_ = ${r}(${t.alpha});`,t.cacheKey))},$s=e=>{e.compute(ke(e.inputs[0],"Not",t=>`!${t}`))},_s=e=>{e.compute(ke(e.inputs[0],"Neg",t=>`-${t}`))},Ss=e=>{e.compute(ke(e.inputs[0],"Reciprocal",t=>`1.0/${t}`))},xs=e=>{let t=et(e.inputs[0].dataType);e.compute(ke(e.inputs[0],"Relu",r=>`select(vec4<${t}>(0.0), ${r}, ${r} > vec4<${t}>(0.0))`))},Cs=e=>{e.compute(ke(e.inputs[0],"Sigmoid",t=>`(1.0 / (1.0 + exp(-${t})))`))},As=e=>ve(e),Is=(e,t)=>{let r=et(e.inputs[0].dataType);e.compute(ke(e.inputs[0],"HardSigmoid",o=>`max(vec4<${r}>(0.0), min(vec4<${r}>(1.0), ${t.alpha} * ${o} + vec4<${r}>(${t.beta})))`,void 0,t.cacheKey))},Ts=e=>{e.compute(ke(e.inputs[0],"Sin","sin"))},Es=e=>{e.compute(ke(e.inputs[0],"Sinh","sinh"))},Ps=e=>{e.compute(ke(e.inputs[0],"Sqrt","sqrt"))},ks=e=>{e.compute(ke(e.inputs[0],"Tan","tan"))},Os=e=>`sign(${e}) * (1 - exp(-2 * abs(${e}))) / (1 + exp(-2 * abs(${e})))`,Rs=e=>{e.compute(ke(e.inputs[0],"Tanh",Os))},Bo=(e="f32")=>`\nconst fast_gelu_a: ${e} = 0.5;\nconst fast_gelu_b: ${e} = 0.7978845608028654;\nconst fast_gelu_c: ${e} = 0.035677408136300125;\n\nfn tanh_v(v: vec4<${e}>) -> vec4<${e}> {\n  return ${Os("v")};\n}\n`,Do=e=>`(fast_gelu_a + fast_gelu_a * tanh_v(${e} * (fast_gelu_c * ${e} * ${e} + fast_gelu_b))) * ${e}`,Bs=e=>{let t=et(e.inputs[0].dataType);e.compute(ke(e.inputs[0],"FastGelu",Do,Bo(t),void 0,e.inputs[0].dataType))},Ds=(e,t)=>{let r=et(e.inputs[0].dataType);return e.compute(ke(e.inputs[0],"ThresholdedRelu",o=>`select(vec4<${r}>(0.0), ${o}, ${o} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${r}>(${t.alpha});`,t.cacheKey)),0},zs=e=>{e.compute(ke(e.inputs[0],"Log","log"))}});var pc,mc,Us,Vs=Y(()=>{"use strict";Se();_e();Rn();pc=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},mc=e=>{let t=e[0].dims.slice();t[2]=t[2]/2;let r=U("input",e[0].dataType,e[0].dims,4),o=U("bias",e[0].dataType,[e[0].dims[2]],4),i=j("output",e[0].dataType,t,4),u=M.size(t)/4,a=De(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)}}),getShaderSource:p=>`\n  const M_SQRT2 = sqrt(2.0);\n  const halfChannels = ${e[0].dims[2]/4/2}u;\n\n  ${p.declareVariables(r,o,i)}\n\n  ${On(a)}\n\n  ${p.mainStart()}\n    ${p.guardAgainstOutOfBoundsWorkgroupSizes(u)}\n    let biasIdx = global_idx % halfChannels;\n    let batchIndex = global_idx / halfChannels;\n    let inputOffset = biasIdx + batchIndex * halfChannels * 2;\n    let valueLeft = input[inputOffset] + bias[biasIdx];\n    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];\n    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);\n\n    ${i.setByOffset("global_idx","valueLeft * geluRight")}\n  }`}},Us=e=>{pc(e.inputs),e.compute(mc(e.inputs))}});var fc,hc,Ot,Ws,Ns,Gs,Hs,Ls,Fs,qs,js,Ks,Ys,Zs=Y(()=>{"use strict";ye();Se();_e();fc=(e,t,r,o,i,u,a,c,p,h,d,y)=>{let w,_;typeof c=="string"?w=_=(x,E)=>`${c}((${x}),(${E}))`:typeof c=="function"?w=_=c:(w=c.scalar,_=c.vector);let v=j("outputData",d,o.length,4),S=U("aData",p,t.length,4),A=U("bData",h,r.length,4),I;if(i)if(u){let x=M.size(t)===1,E=M.size(r)===1,P=t.length>0&&t[t.length-1]%4===0,O=r.length>0&&r[r.length-1]%4===0;x||E?I=v.setByOffset("global_idx",_(x?`${S.type.value}(${S.getByOffset("0")}.x)`:S.getByOffset("global_idx"),E?`${A.type.value}(${A.getByOffset("0")}.x)`:A.getByOffset("global_idx"))):I=`\n            let outputIndices = ${v.offsetToIndices("global_idx * 4u")};\n            let offsetA = ${S.broadcastedIndicesToOffset("outputIndices",v)};\n            let offsetB = ${A.broadcastedIndicesToOffset("outputIndices",v)};\n            ${v.setByOffset("global_idx",_(a||P?S.getByOffset("offsetA / 4u"):`${S.type.value}(${S.getByOffset("offsetA / 4u")}[offsetA % 4u])`,a||O?A.getByOffset("offsetB / 4u"):`${A.type.value}(${A.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}\n          `}else I=v.setByOffset("global_idx",_(S.getByOffset("global_idx"),A.getByOffset("global_idx")));else{if(!u)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let x=(E,P,O="")=>{let R=`aData[indexA${P}][componentA${P}]`,L=`bData[indexB${P}][componentB${P}]`;return`\n            let outputIndices${P} = ${v.offsetToIndices(`global_idx * 4u + ${P}u`)};\n            let offsetA${P} = ${S.broadcastedIndicesToOffset(`outputIndices${P}`,v)};\n            let offsetB${P} = ${A.broadcastedIndicesToOffset(`outputIndices${P}`,v)};\n            let indexA${P} = offsetA${P} / 4u;\n            let indexB${P} = offsetB${P} / 4u;\n            let componentA${P} = offsetA${P} % 4u;\n            let componentB${P} = offsetB${P} % 4u;\n            ${E}[${P}] = ${O}(${w(R,L)});\n          `};d===9?I=`\n            var data = vec4<u32>(0);\n            ${x("data",0,"u32")}\n            ${x("data",1,"u32")}\n            ${x("data",2,"u32")}\n            ${x("data",3,"u32")}\n            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:I=`\n            ${x("outputData[global_idx]",0)}\n            ${x("outputData[global_idx]",1)}\n            ${x("outputData[global_idx]",2)}\n            ${x("outputData[global_idx]",3)}\n          `}return`\n        ${e.registerUniform("vec_size","u32").declareVariables(S,A,v)}\n\n        ${y??""}\n\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n        ${I}\n      }`},hc=(e,t,r,o,i,u,a=r.dataType)=>{let c=!M.areEqual(r.dims,o.dims),p=r.dims,h=M.size(r.dims),d=!1,y=!1,w=[c];if(c){let _=It.calcShape(r.dims,o.dims,!1);if(!_)throw new Error("Can\'t perform binary op on the given tensors");p=_,h=M.size(p);let v=M.size(r.dims)===1,S=M.size(o.dims)===1,A=r.dims.length>0&&r.dims[r.dims.length-1]%4===0,I=o.dims.length>0&&o.dims[o.dims.length-1]%4===0;w.push(v),w.push(S),w.push(A),w.push(I);let x=1;for(let E=1;E<p.length;E++){let P=r.dims[r.dims.length-E]??1,O=o.dims[o.dims.length-E]??1;if(P===O)x*=P;else break}x%4===0?(y=!0,d=!0):(v||S||A||I)&&(d=!0)}else d=!0;return w.push(d),{name:e,shaderCache:{hint:t+w.map(_=>_.toString()).join("_"),inputDependencies:["rank","rank"]},getShaderSource:_=>fc(_,r.dims,o.dims,p,d,c,y,i,r.dataType,o.dataType,a,u),getRunData:()=>({outputs:[{dims:p,dataType:a}],dispatchGroup:{x:Math.ceil(h/64/4)},programUniforms:[{type:12,data:Math.ceil(M.size(p)/4)},...Z(r.dims,o.dims,p)]})}},Ot=(e,t,r,o,i,u)=>{e.compute(hc(t,i??"",e.inputs[0],e.inputs[1],r,o,u))},Ws=e=>{Ot(e,"Add",(t,r)=>`${t}+${r}`)},Ns=e=>{Ot(e,"Div",(t,r)=>`${t}/${r}`)},Gs=e=>{Ot(e,"Equal",{scalar:(t,r)=>`u32(${t}==${r})`,vector:(t,r)=>`vec4<u32>(${t}==${r})`},void 0,void 0,9)},Hs=e=>{Ot(e,"Mul",(t,r)=>`${t}*${r}`)},Ls=e=>{let t=U("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;Ot(e,"Pow",{scalar:(o,i)=>`pow_custom(${o},${i})`,vector:(o,i)=>`pow_vector_custom(${o},${i})`},`\n    fn pow_custom(a : ${t}, b : ${t}) -> ${t} {\n      if (b == ${t}(0.0)) {\n        return ${t}(1.0);\n      } else if (a < ${t}(0.0) && f32(b) != floor(f32(b))) {\n        return ${t}(pow(f32(a), f32(b))); // NaN\n      }\n      return select(sign(a), ${t}(1.0), round(f32(abs(b) % ${t}(2.0))) != 1.0) * ${t}(${t==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));\n    }\n    fn pow_vector_custom(a : vec4<${t}>, b : vec4<${t}>) -> vec4<${t}> {\n      // TODO: implement vectorized pow\n      return vec4<${t}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));\n    }\n      `)},Fs=e=>{Ot(e,"Sub",(t,r)=>`${t}-${r}`)},qs=e=>{Ot(e,"Greater",{scalar:(t,r)=>`u32(${t}>${r})`,vector:(t,r)=>`vec4<u32>(${t}>${r})`},void 0,void 0,9)},js=e=>{Ot(e,"Less",{scalar:(t,r)=>`u32(${t}<${r})`,vector:(t,r)=>`vec4<u32>(${t}<${r})`},void 0,void 0,9)},Ks=e=>{Ot(e,"GreaterOrEqual",{scalar:(t,r)=>`u32(${t}>=${r})`,vector:(t,r)=>`vec4<u32>(${t}>=${r})`},void 0,void 0,9)},Ys=e=>{Ot(e,"LessOrEqual",{scalar:(t,r)=>`u32(${t}<=${r})`,vector:(t,r)=>`vec4<u32>(${t}<=${r})`},void 0,void 0,9)}});var St,xt,Ct,Bn,Ft=Y(()=>{"use strict";ye();Se();St=(e,t,r="f32")=>{switch(e.activation){case"Relu":return`value = max(value, ${t}(0.0));`;case"Sigmoid":return`value = (${t}(1.0) / (${t}(1.0) + exp(-value)));`;case"Clip":return`value = clamp(value, ${t}(${r}(uniforms.clip_min)), ${t}(${r}(uniforms.clip_max)));`;case"HardSigmoid":return`value = max(${t}(0.0), min(${t}(1.0), ${r}(uniforms.alpha) * value + ${r}(uniforms.beta)));`;case"LeakyRelu":return`value = select(${r}(uniforms.alpha) * value, value, value >= ${t}(0.0));`;case"":return"";default:throw new Error(`Unsupported activation ${e.activation}`)}},xt=(e,t)=>{e.activation==="Clip"?t.push({type:1,data:e.clipMax},{type:1,data:e.clipMin}):e.activation==="HardSigmoid"?t.push({type:1,data:e.alpha},{type:1,data:e.beta}):e.activation==="LeakyRelu"&&t.push({type:1,data:e.alpha})},Ct=(e,t)=>{e.activation==="Clip"?t.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):e.activation==="HardSigmoid"?t.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):e.activation==="LeakyRelu"&&t.push({name:"alpha",type:"f32"})},Bn=e=>{let t=e?.activation||"";if(t==="HardSigmoid"){let[r,o]=e?.activation_params||[.2,.5];return{activation:t,alpha:r,beta:o}}else if(t==="Clip"){let[r,o]=e?.activation_params||[xn,Cn];return{activation:t,clipMax:o,clipMin:r}}else if(t==="LeakyRelu"){let[r]=e?.activation_params||[.01];return{activation:t,alpha:r}}return{activation:t}}});var tt,Dn,zn=Y(()=>{"use strict";tt=(e,t)=>{switch(e){case 1:return t;case 2:return`vec2<${t}>`;case 3:return`vec3<${t}>`;case 4:return`vec4<${t}>`;default:throw new Error(`${e}-component is not supported.`)}},Dn=e=>`\n      ${e?"value = value + getBiasByOutputCoords(coords);":""}\n      `});var Mn,zo=Y(()=>{"use strict";Mn=e=>`\nfn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));\n}\nfn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));\n}\n`});var yc,bc,Hr,Xs,wc,Lr,vc,Un,Fr=Y(()=>{"use strict";ye();Se();_e();Ft();zn();yc=(e,t)=>e?`\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          kStart + inputRow,\n          globalRowStart / innerElementSize + inputCol${t?", batchIndices":""});\n        `:`\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          globalRow + innerRow,\n          kStart / innerElementSize + inputCol${t?", batchIndices":""});\n        `,bc=(e,t)=>e?`\n        let ACached0 = mm_Asub[k * innerElementSize][localRow];\n        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];\n        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];\n        ${t===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          acc[i] = BCached0 * ACached0[i] + acc[i];\n          acc[i] = BCached1 * ACached1[i] + acc[i];\n          acc[i] = BCached2 * ACached2[i] + acc[i];\n          ${t===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}\n        }`:`\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          let ACached = mm_Asub[tileRow + i][k];\n          acc[i] = BCached0 * ACached.x + acc[i];\n          acc[i] = BCached1 * ACached.y + acc[i];\n          acc[i] = BCached2 * ACached.z + acc[i];\n          ${t===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}\n        }`,Hr=(e,t,r="f32",o,i=!1,u=32,a=!1,c=32)=>{let p=t[1]*e[1],h=t[0]*e[0],d=i?p:u,y=i?u:p,w=d/t[0],_=u/t[1];if(!((i&&w===4&&e[1]===4||!i&&(w===3||w===4))&&d%t[0]===0&&u%t[1]===0&&e[0]===4))throw new Error(`If transposeA ${i} is true, innerElementSize ${w} and workPerThread[1] ${e[1]} must be 4.\n      Otherwise, innerElementSize ${w} must be 3 or 4.\n  tileAWidth ${d} must be divisible by workgroupSize[0]${t[0]}. tileInner ${u} must be divisible by workgroupSize[1] ${t[1]}. colPerThread ${e[0]} must be 4.`);return`\nvar<workgroup> mm_Asub: array<array<vec${w}<${r}>, ${d/w}>, ${y}>;\nvar<workgroup> mm_Bsub: array<array<vec4<${r}>, ${h/e[0]}>, ${u}>;\n\nconst rowPerThread = ${e[1]};\nconst colPerThread = ${e[0]};\nconst innerElementSize = ${w};\nconst tileInner = ${u};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n  let localRow = i32(localId.y);\n  let tileRow = localRow * rowPerThread;\n  let tileCol = i32(localId.x);\n\n  let globalRow =i32(globalId.y) * rowPerThread;\n  let globalCol = i32(globalId.x);\n  let batch = ${a?"0":"i32(globalId.z)"};\n  ${o?`let batchIndices = ${o.offsetToIndices("u32(batch)")};`:""}\n  let globalRowStart = i32(workgroupId.y) * ${p};\n\n  let num_tiles = ${a?`${Math.ceil(c/u)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};\n  var kStart = ${a?`i32(globalId.z) * ${c}`:"0"};\n\n  var acc: array<vec4<${r}>, rowPerThread>;\n\n  // Loop over shared dimension.\n  let tileRowB = localRow * ${_};\n  for (var t = 0; t < num_tiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let inputRow = tileRow + innerRow;\n          let inputCol = tileCol;\n          ${yc(i,o)}\n      }\n\n      // Load one tile of B into local memory.\n      for (var innerRow = 0; innerRow < ${_}; innerRow = innerRow + 1) {\n          let inputRow = tileRowB + innerRow;\n          let inputCol = tileCol;\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${o?", batchIndices":""});\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {\n          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];\n          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];\n          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];\n          ${w===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}\n\n          ${bc(i,w)}\n      }\n\n      workgroupBarrier();\n  }\n\n  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);\n  }\n}`},Xs=(e,t)=>e?`\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              kStart + inputRow,\n              globalRowStart + inputCol${t?", batchIndices":""});\n            `:`\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              globalRowStart + inputRow,\n              kStart + inputCol${t?", batchIndices":""});\n            `,wc=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",Lr=(e,t,r="f32",o,i=!1,u=32,a=!1,c=32,p=!1)=>{let h=e[1]*t[1],d=e[0]*t[0],y=i?h:u,w=i?u:h;if(!(w%t[1]===0&&y%t[0]===0&&u%t[1]===0))throw new Error(`tileAHight ${w} must be divisible by workgroupSize[1]${t[1]}, tileAWidth ${y} must be divisible by workgroupSize[0]${t[0]}, tileInner ${u} must be divisible by workgroupSize[1]${t[1]}`);let _=w/t[1],v=y/t[0],S=u/t[1],A=p?`\n    let localRow = i32(localId.y);\n    let localCol = i32(localId.x);\n    let globalRowStart = i32(workgroupId.y) * ${h};\n    let globalColStart = i32(workgroupId.x) * ${d};\n\n    // Loop over shared dimension.\n    for (var t = 0; t < num_tiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var inputRow = localRow; inputRow < ${w}; inputRow = inputRow + ${t[1]}) {\n        for (var inputCol = localCol; inputCol < ${y}; inputCol = inputCol + ${t[0]}) {\n          ${Xs(i,o)}\n        }\n      }\n      // Load one tile of B into local memory.\n      for (var inputRow = localRow; inputRow < ${u}; inputRow = inputRow + ${t[1]}) {\n            for (var inputCol = localCol; inputCol < ${d}; inputCol = inputCol + ${t[0]}) {\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n            kStart + inputRow,\n            globalColStart + inputCol${o?", batchIndices":""});\n        }\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      var BCached : array<${r}, colPerThread>;\n      for (var k = 0; k < tileInner; k = k + 1) {\n        for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n          BCached[inner] = mm_Bsub[k][localCol + inner * ${t[0]}];\n        }\n        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let ACached = ${i?`mm_Asub[k][localRow + innerRow * ${t[1]}];`:`mm_Asub[localRow + innerRow * ${t[1]}][k];`}\n          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n            acc[innerRow][innerCol] = acc[innerRow][innerCol] +\n                ACached * BCached[innerCol];\n          }\n        }\n      }\n      workgroupBarrier();\n    }\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      let gRow = globalRowStart + localRow + innerRow * ${t[1]};\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        let gCol = globalColStart + localCol + innerCol * ${t[0]};\n        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);\n      }\n    }\n    `:`\nlet tileRow = i32(localId.y) * rowPerThread;\nlet tileCol = i32(localId.x) * colPerThread;\n\nlet globalRow = i32(globalId.y) * rowPerThread;\nlet globalCol = i32(globalId.x) * colPerThread;\nlet globalRowStart = i32(workgroupId.y) * ${h};\n\nlet tileRowA = i32(localId.y) * ${_};\nlet tileColA = i32(localId.x) * ${v};\nlet tileRowB = i32(localId.y) * ${S};\n// Loop over shared dimension.\nfor (var t = 0; t < num_tiles; t = t + 1) {\n  // Load one tile of A into local memory.\n  for (var innerRow = 0; innerRow < ${_}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < ${v}; innerCol = innerCol + 1) {\n      let inputRow = tileRowA + innerRow;\n      let inputCol = tileColA + innerCol;\n      ${Xs(i,o)}\n    }\n  }\n\n  // Load one tile of B into local memory.\n  for (var innerRow = 0; innerRow < ${S}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n      let inputRow = tileRowB + innerRow;\n      let inputCol = tileCol + innerCol;\n      mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n        kStart + inputRow,\n        globalCol + innerCol${o?", batchIndices":""});\n    }\n  }\n  kStart = kStart + tileInner;\n  workgroupBarrier();\n\n  // Compute acc values for a single thread.\n  var BCached : array<${r}, colPerThread>;\n  for (var k = 0; k < tileInner; k = k + 1) {\n    for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n      BCached[inner] = mm_Bsub[k][tileCol + inner];\n    }\n\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      ${wc(i)}\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];\n      }\n    }\n  }\n\n  workgroupBarrier();\n}\n\nfor (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n    mm_write(batch, globalRow + innerRow, globalCol + innerCol,\n        acc[innerRow][innerCol]);\n  }\n}\n`;return`\n  var<workgroup> mm_Asub : array<array<${r}, ${y}>, ${w}>;\n  var<workgroup> mm_Bsub : array<array<${r}, ${d}>, ${u}>;\n  const rowPerThread = ${e[1]};\n  const colPerThread = ${e[0]};\n  const tileInner = ${u};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n    let batch = ${a?"0":"i32(globalId.z)"};\n    ${o?`let batchIndices = ${o.offsetToIndices("u32(batch)")};`:""}\n    let num_tiles = ${a?`${Math.ceil(c/u)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};\n    var kStart = ${a?`i32(globalId.z) * ${c}`:"0"};\n\n    var acc : array<array<${r}, colPerThread>, rowPerThread>;\n\n    // Without this initialization strange values show up in acc.\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = 0.0;\n      }\n    }\n    ${A}\n  }\n`},vc=(e,t,r,o,i,u=!1)=>{let[a,c,p]=i,[h,d,y,w]=o,_=_r(a,p),v=_r(c,p),S=De(o[0].type.tensor),A=()=>{let E=d.rank,P=h.rank,O=`var aIndices: ${d.type.indices};`;for(let R=E-2-1,L=P-1;R>=0;R--,L--)O+=`\naIndices[${R}] = ${P>1?`batchIndices[${L}]`:"batchIndices"};`;return _.forEach(R=>{O+=`\naIndices[${R}] = 0;`}),O+=`\naIndices[${E-2}] = u32(row);\n                   aIndices[${E-1}] = u32(colIn);`,O},I=()=>{let E=y.rank,P=h.rank,O=`var bIndices: ${y.type.indices};`;for(let R=E-2-1,L=P-1;R>=0;R--,L--)O+=`\nbIndices[${R}] = ${P>1?`batchIndices[${L}]`:"batchIndices"};`;return v.forEach(R=>{O+=`\nbIndices[${R}] = 0;`}),O+=`\nbIndices[${E-2}] = u32(row);\n                   bIndices[${E-1}] = u32(colIn);`,O};return`\n    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${h.type.indices}) -> ${tt(e,S)} {\n      var value = ${tt(e,S)}(0.0);\n      let col = colIn * ${e};\n      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)\n      {\n        ${A()}\n        value = ${d.getByIndices("aIndices")};\n      }\n      return value;\n    }\n\n    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${h.type.indices}) -> ${tt(e,S)} {\n      var value = ${tt(e,S)}(0.0);\n      let col = colIn * ${e};\n      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)\n      {\n        ${I()}\n        value = ${y.getByIndices("bIndices")};\n      }\n      return value;\n    }\n\n    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${tt(e,S)}) {\n      let col = colIn * ${e};\n      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {\n        var value = valueIn;\n        let coords = vec3<i32>(batch, row, colIn);\n        ${t?`value = value + ${u?"bias[colIn]":`${tt(e,S)}(bias[row])`};`:""}\n        ${r}\n        ${w.setByIndices("vec3<u32>(coords)","value")}\n      }\n    }\n    `},Un=(e,t,r,o,i=!1)=>{let u=e[0].dims,a=e[1].dims,c=u.slice(0,-2),p=a.slice(0,-2),h=o?o.slice(0,-2):r.slice(0,-2),d=M.size(h),y=u[u.length-2],w=u[u.length-1],_=a[a.length-1],v=w%4===0&&_%4===0,S=y<=8?[4,1,1]:[4,4,1],A=[8,8,1],I=[Math.ceil(_/A[0]/S[0]),Math.ceil(y/A[1]/S[1]),Math.ceil(d/A[2]/S[2])],x=v?4:1,E=[...c,y,w/x],P=E.length,O=[...p,w,_/x],R=O.length,L=[d,y,_/x],N=[{type:6,data:y},{type:6,data:_},{type:6,data:w}];xt(t,N),N.push(...Z(h,E,O));let K=["rank","rank"],Q=e.length>2;Q&&(N.push(...Z(e[2].dims)),K.push("rank")),N.push(...Z(L));let he=W=>{let se=h.length,Ce=An("batchDims",e[0].dataType,se,1),We=De(e[0].dataType),ee=U("a",e[0].dataType,P,x),ae=U("b",e[1].dataType,R,x),Ae=j("result",e[0].dataType,L.length,x),me=[ee,ae];if(Q){let G=i?x:1;me.push(U("bias",e[2].dataType,e[2].dims.length,G))}let ie=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];Ct(t,ie);let ue=De(Ae.type.tensor),le=St(t,Ae.type.value,ue),qe=vc(x,Q,le,[Ce,ee,ae,Ae],[c,p,h],i);return`\n  ${W.registerUniforms(ie).registerInternalVariables(Ce).declareVariables(...me,Ae)}\n  ${qe}\n  ${v?Hr(S,A,We,Ce):Lr(S,A,We,Ce)}\n                   `};return{name:"MatMul",shaderCache:{hint:`${S};${t.activation};${v};${i}`,inputDependencies:K},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:I[0],y:I[1],z:I[2]},programUniforms:N}),getShaderSource:he}}});var $c,Qs,Js=Y(()=>{"use strict";ye();Lt();_e();Ft();zn();zo();Fr();$c=(e,t,r,o,i=!1,u,a=4,c=4,p=4,h="f32")=>{let d=Q=>{switch(Q){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${h}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${Q} is not supported.`)}},y=Q=>{switch(Q){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${Q} is not supported.`)}},w=e?`\n    let coord = vec4<i32>(batch, xRow, xCol, xCh);\n    `:`\n    let coord = vec4<i32>(batch, xCh, xRow, xCol);\n    `,_=e?`\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    `:`\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    `,v=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",S=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",A=e?"row":"col",I=e?"col":"row",x=`\n    let inChannels = i32(uniforms.w_shape[2]);\n    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n    let outRow = ${A} / outWidth;\n    let outCol = ${A} % outWidth;\n\n    let WRow = ${I} / (i32(uniforms.w_shape[1]) * inChannels);\n    let WCol = ${I} / inChannels % i32(uniforms.w_shape[1]);\n    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];\n    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];\n    let xCh = ${I} % inChannels;\n    var resData = ${tt(a,h)}(0.0);\n    // The bounds checking is always needed since we use it to pad zero for\n    // the \'same\' padding type.\n    if (xRow >= 0 && xRow < ${v} && xCol >= 0 && xCol < ${S}) {\n      ${w}\n      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));\n      ${d(a)}\n    }\n    return resData;`,E=e?t&&o?`\n    let col = colIn * ${a};\n    ${x}`:`\n    let col = colIn * ${a};\n    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {\n      ${x}\n    }\n    return ${tt(a,h)}(0.0);`:o&&r?`\n    let col = colIn * ${a};\n    ${x}`:`\n    let col = colIn * ${a};\n    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {\n      ${x}\n    }\n    return ${tt(a,h)}(0.0);`,P=`${y(c)}`,O=tt(p,h),R=e?tt(a,h):tt(c,h),L=e?tt(c,h):tt(a,h),N=St(u,O,h);return`\n    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${R} {\n      ${e?E:P}\n    }\n\n    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${L} {\n      ${e?P:E}\n    }\n\n    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${O}) {\n      let col = colIn * ${p};\n      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)\n      {\n      var value = valueIn;\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      ${_}\n      ${Dn(i)}\n      ${N}\n      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n      }\n    }`},Qs=(e,t,r,o,i,u,a,c)=>{let p=t.format==="NHWC",h=p?e[0].dims[3]:e[0].dims[1],d=r[0],y=p?r[2]:r[3],w=p?r[1]:r[2],_=p?r[3]:r[1],v=p&&(h%4===0||h%3===0)&&_%4===0,S=p?_:y*w,A=p?y*w:_,I=[8,8,1],x=o<=8?[4,1,1]:[4,4,1],E=[Math.ceil(S/I[0]/x[0]),Math.ceil(A/I[1]/x[1]),Math.ceil(d/I[2]/x[2])];Ve("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${E}`);let P=v?p&&h%4!==0?3:4:1,O=I[1]*x[1],R=I[0]*x[0],L=Math.max(I[0]*P,I[1]),N=o%O===0,K=i%R===0,Q=u%L===0,he=v?[P,4,4]:[1,1,1],W=[{type:6,data:o},{type:6,data:i},{type:6,data:u},{type:6,data:[t.pads[0],t.pads[1]]},{type:6,data:t.strides},{type:6,data:t.dilations}];xt(t,W),W.push(...Z(e[0].dims,e[1].dims));let se=["rank","rank"];a&&(W.push(...Z(e[2].dims)),se.push("rank")),W.push(...Z(r));let Ce=We=>{let ee=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];Ct(t,ee);let ae=v?4:1,Ae=De(e[0].dataType),me=`\n      fn setOutputAtIndex(flatIndex : i32, value : ${v?`vec4<${Ae}>`:Ae}) {\n        result[flatIndex] = ${v?`vec4<${Ae}>`:Ae}(value);\n      }\n      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${v?`vec4<${Ae}>`:Ae}) {\n        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));\n        setOutputAtIndex(flatIndex ${v?"/ 4":""}, value);\n      }`,ie=U("x",e[0].dataType,e[0].dims.length,P===3?1:P),ue=U("w",e[1].dataType,e[1].dims.length,ae),le=[ie,ue],qe=j("result",e[0].dataType,r.length,ae);if(a){let G=U("bias",e[2].dataType,e[2].dims.length,ae);le.push(G),me+=`\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${v?`vec4<${Ae}>`:Ae} {\n          return bias[coords.${p?"w":"y"}${v?"/ 4":""}];\n        }`}return`\n        ${Mn("uniforms.result_strides")}\n        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,\n        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,\n        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };\n        ${We.registerUniforms(ee).declareVariables(...le,qe)}\n        ${me}\n        ${$c(p,N,K,Q,a,t,he[0],he[1],he[2],Ae)}\n        ${v?Hr(x,I,Ae,void 0,!p,L):Lr(x,I,Ae,void 0,!p,L,!1,void 0,c)}`};return{name:"Conv2DMatMul",shaderCache:{hint:`${t.cacheKey};${P};${v};${N};${K};${Q};${O};${R};${L}`,inputDependencies:se},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:E[0],y:E[1],z:E[2]},programUniforms:W}),getShaderSource:Ce}}});var Mo,eu,tu=Y(()=>{"use strict";ye();Se();_e();Uo();Ft();Mo=(e,t,r)=>{let o=e.length>2,i=o?"value += b[output_channel];":"",u=e[0].dims,a=e[1].dims,c=a[0]/t.group,p=t.format==="NHWC",h=Vn(u,a,t.dilations,t.pads,t.strides,p),d=M.size(h),y=[{type:12,data:d},{type:12,data:t.dilations},{type:12,data:[t.strides[0],t.strides[1]]},{type:12,data:[t.pads[0],t.pads[1]]},{type:12,data:c}];xt(t,y),y.push(...Z(u,a));let w=["rank","rank"];o&&(y.push(...Z(e[2].dims)),w.push("rank")),y.push(...Z(h));let _=v=>{let S=j("output",e[0].dataType,h.length),A=De(S.type.tensor),I=St(t,S.type.value,A),x=U("x",e[0].dataType,u.length),E=U("w",e[1].dataType,a.length),P=[x,E];o&&P.push(U("b",e[2].dataType,e[2].dims.length));let O=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:t.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];return Ct(t,O),`\n  ${v.registerUniforms(O).declareVariables(...P,S)}\n\n  ${v.mainStart()}\n    ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let outputIndices = ${S.offsetToIndices("global_idx")};\n    let batch: u32 = outputIndices[0];\n    let output_channel: u32 = outputIndices[${p?3:1}];\n    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${p?1:2}], outputIndices[${p?2:3}]) * uniforms.strides - uniforms.pads;\n    let group_id: u32 = output_channel / uniforms.output_channels_per_group;\n\n    var value: ${S.type.value} = ${S.type.value}(0);\n    for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {\n      let input_channel = group_id * uniforms.w_shape[1] + wInChannel;\n      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {\n        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];\n\n        if (xHeight < 0u || xHeight >= uniforms.x_shape[${p?1:2}]) {\n          continue;\n        }\n\n        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {\n          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];\n          if (xWidth < 0u || xWidth >= uniforms.x_shape[${p?2:3}]) {\n            continue;\n          }\n\n          let xVal = ${p?x.get("batch","xHeight","xWidth","input_channel"):x.get("batch","input_channel","xHeight","xWidth")};\n          let wVal = ${E.get("output_channel","wInChannel","wHeight","wWidth")};\n          value += xVal*wVal;\n        }\n      }\n    }\n    ${i}\n    ${I}\n    ${S.setByOffset("global_idx","value")}\n  }`};return{name:"GroupedConv",shaderCache:{hint:t.cacheKey,inputDependencies:w},getRunData:()=>({outputs:[{dims:r?r(h):h,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:y}),getShaderSource:_}},eu=(e,t,r)=>{let o=e.length>2,i=Me(r[3]),u=Me(r[2]),a=M.size(r)/i/u,c=[e[0].dims[0],e[0].dims[1],e[0].dims[2],e[0].dims[3]/i],p=[e[1].dims[0],e[1].dims[1],e[1].dims[2],e[1].dims[3]/i],h=[r[0],r[1],r[2],r[3]/i],d=[{type:12,data:a},{type:6,data:[t.strides[0],t.strides[1]]},{type:6,data:[t.pads[0],t.pads[1]]}];xt(t,d),d.push(...Z(c,p,h));let y=(u-1)*t.strides[1]+p[1],w=_=>{let v=j("output",e[0].dataType,h.length,i),S=De(v.type.tensor),A=St(t,v.type.value,S),I=U("x",e[0].dataType,c.length,i),x=U("w",e[1].dataType,p.length,i),E=[I,x];o&&E.push(U("b",e[2].dataType,e[2].dims,i));let P=o?"value += b[output_channel];":"",O=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return Ct(t,O),`\n  ${_.registerUniforms(O).declareVariables(...E,v)}\n  ${_.mainStart()}\n    ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n    let width0 = uniforms.output_shape[3];\n    let output_channel = global_idx % width0;\n    var index1 = global_idx / width0;\n    let width1 = uniforms.output_shape[2] / ${u}u;\n    let col = (index1 % width1) * ${u}u;\n    index1 = index1 / width1;\n    let row = index1 % uniforms.output_shape[1];\n    let batch = index1 / uniforms.output_shape[1];\n\n    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;\n\n    var x_vals: array<${I.type.value}, ${y}>;\n    var values: array<${v.type.value}, ${u}>;\n    let input_channel = output_channel;\n    // Use constant instead of uniform can give better performance for w\'s height/width.\n    for (var w_height: u32 = 0u; w_height < ${p[0]}; w_height++) {\n      let x_height = x_corner.x + i32(w_height);\n      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {\n        for (var i = 0; i < ${y}; i++) {\n          let x_width = x_corner.y + i;\n          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {\n            x_vals[i] = ${I.get("batch","u32(x_height)","u32(x_width)","input_channel")};\n          } else {\n            x_vals[i] = ${I.type.value}(0);\n          }\n        }\n        for (var w_width: u32 = 0u; w_width < ${p[1]}; w_width++) {\n          let w_val = ${x.get("w_height","w_width","0","output_channel")};\n          for (var i = 0u; i < ${u}u; i++) {\n            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);\n          }\n        }\n      }\n    }\n\n    for (var i = 0u; i < ${u}u; i++) {\n      var value = values[i];\n      ${P}\n      ${A}\n      ${v.set("batch","row","col + i","output_channel","value")};\n    }\n  }`};return{name:"GroupedConv-Vectorize",shaderCache:{hint:`${t.cacheKey};${i};${u};${y};${p[0]};${p[1]}`,inputDependencies:o?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:d}),getShaderSource:w}}});var Vo,_c,ru,Wo=Y(()=>{"use strict";ye();Se();Fr();_e();Ft();Vo=(e,t,r,o,i=!1)=>{let u=e[0].dims,a=e[1].dims,c=u[u.length-2],p=a[a.length-1],h=u[u.length-1],d=Me(p),y=Me(h),w=Me(c),_=M.size(r)/d/w,v=e.length>2,S=o?o.slice(0,-2):r.slice(0,-2),I=[M.size(S),c,p],x=[{type:12,data:_},{type:12,data:c},{type:12,data:p},{type:12,data:h}];xt(t,x),x.push(...Z(S,u,a)),v&&x.push(...Z(e[2].dims)),x.push(...Z(I));let E=P=>{let O=An("batch_dims",e[0].dataType,S.length),R=U("a",e[0].dataType,u.length,y),L=U("b",e[1].dataType,a.length,d),N=j("output",e[0].dataType,I.length,d),K=De(N.type.tensor),Q=St(t,N.type.value,K),he=[R,L],W="";if(v){let ie=i?d:1;he.push(U("bias",e[2].dataType,e[2].dims.length,ie)),W=`${i?`value += bias[col / ${ie}];`:`value += ${N.type.value}(bias[row + i]);`}`}let se=u.slice(0,-2),Ce=a.slice(0,-2),We=_r(se,S),ee=_r(Ce,S),ae=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];Ct(t,ae);let Ae=(ie,ue)=>{let le=ie.rank,qe=ie.name;if(le===2)return`var ${qe}_indices = ${ie.type.indices}(0u, 0u);`;let G=O.rank,ne=`var ${qe}_indices: ${ie.type.indices};`;for(let xe=le-2-1,Ke=G-1;xe>=0;xe--,Ke--)ne+=`\n${qe}_indices[${xe}] = ${G>1?`batch_indices[${Ke}]`:"batch_indices"};`;return ue.forEach(xe=>{ne+=`\n${qe}_indices[${xe}] = 0;`}),ne+=`${qe}_indices[${le-2}] = 0u;\n                     ${qe}_indices[${le-1}] = 0u;`,ne},me=()=>{let ie=`var a_data: ${R.type.value};`;for(let ue=0;ue<y;ue++)ie+=`\n              let b_data${ue} = b[(b_offset + (k + ${ue}) * uniforms.N + col) / ${d}];`;for(let ue=0;ue<w;ue++){ie+=`a_data = a[(a_offset + (row + ${ue}) * uniforms.K + k) / ${y}];`;for(let le=0;le<y;le++)ie+=`\n            values[${ue}] = fma(${L.type.value}(a_data${y===1?"":`[${le}]`}), b_data${le}, values[${ue}]);\n`}return ie};return`\n  ${P.registerUniforms(ae).registerInternalVariables(O).declareVariables(...he,N)}\n  ${P.mainStart()}\n    ${P.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n    let col = (global_idx % (uniforms.N / ${d})) * ${d};\n    var index1 = global_idx / (uniforms.N / ${d});\n    let stride1 = uniforms.M / ${w};\n    let row = (index1 % stride1) * ${w};\n    let batch = index1 / stride1;\n\n    ${r.length===2?"":`let batch_indices = ${O.offsetToIndices("batch")};`}\n    ${Ae(R,We)}\n    let a_offset = ${R.indicesToOffset("a_indices")};\n    ${Ae(L,ee)}\n    let b_offset = ${L.indicesToOffset("b_indices")};\n    var values: array<${N.type.value}, ${w}>;\n    for (var k: u32 = 0u; k < uniforms.K; k = k + ${y}) {\n      ${me()}\n    }\n    for (var i = 0u; i < ${w}u; i++) {\n      var value = values[i];\n      ${W}\n      ${Q}\n      let cur_indices = ${N.type.indices}(batch, row + i, col);\n      let offset = ${N.indicesToOffset("cur_indices")};\n      ${N.setByOffset(`offset / ${d}`,"value")};\n    }\n  }\n  `};return{name:"MatMulNaive",shaderCache:{hint:`${t.activation};${d};${y};${w};${i}`,inputDependencies:v?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:x}),getShaderSource:E}},_c=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},ru=e=>{_c(e.inputs);let t=It.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw new Error("Can\'t use matmul on the given tensors");let r=t[t.length-1],o=e.inputs[0].dims[e.inputs[0].dims.length-1];r<8&&o<8?e.compute(Vo(e.inputs,{activation:""},t)):e.compute(Un(e.inputs,{activation:""},t))}});var Vn,No,Sc,nu,Go,xc,Cc,Ho,Uo=Y(()=>{"use strict";Se();Js();Fr();tu();Ft();Wo();Sr();Vn=(e,t,r,o,i,u)=>{let a=e[0],c=e.slice(u?1:2,u?3:4),p=c.length,h=t[0],y=t.slice(2).map((v,S)=>v+(v-1)*(r[S]-1)),_=c.map((v,S)=>v+o[S]+o[S+p]).map((v,S)=>Math.floor((v-y[S]+i[S])/i[S]));return _.splice(0,0,a),_.splice(u?3:1,0,h),_},No=[2,3,1,0],Sc=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support conv 1D and 2D");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],o=e[1].dims[1]*t.group;if(r!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(e.length===3&&(e[2].dims.length!==1||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let i=e[0].dims.length-2;if(t.dilations.length!==i)throw new Error(`dilations should be ${i}D`);if(t.strides.length!==i)throw new Error(`strides should be ${i}D`);if(t.pads.length!==i*2)throw new Error(`pads should be ${i*2}D`);if(t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},nu=(e,t)=>{let r=e.kernelShape.slice();for(let u=2;u<t[1].dims.length;++u)r[u-2]===0&&(r[u-2]=t[1].dims[u]);let o=e.pads.slice();nr.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,o,e.format==="NHWC",e.autoPad);let i=Object.assign({},e);return Object.assign(i,{kernelShape:r,pads:o}),i},Go=e=>{let t=Bn(e),r=e.format,o=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],i=e.dilations,u=e.group,a=e.kernel_shape,c=e.pads,p=e.strides,h=e.w_is_const();return{autoPad:o,format:r,dilations:i,group:u,kernelShape:a,pads:c,strides:p,wIsConst:h,...t,cacheKey:`${e.format};${t.activation};`}},xc=(e,t,r)=>{let o=nu(r,t),i=r.format==="NHWC";if(r.group!==1){if(!e.adapterInfo.isArchitecture("ampere")&&i&&t[1].dims[0]===r.group&&t[1].dims[1]===1&&r.dilations[0]===1&&r.dilations[1]===1){let L=Vn(t[0].dims,t[1].dims,r.dilations,o.pads,r.strides,i),N=e.kernelCustomData.wT??e.compute(yt(t[1],No),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=N);let K=[t[0],N];t.length===3&&K.push(t[2]),e.compute(eu(K,o,L),{inputs:K})}else e.compute(Mo(t,o));return}let u=t.length===3,a=t[0].dims[i?1:2],c=t[0].dims[i?2:3],p=t[0].dims[i?3:1],h=t[1].dims[2],d=t[1].dims[3],y=Vn(t[0].dims,t[1].dims,r.dilations,o.pads,r.strides,i),w=y[i?1:2],_=y[i?2:3],v=y[i?3:1],S=i&&h===a&&d===c&&r.pads[0]===0&&r.pads[1]===0;if(S||h===1&&d===1&&r.dilations[0]===1&&r.dilations[1]===1&&r.strides[0]===1&&r.strides[1]===1&&r.pads[0]===0&&r.pads[1]===0){let R=y[0],L,N,K,Q=[];if(i){let se=e.kernelCustomData.wT??e.compute(yt(t[1],No),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];if(r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=se),S){let Ce=a*c*p;L=t[0].reshape([1,R,Ce]),N=se.reshape([1,Ce,v]),K=[1,R,v]}else L=t[0].reshape([R,a*c,p]),N=se.reshape([1,p,v]),K=[R,w*_,v];Q.push(L),Q.push(N)}else L=t[0].reshape([R,p,a*c]),N=t[1].reshape([1,v,p]),K=[R,v,w*_],Q.push(N),Q.push(L);u&&Q.push(t[2]);let he=K[2],W=Q[0].dims[Q[0].dims.length-1];he<8&&W<8?e.compute(Vo(Q,o,y,K,i),{inputs:Q}):e.compute(Un(Q,o,y,K,i),{inputs:Q});return}let A=!0,I=e.kernelCustomData.wT??e.compute(yt(t[1],No),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=I);let x=[t[0],I];u&&x.push(t[2]);let E=i?w*_:v,P=i?v:w*_,O=h*d*p;e.compute(Qs(x,o,y,E,P,O,u,A),{inputs:x})},Cc=(e,t)=>{let r=t.format==="NHWC",o=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&o.push(e.inputs[2]);let i=[0,t.pads[0],0,t.pads[1]],u=[1].concat(t.strides),a=[1].concat(t.dilations),c=[1].concat(t.kernelShape),p=nu({...t,pads:i,strides:u,dilations:a,kernelShape:c},o);e.compute(Mo(o,p,h=>r?[h[0],h[2],h[3]]:[]))},Ho=(e,t)=>{Sc(e.inputs,t),e.inputs[0].dims.length===3?Cc(e,t):xc(e,e.inputs,t)}});var Ac,ou,iu=Y(()=>{"use strict";ye();Lt();_e();Ft();zn();zo();Fr();Ac=(e,t=!1,r,o,i=4)=>{let u=I=>{switch(I){case 1:return"return w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];";case 4:return`\n            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);\n            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);\n            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);\n            let v0 = w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];\n            let v1 = w[getIndexFromCoords4D(coord1, vec4<i32>(uniforms.w_shape))];\n            let v2 = w[getIndexFromCoords4D(coord2, vec4<i32>(uniforms.w_shape))];\n            let v3 = w[getIndexFromCoords4D(coord3, vec4<i32>(uniforms.w_shape))];\n            return ${o}(v0, v1, v2, v3);\n            `;default:throw new Error(`innerElementSize ${I} is not supported.`)}},a=e?`\n      let coord = vec4<i32>(batch, iXR, iXC, xCh);\n      `:`\n      let coord = vec4<i32>(batch, xCh, iXR, iXC);\n      `,c=e?`\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    `:`\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    `,p=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",h=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",d=e?"row":"col",y=e?"col":"row",w=`\n      let inChannels = ${e?"i32(uniforms.x_shape[3])":"i32(uniforms.x_shape[1])"};\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      let outRow = ${d} / outWidth;\n      let outCol = ${d} % outWidth;\n\n      let WRow = ${y} / (uniforms.filter_dims[1] * inChannels);\n      let WCol = ${y} / inChannels % uniforms.filter_dims[1];\n      let xR = f32(outRow - uniforms.pads[0] + uniforms.dilations[0] * WRow) / f32(uniforms.strides[0]);\n      let xC = f32(outCol - uniforms.pads[1] + uniforms.dilations[1] * WCol) / f32(uniforms.strides[1]);\n      if (xR < 0.0 || xR >= f32(${p}) || fract(xR) > 0.0) {\n        return ${o}(0.0);\n      }\n      if (xC < 0.0 || xC >= f32(${h}) || fract(xC) > 0.0) {\n        return ${o}(0.0);\n      }\n      let iXR = i32(xR);\n      let iXC = i32(xC);\n      let xCh = ${y} % inChannels;\n      ${a}\n      return x[getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape))/${i}];`,_=e?`\n      let col = colIn * ${i};\n      if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {\n        ${w}\n      }\n      return ${o}(0.0);`:`\n      let col = colIn * ${i};\n      if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {\n        ${w}\n      }\n      return ${o}(0.0);`,v=`\n      let col = colIn * ${i};\n      let inChannels = ${e?"i32(uniforms.x_shape[3])":"i32(uniforms.x_shape[1])"};\n      let coordX = uniforms.filter_dims[0] - 1 - row / (uniforms.filter_dims[1] * inChannels);\n      let coordY = uniforms.filter_dims[1] - 1 - (row / inChannels) % uniforms.filter_dims[1];\n      if (${e?"row < uniforms.dim_inner && col < uniforms.dim_b_outer":"row < uniforms.dim_inner && col < uniforms.dim_a_outer"}  && coordX >= 0 && coordY >= 0) {\n        let rowInner = row % inChannels;\n        let coord = vec4<i32>(coordX, coordY, col, rowInner);\n        ${u(i)}\n      }\n      return ${o}(0.0);\n      `,S=St(r,o);return`\n  fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${o} {\n    ${e?_:v}\n  }\n\n  fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${o} {\n    ${e?v:_}\n  }\n\n  fn mm_write(batch: i32, row : i32, colIn : i32, valueInput : ${o}) {\n    let col = colIn * ${i};\n    if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {\n      var value = valueInput;\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      ${c}\n      ${Dn(t)}\n      ${S}\n      result[getIndexFromCoords4D(coords, vec4<i32>(uniforms.result_shape))/${i}] = value;\n    }\n  }`},ou=(e,t,r,o,i,u,a,c)=>{let p=t.format==="NHWC",h=p?e[0].dims[3]:e[0].dims[1],d=r[0],y=p?r[2]:r[3],w=p?r[1]:r[2],_=p?r[3]:r[1],v=p&&h%4===0&&h%3&&_%4===0,S=p?_:y*w,A=p?y*w:_,I=[8,8,1],x=o<=8?[4,1,1]:[4,4,1],E=[Math.ceil(S/I[0]/x[0]),Math.ceil(A/I[1]/x[1]),Math.ceil(d/I[2]/x[2])];Ve("verbose",()=>`[conv_backprop_mm_webgpu] dispatch = ${E}`);let P=v?4:1,O=Math.max(I[0]*P,I[1]),R=v?4:1,L=[t.kernelShape[p?1:2],t.kernelShape[p?2:3]],N=[L[0]+(t.dilations[0]<=1?0:(L[0]-1)*(t.dilations[0]-1)),L[1]+(t.dilations[1]<=1?0:(L[1]-1)*(t.dilations[1]-1))],K=[N[0]-1-Math.floor((t.pads[0]+t.pads[2])/2),N[1]-1-Math.floor((t.pads[1]+t.pads[3])/2)],Q=[{type:6,data:o},{type:6,data:i},{type:6,data:u},{type:6,data:t.strides},{type:6,data:t.dilations},{type:6,data:L},{type:6,data:K}];xt(t,Q),Q.push(...Z(e[0].dims,e[1].dims));let he=["rank","rank"];a&&(Q.push(...Z(e[2].dims)),he.push("rank")),Q.push(...Z(r));let W=se=>{let Ce=U("x",e[0].dataType,e[0].dims.length,R),We=U("w",e[1].dataType,e[1].dims.length,1),ee=j("result",e[0].dataType,r.length,R),ae=[Ce,We],Ae="";if(a){let ue=U("bias",e[2].dataType,e[2].dims.length,R);ae.push(ue),Ae+=`\n          fn getBiasByOutputCoords(coords : vec4<i32>) -> ${ue.type.value} {\n            return bias[coords.${p?"w":"y"}${v?"/ 4":""}];\n          }`}let me=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"strides",type:"i32",length:2},{name:"dilations",type:"i32",length:2},{name:"filter_dims",type:"i32",length:L.length},{name:"pads",type:"i32",length:K.length}];Ct(t,me);let ie=De(e[0].dataType,1);if(ie!=="f16"&&ie!=="f32")throw new Error(`elemType ${ie} is not supported.`);return`\n        ${Mn("uniforms.result_strides")}\n        ${se.registerUniforms(me).declareVariables(...ae,ee)};\n        ${Ae}\n        ${Ac(p,a,t,Ce.type.value,P)}\n        ${v?Hr(x,I,ie,void 0,!p,O):Lr(x,I,ie,void 0,!p,O,!1,void 0,c)}`};return{name:"Conv2DTransposeMatMul",shaderCache:{hint:`${t.cacheKey};${x};${I};${v}`,inputDependencies:he},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:E[0],y:E[1],z:E[2]},programUniforms:Q}),getShaderSource:W}}});var Ic,Lo,au=Y(()=>{"use strict";ye();Lt();Se();_e();Ic=(e,t,r,o,i,u=!1,a,c,p=!1)=>{let h=p?1:2,d=p?2:3,y=p?3:1,w=u?2:1,_=`\n  fn setOutputAtIndex(flatIndex : u32, value : ${u?`vec4<${a}>`:a}) {\n    result[flatIndex] = ${u?`vec4<${a}>`:a}(value);\n  }`;o&&(_+=`\n    fn getBiasByOutputCoords(coords : vec4<u32>) -> ${u?`vec4<${a}>`:a} {\n      return bias[coords.${p?"w":"y"}${u?"/ 4":""}];\n    }`);let v=u?4:1,S=U("W",t[1].dataType,t[1].dims.length,v),A=U("Dy",t[0].dataType,t[0].dims.length,v),I=[A,S];o&&I.push(U("bias",t[2].dataType,[r[y]].length,v));let x=j("result",t[0].dataType,r.length,v),E=`{\n        let batch: u32 = ${i?"global_id.z":"workgroup_id.z"} / uniforms.result_shape[1];\n        let r = ${i?"global_id.z":"workgroup_id.z"} % uniforms.result_shape[1];\n        let c = ${i?"global_id.y":"workgroup_id.y"} * ${w};\n        let d1: u32 = ${i?"global_id.x":"workgroup_id.x"} * 4;\n\n        let dyCorner = vec2<i32>(i32(r), i32(c)) - vec2<i32>(uniforms.pads);\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd: array<vec4<${a}>, ${w}>;\n        for (var i = 0; i < ${w}; i++) {\n          dotProd[i] = vec4<${a}>(0.0);\n        }\n        for (var wR: u32 = 0; wR < uniforms.filter_dims[0]; wR = wR + 1) {\n          var dyR = (${a}(dyCorner.x) + ${a}(wR)) / ${a}(uniforms.strides.x);\n          let wRPerm = uniforms.filter_dims[0] - 1 - wR;\n          if (dyR < 0.0 || dyR >= ${a}(uniforms.Dy_shape[1]) ||\n              fract(dyR) > 0.0 || wRPerm < 0) {\n            continue;\n          }\n          let idyR: u32 = u32(dyR);\n\n          for (var wC: u32 = 0; wC < uniforms.filter_dims[1]; wC = wC + 1) {\n            let dyC = (${a}(dyCorner.y) + ${a}(wC)) / ${a}(uniforms.strides.y);\n            let dyC2 = (${a}(dyCorner.y) + 1.0 + ${a}(wC)) / ${a}(uniforms.strides.y);\n            let wCPerm = uniforms.filter_dims[1] - 1 - wC;\n            if (wCPerm < 0) {\n              continue;\n            }\n            var bDyCVal = true;\n            var bDyCVal2 = true;\n            if (dyC < 0.0 || dyC >= ${a}(uniforms.Dy_shape[2]) ||\n                fract(dyC) > 0.0) {\n              bDyCVal = false;\n            }\n            if (dyC2 < 0.0 || dyC2 >= ${a}(uniforms.Dy_shape[2]) ||\n                fract(dyC2) > 0.0) {\n              bDyCVal2 = false;\n            }\n\n            let idyC: u32 = u32(dyC);\n            let idyC2: u32 = u32(dyC2);\n            if (bDyCVal && bDyCVal2) {\n              let d2Length = uniforms.Dy_shape[3];\n              for (var d2 :u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${A.get("batch","idyR","idyC","d2")};\n                let tmpval = vec4<${a}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n\n                xValue =  ${A.get("batch","idyR","idyC2","d2")};\n\n                dotProd[1] = dotProd[1] + vec4<${a}>(dot(xValue, wValue0),\n                                                    dot(xValue, wValue1),\n                                                    dot(xValue, wValue2),\n                                                    dot(xValue, wValue3));\n              }\n            } else if (bDyCVal) {\n              let d2Length = uniforms.Dy_shape[${y}];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${A.get("batch","idyR","idyC","d2")};\n                let tmpval = vec4<${a}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n              }\n            } else if (bDyCVal2) {\n              let d2Length = uniforms.Dy_shape[3];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${A.get("batch","idyR","idyC2","d2")};\n                let tmpval = vec4<${a}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[1] = dotProd[1] + tmpval;\n              }\n            }\n          }\n        }\n\n        for (var i: u32 = 0; i < ${w}; i = i + 1) {\n          let value = dotProd[i] + ${o?"bias[c+i]":`vec4<${a}>(0.0)`};\n          ${x.set("batch","r","c + i","d1","value")};\n        }\n      }`,P=`\n          let outputIndices = ${x.offsetToIndices("global_idx")};\n          let batch = ${x.indicesGet("outputIndices",0)};\n          let d1 = ${x.indicesGet("outputIndices",y)};\n          let r = ${x.indicesGet("outputIndices",h)};\n          let c = ${x.indicesGet("outputIndices",d)};\n          let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;\n          let dyRCorner = dyCorner.x;\n          let dyCCorner = dyCorner.y;\n          let groupId = d1 / uniforms.output_channels_per_group;\n          let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;\n          // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n          // ? = to be determined. : = across all values in that axis.\n          var dotProd = ${a}(0.0);\n          for (var wR: u32 = 0; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {\n            if (wR % uniforms.dilations.x != 0) {\n              continue;\n            }\n            let dyR = (${a}(dyRCorner) + ${a}(wR)) / ${a}(uniforms.strides[0]);\n            let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;\n            if (dyR < 0.0 || dyR >= ${a}(uniforms.Dy_shape[${h}]) || fract(dyR) > 0.0 ||\n                wRPerm < 0) {\n              continue;\n            }\n            let idyR: u32 = u32(dyR);\n\n            for (var wC: u32 = 0; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {\n              if (wC % uniforms.dilations.y != 0) {\n                continue;\n              }\n              let dyC = (${a}(dyCCorner) + ${a}(wC)) / ${a}(uniforms.strides.y);\n              let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;\n              if (dyC < 0.0 || dyC >= ${a}(uniforms.Dy_shape[${d}]) ||\n                  fract(dyC) > 0.0 || wCPerm < 0) {\n                continue;\n              }\n              let idyC: u32 = u32(dyC);\n              var inputChannel = groupId * uniforms.input_channels_per_group;\n              for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group; d2 = d2 + 1) {\n                let xValue = ${p?A.get("batch","idyR","idyC","inputChannel"):A.get("batch","inputChannel","idyR","idyC")};\n                let wValue = ${S.get("inputChannel","wOutChannel","u32(wRPerm)","u32(wCPerm)")};\n                dotProd = dotProd + xValue * wValue;\n                inputChannel = inputChannel + 1;\n              }\n            }\n          }\n          let value = dotProd + ${o?"bias[d1]":`${a}(0.0)`};\n          ${x.setByOffset("global_idx","value")};\n        `;return`\n  ${e.registerUniforms(c).declareVariables(...I,x)}\n  ${_}\n\n    ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")};\n  ${u?E:P}}`},Lo=(e,t,r)=>{let o=e.length>2,i=t.outputShape,u=M.size(i),a=[Math.ceil(u/64),1,1];Ve("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${a}`);let c=t.format==="NHWC",p=["rank","rank"],h=[t.strides[0],t.strides[1]],d=[t.kernelShape[c?1:2],t.kernelShape[c?2:3]],y=[t.dilations[0],t.dilations[1]],w=[d[0]+(t.dilations[0]<=1?0:(t.kernelShape[c?1:2]-1)*(t.dilations[0]-1)),d[1]+(t.dilations[1]<=1?0:(t.kernelShape[c?2:3]-1)*(t.dilations[1]-1))],_=[w[0]-1-Math.floor((t.pads[0]+t.pads[2])/2),w[1]-1-Math.floor(t.pads[1]+t.pads[3])/2],v=!1,S=t.group,A=e[1].dims,I=A[0]/S,x=A[1],E=[{type:12,data:u},{type:12,data:h},{type:12,data:d},{type:12,data:y},{type:12,data:w},{type:6,data:_},{type:12,data:I},{type:12,data:x},...Z(e[0].dims,e[1].dims)];o&&(E.push(...Z(e[2].dims)),p.push("rank")),E.push(...Z(i));let P=a[1]===1&&a[2]===1,O=R=>{let L=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:h.length},{name:"filter_dims",type:"u32",length:d.length},{name:"dilations",type:"u32",length:d.length},{name:"effective_filter_dims",type:"u32",length:w.length},{name:"pads",type:"i32",length:_.length},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],N=De(e[0].dataType);return`${Ic(R,e,i,o,P,v,N,L,c)}`};return{name:"ConvTranspose2D",shaderCache:{hint:`${t.cacheKey};`,inputDependencies:p},getRunData:()=>({dispatchGroup:{x:a[0],y:a[1],z:a[2]},outputs:[{dims:r?r(i):i,dataType:e[0].dataType}],programUniforms:E}),getShaderSource:O}}});var Tc,Ec,Pc,su,uu,kc,Oc,Rc,Bc,du,lu=Y(()=>{"use strict";iu();au();Ft();Sr();Tc=(e,t,r,o,i,u)=>(e-1)*t+r+(o-1)*i+1-u,Ec=(e,t,r,o,i)=>{let u=Math.floor(e/2);t==="SAME_UPPER"?(r[o]=u,r[i]=e-u):t==="SAME_LOWER"&&(r[o]=e-u,r[i]=u)},Pc=(e,t,r,o,i,u,a,c,p,h)=>{let d=e.length-2,y=h.length===0;if(p.length===0)for(let v=0;v<d;++v)p.push(0);let w=e[0],_=t[c?3:1]*i;for(let v=0,S=e.length-d-(c?1:0);v<d;++v,++S){let A=e[S],I=y?A*a[v]:h[v],x=Tc(A,a[v],u[v],t[S],r[v],I);Ec(x,o,u,v,v+d),y&&h.push(a[v]*(A-1)+p[v]+(t[S]-1)*r[v]+1-u[v]-u[v+d])}h.splice(0,0,w),h.splice(c?3:1,0,_)},su=(e,t)=>{let r=e.kernelShape.slice();if(e.kernelShape.length===0||e.kernelShape.reduce((y,w)=>y*w,1)===0){r.length=0;for(let y=2;y<t[1].dims.length;++y)r.push(t[1].dims[y])}let o=e.format==="NHWC";r.splice(0,0,t[1].dims[0]),r.splice(o?3:1,0,t[1].dims[1]);let i=e.pads.slice(),u=e.outputShape.slice(),a=e.outputPadding.slice(),c=t[0].dims,p=e.dilations.slice();if(p.reduce((y,w)=>y+w,0)===0){let y=t[0].dims.length-2;p=new Array(y).fill(1)}let h=e.strides.slice();if(h.reduce((y,w)=>y+w,0)===0){let y=t[0].dims.length-2;h=new Array(y).fill(1)}Pc(c,r,p,e.autoPad,e.group,i,h,o,a,u);let d=Object.assign({},e);return Object.assign(d,{kernelShape:r,pads:i,outputPadding:a,outputShape:u,dilations:p,strides:h}),d},uu=e=>{let t=Bn(e),r=e.format,o=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],i=e.dilations,u=e.group,a=e.kernelShape,c=e.pads,p=e.strides,h=e.wIsConst(),d=e.outputPadding,y=e.outputShape;return{autoPad:o,format:r,dilations:i,group:u,kernelShape:a,outputPadding:d,outputShape:y,pads:c,strides:p,wIsConst:h,...t,cacheKey:`${e.format};${t.activation};`}},kc=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],o=e[1].dims[0];if(r!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let i=e[1].dims[1]*t.group;if(e.length===3&&(e[2].dims.length!==1||e[2].dims[0]!==i))throw new Error("invalid bias");let u=e[0].dims.length-2;if(t.dilations.reduce((d,y)=>d+y,0)>0&&t.dilations.length!==u)throw new Error(`dilations should be ${u}D`);if(t.strides.reduce((d,y)=>d+y,0)>0&&t.strides.length!==u)throw new Error(`strides should be ${u}D`);if(t.pads.reduce((d,y)=>d+y,0)>0&&t.pads.length!==u*2)throw new Error(`pads should be ${u*2}D`);if(t.outputPadding.length!==u&&t.outputPadding.length!==0)throw new Error(`output_padding should be ${u}D`);if(t.kernelShape.reduce((d,y)=>d+y,0)>0&&t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(t.outputShape.length!==0&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},Oc=[2,3,1,0],Rc=(e,t,r)=>{let o=su(r,t),i=r.format==="NHWC",u=o.outputShape,a=u[i?3:1],c=t[0].dims[i?3:1];if(o.group!==1||a===1&&c===1){e.compute(Lo(t,o));return}let p=u[i?1:2],h=u[i?2:3],d=t[1].dims[2],y=t[1].dims[3],w=i?p*h:a,_=i?a:p*h,v=d*y*c,S=!0,A=e.kernelCustomData.wT??e.compute(yt(t[1],Oc),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=A);let I=[t[0],A],x=t.length===3;x&&(!i&&t[2].dims.length===1?I.push(t[2].reshape([t[2].dims[0],1,1])):I.push(t[2])),e.compute(ou(I,o,u,w,_,v,x,S),{inputs:I})},Bc=(e,t)=>{let r=t.format==="NHWC",o=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&o.push(e.inputs[2]);let i=t.kernelShape;(i.length===0||i[0]===0)&&(i=[e.inputs[1].dims[2]]);let u=t.dilations;(u.length===0||u[0]===0)&&(u=[1]);let a=t.strides;(a.length===0||a[0]===0)&&(a=[1]);let c=t.pads;c.length===0&&(c=[0,0]),c=[0,c[0],0,c[1]],a=[1].concat(a),u=[1].concat(u),i=[1].concat(i);let p=su({...t,pads:c,strides:a,dilations:u,kernelShape:i},o);e.compute(Lo(o,p,h=>r?[h[0],h[2],h[3]]:[h[0],h[1],h[3]]))},du=(e,t)=>{kc(e.inputs,t),e.inputs[0].dims.length===3?Bc(e,t):Rc(e,e.inputs,t)}});var Dc,cu,pu,mu=Y(()=>{"use strict";ye();Se();Ze();_e();Dc=(e,t,r,o)=>{let i=M.size(t),u=t.length,a=U("input",e,u),c=j("output",e,u),p=r.dataType===6?r.getInt32Array()[0]:Number(r.getBigInt64Array()[0]),h=M.normalizeAxis(p,u),d=y=>{let w=` i32(${a.indicesGet("inputIndices","uniforms.axis")}) `,_=fe("uniforms.input_shape","uniforms.axis",u),v=o.reverse?w+(o.exclusive?" + 1":""):"0",S=o.reverse?_:w+(o.exclusive?"":" + 1");return`\n                ${y.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(a,c)}\n                ${y.mainStart()}\n                  ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n                  var inputIndices = ${c.offsetToIndices("global_idx")};\n                  var sum = ${c.type.value}(0);\n                  let first : i32 = ${v};\n                  let last : i32 = ${S};\n                  for (var i : i32 = first; i < last; i++) {\n                    ${a.indicesSet("inputIndices","uniforms.axis","u32(i)")};\n                    sum = sum + ${a.getByIndices("inputIndices")};\n                  }\n                  ${c.setByOffset("global_idx","sum")};\n                }`};return{name:"CumSum",shaderCache:{hint:o.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:12,data:i},{type:12,data:h},...Z(t,t)]}),getShaderSource:d}},cu=(e,t)=>{let r=e.inputs[0].dims,o=e.inputs[0].dataType,i=e.inputs[1];e.compute(Dc(o,r,i,t),{inputs:[0]})},pu=e=>{let t=e.exclusive===1,r=e.reverse===1;return ve({exclusive:t,reverse:r})}});var zc,Mc,Uc,fu,hu,gu=Y(()=>{"use strict";ye();Se();Ze();_e();zc=e=>{if(!e||e.length!==1)throw new Error("DepthToSpace requires 1 input.");if(e[0].dims.length!==4)throw new Error("DepthToSpace requires 4D input.")},Mc=(e,t,r,o)=>{let i=[];i.push(`fn perm(i: ${o.type.indices}) -> ${r.type.indices} {\n    var a: ${r.type.indices};`);for(let u=0;u<t;++u)i.push(r.indicesSet("a",e[u],`i[${u}]`));return i.push("return a;}"),i.join(`\n`)},Uc=(e,t)=>{let r,o,i,u,a,c,p=t.format==="NHWC",h=t.blocksize,d=t.mode==="DCR";p?([r,o,i,u]=e.dims,a=d?[r,o,i,h,h,u/h**2]:[r,o,i,u/h**2,h,h],c=d?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([r,o,i,u]=[e.dims[0],e.dims[2],e.dims[3],e.dims[1]],a=d?[r,h,h,u/h**2,o,i]:[r,u/h**2,h,h,o,i],c=d?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let y=e.reshape(a),w=y.dims.length,_=e.dataType,v=U("a",_,w),S=j("output",_,w),A=I=>`\n  ${I.registerUniform("output_size","u32").declareVariables(v,S)}\n\n  ${Mc(c,w,v,S)}\n\n  ${I.mainStart()}\n    ${I.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let indices = ${S.offsetToIndices("global_idx")};\n    let aIndices = perm(indices);\n\n    ${S.setByOffset("global_idx",v.getByIndices("aIndices"))}\n  }`;return{name:"DepthToSpace",shaderCache:{hint:`${e.dims};${t.blocksize};${t.mode}`,inputDependencies:["rank"]},getRunData:I=>{let x=p?[r,o*h,i*h,u/h**2]:[r,u/h**2,o*h,i*h],E=M.size(x),P=y.dims,O=M.sortBasedOnPerm(P,c);return{outputs:[{dims:x,dataType:I[0].dataType}],dispatchGroup:{x:Math.ceil(E/64)},programUniforms:[{type:12,data:E},...Z(P,O)]}},getShaderSource:A}},fu=(e,t)=>{zc(e.inputs),e.compute(Uc(e.inputs[0],t))},hu=e=>ve({blocksize:e.blocksize,mode:e.mode,format:e.format})});var Fo,Wn,yu,Vc,Wc,qo,jo,bu,Nc,wu,vu,$u=Y(()=>{"use strict";ye();Se();Ze();_e();Fo="[a-zA-Z]|\\\\.\\\\.\\\\.",Wn="("+Fo+")+",yu="^"+Wn+"$",Vc="("+Wn+",)*"+Wn,Wc="^"+Vc+"$",qo=class{constructor(t=-1){this.symbolToIndices=new Map,this.inputIndex=t}addSymbol(t,r){let o=this.symbolToIndices.get(t);o===void 0?o=[r]:o.push(r),this.symbolToIndices.set(t,o)}},jo=class{constructor(t,r){this.equation=r;this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[o,i]=r.includes("->")?r.split("->",2):[r,""];if(!o.match(RegExp(Wc)))throw new Error("Invalid LHS term");if(o.split(",").forEach((c,p)=>{let h=t[p].dims.slice();if(!c.match(RegExp(yu)))throw new Error("Invalid LHS term");let d=this.processTerm(c,!0,h,p);this.lhs.push(d)}),i==="")i+=[...this.symbolToInfo.entries()].filter(([c,p])=>p.count===1||c==="...").map(([c])=>c).join("");else if(!i.match(RegExp(Wn)))throw new Error("Invalid RHS");i.match(RegExp(Fo,"g"))?.forEach(c=>{if(c==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let p=this.symbolToInfo.get(c);if(p===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(p.dimValue)}}),this.rhs=this.processTerm(i,!1,this.outputDims)}addSymbol(t,r,o){let i=this.symbolToInfo.get(t);if(i!==void 0){if(i.dimValue!==r&&i.count!==1)throw new Error("Dimension mismatch");i.count++,i.inputIndices.push(o)}else i={count:1,dimValue:r,inputIndices:[o]};this.symbolToInfo.set(t,i)}processTerm(t,r,o,i=-1){let u=o.length,a=!1,c=[],p=0;if(!t.match(RegExp(yu))&&!r&&t!=="")throw new Error("Invalid LHS term");let h=t.match(RegExp(Fo,"g")),d=new qo(i);return h?.forEach((y,w)=>{if(y==="..."){if(a)throw new Error("Only one ellipsis is allowed per input term");a=!0;let _=u-h.length+1;if(_<0)throw new Error("Ellipsis out of bounds");if(c=o.slice(p,p+_),this.hasEllipsis){if(this.ellipsisDims.length!==c.length||this.ellipsisDims.toString()!==c.toString())throw new Error("Ellipsis dimensions mismatch")}else if(r)this.hasEllipsis=!0,this.ellipsisDims=c;else throw new Error("Ellipsis must be specified in the LHS");for(let v=0;v<c.length;v++){let S=String.fromCharCode("0".charCodeAt(0)+v);d.addSymbol(S,w+v),this.addSymbol(S,o[p++],i)}}else d.addSymbol(y,w+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(y,o[p++],i)}),d}},bu=e=>e+"_max",Nc=(e,t,r,o)=>{let u=e.map(d=>d.length).map((d,y)=>U(`input${y}`,t,d)),a=M.size(o),c=j("output",t,o.length),p=[...r.symbolToInfo.keys()].filter(d=>!r.rhs.symbolToIndices.has(d)),h=d=>{let y=[],w="var prod = 1.0;",_="var sum = 0.0;",v="sum += prod;",S=[],A=[],I=[],x=[],E=r.symbolToInfo.size===r.rhs.symbolToIndices.size;r.symbolToInfo.forEach((O,R)=>{if(r.rhs.symbolToIndices.has(R)){let L=r.rhs.symbolToIndices.get(R)?.[0];L!==void 0&&r.lhs.forEach((N,K)=>{if(O.inputIndices.includes(K)){let Q=N.symbolToIndices.get(R);if(Q===void 0)throw new Error("Invalid symbol error");Q.forEach(he=>{y.push(`${u[K].indicesSet(`input${K}Indices`,he,c.indicesGet("outputIndices",L))}`)})}})}else r.lhs.forEach((L,N)=>{if(O.inputIndices.includes(N)){let K=L.symbolToIndices.get(R);if(K===void 0)throw new Error("Invalid symbol error");K.forEach(Q=>{S.push(`${u[N].indicesSet(`input${N}Indices`,Q,`${R}`)}`)}),x.push(`prod *= ${u[N].getByIndices(`input${N}Indices`)};`)}}),A.push(`for(var ${R}: u32 = 0; ${R} < uniforms.${bu(R)}; ${R}++) {`),I.push("}")});let P=E?[...y,`let sum = ${u.map((O,R)=>O.getByIndices(`input${R}Indices`)).join(" * ")};`]:[...y,_,...A,...S,w,...x,v,...I];return`\n            ${d.registerUniforms(p.map(O=>({name:`${bu(O)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...u,c)}\n\n            ${d.mainStart()}\n            ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n            var outputIndices = ${c.offsetToIndices("global_idx")};\n            ${u.map((O,R)=>`var input${R}Indices: ${u[R].type.indices};`).join(`\n`)}\n            ${P.join(`\n`)};\n            ${c.setByOffset("global_idx","sum")};\n          }`};return{name:"Einsum",shaderCache:{hint:r.equation,inputDependencies:e.map(()=>"rank")},getRunData:()=>{let d=p.filter(w=>r.symbolToInfo.has(w)).map(w=>({type:12,data:r.symbolToInfo.get(w)?.dimValue||0}));d.push({type:12,data:a});let y=e.map((w,_)=>[...Z(w)]).reduce((w,_)=>w.concat(_),d);return y.push(...Z(o)),{outputs:[{dims:o,dataType:t}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:y}},getShaderSource:h}},wu=(e,t)=>{let r=new jo(e.inputs,t.equation),o=r.outputDims,i=e.inputs.map((u,a)=>u.dims);e.compute(Nc(i,e.inputs[0].dataType,r,o))},vu=e=>{let t=e.equation.replace(/\\s+/g,"");return ve({equation:t})}});var Gc,_u,Hc,Lc,Su,xu=Y(()=>{"use strict";ye();Se();_e();Gc=e=>{if(!e||e.length!==2)throw new Error("Expand requires 2 input.");let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),o=r.length<t.length?0:r.length-t.length,i=t.length<r.length?0:t.length-r.length;for(;o<r.length&&i<t.length;++o,++i)if(r[o]!==t[i]&&r[o]!==1&&t[i]!==1)throw new Error("Expand requires shape to be broadcastable to input")},_u=(e,t)=>{let r=e.length-t.length,o=[];for(let i=0;i<r;++i)o.push(e[i]);for(let i=0;i<t.length;++i)o.push(t[i]===1?e[i+r]:t[i]);return o},Hc=(e,t)=>e.length>t.length?_u(e,t):_u(t,e),Lc=e=>{let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),o=Hc(t,r),i=e[0].dataType,u=i===9?4:1,a=Math.ceil(M.size(o)/u),c=h=>{let d=U("input",i,t.length,u),y=j("output",i,o.length,u),w;if(i===9){let _=(v,S,A="")=>`\n          let outputIndices${S} = ${y.offsetToIndices(`outputOffset + ${S}u`)};\n          let offset${S} = ${d.broadcastedIndicesToOffset(`outputIndices${S}`,y)};\n          let index${S} = offset${S} / 4u;\n          let component${S} = offset${S} % 4u;\n          ${v}[${S}] = ${A}(${d.getByOffset(`index${S}`)}[component${S}]);\n        `;w=`\n        let outputOffset = global_idx * ${u};\n        var data = vec4<u32>(0);\n        ${_("data",0,"u32")}\n        ${_("data",1,"u32")}\n        ${_("data",2,"u32")}\n        ${_("data",3,"u32")}\n        ${y.setByOffset("global_idx","data")}\n      }`}else w=`\n        let outputIndices = ${y.offsetToIndices("global_idx")};\n        let inputOffset = ${d.broadcastedIndicesToOffset("outputIndices",y)};\n        ${y.setByOffset("global_idx",d.getByOffset("inputOffset"))}\n      }`;return`\n    ${h.registerUniform("vec_size","u32").declareVariables(d,y)}\n    ${h.mainStart()}\n    ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n    ${w}`},p=[{type:12,data:a},...Z(t,o)];return{name:"Expand",shaderCache:{hint:`${o.length}`,inputDependencies:["rank"]},getShaderSource:c,getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:p})}},Su=e=>{Gc(e.inputs),e.compute(Lc(e.inputs),{inputs:[0]})}});var Fc,Cu,Au=Y(()=>{"use strict";ye();Se();_e();Rn();Fc=e=>{let t=e[0].dataType,r=M.size(e[0].dims),o=M.size(e[1].dims),i=o%4===0,u=a=>{let c=U("x",t,[1],4),p=U("bias",t,[1],4),h=j("y",t,[1],4),d=[{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}],y=_=>`\n      let bias${_}_offset: u32 = (global_idx * 4 + ${_}) % uniforms.bias_size;\n      let bias${_} = ${p.getByOffset(`bias${_}_offset / 4`)}[bias${_}_offset % 4];`,w=i?`\n      let bias = ${p.getByOffset("global_idx % (uniforms.bias_size / 4)")};`:`${y(0)}${y(1)}${y(2)}${y(3)}\n      let bias = ${c.type.value}(bias0, bias1, bias2, bias3);`;return`${a.registerUniforms(d).declareVariables(c,p,h)}\n\n    ${Bo(et(t))}\n\n    ${a.mainStart(or)}\n      ${a.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size")}\n\n      let x = ${c.getByOffset("global_idx")};\n      ${w}\n      let x_in = x + bias;\n      ${h.setByOffset("global_idx",Do("x_in"))}\n    }`};return{name:"FastGeluWithBias",shaderCache:{hint:`${i}`,inputDependencies:["type","type"]},getShaderSource:u,getRunData:a=>({outputs:[{dims:a[0].dims,dataType:a[0].dataType}],programUniforms:[{type:12,data:Math.ceil(r/4)},{type:12,data:o}],dispatchGroup:{x:Math.ceil(r/or/4)}})}},Cu=e=>{e.inputs.length<2||M.size(e.inputs[1].dims)===0?Bs(e):e.compute(Fc(e.inputs))}});var qc,jc,Iu,Tu,Eu=Y(()=>{"use strict";ye();Se();Ze();_e();qc=e=>{if(!e||e.length!==2)throw new Error("Gather requires 2 inputs.")},jc=(e,t)=>{let r=e[0].dims,o=e[1].dims,i=r.length,u=M.normalizeAxis(t.axis,i),a=r.slice(0);a.splice(u,1,...o);let c=r[u],p=e[0].dataType===9?4:1,h=Math.ceil(M.size(a)/p),d=[{type:12,data:h},{type:6,data:c},{type:12,data:u},...Z(e[0].dims,e[1].dims,a)],y=w=>{let _=U("data",e[0].dataType,e[0].dims.length,p),v=U("inputIndices",e[1].dataType,e[1].dims.length),S=j("output",e[0].dataType,a.length,p),A=x=>{let E=o.length,P=`var indicesIndices${x}  = ${v.type.indices}(0);`;for(let O=0;O<E;O++)P+=`${E>1?`indicesIndices${x}[${O}]`:`indicesIndices${x}`} = ${a.length>1?`outputIndices${x}[uniforms.axis + ${O}]`:`outputIndices${x}`};`;P+=`\n          var idx${x} = ${v.getByIndices(`indicesIndices${x}`)};\n          if (idx${x} < 0) {\n            idx${x} = idx${x} + uniforms.axisDimLimit;\n          }\n          var dataIndices${x} : ${_.type.indices};\n        `;for(let O=0,R=0;O<i;O++)O===u?(P+=`${i>1?`dataIndices${x}[${O}]`:`dataIndices${x}`} = u32(idx${x});`,R+=E):(P+=`${i>1?`dataIndices${x}[${O}]`:`dataIndices${x}`} = ${a.length>1?`outputIndices${x}[${R}]`:`outputIndices${x}`};`,R++);return P},I;if(e[0].dataType===9){let x=(E,P,O="")=>`\n          let outputIndices${P} = ${S.offsetToIndices(`outputOffset + ${P}u`)};\n          ${A(P)};\n          let offset${P} = ${_.indicesToOffset(`dataIndices${P}`)};\n          let index${P} = offset${P} / 4u;\n          let component${P} = offset${P} % 4u;\n          ${E}[${P}] = ${O}(${_.getByOffset(`index${P}`)}[component${P}]);\n        `;I=`\n        let outputOffset = global_idx * ${p};\n        var value = vec4<u32>(0);\n        ${x("value",0,"u32")}\n        ${x("value",1,"u32")}\n        ${x("value",2,"u32")}\n        ${x("value",3,"u32")}\n        ${S.setByOffset("global_idx","value")}\n      `}else I=`\n      let outputIndices = ${S.offsetToIndices("global_idx")};\n      ${A("")};\n      let value = ${_.getByIndices("dataIndices")};\n      ${S.setByOffset("global_idx","value")};\n      `;return`\n      ${w.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(_,v,S)}\n      ${w.mainStart()}\n        ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n        ${I}\n      }`};return{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:d}),getShaderSource:y}},Iu=e=>ve({axis:e.axis}),Tu=(e,t)=>{let r=e.inputs;qc(r),e.compute(jc(e.inputs,t))}});var Kc,Yc,Pu,ku,Ou=Y(()=>{"use strict";ye();Se();Ze();_e();Kc=e=>{if(!e||e.length!==2)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error(`GatherElements requires that the data input and\n                     indices input tensors be of same rank.`)},Yc=(e,t)=>{let r=e[0].dims,o=e[0].dataType,i=r.length,u=e[1].dims,a=e[1].dataType,c=M.normalizeAxis(t.axis,i),p=r[c],h=u.slice(0),d=M.size(h),y=U("input",o,i),w=U("indicesInput",a,u.length),_=j("output",o,h.length),v=[{type:12,data:d},{type:6,data:p},{type:12,data:c}];return v.push(...Z(r,u,h)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:h,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:v}),getShaderSource:I=>`\n      ${I.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(y,w,_)}\n      ${I.mainStart()}\n      ${I.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n      let outputIndices = ${_.offsetToIndices("global_idx")};\n\n      var idx = ${w.getByOffset("global_idx")};\n      if (idx < 0) {\n        idx = idx + uniforms.axisDimLimit;\n      }\n      var inputIndices = ${y.type.indices}(outputIndices);\n      ${y.indicesSet("inputIndices","uniforms.axis","u32(idx)")};\n      let value = ${y.getByIndices("inputIndices")};\n\n      ${_.setByOffset("global_idx","value")};\n  }`}},Pu=e=>ve({axis:e.axis}),ku=(e,t)=>{let r=e.inputs;Kc(r),e.compute(Yc(e.inputs,t))}});var Zc,Xc,Ru,Bu,Du=Y(()=>{"use strict";ye();Se();_e();Zc=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(e.length===3&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},Xc=(e,t)=>{let r=e[0].dims.slice(),o=e[1].dims.slice(),[i,u,a]=Sn.getShapeOfGemmResult(r,t.transA,o,t.transB,e.length===3?e[2].dims:void 0),c=[i,u];if(!c)throw new Error("Can\'t use gemm on the given tensors");let p=M.size(c),h=[{type:12,data:p},{type:12,data:i},{type:12,data:u},{type:12,data:a},{type:1,data:t.alpha},{type:1,data:t.beta}],d=["type","type"];e.length===3&&(h.push(...Z(e[2].dims)),d.push("rank")),h.push(...Z(c));let y=w=>{let _="";t.transA&&t.transB?_="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":t.transA&&!t.transB?_="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!t.transA&&t.transB?_="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!t.transA&&!t.transB&&(_="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let v=t.alpha===1?"":"value *= uniforms.alpha;",S=U("a",e[0].dataType,e[0].dims),A=U("b",e[1].dataType,e[1].dims),I=S.type.value,x=null,E=[S,A];e.length===3&&(x=U("c",e[2].dataType,e[2].dims.length),E.push(x));let P=j("output",e[0].dataType,c.length);E.push(P);let O=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`\n  ${w.registerUniforms(O).declareVariables(...E)}\n\n  ${w.mainStart()}\n    ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let m = global_idx / uniforms.N;\n    let n = global_idx % uniforms.N;\n\n    var value = ${I}(0);\n    for (var k: u32 = 0u; k < uniforms.K; k++) {\n      ${_}\n    }\n\n    ${v}\n    ${(()=>x!=null?`let cOffset = ${x.broadcastedIndicesToOffset("vec2(m, n)",P)}; value += ${I}(uniforms.beta) * ${x.getByOffset("cOffset")};`:"")()}\n    output[global_idx] = value;\n  }`};return{name:"Gemm",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:d},getRunData:()=>({outputs:[{dims:c,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:h}),getShaderSource:y}},Ru=e=>{let t=e.transA,r=e.transB,o=e.alpha,i=e.beta;return{transA:t,transB:r,alpha:o,beta:i,cacheKey:`${e.transA};${e.transB};${e.alpha===1}`}},Bu=(e,t)=>{Zc(e.inputs),e.compute(Xc(e.inputs,t))}});var Qc,Jc,ep,zu,Mu=Y(()=>{"use strict";ye();Se();_e();Qc=(e,t)=>{let r=e[0].dims,o=r,i=2,u=M.sizeToDimension(r,i),a=M.sizeFromDimension(r,i),c=Me(a),p=a/c,h=[r[0],r[1],p],d=["rank","type","type"],y=[{type:12,data:a},{type:12,data:p}];y.push(...Z(h,h));let w=_=>{let v=U("x",e[0].dataType,h.length,c),S=U("scale",e[1].dataType,e[1].dims),A=U("bias",e[2].dataType,e[2].dims),I=j("output",e[0].dataType,h.length,c),x=[v,S,A,I],E=v.type.value,P=c===1?"f32":`vec${c}<f32>`,O=64,R=[{name:"normSize",type:"u32"},{name:"normPackedSize",type:"u32"}];return`\n  var<workgroup> meanShared : f32;\n  var<workgroup> squaredNormShared : f32;\n  var<workgroup> workgroupShared : array<${P}, ${O}>;\n  const workgroupSize = ${O}u;\n  ${_.registerUniforms(R).declareVariables(...x)}\n  ${_.mainStart(O)}\n    let norm = global_idx / workgroupSize;\n    let batch = norm / uniforms.x_shape[1];\n    let channel = norm % uniforms.x_shape[1];\n    let localIndex = local_id.x;\n\n    // initialize workgroup memory\n    var initial = ${P}(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      initial = initial + ${P}(${v.get("batch","channel","h")});\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the mean of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      meanShared = ${_t("workgroupShared[0]",c)} / f32(uniforms.normSize);\n    }\n    workgroupBarrier();\n\n    // reinitialize workgroup memory.\n    initial = ${P}(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let deviation =  ${P}(${v.get("batch","channel","h")}) - ${P}(meanShared);\n      initial = initial + deviation * deviation;\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the sum of square of deviation of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      squaredNormShared = ${_t("workgroupShared[0]",c)};\n    }\n    workgroupBarrier();\n\n    let invStdDev = inverseSqrt(squaredNormShared / f32(uniforms.normSize) + f32(${t.epsilon}));\n    let channelScale = invStdDev * f32(${S.getByOffset("channel")});\n    let channelShift = f32(${A.getByOffset("channel")}) - meanShared * channelScale;\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let value = ${v.get("batch","channel","h")} * ${E}(${P}(channelScale)) + ${E}(${P}(channelShift));\n      ${I.set("batch","channel","h","value")};\n    }\n  }`};return{name:"InstanceNormalization",shaderCache:{hint:`${t.epsilon};${c}`,inputDependencies:d},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:u},programUniforms:y}),getShaderSource:w}},Jc=(e,t,r,o,i,u,a,c)=>{let p=Me(a),h=64,d=p===1?"vec2f":`mat2x${p}f`,y=p===1?"f32":`vec${p}f`,w=(R,L)=>`${d}(${R}, ${L})`,_=i*a/p,v=Math.ceil(u/h),S=["type"],A=[{type:12,data:v},{type:12,data:u},{type:12,data:Math.floor(a/p)},{type:12,data:Math.floor(u*a/p)}],I=R=>{let L=U("input",t.dataType,t.dims,p);return`\n  ${R.declareVariables(L)}\n  @group(0) @binding(1) var<storage, read_write> output : array<${d}>;\n  struct Uniforms {wg_size:u32, H:u32, C:u32, image_size:u32};\n  @group(0) @binding(2) var<uniform> uniforms: Uniforms;\n\n  ${R.mainStart(h)}\n    let currentImageNumber = global_idx / ${h} / uniforms.C;\n    let currentChannelNumber = (global_idx / ${h}) % uniforms.C;\n    let wgOffset = local_id.x * uniforms.wg_size;\n    if (wgOffset >= uniforms.H) {\n        return;\n    }\n    let wgMax = min(wgOffset + uniforms.wg_size, uniforms.H);\n\n    let offset = currentImageNumber * uniforms.image_size + currentChannelNumber;\n    var sum = ${$t("f32",p)};\n    var squaredSum = ${$t("f32",p)};\n    for (var i: u32 = wgOffset; i < wgMax; i++) {\n        let value = ${y}(input[offset + i * uniforms.C]);\n        sum += value;\n        squaredSum += value * value;\n    }\n    output[global_idx] = ${w("sum","squaredSum")};\n  }`},x=e.compute({name:"InstanceNormComputeMean",shaderCache:{hint:`${p}`,inputDependencies:S},getRunData:()=>({outputs:[{dims:[i,a,h,2],dataType:1}],dispatchGroup:{x:i*a/p},programUniforms:A}),getShaderSource:I},{inputs:[t],outputs:[-1]})[0],E=[{type:12,data:_},{type:12,data:u},{type:12,data:Math.floor(a/p)},{type:12,data:Math.floor(h*a/p)}],P=["type","type","type"],O=R=>{let L=U("scale",r.dataType,r.dims,p),N=U("bias",o.dataType,o.dims,p);return`\n  @group(0) @binding(0) var<storage, read> input : array<${d}>;\n  @group(0) @binding(1) var<storage, read> scale : array<${L.type.storage}>;\n  @group(0) @binding(2) var<storage, read> bias : array<${N.type.storage}>;\n  @group(0) @binding(3) var<storage, read_write> output : array<${d}>;\n  struct Uniforms {units_of_work : u32, H: u32, C : u32, image_size : u32};\n  @group(0) @binding(4) var<uniform> uniforms: Uniforms;\n\n  ${R.mainStart()}\n    ${R.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.units_of_work")}\n    let currentImageNumber = global_idx / uniforms.C;\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let offset = currentImageNumber * uniforms.image_size;\n    var sum = ${$t("f32",p)};\n    var squaredSum = ${$t("f32",p)};\n    for (var i: u32 = 0; i < min(${h}, uniforms.H); i++) {\n        let value = input[offset + i + currentChannelNumber * ${h}];\n        sum += value[0];\n        squaredSum += value[1];\n    }\n    sum = sum / f32(uniforms.H);\n    squaredSum = squaredSum / f32(uniforms.H);\n    let invStdDev = inverseSqrt(squaredSum - sum * sum + f32(${c}));\n    let channelScale = invStdDev * ${y}(scale[currentChannelNumber]);\n    let channelShift = ${y}(bias[currentChannelNumber]) - sum * channelScale;\n\n    output[global_idx] = ${w("channelScale","channelShift")};\n  }`};return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${p};${c}`,inputDependencies:P},getRunData:()=>({outputs:[{dims:[i,a,2],dataType:1}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:E}),getShaderSource:O},{inputs:[x,r,o],outputs:[-1]})[0]},ep=(e,t,r)=>{let o=t[0].dims,i=o,u=o[0],a=o[o.length-1],c=M.sizeFromDimension(o,1)/a,p=Me(a),h=M.size(i)/p,d=[{type:12,data:c},{type:12,data:Math.floor(a/p)}],y=["type","type"],w=Jc(e,t[0],t[1],t[2],u,c,a,r.epsilon),_=v=>{let S=De(t[0].dataType),A=p===1?"vec2f":`mat2x${p}f`,I=p===1?S:`vec${p}<${S}>`,x=U("input",t[0].dataType,t[0].dims,p),E=j("output",t[0].dataType,i,p);return`\n  @group(0) @binding(0) var<storage, read> input : array<${x.type.storage}>;\n  @group(0) @binding(1) var<storage, read> scaleInput : array<${A}>;\n  @group(0) @binding(2) var<storage, read_write> output : array<${E.type.storage}>;\n  struct Uniforms {H: u32, C : u32};\n  @group(0) @binding(3) var<uniform> uniforms: Uniforms;\n\n  ${v.mainStart()}\n    let currentImageNumber = global_idx / (uniforms.C * uniforms.H);\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let scaleOffset = currentImageNumber * uniforms.C + currentChannelNumber;\n    let scale = scaleInput[scaleOffset];\n    output[global_idx] = fma(input[global_idx], ${I}(scale[0]), ${I}(scale[1]));\n  }`};e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${p}`,inputDependencies:y},getRunData:()=>({outputs:[{dims:i,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:d}),getShaderSource:_},{inputs:[t[0],w]})},zu=(e,t)=>{t.format==="NHWC"?ep(e,e.inputs,t):e.compute(Qc(e.inputs,t))}});var tp,rp,Uu,Vu=Y(()=>{"use strict";ye();Se();_e();tp=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},rp=(e,t,r)=>{let o=t.simplified,i=e[0].dims,u=e[1],a=!o&&e[2],c=i,p=M.normalizeAxis(t.axis,i.length),h=M.sizeToDimension(i,p),d=M.sizeFromDimension(i,p),y=M.size(u.dims),w=a?M.size(a.dims):0;if(y!==d||a&&w!==d)throw new Error(`Size of X.shape()[axis:] == ${d}.\n       Size of scale and bias (if provided) must match this.\n       Got scale size of ${y} and bias size of ${w}`);let _=[];for(let O=0;O<i.length;++O)O<p?_.push(i[O]):_.push(1);let v=Me(d),S=["type","type"],A=[{type:12,data:h},{type:1,data:d},{type:12,data:Math.floor(d/v)},{type:1,data:t.epsilon}];a&&S.push("type");let I=r>1,x=r>2,E=O=>{let R=De(e[0].dataType),L=[U("x",e[0].dataType,e[0].dims,v),U("scale",u.dataType,u.dims,v)];a&&L.push(U("bias",a.dataType,a.dims,v)),L.push(j("output",e[0].dataType,c,v)),I&&L.push(j("mean_data_output",1,_)),x&&L.push(j("inv_std_output",1,_));let N=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`\n  ${O.registerUniforms(N).declareVariables(...L)}\n  ${O.mainStart()}\n    ${O.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}\n    let offset = global_idx * uniforms.norm_size_vectorized;\n    var mean_vector = ${$t("f32",v)};\n    var mean_square_vector = ${$t("f32",v)};\n\n    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {\n      let value = ${ir(R,v,"x[h + offset]")};\n      mean_vector += value;\n      mean_square_vector += value * value;\n    }\n    let mean = ${_t("mean_vector",v)} / uniforms.norm_size;\n    let inv_std_dev = inverseSqrt(${_t("mean_square_vector",v)} / uniforms.norm_size ${o?"":"- mean * mean"} + uniforms.epsilon);\n\n    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {\n      let f32input = ${ir(R,v,"x[j + offset]")};\n      let f32scale = ${ir(R,v,"scale[j]")};\n      output[j + offset] = ${L[0].type.value}((f32input ${o?"":"- mean"}) * inv_std_dev * f32scale\n        ${a?`+ ${ir(R,v,"bias[j]")}`:""}\n      );\n    }\n\n    ${I?"mean_data_output[global_idx] = mean":""};\n    ${x?"inv_std_output[global_idx] = inv_std_dev":""};\n  }`},P=[{dims:c,dataType:e[0].dataType}];return I&&P.push({dims:_,dataType:1}),x&&P.push({dims:_,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${v};${r};${o}`,inputDependencies:S},getRunData:()=>({outputs:P,dispatchGroup:{x:Math.ceil(h/64)},programUniforms:A}),getShaderSource:E}},Uu=(e,t)=>{tp(e.inputs),e.compute(rp(e.inputs,t,e.outputCount))}});var np,op,Wu,Nu,Gu=Y(()=>{"use strict";ye();Se();Ze();_e();np=(e,t)=>{if(e.length<3||e.length>4)throw new Error("MatMulNBits requires 3 or 4 inputs");let r=e[0],o=r.dims.length;if(r.dims[o-1]!==t.k)throw new Error("The last dim of input shape does not match the k value");let i=Math.floor((t.k+t.blockSize-1)/t.blockSize),u=t.blockSize/8*t.bits,a=e[1];if(!M.areEqual(a.dims,[t.n,i,u]))throw new Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let p=e[2].dims;if(M.size(p)!==t.n*i)throw new Error("scales input size error.");if(e.length===4){let d=e[3].dims,y=t.bits>4?t.n*i:t.n*Math.floor((i+1)/2);if(M.size(d)!==y)throw new Error("zeroPoints input size error.")}},op=(e,t,r,o)=>{let i=e[0].dims,u=i.length,a=Math.floor((t.k+t.blockSize-1)/t.blockSize),c=i[u-2],p=t.k,h=t.n,d=i.slice(0,u-2),y=M.size(d),_=t.blockSize/8*t.bits/4,v=e[0].dataType,S=Me(c),A=Me(t.k),I=Me(_),x=tr(v),E=c*a*x,P=Math.floor(o/E),O=a<=r[0]&&P>0,R=!O||P>=4?Me(h):P>=2&&Me(h)>=2?2:1,L=d.concat([c,h]),N=M.size(L)/R/S,K=O?[]:[{type:12,data:N},{type:12,data:t.blockSize}],Q=[y,c,p/A],he=M.convertShape(e[1].dims).slice();he.splice(-1,1,_/I),K.push(...Z(Q)),K.push(...Z(he)),K.push(...Z(e[2].dims)),e.length===4&&K.push(...Z(M.convertShape(e[3].dims)));let W=[y,c,h/R];K.push(...Z(W));let se=Ce=>{let We=Q.length,ee=U("a",e[0].dataType,We,A),ae=U("b",12,he.length,I),Ae=U("scales",e[2].dataType,e[2].dims.length),me=[ee,ae,Ae],ie=e.length===4?U("zero_points",12,e[3].dims.length):void 0;ie&&me.push(ie);let ue=W.length,le=j("output",e[0].dataType,ue,R),qe=[{name:"output_size",type:"u32"},{name:"block_size",type:"u32"}],G=De(e[0].dataType),ne=(()=>{switch(A){case 1:return`array<${G}, 8>`;case 2:return`mat4x2<${G}>`;case 4:return`mat2x4<${G}>`;default:throw new Error(`${A}-component is not supported.`)}})(),xe=`\n        for (var word: u32 = 0; word < ${_}; word += ${I}) {\n          ${ae.indicesSet("b_indices","2","word")};\n          let b_data = ${ae.getByIndices("b_indices")};\n          for (var i: u32 = 0; i < ${I}; i++) {\n            let b_value: u32 = ${I===1?"b_data":"b_data[word + i]"};\n            let b_mask: u32 = 0x0F0F0F0Fu;\n            let b_value_lower: vec4<u32> = unpack4xU8(b_value & b_mask);\n            let b_value_upper: vec4<u32> = unpack4xU8((b_value >> 4) & b_mask);\n            let b_quantized_values = ${ne}(${Array.from({length:4},(Be,Ge)=>`${G}(b_value_lower[${Ge}]), ${G}(b_value_upper[${Ge}])`).join(", ")});\n            let b_dequantized_values = ${(()=>A===1?`${ne}(${Array.from({length:8},(Be,Ge)=>`(b_quantized_values[${Ge}] - zero_point) * scale`).join(", ")});`:`(b_quantized_values - ${ne}(${Array(8).fill("zero_point").join(",")})) * scale;`)()};\n            // Number of B elements per 32-bit word is 32/bits = 32/4 = 8\n            for (var m: u32 = 0; m < ${O?c:S}u; m++) {\n              ${ee.indicesSet("a_indices",We-2,O?"m":`row * ${S} + m`)};\n              ${ee.indicesSet("a_indices",We-1,"word_offset")};\n              var input_offset = ${ee.indicesToOffset("a_indices")};\n              var a_data: ${ne};\n              for (var j: u32 = 0; j < ${8/A}; j++) {\n                a_data[j] = ${ee.getByOffset("input_offset")};\n                input_offset++;\n              }\n              ${O?"workgroup_shared[workgroup_shared_offset + m]":"output_values[m]"}${R>1?"[c]":""} += ${Array.from({length:8/A},(Be,Ge)=>`${A===1?`a_data[${Ge}] * b_dequantized_values[${Ge}]`:`dot(a_data[${Ge}], b_dequantized_values[${Ge}])`}`).join(" + ")};\n            }\n            word_offset += ${8/A};\n          }\n        }`,Ke=ie?`\n          zero_point_offset += 4;\n          if (zero_point_offset == 32) {\n            zero_point_offset = 0;\n            zero_point_index++;\n            zero_point_word = ${ie.getByOffset("zero_point_index")};\n          }`:"";return O?`\n        var<workgroup> workgroup_shared: array<${le.type.value}, ${c*a}>;\n        ${Ce.declareVariables(...me,le)}\n        ${Ce.mainStart([a,1,1])}\n          var a_indices: ${ee.type.indices};\n          var block = local_id.x;\n          var col = workgroup_id.y;\n          var batch = workgroup_id.z;\n          ${ee.indicesSet("a_indices","0","batch")};\n          // Two zero points are packed into one byte when uniforms.bits is 4.\n          for (var c: u32 = 0; c < ${R}; c++) {\n            let col_times_components_plus_c = col * ${R} + c;\n              ${ie?`\n            var zero_point_bytes_per_col: u32 = (${a} + 1) / 2;\n            var zero_point_byte_count: u32 = col_times_components_plus_c * zero_point_bytes_per_col + (block >> 0x1u);\n            var zero_point_word_index: u32 = zero_point_byte_count >> 0x2u;\n            var zero_point_byte_offset: u32 = zero_point_byte_count & 0x3u;\n            var zero_point_nibble_offset: u32 = block & 0x1u;\n            var zero_point_bits_offset: u32 = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);\n            var zero_point_word: u32 = ${ie.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;`:""}\n            var b_indices: ${ae.type.indices};\n            ${ae.indicesSet("b_indices","0","col_times_components_plus_c")};\n            // The scale and zero points are computed per block.\n            var scales_index = col_times_components_plus_c * ${a} + block;\n            let scale = ${Ae.getByOffset("scales_index")};\n            // The default zero point is 8 for unsigned 4-bit quantization.\n            let zero_point = ${G}(${ie?"(zero_point_word) & 0xFu":8});\n            ${ae.indicesSet("b_indices","1","block")};\n            var word_offset: u32 = block * ${t.blockSize/A};\n            var workgroup_shared_offset: u32 = block * ${c};\n            ${xe}\n          }\n          workgroupBarrier();\n          if (local_id.x == 0u) {\n            var output_indices: ${le.type.indices};\n            ${le.indicesSet("output_indices","0","batch")};\n            ${le.indicesSet("output_indices",ue-1,"col")};\n            ${le.indicesSet("output_indices",ue-2,"0")};\n            var output_offset = ${le.indicesToOffset("output_indices")};\n            for (var m: u32 = 0u; m < ${c}u; m++) {\n              var output_value: ${le.type.value} = ${le.type.value}(0);\n              var workgroup_shared_offset: u32 = m;\n              for (var b: u32 = 0u; b < ${a}u; b++) {\n                output_value += workgroup_shared[workgroup_shared_offset];\n                workgroup_shared_offset += ${c};\n              }\n              ${le.setByOffset("output_offset","output_value")};\n              output_offset += ${h/R};\n            }\n          }\n        }`:`\n        ${Ce.registerUniforms(qe).declareVariables(...me,le)}\n        ${Ce.mainStart()}\n          ${Ce.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n          var output_values: array<${le.type.value}, ${S}>;\n          var output_indices = ${le.offsetToIndices("global_idx")};\n          var col = ${le.indicesGet("output_indices",ue-1)};\n          var row = ${le.indicesGet("output_indices",ue-2)};\n          var a_indices: ${ee.type.indices} = output_indices;\n          // Two zero points are packed into one byte because uniforms.bits <= 4.\n          // zero_point_offset is either 0 or 4. It is bit offset within one byte.\n          // TODO support zero_point_offset for bits > 4\n          ${ie?`\n          var zero_point_abs_offset = col * ${R} * ((${a} + 1) / 2);\n          var zero_point_index: u32 = zero_point_abs_offset / 4;\n          var zero_point_word: u32 = ${ie.getByOffset("zero_point_index")};\n          var zero_point_offset: u32 = (zero_point_abs_offset % 4) * 8;`:""}\n          var scale_index = col * ${a*R};\n          var b_indices: ${ae.type.indices};\n          for (var c: u32 = 0; c < ${R}; c++) {\n            ${ae.indicesSet("b_indices","0",`col * ${R} + c`)};\n            var block_offset: u32 = 0;\n            for (var block: u32 = 0; block < ${a}; block++) {\n              // The scale and zero points are computed per block.\n              let scale = ${Ae.getByOffset("scale_index")};\n              // The default zero point is 8 for unsigned 4-bit quantization.\n              let zero_point = ${G}(${ie?"extractBits(zero_point_word, zero_point_offset, 4)":8});\n              ${ae.indicesSet("b_indices","1","block")};\n              var word_offset: u32 = block_offset;\n              ${xe}\n              scale_index++;\n              ${Ke}\n              block_offset += uniforms.block_size / ${A};\n            }\n            // Drop the trailing 4 bits if the zero_poit_offset is not a byte boundary to align with the next byte.\n            ${ie?`if (zero_point_offset % 8 > 0) {\n                ${Ke}\n              }`:""}\n            }\n            for (var k: u32 = 0u; k < ${S}u; k++) {\n              ${le.indicesSet("output_indices",ue-2,`${S} * row + k`)};\n              ${le.setByIndices("output_indices","output_values[k]")}\n            }\n        }`};return{name:O?"BlockwiseMatMulNBits":"MatMulNBits",shaderCache:{hint:`${t.cacheKey};${c};${v};${e.length}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:L,dataType:v}],name:O?"BlockwiseMatMulNBits":"MatMulNBits",dispatchGroup:O?{x:1,y:Math.ceil(h/R),z:y}:{x:Math.ceil(N/64)},programUniforms:K}),getShaderSource:se}},Wu=(e,t)=>{np(e.inputs,t);let r=e.getMaxComputeWorkgroupSizes(),o=e.getMaxComputeWorkgroupStoragesize();e.compute(op(e.inputs,t,r,o))},Nu=e=>ve(e)});var it,ip,Lu,Hu,ap,Ko,Fu,qu=Y(()=>{"use strict";ye();Se();Ze();_n();Ro();_e();Sr();it=(e,t)=>e.length>t&&e[t].dims.length>0&&M.size(e[t].dims)>0?e[t]:void 0,ip=(e,t)=>{let r=e[0],o=it(e,1),i=it(e,2),u=it(e,3),a=it(e,4),c=it(e,5),p=it(e,6),h=it(e,7);if(r.dims.length!==3&&r.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let d=!1,y=r.dims[0],w=r.dims[1],_=r.dims.length===3?d?r.dims[2]/3:r.dims[2]:t.numHeads*r.dims[4],v=w,S=0,A=0,I=Math.floor(_/t.numHeads);if(p&&h){if(p.dims.length!==4)throw new Error(\'Input "past_key" is expected to have 4 dimensions\');if(p.dims[0]!==y||p.dims[1]!==t.numHeads||p.dims[3]!==I)throw new Error(\'Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)\');if(h.dims[0]!==y||h.dims[1]!==t.numHeads||h.dims[3]!==I)throw new Error(\'Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)\');if(p.dims[2]!==h.dims[2])throw new Error(\'Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)\');if(h.dims.length!==4)throw new Error(\'Input "past_value" is expected to have 4 dimensions\');S=p.dims[2],A=p.dims[2]}else if(p||h)throw new Error(\'Input "past_key" and "past_value" shall be both present or both absent\');let x;if(o){if(r.dims.length!==3)throw new Error(\'Input "query" is expected to have 3 dimensions when key is given\');if(o.dims.length<3||o.dims.length>5)throw new Error(\'Input "key" is expected to have 3, 4, or 5 dimensions\');if(r.dims[0]!==o.dims[0])throw new Error(\'Input "query" and "key" shall have same dim 0 (batch size)\');if(o.dims.length===3){if(o.dims[2]!==r.dims[2])throw new Error(\'Input "query" and "key" shall have same dim 2 (hidden_size)\');x=2,v=o.dims[1]}else if(o.dims.length===5){if(o.dims[2]!==t.numHeads||o.dims[3]!==2||o.dims[4]!==I)throw new Error(\'Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv\');if(i)throw new Error(\'Expect "value" be none when "key" has packed kv format.\');x=5,v=o.dims[1]}else{if(o.dims[1]!==t.numHeads||o.dims[3]!==I)throw new Error(\'Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key\');x=0,v=o.dims[2]}}else{if(r.dims.length!==3&&r.dims.length!==5)throw new Error(\'Input "query" is expected to have 3 or 5 dimensions when key is empty\');if(r.dims.length===5&&(r.dims[2]!==t.numHeads||r.dims[3]!==3))throw new Error(\'Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv\');x=3}if(u){if(u.dims.length!==1)throw new Error(\'Input "bias" is expected to have 1 dimension\');if(i&&r.dims.length===5&&r.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let E=0;if(a){E=8;let N=a.dims;throw N.length===1?N[0]===y?E=1:N[0]===3*y+2&&(E=3):N.length===2&&N[0]===y&&N[1]===v&&(E=5),E===8?new Error(\'Input "key_padding_mask" shape shall be (batch_size) or (batch_size, kv_sequence_length)\'):new Error("Mask not supported")}let P=!1,O=_;if(i){if(i.dims.length!==3&&i.dims.length!==4)throw new Error(\'Input "value" is expected to have 3 or 4 dimensions\');if(r.dims[0]!==i.dims[0])throw new Error(\'Input "query" and "value" shall have same dim 0 (batch_size)\');if(i.dims.length===3){if(v!==i.dims[1])throw new Error(\'Input "key" and "value" shall have the same dim 1 (kv_sequence_length)\');O=i.dims[2]}else{if(v!==i.dims[2])throw new Error(\'Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)\');O=i.dims[1]*i.dims[3],P=!0}}let R=S+v,L=!1;if(a)throw new Error("Key padding mask is not supported");if(c){if(c.dims.length!==4)throw new Error(\'Input "relative_position_bias" is expected to have 4 dimensions\');if(c.dims[0]!==y&&c.dims[0]!==1||c.dims[1]!==t.numHeads||c.dims[2]!==w||c.dims[3]!==R)throw new Error(\'Input "relative_position_bias" shape (batch_size, 1, sequence_length, kv_sequence_length)\')}return{batchSize:y,sequenceLength:w,pastSequenceLength:S,kvSequenceLength:v,totalSequenceLength:R,maxSequenceLength:A,inputHiddenSize:0,hiddenSize:_,vHiddenSize:O,headSize:I,vHeadSize:Math.floor(O/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:E,scale:t.scale,broadcastResPosBias:L,passPastInKv:P,qkvFormat:x}},Lu=e=>ve({...e}),Hu=ve({perm:[0,2,1,3]}),ap=(e,t,r,o,i,u,a)=>{let c=[o,i,u],p=M.size(c),h=[{type:12,data:p},{type:12,data:a},{type:12,data:u}],d=y=>{let w=j("qkv_with_bias",t.dataType,c),_=U("qkv",t.dataType,c),v=U("bias",r.dataType,c),S=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`\n  ${y.registerUniforms(S).declareVariables(_,v,w)}\n  ${y.mainStart()}\n    ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;\n\n    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];\n  }`};return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:c,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:h}),getShaderSource:d},{inputs:[t,r],outputs:[-1]})[0]},Ko=(e,t,r,o,i,u,a,c)=>{let p=u;if(a){if(o===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return p=ap(e,u,a,t,o,r*i,c),p=p.reshape([t,o,r,i]),e.compute(yt(p,Hu.perm),{inputs:[p],outputs:[-1]})[0]}else return u.dims.length===3&&(p=u.reshape([t,o,r,i])),e.compute(yt(p,Hu.perm),{inputs:[p],outputs:[-1]})[0]},Fu=(e,t)=>{let r=ip(e.inputs,t),o=e.inputs[0],i=it(e.inputs,1),u=it(e.inputs,2),a=it(e.inputs,3),c=it(e.inputs,4),p=it(e.inputs,5),h=it(e.inputs,6),d=it(e.inputs,7);if(o.dims.length===5)throw new Error("Packed QKV is not implemented");if(i?.dims.length===5)throw new Error("Packed KV is not implemented");let y=i&&u&&i.dims.length===4&&u.dims.length===4,w=Ko(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,o,a,0);if(y)return Pn(e,w,i,u,c,void 0,h,d,p,r,t);if(!i||!u)throw new Error("key and value must be provided");let _=Ko(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.headSize,i,a,r.hiddenSize),v=Ko(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.vHeadSize,u,a,2*r.hiddenSize);Pn(e,w,_,v,c,void 0,h,d,p,r,t)}});var sp,up,dp,lp,cp,pp,mp,fp,ju,Ku=Y(()=>{"use strict";ye();Se();_e();sp=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(e[0].dataType!==1&&e[0].dataType!==10)throw new Error("Input type must be float or float16.");if(e.length>=2){let t=e[0].dims.length*2===e[1].dims[0];if(e.length===4&&(t=e[3].dims[0]*2===e[1].dims[0]),!t)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},up=(e,t,r)=>{let o="";for(let i=t-1;i>=0;--i)o+=`\n            k = i32(${e.indicesGet("indices",i)}) - ${fe("uniforms.pads",i,r)};\n            if (k < 0) {\n              break;\n            }\n            if (k >= i32(${fe("uniforms.x_shape",i,t)})) {\n              break;\n            }\n            offset += k * i32(${fe("uniforms.x_strides",i,t)});\n        `;return`\n          value = ${e.type.value}(uniforms.constant_value);\n          for (var i = 0; i < 1; i++) {\n            var offset = 0;\n            var k = 0;\n            ${o}\n            value = x[offset];\n          }\n      `},dp=(e,t,r)=>{let o="";for(let i=t-1;i>=0;--i)o+=`\n                k = i32(${e.indicesGet("indices",i)}) - ${fe("uniforms.pads",i,r)};\n                if (k < 0) {\n                  k = -k;\n                }\n                {\n                  let _2n_1 = 2 * (i32(${fe("uniforms.x_shape",i,t)}) - 1);\n                  k = k % _2n_1;\n                  if(k >= i32(${fe("uniforms.x_shape",i,t)})) {\n                    k = _2n_1 - k;\n                  }\n                }\n                offset += k * i32(${fe("uniforms.x_strides",i,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},lp=(e,t,r)=>{let o="";for(let i=t-1;i>=0;--i)o+=`\n                k = i32(${e.indicesGet("indices",i)}) - ${fe("uniforms.pads",i,r)};\n                if (k < 0) {\n                  k = 0;\n                }\n                if (k >= i32(${fe("uniforms.x_shape",i,t)})) {\n                  k = i32(${fe("uniforms.x_shape",i,t)}) - 1;\n                }\n                offset += k * i32(${fe("uniforms.x_strides",i,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},cp=(e,t,r)=>{let o="";for(let i=t-1;i>=0;--i)o+=`\n                k = i32(${e.indicesGet("indices",i)}) - ${fe("uniforms.pads",i,r)};\n                if (k < 0)  {\n                  k += i32(${fe("uniforms.x_shape",i,t)}]);\n                }\n                if (k >= i32(${fe("uniforms.x_shape",i,t)})) {\n                  k -= i32(${fe("uniforms.x_shape",i,t)});\n                }\n                offset += k * i32(${fe("uniforms.x_strides",i,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},pp=(e,t,r)=>{switch(r.mode){case 0:return up(e,t,r.pads.length);case 1:return dp(e,t,r.pads.length);case 2:return lp(e,t,r.pads.length);case 3:return cp(e,t,r.pads.length);default:throw new Error("Invalid mode")}},mp=(e,t)=>{let r=M.padShape(e[0].dims.slice(),t.pads),o=e[0].dims,i=M.size(r),u=[{type:12,data:i},{type:6,data:t.pads}];t.mode===0&&u.push({type:e[0].dataType,data:t.value}),u.push(...Z(e[0].dims,r));let a=["rank"],c=p=>{let h=j("output",e[0].dataType,r.length),d=U("x",e[0].dataType,o.length),y=d.type.value,w=pp(h,o.length,t),_=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return t.mode===0&&_.push({name:"constant_value",type:y}),`\n            ${p.registerUniforms(_).declareVariables(d,h)}\n            ${p.mainStart()}\n            ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n            let indices = ${h.offsetToIndices("global_idx")};\n\n            var value = ${y}(0);\n            ${w}\n            output[global_idx] = value;\n        }`};return{name:"Pad",shaderCache:{hint:`${t.mode}`,inputDependencies:a},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(M.size(r)/64)},programUniforms:u}),getShaderSource:c}},fp=(e,t)=>{if(e.length>1){let r=e[1].getBigInt64Array(),o=e.length>=3&&e[2].data?e[2].getFloat32Array()[0]:0,i=e[0].dims.length,u=new Int32Array(2*i).fill(0);if(e.length>=4){let c=e[3].getBigInt64Array();for(let p=0;p<c.length;p++)u[Number(c[p])]=Number(r[p]),u[Number(c[p])+i]=Number(r[p+c.length])}else r.forEach((c,p)=>u[Number(p)]=Number(c));let a=[];return u.forEach(c=>a.push(c)),{mode:t.mode,value:o,pads:a}}else return t},ju=(e,t)=>{sp(e.inputs);let r=fp(e.inputs,t);e.compute(mp(e.inputs,r),{inputs:[0]})}});var Nn,Yu,Zu,Xu,Qu,hp,gp,Ju,ed,td,rd,nd,od,id,ad,sd,ud,dd,ld,cd=Y(()=>{"use strict";$r();ye();Se();_e();Nn=e=>{if(vr.webgpu.validateInputContent&&(!e||e.length!==1))throw new Error("Pool ops requires 1 input.")},Yu=(e,t,r)=>{let o=t.format==="NHWC",i=e.dims.slice();o&&i.splice(1,0,i.pop());let u=Object.hasOwnProperty.call(t,"dilations"),a=t.kernelShape.slice(),c=t.strides.slice(),p=u?t.dilations.slice():[],h=t.pads.slice();nr.adjustPoolAttributes(r,i,a,c,p,h);let d=nr.computePoolOutputShape(r,i,c,p,a,h,t.autoPad),y=Object.assign({},t);u?Object.assign(y,{kernelShape:a,strides:c,pads:h,dilations:p,cacheKey:t.cacheKey}):Object.assign(y,{kernelShape:a,strides:c,pads:h,cacheKey:t.cacheKey});let w=d.slice();return w.push(w.splice(1,1)[0]),[y,o?w:d]},Zu=(e,t)=>{let r=t.format==="NHWC",o=M.size(e),i=M.size(t.kernelShape),u=[{type:12,data:o},{type:12,data:i}],a=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){let c=t.kernelShape[t.kernelShape.length-1],p=t.strides[t.strides.length-1],h=t.pads[t.pads.length/2-1],d=t.pads[t.pads.length-1],y=!!(h+d);u.push({type:12,data:c},{type:12,data:p},{type:12,data:h},{type:12,data:d}),a.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let w=!1;if(t.kernelShape.length===2){let _=t.kernelShape[t.kernelShape.length-2],v=t.strides[t.strides.length-2],S=t.pads[t.pads.length/2-2],A=t.pads[t.pads.length-2];w=!!(S+A),u.push({type:12,data:_},{type:12,data:v},{type:12,data:S},{type:12,data:A}),a.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[u,a,!0,y,w]}else{if(r)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let c=M.computeStrides(t.kernelShape);u.push({type:12,data:c},{type:12,data:t.pads},{type:12,data:t.strides}),a.push({name:"kernelStrides",type:"u32",length:c.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length});let p=t.pads.reduce((h,d)=>h+d);return[u,a,!!p,!1,!1]}},Xu=(e,t,r,o,i,u,a,c,p,h,d,y)=>{let w=i.format==="NHWC",_=t.type.value,v=j("output",t.type.tensor,o);if(i.kernelShape.length<=2){let S="",A="",I="",x=r-(w?2:1);if(d?S=`\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[${x}] = indices[${x}] * uniforms.sw - uniforms.pwStart + i;\n                  if (xIndices[${x}] < 0 || xIndices[${x}]\n                      >= uniforms.x_shape[${x}]) {\n                    pad++;\n                    continue;\n                  }\n                  let x_val = x[${t.indicesToOffset("xIndices")}];\n                  ${u}\n                }`:S=`\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[${x}] = indices[${x}] * uniforms.sw - uniforms.pwStart + i;\n                  let x_val = x[${t.indicesToOffset("xIndices")}];\n                  ${u}\n                }`,i.kernelShape.length===2){let P=r-(w?3:2);y?A=`\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[${P}] = indices[${P}] * uniforms.sh - uniforms.phStart + j;\n                  if (xIndices[${P}] < 0 || xIndices[${P}] >= uniforms.x_shape[${P}]) {\n                    pad += i32(uniforms.kw);\n                    continue;\n                  }\n              `:A=`\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[${P}] = indices[${P}] * uniforms.sh - uniforms.phStart + j;\n                `,I=`\n              }\n            `}return`\n            ${e.registerUniforms(p).declareVariables(t,v)}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n              let indices = ${v.offsetToIndices("global_idx")};\n              var xIndices = ${v.offsetToIndices("global_idx")};\n\n              var value = ${_}(${c});\n              var pad = 0;\n              ${A}\n              ${S}\n              ${I}\n              ${a}\n\n              output[global_idx] = value;\n            }`}else{if(w)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let S=i.kernelShape.length,A=i.pads.length,I="";return h?I=`\n                if (xIndices[j] >= uniforms.x_shape[j]) {\n                  pad++;\n                  isPad = true;\n                  break;\n                }\n              }\n              if (!isPad) {\n                let x_val = x[${t.indicesToOffset("xIndices")}];\n                ${u}\n              }`:I=`\n              }\n              let x_val = x[${t.indicesToOffset("xIndices")}];\n              ${u}\n            `,`\n            ${e.registerUniforms(p).declareVariables(t,v)}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n              let indices = ${v.offsetToIndices("global_idx")};\n              var xIndices = ${v.offsetToIndices("global_idx")};\n\n              var offsets: array<u32, ${S}>;\n\n              var value = ${_}(${c});\n              var pad = 0;\n              var isPad = false;\n\n              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {\n                var offset = i;\n                for (var j = 0u; j < ${S-1}u; j++) {\n                  offsets[j] = offset / ${fe("uniforms.kernelStrides","j",S)};\n                  offset -= offsets[j] * ${fe("uniforms.kernelStrides","j",S)};\n                }\n                offsets[${S-1}] = offset;\n\n                isPad = false;\n                for (var j = ${r-S}u; j < ${r}u; j++) {\n                  xIndices[j] = indices[j] * ${fe("uniforms.strides",`j - ${r-S}u`,S)}\n                    + offsets[j - ${r-S}u] - ${fe("uniforms.pads","j - 2u",A)};\n                  ${I}\n              }\n              ${a}\n\n              output[global_idx] = value;\n            }`}},Qu=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,hp=e=>`${Qu(e)};${e.countIncludePad}`,gp=e=>`${Qu(e)};${e.storageOrder};${e.dilations}`,Ju=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),ed=(e,t,r,o)=>{let[i,u]=Yu(t,o,r),a=U("x",t.dataType,t.dims.length),c=a.type.value,p="value += x_val;",h="";i.countIncludePad?h+=`value /= ${c}(uniforms.kernelSize);`:h+=`value /= ${c}(i32(uniforms.kernelSize) - pad);`;let[d,y,w,_,v]=Zu(u,i);d.push(...Z(t.dims,u));let S=["rank"];return{name:e,shaderCache:{hint:`${o.cacheKey};${w};${_};${v}`,inputDependencies:S},getRunData:()=>({outputs:[{dims:u,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(M.size(u)/64)},programUniforms:d}),getShaderSource:A=>Xu(A,a,t.dims.length,u.length,i,p,h,0,y,w,_,v)}},td=e=>{let t=e.count_include_pad!==0,r=Ju(e);if(r.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let o={countIncludePad:t,...r,cacheKey:""};return{...o,cacheKey:hp(o)}},rd=(e,t)=>{Nn(e.inputs),e.compute(ed("AveragePool",e.inputs[0],!1,t))},nd={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},od=e=>{let t=e.format;return{format:t,...nd,cacheKey:t}},id=(e,t)=>{Nn(e.inputs),e.compute(ed("GlobalAveragePool",e.inputs[0],!0,t))},ad=(e,t,r,o)=>{let[i,u]=Yu(t,o,r),a=`\n      value = max(x_val, value);\n    `,c="",p=U("x",t.dataType,t.dims.length),h=["rank"],[d,y,w,_,v]=Zu(u,i);return d.push(...Z(t.dims,u)),{name:e,shaderCache:{hint:`${o.cacheKey};${w};${_};${v}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:u,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(M.size(u)/64)},programUniforms:d}),getShaderSource:S=>Xu(S,p,t.dims.length,u.length,i,a,c,t.dataType===10?-65504:-1e5,y,w,_,v)}},sd=(e,t)=>{Nn(e.inputs),e.compute(ad("MaxPool",e.inputs[0],!1,t))},ud=e=>{let t=e.storage_order,r=e.dilations,o=Ju(e);if(t!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(o.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let i={storageOrder:t,dilations:r,...o,cacheKey:""};return{...i,cacheKey:gp(i)}},dd=e=>{let t=e.format;return{format:t,...nd,cacheKey:t}},ld=(e,t)=>{Nn(e.inputs),e.compute(ad("GlobalMaxPool",e.inputs[0],!0,t))}});var bp,wp,pd,md=Y(()=>{"use strict";$r();ye();_e();bp=(e,t,r)=>{let o=e===t,i=e<t&&r<0,u=e>t&&r>0;if(o||i||u)throw new Error("Range these inputs\' contents are invalid.")},wp=(e,t,r,o)=>{let i=Math.abs(Math.ceil((t-e)/r)),u=[i],a=i,c=[{type:12,data:a},{type:o,data:e},{type:o,data:r},...Z(u)],p=h=>{let d=j("output",o,u.length),y=d.type.value,w=[{name:"outputSize",type:"u32"},{name:"start",type:y},{name:"delta",type:y}];return`\n        ${h.registerUniforms(w).declareVariables(d)}\n        ${h.mainStart()}\n        ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n        output[global_idx] = uniforms.start + ${y}(global_idx) * uniforms.delta;\n      }`};return{name:"Range",shaderCache:{hint:`${o}`},getShaderSource:p,getRunData:()=>({outputs:[{dims:u,dataType:o}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:c})}},pd=e=>{let t=0,r=0,o=0;e.inputs[0].dataType===6?(t=e.inputs[0].getInt32Array()[0],r=e.inputs[1].getInt32Array()[0],o=e.inputs[2].getInt32Array()[0]):e.inputs[0].dataType===1&&(t=e.inputs[0].getFloat32Array()[0],r=e.inputs[1].getFloat32Array()[0],o=e.inputs[2].getFloat32Array()[0]),vr.webgpu.validateInputContent&&bp(t,r,o),e.compute(wp(t,r,o,e.inputs[0].dataType),{inputs:[]})}});var vp,$p,_p,Sp,xp,Cp,Ap,Ip,Tp,Ep,Pp,fd,kp,Op,Rp,Bp,Dp,hd,gd,yd=Y(()=>{"use strict";ye();Se();Ze();_e();vp=(e,t)=>{if(e.every(r=>r>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),e.length>0){if(t.mode==="linear"){if(!(e.length===2||e.length===3||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1||e.length===5&&e[0]===1&&e[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and\n            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(t.mode==="cubic"&&!(e.length===2||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},$p=(e,t,r)=>{t.every(i=>i>=0&&i<r||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let o=new Array(r).fill(1);return t.forEach((i,u)=>o[i]=e[u]),o},_p=(e,t,r,o,i,u)=>{let[a,c,p]=r>10?[1,2,3]:[-1,e.length>1?1:-1,-1],h=e[0].dims.length;if(a>0&&e.length>a&&e[a].dims.length>0)e[a].getFloat32Array().forEach(d=>u.push(d));else if(t.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(c>0&&e.length>c&&e[c].dims.length>0){if(e[c].getFloat32Array().forEach(d=>o.push(d)),o.length!==0&&o.length!==h&&r>=18&&o.length!==t.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");vp(o,t),t.axes.length>0&&$p(o,t.axes,h).forEach((d,y)=>o[y]=d)}if(p>0&&e.length>p&&(e[p].getBigInt64Array().forEach(d=>i.push(Number(d))),i.length!==h||r>=18&&i.length===t.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(o.length!==t.axes.length)throw new Error(\'Resize requires "scales" input size to be of axes rank when axes attributes is specified\');if(i.length!==t.axes.length)throw new Error(\'Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified\')}if(typeof o<"u"&&typeof i<"u"&&o.length>0&&i.length>h)throw new Error("Resize requires only of scales or sizes to be specified")},Sp=(e,t)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,\n     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${t} { `+(()=>{switch(e){case"asymmetric":return`return ${t}(xResized) / ${t}(xScale);`;case"pytorch_half_pixel":return`if (lengthResized > 1) {\n                    return (${t}(xResized) + 0.5) / ${t}(xScale) - 0.5;\n                  } else {\n                    return 0.0;\n                  }`;case"tf_half_pixel_for_nn":return`return (${t}(xResized) + 0.5) / ${t}(xScale);`;case"align_corners":return`if (lengthResized == 1) {\n                    return 0.0;\n                  } else {\n                    // The whole part and the fractional part are calculated separately due to inaccuracy of floating\n                    // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an\n                    // offset-by-one error later in floor().\n                    let whole = ${t}(xResized * (lengthOriginal - 1) / (lengthResized - 1));\n                    let fract =\n                        ${t}(xResized * (lengthOriginal - 1) % (lengthResized - 1)) / ${t}(lengthResized - 1);\n                    return whole + fract;\n                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {\n                    return ${t}(roiStart) * ${t}(lengthOriginal - 1) +\n                        (${t}(xResized) * ${t}(roiEnd - roiStart) * ${t}(lengthOriginal - 1)) /\n                        ${t}(lengthResized - 1);\n                  } else {\n                    return 0.5 * ${t}(roiStart + roiEnd) * ${t}(lengthOriginal - 1);\n                  }`;case"half_pixel_symmetric":return`const outputWidth = ${t}xScale * ${t}(lengthResized);\n                  const adjustment = ${t}(lengthResized) / outputWidth;\n                  const center = ${t}(lengthOriginal) / 2;\n                  const offset = center * (1 - adjustment);\n                  return offset + ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;case"half_pixel":return`return ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",xp=(e,t,r)=>`fn getNearestPixelFromOriginal(xOriginal: ${r}, isDownSample: bool) -> ${r} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";case"simple":default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${e} is not supported`)}})()+"}",Cp=(e,t,r)=>{let o=new Array(r).fill(0).concat(new Array(r).fill(1)),i=e.length===0?o:e.slice();return t.length>0?(t.forEach((u,a)=>{o[u]=i[a],o[a+r]=i[t.length+a]}),o):i},Ap=(e,t,r,o)=>{let i=[];if(r.length>0)if(o.length>0){if(e.forEach(u=>i.push(u)),Math.max(...o)>e.length)throw new Error("axes is out of bound");o.forEach((u,a)=>i[u]=r[a])}else r.forEach(u=>i.push(u));else{if(t.length===0)throw new Error("Resize requires either scales or sizes.");i=e.map((u,a)=>Math.round(u*t[a]))}return i},Ip=(e,t,r)=>{let o=(()=>{switch(r.keepAspectRatioPolicy){case"not_larger":return r.axes.length>0?Math.min(...r.axes.map(u=>t[u]),Number.MAX_VALUE):Math.min(...t,Number.MAX_VALUE);case"not_smaller":return r.axes.length>0?Math.max(...r.axes.map(u=>t[u]),Number.MIN_VALUE):Math.max(...t,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${r.keepAspectRatioPolicy} is not supported`)}})();t.fill(1,0,t.length);let i=e.slice();return r.axes.length>0?(r.axes.forEach(u=>t[u]=o),r.axes.forEach(u=>i[u]=Math.round(e[u]*t[u]))):(t.fill(o,0,t.length),i.forEach((u,a)=>i[a]=Math.round(u*t[a]))),i},Tp=(e,t,r,o,i)=>`\n    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${r.length}> {\n      var original_indices: array<${e.type.value}, ${r.length}>;\n      for (var i:u32 = 0; i < ${r.length}; i++) {\n        var output_index = ${e.indicesGet("output_indices","i")};\n        var scale = ${fe("uniforms.scales","i",o)};\n        var roi_low = ${fe("uniforms.roi","i",i)};\n        var roi_hi = ${fe("uniforms.roi",`i + ${t.length}`,i)};\n        if (scale == 1.0) {\n          original_indices[i] = ${e.type.value}(output_index);\n        } else {\n          var input_shape_i = ${fe("uniforms.input_shape","i",t.length)};\n          var output_shape_i = ${fe("uniforms.output_shape","i",r.length)};\n          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                           input_shape_i, roi_low, roi_hi);\n        }\n      }\n      return original_indices;\n    }`,Ep=(e,t,r,o,i,u,a)=>`\n    fn calculateInputIndicesFromOutputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {\n      var input_indices: ${e.type.indices};\n      for (var i:u32 = 0; i < ${o.length}; i++) {\n        var output_index = ${t.indicesGet("output_indices","i")};\n        var input_index: u32;\n        var scale = ${fe("uniforms.scales","i",i)};\n        if (scale == 1.0) {\n          input_index = output_index;\n        } else {\n          var roi_low = ${fe("uniforms.roi","i",u)};\n          var roi_hi = ${fe("uniforms.roi",`i + ${r.length}`,u)};\n          var input_shape_i = ${fe("uniforms.input_shape","i",r.length)};\n          var output_shape_i = ${fe("uniforms.output_shape","i",o.length)};\n          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                        input_shape_i, roi_low, roi_hi);\n          if (!${a} || (original_idx >= 0 && original_idx < ${t.type.value}(input_shape_i))) {\n            if (original_idx < 0) {\n              input_index = 0;\n            } else if (original_idx > ${t.type.value}(input_shape_i - 1)) {\n              input_index = input_shape_i - 1;\n            } else {\n              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));\n            }\n          } else {\n            input_index = u32(original_idx);\n          }\n        }\n        ${e.indicesSet("input_indices","i"," input_index")}\n      }\n      return input_indices;\n    }`,Pp=(e,t)=>`\n    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {\n      for (var i:u32 = 0; i < ${t.length}; i++) {\n        var input_index = ${e.indicesGet("input_indices","i")};\n        if (input_index < 0 || input_index >= ${fe("uniforms.input_shape","i",t.length)}) {\n          return false;\n        }\n      }\n      return true;\n    }`,fd=(e,t,r,o)=>e.rank>o?`\n    ${e.indicesSet("input_indices",t,"channel")};\n    ${e.indicesSet("input_indices",r,"batch")};\n`:"",kp=(e,t,r,o,i)=>{let[a,c,p,h]=r.length===2?[-1,0,1,-1]:[0,2,3,1],d=e.type.value;return`\n    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${d} {\n      var input_indices: ${e.type.indices};\n      ${e.indicesSet("input_indices",c,`max(0, min(row, ${r[c]} - 1))`)};\n      ${e.indicesSet("input_indices",p,`max(0, min(col, ${r[p]} - 1))`)};\n      ${fd(e,h,a,2)}\n      return ${e.getByIndices("input_indices")};\n    }\n\n    fn bilinearInterpolation(output_indices: ${t.type.indices}) -> ${d} {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var row:${d} = originalIndices[${c}];\n      var col:${d} = originalIndices[${p}];\n      ${o?`if (row < 0 || row > (${r[c]} - 1) || col < 0 || col > (${r[p]} - 1)) {\n        return ${i};\n      }`:""};\n      row = max(0, min(row, ${r[c]} - 1));\n      col = max(0, min(col, ${r[p]} - 1));\n      var row1: u32 = u32(row);\n      var col1: u32 = u32(col);\n      var row2: u32 = u32(row + 1);\n      var col2: u32 = u32(col + 1);\n      var channel: u32 = ${r.length>2?`u32(originalIndices[${h}])`:"0"};\n      var batch: u32 =  ${r.length>2?`u32(originalIndices[${a}])`:"0"};\n      var x11: ${d} = getInputValue(batch, channel, row1, col1);\n      var x12: ${d} = getInputValue(batch, channel, row1, col2);\n      var x21: ${d} = getInputValue(batch, channel, row2, col1);\n      var x22: ${d} = getInputValue(batch, channel, row2, col2);\n      var dx1: ${d} = abs(row - ${d}(row1));\n      var dx2: ${d} = abs(${d}(row2) - row);\n      var dy1: ${d} = abs(col - ${d}(col1));\n      var dy2: ${d} = abs(${d}(col2) - col);\n      if (row1 == row2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (col1 == col2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);\n    }`},Op=(e,t,r,o,i,u,a,c,p,h)=>{let d=r.length===2,y=!0,[w,_]=d?[0,1]:y?[2,3]:[1,2],v=e.type.value,S=A=>{let I=A===w?"row":"col";return`\n      fn ${I}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${t.type.indices}) -> ${v} {\n        var output_index = ${t.indicesGet("output_indices",A)};\n        var originalIdx: ${v} = getOriginalCoordinateFromResizedCoordinate(output_index, ${i[A]},\n        ${o[A]}, ${r[A]}, ${u[A]}, ${u[A]} + ${r.length});\n        var fractOriginalIdx: ${v} = originalIdx - floor(originalIdx);\n        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);\n\n        if (${c} && (originalIdx < 0 || originalIdx > (${r[A]} - 1))) {\n          return ${p};\n        }\n        var data: array<${v}, 4> = array<${v}, 4>(0.0, 0.0, 0.0, 0.0);\n        for (var i: i32 = -1; i < 3; i++) {\n          var ${I}: ${v} = originalIdx + ${v}(i);\n          if (${I} < 0 || ${I} >= ${r[A]}) {\n            ${(()=>h?`coefs[i + 1] = 0.0;\n                        continue;`:c?`return ${p};`:`${I} = max(0, min(${I}, ${r[A]} - 1));`)()};\n          }\n        var input_indices_copy: ${e.type.indices} = input_indices;\n          ${e.indicesSet("input_indices_copy",A,`u32(${I})`)};\n          data[i + 1] = ${A===w?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};\n        }\n        return cubicInterpolation1D(data, coefs);\n      }`};return`\n    ${S(w)};\n    ${S(_)};\n  fn getCubicInterpolationCoefs(s: ${v}) -> array<${v}, 4> {\n    var absS = abs(s);\n    var coeffs: array<${v}, 4> = array<${v}, 4>(0.0, 0.0, 0.0, 0.0);\n    var oneMinusAbsS: ${v} = 1.0 - absS;\n    var twoMinusAbsS: ${v} = 2.0 - absS;\n    var onePlusAbsS: ${v} = 1.0 + absS;\n    coeffs[0] = ((${a} * onePlusAbsS - 5 * ${a}) * onePlusAbsS + 8 * ${a}) * onePlusAbsS - 4 * ${a};\n    coeffs[1] = ((${a} + 2) * absS - (${a} + 3)) * absS * absS + 1;\n    coeffs[2] = ((${a} + 2) * oneMinusAbsS - (${a} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;\n    coeffs[3] = ((${a} * twoMinusAbsS - 5 * ${a}) * twoMinusAbsS + 8 * ${a}) * twoMinusAbsS - 4 * ${a};\n    return coeffs;\n  }\n\n  fn cubicInterpolation1D(x: array<${v}, 4>, coefs: array<${v}, 4>) -> ${v} {\n    var coefsSum: ${v} = coefs[0] + coefs[1] + coefs[2] + coefs[3];\n    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;\n  }\n\n  fn bicubicInterpolation(output_indices: ${t.type.indices}) -> ${v} {\n    var input_indices: ${e.type.indices} = output_indices;\n    return colCubicInterpolation(input_indices, output_indices);\n  }\n    `},Rp=(e,t,r,o,i)=>{let[a,c,p,h,d]=r.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],y=e.type.value;return`\n    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${y} {\n      var input_indices: ${e.type.indices};\n      ${e.indicesSet("input_indices",c,`max(0, min(depth, ${r[c]} - 1))`)};\n      ${e.indicesSet("input_indices",p,`max(0, min(height, ${r[p]} - 1))`)};\n      ${e.indicesSet("input_indices",h,`max(0, min(width, ${r[h]} - 1))`)};\n      ${fd(e,d,a,3)}\n      return ${e.getByIndices("input_indices")};\n    }\n\n    fn trilinearInterpolation(output_indices: ${t.type.indices}) -> ${y} {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var depth:${y} = originalIndices[${c}];\n      var height:${y} = originalIndices[${p}];\n      var width:${y} = originalIndices[${h}];\n      ${o?`if (depth < 0 || depth > (${r[c]} - 1) || height < 0 || height > (${r[p]} - 1) || width < 0 || (width > ${r[h]} - 1)) {\n      return ${i};\n        }`:""};\n\n    depth = max(0, min(depth, ${r[c]} - 1));\n      height = max(0, min(height, ${r[p]} - 1));\n      width = max(0, min(width, ${r[h]} - 1));\n      var depth1: u32 = u32(depth);\n      var height1: u32 = u32(height);\n      var width1: u32 = u32(width);\n      var depth2: u32 = u32(depth + 1);\n      var height2: u32 = u32(height + 1);\n      var width2: u32 = u32(width + 1);\n      var channel: u32 = ${r.length>3?`u32(originalIndices[${d}])`:"0"};\n      var batch: u32 =  ${r.length>3?`u32(originalIndices[${a}])`:"0"};\n\n      var x111: ${y} = getInputValue(batch, channel, depth1, height1, width1);\n      var x112: ${y} = getInputValue(batch, channel, depth1, height1, width2);\n      var x121: ${y} = getInputValue(batch, channel, depth1, height2, width1);\n      var x122: ${y} = getInputValue(batch, channel, depth1, height2, width2);\n      var x211: ${y} = getInputValue(batch, channel, depth2, height1, width1);\n      var x212: ${y} = getInputValue(batch, channel, depth2, height1, width2);\n      var x221: ${y} = getInputValue(batch, channel, depth2, height2, width1);\n      var x222: ${y} = getInputValue(batch, channel, depth2, height2, width2);\n      var dx1: ${y} = abs(depth - ${y}(depth1));\n      var dx2: ${y} = abs(${y}(depth2) - depth);\n      var dy1: ${y} = abs(height - ${y}(height1));\n      var dy2: ${y} = abs(${y}(height2) - height);\n      var dz1: ${y} = abs(width - ${y}(width1));\n      var dz2: ${y} = abs(${y}(width2) - width);\n      if (depth1 == depth2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (height1 == height2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      if (width1 == width2) {\n        dz1 = 0.5;\n        dz2 = 0.5;\n      }\n      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +\n              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);\n    }`},Bp=(e,t,r,o,i,u)=>{let a=e.dims,c=Cp(u,t.axes,a.length),p=Ap(a,o,i,t.axes),h=o.slice();o.length===0&&(h=a.map((x,E)=>x===0?1:p[E]/x),t.keepAspectRatioPolicy!=="stretch"&&(p=Ip(a,h,t)));let d=j("output",e.dataType,p.length),y=U("input",e.dataType,a.length),w=M.size(p),_=a.length===p.length&&a.every((x,E)=>x===p[E]),v=t.coordinateTransformMode==="tf_crop_and_resize",S=t.extrapolationValue,A=y.type.value,I=x=>`\n      ${_?"":`\n      ${Sp(t.coordinateTransformMode,A)};\n      ${(()=>{switch(t.mode){case"nearest":return`\n              ${Pp(y,a)};\n              ${xp(t.nearestMode,r,A)};\n              ${Ep(y,d,a,p,h.length,c.length,v)};\n              `;case"linear":return`\n              ${Tp(d,a,p,h.length,c.length)};\n              ${(()=>{if(a.length===2||a.length===4)return`${kp(y,d,a,v,S)}`;if(a.length===3||a.length===5)return`${Rp(y,d,a,v,S)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};\n            `;case"cubic":return`\n            ${(()=>{if(a.length===2||a.length===4)return`${Op(y,d,a,p,h,c,t.cubicCoeffA,v,t.extrapolationValue,t.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};\n            `;default:throw Error("Invalid resize mode")}})()};\n      `}\n      ${x.registerUniform("output_size","u32").registerUniform("scales","f32",h.length).registerUniform("roi","f32",c.length).declareVariables(y,d)}\n      ${x.mainStart()}\n        ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n        ${_?"output[global_idx] = input[global_idx];":`\n        let output_indices = ${d.offsetToIndices("global_idx")};\n        var input_indices: ${y.type.indices};\n        ${(()=>{switch(t.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);\n                if (checkInputIndices(input_indices)) {\n                  output[global_idx] = ${y.getByIndices("input_indices")};\n                } else {\n                  output[global_idx] = ${t.extrapolationValue};\n                }`;case"linear":return`output[global_idx] = ${a.length===2||a.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${t.mode}`)}})()};\n`}\n      }`;return{name:"Resize",shaderCache:{hint:`${t.cacheKey}|${r}|${h.length>0?h:""}|${i.length>0?i:""}|${c.length>0?c:""}|${_}|${a}`,inputDependencies:["rank"]},getShaderSource:I,getRunData:()=>({outputs:[{dims:p,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(w/64)},programUniforms:[{type:12,data:w},{type:1,data:h},{type:1,data:c},...Z(a,p)]})}},Dp=e=>{let t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0]},hd=(e,t)=>{let r=[],o=[],i=[],u=Dp(e);if(t.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");_p(e.inputs,t,u,r,o,i),e.compute(Bp(e.inputs[0],t,u,r,o,i),{inputs:[0]})},gd=e=>{let t=e.antialias,r=e.axes,o=e.coordinateTransformMode,i=e.cubicCoeffA,u=e.excludeOutside!==0,a=e.extrapolationValue,c=e.keepAspectRatioPolicy,p=e.mode,h=e.nearestMode===""?"simple":e.nearestMode;return ve({antialias:t,axes:r,coordinateTransformMode:o,cubicCoeffA:i,excludeOutside:u,extrapolationValue:a,keepAspectRatioPolicy:c,mode:p,nearestMode:h})}});var zp,Mp,bd,wd=Y(()=>{"use strict";ye();Se();Ze();_e();zp=(e,t)=>{let[r,o,i,u]=e,{numHeads:a,rotaryEmbeddingDim:c}=t;if(r.dims.length!==3&&r.dims.length!==4)throw new Error(`Input \'x\' is expected to have 3 or 4 dimensions, got ${r.dims.length}`);if(!M.areEqual(o.dims,[])&&!M.areEqual(o.dims,[1])&&o.dims.length!==2)throw new Error(`Input \'position_ids\' is expected to have 0, 1, or 2 dimensions, got ${o.dims.length}`);if(i.dims.length!==2)throw new Error(`Input \'cos_cache\' is expected to have 2 dimensions, got ${i.dims.length}`);if(u.dims.length!==2)throw new Error(`Input \'sin_cache\' is expected to have 2 dimensions, got ${u.dims.length}`);if(!M.areEqual(i.dims,u.dims))throw new Error("Inputs \'cos_cache\' and \'sin_cache\' are expected to have the same shape");if(c>0&&a===0)throw new Error("num_heads must be provided if rotary_embedding_dim is specified");let p=r.dims[0],h=r.dims[r.dims.length-2],d=i.dims[0],y=M.sizeFromDimension(r.dims,1)/h,w=c===0?i.dims[1]*2:y/a;if(c>w)throw new Error("rotary_embedding_dim must be less than or equal to head_size");if(o.dims.length===2){if(p!==o.dims[0])throw new Error(`Input \'position_ids\' dimension 0 should be of size batch_size, got ${o.dims[0]}`);if(h!==o.dims[1])throw new Error(`Input \'position_ids\' dimension 1 should be of size sequence_length, got ${o.dims[1]}`)}if(w/2!==i.dims[1]&&c/2!==i.dims[1])throw new Error(`Input \'cos_cache\' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ${i.dims[1]}`);if(h>d)throw new Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},Mp=(e,t)=>{let{interleaved:r,numHeads:o,rotaryEmbeddingDim:i,scale:u}=t,a=e[0].dims[0],c=M.sizeFromDimension(e[0].dims,1),p=e[0].dims[e[0].dims.length-2],h=c/p,d=e[2].dims[1],y=i===0?d*2:h/o,w=new Array(a,p,h/y,y-d),_=M.computeStrides(w),v=[{type:1,data:u},{type:12,data:w},{type:12,data:_},...e[0].dims.length===3?new Array({type:12,data:[c,h,y,1]}):[],...e[0].dims.length===4?new Array({type:12,data:[c,y,p*y,1]}):[],...Z(e[0].dims,e[1].dims,e[2].dims,e[3].dims,e[0].dims)],S=A=>{let I=U("input",e[0].dataType,e[0].dims.length),x=U("position_ids",e[1].dataType,e[1].dims.length),E=U("cos_cache",e[2].dataType,e[2].dims.length),P=U("sin_cache",e[3].dataType,e[3].dims.length),O=j("output",e[0].dataType,e[0].dims.length);return A.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:w.length},{name:"global_strides",type:"u32",length:_.length},{name:"input_output_strides",type:"u32",length:_.length}]),`\n        ${A.declareVariables(I,x,E,P,O)}\n\n        ${A.mainStart(or)}\n          let half_rotary_emb_dim = uniforms.${E.name}_shape[1];\n          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;\n          let size = uniforms.global_shape[0] * uniforms.global_strides[0];\n          ${A.guardAgainstOutOfBoundsWorkgroupSizes("size")}\n\n          if (bsnh[3] < half_rotary_emb_dim) {\n            let position_ids_idx =\n                ${x.broadcastedIndicesToOffset("bsnh.xy",j("",x.type.tensor,2))};\n            let position_id =\n                u32(${x.getByOffset("position_ids_idx")}) + select(0, bsnh[1], position_ids_idx == 0);\n            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ${r});\n            let j = i + select(half_rotary_emb_dim, 1, ${r});\n            let re = ${I.getByOffset("i")} * ${E.get("position_id","bsnh[3]")} -\n                ${I.getByOffset("j")} * ${P.get("position_id","bsnh[3]")};\n            ${O.setByOffset("i","re")}\n            let im = ${I.getByOffset("i")} * ${P.get("position_id","bsnh[3]")} +\n                ${I.getByOffset("j")} * ${E.get("position_id","bsnh[3]")};\n            ${O.setByOffset("j","im")}\n          } else {\n            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;\n            ${O.setByOffset("k",I.getByOffset("k"))}\n          }\n        }`};return{name:"RotaryEmbedding",shaderCache:{hint:ve({interleaved:r}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:S,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(M.size(w)/or)},programUniforms:v})}},bd=(e,t)=>{zp(e.inputs,t),e.compute(Mp(e.inputs,t))}});var Up,Vp,vd,$d=Y(()=>{"use strict";ye();Se();_e();Up=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let t=e[0],r=e[1],o=e[2];if(t.dataType!==r.dataType||t.dataType!==o.dataType)throw new Error("All inputs must have the same data type");if(t.dims.length!==3&&t.dims.length!==2)throw new Error("Input must be 2D or 3D");if(r.dims.length!==3&&r.dims.length!==2)throw new Error("Skip must be 2D or 3D");let i=t.dims[t.dims.length-1],u=t.dims[t.dims.length-2];if(r.dims[r.dims.length-1]!==i)throw new Error("Skip must have the same hidden size as input");if(r.dims[r.dims.length-2]!==u)throw new Error("Skip must have the same sequence length as input");if(o.dims.length!==1)throw new Error("Gamma must be 1D");if(o.dims[o.dims.length-1]!==i)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let a=e[3];if(a.dims.length!==1)throw new Error("Beta must be 1D");if(a.dims[a.dims.length-1]!==i)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let a=e[4];if(a.dims.length!==1)throw new Error("Bias must be 1D");if(a.dims[a.dims.length-1]!==i)throw new Error("Bias must have the same hidden size as input")}},Vp=(e,t,r,o)=>{let i=t.simplified,u=e[0].dims,a=M.size(u),c=u,p=a,h=u.slice(-1)[0],d=o?u.slice(0,-1).concat(1):[],y=!i&&e.length>3,w=e.length>4,_=o&&r>1,v=o&&r>2,S=r>3,A=Me(h),I=[{type:12,data:p},{type:12,data:A},{type:12,data:h},{type:1,data:t.epsilon}],x=P=>{let O=[{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}],R=[U("x",e[0].dataType,e[0].dims,A),U("skip",e[1].dataType,e[1].dims,A),U("gamma",e[2].dataType,e[2].dims,A)];y&&R.push(U("beta",e[3].dataType,e[3].dims,A)),w&&R.push(U("bias",e[4].dataType,e[4].dims,A)),R.push(j("output",e[0].dataType,c,A)),_&&R.push(j("mean_output",1,d)),v&&R.push(j("inv_std_output",1,d)),S&&R.push(j("input_skip_bias_sum",e[0].dataType,c,A));let L=De(e[0].dataType);return`\n\n      ${P.registerUniforms(O).declareVariables(...R)}\n\n      ${P.mainStart()}\n        ${P.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size / uniforms.hidden_size")}\n        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;\n        let offset = global_idx * hidden_size_vectorized;\n        var sum = ${$t("f32",A)};\n        var squareSum = ${$t("f32",A)};\n        for (var i: u32 = 0; i < hidden_size_vectorized; i++) {\n          let skip_value = skip[offset + i];\n          let bias_value = ${w?"bias[i]":L+"(0.0)"};\n          let input_value = x[offset + i];\n          let value = input_value + skip_value + bias_value;\n          ${S?"input_skip_bias_sum[offset + i] = value;":""}\n          output[offset + i] = value;\n          let f32_value = ${ir(L,A,"value")};\n          sum += f32_value;\n          squareSum += f32_value * f32_value;\n        }\n        let mean = ${_t("sum",A)} / f32(uniforms.hidden_size);\n        let inv_std_dev = inverseSqrt(${_t("squareSum",A)} / f32(uniforms.hidden_size) ${i?"":"- mean * mean"} + uniforms.epsilon);\n        ${_?"mean_output[global_idx] = mean;":""}\n        ${v?"inv_std_output[global_idx] = inv_std_dev;":""}\n        for (var i: u32 = 0; i < hidden_size_vectorized; i++) {\n          output[offset + i] = (output[offset + i] ${i?"":`- ${L}(mean)`}) * ${L}(inv_std_dev) * gamma[i] ${y?"+ beta[i]":""};\n        }\n      }`},E=[{dims:c,dataType:e[0].dataType}];return r>1&&E.push({dims:d,dataType:1}),r>2&&E.push({dims:d,dataType:1}),r>3&&E.push({dims:u,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:`${A};${_};${v};${S}`,inputDependencies:e.map((P,O)=>"type")},getShaderSource:x,getRunData:()=>({outputs:E,dispatchGroup:{x:Math.ceil(p/h/64)},programUniforms:I})}},vd=(e,t)=>{Up(e.inputs);let o=[0];e.outputCount>1&&o.push(-3),e.outputCount>2&&o.push(-3),e.outputCount>3&&o.push(3),e.compute(Vp(e.inputs,t,e.outputCount,!1),{outputs:o})}});var Wp,Gn,Np,_d,Gp,Hp,Sd,xd,Cd=Y(()=>{"use strict";ye();Se();Ze();_e();Wp=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");if(t.axes.length!==0){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(t.starts.length!==t.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach((r,o)=>{if(e[o+1].dataType!==6&&e[o+1].dataType!==7)throw new Error(`Input ${o} must be an array of int32 or int64`)})},Gn=(e,t)=>{let r=[];if(e.length>t)if(e[t].dataType===7)e[t].getBigInt64Array().forEach(o=>r.push(Number(o)));else if(e[t].dataType===6)e[t].getInt32Array().forEach(o=>r.push(Number(o)));else throw new Error(`Input ${t} must be an array of int32 or int64`);return r},Np=(e,t)=>{if(e.length>1){let r=Gn(e,1),o=Gn(e,2),i=Gn(e,3);return i.length===0&&(i=[...Array(e[0].dims.length).keys()]),ve({starts:r,ends:o,axes:i})}else return t},_d=(e,t,r,o,i)=>{let u=e;return e<0&&(u+=r[o[t]]),i[t]<0?Math.max(0,Math.min(u,r[o[t]]-1)):Math.max(0,Math.min(u,r[o[t]]))},Gp=(e,t,r)=>`fn calculateInputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {\n          var input_indices: ${e.type.indices};\n          var carry = 0u;\n          for (var i = ${r.length}; i >= 0; i--) {\n            let input_shape_i = ${fe("uniforms.input_shape","i",r.length)};\n            let steps_i = ${fe("uniforms.steps","i",r.length)};\n            let signs_i = ${fe("uniforms.signs","i",r.length)};\n            let starts_i = ${fe("uniforms.starts","i",r.length)};\n            var output_index = ${t.indicesGet("output_indices","i")};\n            var input_index = output_index * steps_i + starts_i + carry;\n            carry = input_index / input_shape_i;\n            input_index = input_index % input_shape_i;\n            if (signs_i < 0) {\n              input_index = input_shape_i - input_index - 1u + starts_i;\n            }\n            ${e.indicesSet("input_indices","i","input_index")};\n          }\n          return input_indices;\n      }`,Hp=(e,t)=>{let r=e[0].dims,o=M.size(r),i=t.axes.length>0?M.normalizeAxes(t.axes,r.length):[...Array(r.length).keys()],u=Gn(e,4);u.forEach(I=>I!==0||(()=>{throw new Error("step cannot be 0")})),u.length===0&&(u=Array(i.length).fill(1));let a=t.starts.map((I,x)=>_d(I,x,r,i,u)),c=t.ends.map((I,x)=>_d(I,x,r,i,u));if(i.length!==a.length||i.length!==c.length)throw new Error("start, ends and axes should have the same number of elements");if(i.length!==r.length)for(let I=0;I<r.length;++I)i.includes(I)||(a.splice(I,0,0),c.splice(I,0,r[I]),u.splice(I,0,1));let p=u.map(I=>Math.sign(I));u.forEach((I,x,E)=>{if(I<0){let P=(c[x]-a[x])/I,O=a[x],R=O+P*u[x];a[x]=R,c[x]=O,E[x]=-I}});let h=r.slice(0);i.forEach((I,x)=>{h[I]=Math.ceil((c[I]-a[I])/u[I])});let d={dims:h,dataType:e[0].dataType},y=j("output",e[0].dataType,h.length),w=U("input",e[0].dataType,e[0].dims.length),_=M.size(h),v=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:a.length},{name:"signs",type:"i32",length:p.length},{name:"steps",type:"u32",length:u.length}],S=[{type:12,data:_},{type:12,data:a},{type:6,data:p},{type:12,data:u},...Z(e[0].dims,h)],A=I=>`\n      ${I.registerUniforms(v).declareVariables(w,y)}\n        ${Gp(w,y,r)}\n        ${I.mainStart()}\n          ${I.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n          let output_indices = ${y.offsetToIndices("global_idx")};\n          let input_indices = calculateInputIndices(output_indices);\n          ${y.setByOffset("global_idx",w.getByIndices("input_indices"))}\n      }`;return{name:"Slice",shaderCache:{hint:`${p.length}_${a.length}_${u.length}`,inputDependencies:["rank"]},getShaderSource:A,getRunData:()=>({outputs:[d],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:S})}},Sd=(e,t)=>{Wp(e.inputs,t);let r=Np(e.inputs,t);e.compute(Hp(e.inputs,r),{inputs:[0]})},xd=e=>{let t=e.starts,r=e.ends,o=e.axes;return ve({starts:t,ends:r,axes:o})}});var Lp,Fp,Ad,Id,Td=Y(()=>{"use strict";ye();Se();Ze();_e();Lp=e=>{if(!e||e.length!==1)throw new Error("Softmax op requires 1 input.")},Fp=(e,t)=>{let r=e.dims,o=M.size(r),i=64,u=t.axis;if(u<0&&(u=r.length+u),u<r.length-1)throw new Error("softmax only supports last axis for now.");let a=r[u],c=o/a,p=Me(a),h=a/p,d=(A,I)=>I===4?`max(max(${A}.x, ${A}.y), max(${A}.z, ${A}.w))`:I===2?`max(${A}.x, ${A}.y)`:I===3?`max(max(${A}.x, ${A}.y), ${A}.z)`:A,y=U("x",e.dataType,e.dims,p),w=j("result",e.dataType,e.dims,p),_=y.type.value,v=De(e.dataType)==="f32"?`var threadMax = ${_}(-3.402823e+38f);`:`var threadMax = ${_}(-65504.0h);`,S=A=>`\n      var<workgroup> rowMaxShared : ${_};\n      var<workgroup> rowSumShared : ${_};\n      var<workgroup> threadShared : array<${_}, ${i}>;\n\n      fn getValue(row: i32, col: i32, row_stride: i32) -> ${_} {\n        let index = row * row_stride + col;\n        return x[index];\n      }\n\n      fn setValue(row: i32, col: i32, row_stride: i32, value: ${_}) {\n        let index = row * row_stride + col;\n        result[index] = value;\n      }\n      ${A.registerUniform("packedCols","i32").declareVariables(y,w)}\n      ${A.mainStart()}\n        let gindex = i32(global_idx);\n        let lindex = i32(local_idx);\n        const wg = ${i};\n        let row = gindex / wg;\n        let cols = uniforms.packedCols;\n        let row_stride : i32 = uniforms.packedCols;\n\n        // find the rows max\n        ${v}\n        for (var col = lindex; col < cols; col += wg) {\n          let value = getValue(row, col, row_stride);\n          threadMax = max(threadMax, value);\n        }\n        if (lindex < cols) {\n          threadShared[lindex] = threadMax;\n        }\n        workgroupBarrier();\n\n        var reduceSize = min(cols, wg);\n        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {\n          reduceSize = currSize + (reduceSize & 1);\n          if (lindex < currSize) {\n            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowMaxShared = ${_}(${d("threadShared[0]",p)});\n        }\n        workgroupBarrier();\n\n        // find the rows sum\n        var threadSum = ${_}(0.0);\n        for (var col = lindex; col < cols; col += wg) {\n          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);\n          threadSum += subExp;\n        }\n        threadShared[lindex] = threadSum;\n        workgroupBarrier();\n\n        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {\n          if (lindex < currSize) {\n            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowSumShared = ${_}(${_t("threadShared[0]",p)});\n        }\n        workgroupBarrier();\n\n        // calculate final value for each element in the row\n        for (var col = lindex; col < cols; col += wg) {\n          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;\n          setValue(row, col, row_stride, value);\n        }\n      }`;return{name:"Softmax",shaderCache:{hint:`${p}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.dataType}],dispatchGroup:{x:c},programUniforms:[{type:6,data:h}]}),getShaderSource:S}},Ad=(e,t)=>{Lp(e.inputs),e.compute(Fp(e.inputs[0],t))},Id=e=>ve({axis:e.axis})});var qp,jp,Kp,Yp,Zp,Ed,Pd,kd=Y(()=>{"use strict";ye();Se();Ze();_e();qp=e=>{if(!e||e.length<1)throw new Error("too few inputs")},jp=(e,t)=>{let r=[],o=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach(i=>r.push(Number(i))),o=r.length),ve({numOutputs:o,axis:t.axis,splitSizes:r})},Kp=e=>`\nfn calculateOutputIndex(index: u32) -> u32 {\n    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {\n    if (index < ${fe("uniforms.size_in_split_axis","i",e)}) {\n        return i;\n    }\n    }\n    return ${e}u;\n}`,Yp=e=>{let t=e.length,r=[];for(let o=0;o<t;++o){let i=e[o].setByIndices("indices","input[global_idx]");t===1?r.push(i):o===0?r.push(`if (output_number == ${o}u) { ${i} }`):o===t-1?r.push(`else { ${i} }`):r.push(`else if (output_number == ${o}) { ${i} }`)}return`\n      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {\n        ${r.join(`\n`)}\n      }`},Zp=(e,t)=>{let r=e[0].dims,o=M.size(r),i=e[0].dataType,u=M.normalizeAxis(t.axis,r.length),a=new Array(t.numOutputs),c=U("input",i,r.length),p=new Array(t.numOutputs),h=[],d=[],y=0,w=[{type:12,data:o}];for(let v=0;v<t.numOutputs;v++){y+=t.splitSizes[v],p[v]=y;let S=r.slice();S[t.axis]=t.splitSizes[v],d.push(S),a[v]=j(`output${v}`,i,S.length),h.push({dims:d[v],dataType:e[0].dataType})}w.push({type:12,data:p},...Z(r,...d));let _=v=>`\n  ${v.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",p.length).declareVariables(c,...a)}\n  ${Kp(p.length)}\n  ${Yp(a)}\n\n  ${v.mainStart()}\n    ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}\n\n    var indices = ${c.offsetToIndices("global_idx")};\n    var index = ${c.indicesGet("indices",u)};\n    let output_number = calculateOutputIndex(index);\n    if (output_number != 0) {\n      index -= ${fe("uniforms.size_in_split_axis","output_number - 1u",p.length)};\n      ${c.indicesSet("indices",u,"index")};\n    }\n    writeBufferData(output_number, indices, global_idx);\n  }`;return{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:_,getRunData:()=>({outputs:h,dispatchGroup:{x:Math.ceil(o/64)},programUniforms:w})}},Ed=(e,t)=>{qp(e.inputs);let r=e.inputs.length===1?t:jp(e.inputs,t);e.compute(Zp(e.inputs,r),{inputs:[0]})},Pd=e=>{let t=e.axis,r=e.splitSizes,o=e.numOutputs<0?r.length:e.numOutputs;if(o!==r.length)throw new Error("numOutputs and splitSizes lengh must be equal");return ve({axis:t,numOutputs:o,splitSizes:r})}});var Od,Xp,Qp,Jp,Rd,Bd=Y(()=>{"use strict";ye();Se();_e();Od=e=>Array.from(e.getBigInt64Array(),Number),Xp=e=>{if(!e||e.length!==2)throw new Error("Tile requires 2 inputs.");if(e[0].dataType!==1&&e[0].dataType!==6&&e[0].dataType!==12)throw new Error("Tile only support float, int32, and uint32 data types");if(e[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(e[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(Od(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},Qp=(e,t)=>{let r=[];for(let o=0;o<e.length;++o)r.push(e[o]*t[o]);return r},Jp=e=>{let t=e[0].dims,r=Od(e[1]),o=Qp(t,r),i=M.size(o),u=e[0].dataType,a=U("input",u,t.length),c=j("output",u,o.length),p=h=>`\n      const inputShape = ${a.indices(...t)};\n      ${h.registerUniform("output_size","u32").declareVariables(a,c)}\n      ${h.mainStart()}\n      ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n      let output_indices = ${c.offsetToIndices("global_idx")};\n      var input_indices: ${a.type.indices};\n      for (var i = 0; i < ${t.length}; i++) {\n        let input_dim_i = ${a.indicesGet("uniforms.input_shape","i")};\n        let input_dim_value = ${c.indicesGet("output_indices","i")}  % input_dim_i;\n\n        ${a.indicesSet("input_indices","i","input_dim_value")}\n      }\n      ${c.setByOffset("global_idx",a.getByIndices("input_indices"))}\n    }`;return{name:"Tile",shaderCache:{hint:`${r}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:12,data:i},...Z(e[0].dims,o)]}),getShaderSource:p}},Rd=e=>{Xp(e.inputs),e.compute(Jp(e.inputs),{inputs:[0]})}});var em,tm,Dd,zd=Y(()=>{"use strict";ye();Se();_e();em=(e,t,r,o,i)=>{let u=j("output_data",i,r.length,4),a=U("a_data",t[1].dataType,t[1].dims.length,4),c=U("b_data",t[2].dataType,t[2].dims.length,4),p=U("c_data",t[0].dataType,t[0].dims.length,4),h,d=(y,w,_)=>`select(${w}, ${y}, ${_})`;if(!o)h=u.setByOffset("global_idx",d(a.getByOffset("global_idx"),c.getByOffset("global_idx"),p.getByOffset("global_idx")));else{let y=(w,_,v="")=>{let S=`a_data[index_a${_}][component_a${_}]`,A=`b_data[index_b${_}][component_b${_}]`,I=`bool(c_data[index_c${_}] & (0xffu << (component_c${_} * 8)))`;return`\n            let output_indices${_} = ${u.offsetToIndices(`global_idx * 4u + ${_}u`)};\n            let offset_a${_} = ${a.broadcastedIndicesToOffset(`output_indices${_}`,u)};\n            let offset_b${_} = ${c.broadcastedIndicesToOffset(`output_indices${_}`,u)};\n            let offset_c${_} = ${p.broadcastedIndicesToOffset(`output_indices${_}`,u)};\n            let index_a${_} = offset_a${_} / 4u;\n            let index_b${_} = offset_b${_} / 4u;\n            let index_c${_} = offset_c${_} / 4u;\n            let component_a${_} = offset_a${_} % 4u;\n            let component_b${_} = offset_b${_} % 4u;\n            let component_c${_} = offset_c${_} % 4u;\n            ${w}[${_}] = ${v}(${d(S,A,I)});\n          `};i===9?h=`\n            var data = vec4<u32>(0);\n            ${y("data",0,"u32")}\n            ${y("data",1,"u32")}\n            ${y("data",2,"u32")}\n            ${y("data",3,"u32")}\n            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:h=`\n            ${y("output_data[global_idx]",0)}\n            ${y("output_data[global_idx]",1)}\n            ${y("output_data[global_idx]",2)}\n            ${y("output_data[global_idx]",3)}\n          `}return`\n        ${e.registerUniform("vec_size","u32").declareVariables(p,a,c,u)}\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n        ${h}\n      }`},tm=e=>{let t=e[1].dims,r=e[2].dims,o=e[0].dims,i=e[1].dataType,u=!(M.areEqual(t,r)&&M.areEqual(r,o)),a=t,c=M.size(t);if(u){let h=It.calcShape(It.calcShape(t,r,!1),o,!1);if(!h)throw new Error("Can\'t perform where op on the given tensors");a=h,c=M.size(a)}let p=Math.ceil(c/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:h=>em(h,e,a,u,i),getRunData:()=>({outputs:[{dims:a,dataType:i}],dispatchGroup:{x:Math.ceil(c/64/4)},programUniforms:[{type:12,data:p},...Z(o,t,r,a)]})}},Dd=e=>{e.compute(tm(e.inputs))}});var Md,Ud=Y(()=>{"use strict";Ka();Ro();Ja();ts();Vs();Zs();Oo();Uo();lu();mu();gu();$u();xu();Au();Eu();Ou();Du();Mu();Vu();Wo();Gu();qu();Ku();cd();md();In();yd();wd();$d();Cd();Td();kd();Bd();Sr();Rn();zd();Md=new Map([["Abs",[rs]],["Acos",[ns]],["Acosh",[os]],["Add",[Ws]],["ArgMax",[ja,ko]],["ArgMin",[qa,ko]],["Asin",[is]],["Asinh",[as]],["Atan",[ss]],["Atanh",[us]],["Attention",[Xa]],["AveragePool",[rd,td]],["BatchNormalization",[Qa]],["BiasAdd",[es]],["BiasSplitGelu",[Us]],["Cast",[ls,ds]],["Ceil",[ps]],["Clip",[cs]],["Concat",[Ya,Za]],["Conv",[Ho,Go]],["ConvTranspose",[du,uu]],["Cos",[ms]],["Cosh",[fs]],["CumSum",[cu,pu]],["DepthToSpace",[fu,hu]],["Div",[Ns]],["Einsum",[wu,vu]],["Elu",[hs,kn]],["Equal",[Gs]],["Erf",[gs]],["Exp",[ys]],["Expand",[Su]],["FastGelu",[Cu]],["Floor",[bs]],["FusedConv",[Ho,Go]],["Gather",[Tu,Iu]],["GatherElements",[ku,Pu]],["Gelu",[ws]],["Gemm",[Bu,Ru]],["GlobalAveragePool",[id,od]],["GlobalMaxPool",[ld,dd]],["Greater",[qs]],["GreaterOrEqual",[Ks]],["HardSigmoid",[Is,As]],["InstanceNormalization",[zu]],["LayerNormalization",[Uu]],["LeakyRelu",[vs,kn]],["Less",[js]],["LessOrEqual",[Ys]],["Log",[zs]],["MatMul",[ru]],["MatMulNBits",[Wu,Nu]],["MaxPool",[sd,ud]],["Mul",[Hs]],["MultiHeadAttention",[Fu,Lu]],["Neg",[_s]],["Not",[$s]],["Pad",[ju]],["Pow",[Ls]],["Range",[pd]],["Reciprocal",[Ss]],["ReduceMin",[Wa]],["ReduceMean",[Da]],["ReduceMax",[Va]],["ReduceSum",[Ga]],["ReduceProd",[Na]],["ReduceL1",[za]],["ReduceL2",[Ma]],["ReduceLogSum",[La]],["ReduceLogSumExp",[Ua]],["ReduceSumSquare",[Ha]],["Relu",[xs]],["Resize",[hd,gd]],["RotaryEmbedding",[bd]],["Sigmoid",[Cs]],["Sin",[Ts]],["Sinh",[Es]],["Slice",[Sd,xd]],["SkipLayerNormalization",[vd]],["Split",[Ed,Pd]],["Sqrt",[Ps]],["Softmax",[Ad,Id]],["Sub",[Fs]],["Tan",[ks]],["Tanh",[Rs]],["ThresholdedRelu",[Ds,kn]],["Tile",[Rd]],["Transpose",[_a,Sa]],["Where",[Dd]]])});var Hn,Vd=Y(()=>{"use strict";$r();Lt();_e();Hn=class{constructor(t){this.backend=t;this.repo=new Map,this.attributesBound=!1}getArtifact(t){return this.repo.get(t)}setArtifact(t,r){this.repo.set(t,r)}run(t,r,o,i,u){rr(t.programInfo.name);let a=this.backend.device,c=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2);let p=[];for(let d of r)p.push({binding:p.length,resource:{buffer:d.buffer}});for(let d of o)p.push({binding:p.length,resource:{buffer:d.buffer}});u&&p.push({binding:p.length,resource:u});let h=a.createBindGroup({layout:t.computePipeline.getBindGroupLayout(0),entries:p,label:t.programInfo.name});if(this.backend.sessionStatus==="capturing"){let d={kernelId:this.backend.currentKernelId,computePipeline:t.computePipeline,bindGroup:h,dispatchGroup:i};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(d)}c.setPipeline(t.computePipeline),c.setBindGroup(0,h),c.dispatchWorkgroups(...i),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),Ht(t.programInfo.name)}dispose(){}build(t,r){rr(t.name);let o=this.backend.device,i=[];o.features.has("shader-f16")&&i.push("enable f16;");let u=va(r,this.backend.device.limits),a=t.getShaderSource(u),c=`${i.join(`\n`)}\n${u.additionalImplementations}\n${a}`,p=o.createShaderModule({code:c,label:t.name});Ve("verbose",()=>`[WebGPU] ${t.name} shader code: ${c}`);let h=o.createComputePipeline({compute:{module:p,entryPoint:"main"},layout:"auto",label:t.name});return Ht(t.name),{programInfo:t,computePipeline:h,uniformVariablesInfo:u.variablesInfo}}normalizeDispatchGroupSize(t){let r=typeof t=="number"?t:t.x,o=typeof t=="number"?1:t.y||1,i=typeof t=="number"?1:t.z||1,u=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(r<=u&&o<=u&&i<=u)return[r,o,i];let a=r*o*i,c=Math.ceil(Math.sqrt(a));if(c>u){if(c=Math.ceil(Math.cbrt(a)),c>u)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[c,c,c]}else return[c,c,1]}}});var rm,nm,Yo,Ln,Wd=Y(()=>{"use strict";$r();ye();Lt();fa();wa();Ud();Vd();rm=(e,t)=>{if(t.length!==e.length)throw new Error(`inputDependencies length ${t.length} is not equal to inputTensors length ${e.length}.`);let r=[];for(let o=0;o<e.length;++o){let i=e[o].dataType;switch(t[o]){case"none":{r.push("");break}case"type":{r.push(`${i}`);break}case"rank":{let u=e[o].dims.length;r.push(`${i};${u}`);break}case"dims":{let u=e[o].dims.join(",");r.push(`${i};${u}`);break}default:throw new Error(`unsupported input dependency: ${t[o]}`)}}return r.join("|")},nm=(e,t,r)=>{let o=e.name;return e.shaderCache?.hint&&(o+="["+e.shaderCache.hint+"]"),o+=":"+r+`:${rm(t,e.shaderCache?.inputDependencies??new Array(t.length).fill("dims"))}`,o},Yo=class{constructor(t){t&&(this.architecture=t.architecture,this.vendor=t.vendor)}isArchitecture(t){return this.architecture===t}isVendor(t){return this.vendor===t}},Ln=class{constructor(){this.currentSessionId=null;this.currentKernelId=null;this.commandEncoder=null;this.computePassEncoder=null;this.maxDispatchNumber=16;this.pendingDispatchNumber=0;this.pendingKernels=[];this.pendingQueries=new Map;this.sessionStatus="default";this.capturedCommandList=new Map;this.capturedPendingKernels=new Map;this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let t=this.kernelCustomData.get(this.currentKernelId);return t||(t={},this.kernelCustomData.set(this.currentKernelId,t)),t}async initialize(t,r){this.env=t;let o=[],i={requiredLimits:{maxComputeWorkgroupStorageSize:r.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:r.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:r.limits.maxStorageBufferBindingSize,maxBufferSize:r.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:r.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:r.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:r.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:r.limits.maxComputeWorkgroupSizeZ},requiredFeatures:o};r.features.has("chromium-experimental-timestamp-query-inside-passes")?o.push("chromium-experimental-timestamp-query-inside-passes"):r.features.has("timestamp-query")&&o.push("timestamp-query"),r.features.has("shader-f16")&&o.push("shader-f16"),this.device=await r.requestDevice(i),this.adapterInfo=new Yo(await r.requestAdapterInfo()),this.gpuDataManager=ba(this),this.programManager=new Hn(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,pa(t.logLevel,!!t.debug),this.device.onuncapturederror=u=>{u.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${u.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:r,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let t=this.getCommandEncoder(),r={};this.queryType==="at-passes"&&(r.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=t.beginComputePass(r)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;rr(),this.endComputePass();let t;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),t=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(t,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,t,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&t.mapAsync(GPUMapMode.READ).then(()=>{let r=new BigUint64Array(t.getMappedRange()),o=this.pendingQueries.get(t);for(let i=0;i<r.length/2;i++){let u=o[i],a=u.kernelId,c=this.kernels.get(a),p=c.kernelType,h=c.kernelName,d=u.programName,y=u.inputTensorViews,w=u.outputTensorViews,_=r[i*2],v=r[i*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=_);let S=Number(_-this.queryTimeBase),A=Number(v-this.queryTimeBase);if(!Number.isSafeInteger(S)||!Number.isSafeInteger(A))throw new RangeError("incorrect timestamp range");if(this.env.webgpu.profiling?.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:y.map(I=>({dims:I.dims,dataType:Gt(I.dataType)})),outputsMetadata:w.map(I=>({dims:I.dims,dataType:Gt(I.dataType)})),kernelId:a,kernelType:p,kernelName:h,programName:d,startTime:S,endTime:A});else{let I="";y.forEach((E,P)=>{I+=`input[${P}]: [${E.dims}] | ${Gt(E.dataType)}, `});let x="";w.forEach((E,P)=>{x+=`output[${P}]: [${E.dims}] | ${Gt(E.dataType)}, `}),console.log(`[profiling] kernel "${a}|${p}|${h}|${d}" ${I}${x}execution time: ${A-S} ns`)}wo("GPU",`${d}::${_}::${v}`)}t.unmap(),this.pendingQueries.delete(t)}),Ht()}run(t,r,o,i,u,a){rr(t.name);let c=[];for(let E=0;E<r.length;++E){let P=r[E].data;if(P===0)continue;let O=this.gpuDataManager.get(P);if(!O)throw new Error(`no GPU data for input: ${P}`);c.push(O)}let{outputs:p,dispatchGroup:h,programUniforms:d}=t.getRunData(r),y=o.length===0?p.map((E,P)=>P):o;if(y.length!==p.length)throw new Error(`Output size ${y.length} must be equal to ${p.length}.`);let w=[],_=[];for(let E=0;E<p.length;++E){if(!Number.isInteger(y[E])||y[E]<-3||y[E]>=a)throw new Error(`Invalid output index: ${y[E]}`);if(y[E]===-3)continue;let P=y[E]===-1,O=y[E]===-2,R=P||O?u(p[E].dataType,p[E].dims):i(y[E],p[E].dataType,p[E].dims);if(w.push(R),R.data===0)continue;let L=this.gpuDataManager.get(R.data);if(!L)throw new Error(`no GPU data for output: ${R.data}`);if(P&&this.temporaryData.push(L),O){let N=this.kernelPersistentData.get(this.currentKernelId);N||(N=[],this.kernelPersistentData.set(this.currentKernelId,N)),N.push(L)}_.push(L)}if(c.length!==r.length||_.length!==w.length){if(_.length===0)return Ht(t.name),w;throw new Error(`Program ${t.name} has zero-sized tensor(s) in inputs or outputs. This is not supported now.`)}let v;if(d){let E=0,P=[];d.forEach(N=>{let K=typeof N.data=="number"?[N.data]:N.data;if(K.length===0)return;let Q=N.type===10?2:4,he,W;N.type===10?(W=K.length>4?16:K.length>2?8:K.length*Q,he=K.length>4?16:Q*K.length):(W=K.length<=2?K.length*Q:16,he=16),E=Math.ceil(E/W)*W,P.push(E);let se=N.type===10?8:4;E+=K.length>4?Math.ceil(K.length/se)*he:K.length*Q});let O=16;E=Math.ceil(E/O)*O;let R=new ArrayBuffer(E);d.forEach((N,K)=>{let Q=P[K],he=typeof N.data=="number"?[N.data]:N.data;if(N.type===6)new Int32Array(R,Q,he.length).set(he);else if(N.type===12)new Uint32Array(R,Q,he.length).set(he);else if(N.type===10)new Uint16Array(R,Q,he.length).set(he);else if(N.type===1)new Float32Array(R,Q,he.length).set(he);else throw new Error(`Unsupported uniform type: ${Gt(N.type)}`)});let L=this.gpuDataManager.create(E,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(L.buffer,0,R,0,E),this.gpuDataManager.release(L.id),v={offset:0,size:E,buffer:L.buffer}}let S=this.programManager.normalizeDispatchGroupSize(h),A=S[1]===1&&S[2]===1,I=nm(t,r,A),x=this.programManager.getArtifact(I);if(x||(x=this.programManager.build(t,S),this.programManager.setArtifact(I,x),Ve("info",()=>`[artifact] key: ${I}, programName: ${t.name}`)),d&&x.uniformVariablesInfo){if(d.length!==x.uniformVariablesInfo.length)throw new Error(`Uniform variables count mismatch: expect ${x.uniformVariablesInfo.length}, got ${d.length} in program "${x.programInfo.name}".`);for(let E=0;E<d.length;E++){let P=d[E],O=P.type,R=typeof P.data=="number"?1:P.data.length,[L,N]=x.uniformVariablesInfo[E];if(O!==L||R!==N)throw new Error(`Uniform variable ${E} mismatch: expect type ${L} with size ${N}, got type ${O} with size ${R} in program "${x.programInfo.name}".`)}}if(Ve("info",()=>`[ProgramManager] run "${t.name}" (key=${I}) with ${S[0]}x${S[1]}x${S[2]}`),this.queryType!=="none"||this.sessionStatus==="capturing"){let E={kernelId:this.currentKernelId,programName:x.programInfo.name,inputTensorViews:r,outputTensorViews:w};this.pendingKernels.push(E),this.sessionStatus==="capturing"&&this.capturedPendingKernels.get(this.currentSessionId).push(E)}return this.programManager.run(x,c,_,S,v),Ht(t.name),w}upload(t,r){this.gpuDataManager.upload(t,r)}memcpy(t,r){this.gpuDataManager.memcpy(t,r)}async download(t,r){await this.gpuDataManager.download(t,r)}alloc(t){return this.gpuDataManager.create(t).id}free(t){return this.gpuDataManager.release(t)}createKernel(t,r,o,i){let u=Md.get(t);if(!u)throw new Error(`kernel not implemented: ${t}`);let a={kernelType:t,kernelName:i,kernelEntry:u[0],attributes:[u[1],o]};this.kernels.set(r,a)}releaseKernel(t){let r=this.kernelPersistentData.get(t);if(r){for(let o of r)this.gpuDataManager.release(o.id);this.kernelPersistentData.delete(t)}this.kernelCustomData.delete(t),this.kernels.delete(t)}computeKernel(t,r,o){let i=this.kernels.get(t);if(!i)throw new Error(`kernel not created: ${t}`);let u=i.kernelType,a=i.kernelName,c=i.kernelEntry,p=i.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${u}] ${a}" is not allowed to be called recursively`);this.currentKernelId=t,p[0]&&(p[1]=p[0](p[1]),p[0]=void 0),Ve("info",()=>`[WebGPU] Start to run kernel "[${u}] ${a}"...`);let h=this.env.debug;this.temporaryData=[];try{return h&&this.device.pushErrorScope("validation"),c(r,p[1]),0}catch(d){return o.push(Promise.resolve(`[WebGPU] Kernel "[${u}] ${a}" failed. ${d}`)),1}finally{h&&o.push(this.device.popErrorScope().then(d=>d?`GPU validation error for kernel "[${u}] ${a}": ${d.message}`:null));for(let d of this.temporaryData)this.gpuDataManager.release(d.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(t,r,o,i){let u=this.sessionExternalDataMapping.get(t);u||(u=new Map,this.sessionExternalDataMapping.set(t,u));let a=u.get(r),c=this.gpuDataManager.registerExternalBuffer(o,i,a?.[1]);return u.set(r,[c,o]),c}unregisterBuffers(t){let r=this.sessionExternalDataMapping.get(t);r&&(r.forEach(o=>this.gpuDataManager.unregisterExternalBuffer(o[1])),this.sessionExternalDataMapping.delete(t))}getBuffer(t){let r=this.gpuDataManager.get(t);if(!r)throw new Error(`no GPU data for buffer: ${t}`);return r.buffer}createDownloader(t,r,o){return async()=>{let i=await xo(this,t,r);return ma(i.buffer,o)}}writeTimestamp(t){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,t)}setQueryType(){this.queryType="none",(this.env.webgpu.profiling?.mode==="default"||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){Ve("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){Ve("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){Ve("info","replay"),this.sessionStatus="replaying";let t=this.capturedCommandList.get(this.currentSessionId),r=this.capturedPendingKernels.get(this.currentSessionId),o=t.length;this.pendingKernels=[];for(let i=0;i<o;i++){let u=this.getComputePassEncoder(),a=t[i];this.writeTimestamp(this.pendingDispatchNumber*2),u.setPipeline(a.computePipeline),u.setBindGroup(0,a.bindGroup),u.dispatchWorkgroups(...a.dispatchGroup),this.writeTimestamp(this.pendingDispatchNumber*2+1),this.pendingDispatchNumber++,this.queryType!=="none"&&this.pendingKernels.push(r[i]),(this.pendingDispatchNumber>=this.maxDispatchNumber||this.queryType==="at-passes")&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onReleaseSession(t){this.unregisterBuffers(t),this.capturedCommandList.has(t)&&this.capturedCommandList.delete(t),this.capturedPendingKernels.has(t)&&this.capturedPendingKernels.delete(t),this.gpuDataManager.onReleaseSession(t)}onRunStart(t){this.currentSessionId=t,this.setQueryType()}}});var Nd={};gn(Nd,{init:()=>om});var qr,Zo,om,Gd=Y(()=>{"use strict";ye();Wd();Lt();Se();qr=class e{constructor(t,r,o,i){this.module=t;this.dataType=r;this.data=o;this.dims=i}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let t=M.size(this.dims);return t===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,t)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let t=M.size(this.dims);return t===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,t)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let t=M.size(this.dims);return t===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,t)}reshape(t){if(M.size(t)!==M.size(this.dims))throw new Error("Invalid new shape");return new e(this.module,this.dataType,this.data,t)}},Zo=class{constructor(t,r,o){this.module=t;this.backend=r;this.customDataOffset=0;this.customDataSize=0;this.adapterInfo=r.adapterInfo;let i=t.HEAPU32,u=o>>>2;this.opKernelContext=i[u++];let a=i[u++];this.outputCount=i[u++],this.customDataOffset=i[u++],this.customDataSize=i[u++];let c=[];for(let p=0;p<a;p++){let h=i[u++],d=i[u++],y=i[u++],w=[];for(let _=0;_<y;_++)w.push(i[u++]);c.push(new qr(t,h,d,w))}this.inputs=c}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}getMaxComputeWorkgroupSizes(){return[this.backend.device.limits.maxComputeWorkgroupSizeX,this.backend.device.limits.maxComputeWorkgroupSizeY,this.backend.device.limits.maxComputeWorkgroupSizeZ]}getMaxComputeWorkgroupStoragesize(){return this.backend.device.limits.maxComputeWorkgroupStorageSize}compute(t,r){let o=r?.inputs?.map(c=>typeof c=="number"?this.inputs[c]:c)??this.inputs,i=r?.outputs??[],u=(c,p,h)=>new qr(this.module,p,this.output(c,h),h),a=(c,p)=>{let h=tr(c);if(!h)throw new Error(`Unsupported data type: ${c}`);let d=h*M.size(p),y=d>0?this.backend.gpuDataManager.create(d).id:0;return new qr(this.module,c,y,p)};return this.backend.run(t,o,i,u,a,this.outputCount)}output(t,r){let o=this.module.stackSave();try{let i=this.module.stackAlloc((1+r.length)*4),u=i>>2;this.module.HEAPU32[u++]=r.length;for(let a=0;a<r.length;a++)this.module.HEAPU32[u++]=r[a];return this.module._JsepOutput(this.opKernelContext,t,i)}catch(i){throw new Error(`Failed to generate kernel\'s output[${t}] with dims [${r}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${i}`)}finally{this.module.stackRestore(o)}}},om=async(e,t,r,o)=>{let i=t.jsepInit;if(!i)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if(e==="webgpu"){let u=new Ln;await u.initialize(r,o),i("webgpu",[u,a=>u.alloc(a),a=>u.free(a),(a,c,p,h=!1)=>{if(h)Ve("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${a}, dst=${c}, size=${p}`),u.memcpy(a,c);else{Ve("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${a}, gpuDataId=${c}, size=${p}`);let d=t.HEAPU8.subarray(a>>>0,(a>>>0)+p);u.upload(c,d)}},async(a,c,p)=>{Ve("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${a}, dataOffset=${c}, size=${p}`),await u.download(a,()=>t.HEAPU8.subarray(c>>>0,(c>>>0)+p))},(a,c,p)=>u.createKernel(a,c,p,t.UTF8ToString(t._JsepGetNodeName(c))),a=>u.releaseKernel(a),(a,c,p,h)=>{Ve("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${p}, kernel=${a}, contextDataOffset=${c}`);let d=new Zo(t,u,c);return u.computeKernel(a,d,h)},()=>u.captureBegin(),()=>u.captureEnd(),()=>u.replay()])}else i("webnn")}});var Vi;Vi=Ei();var pl=zi(),fo,ho=!1,yn=!1,Ui=!1,ml=e=>{if(e===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},fl=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},hl=(e,t)=>e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":t?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Wi=async e=>{if(ho)return Promise.resolve();if(yn)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(Ui)throw new Error("previous call to \'initializeWebAssembly()\' failed.");yn=!0;let t=e.initTimeout,r=e.numThreads,o=e.simd,i=ml(r),u=o&&fl(),a=e.wasmPaths,c=typeof a=="string"?a:void 0,p=hl(u,i),h=typeof a=="object"?a[p]:void 0,d=!1,y=[];if(t>0&&y.push(new Promise(w=>{setTimeout(()=>{d=!0,w()},t)})),y.push(new Promise((w,_)=>{let v=i?pl:Vi,S={locateFile:(A,I)=>{if(i&&A.endsWith(".worker.js")&&typeof Blob<"u")return URL.createObjectURL(new Blob([Mi()],{type:"text/javascript"}));if(A.endsWith(".wasm")){if(h)return h;let x=c??I;return p==="ort-wasm-simd.wasm"?x+"ort-wasm-simd.jsep.wasm":p==="ort-wasm-simd-threaded.wasm"?x+"ort-wasm-simd-threaded.jsep.wasm":x+p}return I+A}};if(i)if(S.numThreads=r,typeof Blob>"u")S.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let A=`var ortWasmThreaded=${v.toString()};`;S.mainScriptUrlOrBlob=new Blob([A],{type:"text/javascript"})}v(S).then(A=>{yn=!1,ho=!0,fo=A,w()},A=>{yn=!1,Ui=!0,_(A)})})),await Promise.race(y),d)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},Le=()=>{if(ho&&fo)return fo;throw new Error("WebAssembly is not initialized yet.")};var Fe=(e,t)=>{let r=Le(),o=r.lengthBytesUTF8(e)+1,i=r._malloc(o);return r.stringToUTF8(e,i,o),t.push(i),i},Nr=(e,t,r,o)=>{if(typeof e=="object"&&e!==null){if(r.has(e))throw new Error("Circular reference in options");r.add(e)}Object.entries(e).forEach(([i,u])=>{let a=t?t+i:i;if(typeof u=="object")Nr(u,a+".",r,o);else if(typeof u=="string"||typeof u=="number")o(a,u.toString());else if(typeof u=="boolean")o(a,u?"1":"0");else throw new Error(`Can\'t handle extra config type: ${typeof u}`)})},Ue=e=>{let t=Le(),r=t.stackSave();try{let o=t.stackAlloc(8);t._OrtGetLastError(o,o+4);let i=t.HEAP32[o/4],u=t.HEAPU32[o/4+1],a=u?t.UTF8ToString(u):"";throw new Error(`${e} ERROR_CODE: ${i}, ERROR_MESSAGE: ${a}`)}finally{t.stackRestore(r)}};var Ni=e=>{let t=Le(),r=0,o=[],i=e||{};try{if(e?.logSeverityLevel===void 0)i.logSeverityLevel=2;else if(typeof e.logSeverityLevel!="number"||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(e?.logVerbosityLevel===void 0)i.logVerbosityLevel=0;else if(typeof e.logVerbosityLevel!="number"||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);e?.terminate===void 0&&(i.terminate=!1);let u=0;return e?.tag!==void 0&&(u=Fe(e.tag,o)),r=t._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,u),r===0&&Ue("Can\'t create run options."),e?.extra!==void 0&&Nr(e.extra,"",new WeakSet,(a,c)=>{let p=Fe(a,o),h=Fe(c,o);t._OrtAddRunConfigEntry(r,p,h)!==0&&Ue(`Can\'t set a run config entry: ${a} - ${c}.`)}),[r,o]}catch(u){throw r!==0&&t._OrtReleaseRunOptions(r),o.forEach(a=>t._free(a)),u}};var gl=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},yl=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},bl=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(r=>(typeof r=="string"?r:r.name)==="webgpu")&&(e.enableMemPattern=!1)},wl=(e,t,r)=>{for(let o of t){let i=typeof o=="string"?o:o.name;switch(i){case"webnn":if(i="WEBNN",typeof o!="string"){let a=o;if(a?.deviceType){let c=Fe("deviceType",r),p=Fe(a.deviceType,r);Le()._OrtAddSessionConfigEntry(e,c,p)!==0&&Ue(`Can\'t set a session config entry: \'deviceType\' - ${a.deviceType}.`)}if(a?.numThreads){let c=a.numThreads;(typeof c!="number"||!Number.isInteger(c)||c<0)&&(c=0);let p=Fe("numThreads",r),h=Fe(c.toString(),r);Le()._OrtAddSessionConfigEntry(e,p,h)!==0&&Ue(`Can\'t set a session config entry: \'numThreads\' - ${a.numThreads}.`)}if(a?.powerPreference){let c=Fe("powerPreference",r),p=Fe(a.powerPreference,r);Le()._OrtAddSessionConfigEntry(e,c,p)!==0&&Ue(`Can\'t set a session config entry: \'powerPreference\' - ${a.powerPreference}.`)}}break;case"webgpu":if(i="JS",typeof o!="string"){let a=o;if(a?.preferredLayout){if(a.preferredLayout!=="NCHW"&&a.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either \'NCHW\' or \'NHWC\': ${a.preferredLayout}`);let c=Fe("preferredLayout",r),p=Fe(a.preferredLayout,r);Le()._OrtAddSessionConfigEntry(e,c,p)!==0&&Ue(`Can\'t set a session config entry: \'preferredLayout\' - ${a.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${i}`)}let u=Fe(i,r);Le()._OrtAppendExecutionProvider(e,u)!==0&&Ue(`Can\'t append execution provider: ${i}.`)}},Gi=e=>{let t=Le(),r=0,o=[],i=e||{};bl(i);try{let u=gl(i.graphOptimizationLevel??"all"),a=yl(i.executionMode??"sequential"),c=typeof i.logId=="string"?Fe(i.logId,o):0,p=i.logSeverityLevel??2;if(!Number.isInteger(p)||p<0||p>4)throw new Error(`log serverity level is not valid: ${p}`);let h=i.logVerbosityLevel??0;if(!Number.isInteger(h)||h<0||h>4)throw new Error(`log verbosity level is not valid: ${h}`);let d=typeof i.optimizedModelFilePath=="string"?Fe(i.optimizedModelFilePath,o):0;if(r=t._OrtCreateSessionOptions(u,!!i.enableCpuMemArena,!!i.enableMemPattern,a,!!i.enableProfiling,0,c,p,h,d),r===0&&Ue("Can\'t create session options."),i.executionProviders&&wl(r,i.executionProviders,o),i.enableGraphCapture!==void 0){if(typeof i.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${i.enableGraphCapture}`);let y=Fe("enableGraphCapture",o),w=Fe(i.enableGraphCapture.toString(),o);t._OrtAddSessionConfigEntry(r,y,w)!==0&&Ue(`Can\'t set a session config entry: \'enableGraphCapture\' - ${i.enableGraphCapture}.`)}if(i.freeDimensionOverrides)for(let[y,w]of Object.entries(i.freeDimensionOverrides)){if(typeof y!="string")throw new Error(`free dimension override name must be a string: ${y}`);if(typeof w!="number"||!Number.isInteger(w)||w<0)throw new Error(`free dimension override value must be a non-negative integer: ${w}`);let _=Fe(y,o);t._OrtAddFreeDimensionOverride(r,_,w)!==0&&Ue(`Can\'t set a free dimension override: ${y} - ${w}.`)}return i.extra!==void 0&&Nr(i.extra,"",new WeakSet,(y,w)=>{let _=Fe(y,o),v=Fe(w,o);t._OrtAddSessionConfigEntry(r,_,v)!==0&&Ue(`Can\'t set a session config entry: ${y} - ${w}.`)}),[r,o]}catch(u){throw r!==0&&t._OrtReleaseSessionOptions(r),o.forEach(a=>t._free(a)),u}};ye();var Li=async e=>{if(typeof e=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(e))}catch(t){if(t.code==="ERR_FS_FILE_TOO_LARGE"){let r=(void 0)(e),o=[];for await(let i of r)o.push(i);return new Uint8Array(Buffer.concat(o))}throw t}else{let t=await fetch(e);if(!t.ok)throw new Error(`failed to load external data file: ${e}`);let r=t.headers.get("Content-Length"),o=r?parseInt(r,10):0;if(o<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let i=t.body.getReader(),u;try{u=new ArrayBuffer(o)}catch(c){if(c instanceof RangeError){let p=Math.ceil(o/65536);u=new WebAssembly.Memory({initial:p,maximum:p}).buffer}else throw c}let a=0;for(;;){let{done:c,value:p}=await i.read();if(c)break;let h=p.byteLength;new Uint8Array(u,a,h).set(p),a+=h}return new Uint8Array(u,0,o)}}else return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)};var im=(e,t)=>{Le()._OrtInit(e,t)!==0&&Ue("Can\'t initialize onnxruntime.")},Ld=async e=>{im(e.wasm.numThreads,Gr(e.logLevel))},Fd=async(e,t)=>{{let r=(Gd(),wr(Nd)).init;if(t==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let o=e.webgpu.adapter;if(o){if(typeof o.limits!="object"||typeof o.features!="object"||typeof o.requestDevice!="function")throw new Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let i=e.webgpu.powerPreference;if(i!==void 0&&i!=="low-power"&&i!=="high-performance")throw new Error(`Invalid powerPreference setting: "${i}"`);let u=e.webgpu.forceFallbackAdapter;if(u!==void 0&&typeof u!="boolean")throw new Error(`Invalid forceFallbackAdapter setting: "${u}"`);if(o=await navigator.gpu.requestAdapter({powerPreference:i,forceFallbackAdapter:u}),!o)throw new Error(\'Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.\')}if(!e.wasm.simd)throw new Error("Not supported for WebGPU=ON and SIMD=OFF. Please set `env.wasm.simd` to true when using `webgpu` EP");await r("webgpu",Le(),e,o)}if(t==="webnn"){if(typeof navigator>"u"||!navigator.ml)throw new Error("WebNN is not supported in current environment");await r("webnn",Le(),e)}}},ar=new Map,am=e=>{let t=Le(),r=t.stackSave();try{let o=t.stackAlloc(8);return t._OrtGetInputOutputCount(e,o,o+4)!==0&&Ue("Can\'t get session input/output count."),[t.HEAP32[o/4],t.HEAP32[o/4+1]]}finally{t.stackRestore(r)}},Xo=e=>{let t=Le(),r=t._malloc(e.byteLength);if(r===0)throw new Error(`Can\'t create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,r),[r,e.byteLength]},qd=async(e,t)=>{let r,o,i=Le();Array.isArray(e)?[r,o]=e:e.buffer===i.HEAPU8.buffer?[r,o]=[e.byteOffset,e.byteLength]:[r,o]=Xo(e);let u=0,a=0,c=0,p=[],h=[],d=[];try{if([a,p]=Gi(t),t?.externalData&&i.mountExternalData){let x=[];for(let E of t.externalData){let P=typeof E=="string"?E:E.path;x.push(Li(typeof E=="string"?E:E.data).then(O=>{i.mountExternalData(P,O)}))}await Promise.all(x)}u=await i._OrtCreateSession(r,o,a),u===0&&Ue("Can\'t create a session.");let[y,w]=am(u),_=!!t?.enableGraphCapture,v=[],S=[],A=[];for(let x=0;x<y;x++){let E=i._OrtGetInputName(u,x);E===0&&Ue("Can\'t get an input name."),h.push(E),v.push(i.UTF8ToString(E))}for(let x=0;x<w;x++){let E=i._OrtGetOutputName(u,x);E===0&&Ue("Can\'t get an output name."),d.push(E);let P=i.UTF8ToString(E);S.push(P);{if(_&&t?.preferredOutputLocation===void 0){A.push("gpu-buffer");continue}let O=typeof t?.preferredOutputLocation=="string"?t.preferredOutputLocation:t?.preferredOutputLocation?.[P]??"cpu";if(O!=="cpu"&&O!=="cpu-pinned"&&O!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${O}.`);if(_&&O!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${O}. Only \'gpu-buffer\' location is supported when enableGraphCapture is true.`);A.push(O)}}let I=null;return A.some(x=>x==="gpu-buffer")&&(c=i._OrtCreateBinding(u),c===0&&Ue("Can\'t create IO binding."),I={handle:c,outputPreferredLocations:A,outputPreferredLocationsEncoded:A.map(x=>yo(x))}),ar.set(u,[u,h,d,I,_,!1]),[u,v,S]}catch(y){throw h.forEach(w=>i._OrtFree(w)),d.forEach(w=>i._OrtFree(w)),c!==0&&i._OrtReleaseBinding(c),u!==0&&i._OrtReleaseSession(u),y}finally{i._free(r),a!==0&&i._OrtReleaseSessionOptions(a),p.forEach(y=>i._free(y)),i.unmountExternalData?.()}},jd=e=>{let t=Le(),r=ar.get(e);if(!r)throw new Error(`cannot release session. invalid session id: ${e}`);let[o,i,u,a,c]=r;a&&(c&&t._OrtClearBoundOutputs(a.handle),t._OrtReleaseBinding(a.handle)),t.jsepOnReleaseSession?.(e),i.forEach(p=>t._OrtFree(p)),u.forEach(p=>t._OrtFree(p)),t._OrtReleaseSession(o),ar.delete(e)},Hd=(e,t,r,o,i,u=!1)=>{if(!e){t.push(0);return}let a=Le(),c=e[0],p=e[1],h=e[3],d,y;if(c==="string"&&h==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(u&&h!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${i} when enableGraphCapture is true.`);if(h==="gpu-buffer"){let v=e[2].gpuBuffer,S=tr(go(c));y=p.reduce((I,x)=>I*x,1)*S;let A=a.jsepRegisterBuffer;if(!A)throw new Error(\'Tensor location "gpu-buffer" is not supported without using WebGPU.\');d=A(o,i,v,y)}else{let v=e[2];if(Array.isArray(v)){y=4*v.length,d=a._malloc(y),r.push(d);let S=d/4;for(let A=0;A<v.length;A++){if(typeof v[A]!="string")throw new TypeError(`tensor data at index ${A} is not a string`);a.HEAPU32[S++]=Fe(v[A],r)}}else y=v.byteLength,d=a._malloc(y),r.push(d),a.HEAPU8.set(new Uint8Array(v.buffer,v.byteOffset,y),d)}let w=a.stackSave(),_=a.stackAlloc(4*p.length);try{let v=_/4;p.forEach(A=>a.HEAP32[v++]=A);let S=a._OrtCreateTensor(go(c),d,y,_,p.length,yo(h));S===0&&Ue(`Can\'t create tensor for input/output. session=${o}, index=${i}.`),t.push(S)}finally{a.stackRestore(w)}},Kd=async(e,t,r,o,i,u)=>{let a=Le(),c=ar.get(e);if(!c)throw new Error(`cannot run inference. invalid session id: ${e}`);let p=c[0],h=c[1],d=c[2],y=c[3],w=c[4],_=c[5],v=t.length,S=o.length,A=0,I=[],x=[],E=[],P=[],O=a.stackSave(),R=a.stackAlloc(v*4),L=a.stackAlloc(v*4),N=a.stackAlloc(S*4),K=a.stackAlloc(S*4);try{[A,I]=Ni(u);for(let ee=0;ee<v;ee++)Hd(r[ee],x,P,e,t[ee],w);for(let ee=0;ee<S;ee++)Hd(i[ee],E,P,e,v+o[ee],w);let Q=R/4,he=L/4,W=N/4,se=K/4;for(let ee=0;ee<v;ee++)a.HEAPU32[Q++]=x[ee],a.HEAPU32[he++]=h[t[ee]];for(let ee=0;ee<S;ee++)a.HEAPU32[W++]=E[ee],a.HEAPU32[se++]=d[o[ee]];if(y&&!_){let{handle:ee,outputPreferredLocations:ae,outputPreferredLocationsEncoded:Ae}=y;if(h.length!==v)throw new Error(`input count from feeds (${v}) is expected to be always equal to model\'s input count (${h.length}).`);for(let me=0;me<v;me++){let ie=t[me];await a._OrtBindInput(ee,h[ie],x[me])!==0&&Ue(`Can\'t bind input[${me}] for session=${e}.`)}for(let me=0;me<S;me++){let ie=o[me];i[me]?.[3]?a._OrtBindOutput(ee,d[ie],E[me],0)!==0&&Ue(`Can\'t bind pre-allocated output[${me}] for session=${e}.`):a._OrtBindOutput(ee,d[ie],0,Ae[ie])!==0&&Ue(`Can\'t bind output[${me}] to ${ae[me]} for session=${e}.`)}ar.set(e,[p,h,d,y,w,!0])}a.jsepOnRunStart?.(p);let Ce;y?Ce=await a._OrtRunWithBinding(p,y.handle,S,N,A):Ce=await a._OrtRun(p,L,R,v,K,S,N,A),Ce!==0&&Ue("failed to call OrtRun().");let We=[];for(let ee=0;ee<S;ee++){let ae=a.HEAPU32[N/4+ee];if(ae===E[ee]){We.push(i[ee]);continue}let Ae=a.stackSave(),me=a.stackAlloc(4*4),ie=!1,ue,le=0;try{a._OrtGetTensorData(ae,me,me+4,me+8,me+12)!==0&&Ue(`Can\'t access output tensor data on index ${ee}.`);let G=me/4,ne=a.HEAPU32[G++];le=a.HEAPU32[G++];let xe=a.HEAPU32[G++],Ke=a.HEAPU32[G++],Be=[];for(let Ne=0;Ne<Ke;Ne++)Be.push(a.HEAPU32[xe/4+Ne]);a._OrtFree(xe);let Ge=Be.reduce((Ne,Ye)=>Ne*Ye,1);ue=Gt(ne);let Ut=y?.outputPreferredLocations[o[ee]];if(ue==="string"){if(Ut==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let Ne=[],Ye=le/4;for(let mt=0;mt<Ge;mt++){let Rt=a.HEAPU32[Ye++],qt=mt===Ge-1?void 0:a.HEAPU32[Ye]-Rt;Ne.push(a.UTF8ToString(Rt,qt))}We.push([ue,Be,Ne,"cpu"])}else if(Ut==="gpu-buffer"&&Ge>0){let Ne=a.jsepGetBuffer;if(!Ne)throw new Error(\'preferredLocation "gpu-buffer" is not supported without using WebGPU.\');let Ye=Ne(le),mt=tr(ne);if(mt===void 0||!Hi(ue))throw new Error(`Unsupported data type: ${ue}`);ie=!0,We.push([ue,Be,{gpuBuffer:Ye,download:a.jsepCreateDownloader(Ye,Ge*mt,ue),dispose:()=>{a._OrtReleaseTensor(ae)}},"gpu-buffer"])}else{let Ne=bn(ue),Ye=new Ne(Ge);new Uint8Array(Ye.buffer,Ye.byteOffset,Ye.byteLength).set(a.HEAPU8.subarray(le,le+Ye.byteLength)),We.push([ue,Be,Ye,"cpu"])}}finally{a.stackRestore(Ae),ue==="string"&&le&&a._free(le),ie||a._OrtReleaseTensor(ae)}}return y&&!w&&(a._OrtClearBoundOutputs(y.handle),ar.set(e,[p,h,d,y,w,!1])),We}finally{a.stackRestore(O),x.forEach(Q=>a._OrtReleaseTensor(Q)),E.forEach(Q=>a._OrtReleaseTensor(Q)),P.forEach(Q=>a._free(Q)),A!==0&&a._OrtReleaseRunOptions(A),I.forEach(Q=>a._free(Q))}},Yd=e=>{let t=Le(),r=ar.get(e);if(!r)throw new Error("invalid session id");let o=r[0],i=t._OrtEndProfiling(o);i===0&&Ue("Can\'t get an profile file name."),t._OrtFree(i)},Zd=e=>{let t=[];for(let r of e){let o=r[2];!Array.isArray(o)&&"buffer"in o&&t.push(o.buffer)}return t};self.onmessage=e=>{let{type:t,in:r}=e.data;try{switch(t){case"init-wasm":Wi(r.wasm).then(()=>{Ld(r).then(()=>{postMessage({type:t})},o=>{postMessage({type:t,err:o})})},o=>{postMessage({type:t,err:o})});break;case"init-ep":{let{epName:o,env:i}=r;Fd(i,o).then(()=>{postMessage({type:t})},u=>{postMessage({type:t,err:u})});break}case"copy-from":{let{buffer:o}=r,i=Xo(o);postMessage({type:t,out:i});break}case"create":{let{model:o,options:i}=r;qd(o,i).then(u=>{postMessage({type:t,out:u})},u=>{postMessage({type:t,err:u})});break}case"release":jd(r),postMessage({type:t});break;case"run":{let{sessionId:o,inputIndices:i,inputs:u,outputIndices:a,options:c}=r;Kd(o,i,u,a,new Array(a.length).fill(null),c).then(p=>{p.some(h=>h[3]!=="cpu")?postMessage({type:t,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:t,out:p},Zd([...u,...p]))},p=>{postMessage({type:t,err:p})});break}case"end-profiling":Yd(r),postMessage({type:t});break;default:}}catch(o){postMessage({type:t,err:o})}};})();\n/**\n * @license\n * Copyright 2021 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n/**\n * @license\n * Copyright 2020 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n/**\n * @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n'}),gr,St,sn,pi,mi,Co,Io,zr,Br,pf,ci,Wd,Nd,Vd,Hd,Gd,Ld,Fd,To=j(()=>{var e;_t(),Md(),Or(),gr=()=>!!ke.wasm.proxy&&typeof document<"u",sn=!1,pi=!1,mi=!1,Io=new Map,zr=(i,a)=>{let o=Io.get(i);o?o.push(a):Io.set(i,[a])},Br=()=>{if(sn||!pi||mi||!St)throw new Error("worker not ready")},pf=i=>{switch(i.data.type){case"init-wasm":sn=!1,i.data.err?(mi=!0,Co[1](i.data.err)):(pi=!0,Co[0]());break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let a=Io.get(i.data.type);i.data.err?a.shift()[1](i.data.err):a.shift()[0](i.data.out);break}}},ci=typeof document<"u"?(e=document==null?void 0:document.currentScript)==null?void 0:e.src:void 0,Wd=async()=>{if(!pi){if(sn)throw new Error("multiple calls to 'initWasm()' detected.");if(mi)throw new Error("previous call to 'initWasm()' failed.");if(sn=!0,gr())return ke.wasm.wasmPaths===void 0&&ci&&ci.indexOf("blob:")!==0&&(ke.wasm.wasmPaths=ci.substr(0,+ci.lastIndexOf("/")+1)),new Promise((i,a)=>{St==null||St.terminate();let o=URL.createObjectURL(new Blob([Ud()],{type:"text/javascript"}));St=new Worker(o,{name:"ort-wasm-proxy-worker"}),St.onerror=s=>a(s),St.onmessage=pf,URL.revokeObjectURL(o),Co=[i,a];let c={type:"init-wasm",in:ke};St.postMessage(c)});try{await Fa(ke.wasm),await kd(ke),pi=!0}catch(i){throw mi=!0,i}finally{sn=!1}}},Nd=async i=>{if(gr())return Br(),new Promise((a,o)=>{zr("init-ep",[a,o]);let c={type:"init-ep",in:{epName:i,env:ke}};St.postMessage(c)});await Od(ke,i)},Vd=async i=>gr()?(Br(),new Promise((a,o)=>{zr("copy-from",[a,o]);let c={type:"copy-from",in:{buffer:i}};St.postMessage(c,[i.buffer])})):So(i),Hd=async(i,a)=>{if(gr()){if(a!=null&&a.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return Br(),new Promise((o,c)=>{zr("create",[o,c]);let s={type:"create",in:{model:i,options:{...a}}},d=[];i instanceof Uint8Array&&d.push(i.buffer),St.postMessage(s,d)})}else return Pd(i,a)},Gd=async i=>{if(gr())return Br(),new Promise((a,o)=>{zr("release",[a,o]);let c={type:"release",in:i};St.postMessage(c)});Rd(i)},Ld=async(i,a,o,c,s,d)=>{if(gr()){if(o.some($=>$[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(s.some($=>$))throw new Error("pre-allocated output tensor is not supported for proxy.");return Br(),new Promise(($,et)=>{zr("run",[$,et]);let h=o,b={type:"run",in:{sessionId:i,inputIndices:a,inputs:h,outputIndices:c,options:d}};St.postMessage(b,Dd(h))})}else return zd(i,a,o,c,s,d)},Fd=async i=>{if(gr())return Br(),new Promise((a,o)=>{zr("end-profiling",[a,o]);let c={type:"end-profiling",in:i};St.postMessage(c)});Bd(i)}}),qd,mf,fi,jd=j(()=>{_t(),To(),ye(),qi(),qd=(e,i)=>{switch(e.location){case"cpu":return[e.type,e.dims,e.data,"cpu"];case"gpu-buffer":return[e.type,e.dims,{gpuBuffer:e.gpuBuffer},"gpu-buffer"];default:throw new Error(`invalid data location: ${e.location} for ${i()}`)}},mf=e=>{switch(e[3]){case"cpu":return new tt(e[0],e[2],e[1]);case"gpu-buffer":{let i=e[0];if(!Vn(i))throw new Error(`not supported data type: ${i} for deserializing GPU tensor`);let{gpuBuffer:a,download:o,dispose:c}=e[2];return tt.fromGpuBuffer(a,{dataType:i,dims:e[1],download:o,dispose:c})}default:throw new Error(`invalid data location: ${e[3]}`)}},fi=class{async fetchModelAndCopyToWasmMemory(e){return Vd(await tn(e))}async loadModel(e,i){yt();let a;typeof e=="string"?typeof process<"u"&&process.versions&&process.versions.node?a=await tn(e):a=await this.fetchModelAndCopyToWasmMemory(e):a=e,[this.sessionId,this.inputNames,this.outputNames]=await Hd(a,i),ut()}async dispose(){return Gd(this.sessionId)}async run(e,i,a){yt();let o=[],c=[];Object.entries(e).forEach(g=>{let st=g[0],$t=g[1],vt=this.inputNames.indexOf(st);if(vt===-1)throw new Error(`invalid input '${st}'`);o.push($t),c.push(vt)});let s=[],d=[];Object.entries(i).forEach(g=>{let st=g[0],$t=g[1],vt=this.outputNames.indexOf(st);if(vt===-1)throw new Error(`invalid output '${st}'`);s.push($t),d.push(vt)});let $=o.map((g,st)=>qd(g,()=>`input "${this.inputNames[c[st]]}"`)),et=s.map((g,st)=>g?qd(g,()=>`output "${this.outputNames[d[st]]}"`):null),h=await Ld(this.sessionId,c,$,d,et,a),b={};for(let g=0;g<h.length;g++)b[this.outputNames[d[g]]]=s[g]??mf(h[g]);return ut(),b}startProfiling(){}endProfiling(){Fd(this.sessionId)}}}),ff,hi,Kd=j(()=>{_t(),To(),jd(),ff=()=>{if((typeof ke.wasm.initTimeout!="number"||ke.wasm.initTimeout<0)&&(ke.wasm.initTimeout=0),typeof ke.wasm.simd!="boolean"&&(ke.wasm.simd=!0),typeof ke.wasm.proxy!="boolean"&&(ke.wasm.proxy=!1),typeof ke.wasm.trace!="boolean"&&(ke.wasm.trace=!1),typeof ke.wasm.numThreads!="number"||!Number.isInteger(ke.wasm.numThreads)||ke.wasm.numThreads<=0){(typeof self<"u"&&!self.crossOriginIsolated||typeof process<"u"&&process.versions&&process.versions.node)&&(ke.wasm.numThreads=1);let e=typeof navigator>"u"?(void 0)().length:navigator.hardwareConcurrency;ke.wasm.numThreads=Math.min(4,Math.ceil((e||1)/2))}},hi=class{async init(e){ff(),await Wd(),await Nd(e)}async createInferenceSessionHandler(e,i){let a=new fi;return await a.loadModel(e,i),Promise.resolve(a)}}}),Yd={};kr(Yd,{wasmBackend:()=>hf});var hf,Xd=j(()=>{Kd(),hf=new hi});_t();_t();_t();var ka="1.18.0",h$=Bi;{let e=(Xd(),sr(Yd)).wasmBackend;lr("webgpu",e,5),lr("webnn",e,5),lr("cpu",e,10),lr("wasm",e,10)}Object.defineProperty(ke.versions,"web",{value:ka,enumerable:!0});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ort_gpu=Object.freeze(Object.defineProperty({__proto__:null,get InferenceSession(){return uc},get TRACE(){return Bn},get TRACE_FUNC_BEGIN(){return yt},get TRACE_FUNC_END(){return ut},get Tensor(){return tt},get TrainingSession(){return dc},default:h$,get env(){return ke},get registerBackend(){return lr}},Symbol.toStringTag,{value:"Module"}));var util;(function(e){e.assertEqual=c=>c;function i(c){}e.assertIs=i;function a(c){throw new Error}e.assertNever=a,e.arrayToEnum=c=>{const s={};for(const d of c)s[d]=d;return s},e.getValidEnumValues=c=>{const s=e.objectKeys(c).filter($=>typeof c[c[$]]!="number"),d={};for(const $ of s)d[$]=c[$];return e.objectValues(d)},e.objectValues=c=>e.objectKeys(c).map(function(s){return c[s]}),e.objectKeys=typeof Object.keys=="function"?c=>Object.keys(c):c=>{const s=[];for(const d in c)Object.prototype.hasOwnProperty.call(c,d)&&s.push(d);return s},e.find=(c,s)=>{for(const d of c)if(s(d))return d},e.isInteger=typeof Number.isInteger=="function"?c=>Number.isInteger(c):c=>typeof c=="number"&&isFinite(c)&&Math.floor(c)===c;function o(c,s=" | "){return c.map(d=>typeof d=="string"?`'${d}'`:d).join(s)}e.joinValues=o,e.jsonStringifyReplacer=(c,s)=>typeof s=="bigint"?s.toString():s})(util||(util={}));var objectUtil;(function(e){e.mergeShapes=(i,a)=>({...i,...a})})(objectUtil||(objectUtil={}));const ZodParsedType=util.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),getParsedType=e=>{switch(typeof e){case"undefined":return ZodParsedType.undefined;case"string":return ZodParsedType.string;case"number":return isNaN(e)?ZodParsedType.nan:ZodParsedType.number;case"boolean":return ZodParsedType.boolean;case"function":return ZodParsedType.function;case"bigint":return ZodParsedType.bigint;case"symbol":return ZodParsedType.symbol;case"object":return Array.isArray(e)?ZodParsedType.array:e===null?ZodParsedType.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?ZodParsedType.promise:typeof Map<"u"&&e instanceof Map?ZodParsedType.map:typeof Set<"u"&&e instanceof Set?ZodParsedType.set:typeof Date<"u"&&e instanceof Date?ZodParsedType.date:ZodParsedType.object;default:return ZodParsedType.unknown}},ZodIssueCode=util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),quotelessJson=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class ZodError extends Error{constructor(i){super(),this.issues=[],this.addIssue=o=>{this.issues=[...this.issues,o]},this.addIssues=(o=[])=>{this.issues=[...this.issues,...o]};const a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=i}get errors(){return this.issues}format(i){const a=i||function(s){return s.message},o={_errors:[]},c=s=>{for(const d of s.issues)if(d.code==="invalid_union")d.unionErrors.map(c);else if(d.code==="invalid_return_type")c(d.returnTypeError);else if(d.code==="invalid_arguments")c(d.argumentsError);else if(d.path.length===0)o._errors.push(a(d));else{let $=o,et=0;for(;et<d.path.length;){const h=d.path[et];et===d.path.length-1?($[h]=$[h]||{_errors:[]},$[h]._errors.push(a(d))):$[h]=$[h]||{_errors:[]},$=$[h],et++}}};return c(this),o}static assert(i){if(!(i instanceof ZodError))throw new Error(`Not a ZodError: ${i}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,util.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(i=a=>a.message){const a={},o=[];for(const c of this.issues)c.path.length>0?(a[c.path[0]]=a[c.path[0]]||[],a[c.path[0]].push(i(c))):o.push(i(c));return{formErrors:o,fieldErrors:a}}get formErrors(){return this.flatten()}}ZodError.create=e=>new ZodError(e);const errorMap=(e,i)=>{let a;switch(e.code){case ZodIssueCode.invalid_type:e.received===ZodParsedType.undefined?a="Required":a=`Expected ${e.expected}, received ${e.received}`;break;case ZodIssueCode.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(e.expected,util.jsonStringifyReplacer)}`;break;case ZodIssueCode.unrecognized_keys:a=`Unrecognized key(s) in object: ${util.joinValues(e.keys,", ")}`;break;case ZodIssueCode.invalid_union:a="Invalid input";break;case ZodIssueCode.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${util.joinValues(e.options)}`;break;case ZodIssueCode.invalid_enum_value:a=`Invalid enum value. Expected ${util.joinValues(e.options)}, received '${e.received}'`;break;case ZodIssueCode.invalid_arguments:a="Invalid function arguments";break;case ZodIssueCode.invalid_return_type:a="Invalid function return type";break;case ZodIssueCode.invalid_date:a="Invalid date";break;case ZodIssueCode.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(a=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?a=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?a=`Invalid input: must end with "${e.validation.endsWith}"`:util.assertNever(e.validation):e.validation!=="regex"?a=`Invalid ${e.validation}`:a="Invalid";break;case ZodIssueCode.too_small:e.type==="array"?a=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?a=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?a=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?a=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:a="Invalid input";break;case ZodIssueCode.too_big:e.type==="array"?a=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?a=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?a=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?a=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?a=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:a="Invalid input";break;case ZodIssueCode.custom:a="Invalid input";break;case ZodIssueCode.invalid_intersection_types:a="Intersection results could not be merged";break;case ZodIssueCode.not_multiple_of:a=`Number must be a multiple of ${e.multipleOf}`;break;case ZodIssueCode.not_finite:a="Number must be finite";break;default:a=i.defaultError,util.assertNever(e)}return{message:a}};let overrideErrorMap=errorMap;function setErrorMap(e){overrideErrorMap=e}function getErrorMap(){return overrideErrorMap}const makeIssue=e=>{const{data:i,path:a,errorMaps:o,issueData:c}=e,s=[...a,...c.path||[]],d={...c,path:s};if(c.message!==void 0)return{...c,path:s,message:c.message};let $="";const et=o.filter(h=>!!h).slice().reverse();for(const h of et)$=h(d,{data:i,defaultError:$}).message;return{...c,path:s,message:$}},EMPTY_PATH=[];function addIssueToContext(e,i){const a=getErrorMap(),o=makeIssue({issueData:i,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,a,a===errorMap?void 0:errorMap].filter(c=>!!c)});e.common.issues.push(o)}class ParseStatus{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(i,a){const o=[];for(const c of a){if(c.status==="aborted")return INVALID;c.status==="dirty"&&i.dirty(),o.push(c.value)}return{status:i.value,value:o}}static async mergeObjectAsync(i,a){const o=[];for(const c of a){const s=await c.key,d=await c.value;o.push({key:s,value:d})}return ParseStatus.mergeObjectSync(i,o)}static mergeObjectSync(i,a){const o={};for(const c of a){const{key:s,value:d}=c;if(s.status==="aborted"||d.status==="aborted")return INVALID;s.status==="dirty"&&i.dirty(),d.status==="dirty"&&i.dirty(),s.value!=="__proto__"&&(typeof d.value<"u"||c.alwaysSet)&&(o[s.value]=d.value)}return{status:i.value,value:o}}}const INVALID=Object.freeze({status:"aborted"}),DIRTY=e=>({status:"dirty",value:e}),OK=e=>({status:"valid",value:e}),isAborted=e=>e.status==="aborted",isDirty=e=>e.status==="dirty",isValid$1=e=>e.status==="valid",isAsync=e=>typeof Promise<"u"&&e instanceof Promise;function __classPrivateFieldGet(e,i,a,o){if(a==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof i=="function"?e!==i||!o:!i.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a==="m"?o:a==="a"?o.call(e):o?o.value:i.get(e)}function __classPrivateFieldSet(e,i,a,o,c){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!c)throw new TypeError("Private accessor was defined without a setter");if(typeof i=="function"?e!==i||!c:!i.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?c.call(e,a):c?c.value=a:i.set(e,a),a}typeof SuppressedError=="function"&&SuppressedError;var errorUtil;(function(e){e.errToObj=i=>typeof i=="string"?{message:i}:i||{},e.toString=i=>typeof i=="string"?i:i==null?void 0:i.message})(errorUtil||(errorUtil={}));var _ZodEnum_cache,_ZodNativeEnum_cache;class ParseInputLazyPath{constructor(i,a,o,c){this._cachedPath=[],this.parent=i,this.data=a,this._path=o,this._key=c}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const handleResult=(e,i)=>{if(isValid$1(i))return{success:!0,data:i.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const a=new ZodError(e.common.issues);return this._error=a,this._error}}};function processCreateParams(e){if(!e)return{};const{errorMap:i,invalid_type_error:a,required_error:o,description:c}=e;if(i&&(a||o))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return i?{errorMap:i,description:c}:{errorMap:(d,$)=>{var et,h;const{message:b}=e;return d.code==="invalid_enum_value"?{message:b??$.defaultError}:typeof $.data>"u"?{message:(et=b??o)!==null&&et!==void 0?et:$.defaultError}:d.code!=="invalid_type"?{message:$.defaultError}:{message:(h=b??a)!==null&&h!==void 0?h:$.defaultError}},description:c}}class ZodType{constructor(i){this.spa=this.safeParseAsync,this._def=i,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(i){return getParsedType(i.data)}_getOrReturnCtx(i,a){return a||{common:i.parent.common,data:i.data,parsedType:getParsedType(i.data),schemaErrorMap:this._def.errorMap,path:i.path,parent:i.parent}}_processInputParams(i){return{status:new ParseStatus,ctx:{common:i.parent.common,data:i.data,parsedType:getParsedType(i.data),schemaErrorMap:this._def.errorMap,path:i.path,parent:i.parent}}}_parseSync(i){const a=this._parse(i);if(isAsync(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(i){const a=this._parse(i);return Promise.resolve(a)}parse(i,a){const o=this.safeParse(i,a);if(o.success)return o.data;throw o.error}safeParse(i,a){var o;const c={common:{issues:[],async:(o=a==null?void 0:a.async)!==null&&o!==void 0?o:!1,contextualErrorMap:a==null?void 0:a.errorMap},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:i,parsedType:getParsedType(i)},s=this._parseSync({data:i,path:c.path,parent:c});return handleResult(c,s)}async parseAsync(i,a){const o=await this.safeParseAsync(i,a);if(o.success)return o.data;throw o.error}async safeParseAsync(i,a){const o={common:{issues:[],contextualErrorMap:a==null?void 0:a.errorMap,async:!0},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:i,parsedType:getParsedType(i)},c=this._parse({data:i,path:o.path,parent:o}),s=await(isAsync(c)?c:Promise.resolve(c));return handleResult(o,s)}refine(i,a){const o=c=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(c):a;return this._refinement((c,s)=>{const d=i(c),$=()=>s.addIssue({code:ZodIssueCode.custom,...o(c)});return typeof Promise<"u"&&d instanceof Promise?d.then(et=>et?!0:($(),!1)):d?!0:($(),!1)})}refinement(i,a){return this._refinement((o,c)=>i(o)?!0:(c.addIssue(typeof a=="function"?a(o,c):a),!1))}_refinement(i){return new ZodEffects({schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"refinement",refinement:i}})}superRefine(i){return this._refinement(i)}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this,this._def)}promise(){return ZodPromise.create(this,this._def)}or(i){return ZodUnion.create([this,i],this._def)}and(i){return ZodIntersection.create(this,i,this._def)}transform(i){return new ZodEffects({...processCreateParams(this._def),schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"transform",transform:i}})}default(i){const a=typeof i=="function"?i:()=>i;return new ZodDefault({...processCreateParams(this._def),innerType:this,defaultValue:a,typeName:ZodFirstPartyTypeKind.ZodDefault})}brand(){return new ZodBranded({typeName:ZodFirstPartyTypeKind.ZodBranded,type:this,...processCreateParams(this._def)})}catch(i){const a=typeof i=="function"?i:()=>i;return new ZodCatch({...processCreateParams(this._def),innerType:this,catchValue:a,typeName:ZodFirstPartyTypeKind.ZodCatch})}describe(i){const a=this.constructor;return new a({...this._def,description:i})}pipe(i){return ZodPipeline.create(this,i)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const cuidRegex=/^c[^\s-]{8,}$/i,cuid2Regex=/^[0-9a-z]+$/,ulidRegex=/^[0-9A-HJKMNP-TV-Z]{26}$/,uuidRegex=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,nanoidRegex=/^[a-z0-9_-]{21}$/i,durationRegex=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,emailRegex=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,_emojiRegex="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let emojiRegex;const ipv4Regex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6Regex=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64Regex=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,dateRegexSource="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dateRegex=new RegExp(`^${dateRegexSource}$`);function timeRegexSource(e){let i="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?i=`${i}\\.\\d{${e.precision}}`:e.precision==null&&(i=`${i}(\\.\\d+)?`),i}function timeRegex(e){return new RegExp(`^${timeRegexSource(e)}$`)}function datetimeRegex(e){let i=`${dateRegexSource}T${timeRegexSource(e)}`;const a=[];return a.push(e.local?"Z?":"Z"),e.offset&&a.push("([+-]\\d{2}:?\\d{2})"),i=`${i}(${a.join("|")})`,new RegExp(`^${i}$`)}function isValidIP(e,i){return!!((i==="v4"||!i)&&ipv4Regex.test(e)||(i==="v6"||!i)&&ipv6Regex.test(e))}class ZodString extends ZodType{_parse(i){if(this._def.coerce&&(i.data=String(i.data)),this._getType(i)!==ZodParsedType.string){const s=this._getOrReturnCtx(i);return addIssueToContext(s,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.string,received:s.parsedType}),INVALID}const o=new ParseStatus;let c;for(const s of this._def.checks)if(s.kind==="min")i.data.length<s.value&&(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{code:ZodIssueCode.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),o.dirty());else if(s.kind==="max")i.data.length>s.value&&(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{code:ZodIssueCode.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),o.dirty());else if(s.kind==="length"){const d=i.data.length>s.value,$=i.data.length<s.value;(d||$)&&(c=this._getOrReturnCtx(i,c),d?addIssueToContext(c,{code:ZodIssueCode.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):$&&addIssueToContext(c,{code:ZodIssueCode.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),o.dirty())}else if(s.kind==="email")emailRegex.test(i.data)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{validation:"email",code:ZodIssueCode.invalid_string,message:s.message}),o.dirty());else if(s.kind==="emoji")emojiRegex||(emojiRegex=new RegExp(_emojiRegex,"u")),emojiRegex.test(i.data)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{validation:"emoji",code:ZodIssueCode.invalid_string,message:s.message}),o.dirty());else if(s.kind==="uuid")uuidRegex.test(i.data)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{validation:"uuid",code:ZodIssueCode.invalid_string,message:s.message}),o.dirty());else if(s.kind==="nanoid")nanoidRegex.test(i.data)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{validation:"nanoid",code:ZodIssueCode.invalid_string,message:s.message}),o.dirty());else if(s.kind==="cuid")cuidRegex.test(i.data)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{validation:"cuid",code:ZodIssueCode.invalid_string,message:s.message}),o.dirty());else if(s.kind==="cuid2")cuid2Regex.test(i.data)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{validation:"cuid2",code:ZodIssueCode.invalid_string,message:s.message}),o.dirty());else if(s.kind==="ulid")ulidRegex.test(i.data)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{validation:"ulid",code:ZodIssueCode.invalid_string,message:s.message}),o.dirty());else if(s.kind==="url")try{new URL(i.data)}catch{c=this._getOrReturnCtx(i,c),addIssueToContext(c,{validation:"url",code:ZodIssueCode.invalid_string,message:s.message}),o.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(i.data)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{validation:"regex",code:ZodIssueCode.invalid_string,message:s.message}),o.dirty())):s.kind==="trim"?i.data=i.data.trim():s.kind==="includes"?i.data.includes(s.value,s.position)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{code:ZodIssueCode.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),o.dirty()):s.kind==="toLowerCase"?i.data=i.data.toLowerCase():s.kind==="toUpperCase"?i.data=i.data.toUpperCase():s.kind==="startsWith"?i.data.startsWith(s.value)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{code:ZodIssueCode.invalid_string,validation:{startsWith:s.value},message:s.message}),o.dirty()):s.kind==="endsWith"?i.data.endsWith(s.value)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{code:ZodIssueCode.invalid_string,validation:{endsWith:s.value},message:s.message}),o.dirty()):s.kind==="datetime"?datetimeRegex(s).test(i.data)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{code:ZodIssueCode.invalid_string,validation:"datetime",message:s.message}),o.dirty()):s.kind==="date"?dateRegex.test(i.data)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{code:ZodIssueCode.invalid_string,validation:"date",message:s.message}),o.dirty()):s.kind==="time"?timeRegex(s).test(i.data)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{code:ZodIssueCode.invalid_string,validation:"time",message:s.message}),o.dirty()):s.kind==="duration"?durationRegex.test(i.data)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{validation:"duration",code:ZodIssueCode.invalid_string,message:s.message}),o.dirty()):s.kind==="ip"?isValidIP(i.data,s.version)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{validation:"ip",code:ZodIssueCode.invalid_string,message:s.message}),o.dirty()):s.kind==="base64"?base64Regex.test(i.data)||(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{validation:"base64",code:ZodIssueCode.invalid_string,message:s.message}),o.dirty()):util.assertNever(s);return{status:o.value,value:i.data}}_regex(i,a,o){return this.refinement(c=>i.test(c),{validation:a,code:ZodIssueCode.invalid_string,...errorUtil.errToObj(o)})}_addCheck(i){return new ZodString({...this._def,checks:[...this._def.checks,i]})}email(i){return this._addCheck({kind:"email",...errorUtil.errToObj(i)})}url(i){return this._addCheck({kind:"url",...errorUtil.errToObj(i)})}emoji(i){return this._addCheck({kind:"emoji",...errorUtil.errToObj(i)})}uuid(i){return this._addCheck({kind:"uuid",...errorUtil.errToObj(i)})}nanoid(i){return this._addCheck({kind:"nanoid",...errorUtil.errToObj(i)})}cuid(i){return this._addCheck({kind:"cuid",...errorUtil.errToObj(i)})}cuid2(i){return this._addCheck({kind:"cuid2",...errorUtil.errToObj(i)})}ulid(i){return this._addCheck({kind:"ulid",...errorUtil.errToObj(i)})}base64(i){return this._addCheck({kind:"base64",...errorUtil.errToObj(i)})}ip(i){return this._addCheck({kind:"ip",...errorUtil.errToObj(i)})}datetime(i){var a,o;return typeof i=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:i}):this._addCheck({kind:"datetime",precision:typeof(i==null?void 0:i.precision)>"u"?null:i==null?void 0:i.precision,offset:(a=i==null?void 0:i.offset)!==null&&a!==void 0?a:!1,local:(o=i==null?void 0:i.local)!==null&&o!==void 0?o:!1,...errorUtil.errToObj(i==null?void 0:i.message)})}date(i){return this._addCheck({kind:"date",message:i})}time(i){return typeof i=="string"?this._addCheck({kind:"time",precision:null,message:i}):this._addCheck({kind:"time",precision:typeof(i==null?void 0:i.precision)>"u"?null:i==null?void 0:i.precision,...errorUtil.errToObj(i==null?void 0:i.message)})}duration(i){return this._addCheck({kind:"duration",...errorUtil.errToObj(i)})}regex(i,a){return this._addCheck({kind:"regex",regex:i,...errorUtil.errToObj(a)})}includes(i,a){return this._addCheck({kind:"includes",value:i,position:a==null?void 0:a.position,...errorUtil.errToObj(a==null?void 0:a.message)})}startsWith(i,a){return this._addCheck({kind:"startsWith",value:i,...errorUtil.errToObj(a)})}endsWith(i,a){return this._addCheck({kind:"endsWith",value:i,...errorUtil.errToObj(a)})}min(i,a){return this._addCheck({kind:"min",value:i,...errorUtil.errToObj(a)})}max(i,a){return this._addCheck({kind:"max",value:i,...errorUtil.errToObj(a)})}length(i,a){return this._addCheck({kind:"length",value:i,...errorUtil.errToObj(a)})}nonempty(i){return this.min(1,errorUtil.errToObj(i))}trim(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(i=>i.kind==="datetime")}get isDate(){return!!this._def.checks.find(i=>i.kind==="date")}get isTime(){return!!this._def.checks.find(i=>i.kind==="time")}get isDuration(){return!!this._def.checks.find(i=>i.kind==="duration")}get isEmail(){return!!this._def.checks.find(i=>i.kind==="email")}get isURL(){return!!this._def.checks.find(i=>i.kind==="url")}get isEmoji(){return!!this._def.checks.find(i=>i.kind==="emoji")}get isUUID(){return!!this._def.checks.find(i=>i.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(i=>i.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(i=>i.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(i=>i.kind==="cuid2")}get isULID(){return!!this._def.checks.find(i=>i.kind==="ulid")}get isIP(){return!!this._def.checks.find(i=>i.kind==="ip")}get isBase64(){return!!this._def.checks.find(i=>i.kind==="base64")}get minLength(){let i=null;for(const a of this._def.checks)a.kind==="min"&&(i===null||a.value>i)&&(i=a.value);return i}get maxLength(){let i=null;for(const a of this._def.checks)a.kind==="max"&&(i===null||a.value<i)&&(i=a.value);return i}}ZodString.create=e=>{var i;return new ZodString({checks:[],typeName:ZodFirstPartyTypeKind.ZodString,coerce:(i=e==null?void 0:e.coerce)!==null&&i!==void 0?i:!1,...processCreateParams(e)})};function floatSafeRemainder(e,i){const a=(e.toString().split(".")[1]||"").length,o=(i.toString().split(".")[1]||"").length,c=a>o?a:o,s=parseInt(e.toFixed(c).replace(".","")),d=parseInt(i.toFixed(c).replace(".",""));return s%d/Math.pow(10,c)}class ZodNumber extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(i){if(this._def.coerce&&(i.data=Number(i.data)),this._getType(i)!==ZodParsedType.number){const s=this._getOrReturnCtx(i);return addIssueToContext(s,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.number,received:s.parsedType}),INVALID}let o;const c=new ParseStatus;for(const s of this._def.checks)s.kind==="int"?util.isInteger(i.data)||(o=this._getOrReturnCtx(i,o),addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:"integer",received:"float",message:s.message}),c.dirty()):s.kind==="min"?(s.inclusive?i.data<s.value:i.data<=s.value)&&(o=this._getOrReturnCtx(i,o),addIssueToContext(o,{code:ZodIssueCode.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),c.dirty()):s.kind==="max"?(s.inclusive?i.data>s.value:i.data>=s.value)&&(o=this._getOrReturnCtx(i,o),addIssueToContext(o,{code:ZodIssueCode.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),c.dirty()):s.kind==="multipleOf"?floatSafeRemainder(i.data,s.value)!==0&&(o=this._getOrReturnCtx(i,o),addIssueToContext(o,{code:ZodIssueCode.not_multiple_of,multipleOf:s.value,message:s.message}),c.dirty()):s.kind==="finite"?Number.isFinite(i.data)||(o=this._getOrReturnCtx(i,o),addIssueToContext(o,{code:ZodIssueCode.not_finite,message:s.message}),c.dirty()):util.assertNever(s);return{status:c.value,value:i.data}}gte(i,a){return this.setLimit("min",i,!0,errorUtil.toString(a))}gt(i,a){return this.setLimit("min",i,!1,errorUtil.toString(a))}lte(i,a){return this.setLimit("max",i,!0,errorUtil.toString(a))}lt(i,a){return this.setLimit("max",i,!1,errorUtil.toString(a))}setLimit(i,a,o,c){return new ZodNumber({...this._def,checks:[...this._def.checks,{kind:i,value:a,inclusive:o,message:errorUtil.toString(c)}]})}_addCheck(i){return new ZodNumber({...this._def,checks:[...this._def.checks,i]})}int(i){return this._addCheck({kind:"int",message:errorUtil.toString(i)})}positive(i){return this._addCheck({kind:"min",value:0,inclusive:!1,message:errorUtil.toString(i)})}negative(i){return this._addCheck({kind:"max",value:0,inclusive:!1,message:errorUtil.toString(i)})}nonpositive(i){return this._addCheck({kind:"max",value:0,inclusive:!0,message:errorUtil.toString(i)})}nonnegative(i){return this._addCheck({kind:"min",value:0,inclusive:!0,message:errorUtil.toString(i)})}multipleOf(i,a){return this._addCheck({kind:"multipleOf",value:i,message:errorUtil.toString(a)})}finite(i){return this._addCheck({kind:"finite",message:errorUtil.toString(i)})}safe(i){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:errorUtil.toString(i)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:errorUtil.toString(i)})}get minValue(){let i=null;for(const a of this._def.checks)a.kind==="min"&&(i===null||a.value>i)&&(i=a.value);return i}get maxValue(){let i=null;for(const a of this._def.checks)a.kind==="max"&&(i===null||a.value<i)&&(i=a.value);return i}get isInt(){return!!this._def.checks.find(i=>i.kind==="int"||i.kind==="multipleOf"&&util.isInteger(i.value))}get isFinite(){let i=null,a=null;for(const o of this._def.checks){if(o.kind==="finite"||o.kind==="int"||o.kind==="multipleOf")return!0;o.kind==="min"?(a===null||o.value>a)&&(a=o.value):o.kind==="max"&&(i===null||o.value<i)&&(i=o.value)}return Number.isFinite(a)&&Number.isFinite(i)}}ZodNumber.create=e=>new ZodNumber({checks:[],typeName:ZodFirstPartyTypeKind.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...processCreateParams(e)});class ZodBigInt extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(i){if(this._def.coerce&&(i.data=BigInt(i.data)),this._getType(i)!==ZodParsedType.bigint){const s=this._getOrReturnCtx(i);return addIssueToContext(s,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.bigint,received:s.parsedType}),INVALID}let o;const c=new ParseStatus;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?i.data<s.value:i.data<=s.value)&&(o=this._getOrReturnCtx(i,o),addIssueToContext(o,{code:ZodIssueCode.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),c.dirty()):s.kind==="max"?(s.inclusive?i.data>s.value:i.data>=s.value)&&(o=this._getOrReturnCtx(i,o),addIssueToContext(o,{code:ZodIssueCode.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),c.dirty()):s.kind==="multipleOf"?i.data%s.value!==BigInt(0)&&(o=this._getOrReturnCtx(i,o),addIssueToContext(o,{code:ZodIssueCode.not_multiple_of,multipleOf:s.value,message:s.message}),c.dirty()):util.assertNever(s);return{status:c.value,value:i.data}}gte(i,a){return this.setLimit("min",i,!0,errorUtil.toString(a))}gt(i,a){return this.setLimit("min",i,!1,errorUtil.toString(a))}lte(i,a){return this.setLimit("max",i,!0,errorUtil.toString(a))}lt(i,a){return this.setLimit("max",i,!1,errorUtil.toString(a))}setLimit(i,a,o,c){return new ZodBigInt({...this._def,checks:[...this._def.checks,{kind:i,value:a,inclusive:o,message:errorUtil.toString(c)}]})}_addCheck(i){return new ZodBigInt({...this._def,checks:[...this._def.checks,i]})}positive(i){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:errorUtil.toString(i)})}negative(i){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:errorUtil.toString(i)})}nonpositive(i){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:errorUtil.toString(i)})}nonnegative(i){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:errorUtil.toString(i)})}multipleOf(i,a){return this._addCheck({kind:"multipleOf",value:i,message:errorUtil.toString(a)})}get minValue(){let i=null;for(const a of this._def.checks)a.kind==="min"&&(i===null||a.value>i)&&(i=a.value);return i}get maxValue(){let i=null;for(const a of this._def.checks)a.kind==="max"&&(i===null||a.value<i)&&(i=a.value);return i}}ZodBigInt.create=e=>{var i;return new ZodBigInt({checks:[],typeName:ZodFirstPartyTypeKind.ZodBigInt,coerce:(i=e==null?void 0:e.coerce)!==null&&i!==void 0?i:!1,...processCreateParams(e)})};class ZodBoolean extends ZodType{_parse(i){if(this._def.coerce&&(i.data=!!i.data),this._getType(i)!==ZodParsedType.boolean){const o=this._getOrReturnCtx(i);return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.boolean,received:o.parsedType}),INVALID}return OK(i.data)}}ZodBoolean.create=e=>new ZodBoolean({typeName:ZodFirstPartyTypeKind.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...processCreateParams(e)});class ZodDate extends ZodType{_parse(i){if(this._def.coerce&&(i.data=new Date(i.data)),this._getType(i)!==ZodParsedType.date){const s=this._getOrReturnCtx(i);return addIssueToContext(s,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.date,received:s.parsedType}),INVALID}if(isNaN(i.data.getTime())){const s=this._getOrReturnCtx(i);return addIssueToContext(s,{code:ZodIssueCode.invalid_date}),INVALID}const o=new ParseStatus;let c;for(const s of this._def.checks)s.kind==="min"?i.data.getTime()<s.value&&(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{code:ZodIssueCode.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),o.dirty()):s.kind==="max"?i.data.getTime()>s.value&&(c=this._getOrReturnCtx(i,c),addIssueToContext(c,{code:ZodIssueCode.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),o.dirty()):util.assertNever(s);return{status:o.value,value:new Date(i.data.getTime())}}_addCheck(i){return new ZodDate({...this._def,checks:[...this._def.checks,i]})}min(i,a){return this._addCheck({kind:"min",value:i.getTime(),message:errorUtil.toString(a)})}max(i,a){return this._addCheck({kind:"max",value:i.getTime(),message:errorUtil.toString(a)})}get minDate(){let i=null;for(const a of this._def.checks)a.kind==="min"&&(i===null||a.value>i)&&(i=a.value);return i!=null?new Date(i):null}get maxDate(){let i=null;for(const a of this._def.checks)a.kind==="max"&&(i===null||a.value<i)&&(i=a.value);return i!=null?new Date(i):null}}ZodDate.create=e=>new ZodDate({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:ZodFirstPartyTypeKind.ZodDate,...processCreateParams(e)});class ZodSymbol extends ZodType{_parse(i){if(this._getType(i)!==ZodParsedType.symbol){const o=this._getOrReturnCtx(i);return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.symbol,received:o.parsedType}),INVALID}return OK(i.data)}}ZodSymbol.create=e=>new ZodSymbol({typeName:ZodFirstPartyTypeKind.ZodSymbol,...processCreateParams(e)});class ZodUndefined extends ZodType{_parse(i){if(this._getType(i)!==ZodParsedType.undefined){const o=this._getOrReturnCtx(i);return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.undefined,received:o.parsedType}),INVALID}return OK(i.data)}}ZodUndefined.create=e=>new ZodUndefined({typeName:ZodFirstPartyTypeKind.ZodUndefined,...processCreateParams(e)});class ZodNull extends ZodType{_parse(i){if(this._getType(i)!==ZodParsedType.null){const o=this._getOrReturnCtx(i);return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.null,received:o.parsedType}),INVALID}return OK(i.data)}}ZodNull.create=e=>new ZodNull({typeName:ZodFirstPartyTypeKind.ZodNull,...processCreateParams(e)});class ZodAny extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(i){return OK(i.data)}}ZodAny.create=e=>new ZodAny({typeName:ZodFirstPartyTypeKind.ZodAny,...processCreateParams(e)});class ZodUnknown extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(i){return OK(i.data)}}ZodUnknown.create=e=>new ZodUnknown({typeName:ZodFirstPartyTypeKind.ZodUnknown,...processCreateParams(e)});class ZodNever extends ZodType{_parse(i){const a=this._getOrReturnCtx(i);return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.never,received:a.parsedType}),INVALID}}ZodNever.create=e=>new ZodNever({typeName:ZodFirstPartyTypeKind.ZodNever,...processCreateParams(e)});class ZodVoid extends ZodType{_parse(i){if(this._getType(i)!==ZodParsedType.undefined){const o=this._getOrReturnCtx(i);return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.void,received:o.parsedType}),INVALID}return OK(i.data)}}ZodVoid.create=e=>new ZodVoid({typeName:ZodFirstPartyTypeKind.ZodVoid,...processCreateParams(e)});class ZodArray extends ZodType{_parse(i){const{ctx:a,status:o}=this._processInputParams(i),c=this._def;if(a.parsedType!==ZodParsedType.array)return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:a.parsedType}),INVALID;if(c.exactLength!==null){const d=a.data.length>c.exactLength.value,$=a.data.length<c.exactLength.value;(d||$)&&(addIssueToContext(a,{code:d?ZodIssueCode.too_big:ZodIssueCode.too_small,minimum:$?c.exactLength.value:void 0,maximum:d?c.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:c.exactLength.message}),o.dirty())}if(c.minLength!==null&&a.data.length<c.minLength.value&&(addIssueToContext(a,{code:ZodIssueCode.too_small,minimum:c.minLength.value,type:"array",inclusive:!0,exact:!1,message:c.minLength.message}),o.dirty()),c.maxLength!==null&&a.data.length>c.maxLength.value&&(addIssueToContext(a,{code:ZodIssueCode.too_big,maximum:c.maxLength.value,type:"array",inclusive:!0,exact:!1,message:c.maxLength.message}),o.dirty()),a.common.async)return Promise.all([...a.data].map((d,$)=>c.type._parseAsync(new ParseInputLazyPath(a,d,a.path,$)))).then(d=>ParseStatus.mergeArray(o,d));const s=[...a.data].map((d,$)=>c.type._parseSync(new ParseInputLazyPath(a,d,a.path,$)));return ParseStatus.mergeArray(o,s)}get element(){return this._def.type}min(i,a){return new ZodArray({...this._def,minLength:{value:i,message:errorUtil.toString(a)}})}max(i,a){return new ZodArray({...this._def,maxLength:{value:i,message:errorUtil.toString(a)}})}length(i,a){return new ZodArray({...this._def,exactLength:{value:i,message:errorUtil.toString(a)}})}nonempty(i){return this.min(1,i)}}ZodArray.create=(e,i)=>new ZodArray({type:e,minLength:null,maxLength:null,exactLength:null,typeName:ZodFirstPartyTypeKind.ZodArray,...processCreateParams(i)});function deepPartialify(e){if(e instanceof ZodObject){const i={};for(const a in e.shape){const o=e.shape[a];i[a]=ZodOptional.create(deepPartialify(o))}return new ZodObject({...e._def,shape:()=>i})}else return e instanceof ZodArray?new ZodArray({...e._def,type:deepPartialify(e.element)}):e instanceof ZodOptional?ZodOptional.create(deepPartialify(e.unwrap())):e instanceof ZodNullable?ZodNullable.create(deepPartialify(e.unwrap())):e instanceof ZodTuple?ZodTuple.create(e.items.map(i=>deepPartialify(i))):e}class ZodObject extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const i=this._def.shape(),a=util.objectKeys(i);return this._cached={shape:i,keys:a}}_parse(i){if(this._getType(i)!==ZodParsedType.object){const h=this._getOrReturnCtx(i);return addIssueToContext(h,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:h.parsedType}),INVALID}const{status:o,ctx:c}=this._processInputParams(i),{shape:s,keys:d}=this._getCached(),$=[];if(!(this._def.catchall instanceof ZodNever&&this._def.unknownKeys==="strip"))for(const h in c.data)d.includes(h)||$.push(h);const et=[];for(const h of d){const b=s[h],g=c.data[h];et.push({key:{status:"valid",value:h},value:b._parse(new ParseInputLazyPath(c,g,c.path,h)),alwaysSet:h in c.data})}if(this._def.catchall instanceof ZodNever){const h=this._def.unknownKeys;if(h==="passthrough")for(const b of $)et.push({key:{status:"valid",value:b},value:{status:"valid",value:c.data[b]}});else if(h==="strict")$.length>0&&(addIssueToContext(c,{code:ZodIssueCode.unrecognized_keys,keys:$}),o.dirty());else if(h!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const h=this._def.catchall;for(const b of $){const g=c.data[b];et.push({key:{status:"valid",value:b},value:h._parse(new ParseInputLazyPath(c,g,c.path,b)),alwaysSet:b in c.data})}}return c.common.async?Promise.resolve().then(async()=>{const h=[];for(const b of et){const g=await b.key,st=await b.value;h.push({key:g,value:st,alwaysSet:b.alwaysSet})}return h}).then(h=>ParseStatus.mergeObjectSync(o,h)):ParseStatus.mergeObjectSync(o,et)}get shape(){return this._def.shape()}strict(i){return errorUtil.errToObj,new ZodObject({...this._def,unknownKeys:"strict",...i!==void 0?{errorMap:(a,o)=>{var c,s,d,$;const et=(d=(s=(c=this._def).errorMap)===null||s===void 0?void 0:s.call(c,a,o).message)!==null&&d!==void 0?d:o.defaultError;return a.code==="unrecognized_keys"?{message:($=errorUtil.errToObj(i).message)!==null&&$!==void 0?$:et}:{message:et}}}:{}})}strip(){return new ZodObject({...this._def,unknownKeys:"strip"})}passthrough(){return new ZodObject({...this._def,unknownKeys:"passthrough"})}extend(i){return new ZodObject({...this._def,shape:()=>({...this._def.shape(),...i})})}merge(i){return new ZodObject({unknownKeys:i._def.unknownKeys,catchall:i._def.catchall,shape:()=>({...this._def.shape(),...i._def.shape()}),typeName:ZodFirstPartyTypeKind.ZodObject})}setKey(i,a){return this.augment({[i]:a})}catchall(i){return new ZodObject({...this._def,catchall:i})}pick(i){const a={};return util.objectKeys(i).forEach(o=>{i[o]&&this.shape[o]&&(a[o]=this.shape[o])}),new ZodObject({...this._def,shape:()=>a})}omit(i){const a={};return util.objectKeys(this.shape).forEach(o=>{i[o]||(a[o]=this.shape[o])}),new ZodObject({...this._def,shape:()=>a})}deepPartial(){return deepPartialify(this)}partial(i){const a={};return util.objectKeys(this.shape).forEach(o=>{const c=this.shape[o];i&&!i[o]?a[o]=c:a[o]=c.optional()}),new ZodObject({...this._def,shape:()=>a})}required(i){const a={};return util.objectKeys(this.shape).forEach(o=>{if(i&&!i[o])a[o]=this.shape[o];else{let s=this.shape[o];for(;s instanceof ZodOptional;)s=s._def.innerType;a[o]=s}}),new ZodObject({...this._def,shape:()=>a})}keyof(){return createZodEnum(util.objectKeys(this.shape))}}ZodObject.create=(e,i)=>new ZodObject({shape:()=>e,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(i)});ZodObject.strictCreate=(e,i)=>new ZodObject({shape:()=>e,unknownKeys:"strict",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(i)});ZodObject.lazycreate=(e,i)=>new ZodObject({shape:e,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(i)});class ZodUnion extends ZodType{_parse(i){const{ctx:a}=this._processInputParams(i),o=this._def.options;function c(s){for(const $ of s)if($.result.status==="valid")return $.result;for(const $ of s)if($.result.status==="dirty")return a.common.issues.push(...$.ctx.common.issues),$.result;const d=s.map($=>new ZodError($.ctx.common.issues));return addIssueToContext(a,{code:ZodIssueCode.invalid_union,unionErrors:d}),INVALID}if(a.common.async)return Promise.all(o.map(async s=>{const d={...a,common:{...a.common,issues:[]},parent:null};return{result:await s._parseAsync({data:a.data,path:a.path,parent:d}),ctx:d}})).then(c);{let s;const d=[];for(const et of o){const h={...a,common:{...a.common,issues:[]},parent:null},b=et._parseSync({data:a.data,path:a.path,parent:h});if(b.status==="valid")return b;b.status==="dirty"&&!s&&(s={result:b,ctx:h}),h.common.issues.length&&d.push(h.common.issues)}if(s)return a.common.issues.push(...s.ctx.common.issues),s.result;const $=d.map(et=>new ZodError(et));return addIssueToContext(a,{code:ZodIssueCode.invalid_union,unionErrors:$}),INVALID}}get options(){return this._def.options}}ZodUnion.create=(e,i)=>new ZodUnion({options:e,typeName:ZodFirstPartyTypeKind.ZodUnion,...processCreateParams(i)});const getDiscriminator=e=>e instanceof ZodLazy?getDiscriminator(e.schema):e instanceof ZodEffects?getDiscriminator(e.innerType()):e instanceof ZodLiteral?[e.value]:e instanceof ZodEnum?e.options:e instanceof ZodNativeEnum?util.objectValues(e.enum):e instanceof ZodDefault?getDiscriminator(e._def.innerType):e instanceof ZodUndefined?[void 0]:e instanceof ZodNull?[null]:e instanceof ZodOptional?[void 0,...getDiscriminator(e.unwrap())]:e instanceof ZodNullable?[null,...getDiscriminator(e.unwrap())]:e instanceof ZodBranded||e instanceof ZodReadonly?getDiscriminator(e.unwrap()):e instanceof ZodCatch?getDiscriminator(e._def.innerType):[];class ZodDiscriminatedUnion extends ZodType{_parse(i){const{ctx:a}=this._processInputParams(i);if(a.parsedType!==ZodParsedType.object)return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:a.parsedType}),INVALID;const o=this.discriminator,c=a.data[o],s=this.optionsMap.get(c);return s?a.common.async?s._parseAsync({data:a.data,path:a.path,parent:a}):s._parseSync({data:a.data,path:a.path,parent:a}):(addIssueToContext(a,{code:ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[o]}),INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(i,a,o){const c=new Map;for(const s of a){const d=getDiscriminator(s.shape[i]);if(!d.length)throw new Error(`A discriminator value for key \`${i}\` could not be extracted from all schema options`);for(const $ of d){if(c.has($))throw new Error(`Discriminator property ${String(i)} has duplicate value ${String($)}`);c.set($,s)}}return new ZodDiscriminatedUnion({typeName:ZodFirstPartyTypeKind.ZodDiscriminatedUnion,discriminator:i,options:a,optionsMap:c,...processCreateParams(o)})}}function mergeValues(e,i){const a=getParsedType(e),o=getParsedType(i);if(e===i)return{valid:!0,data:e};if(a===ZodParsedType.object&&o===ZodParsedType.object){const c=util.objectKeys(i),s=util.objectKeys(e).filter($=>c.indexOf($)!==-1),d={...e,...i};for(const $ of s){const et=mergeValues(e[$],i[$]);if(!et.valid)return{valid:!1};d[$]=et.data}return{valid:!0,data:d}}else if(a===ZodParsedType.array&&o===ZodParsedType.array){if(e.length!==i.length)return{valid:!1};const c=[];for(let s=0;s<e.length;s++){const d=e[s],$=i[s],et=mergeValues(d,$);if(!et.valid)return{valid:!1};c.push(et.data)}return{valid:!0,data:c}}else return a===ZodParsedType.date&&o===ZodParsedType.date&&+e==+i?{valid:!0,data:e}:{valid:!1}}class ZodIntersection extends ZodType{_parse(i){const{status:a,ctx:o}=this._processInputParams(i),c=(s,d)=>{if(isAborted(s)||isAborted(d))return INVALID;const $=mergeValues(s.value,d.value);return $.valid?((isDirty(s)||isDirty(d))&&a.dirty(),{status:a.value,value:$.data}):(addIssueToContext(o,{code:ZodIssueCode.invalid_intersection_types}),INVALID)};return o.common.async?Promise.all([this._def.left._parseAsync({data:o.data,path:o.path,parent:o}),this._def.right._parseAsync({data:o.data,path:o.path,parent:o})]).then(([s,d])=>c(s,d)):c(this._def.left._parseSync({data:o.data,path:o.path,parent:o}),this._def.right._parseSync({data:o.data,path:o.path,parent:o}))}}ZodIntersection.create=(e,i,a)=>new ZodIntersection({left:e,right:i,typeName:ZodFirstPartyTypeKind.ZodIntersection,...processCreateParams(a)});class ZodTuple extends ZodType{_parse(i){const{status:a,ctx:o}=this._processInputParams(i);if(o.parsedType!==ZodParsedType.array)return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:o.parsedType}),INVALID;if(o.data.length<this._def.items.length)return addIssueToContext(o,{code:ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),INVALID;!this._def.rest&&o.data.length>this._def.items.length&&(addIssueToContext(o,{code:ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());const s=[...o.data].map((d,$)=>{const et=this._def.items[$]||this._def.rest;return et?et._parse(new ParseInputLazyPath(o,d,o.path,$)):null}).filter(d=>!!d);return o.common.async?Promise.all(s).then(d=>ParseStatus.mergeArray(a,d)):ParseStatus.mergeArray(a,s)}get items(){return this._def.items}rest(i){return new ZodTuple({...this._def,rest:i})}}ZodTuple.create=(e,i)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:e,typeName:ZodFirstPartyTypeKind.ZodTuple,rest:null,...processCreateParams(i)})};class ZodRecord extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(i){const{status:a,ctx:o}=this._processInputParams(i);if(o.parsedType!==ZodParsedType.object)return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:o.parsedType}),INVALID;const c=[],s=this._def.keyType,d=this._def.valueType;for(const $ in o.data)c.push({key:s._parse(new ParseInputLazyPath(o,$,o.path,$)),value:d._parse(new ParseInputLazyPath(o,o.data[$],o.path,$)),alwaysSet:$ in o.data});return o.common.async?ParseStatus.mergeObjectAsync(a,c):ParseStatus.mergeObjectSync(a,c)}get element(){return this._def.valueType}static create(i,a,o){return a instanceof ZodType?new ZodRecord({keyType:i,valueType:a,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(o)}):new ZodRecord({keyType:ZodString.create(),valueType:i,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(a)})}}class ZodMap extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(i){const{status:a,ctx:o}=this._processInputParams(i);if(o.parsedType!==ZodParsedType.map)return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.map,received:o.parsedType}),INVALID;const c=this._def.keyType,s=this._def.valueType,d=[...o.data.entries()].map(([$,et],h)=>({key:c._parse(new ParseInputLazyPath(o,$,o.path,[h,"key"])),value:s._parse(new ParseInputLazyPath(o,et,o.path,[h,"value"]))}));if(o.common.async){const $=new Map;return Promise.resolve().then(async()=>{for(const et of d){const h=await et.key,b=await et.value;if(h.status==="aborted"||b.status==="aborted")return INVALID;(h.status==="dirty"||b.status==="dirty")&&a.dirty(),$.set(h.value,b.value)}return{status:a.value,value:$}})}else{const $=new Map;for(const et of d){const h=et.key,b=et.value;if(h.status==="aborted"||b.status==="aborted")return INVALID;(h.status==="dirty"||b.status==="dirty")&&a.dirty(),$.set(h.value,b.value)}return{status:a.value,value:$}}}}ZodMap.create=(e,i,a)=>new ZodMap({valueType:i,keyType:e,typeName:ZodFirstPartyTypeKind.ZodMap,...processCreateParams(a)});class ZodSet extends ZodType{_parse(i){const{status:a,ctx:o}=this._processInputParams(i);if(o.parsedType!==ZodParsedType.set)return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.set,received:o.parsedType}),INVALID;const c=this._def;c.minSize!==null&&o.data.size<c.minSize.value&&(addIssueToContext(o,{code:ZodIssueCode.too_small,minimum:c.minSize.value,type:"set",inclusive:!0,exact:!1,message:c.minSize.message}),a.dirty()),c.maxSize!==null&&o.data.size>c.maxSize.value&&(addIssueToContext(o,{code:ZodIssueCode.too_big,maximum:c.maxSize.value,type:"set",inclusive:!0,exact:!1,message:c.maxSize.message}),a.dirty());const s=this._def.valueType;function d(et){const h=new Set;for(const b of et){if(b.status==="aborted")return INVALID;b.status==="dirty"&&a.dirty(),h.add(b.value)}return{status:a.value,value:h}}const $=[...o.data.values()].map((et,h)=>s._parse(new ParseInputLazyPath(o,et,o.path,h)));return o.common.async?Promise.all($).then(et=>d(et)):d($)}min(i,a){return new ZodSet({...this._def,minSize:{value:i,message:errorUtil.toString(a)}})}max(i,a){return new ZodSet({...this._def,maxSize:{value:i,message:errorUtil.toString(a)}})}size(i,a){return this.min(i,a).max(i,a)}nonempty(i){return this.min(1,i)}}ZodSet.create=(e,i)=>new ZodSet({valueType:e,minSize:null,maxSize:null,typeName:ZodFirstPartyTypeKind.ZodSet,...processCreateParams(i)});class ZodFunction extends ZodType{constructor(){super(...arguments),this.validate=this.implement}_parse(i){const{ctx:a}=this._processInputParams(i);if(a.parsedType!==ZodParsedType.function)return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.function,received:a.parsedType}),INVALID;function o($,et){return makeIssue({data:$,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,getErrorMap(),errorMap].filter(h=>!!h),issueData:{code:ZodIssueCode.invalid_arguments,argumentsError:et}})}function c($,et){return makeIssue({data:$,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,getErrorMap(),errorMap].filter(h=>!!h),issueData:{code:ZodIssueCode.invalid_return_type,returnTypeError:et}})}const s={errorMap:a.common.contextualErrorMap},d=a.data;if(this._def.returns instanceof ZodPromise){const $=this;return OK(async function(...et){const h=new ZodError([]),b=await $._def.args.parseAsync(et,s).catch($t=>{throw h.addIssue(o(et,$t)),h}),g=await Reflect.apply(d,this,b);return await $._def.returns._def.type.parseAsync(g,s).catch($t=>{throw h.addIssue(c(g,$t)),h})})}else{const $=this;return OK(function(...et){const h=$._def.args.safeParse(et,s);if(!h.success)throw new ZodError([o(et,h.error)]);const b=Reflect.apply(d,this,h.data),g=$._def.returns.safeParse(b,s);if(!g.success)throw new ZodError([c(b,g.error)]);return g.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...i){return new ZodFunction({...this._def,args:ZodTuple.create(i).rest(ZodUnknown.create())})}returns(i){return new ZodFunction({...this._def,returns:i})}implement(i){return this.parse(i)}strictImplement(i){return this.parse(i)}static create(i,a,o){return new ZodFunction({args:i||ZodTuple.create([]).rest(ZodUnknown.create()),returns:a||ZodUnknown.create(),typeName:ZodFirstPartyTypeKind.ZodFunction,...processCreateParams(o)})}}class ZodLazy extends ZodType{get schema(){return this._def.getter()}_parse(i){const{ctx:a}=this._processInputParams(i);return this._def.getter()._parse({data:a.data,path:a.path,parent:a})}}ZodLazy.create=(e,i)=>new ZodLazy({getter:e,typeName:ZodFirstPartyTypeKind.ZodLazy,...processCreateParams(i)});class ZodLiteral extends ZodType{_parse(i){if(i.data!==this._def.value){const a=this._getOrReturnCtx(i);return addIssueToContext(a,{received:a.data,code:ZodIssueCode.invalid_literal,expected:this._def.value}),INVALID}return{status:"valid",value:i.data}}get value(){return this._def.value}}ZodLiteral.create=(e,i)=>new ZodLiteral({value:e,typeName:ZodFirstPartyTypeKind.ZodLiteral,...processCreateParams(i)});function createZodEnum(e,i){return new ZodEnum({values:e,typeName:ZodFirstPartyTypeKind.ZodEnum,...processCreateParams(i)})}class ZodEnum extends ZodType{constructor(){super(...arguments),_ZodEnum_cache.set(this,void 0)}_parse(i){if(typeof i.data!="string"){const a=this._getOrReturnCtx(i),o=this._def.values;return addIssueToContext(a,{expected:util.joinValues(o),received:a.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodEnum_cache,"f")||__classPrivateFieldSet(this,_ZodEnum_cache,new Set(this._def.values),"f"),!__classPrivateFieldGet(this,_ZodEnum_cache,"f").has(i.data)){const a=this._getOrReturnCtx(i),o=this._def.values;return addIssueToContext(a,{received:a.data,code:ZodIssueCode.invalid_enum_value,options:o}),INVALID}return OK(i.data)}get options(){return this._def.values}get enum(){const i={};for(const a of this._def.values)i[a]=a;return i}get Values(){const i={};for(const a of this._def.values)i[a]=a;return i}get Enum(){const i={};for(const a of this._def.values)i[a]=a;return i}extract(i,a=this._def){return ZodEnum.create(i,{...this._def,...a})}exclude(i,a=this._def){return ZodEnum.create(this.options.filter(o=>!i.includes(o)),{...this._def,...a})}}_ZodEnum_cache=new WeakMap;ZodEnum.create=createZodEnum;class ZodNativeEnum extends ZodType{constructor(){super(...arguments),_ZodNativeEnum_cache.set(this,void 0)}_parse(i){const a=util.getValidEnumValues(this._def.values),o=this._getOrReturnCtx(i);if(o.parsedType!==ZodParsedType.string&&o.parsedType!==ZodParsedType.number){const c=util.objectValues(a);return addIssueToContext(o,{expected:util.joinValues(c),received:o.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodNativeEnum_cache,"f")||__classPrivateFieldSet(this,_ZodNativeEnum_cache,new Set(util.getValidEnumValues(this._def.values)),"f"),!__classPrivateFieldGet(this,_ZodNativeEnum_cache,"f").has(i.data)){const c=util.objectValues(a);return addIssueToContext(o,{received:o.data,code:ZodIssueCode.invalid_enum_value,options:c}),INVALID}return OK(i.data)}get enum(){return this._def.values}}_ZodNativeEnum_cache=new WeakMap;ZodNativeEnum.create=(e,i)=>new ZodNativeEnum({values:e,typeName:ZodFirstPartyTypeKind.ZodNativeEnum,...processCreateParams(i)});class ZodPromise extends ZodType{unwrap(){return this._def.type}_parse(i){const{ctx:a}=this._processInputParams(i);if(a.parsedType!==ZodParsedType.promise&&a.common.async===!1)return addIssueToContext(a,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.promise,received:a.parsedType}),INVALID;const o=a.parsedType===ZodParsedType.promise?a.data:Promise.resolve(a.data);return OK(o.then(c=>this._def.type.parseAsync(c,{path:a.path,errorMap:a.common.contextualErrorMap})))}}ZodPromise.create=(e,i)=>new ZodPromise({type:e,typeName:ZodFirstPartyTypeKind.ZodPromise,...processCreateParams(i)});class ZodEffects extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ZodFirstPartyTypeKind.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(i){const{status:a,ctx:o}=this._processInputParams(i),c=this._def.effect||null,s={addIssue:d=>{addIssueToContext(o,d),d.fatal?a.abort():a.dirty()},get path(){return o.path}};if(s.addIssue=s.addIssue.bind(s),c.type==="preprocess"){const d=c.transform(o.data,s);if(o.common.async)return Promise.resolve(d).then(async $=>{if(a.value==="aborted")return INVALID;const et=await this._def.schema._parseAsync({data:$,path:o.path,parent:o});return et.status==="aborted"?INVALID:et.status==="dirty"||a.value==="dirty"?DIRTY(et.value):et});{if(a.value==="aborted")return INVALID;const $=this._def.schema._parseSync({data:d,path:o.path,parent:o});return $.status==="aborted"?INVALID:$.status==="dirty"||a.value==="dirty"?DIRTY($.value):$}}if(c.type==="refinement"){const d=$=>{const et=c.refinement($,s);if(o.common.async)return Promise.resolve(et);if(et instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return $};if(o.common.async===!1){const $=this._def.schema._parseSync({data:o.data,path:o.path,parent:o});return $.status==="aborted"?INVALID:($.status==="dirty"&&a.dirty(),d($.value),{status:a.value,value:$.value})}else return this._def.schema._parseAsync({data:o.data,path:o.path,parent:o}).then($=>$.status==="aborted"?INVALID:($.status==="dirty"&&a.dirty(),d($.value).then(()=>({status:a.value,value:$.value}))))}if(c.type==="transform")if(o.common.async===!1){const d=this._def.schema._parseSync({data:o.data,path:o.path,parent:o});if(!isValid$1(d))return d;const $=c.transform(d.value,s);if($ instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:$}}else return this._def.schema._parseAsync({data:o.data,path:o.path,parent:o}).then(d=>isValid$1(d)?Promise.resolve(c.transform(d.value,s)).then($=>({status:a.value,value:$})):d);util.assertNever(c)}}ZodEffects.create=(e,i,a)=>new ZodEffects({schema:e,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:i,...processCreateParams(a)});ZodEffects.createWithPreprocess=(e,i,a)=>new ZodEffects({schema:i,effect:{type:"preprocess",transform:e},typeName:ZodFirstPartyTypeKind.ZodEffects,...processCreateParams(a)});class ZodOptional extends ZodType{_parse(i){return this._getType(i)===ZodParsedType.undefined?OK(void 0):this._def.innerType._parse(i)}unwrap(){return this._def.innerType}}ZodOptional.create=(e,i)=>new ZodOptional({innerType:e,typeName:ZodFirstPartyTypeKind.ZodOptional,...processCreateParams(i)});class ZodNullable extends ZodType{_parse(i){return this._getType(i)===ZodParsedType.null?OK(null):this._def.innerType._parse(i)}unwrap(){return this._def.innerType}}ZodNullable.create=(e,i)=>new ZodNullable({innerType:e,typeName:ZodFirstPartyTypeKind.ZodNullable,...processCreateParams(i)});class ZodDefault extends ZodType{_parse(i){const{ctx:a}=this._processInputParams(i);let o=a.data;return a.parsedType===ZodParsedType.undefined&&(o=this._def.defaultValue()),this._def.innerType._parse({data:o,path:a.path,parent:a})}removeDefault(){return this._def.innerType}}ZodDefault.create=(e,i)=>new ZodDefault({innerType:e,typeName:ZodFirstPartyTypeKind.ZodDefault,defaultValue:typeof i.default=="function"?i.default:()=>i.default,...processCreateParams(i)});class ZodCatch extends ZodType{_parse(i){const{ctx:a}=this._processInputParams(i),o={...a,common:{...a.common,issues:[]}},c=this._def.innerType._parse({data:o.data,path:o.path,parent:{...o}});return isAsync(c)?c.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ZodError(o.common.issues)},input:o.data})})):{status:"valid",value:c.status==="valid"?c.value:this._def.catchValue({get error(){return new ZodError(o.common.issues)},input:o.data})}}removeCatch(){return this._def.innerType}}ZodCatch.create=(e,i)=>new ZodCatch({innerType:e,typeName:ZodFirstPartyTypeKind.ZodCatch,catchValue:typeof i.catch=="function"?i.catch:()=>i.catch,...processCreateParams(i)});class ZodNaN extends ZodType{_parse(i){if(this._getType(i)!==ZodParsedType.nan){const o=this._getOrReturnCtx(i);return addIssueToContext(o,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.nan,received:o.parsedType}),INVALID}return{status:"valid",value:i.data}}}ZodNaN.create=e=>new ZodNaN({typeName:ZodFirstPartyTypeKind.ZodNaN,...processCreateParams(e)});const BRAND=Symbol("zod_brand");class ZodBranded extends ZodType{_parse(i){const{ctx:a}=this._processInputParams(i),o=a.data;return this._def.type._parse({data:o,path:a.path,parent:a})}unwrap(){return this._def.type}}class ZodPipeline extends ZodType{_parse(i){const{status:a,ctx:o}=this._processInputParams(i);if(o.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:o.data,path:o.path,parent:o});return s.status==="aborted"?INVALID:s.status==="dirty"?(a.dirty(),DIRTY(s.value)):this._def.out._parseAsync({data:s.value,path:o.path,parent:o})})();{const c=this._def.in._parseSync({data:o.data,path:o.path,parent:o});return c.status==="aborted"?INVALID:c.status==="dirty"?(a.dirty(),{status:"dirty",value:c.value}):this._def.out._parseSync({data:c.value,path:o.path,parent:o})}}static create(i,a){return new ZodPipeline({in:i,out:a,typeName:ZodFirstPartyTypeKind.ZodPipeline})}}class ZodReadonly extends ZodType{_parse(i){const a=this._def.innerType._parse(i),o=c=>(isValid$1(c)&&(c.value=Object.freeze(c.value)),c);return isAsync(a)?a.then(c=>o(c)):o(a)}unwrap(){return this._def.innerType}}ZodReadonly.create=(e,i)=>new ZodReadonly({innerType:e,typeName:ZodFirstPartyTypeKind.ZodReadonly,...processCreateParams(i)});function custom(e,i={},a){return e?ZodAny.create().superRefine((o,c)=>{var s,d;if(!e(o)){const $=typeof i=="function"?i(o):typeof i=="string"?{message:i}:i,et=(d=(s=$.fatal)!==null&&s!==void 0?s:a)!==null&&d!==void 0?d:!0,h=typeof $=="string"?{message:$}:$;c.addIssue({code:"custom",...h,fatal:et})}}):ZodAny.create()}const late={object:ZodObject.lazycreate};var ZodFirstPartyTypeKind;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(ZodFirstPartyTypeKind||(ZodFirstPartyTypeKind={}));const instanceOfType=(e,i={message:`Input not instance of ${e.name}`})=>custom(a=>a instanceof e,i),stringType=ZodString.create,numberType=ZodNumber.create,nanType=ZodNaN.create,bigIntType=ZodBigInt.create,booleanType=ZodBoolean.create,dateType=ZodDate.create,symbolType=ZodSymbol.create,undefinedType=ZodUndefined.create,nullType=ZodNull.create,anyType=ZodAny.create,unknownType=ZodUnknown.create,neverType=ZodNever.create,voidType=ZodVoid.create,arrayType=ZodArray.create,objectType=ZodObject.create,strictObjectType=ZodObject.strictCreate,unionType=ZodUnion.create,discriminatedUnionType=ZodDiscriminatedUnion.create,intersectionType=ZodIntersection.create,tupleType=ZodTuple.create,recordType=ZodRecord.create,mapType=ZodMap.create,setType=ZodSet.create,functionType=ZodFunction.create,lazyType=ZodLazy.create,literalType=ZodLiteral.create,enumType=ZodEnum.create,nativeEnumType=ZodNativeEnum.create,promiseType=ZodPromise.create,effectsType=ZodEffects.create,optionalType=ZodOptional.create,nullableType=ZodNullable.create,preprocessType=ZodEffects.createWithPreprocess,pipelineType=ZodPipeline.create,ostring=()=>stringType().optional(),onumber=()=>numberType().optional(),oboolean=()=>booleanType().optional(),coerce={string:e=>ZodString.create({...e,coerce:!0}),number:e=>ZodNumber.create({...e,coerce:!0}),boolean:e=>ZodBoolean.create({...e,coerce:!0}),bigint:e=>ZodBigInt.create({...e,coerce:!0}),date:e=>ZodDate.create({...e,coerce:!0})},NEVER=INVALID;var z=Object.freeze({__proto__:null,defaultErrorMap:errorMap,setErrorMap,getErrorMap,makeIssue,EMPTY_PATH,addIssueToContext,ParseStatus,INVALID,DIRTY,OK,isAborted,isDirty,isValid:isValid$1,isAsync,get util(){return util},get objectUtil(){return objectUtil},ZodParsedType,getParsedType,ZodType,datetimeRegex,ZodString,ZodNumber,ZodBigInt,ZodBoolean,ZodDate,ZodSymbol,ZodUndefined,ZodNull,ZodAny,ZodUnknown,ZodNever,ZodVoid,ZodArray,ZodObject,ZodUnion,ZodDiscriminatedUnion,ZodIntersection,ZodTuple,ZodRecord,ZodMap,ZodSet,ZodFunction,ZodLazy,ZodLiteral,ZodEnum,ZodNativeEnum,ZodPromise,ZodEffects,ZodTransformer:ZodEffects,ZodOptional,ZodNullable,ZodDefault,ZodCatch,ZodNaN,BRAND,ZodBranded,ZodPipeline,ZodReadonly,custom,Schema:ZodType,ZodSchema:ZodType,late,get ZodFirstPartyTypeKind(){return ZodFirstPartyTypeKind},coerce,any:anyType,array:arrayType,bigint:bigIntType,boolean:booleanType,date:dateType,discriminatedUnion:discriminatedUnionType,effect:effectsType,enum:enumType,function:functionType,instanceof:instanceOfType,intersection:intersectionType,lazy:lazyType,literal:literalType,map:mapType,nan:nanType,nativeEnum:nativeEnumType,never:neverType,null:nullType,nullable:nullableType,number:numberType,object:objectType,oboolean,onumber,optional:optionalType,ostring,pipeline:pipelineType,preprocess:preprocessType,promise:promiseType,record:recordType,set:setType,strictObject:strictObjectType,string:stringType,symbol:symbolType,transformer:effectsType,tuple:tupleType,undefined:undefinedType,union:unionType,unknown:unknownType,void:voidType,NEVER,ZodIssueCode,quotelessJson,ZodError}),__create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__commonJS=(e,i)=>function(){return i||(0,e[__getOwnPropNames(e)[0]])((i={exports:{}}).exports,i),i.exports},__copyProps=(e,i,a,o)=>{if(i&&typeof i=="object"||typeof i=="function")for(let c of __getOwnPropNames(i))!__hasOwnProp.call(e,c)&&c!==a&&__defProp(e,c,{get:()=>i[c],enumerable:!(o=__getOwnPropDesc(i,c))||o.enumerable});return e},__toESM=(e,i,a)=>(a=e!=null?__create(__getProtoOf(e)):{},__copyProps(i||!e||!e.__esModule?__defProp(a,"default",{value:e,enumerable:!0}):a,e)),require_lodash=__commonJS({"../../node_modules/lodash/lodash.js"(e,i){(function(){var a,o="4.17.21",c=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",$="Invalid `variable` option passed into `_.template`",et="__lodash_hash_undefined__",h=500,b="__lodash_placeholder__",g=1,st=2,$t=4,vt=1,Ft=2,Gt=1,qt=2,Lt=4,rr=8,jr=16,Hr=32,wn=64,_n=128,No=256,Qo=512,Xo=30,l0="...",v0=800,x0=16,D0=1,M0=2,Mo=3,e0=1/0,Sn=9007199254740991,t0=17976931348623157e292,d0=0/0,xn=4294967295,f0=xn-1,$0=xn>>>1,N0=[["ary",_n],["bind",Gt],["bindKey",qt],["curry",rr],["curryRight",jr],["flip",Qo],["partial",Hr],["partialRight",wn],["rearg",No]],j0="[object Arguments]",Z0="[object Array]",fy="[object AsyncFunction]",oy="[object Boolean]",gy="[object Date]",hy="[object DOMException]",J0="[object Error]",H0="[object Function]",yy="[object GeneratorFunction]",vy="[object Map]",$y="[object Number]",o1="[object Null]",_y="[object Object]",Gy="[object Promise]",fv="[object Proxy]",Ly="[object RegExp]",Iy="[object Set]",Ny="[object String]",py="[object Symbol]",n1="[object Undefined]",Ay="[object WeakMap]",s1="[object WeakSet]",xy="[object ArrayBuffer]",u1="[object DataView]",ay="[object Float32Array]",qy="[object Float64Array]",L0="[object Int8Array]",Dy="[object Int16Array]",l1="[object Int32Array]",g1="[object Uint8Array]",T0="[object Uint8ClampedArray]",d1="[object Uint16Array]",U0="[object Uint32Array]",Py=/\b__p \+= '';/g,Yr=/\b(__p \+=) '' \+/g,Ro=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Bo=/&(?:amp|lt|gt|quot|#39);/g,a0=/[&<>"']/g,u0=RegExp(Bo.source),O0=RegExp(a0.source),G0=/<%-([\s\S]+?)%>/g,Cy=/<%([\s\S]+?)%>/g,Uy=/<%=([\s\S]+?)%>/g,Ry=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Oy=/^\w*$/,P1=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Zy=/[\\^$.*+?()[\]{}|]/g,_g=RegExp(Zy.source),ey=/^\s+/,ty=/\s/,Ey=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,R1=/\{\n\/\* \[wrapped with (.+)\] \*/,c1=/,? & /,hv=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,mv=/[()=,{}\[\]\/\s]/,kv=/\\(\\)?/g,Q1=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,gv=/\w*$/,yv=/^[-+]0x[0-9a-f]+$/i,J1=/^0b[01]+$/i,vv=/^\[object .+?Constructor\]$/,T1=/^0o[0-7]+$/i,U1=/^(?:0|[1-9]\d*)$/,Iv=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,S1=/($^)/,Jy=/['\n\r\u2028\u2029\\]/g,E1="\\ud800-\\udfff",ev="\\u0300-\\u036f",p1="\\ufe20-\\ufe2f",Cv="\\u20d0-\\u20ff",zy=ev+p1+Cv,tv="\\u2700-\\u27bf",F1="a-z\\xdf-\\xf6\\xf8-\\xff",e1="\\xac\\xb1\\xd7\\xf7",rv="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",jy="\\u2000-\\u206f",Ky=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",D1="A-Z\\xc0-\\xd6\\xd8-\\xde",Ov="\\ufe0e\\ufe0f",Av=e1+rv+jy+Ky,nv="['’]",Wv="["+E1+"]",Pv="["+Av+"]",iv="["+zy+"]",P0="\\d+",bv="["+tv+"]",z0="["+F1+"]",av="[^"+E1+Av+P0+tv+F1+D1+"]",f1="\\ud83c[\\udffb-\\udfff]",Fy="(?:"+iv+"|"+f1+")",W1="[^"+E1+"]",M1="(?:\\ud83c[\\udde6-\\uddff]){2}",V1="[\\ud800-\\udbff][\\udc00-\\udfff]",Yy="["+D1+"]",ov="\\u200d",t1="(?:"+z0+"|"+av+")",i1="(?:"+Yy+"|"+av+")",H1="(?:"+nv+"(?:d|ll|m|re|s|t|ve))?",y1="(?:"+nv+"(?:D|LL|M|RE|S|T|VE))?",nr=Fy+"?",wt="["+Ov+"]?",jt="(?:"+ov+"(?:"+[W1,M1,V1].join("|")+")"+wt+nr+")*",tr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",or="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",qr=wt+nr+jt,Tn="(?:"+[bv,M1,V1].join("|")+")"+qr,o0="(?:"+[W1+iv+"?",iv,M1,V1,Wv].join("|")+")",h0=RegExp(nv,"g"),b0=RegExp(iv,"g"),y0=RegExp(f1+"(?="+f1+")|"+o0+qr,"g"),R0=RegExp([Yy+"?"+z0+"+"+H1+"(?="+[Pv,Yy,"$"].join("|")+")",i1+"+"+y1+"(?="+[Pv,Yy+t1,"$"].join("|")+")",Yy+"?"+t1+"+"+H1,Yy+"+"+y1,or,tr,P0,Tn].join("|"),"g"),ry=RegExp("["+ov+E1+zy+Ov+"]"),Go=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Uo=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],S0=-1,E0={};E0[ay]=E0[qy]=E0[L0]=E0[Dy]=E0[l1]=E0[g1]=E0[T0]=E0[d1]=E0[U0]=!0,E0[j0]=E0[Z0]=E0[xy]=E0[oy]=E0[u1]=E0[gy]=E0[J0]=E0[H0]=E0[vy]=E0[$y]=E0[_y]=E0[Ly]=E0[Iy]=E0[Ny]=E0[Ay]=!1;var ny={};ny[j0]=ny[Z0]=ny[xy]=ny[u1]=ny[oy]=ny[gy]=ny[ay]=ny[qy]=ny[L0]=ny[Dy]=ny[l1]=ny[vy]=ny[$y]=ny[_y]=ny[Ly]=ny[Iy]=ny[Ny]=ny[py]=ny[g1]=ny[T0]=ny[d1]=ny[U0]=!0,ny[J0]=ny[H0]=ny[Ay]=!1;var sv={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},ow={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},sw={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},uw={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},lw=parseFloat,E$=parseInt,k$=typeof global=="object"&&global&&global.Object===Object&&global,I$=typeof self=="object"&&self&&self.Object===Object&&self,Wy=k$||I$||Function("return this")(),Jv=typeof e=="object"&&e&&!e.nodeType&&e,$v=Jv&&typeof i=="object"&&i&&!i.nodeType&&i,C$=$v&&$v.exports===Jv,u$=C$&&k$.process,v1=function(){try{var ko=$v&&$v.require&&$v.require("util").types;return ko||u$&&u$.binding&&u$.binding("util")}catch{}}(),O$=v1&&v1.isArrayBuffer,dw=v1&&v1.isDate,A$=v1&&v1.isMap,P$=v1&&v1.isRegExp,R$=v1&&v1.isSet,cw=v1&&v1.isTypedArray;function b1(ko,s0,r0){switch(r0.length){case 0:return ko.call(s0);case 1:return ko.call(s0,r0[0]);case 2:return ko.call(s0,r0[0],r0[1]);case 3:return ko.call(s0,r0[0],r0[1],r0[2])}return ko.apply(s0,r0)}function pw(ko,s0,r0,I0){for(var K0=-1,by=ko==null?0:ko.length;++K0<by;){var Xy=ko[K0];s0(I0,Xy,r0(Xy),ko)}return I0}function $1(ko,s0){for(var r0=-1,I0=ko==null?0:ko.length;++r0<I0&&s0(ko[r0],r0,ko)!==!1;);return ko}function l$(ko,s0){for(var r0=ko==null?0:ko.length;r0--&&s0(ko[r0],r0,ko)!==!1;);return ko}function fw(ko,s0){for(var r0=-1,I0=ko==null?0:ko.length;++r0<I0;)if(!s0(ko[r0],r0,ko))return!1;return!0}function wv(ko,s0){for(var r0=-1,I0=ko==null?0:ko.length,K0=0,by=[];++r0<I0;){var Xy=ko[r0];s0(Xy,r0,ko)&&(by[K0++]=Xy)}return by}function C0(ko,s0){var r0=ko==null?0:ko.length;return!!r0&&_v(ko,s0,0)>-1}function d$(ko,s0,r0){for(var I0=-1,K0=ko==null?0:ko.length;++I0<K0;)if(r0(s0,ko[I0]))return!0;return!1}function Ty(ko,s0){for(var r0=-1,I0=ko==null?0:ko.length,K0=Array(I0);++r0<I0;)K0[r0]=s0(ko[r0],r0,ko);return K0}function N1(ko,s0){for(var r0=-1,I0=s0.length,K0=ko.length;++r0<I0;)ko[K0+r0]=s0[r0];return ko}function k1(ko,s0,r0,I0){var K0=-1,by=ko==null?0:ko.length;for(I0&&by&&(r0=ko[++K0]);++K0<by;)r0=s0(r0,ko[K0],K0,ko);return r0}function hw(ko,s0,r0,I0){var K0=ko==null?0:ko.length;for(I0&&K0&&(r0=ko[--K0]);K0--;)r0=s0(r0,ko[K0],K0,ko);return r0}function c$(ko,s0){for(var r0=-1,I0=ko==null?0:ko.length;++r0<I0;)if(s0(ko[r0],r0,ko))return!0;return!1}var D$=p$("length");function M$(ko){return ko.split("")}function mw(ko){return ko.match(hv)||[]}function N$(ko,s0,r0){var I0;return r0(ko,function(K0,by,Xy){if(s0(K0,by,Xy))return I0=by,!1}),I0}function Rv(ko,s0,r0,I0){for(var K0=ko.length,by=r0+(I0?1:-1);I0?by--:++by<K0;)if(s0(ko[by],by,ko))return by;return-1}function _v(ko,s0,r0){return s0===s0?Yx(ko,s0,r0):Rv(ko,j$,r0)}function z$(ko,s0,r0,I0){for(var K0=r0-1,by=ko.length;++K0<by;)if(I0(ko[K0],s0))return K0;return-1}function j$(ko){return ko!==ko}function B$(ko,s0){var r0=ko==null?0:ko.length;return r0?Vv(ko,s0)/r0:d0}function p$(ko){return function(s0){return s0==null?a:s0[ko]}}function f$(ko){return function(s0){return ko==null?a:ko[s0]}}function L$(ko,s0,r0,I0,K0){return K0(ko,function(by,Xy,ky){r0=I0?(I0=!1,by):s0(r0,by,Xy,ky)}),r0}function t2(ko,s0){var r0=ko.length;for(ko.sort(s0);r0--;)ko[r0]=ko[r0].value;return ko}function Vv(ko,s0){for(var r0,I0=-1,K0=ko.length;++I0<K0;){var by=s0(ko[I0]);by!==a&&(r0=r0===a?by:r0+by)}return r0}function m$(ko,s0){for(var r0=-1,I0=Array(ko);++r0<ko;)I0[r0]=s0(r0);return I0}function Ct(ko,s0){return Ty(s0,function(r0){return[r0,ko[r0]]})}function Ht(ko){return ko&&ko.slice(0,J2(ko)+1).replace(ey,"")}function ir(ko){return function(s0){return ko(s0)}}function Lr(ko,s0){return Ty(s0,function(r0){return ko[r0]})}function Xr(ko,s0){return ko.has(s0)}function An(ko,s0){for(var r0=-1,I0=ko.length;++r0<I0&&_v(s0,ko[r0],0)>-1;);return r0}function i0(ko,s0){for(var r0=ko.length;r0--&&_v(s0,ko[r0],0)>-1;);return r0}function g0(ko,s0){for(var r0=ko.length,I0=0;r0--;)ko[r0]===s0&&++I0;return I0}var k0=f$(sv),w0=f$(ow);function B0(ko){return"\\"+uw[ko]}function my(ko,s0){return ko==null?a:ko[s0]}function dy(ko){return ry.test(ko)}function n0(ko){return Go.test(ko)}function q0(ko){for(var s0,r0=[];!(s0=ko.next()).done;)r0.push(s0.value);return r0}function uy(ko){var s0=-1,r0=Array(ko.size);return ko.forEach(function(I0,K0){r0[++s0]=[K0,I0]}),r0}function xv(ko,s0){return function(r0){return ko(s0(r0))}}function uv(ko,s0){for(var r0=-1,I0=ko.length,K0=0,by=[];++r0<I0;){var Xy=ko[r0];(Xy===s0||Xy===b)&&(ko[r0]=b,by[K0++]=r0)}return by}function gw(ko){var s0=-1,r0=Array(ko.size);return ko.forEach(function(I0){r0[++s0]=I0}),r0}function Kx(ko){var s0=-1,r0=Array(ko.size);return ko.forEach(function(I0){r0[++s0]=[I0,I0]}),r0}function Yx(ko,s0,r0){for(var I0=r0-1,K0=ko.length;++I0<K0;)if(ko[I0]===s0)return I0;return-1}function Xx(ko,s0,r0){for(var I0=r0+1;I0--;)if(ko[I0]===s0)return I0;return I0}function g$(ko){return dy(ko)?Jx(ko):D$(ko)}function lv(ko){return dy(ko)?eT(ko):M$(ko)}function J2(ko){for(var s0=ko.length;s0--&&ty.test(ko.charAt(s0)););return s0}var Qx=f$(sw);function Jx(ko){for(var s0=y0.lastIndex=0;y0.test(ko);)++s0;return s0}function eT(ko){return ko.match(y0)||[]}function tT(ko){return ko.match(R0)||[]}var rT=function ko(s0){s0=s0==null?Wy:Hv.defaults(Wy.Object(),s0,Hv.pick(Wy,Uo));var r0=s0.Array,I0=s0.Date,K0=s0.Error,by=s0.Function,Xy=s0.Math,ky=s0.Object,r2=s0.RegExp,nT=s0.String,G1=s0.TypeError,yw=r0.prototype,iT=by.prototype,y$=ky.prototype,vw=s0["__core-js_shared__"],bw=iT.toString,Sy=y$.hasOwnProperty,aT=0,e_=function(){var at=/[^.]+$/.exec(vw&&vw.keys&&vw.keys.IE_PROTO||"");return at?"Symbol(src)_1."+at:""}(),$w=y$.toString,oT=bw.call(ky),sT=Wy._,uT=r2("^"+bw.call(Sy).replace(Zy,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ww=C$?s0.Buffer:a,Gv=s0.Symbol,_w=s0.Uint8Array,t_=ww?ww.allocUnsafe:a,xw=xv(ky.getPrototypeOf,ky),r_=ky.create,n_=y$.propertyIsEnumerable,Tw=yw.splice,i_=Gv?Gv.isConcatSpreadable:a,U$=Gv?Gv.iterator:a,e$=Gv?Gv.toStringTag:a,Sw=function(){try{var at=a$(ky,"defineProperty");return at({},"",{}),at}catch{}}(),lT=s0.clearTimeout!==Wy.clearTimeout&&s0.clearTimeout,dT=I0&&I0.now!==Wy.Date.now&&I0.now,cT=s0.setTimeout!==Wy.setTimeout&&s0.setTimeout,Ew=Xy.ceil,kw=Xy.floor,n2=ky.getOwnPropertySymbols,pT=ww?ww.isBuffer:a,a_=s0.isFinite,fT=yw.join,hT=xv(ky.keys,ky),Qy=Xy.max,h1=Xy.min,mT=I0.now,gT=s0.parseInt,o_=Xy.random,yT=yw.reverse,i2=a$(s0,"DataView"),F$=a$(s0,"Map"),a2=a$(s0,"Promise"),v$=a$(s0,"Set"),W$=a$(s0,"WeakMap"),V$=a$(ky,"create"),Iw=W$&&new W$,b$={},vT=o$(i2),bT=o$(F$),$T=o$(a2),wT=o$(v$),_T=o$(W$),Cw=Gv?Gv.prototype:a,H$=Cw?Cw.valueOf:a,s_=Cw?Cw.toString:a;function Zr(at){if(By(at)&&!Y0(at)&&!(at instanceof ly)){if(at instanceof Z1)return at;if(Sy.call(at,"__wrapped__"))return ux(at)}return new Z1(at)}var $$=function(){function at(){}return function(pt){if(!My(pt))return{};if(r_)return r_(pt);at.prototype=pt;var Tt=new at;return at.prototype=a,Tt}}();function Ow(){}function Z1(at,pt){this.__wrapped__=at,this.__actions__=[],this.__chain__=!!pt,this.__index__=0,this.__values__=a}Zr.templateSettings={escape:G0,evaluate:Cy,interpolate:Uy,variable:"",imports:{_:Zr}},Zr.prototype=Ow.prototype,Zr.prototype.constructor=Zr,Z1.prototype=$$(Ow.prototype),Z1.prototype.constructor=Z1;function ly(at){this.__wrapped__=at,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=xn,this.__views__=[]}function xT(){var at=new ly(this.__wrapped__);return at.__actions__=I1(this.__actions__),at.__dir__=this.__dir__,at.__filtered__=this.__filtered__,at.__iteratees__=I1(this.__iteratees__),at.__takeCount__=this.__takeCount__,at.__views__=I1(this.__views__),at}function TT(){if(this.__filtered__){var at=new ly(this);at.__dir__=-1,at.__filtered__=!0}else at=this.clone(),at.__dir__*=-1;return at}function ST(){var at=this.__wrapped__.value(),pt=this.__dir__,Tt=Y0(at),Kt=pt<0,Ir=Tt?at.length:0,Kr=zS(0,Ir,this.__views__),vn=Kr.start,In=Kr.end,zo=In-vn,c0=Kt?In:vn-1,p0=this.__iteratees__,m0=p0.length,_0=0,A0=h1(zo,this.__takeCount__);if(!Tt||!Kt&&Ir==zo&&A0==zo)return A_(at,this.__actions__);var W0=[];e:for(;zo--&&_0<A0;){c0+=pt;for(var Q0=-1,V0=at[c0];++Q0<m0;){var sy=p0[Q0],cy=sy.iteratee,B1=sy.type,x1=cy(V0);if(B1==M0)V0=x1;else if(!x1){if(B1==D0)continue e;break e}}W0[_0++]=V0}return W0}ly.prototype=$$(Ow.prototype),ly.prototype.constructor=ly;function t$(at){var pt=-1,Tt=at==null?0:at.length;for(this.clear();++pt<Tt;){var Kt=at[pt];this.set(Kt[0],Kt[1])}}function ET(){this.__data__=V$?V$(null):{},this.size=0}function kT(at){var pt=this.has(at)&&delete this.__data__[at];return this.size-=pt?1:0,pt}function IT(at){var pt=this.__data__;if(V$){var Tt=pt[at];return Tt===et?a:Tt}return Sy.call(pt,at)?pt[at]:a}function CT(at){var pt=this.__data__;return V$?pt[at]!==a:Sy.call(pt,at)}function OT(at,pt){var Tt=this.__data__;return this.size+=this.has(at)?0:1,Tt[at]=V$&&pt===a?et:pt,this}t$.prototype.clear=ET,t$.prototype.delete=kT,t$.prototype.get=IT,t$.prototype.has=CT,t$.prototype.set=OT;function Dv(at){var pt=-1,Tt=at==null?0:at.length;for(this.clear();++pt<Tt;){var Kt=at[pt];this.set(Kt[0],Kt[1])}}function AT(){this.__data__=[],this.size=0}function PT(at){var pt=this.__data__,Tt=Aw(pt,at);if(Tt<0)return!1;var Kt=pt.length-1;return Tt==Kt?pt.pop():Tw.call(pt,Tt,1),--this.size,!0}function RT(at){var pt=this.__data__,Tt=Aw(pt,at);return Tt<0?a:pt[Tt][1]}function DT(at){return Aw(this.__data__,at)>-1}function MT(at,pt){var Tt=this.__data__,Kt=Aw(Tt,at);return Kt<0?(++this.size,Tt.push([at,pt])):Tt[Kt][1]=pt,this}Dv.prototype.clear=AT,Dv.prototype.delete=PT,Dv.prototype.get=RT,Dv.prototype.has=DT,Dv.prototype.set=MT;function Mv(at){var pt=-1,Tt=at==null?0:at.length;for(this.clear();++pt<Tt;){var Kt=at[pt];this.set(Kt[0],Kt[1])}}function NT(){this.size=0,this.__data__={hash:new t$,map:new(F$||Dv),string:new t$}}function zT(at){var pt=Ww(this,at).delete(at);return this.size-=pt?1:0,pt}function jT(at){return Ww(this,at).get(at)}function BT(at){return Ww(this,at).has(at)}function LT(at,pt){var Tt=Ww(this,at),Kt=Tt.size;return Tt.set(at,pt),this.size+=Tt.size==Kt?0:1,this}Mv.prototype.clear=NT,Mv.prototype.delete=zT,Mv.prototype.get=jT,Mv.prototype.has=BT,Mv.prototype.set=LT;function r$(at){var pt=-1,Tt=at==null?0:at.length;for(this.__data__=new Mv;++pt<Tt;)this.add(at[pt])}function UT(at){return this.__data__.set(at,et),this}function FT(at){return this.__data__.has(at)}r$.prototype.add=r$.prototype.push=UT,r$.prototype.has=FT;function dv(at){var pt=this.__data__=new Dv(at);this.size=pt.size}function WT(){this.__data__=new Dv,this.size=0}function VT(at){var pt=this.__data__,Tt=pt.delete(at);return this.size=pt.size,Tt}function HT(at){return this.__data__.get(at)}function GT(at){return this.__data__.has(at)}function ZT(at,pt){var Tt=this.__data__;if(Tt instanceof Dv){var Kt=Tt.__data__;if(!F$||Kt.length<c-1)return Kt.push([at,pt]),this.size=++Tt.size,this;Tt=this.__data__=new Mv(Kt)}return Tt.set(at,pt),this.size=Tt.size,this}dv.prototype.clear=WT,dv.prototype.delete=VT,dv.prototype.get=HT,dv.prototype.has=GT,dv.prototype.set=ZT;function u_(at,pt){var Tt=Y0(at),Kt=!Tt&&s$(at),Ir=!Tt&&!Kt&&Xv(at),Kr=!Tt&&!Kt&&!Ir&&T$(at),vn=Tt||Kt||Ir||Kr,In=vn?m$(at.length,nT):[],zo=In.length;for(var c0 in at)(pt||Sy.call(at,c0))&&!(vn&&(c0=="length"||Ir&&(c0=="offset"||c0=="parent")||Kr&&(c0=="buffer"||c0=="byteLength"||c0=="byteOffset")||Bv(c0,zo)))&&In.push(c0);return In}function l_(at){var pt=at.length;return pt?at[g2(0,pt-1)]:a}function qT(at,pt){return Vw(I1(at),n$(pt,0,at.length))}function KT(at){return Vw(I1(at))}function o2(at,pt,Tt){(Tt!==a&&!cv(at[pt],Tt)||Tt===a&&!(pt in at))&&Nv(at,pt,Tt)}function G$(at,pt,Tt){var Kt=at[pt];(!(Sy.call(at,pt)&&cv(Kt,Tt))||Tt===a&&!(pt in at))&&Nv(at,pt,Tt)}function Aw(at,pt){for(var Tt=at.length;Tt--;)if(cv(at[Tt][0],pt))return Tt;return-1}function YT(at,pt,Tt,Kt){return Zv(at,function(Ir,Kr,vn){pt(Kt,Ir,Tt(Ir),vn)}),Kt}function d_(at,pt){return at&&Sv(pt,r1(pt),at)}function XT(at,pt){return at&&Sv(pt,O1(pt),at)}function Nv(at,pt,Tt){pt=="__proto__"&&Sw?Sw(at,pt,{configurable:!0,enumerable:!0,value:Tt,writable:!0}):at[pt]=Tt}function s2(at,pt){for(var Tt=-1,Kt=pt.length,Ir=r0(Kt),Kr=at==null;++Tt<Kt;)Ir[Tt]=Kr?a:U2(at,pt[Tt]);return Ir}function n$(at,pt,Tt){return at===at&&(Tt!==a&&(at=at<=Tt?at:Tt),pt!==a&&(at=at>=pt?at:pt)),at}function q1(at,pt,Tt,Kt,Ir,Kr){var vn,In=pt&g,zo=pt&st,c0=pt&$t;if(Tt&&(vn=Ir?Tt(at,Kt,Ir,Kr):Tt(at)),vn!==a)return vn;if(!My(at))return at;var p0=Y0(at);if(p0){if(vn=BS(at),!In)return I1(at,vn)}else{var m0=m1(at),_0=m0==H0||m0==yy;if(Xv(at))return D_(at,In);if(m0==_y||m0==j0||_0&&!Ir){if(vn=zo||_0?{}:J_(at),!In)return zo?IS(at,XT(vn,at)):kS(at,d_(vn,at))}else{if(!ny[m0])return Ir?at:{};vn=LS(at,m0,In)}}Kr||(Kr=new dv);var A0=Kr.get(at);if(A0)return A0;Kr.set(at,vn),Ix(at)?at.forEach(function(V0){vn.add(q1(V0,pt,Tt,V0,at,Kr))}):Ex(at)&&at.forEach(function(V0,sy){vn.set(sy,q1(V0,pt,Tt,sy,at,Kr))});var W0=c0?zo?k2:E2:zo?O1:r1,Q0=p0?a:W0(at);return $1(Q0||at,function(V0,sy){Q0&&(sy=V0,V0=at[sy]),G$(vn,sy,q1(V0,pt,Tt,sy,at,Kr))}),vn}function QT(at){var pt=r1(at);return function(Tt){return c_(Tt,at,pt)}}function c_(at,pt,Tt){var Kt=Tt.length;if(at==null)return!Kt;for(at=ky(at);Kt--;){var Ir=Tt[Kt],Kr=pt[Ir],vn=at[Ir];if(vn===a&&!(Ir in at)||!Kr(vn))return!1}return!0}function p_(at,pt,Tt){if(typeof at!="function")throw new G1(d);return J$(function(){at.apply(a,Tt)},pt)}function Z$(at,pt,Tt,Kt){var Ir=-1,Kr=C0,vn=!0,In=at.length,zo=[],c0=pt.length;if(!In)return zo;Tt&&(pt=Ty(pt,ir(Tt))),Kt?(Kr=d$,vn=!1):pt.length>=c&&(Kr=Xr,vn=!1,pt=new r$(pt));e:for(;++Ir<In;){var p0=at[Ir],m0=Tt==null?p0:Tt(p0);if(p0=Kt||p0!==0?p0:0,vn&&m0===m0){for(var _0=c0;_0--;)if(pt[_0]===m0)continue e;zo.push(p0)}else Kr(pt,m0,Kt)||zo.push(p0)}return zo}var Zv=B_(Tv),f_=B_(l2,!0);function JT(at,pt){var Tt=!0;return Zv(at,function(Kt,Ir,Kr){return Tt=!!pt(Kt,Ir,Kr),Tt}),Tt}function Pw(at,pt,Tt){for(var Kt=-1,Ir=at.length;++Kt<Ir;){var Kr=at[Kt],vn=pt(Kr);if(vn!=null&&(In===a?vn===vn&&!j1(vn):Tt(vn,In)))var In=vn,zo=Kr}return zo}function eS(at,pt,Tt,Kt){var Ir=at.length;for(Tt=X0(Tt),Tt<0&&(Tt=-Tt>Ir?0:Ir+Tt),Kt=Kt===a||Kt>Ir?Ir:X0(Kt),Kt<0&&(Kt+=Ir),Kt=Tt>Kt?0:Ox(Kt);Tt<Kt;)at[Tt++]=pt;return at}function h_(at,pt){var Tt=[];return Zv(at,function(Kt,Ir,Kr){pt(Kt,Ir,Kr)&&Tt.push(Kt)}),Tt}function a1(at,pt,Tt,Kt,Ir){var Kr=-1,vn=at.length;for(Tt||(Tt=FS),Ir||(Ir=[]);++Kr<vn;){var In=at[Kr];pt>0&&Tt(In)?pt>1?a1(In,pt-1,Tt,Kt,Ir):N1(Ir,In):Kt||(Ir[Ir.length]=In)}return Ir}var u2=L_(),m_=L_(!0);function Tv(at,pt){return at&&u2(at,pt,r1)}function l2(at,pt){return at&&m_(at,pt,r1)}function Rw(at,pt){return wv(pt,function(Tt){return Lv(at[Tt])})}function i$(at,pt){pt=Kv(pt,at);for(var Tt=0,Kt=pt.length;at!=null&&Tt<Kt;)at=at[Ev(pt[Tt++])];return Tt&&Tt==Kt?at:a}function g_(at,pt,Tt){var Kt=pt(at);return Y0(at)?Kt:N1(Kt,Tt(at))}function w1(at){return at==null?at===a?n1:o1:e$&&e$ in ky(at)?NS(at):KS(at)}function d2(at,pt){return at>pt}function tS(at,pt){return at!=null&&Sy.call(at,pt)}function rS(at,pt){return at!=null&&pt in ky(at)}function nS(at,pt,Tt){return at>=h1(pt,Tt)&&at<Qy(pt,Tt)}function c2(at,pt,Tt){for(var Kt=Tt?d$:C0,Ir=at[0].length,Kr=at.length,vn=Kr,In=r0(Kr),zo=1/0,c0=[];vn--;){var p0=at[vn];vn&&pt&&(p0=Ty(p0,ir(pt))),zo=h1(p0.length,zo),In[vn]=!Tt&&(pt||Ir>=120&&p0.length>=120)?new r$(vn&&p0):a}p0=at[0];var m0=-1,_0=In[0];e:for(;++m0<Ir&&c0.length<zo;){var A0=p0[m0],W0=pt?pt(A0):A0;if(A0=Tt||A0!==0?A0:0,!(_0?Xr(_0,W0):Kt(c0,W0,Tt))){for(vn=Kr;--vn;){var Q0=In[vn];if(!(Q0?Xr(Q0,W0):Kt(at[vn],W0,Tt)))continue e}_0&&_0.push(W0),c0.push(A0)}}return c0}function iS(at,pt,Tt,Kt){return Tv(at,function(Ir,Kr,vn){pt(Kt,Tt(Ir),Kr,vn)}),Kt}function q$(at,pt,Tt){pt=Kv(pt,at),at=nx(at,pt);var Kt=at==null?at:at[Ev(Y1(pt))];return Kt==null?a:b1(Kt,at,Tt)}function y_(at){return By(at)&&w1(at)==j0}function aS(at){return By(at)&&w1(at)==xy}function oS(at){return By(at)&&w1(at)==gy}function K$(at,pt,Tt,Kt,Ir){return at===pt?!0:at==null||pt==null||!By(at)&&!By(pt)?at!==at&&pt!==pt:sS(at,pt,Tt,Kt,K$,Ir)}function sS(at,pt,Tt,Kt,Ir,Kr){var vn=Y0(at),In=Y0(pt),zo=vn?Z0:m1(at),c0=In?Z0:m1(pt);zo=zo==j0?_y:zo,c0=c0==j0?_y:c0;var p0=zo==_y,m0=c0==_y,_0=zo==c0;if(_0&&Xv(at)){if(!Xv(pt))return!1;vn=!0,p0=!1}if(_0&&!p0)return Kr||(Kr=new dv),vn||T$(at)?Y_(at,pt,Tt,Kt,Ir,Kr):DS(at,pt,zo,Tt,Kt,Ir,Kr);if(!(Tt&vt)){var A0=p0&&Sy.call(at,"__wrapped__"),W0=m0&&Sy.call(pt,"__wrapped__");if(A0||W0){var Q0=A0?at.value():at,V0=W0?pt.value():pt;return Kr||(Kr=new dv),Ir(Q0,V0,Tt,Kt,Kr)}}return _0?(Kr||(Kr=new dv),MS(at,pt,Tt,Kt,Ir,Kr)):!1}function uS(at){return By(at)&&m1(at)==vy}function p2(at,pt,Tt,Kt){var Ir=Tt.length,Kr=Ir,vn=!Kt;if(at==null)return!Kr;for(at=ky(at);Ir--;){var In=Tt[Ir];if(vn&&In[2]?In[1]!==at[In[0]]:!(In[0]in at))return!1}for(;++Ir<Kr;){In=Tt[Ir];var zo=In[0],c0=at[zo],p0=In[1];if(vn&&In[2]){if(c0===a&&!(zo in at))return!1}else{var m0=new dv;if(Kt)var _0=Kt(c0,p0,zo,at,pt,m0);if(!(_0===a?K$(p0,c0,vt|Ft,Kt,m0):_0))return!1}}return!0}function v_(at){if(!My(at)||VS(at))return!1;var pt=Lv(at)?uT:vv;return pt.test(o$(at))}function lS(at){return By(at)&&w1(at)==Ly}function dS(at){return By(at)&&m1(at)==Iy}function cS(at){return By(at)&&Yw(at.length)&&!!E0[w1(at)]}function b_(at){return typeof at=="function"?at:at==null?A1:typeof at=="object"?Y0(at)?__(at[0],at[1]):w_(at):Ux(at)}function f2(at){if(!Q$(at))return hT(at);var pt=[];for(var Tt in ky(at))Sy.call(at,Tt)&&Tt!="constructor"&&pt.push(Tt);return pt}function pS(at){if(!My(at))return qS(at);var pt=Q$(at),Tt=[];for(var Kt in at)Kt=="constructor"&&(pt||!Sy.call(at,Kt))||Tt.push(Kt);return Tt}function h2(at,pt){return at<pt}function $_(at,pt){var Tt=-1,Kt=C1(at)?r0(at.length):[];return Zv(at,function(Ir,Kr,vn){Kt[++Tt]=pt(Ir,Kr,vn)}),Kt}function w_(at){var pt=C2(at);return pt.length==1&&pt[0][2]?tx(pt[0][0],pt[0][1]):function(Tt){return Tt===at||p2(Tt,at,pt)}}function __(at,pt){return A2(at)&&ex(pt)?tx(Ev(at),pt):function(Tt){var Kt=U2(Tt,at);return Kt===a&&Kt===pt?F2(Tt,at):K$(pt,Kt,vt|Ft)}}function Dw(at,pt,Tt,Kt,Ir){at!==pt&&u2(pt,function(Kr,vn){if(Ir||(Ir=new dv),My(Kr))fS(at,pt,vn,Tt,Dw,Kt,Ir);else{var In=Kt?Kt(R2(at,vn),Kr,vn+"",at,pt,Ir):a;In===a&&(In=Kr),o2(at,vn,In)}},O1)}function fS(at,pt,Tt,Kt,Ir,Kr,vn){var In=R2(at,Tt),zo=R2(pt,Tt),c0=vn.get(zo);if(c0){o2(at,Tt,c0);return}var p0=Kr?Kr(In,zo,Tt+"",at,pt,vn):a,m0=p0===a;if(m0){var _0=Y0(zo),A0=!_0&&Xv(zo),W0=!_0&&!A0&&T$(zo);p0=zo,_0||A0||W0?Y0(In)?p0=In:Vy(In)?p0=I1(In):A0?(m0=!1,p0=D_(zo,!0)):W0?(m0=!1,p0=M_(zo,!0)):p0=[]:ew(zo)||s$(zo)?(p0=In,s$(In)?p0=Ax(In):(!My(In)||Lv(In))&&(p0=J_(zo))):m0=!1}m0&&(vn.set(zo,p0),Ir(p0,zo,Kt,Kr,vn),vn.delete(zo)),o2(at,Tt,p0)}function x_(at,pt){var Tt=at.length;if(Tt)return pt+=pt<0?Tt:0,Bv(pt,Tt)?at[pt]:a}function T_(at,pt,Tt){pt.length?pt=Ty(pt,function(Kr){return Y0(Kr)?function(vn){return i$(vn,Kr.length===1?Kr[0]:Kr)}:Kr}):pt=[A1];var Kt=-1;pt=Ty(pt,ir(F0()));var Ir=$_(at,function(Kr,vn,In){var zo=Ty(pt,function(c0){return c0(Kr)});return{criteria:zo,index:++Kt,value:Kr}});return t2(Ir,function(Kr,vn){return ES(Kr,vn,Tt)})}function hS(at,pt){return S_(at,pt,function(Tt,Kt){return F2(at,Kt)})}function S_(at,pt,Tt){for(var Kt=-1,Ir=pt.length,Kr={};++Kt<Ir;){var vn=pt[Kt],In=i$(at,vn);Tt(In,vn)&&Y$(Kr,Kv(vn,at),In)}return Kr}function mS(at){return function(pt){return i$(pt,at)}}function m2(at,pt,Tt,Kt){var Ir=Kt?z$:_v,Kr=-1,vn=pt.length,In=at;for(at===pt&&(pt=I1(pt)),Tt&&(In=Ty(at,ir(Tt)));++Kr<vn;)for(var zo=0,c0=pt[Kr],p0=Tt?Tt(c0):c0;(zo=Ir(In,p0,zo,Kt))>-1;)In!==at&&Tw.call(In,zo,1),Tw.call(at,zo,1);return at}function E_(at,pt){for(var Tt=at?pt.length:0,Kt=Tt-1;Tt--;){var Ir=pt[Tt];if(Tt==Kt||Ir!==Kr){var Kr=Ir;Bv(Ir)?Tw.call(at,Ir,1):b2(at,Ir)}}return at}function g2(at,pt){return at+kw(o_()*(pt-at+1))}function gS(at,pt,Tt,Kt){for(var Ir=-1,Kr=Qy(Ew((pt-at)/(Tt||1)),0),vn=r0(Kr);Kr--;)vn[Kt?Kr:++Ir]=at,at+=Tt;return vn}function y2(at,pt){var Tt="";if(!at||pt<1||pt>Sn)return Tt;do pt%2&&(Tt+=at),pt=kw(pt/2),pt&&(at+=at);while(pt);return Tt}function iy(at,pt){return D2(rx(at,pt,A1),at+"")}function yS(at){return l_(S$(at))}function vS(at,pt){var Tt=S$(at);return Vw(Tt,n$(pt,0,Tt.length))}function Y$(at,pt,Tt,Kt){if(!My(at))return at;pt=Kv(pt,at);for(var Ir=-1,Kr=pt.length,vn=Kr-1,In=at;In!=null&&++Ir<Kr;){var zo=Ev(pt[Ir]),c0=Tt;if(zo==="__proto__"||zo==="constructor"||zo==="prototype")return at;if(Ir!=vn){var p0=In[zo];c0=Kt?Kt(p0,zo,In):a,c0===a&&(c0=My(p0)?p0:Bv(pt[Ir+1])?[]:{})}G$(In,zo,c0),In=In[zo]}return at}var k_=Iw?function(at,pt){return Iw.set(at,pt),at}:A1,bS=Sw?function(at,pt){return Sw(at,"toString",{configurable:!0,enumerable:!1,value:V2(pt),writable:!0})}:A1;function $S(at){return Vw(S$(at))}function K1(at,pt,Tt){var Kt=-1,Ir=at.length;pt<0&&(pt=-pt>Ir?0:Ir+pt),Tt=Tt>Ir?Ir:Tt,Tt<0&&(Tt+=Ir),Ir=pt>Tt?0:Tt-pt>>>0,pt>>>=0;for(var Kr=r0(Ir);++Kt<Ir;)Kr[Kt]=at[Kt+pt];return Kr}function wS(at,pt){var Tt;return Zv(at,function(Kt,Ir,Kr){return Tt=pt(Kt,Ir,Kr),!Tt}),!!Tt}function Mw(at,pt,Tt){var Kt=0,Ir=at==null?Kt:at.length;if(typeof pt=="number"&&pt===pt&&Ir<=$0){for(;Kt<Ir;){var Kr=Kt+Ir>>>1,vn=at[Kr];vn!==null&&!j1(vn)&&(Tt?vn<=pt:vn<pt)?Kt=Kr+1:Ir=Kr}return Ir}return v2(at,pt,A1,Tt)}function v2(at,pt,Tt,Kt){var Ir=0,Kr=at==null?0:at.length;if(Kr===0)return 0;pt=Tt(pt);for(var vn=pt!==pt,In=pt===null,zo=j1(pt),c0=pt===a;Ir<Kr;){var p0=kw((Ir+Kr)/2),m0=Tt(at[p0]),_0=m0!==a,A0=m0===null,W0=m0===m0,Q0=j1(m0);if(vn)var V0=Kt||W0;else c0?V0=W0&&(Kt||_0):In?V0=W0&&_0&&(Kt||!A0):zo?V0=W0&&_0&&!A0&&(Kt||!Q0):A0||Q0?V0=!1:V0=Kt?m0<=pt:m0<pt;V0?Ir=p0+1:Kr=p0}return h1(Kr,f0)}function I_(at,pt){for(var Tt=-1,Kt=at.length,Ir=0,Kr=[];++Tt<Kt;){var vn=at[Tt],In=pt?pt(vn):vn;if(!Tt||!cv(In,zo)){var zo=In;Kr[Ir++]=vn===0?0:vn}}return Kr}function C_(at){return typeof at=="number"?at:j1(at)?d0:+at}function z1(at){if(typeof at=="string")return at;if(Y0(at))return Ty(at,z1)+"";if(j1(at))return s_?s_.call(at):"";var pt=at+"";return pt=="0"&&1/at==-e0?"-0":pt}function qv(at,pt,Tt){var Kt=-1,Ir=C0,Kr=at.length,vn=!0,In=[],zo=In;if(Tt)vn=!1,Ir=d$;else if(Kr>=c){var c0=pt?null:PS(at);if(c0)return gw(c0);vn=!1,Ir=Xr,zo=new r$}else zo=pt?[]:In;e:for(;++Kt<Kr;){var p0=at[Kt],m0=pt?pt(p0):p0;if(p0=Tt||p0!==0?p0:0,vn&&m0===m0){for(var _0=zo.length;_0--;)if(zo[_0]===m0)continue e;pt&&zo.push(m0),In.push(p0)}else Ir(zo,m0,Tt)||(zo!==In&&zo.push(m0),In.push(p0))}return In}function b2(at,pt){return pt=Kv(pt,at),at=nx(at,pt),at==null||delete at[Ev(Y1(pt))]}function O_(at,pt,Tt,Kt){return Y$(at,pt,Tt(i$(at,pt)),Kt)}function Nw(at,pt,Tt,Kt){for(var Ir=at.length,Kr=Kt?Ir:-1;(Kt?Kr--:++Kr<Ir)&&pt(at[Kr],Kr,at););return Tt?K1(at,Kt?0:Kr,Kt?Kr+1:Ir):K1(at,Kt?Kr+1:0,Kt?Ir:Kr)}function A_(at,pt){var Tt=at;return Tt instanceof ly&&(Tt=Tt.value()),k1(pt,function(Kt,Ir){return Ir.func.apply(Ir.thisArg,N1([Kt],Ir.args))},Tt)}function $2(at,pt,Tt){var Kt=at.length;if(Kt<2)return Kt?qv(at[0]):[];for(var Ir=-1,Kr=r0(Kt);++Ir<Kt;)for(var vn=at[Ir],In=-1;++In<Kt;)In!=Ir&&(Kr[Ir]=Z$(Kr[Ir]||vn,at[In],pt,Tt));return qv(a1(Kr,1),pt,Tt)}function P_(at,pt,Tt){for(var Kt=-1,Ir=at.length,Kr=pt.length,vn={};++Kt<Ir;){var In=Kt<Kr?pt[Kt]:a;Tt(vn,at[Kt],In)}return vn}function w2(at){return Vy(at)?at:[]}function _2(at){return typeof at=="function"?at:A1}function Kv(at,pt){return Y0(at)?at:A2(at,pt)?[at]:sx(wy(at))}var _S=iy;function Yv(at,pt,Tt){var Kt=at.length;return Tt=Tt===a?Kt:Tt,!pt&&Tt>=Kt?at:K1(at,pt,Tt)}var R_=lT||function(at){return Wy.clearTimeout(at)};function D_(at,pt){if(pt)return at.slice();var Tt=at.length,Kt=t_?t_(Tt):new at.constructor(Tt);return at.copy(Kt),Kt}function x2(at){var pt=new at.constructor(at.byteLength);return new _w(pt).set(new _w(at)),pt}function xS(at,pt){var Tt=pt?x2(at.buffer):at.buffer;return new at.constructor(Tt,at.byteOffset,at.byteLength)}function TS(at){var pt=new at.constructor(at.source,gv.exec(at));return pt.lastIndex=at.lastIndex,pt}function SS(at){return H$?ky(H$.call(at)):{}}function M_(at,pt){var Tt=pt?x2(at.buffer):at.buffer;return new at.constructor(Tt,at.byteOffset,at.length)}function N_(at,pt){if(at!==pt){var Tt=at!==a,Kt=at===null,Ir=at===at,Kr=j1(at),vn=pt!==a,In=pt===null,zo=pt===pt,c0=j1(pt);if(!In&&!c0&&!Kr&&at>pt||Kr&&vn&&zo&&!In&&!c0||Kt&&vn&&zo||!Tt&&zo||!Ir)return 1;if(!Kt&&!Kr&&!c0&&at<pt||c0&&Tt&&Ir&&!Kt&&!Kr||In&&Tt&&Ir||!vn&&Ir||!zo)return-1}return 0}function ES(at,pt,Tt){for(var Kt=-1,Ir=at.criteria,Kr=pt.criteria,vn=Ir.length,In=Tt.length;++Kt<vn;){var zo=N_(Ir[Kt],Kr[Kt]);if(zo){if(Kt>=In)return zo;var c0=Tt[Kt];return zo*(c0=="desc"?-1:1)}}return at.index-pt.index}function z_(at,pt,Tt,Kt){for(var Ir=-1,Kr=at.length,vn=Tt.length,In=-1,zo=pt.length,c0=Qy(Kr-vn,0),p0=r0(zo+c0),m0=!Kt;++In<zo;)p0[In]=pt[In];for(;++Ir<vn;)(m0||Ir<Kr)&&(p0[Tt[Ir]]=at[Ir]);for(;c0--;)p0[In++]=at[Ir++];return p0}function j_(at,pt,Tt,Kt){for(var Ir=-1,Kr=at.length,vn=-1,In=Tt.length,zo=-1,c0=pt.length,p0=Qy(Kr-In,0),m0=r0(p0+c0),_0=!Kt;++Ir<p0;)m0[Ir]=at[Ir];for(var A0=Ir;++zo<c0;)m0[A0+zo]=pt[zo];for(;++vn<In;)(_0||Ir<Kr)&&(m0[A0+Tt[vn]]=at[Ir++]);return m0}function I1(at,pt){var Tt=-1,Kt=at.length;for(pt||(pt=r0(Kt));++Tt<Kt;)pt[Tt]=at[Tt];return pt}function Sv(at,pt,Tt,Kt){var Ir=!Tt;Tt||(Tt={});for(var Kr=-1,vn=pt.length;++Kr<vn;){var In=pt[Kr],zo=Kt?Kt(Tt[In],at[In],In,Tt,at):a;zo===a&&(zo=at[In]),Ir?Nv(Tt,In,zo):G$(Tt,In,zo)}return Tt}function kS(at,pt){return Sv(at,O2(at),pt)}function IS(at,pt){return Sv(at,X_(at),pt)}function zw(at,pt){return function(Tt,Kt){var Ir=Y0(Tt)?pw:YT,Kr=pt?pt():{};return Ir(Tt,at,F0(Kt,2),Kr)}}function w$(at){return iy(function(pt,Tt){var Kt=-1,Ir=Tt.length,Kr=Ir>1?Tt[Ir-1]:a,vn=Ir>2?Tt[2]:a;for(Kr=at.length>3&&typeof Kr=="function"?(Ir--,Kr):a,vn&&_1(Tt[0],Tt[1],vn)&&(Kr=Ir<3?a:Kr,Ir=1),pt=ky(pt);++Kt<Ir;){var In=Tt[Kt];In&&at(pt,In,Kt,Kr)}return pt})}function B_(at,pt){return function(Tt,Kt){if(Tt==null)return Tt;if(!C1(Tt))return at(Tt,Kt);for(var Ir=Tt.length,Kr=pt?Ir:-1,vn=ky(Tt);(pt?Kr--:++Kr<Ir)&&Kt(vn[Kr],Kr,vn)!==!1;);return Tt}}function L_(at){return function(pt,Tt,Kt){for(var Ir=-1,Kr=ky(pt),vn=Kt(pt),In=vn.length;In--;){var zo=vn[at?In:++Ir];if(Tt(Kr[zo],zo,Kr)===!1)break}return pt}}function CS(at,pt,Tt){var Kt=pt&Gt,Ir=X$(at);function Kr(){var vn=this&&this!==Wy&&this instanceof Kr?Ir:at;return vn.apply(Kt?Tt:this,arguments)}return Kr}function U_(at){return function(pt){pt=wy(pt);var Tt=dy(pt)?lv(pt):a,Kt=Tt?Tt[0]:pt.charAt(0),Ir=Tt?Yv(Tt,1).join(""):pt.slice(1);return Kt[at]()+Ir}}function _$(at){return function(pt){return k1(Bx(jx(pt).replace(h0,"")),at,"")}}function X$(at){return function(){var pt=arguments;switch(pt.length){case 0:return new at;case 1:return new at(pt[0]);case 2:return new at(pt[0],pt[1]);case 3:return new at(pt[0],pt[1],pt[2]);case 4:return new at(pt[0],pt[1],pt[2],pt[3]);case 5:return new at(pt[0],pt[1],pt[2],pt[3],pt[4]);case 6:return new at(pt[0],pt[1],pt[2],pt[3],pt[4],pt[5]);case 7:return new at(pt[0],pt[1],pt[2],pt[3],pt[4],pt[5],pt[6])}var Tt=$$(at.prototype),Kt=at.apply(Tt,pt);return My(Kt)?Kt:Tt}}function OS(at,pt,Tt){var Kt=X$(at);function Ir(){for(var Kr=arguments.length,vn=r0(Kr),In=Kr,zo=x$(Ir);In--;)vn[In]=arguments[In];var c0=Kr<3&&vn[0]!==zo&&vn[Kr-1]!==zo?[]:uv(vn,zo);if(Kr-=c0.length,Kr<Tt)return G_(at,pt,jw,Ir.placeholder,a,vn,c0,a,a,Tt-Kr);var p0=this&&this!==Wy&&this instanceof Ir?Kt:at;return b1(p0,this,vn)}return Ir}function F_(at){return function(pt,Tt,Kt){var Ir=ky(pt);if(!C1(pt)){var Kr=F0(Tt,3);pt=r1(pt),Tt=function(In){return Kr(Ir[In],In,Ir)}}var vn=at(pt,Tt,Kt);return vn>-1?Ir[Kr?pt[vn]:vn]:a}}function W_(at){return jv(function(pt){var Tt=pt.length,Kt=Tt,Ir=Z1.prototype.thru;for(at&&pt.reverse();Kt--;){var Kr=pt[Kt];if(typeof Kr!="function")throw new G1(d);if(Ir&&!vn&&Fw(Kr)=="wrapper")var vn=new Z1([],!0)}for(Kt=vn?Kt:Tt;++Kt<Tt;){Kr=pt[Kt];var In=Fw(Kr),zo=In=="wrapper"?I2(Kr):a;zo&&P2(zo[0])&&zo[1]==(_n|rr|Hr|No)&&!zo[4].length&&zo[9]==1?vn=vn[Fw(zo[0])].apply(vn,zo[3]):vn=Kr.length==1&&P2(Kr)?vn[In]():vn.thru(Kr)}return function(){var c0=arguments,p0=c0[0];if(vn&&c0.length==1&&Y0(p0))return vn.plant(p0).value();for(var m0=0,_0=Tt?pt[m0].apply(this,c0):p0;++m0<Tt;)_0=pt[m0].call(this,_0);return _0}})}function jw(at,pt,Tt,Kt,Ir,Kr,vn,In,zo,c0){var p0=pt&_n,m0=pt&Gt,_0=pt&qt,A0=pt&(rr|jr),W0=pt&Qo,Q0=_0?a:X$(at);function V0(){for(var sy=arguments.length,cy=r0(sy),B1=sy;B1--;)cy[B1]=arguments[B1];if(A0)var x1=x$(V0),L1=g0(cy,x1);if(Kt&&(cy=z_(cy,Kt,Ir,A0)),Kr&&(cy=j_(cy,Kr,vn,A0)),sy-=L1,A0&&sy<c0){var Hy=uv(cy,x1);return G_(at,pt,jw,V0.placeholder,Tt,cy,Hy,In,zo,c0-sy)}var pv=m0?Tt:this,Fv=_0?pv[at]:at;return sy=cy.length,In?cy=YS(cy,In):W0&&sy>1&&cy.reverse(),p0&&zo<sy&&(cy.length=zo),this&&this!==Wy&&this instanceof V0&&(Fv=Q0||X$(Fv)),Fv.apply(pv,cy)}return V0}function V_(at,pt){return function(Tt,Kt){return iS(Tt,at,pt(Kt),{})}}function Bw(at,pt){return function(Tt,Kt){var Ir;if(Tt===a&&Kt===a)return pt;if(Tt!==a&&(Ir=Tt),Kt!==a){if(Ir===a)return Kt;typeof Tt=="string"||typeof Kt=="string"?(Tt=z1(Tt),Kt=z1(Kt)):(Tt=C_(Tt),Kt=C_(Kt)),Ir=at(Tt,Kt)}return Ir}}function T2(at){return jv(function(pt){return pt=Ty(pt,ir(F0())),iy(function(Tt){var Kt=this;return at(pt,function(Ir){return b1(Ir,Kt,Tt)})})})}function Lw(at,pt){pt=pt===a?" ":z1(pt);var Tt=pt.length;if(Tt<2)return Tt?y2(pt,at):pt;var Kt=y2(pt,Ew(at/g$(pt)));return dy(pt)?Yv(lv(Kt),0,at).join(""):Kt.slice(0,at)}function AS(at,pt,Tt,Kt){var Ir=pt&Gt,Kr=X$(at);function vn(){for(var In=-1,zo=arguments.length,c0=-1,p0=Kt.length,m0=r0(p0+zo),_0=this&&this!==Wy&&this instanceof vn?Kr:at;++c0<p0;)m0[c0]=Kt[c0];for(;zo--;)m0[c0++]=arguments[++In];return b1(_0,Ir?Tt:this,m0)}return vn}function H_(at){return function(pt,Tt,Kt){return Kt&&typeof Kt!="number"&&_1(pt,Tt,Kt)&&(Tt=Kt=a),pt=Uv(pt),Tt===a?(Tt=pt,pt=0):Tt=Uv(Tt),Kt=Kt===a?pt<Tt?1:-1:Uv(Kt),gS(pt,Tt,Kt,at)}}function Uw(at){return function(pt,Tt){return typeof pt=="string"&&typeof Tt=="string"||(pt=X1(pt),Tt=X1(Tt)),at(pt,Tt)}}function G_(at,pt,Tt,Kt,Ir,Kr,vn,In,zo,c0){var p0=pt&rr,m0=p0?vn:a,_0=p0?a:vn,A0=p0?Kr:a,W0=p0?a:Kr;pt|=p0?Hr:wn,pt&=~(p0?wn:Hr),pt&Lt||(pt&=~(Gt|qt));var Q0=[at,pt,Ir,A0,m0,W0,_0,In,zo,c0],V0=Tt.apply(a,Q0);return P2(at)&&ix(V0,Q0),V0.placeholder=Kt,ax(V0,at,pt)}function S2(at){var pt=Xy[at];return function(Tt,Kt){if(Tt=X1(Tt),Kt=Kt==null?0:h1(X0(Kt),292),Kt&&a_(Tt)){var Ir=(wy(Tt)+"e").split("e"),Kr=pt(Ir[0]+"e"+(+Ir[1]+Kt));return Ir=(wy(Kr)+"e").split("e"),+(Ir[0]+"e"+(+Ir[1]-Kt))}return pt(Tt)}}var PS=v$&&1/gw(new v$([,-0]))[1]==e0?function(at){return new v$(at)}:Z2;function Z_(at){return function(pt){var Tt=m1(pt);return Tt==vy?uy(pt):Tt==Iy?Kx(pt):Ct(pt,at(pt))}}function zv(at,pt,Tt,Kt,Ir,Kr,vn,In){var zo=pt&qt;if(!zo&&typeof at!="function")throw new G1(d);var c0=Kt?Kt.length:0;if(c0||(pt&=~(Hr|wn),Kt=Ir=a),vn=vn===a?vn:Qy(X0(vn),0),In=In===a?In:X0(In),c0-=Ir?Ir.length:0,pt&wn){var p0=Kt,m0=Ir;Kt=Ir=a}var _0=zo?a:I2(at),A0=[at,pt,Tt,Kt,Ir,p0,m0,Kr,vn,In];if(_0&&ZS(A0,_0),at=A0[0],pt=A0[1],Tt=A0[2],Kt=A0[3],Ir=A0[4],In=A0[9]=A0[9]===a?zo?0:at.length:Qy(A0[9]-c0,0),!In&&pt&(rr|jr)&&(pt&=~(rr|jr)),!pt||pt==Gt)var W0=CS(at,pt,Tt);else pt==rr||pt==jr?W0=OS(at,pt,In):(pt==Hr||pt==(Gt|Hr))&&!Ir.length?W0=AS(at,pt,Tt,Kt):W0=jw.apply(a,A0);var Q0=_0?k_:ix;return ax(Q0(W0,A0),at,pt)}function q_(at,pt,Tt,Kt){return at===a||cv(at,y$[Tt])&&!Sy.call(Kt,Tt)?pt:at}function K_(at,pt,Tt,Kt,Ir,Kr){return My(at)&&My(pt)&&(Kr.set(pt,at),Dw(at,pt,a,K_,Kr),Kr.delete(pt)),at}function RS(at){return ew(at)?a:at}function Y_(at,pt,Tt,Kt,Ir,Kr){var vn=Tt&vt,In=at.length,zo=pt.length;if(In!=zo&&!(vn&&zo>In))return!1;var c0=Kr.get(at),p0=Kr.get(pt);if(c0&&p0)return c0==pt&&p0==at;var m0=-1,_0=!0,A0=Tt&Ft?new r$:a;for(Kr.set(at,pt),Kr.set(pt,at);++m0<In;){var W0=at[m0],Q0=pt[m0];if(Kt)var V0=vn?Kt(Q0,W0,m0,pt,at,Kr):Kt(W0,Q0,m0,at,pt,Kr);if(V0!==a){if(V0)continue;_0=!1;break}if(A0){if(!c$(pt,function(sy,cy){if(!Xr(A0,cy)&&(W0===sy||Ir(W0,sy,Tt,Kt,Kr)))return A0.push(cy)})){_0=!1;break}}else if(!(W0===Q0||Ir(W0,Q0,Tt,Kt,Kr))){_0=!1;break}}return Kr.delete(at),Kr.delete(pt),_0}function DS(at,pt,Tt,Kt,Ir,Kr,vn){switch(Tt){case u1:if(at.byteLength!=pt.byteLength||at.byteOffset!=pt.byteOffset)return!1;at=at.buffer,pt=pt.buffer;case xy:return!(at.byteLength!=pt.byteLength||!Kr(new _w(at),new _w(pt)));case oy:case gy:case $y:return cv(+at,+pt);case J0:return at.name==pt.name&&at.message==pt.message;case Ly:case Ny:return at==pt+"";case vy:var In=uy;case Iy:var zo=Kt&vt;if(In||(In=gw),at.size!=pt.size&&!zo)return!1;var c0=vn.get(at);if(c0)return c0==pt;Kt|=Ft,vn.set(at,pt);var p0=Y_(In(at),In(pt),Kt,Ir,Kr,vn);return vn.delete(at),p0;case py:if(H$)return H$.call(at)==H$.call(pt)}return!1}function MS(at,pt,Tt,Kt,Ir,Kr){var vn=Tt&vt,In=E2(at),zo=In.length,c0=E2(pt),p0=c0.length;if(zo!=p0&&!vn)return!1;for(var m0=zo;m0--;){var _0=In[m0];if(!(vn?_0 in pt:Sy.call(pt,_0)))return!1}var A0=Kr.get(at),W0=Kr.get(pt);if(A0&&W0)return A0==pt&&W0==at;var Q0=!0;Kr.set(at,pt),Kr.set(pt,at);for(var V0=vn;++m0<zo;){_0=In[m0];var sy=at[_0],cy=pt[_0];if(Kt)var B1=vn?Kt(cy,sy,_0,pt,at,Kr):Kt(sy,cy,_0,at,pt,Kr);if(!(B1===a?sy===cy||Ir(sy,cy,Tt,Kt,Kr):B1)){Q0=!1;break}V0||(V0=_0=="constructor")}if(Q0&&!V0){var x1=at.constructor,L1=pt.constructor;x1!=L1&&"constructor"in at&&"constructor"in pt&&!(typeof x1=="function"&&x1 instanceof x1&&typeof L1=="function"&&L1 instanceof L1)&&(Q0=!1)}return Kr.delete(at),Kr.delete(pt),Q0}function jv(at){return D2(rx(at,a,cx),at+"")}function E2(at){return g_(at,r1,O2)}function k2(at){return g_(at,O1,X_)}var I2=Iw?function(at){return Iw.get(at)}:Z2;function Fw(at){for(var pt=at.name+"",Tt=b$[pt],Kt=Sy.call(b$,pt)?Tt.length:0;Kt--;){var Ir=Tt[Kt],Kr=Ir.func;if(Kr==null||Kr==at)return Ir.name}return pt}function x$(at){var pt=Sy.call(Zr,"placeholder")?Zr:at;return pt.placeholder}function F0(){var at=Zr.iteratee||H2;return at=at===H2?b_:at,arguments.length?at(arguments[0],arguments[1]):at}function Ww(at,pt){var Tt=at.__data__;return WS(pt)?Tt[typeof pt=="string"?"string":"hash"]:Tt.map}function C2(at){for(var pt=r1(at),Tt=pt.length;Tt--;){var Kt=pt[Tt],Ir=at[Kt];pt[Tt]=[Kt,Ir,ex(Ir)]}return pt}function a$(at,pt){var Tt=my(at,pt);return v_(Tt)?Tt:a}function NS(at){var pt=Sy.call(at,e$),Tt=at[e$];try{at[e$]=a;var Kt=!0}catch{}var Ir=$w.call(at);return Kt&&(pt?at[e$]=Tt:delete at[e$]),Ir}var O2=n2?function(at){return at==null?[]:(at=ky(at),wv(n2(at),function(pt){return n_.call(at,pt)}))}:q2,X_=n2?function(at){for(var pt=[];at;)N1(pt,O2(at)),at=xw(at);return pt}:q2,m1=w1;(i2&&m1(new i2(new ArrayBuffer(1)))!=u1||F$&&m1(new F$)!=vy||a2&&m1(a2.resolve())!=Gy||v$&&m1(new v$)!=Iy||W$&&m1(new W$)!=Ay)&&(m1=function(at){var pt=w1(at),Tt=pt==_y?at.constructor:a,Kt=Tt?o$(Tt):"";if(Kt)switch(Kt){case vT:return u1;case bT:return vy;case $T:return Gy;case wT:return Iy;case _T:return Ay}return pt});function zS(at,pt,Tt){for(var Kt=-1,Ir=Tt.length;++Kt<Ir;){var Kr=Tt[Kt],vn=Kr.size;switch(Kr.type){case"drop":at+=vn;break;case"dropRight":pt-=vn;break;case"take":pt=h1(pt,at+vn);break;case"takeRight":at=Qy(at,pt-vn);break}}return{start:at,end:pt}}function jS(at){var pt=at.match(R1);return pt?pt[1].split(c1):[]}function Q_(at,pt,Tt){pt=Kv(pt,at);for(var Kt=-1,Ir=pt.length,Kr=!1;++Kt<Ir;){var vn=Ev(pt[Kt]);if(!(Kr=at!=null&&Tt(at,vn)))break;at=at[vn]}return Kr||++Kt!=Ir?Kr:(Ir=at==null?0:at.length,!!Ir&&Yw(Ir)&&Bv(vn,Ir)&&(Y0(at)||s$(at)))}function BS(at){var pt=at.length,Tt=new at.constructor(pt);return pt&&typeof at[0]=="string"&&Sy.call(at,"index")&&(Tt.index=at.index,Tt.input=at.input),Tt}function J_(at){return typeof at.constructor=="function"&&!Q$(at)?$$(xw(at)):{}}function LS(at,pt,Tt){var Kt=at.constructor;switch(pt){case xy:return x2(at);case oy:case gy:return new Kt(+at);case u1:return xS(at,Tt);case ay:case qy:case L0:case Dy:case l1:case g1:case T0:case d1:case U0:return M_(at,Tt);case vy:return new Kt;case $y:case Ny:return new Kt(at);case Ly:return TS(at);case Iy:return new Kt;case py:return SS(at)}}function US(at,pt){var Tt=pt.length;if(!Tt)return at;var Kt=Tt-1;return pt[Kt]=(Tt>1?"& ":"")+pt[Kt],pt=pt.join(Tt>2?", ":" "),at.replace(Ey,`{
/* [wrapped with `+pt+`] */
`)}function FS(at){return Y0(at)||s$(at)||!!(i_&&at&&at[i_])}function Bv(at,pt){var Tt=typeof at;return pt=pt??Sn,!!pt&&(Tt=="number"||Tt!="symbol"&&U1.test(at))&&at>-1&&at%1==0&&at<pt}function _1(at,pt,Tt){if(!My(Tt))return!1;var Kt=typeof pt;return(Kt=="number"?C1(Tt)&&Bv(pt,Tt.length):Kt=="string"&&pt in Tt)?cv(Tt[pt],at):!1}function A2(at,pt){if(Y0(at))return!1;var Tt=typeof at;return Tt=="number"||Tt=="symbol"||Tt=="boolean"||at==null||j1(at)?!0:Oy.test(at)||!Ry.test(at)||pt!=null&&at in ky(pt)}function WS(at){var pt=typeof at;return pt=="string"||pt=="number"||pt=="symbol"||pt=="boolean"?at!=="__proto__":at===null}function P2(at){var pt=Fw(at),Tt=Zr[pt];if(typeof Tt!="function"||!(pt in ly.prototype))return!1;if(at===Tt)return!0;var Kt=I2(Tt);return!!Kt&&at===Kt[0]}function VS(at){return!!e_&&e_ in at}var HS=vw?Lv:K2;function Q$(at){var pt=at&&at.constructor,Tt=typeof pt=="function"&&pt.prototype||y$;return at===Tt}function ex(at){return at===at&&!My(at)}function tx(at,pt){return function(Tt){return Tt==null?!1:Tt[at]===pt&&(pt!==a||at in ky(Tt))}}function GS(at){var pt=qw(at,function(Kt){return Tt.size===h&&Tt.clear(),Kt}),Tt=pt.cache;return pt}function ZS(at,pt){var Tt=at[1],Kt=pt[1],Ir=Tt|Kt,Kr=Ir<(Gt|qt|_n),vn=Kt==_n&&Tt==rr||Kt==_n&&Tt==No&&at[7].length<=pt[8]||Kt==(_n|No)&&pt[7].length<=pt[8]&&Tt==rr;if(!(Kr||vn))return at;Kt&Gt&&(at[2]=pt[2],Ir|=Tt&Gt?0:Lt);var In=pt[3];if(In){var zo=at[3];at[3]=zo?z_(zo,In,pt[4]):In,at[4]=zo?uv(at[3],b):pt[4]}return In=pt[5],In&&(zo=at[5],at[5]=zo?j_(zo,In,pt[6]):In,at[6]=zo?uv(at[5],b):pt[6]),In=pt[7],In&&(at[7]=In),Kt&_n&&(at[8]=at[8]==null?pt[8]:h1(at[8],pt[8])),at[9]==null&&(at[9]=pt[9]),at[0]=pt[0],at[1]=Ir,at}function qS(at){var pt=[];if(at!=null)for(var Tt in ky(at))pt.push(Tt);return pt}function KS(at){return $w.call(at)}function rx(at,pt,Tt){return pt=Qy(pt===a?at.length-1:pt,0),function(){for(var Kt=arguments,Ir=-1,Kr=Qy(Kt.length-pt,0),vn=r0(Kr);++Ir<Kr;)vn[Ir]=Kt[pt+Ir];Ir=-1;for(var In=r0(pt+1);++Ir<pt;)In[Ir]=Kt[Ir];return In[pt]=Tt(vn),b1(at,this,In)}}function nx(at,pt){return pt.length<2?at:i$(at,K1(pt,0,-1))}function YS(at,pt){for(var Tt=at.length,Kt=h1(pt.length,Tt),Ir=I1(at);Kt--;){var Kr=pt[Kt];at[Kt]=Bv(Kr,Tt)?Ir[Kr]:a}return at}function R2(at,pt){if(!(pt==="constructor"&&typeof at[pt]=="function")&&pt!="__proto__")return at[pt]}var ix=ox(k_),J$=cT||function(at,pt){return Wy.setTimeout(at,pt)},D2=ox(bS);function ax(at,pt,Tt){var Kt=pt+"";return D2(at,US(Kt,XS(jS(Kt),Tt)))}function ox(at){var pt=0,Tt=0;return function(){var Kt=mT(),Ir=x0-(Kt-Tt);if(Tt=Kt,Ir>0){if(++pt>=v0)return arguments[0]}else pt=0;return at.apply(a,arguments)}}function Vw(at,pt){var Tt=-1,Kt=at.length,Ir=Kt-1;for(pt=pt===a?Kt:pt;++Tt<pt;){var Kr=g2(Tt,Ir),vn=at[Kr];at[Kr]=at[Tt],at[Tt]=vn}return at.length=pt,at}var sx=GS(function(at){var pt=[];return at.charCodeAt(0)===46&&pt.push(""),at.replace(P1,function(Tt,Kt,Ir,Kr){pt.push(Ir?Kr.replace(kv,"$1"):Kt||Tt)}),pt});function Ev(at){if(typeof at=="string"||j1(at))return at;var pt=at+"";return pt=="0"&&1/at==-e0?"-0":pt}function o$(at){if(at!=null){try{return bw.call(at)}catch{}try{return at+""}catch{}}return""}function XS(at,pt){return $1(N0,function(Tt){var Kt="_."+Tt[0];pt&Tt[1]&&!C0(at,Kt)&&at.push(Kt)}),at.sort()}function ux(at){if(at instanceof ly)return at.clone();var pt=new Z1(at.__wrapped__,at.__chain__);return pt.__actions__=I1(at.__actions__),pt.__index__=at.__index__,pt.__values__=at.__values__,pt}function QS(at,pt,Tt){(Tt?_1(at,pt,Tt):pt===a)?pt=1:pt=Qy(X0(pt),0);var Kt=at==null?0:at.length;if(!Kt||pt<1)return[];for(var Ir=0,Kr=0,vn=r0(Ew(Kt/pt));Ir<Kt;)vn[Kr++]=K1(at,Ir,Ir+=pt);return vn}function JS(at){for(var pt=-1,Tt=at==null?0:at.length,Kt=0,Ir=[];++pt<Tt;){var Kr=at[pt];Kr&&(Ir[Kt++]=Kr)}return Ir}function eE(){var at=arguments.length;if(!at)return[];for(var pt=r0(at-1),Tt=arguments[0],Kt=at;Kt--;)pt[Kt-1]=arguments[Kt];return N1(Y0(Tt)?I1(Tt):[Tt],a1(pt,1))}var tE=iy(function(at,pt){return Vy(at)?Z$(at,a1(pt,1,Vy,!0)):[]}),rE=iy(function(at,pt){var Tt=Y1(pt);return Vy(Tt)&&(Tt=a),Vy(at)?Z$(at,a1(pt,1,Vy,!0),F0(Tt,2)):[]}),nE=iy(function(at,pt){var Tt=Y1(pt);return Vy(Tt)&&(Tt=a),Vy(at)?Z$(at,a1(pt,1,Vy,!0),a,Tt):[]});function iE(at,pt,Tt){var Kt=at==null?0:at.length;return Kt?(pt=Tt||pt===a?1:X0(pt),K1(at,pt<0?0:pt,Kt)):[]}function aE(at,pt,Tt){var Kt=at==null?0:at.length;return Kt?(pt=Tt||pt===a?1:X0(pt),pt=Kt-pt,K1(at,0,pt<0?0:pt)):[]}function oE(at,pt){return at&&at.length?Nw(at,F0(pt,3),!0,!0):[]}function sE(at,pt){return at&&at.length?Nw(at,F0(pt,3),!0):[]}function uE(at,pt,Tt,Kt){var Ir=at==null?0:at.length;return Ir?(Tt&&typeof Tt!="number"&&_1(at,pt,Tt)&&(Tt=0,Kt=Ir),eS(at,pt,Tt,Kt)):[]}function lx(at,pt,Tt){var Kt=at==null?0:at.length;if(!Kt)return-1;var Ir=Tt==null?0:X0(Tt);return Ir<0&&(Ir=Qy(Kt+Ir,0)),Rv(at,F0(pt,3),Ir)}function dx(at,pt,Tt){var Kt=at==null?0:at.length;if(!Kt)return-1;var Ir=Kt-1;return Tt!==a&&(Ir=X0(Tt),Ir=Tt<0?Qy(Kt+Ir,0):h1(Ir,Kt-1)),Rv(at,F0(pt,3),Ir,!0)}function cx(at){var pt=at==null?0:at.length;return pt?a1(at,1):[]}function lE(at){var pt=at==null?0:at.length;return pt?a1(at,e0):[]}function dE(at,pt){var Tt=at==null?0:at.length;return Tt?(pt=pt===a?1:X0(pt),a1(at,pt)):[]}function cE(at){for(var pt=-1,Tt=at==null?0:at.length,Kt={};++pt<Tt;){var Ir=at[pt];Kt[Ir[0]]=Ir[1]}return Kt}function px(at){return at&&at.length?at[0]:a}function pE(at,pt,Tt){var Kt=at==null?0:at.length;if(!Kt)return-1;var Ir=Tt==null?0:X0(Tt);return Ir<0&&(Ir=Qy(Kt+Ir,0)),_v(at,pt,Ir)}function fE(at){var pt=at==null?0:at.length;return pt?K1(at,0,-1):[]}var hE=iy(function(at){var pt=Ty(at,w2);return pt.length&&pt[0]===at[0]?c2(pt):[]}),mE=iy(function(at){var pt=Y1(at),Tt=Ty(at,w2);return pt===Y1(Tt)?pt=a:Tt.pop(),Tt.length&&Tt[0]===at[0]?c2(Tt,F0(pt,2)):[]}),gE=iy(function(at){var pt=Y1(at),Tt=Ty(at,w2);return pt=typeof pt=="function"?pt:a,pt&&Tt.pop(),Tt.length&&Tt[0]===at[0]?c2(Tt,a,pt):[]});function yE(at,pt){return at==null?"":fT.call(at,pt)}function Y1(at){var pt=at==null?0:at.length;return pt?at[pt-1]:a}function vE(at,pt,Tt){var Kt=at==null?0:at.length;if(!Kt)return-1;var Ir=Kt;return Tt!==a&&(Ir=X0(Tt),Ir=Ir<0?Qy(Kt+Ir,0):h1(Ir,Kt-1)),pt===pt?Xx(at,pt,Ir):Rv(at,j$,Ir,!0)}function bE(at,pt){return at&&at.length?x_(at,X0(pt)):a}var $E=iy(fx);function fx(at,pt){return at&&at.length&&pt&&pt.length?m2(at,pt):at}function wE(at,pt,Tt){return at&&at.length&&pt&&pt.length?m2(at,pt,F0(Tt,2)):at}function _E(at,pt,Tt){return at&&at.length&&pt&&pt.length?m2(at,pt,a,Tt):at}var xE=jv(function(at,pt){var Tt=at==null?0:at.length,Kt=s2(at,pt);return E_(at,Ty(pt,function(Ir){return Bv(Ir,Tt)?+Ir:Ir}).sort(N_)),Kt});function TE(at,pt){var Tt=[];if(!(at&&at.length))return Tt;var Kt=-1,Ir=[],Kr=at.length;for(pt=F0(pt,3);++Kt<Kr;){var vn=at[Kt];pt(vn,Kt,at)&&(Tt.push(vn),Ir.push(Kt))}return E_(at,Ir),Tt}function M2(at){return at==null?at:yT.call(at)}function SE(at,pt,Tt){var Kt=at==null?0:at.length;return Kt?(Tt&&typeof Tt!="number"&&_1(at,pt,Tt)?(pt=0,Tt=Kt):(pt=pt==null?0:X0(pt),Tt=Tt===a?Kt:X0(Tt)),K1(at,pt,Tt)):[]}function EE(at,pt){return Mw(at,pt)}function kE(at,pt,Tt){return v2(at,pt,F0(Tt,2))}function IE(at,pt){var Tt=at==null?0:at.length;if(Tt){var Kt=Mw(at,pt);if(Kt<Tt&&cv(at[Kt],pt))return Kt}return-1}function CE(at,pt){return Mw(at,pt,!0)}function OE(at,pt,Tt){return v2(at,pt,F0(Tt,2),!0)}function AE(at,pt){var Tt=at==null?0:at.length;if(Tt){var Kt=Mw(at,pt,!0)-1;if(cv(at[Kt],pt))return Kt}return-1}function PE(at){return at&&at.length?I_(at):[]}function RE(at,pt){return at&&at.length?I_(at,F0(pt,2)):[]}function DE(at){var pt=at==null?0:at.length;return pt?K1(at,1,pt):[]}function ME(at,pt,Tt){return at&&at.length?(pt=Tt||pt===a?1:X0(pt),K1(at,0,pt<0?0:pt)):[]}function NE(at,pt,Tt){var Kt=at==null?0:at.length;return Kt?(pt=Tt||pt===a?1:X0(pt),pt=Kt-pt,K1(at,pt<0?0:pt,Kt)):[]}function zE(at,pt){return at&&at.length?Nw(at,F0(pt,3),!1,!0):[]}function jE(at,pt){return at&&at.length?Nw(at,F0(pt,3)):[]}var BE=iy(function(at){return qv(a1(at,1,Vy,!0))}),LE=iy(function(at){var pt=Y1(at);return Vy(pt)&&(pt=a),qv(a1(at,1,Vy,!0),F0(pt,2))}),UE=iy(function(at){var pt=Y1(at);return pt=typeof pt=="function"?pt:a,qv(a1(at,1,Vy,!0),a,pt)});function FE(at){return at&&at.length?qv(at):[]}function WE(at,pt){return at&&at.length?qv(at,F0(pt,2)):[]}function VE(at,pt){return pt=typeof pt=="function"?pt:a,at&&at.length?qv(at,a,pt):[]}function N2(at){if(!(at&&at.length))return[];var pt=0;return at=wv(at,function(Tt){if(Vy(Tt))return pt=Qy(Tt.length,pt),!0}),m$(pt,function(Tt){return Ty(at,p$(Tt))})}function hx(at,pt){if(!(at&&at.length))return[];var Tt=N2(at);return pt==null?Tt:Ty(Tt,function(Kt){return b1(pt,a,Kt)})}var HE=iy(function(at,pt){return Vy(at)?Z$(at,pt):[]}),GE=iy(function(at){return $2(wv(at,Vy))}),ZE=iy(function(at){var pt=Y1(at);return Vy(pt)&&(pt=a),$2(wv(at,Vy),F0(pt,2))}),qE=iy(function(at){var pt=Y1(at);return pt=typeof pt=="function"?pt:a,$2(wv(at,Vy),a,pt)}),KE=iy(N2);function YE(at,pt){return P_(at||[],pt||[],G$)}function XE(at,pt){return P_(at||[],pt||[],Y$)}var QE=iy(function(at){var pt=at.length,Tt=pt>1?at[pt-1]:a;return Tt=typeof Tt=="function"?(at.pop(),Tt):a,hx(at,Tt)});function mx(at){var pt=Zr(at);return pt.__chain__=!0,pt}function JE(at,pt){return pt(at),at}function Hw(at,pt){return pt(at)}var e3=jv(function(at){var pt=at.length,Tt=pt?at[0]:0,Kt=this.__wrapped__,Ir=function(Kr){return s2(Kr,at)};return pt>1||this.__actions__.length||!(Kt instanceof ly)||!Bv(Tt)?this.thru(Ir):(Kt=Kt.slice(Tt,+Tt+(pt?1:0)),Kt.__actions__.push({func:Hw,args:[Ir],thisArg:a}),new Z1(Kt,this.__chain__).thru(function(Kr){return pt&&!Kr.length&&Kr.push(a),Kr}))});function t3(){return mx(this)}function r3(){return new Z1(this.value(),this.__chain__)}function n3(){this.__values__===a&&(this.__values__=Cx(this.value()));var at=this.__index__>=this.__values__.length,pt=at?a:this.__values__[this.__index__++];return{done:at,value:pt}}function i3(){return this}function a3(at){for(var pt,Tt=this;Tt instanceof Ow;){var Kt=ux(Tt);Kt.__index__=0,Kt.__values__=a,pt?Ir.__wrapped__=Kt:pt=Kt;var Ir=Kt;Tt=Tt.__wrapped__}return Ir.__wrapped__=at,pt}function o3(){var at=this.__wrapped__;if(at instanceof ly){var pt=at;return this.__actions__.length&&(pt=new ly(this)),pt=pt.reverse(),pt.__actions__.push({func:Hw,args:[M2],thisArg:a}),new Z1(pt,this.__chain__)}return this.thru(M2)}function s3(){return A_(this.__wrapped__,this.__actions__)}var u3=zw(function(at,pt,Tt){Sy.call(at,Tt)?++at[Tt]:Nv(at,Tt,1)});function l3(at,pt,Tt){var Kt=Y0(at)?fw:JT;return Tt&&_1(at,pt,Tt)&&(pt=a),Kt(at,F0(pt,3))}function d3(at,pt){var Tt=Y0(at)?wv:h_;return Tt(at,F0(pt,3))}var c3=F_(lx),p3=F_(dx);function f3(at,pt){return a1(Gw(at,pt),1)}function h3(at,pt){return a1(Gw(at,pt),e0)}function m3(at,pt,Tt){return Tt=Tt===a?1:X0(Tt),a1(Gw(at,pt),Tt)}function gx(at,pt){var Tt=Y0(at)?$1:Zv;return Tt(at,F0(pt,3))}function yx(at,pt){var Tt=Y0(at)?l$:f_;return Tt(at,F0(pt,3))}var g3=zw(function(at,pt,Tt){Sy.call(at,Tt)?at[Tt].push(pt):Nv(at,Tt,[pt])});function y3(at,pt,Tt,Kt){at=C1(at)?at:S$(at),Tt=Tt&&!Kt?X0(Tt):0;var Ir=at.length;return Tt<0&&(Tt=Qy(Ir+Tt,0)),Xw(at)?Tt<=Ir&&at.indexOf(pt,Tt)>-1:!!Ir&&_v(at,pt,Tt)>-1}var v3=iy(function(at,pt,Tt){var Kt=-1,Ir=typeof pt=="function",Kr=C1(at)?r0(at.length):[];return Zv(at,function(vn){Kr[++Kt]=Ir?b1(pt,vn,Tt):q$(vn,pt,Tt)}),Kr}),b3=zw(function(at,pt,Tt){Nv(at,Tt,pt)});function Gw(at,pt){var Tt=Y0(at)?Ty:$_;return Tt(at,F0(pt,3))}function $3(at,pt,Tt,Kt){return at==null?[]:(Y0(pt)||(pt=pt==null?[]:[pt]),Tt=Kt?a:Tt,Y0(Tt)||(Tt=Tt==null?[]:[Tt]),T_(at,pt,Tt))}var w3=zw(function(at,pt,Tt){at[Tt?0:1].push(pt)},function(){return[[],[]]});function _3(at,pt,Tt){var Kt=Y0(at)?k1:L$,Ir=arguments.length<3;return Kt(at,F0(pt,4),Tt,Ir,Zv)}function x3(at,pt,Tt){var Kt=Y0(at)?hw:L$,Ir=arguments.length<3;return Kt(at,F0(pt,4),Tt,Ir,f_)}function T3(at,pt){var Tt=Y0(at)?wv:h_;return Tt(at,Kw(F0(pt,3)))}function S3(at){var pt=Y0(at)?l_:yS;return pt(at)}function E3(at,pt,Tt){(Tt?_1(at,pt,Tt):pt===a)?pt=1:pt=X0(pt);var Kt=Y0(at)?qT:vS;return Kt(at,pt)}function k3(at){var pt=Y0(at)?KT:$S;return pt(at)}function I3(at){if(at==null)return 0;if(C1(at))return Xw(at)?g$(at):at.length;var pt=m1(at);return pt==vy||pt==Iy?at.size:f2(at).length}function C3(at,pt,Tt){var Kt=Y0(at)?c$:wS;return Tt&&_1(at,pt,Tt)&&(pt=a),Kt(at,F0(pt,3))}var O3=iy(function(at,pt){if(at==null)return[];var Tt=pt.length;return Tt>1&&_1(at,pt[0],pt[1])?pt=[]:Tt>2&&_1(pt[0],pt[1],pt[2])&&(pt=[pt[0]]),T_(at,a1(pt,1),[])}),Zw=dT||function(){return Wy.Date.now()};function A3(at,pt){if(typeof pt!="function")throw new G1(d);return at=X0(at),function(){if(--at<1)return pt.apply(this,arguments)}}function vx(at,pt,Tt){return pt=Tt?a:pt,pt=at&&pt==null?at.length:pt,zv(at,_n,a,a,a,a,pt)}function bx(at,pt){var Tt;if(typeof pt!="function")throw new G1(d);return at=X0(at),function(){return--at>0&&(Tt=pt.apply(this,arguments)),at<=1&&(pt=a),Tt}}var z2=iy(function(at,pt,Tt){var Kt=Gt;if(Tt.length){var Ir=uv(Tt,x$(z2));Kt|=Hr}return zv(at,Kt,pt,Tt,Ir)}),$x=iy(function(at,pt,Tt){var Kt=Gt|qt;if(Tt.length){var Ir=uv(Tt,x$($x));Kt|=Hr}return zv(pt,Kt,at,Tt,Ir)});function wx(at,pt,Tt){pt=Tt?a:pt;var Kt=zv(at,rr,a,a,a,a,a,pt);return Kt.placeholder=wx.placeholder,Kt}function _x(at,pt,Tt){pt=Tt?a:pt;var Kt=zv(at,jr,a,a,a,a,a,pt);return Kt.placeholder=_x.placeholder,Kt}function xx(at,pt,Tt){var Kt,Ir,Kr,vn,In,zo,c0=0,p0=!1,m0=!1,_0=!0;if(typeof at!="function")throw new G1(d);pt=X1(pt)||0,My(Tt)&&(p0=!!Tt.leading,m0="maxWait"in Tt,Kr=m0?Qy(X1(Tt.maxWait)||0,pt):Kr,_0="trailing"in Tt?!!Tt.trailing:_0);function A0(Hy){var pv=Kt,Fv=Ir;return Kt=Ir=a,c0=Hy,vn=at.apply(Fv,pv),vn}function W0(Hy){return c0=Hy,In=J$(sy,pt),p0?A0(Hy):vn}function Q0(Hy){var pv=Hy-zo,Fv=Hy-c0,Fx=pt-pv;return m0?h1(Fx,Kr-Fv):Fx}function V0(Hy){var pv=Hy-zo,Fv=Hy-c0;return zo===a||pv>=pt||pv<0||m0&&Fv>=Kr}function sy(){var Hy=Zw();if(V0(Hy))return cy(Hy);In=J$(sy,Q0(Hy))}function cy(Hy){return In=a,_0&&Kt?A0(Hy):(Kt=Ir=a,vn)}function B1(){In!==a&&R_(In),c0=0,Kt=zo=Ir=In=a}function x1(){return In===a?vn:cy(Zw())}function L1(){var Hy=Zw(),pv=V0(Hy);if(Kt=arguments,Ir=this,zo=Hy,pv){if(In===a)return W0(zo);if(m0)return R_(In),In=J$(sy,pt),A0(zo)}return In===a&&(In=J$(sy,pt)),vn}return L1.cancel=B1,L1.flush=x1,L1}var P3=iy(function(at,pt){return p_(at,1,pt)}),R3=iy(function(at,pt,Tt){return p_(at,X1(pt)||0,Tt)});function D3(at){return zv(at,Qo)}function qw(at,pt){if(typeof at!="function"||pt!=null&&typeof pt!="function")throw new G1(d);var Tt=function(){var Kt=arguments,Ir=pt?pt.apply(this,Kt):Kt[0],Kr=Tt.cache;if(Kr.has(Ir))return Kr.get(Ir);var vn=at.apply(this,Kt);return Tt.cache=Kr.set(Ir,vn)||Kr,vn};return Tt.cache=new(qw.Cache||Mv),Tt}qw.Cache=Mv;function Kw(at){if(typeof at!="function")throw new G1(d);return function(){var pt=arguments;switch(pt.length){case 0:return!at.call(this);case 1:return!at.call(this,pt[0]);case 2:return!at.call(this,pt[0],pt[1]);case 3:return!at.call(this,pt[0],pt[1],pt[2])}return!at.apply(this,pt)}}function M3(at){return bx(2,at)}var N3=_S(function(at,pt){pt=pt.length==1&&Y0(pt[0])?Ty(pt[0],ir(F0())):Ty(a1(pt,1),ir(F0()));var Tt=pt.length;return iy(function(Kt){for(var Ir=-1,Kr=h1(Kt.length,Tt);++Ir<Kr;)Kt[Ir]=pt[Ir].call(this,Kt[Ir]);return b1(at,this,Kt)})}),j2=iy(function(at,pt){var Tt=uv(pt,x$(j2));return zv(at,Hr,a,pt,Tt)}),Tx=iy(function(at,pt){var Tt=uv(pt,x$(Tx));return zv(at,wn,a,pt,Tt)}),z3=jv(function(at,pt){return zv(at,No,a,a,a,pt)});function j3(at,pt){if(typeof at!="function")throw new G1(d);return pt=pt===a?pt:X0(pt),iy(at,pt)}function B3(at,pt){if(typeof at!="function")throw new G1(d);return pt=pt==null?0:Qy(X0(pt),0),iy(function(Tt){var Kt=Tt[pt],Ir=Yv(Tt,0,pt);return Kt&&N1(Ir,Kt),b1(at,this,Ir)})}function L3(at,pt,Tt){var Kt=!0,Ir=!0;if(typeof at!="function")throw new G1(d);return My(Tt)&&(Kt="leading"in Tt?!!Tt.leading:Kt,Ir="trailing"in Tt?!!Tt.trailing:Ir),xx(at,pt,{leading:Kt,maxWait:pt,trailing:Ir})}function U3(at){return vx(at,1)}function F3(at,pt){return j2(_2(pt),at)}function W3(){if(!arguments.length)return[];var at=arguments[0];return Y0(at)?at:[at]}function V3(at){return q1(at,$t)}function H3(at,pt){return pt=typeof pt=="function"?pt:a,q1(at,$t,pt)}function G3(at){return q1(at,g|$t)}function Z3(at,pt){return pt=typeof pt=="function"?pt:a,q1(at,g|$t,pt)}function q3(at,pt){return pt==null||c_(at,pt,r1(pt))}function cv(at,pt){return at===pt||at!==at&&pt!==pt}var K3=Uw(d2),Y3=Uw(function(at,pt){return at>=pt}),s$=y_(function(){return arguments}())?y_:function(at){return By(at)&&Sy.call(at,"callee")&&!n_.call(at,"callee")},Y0=r0.isArray,X3=O$?ir(O$):aS;function C1(at){return at!=null&&Yw(at.length)&&!Lv(at)}function Vy(at){return By(at)&&C1(at)}function Q3(at){return at===!0||at===!1||By(at)&&w1(at)==oy}var Xv=pT||K2,J3=dw?ir(dw):oS;function _k(at){return By(at)&&at.nodeType===1&&!ew(at)}function eI(at){if(at==null)return!0;if(C1(at)&&(Y0(at)||typeof at=="string"||typeof at.splice=="function"||Xv(at)||T$(at)||s$(at)))return!at.length;var pt=m1(at);if(pt==vy||pt==Iy)return!at.size;if(Q$(at))return!f2(at).length;for(var Tt in at)if(Sy.call(at,Tt))return!1;return!0}function tI(at,pt){return K$(at,pt)}function rI(at,pt,Tt){Tt=typeof Tt=="function"?Tt:a;var Kt=Tt?Tt(at,pt):a;return Kt===a?K$(at,pt,a,Tt):!!Kt}function B2(at){if(!By(at))return!1;var pt=w1(at);return pt==J0||pt==hy||typeof at.message=="string"&&typeof at.name=="string"&&!ew(at)}function nI(at){return typeof at=="number"&&a_(at)}function Lv(at){if(!My(at))return!1;var pt=w1(at);return pt==H0||pt==yy||pt==fy||pt==fv}function Sx(at){return typeof at=="number"&&at==X0(at)}function Yw(at){return typeof at=="number"&&at>-1&&at%1==0&&at<=Sn}function My(at){var pt=typeof at;return at!=null&&(pt=="object"||pt=="function")}function By(at){return at!=null&&typeof at=="object"}var Ex=A$?ir(A$):uS;function iI(at,pt){return at===pt||p2(at,pt,C2(pt))}function aI(at,pt,Tt){return Tt=typeof Tt=="function"?Tt:a,p2(at,pt,C2(pt),Tt)}function oI(at){return kx(at)&&at!=+at}function sI(at){if(HS(at))throw new K0(s);return v_(at)}function uI(at){return at===null}function lI(at){return at==null}function kx(at){return typeof at=="number"||By(at)&&w1(at)==$y}function ew(at){if(!By(at)||w1(at)!=_y)return!1;var pt=xw(at);if(pt===null)return!0;var Tt=Sy.call(pt,"constructor")&&pt.constructor;return typeof Tt=="function"&&Tt instanceof Tt&&bw.call(Tt)==oT}var L2=P$?ir(P$):lS;function dI(at){return Sx(at)&&at>=-Sn&&at<=Sn}var Ix=R$?ir(R$):dS;function Xw(at){return typeof at=="string"||!Y0(at)&&By(at)&&w1(at)==Ny}function j1(at){return typeof at=="symbol"||By(at)&&w1(at)==py}var T$=cw?ir(cw):cS;function cI(at){return at===a}function pI(at){return By(at)&&m1(at)==Ay}function fI(at){return By(at)&&w1(at)==s1}var hI=Uw(h2),mI=Uw(function(at,pt){return at<=pt});function Cx(at){if(!at)return[];if(C1(at))return Xw(at)?lv(at):I1(at);if(U$&&at[U$])return q0(at[U$]());var pt=m1(at),Tt=pt==vy?uy:pt==Iy?gw:S$;return Tt(at)}function Uv(at){if(!at)return at===0?at:0;if(at=X1(at),at===e0||at===-e0){var pt=at<0?-1:1;return pt*t0}return at===at?at:0}function X0(at){var pt=Uv(at),Tt=pt%1;return pt===pt?Tt?pt-Tt:pt:0}function Ox(at){return at?n$(X0(at),0,xn):0}function X1(at){if(typeof at=="number")return at;if(j1(at))return d0;if(My(at)){var pt=typeof at.valueOf=="function"?at.valueOf():at;at=My(pt)?pt+"":pt}if(typeof at!="string")return at===0?at:+at;at=Ht(at);var Tt=J1.test(at);return Tt||T1.test(at)?E$(at.slice(2),Tt?2:8):yv.test(at)?d0:+at}function Ax(at){return Sv(at,O1(at))}function gI(at){return at?n$(X0(at),-Sn,Sn):at===0?at:0}function wy(at){return at==null?"":z1(at)}var yI=w$(function(at,pt){if(Q$(pt)||C1(pt)){Sv(pt,r1(pt),at);return}for(var Tt in pt)Sy.call(pt,Tt)&&G$(at,Tt,pt[Tt])}),Px=w$(function(at,pt){Sv(pt,O1(pt),at)}),Qw=w$(function(at,pt,Tt,Kt){Sv(pt,O1(pt),at,Kt)}),vI=w$(function(at,pt,Tt,Kt){Sv(pt,r1(pt),at,Kt)}),bI=jv(s2);function $I(at,pt){var Tt=$$(at);return pt==null?Tt:d_(Tt,pt)}var wI=iy(function(at,pt){at=ky(at);var Tt=-1,Kt=pt.length,Ir=Kt>2?pt[2]:a;for(Ir&&_1(pt[0],pt[1],Ir)&&(Kt=1);++Tt<Kt;)for(var Kr=pt[Tt],vn=O1(Kr),In=-1,zo=vn.length;++In<zo;){var c0=vn[In],p0=at[c0];(p0===a||cv(p0,y$[c0])&&!Sy.call(at,c0))&&(at[c0]=Kr[c0])}return at}),_I=iy(function(at){return at.push(a,K_),b1(Rx,a,at)});function xI(at,pt){return N$(at,F0(pt,3),Tv)}function TI(at,pt){return N$(at,F0(pt,3),l2)}function SI(at,pt){return at==null?at:u2(at,F0(pt,3),O1)}function EI(at,pt){return at==null?at:m_(at,F0(pt,3),O1)}function kI(at,pt){return at&&Tv(at,F0(pt,3))}function II(at,pt){return at&&l2(at,F0(pt,3))}function CI(at){return at==null?[]:Rw(at,r1(at))}function OI(at){return at==null?[]:Rw(at,O1(at))}function U2(at,pt,Tt){var Kt=at==null?a:i$(at,pt);return Kt===a?Tt:Kt}function AI(at,pt){return at!=null&&Q_(at,pt,tS)}function F2(at,pt){return at!=null&&Q_(at,pt,rS)}var PI=V_(function(at,pt,Tt){pt!=null&&typeof pt.toString!="function"&&(pt=$w.call(pt)),at[pt]=Tt},V2(A1)),RI=V_(function(at,pt,Tt){pt!=null&&typeof pt.toString!="function"&&(pt=$w.call(pt)),Sy.call(at,pt)?at[pt].push(Tt):at[pt]=[Tt]},F0),DI=iy(q$);function r1(at){return C1(at)?u_(at):f2(at)}function O1(at){return C1(at)?u_(at,!0):pS(at)}function MI(at,pt){var Tt={};return pt=F0(pt,3),Tv(at,function(Kt,Ir,Kr){Nv(Tt,pt(Kt,Ir,Kr),Kt)}),Tt}function NI(at,pt){var Tt={};return pt=F0(pt,3),Tv(at,function(Kt,Ir,Kr){Nv(Tt,Ir,pt(Kt,Ir,Kr))}),Tt}var zI=w$(function(at,pt,Tt){Dw(at,pt,Tt)}),Rx=w$(function(at,pt,Tt,Kt){Dw(at,pt,Tt,Kt)}),jI=jv(function(at,pt){var Tt={};if(at==null)return Tt;var Kt=!1;pt=Ty(pt,function(Kr){return Kr=Kv(Kr,at),Kt||(Kt=Kr.length>1),Kr}),Sv(at,k2(at),Tt),Kt&&(Tt=q1(Tt,g|st|$t,RS));for(var Ir=pt.length;Ir--;)b2(Tt,pt[Ir]);return Tt});function BI(at,pt){return Dx(at,Kw(F0(pt)))}var LI=jv(function(at,pt){return at==null?{}:hS(at,pt)});function Dx(at,pt){if(at==null)return{};var Tt=Ty(k2(at),function(Kt){return[Kt]});return pt=F0(pt),S_(at,Tt,function(Kt,Ir){return pt(Kt,Ir[0])})}function UI(at,pt,Tt){pt=Kv(pt,at);var Kt=-1,Ir=pt.length;for(Ir||(Ir=1,at=a);++Kt<Ir;){var Kr=at==null?a:at[Ev(pt[Kt])];Kr===a&&(Kt=Ir,Kr=Tt),at=Lv(Kr)?Kr.call(at):Kr}return at}function FI(at,pt,Tt){return at==null?at:Y$(at,pt,Tt)}function WI(at,pt,Tt,Kt){return Kt=typeof Kt=="function"?Kt:a,at==null?at:Y$(at,pt,Tt,Kt)}var Mx=Z_(r1),Nx=Z_(O1);function VI(at,pt,Tt){var Kt=Y0(at),Ir=Kt||Xv(at)||T$(at);if(pt=F0(pt,4),Tt==null){var Kr=at&&at.constructor;Ir?Tt=Kt?new Kr:[]:My(at)?Tt=Lv(Kr)?$$(xw(at)):{}:Tt={}}return(Ir?$1:Tv)(at,function(vn,In,zo){return pt(Tt,vn,In,zo)}),Tt}function HI(at,pt){return at==null?!0:b2(at,pt)}function GI(at,pt,Tt){return at==null?at:O_(at,pt,_2(Tt))}function ZI(at,pt,Tt,Kt){return Kt=typeof Kt=="function"?Kt:a,at==null?at:O_(at,pt,_2(Tt),Kt)}function S$(at){return at==null?[]:Lr(at,r1(at))}function qI(at){return at==null?[]:Lr(at,O1(at))}function KI(at,pt,Tt){return Tt===a&&(Tt=pt,pt=a),Tt!==a&&(Tt=X1(Tt),Tt=Tt===Tt?Tt:0),pt!==a&&(pt=X1(pt),pt=pt===pt?pt:0),n$(X1(at),pt,Tt)}function YI(at,pt,Tt){return pt=Uv(pt),Tt===a?(Tt=pt,pt=0):Tt=Uv(Tt),at=X1(at),nS(at,pt,Tt)}function XI(at,pt,Tt){if(Tt&&typeof Tt!="boolean"&&_1(at,pt,Tt)&&(pt=Tt=a),Tt===a&&(typeof pt=="boolean"?(Tt=pt,pt=a):typeof at=="boolean"&&(Tt=at,at=a)),at===a&&pt===a?(at=0,pt=1):(at=Uv(at),pt===a?(pt=at,at=0):pt=Uv(pt)),at>pt){var Kt=at;at=pt,pt=Kt}if(Tt||at%1||pt%1){var Ir=o_();return h1(at+Ir*(pt-at+lw("1e-"+((Ir+"").length-1))),pt)}return g2(at,pt)}var QI=_$(function(at,pt,Tt){return pt=pt.toLowerCase(),at+(Tt?zx(pt):pt)});function zx(at){return W2(wy(at).toLowerCase())}function jx(at){return at=wy(at),at&&at.replace(Iv,k0).replace(b0,"")}function JI(at,pt,Tt){at=wy(at),pt=z1(pt);var Kt=at.length;Tt=Tt===a?Kt:n$(X0(Tt),0,Kt);var Ir=Tt;return Tt-=pt.length,Tt>=0&&at.slice(Tt,Ir)==pt}function eC(at){return at=wy(at),at&&O0.test(at)?at.replace(a0,w0):at}function tC(at){return at=wy(at),at&&_g.test(at)?at.replace(Zy,"\\$&"):at}var rC=_$(function(at,pt,Tt){return at+(Tt?"-":"")+pt.toLowerCase()}),nC=_$(function(at,pt,Tt){return at+(Tt?" ":"")+pt.toLowerCase()}),iC=U_("toLowerCase");function aC(at,pt,Tt){at=wy(at),pt=X0(pt);var Kt=pt?g$(at):0;if(!pt||Kt>=pt)return at;var Ir=(pt-Kt)/2;return Lw(kw(Ir),Tt)+at+Lw(Ew(Ir),Tt)}function oC(at,pt,Tt){at=wy(at),pt=X0(pt);var Kt=pt?g$(at):0;return pt&&Kt<pt?at+Lw(pt-Kt,Tt):at}function sC(at,pt,Tt){at=wy(at),pt=X0(pt);var Kt=pt?g$(at):0;return pt&&Kt<pt?Lw(pt-Kt,Tt)+at:at}function uC(at,pt,Tt){return Tt||pt==null?pt=0:pt&&(pt=+pt),gT(wy(at).replace(ey,""),pt||0)}function lC(at,pt,Tt){return(Tt?_1(at,pt,Tt):pt===a)?pt=1:pt=X0(pt),y2(wy(at),pt)}function dC(){var at=arguments,pt=wy(at[0]);return at.length<3?pt:pt.replace(at[1],at[2])}var cC=_$(function(at,pt,Tt){return at+(Tt?"_":"")+pt.toLowerCase()});function pC(at,pt,Tt){return Tt&&typeof Tt!="number"&&_1(at,pt,Tt)&&(pt=Tt=a),Tt=Tt===a?xn:Tt>>>0,Tt?(at=wy(at),at&&(typeof pt=="string"||pt!=null&&!L2(pt))&&(pt=z1(pt),!pt&&dy(at))?Yv(lv(at),0,Tt):at.split(pt,Tt)):[]}var fC=_$(function(at,pt,Tt){return at+(Tt?" ":"")+W2(pt)});function hC(at,pt,Tt){return at=wy(at),Tt=Tt==null?0:n$(X0(Tt),0,at.length),pt=z1(pt),at.slice(Tt,Tt+pt.length)==pt}function mC(at,pt,Tt){var Kt=Zr.templateSettings;Tt&&_1(at,pt,Tt)&&(pt=a),at=wy(at),pt=Qw({},pt,Kt,q_);var Ir=Qw({},pt.imports,Kt.imports,q_),Kr=r1(Ir),vn=Lr(Ir,Kr),In,zo,c0=0,p0=pt.interpolate||S1,m0="__p += '",_0=r2((pt.escape||S1).source+"|"+p0.source+"|"+(p0===Uy?Q1:S1).source+"|"+(pt.evaluate||S1).source+"|$","g"),A0="//# sourceURL="+(Sy.call(pt,"sourceURL")?(pt.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++S0+"]")+`
`;at.replace(_0,function(V0,sy,cy,B1,x1,L1){return cy||(cy=B1),m0+=at.slice(c0,L1).replace(Jy,B0),sy&&(In=!0,m0+=`' +
__e(`+sy+`) +
'`),x1&&(zo=!0,m0+=`';
`+x1+`;
__p += '`),cy&&(m0+=`' +
((__t = (`+cy+`)) == null ? '' : __t) +
'`),c0=L1+V0.length,V0}),m0+=`';
`;var W0=Sy.call(pt,"variable")&&pt.variable;if(!W0)m0=`with (obj) {
`+m0+`
}
`;else if(mv.test(W0))throw new K0($);m0=(zo?m0.replace(Py,""):m0).replace(Yr,"$1").replace(Ro,"$1;"),m0="function("+(W0||"obj")+`) {
`+(W0?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(In?", __e = _.escape":"")+(zo?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+m0+`return __p
}`;var Q0=Lx(function(){return by(Kr,A0+"return "+m0).apply(a,vn)});if(Q0.source=m0,B2(Q0))throw Q0;return Q0}function gC(at){return wy(at).toLowerCase()}function yC(at){return wy(at).toUpperCase()}function vC(at,pt,Tt){if(at=wy(at),at&&(Tt||pt===a))return Ht(at);if(!at||!(pt=z1(pt)))return at;var Kt=lv(at),Ir=lv(pt),Kr=An(Kt,Ir),vn=i0(Kt,Ir)+1;return Yv(Kt,Kr,vn).join("")}function bC(at,pt,Tt){if(at=wy(at),at&&(Tt||pt===a))return at.slice(0,J2(at)+1);if(!at||!(pt=z1(pt)))return at;var Kt=lv(at),Ir=i0(Kt,lv(pt))+1;return Yv(Kt,0,Ir).join("")}function $C(at,pt,Tt){if(at=wy(at),at&&(Tt||pt===a))return at.replace(ey,"");if(!at||!(pt=z1(pt)))return at;var Kt=lv(at),Ir=An(Kt,lv(pt));return Yv(Kt,Ir).join("")}function wC(at,pt){var Tt=Xo,Kt=l0;if(My(pt)){var Ir="separator"in pt?pt.separator:Ir;Tt="length"in pt?X0(pt.length):Tt,Kt="omission"in pt?z1(pt.omission):Kt}at=wy(at);var Kr=at.length;if(dy(at)){var vn=lv(at);Kr=vn.length}if(Tt>=Kr)return at;var In=Tt-g$(Kt);if(In<1)return Kt;var zo=vn?Yv(vn,0,In).join(""):at.slice(0,In);if(Ir===a)return zo+Kt;if(vn&&(In+=zo.length-In),L2(Ir)){if(at.slice(In).search(Ir)){var c0,p0=zo;for(Ir.global||(Ir=r2(Ir.source,wy(gv.exec(Ir))+"g")),Ir.lastIndex=0;c0=Ir.exec(p0);)var m0=c0.index;zo=zo.slice(0,m0===a?In:m0)}}else if(at.indexOf(z1(Ir),In)!=In){var _0=zo.lastIndexOf(Ir);_0>-1&&(zo=zo.slice(0,_0))}return zo+Kt}function _C(at){return at=wy(at),at&&u0.test(at)?at.replace(Bo,Qx):at}var xC=_$(function(at,pt,Tt){return at+(Tt?" ":"")+pt.toUpperCase()}),W2=U_("toUpperCase");function Bx(at,pt,Tt){return at=wy(at),pt=Tt?a:pt,pt===a?n0(at)?tT(at):mw(at):at.match(pt)||[]}var Lx=iy(function(at,pt){try{return b1(at,a,pt)}catch(Tt){return B2(Tt)?Tt:new K0(Tt)}}),TC=jv(function(at,pt){return $1(pt,function(Tt){Tt=Ev(Tt),Nv(at,Tt,z2(at[Tt],at))}),at});function SC(at){var pt=at==null?0:at.length,Tt=F0();return at=pt?Ty(at,function(Kt){if(typeof Kt[1]!="function")throw new G1(d);return[Tt(Kt[0]),Kt[1]]}):[],iy(function(Kt){for(var Ir=-1;++Ir<pt;){var Kr=at[Ir];if(b1(Kr[0],this,Kt))return b1(Kr[1],this,Kt)}})}function EC(at){return QT(q1(at,g))}function V2(at){return function(){return at}}function kC(at,pt){return at==null||at!==at?pt:at}var IC=W_(),CC=W_(!0);function A1(at){return at}function H2(at){return b_(typeof at=="function"?at:q1(at,g))}function OC(at){return w_(q1(at,g))}function AC(at,pt){return __(at,q1(pt,g))}var PC=iy(function(at,pt){return function(Tt){return q$(Tt,at,pt)}}),RC=iy(function(at,pt){return function(Tt){return q$(at,Tt,pt)}});function G2(at,pt,Tt){var Kt=r1(pt),Ir=Rw(pt,Kt);Tt==null&&!(My(pt)&&(Ir.length||!Kt.length))&&(Tt=pt,pt=at,at=this,Ir=Rw(pt,r1(pt)));var Kr=!(My(Tt)&&"chain"in Tt)||!!Tt.chain,vn=Lv(at);return $1(Ir,function(In){var zo=pt[In];at[In]=zo,vn&&(at.prototype[In]=function(){var c0=this.__chain__;if(Kr||c0){var p0=at(this.__wrapped__),m0=p0.__actions__=I1(this.__actions__);return m0.push({func:zo,args:arguments,thisArg:at}),p0.__chain__=c0,p0}return zo.apply(at,N1([this.value()],arguments))})}),at}function DC(){return Wy._===this&&(Wy._=sT),this}function Z2(){}function MC(at){return at=X0(at),iy(function(pt){return x_(pt,at)})}var NC=T2(Ty),zC=T2(fw),jC=T2(c$);function Ux(at){return A2(at)?p$(Ev(at)):mS(at)}function BC(at){return function(pt){return at==null?a:i$(at,pt)}}var LC=H_(),UC=H_(!0);function q2(){return[]}function K2(){return!1}function FC(){return{}}function WC(){return""}function VC(){return!0}function HC(at,pt){if(at=X0(at),at<1||at>Sn)return[];var Tt=xn,Kt=h1(at,xn);pt=F0(pt),at-=xn;for(var Ir=m$(Kt,pt);++Tt<at;)pt(Tt);return Ir}function GC(at){return Y0(at)?Ty(at,Ev):j1(at)?[at]:I1(sx(wy(at)))}function ZC(at){var pt=++aT;return wy(at)+pt}var qC=Bw(function(at,pt){return at+pt},0),KC=S2("ceil"),YC=Bw(function(at,pt){return at/pt},1),XC=S2("floor");function QC(at){return at&&at.length?Pw(at,A1,d2):a}function JC(at,pt){return at&&at.length?Pw(at,F0(pt,2),d2):a}function eO(at){return B$(at,A1)}function tO(at,pt){return B$(at,F0(pt,2))}function rO(at){return at&&at.length?Pw(at,A1,h2):a}function nO(at,pt){return at&&at.length?Pw(at,F0(pt,2),h2):a}var iO=Bw(function(at,pt){return at*pt},1),aO=S2("round"),oO=Bw(function(at,pt){return at-pt},0);function sO(at){return at&&at.length?Vv(at,A1):0}function uO(at,pt){return at&&at.length?Vv(at,F0(pt,2)):0}return Zr.after=A3,Zr.ary=vx,Zr.assign=yI,Zr.assignIn=Px,Zr.assignInWith=Qw,Zr.assignWith=vI,Zr.at=bI,Zr.before=bx,Zr.bind=z2,Zr.bindAll=TC,Zr.bindKey=$x,Zr.castArray=W3,Zr.chain=mx,Zr.chunk=QS,Zr.compact=JS,Zr.concat=eE,Zr.cond=SC,Zr.conforms=EC,Zr.constant=V2,Zr.countBy=u3,Zr.create=$I,Zr.curry=wx,Zr.curryRight=_x,Zr.debounce=xx,Zr.defaults=wI,Zr.defaultsDeep=_I,Zr.defer=P3,Zr.delay=R3,Zr.difference=tE,Zr.differenceBy=rE,Zr.differenceWith=nE,Zr.drop=iE,Zr.dropRight=aE,Zr.dropRightWhile=oE,Zr.dropWhile=sE,Zr.fill=uE,Zr.filter=d3,Zr.flatMap=f3,Zr.flatMapDeep=h3,Zr.flatMapDepth=m3,Zr.flatten=cx,Zr.flattenDeep=lE,Zr.flattenDepth=dE,Zr.flip=D3,Zr.flow=IC,Zr.flowRight=CC,Zr.fromPairs=cE,Zr.functions=CI,Zr.functionsIn=OI,Zr.groupBy=g3,Zr.initial=fE,Zr.intersection=hE,Zr.intersectionBy=mE,Zr.intersectionWith=gE,Zr.invert=PI,Zr.invertBy=RI,Zr.invokeMap=v3,Zr.iteratee=H2,Zr.keyBy=b3,Zr.keys=r1,Zr.keysIn=O1,Zr.map=Gw,Zr.mapKeys=MI,Zr.mapValues=NI,Zr.matches=OC,Zr.matchesProperty=AC,Zr.memoize=qw,Zr.merge=zI,Zr.mergeWith=Rx,Zr.method=PC,Zr.methodOf=RC,Zr.mixin=G2,Zr.negate=Kw,Zr.nthArg=MC,Zr.omit=jI,Zr.omitBy=BI,Zr.once=M3,Zr.orderBy=$3,Zr.over=NC,Zr.overArgs=N3,Zr.overEvery=zC,Zr.overSome=jC,Zr.partial=j2,Zr.partialRight=Tx,Zr.partition=w3,Zr.pick=LI,Zr.pickBy=Dx,Zr.property=Ux,Zr.propertyOf=BC,Zr.pull=$E,Zr.pullAll=fx,Zr.pullAllBy=wE,Zr.pullAllWith=_E,Zr.pullAt=xE,Zr.range=LC,Zr.rangeRight=UC,Zr.rearg=z3,Zr.reject=T3,Zr.remove=TE,Zr.rest=j3,Zr.reverse=M2,Zr.sampleSize=E3,Zr.set=FI,Zr.setWith=WI,Zr.shuffle=k3,Zr.slice=SE,Zr.sortBy=O3,Zr.sortedUniq=PE,Zr.sortedUniqBy=RE,Zr.split=pC,Zr.spread=B3,Zr.tail=DE,Zr.take=ME,Zr.takeRight=NE,Zr.takeRightWhile=zE,Zr.takeWhile=jE,Zr.tap=JE,Zr.throttle=L3,Zr.thru=Hw,Zr.toArray=Cx,Zr.toPairs=Mx,Zr.toPairsIn=Nx,Zr.toPath=GC,Zr.toPlainObject=Ax,Zr.transform=VI,Zr.unary=U3,Zr.union=BE,Zr.unionBy=LE,Zr.unionWith=UE,Zr.uniq=FE,Zr.uniqBy=WE,Zr.uniqWith=VE,Zr.unset=HI,Zr.unzip=N2,Zr.unzipWith=hx,Zr.update=GI,Zr.updateWith=ZI,Zr.values=S$,Zr.valuesIn=qI,Zr.without=HE,Zr.words=Bx,Zr.wrap=F3,Zr.xor=GE,Zr.xorBy=ZE,Zr.xorWith=qE,Zr.zip=KE,Zr.zipObject=YE,Zr.zipObjectDeep=XE,Zr.zipWith=QE,Zr.entries=Mx,Zr.entriesIn=Nx,Zr.extend=Px,Zr.extendWith=Qw,G2(Zr,Zr),Zr.add=qC,Zr.attempt=Lx,Zr.camelCase=QI,Zr.capitalize=zx,Zr.ceil=KC,Zr.clamp=KI,Zr.clone=V3,Zr.cloneDeep=G3,Zr.cloneDeepWith=Z3,Zr.cloneWith=H3,Zr.conformsTo=q3,Zr.deburr=jx,Zr.defaultTo=kC,Zr.divide=YC,Zr.endsWith=JI,Zr.eq=cv,Zr.escape=eC,Zr.escapeRegExp=tC,Zr.every=l3,Zr.find=c3,Zr.findIndex=lx,Zr.findKey=xI,Zr.findLast=p3,Zr.findLastIndex=dx,Zr.findLastKey=TI,Zr.floor=XC,Zr.forEach=gx,Zr.forEachRight=yx,Zr.forIn=SI,Zr.forInRight=EI,Zr.forOwn=kI,Zr.forOwnRight=II,Zr.get=U2,Zr.gt=K3,Zr.gte=Y3,Zr.has=AI,Zr.hasIn=F2,Zr.head=px,Zr.identity=A1,Zr.includes=y3,Zr.indexOf=pE,Zr.inRange=YI,Zr.invoke=DI,Zr.isArguments=s$,Zr.isArray=Y0,Zr.isArrayBuffer=X3,Zr.isArrayLike=C1,Zr.isArrayLikeObject=Vy,Zr.isBoolean=Q3,Zr.isBuffer=Xv,Zr.isDate=J3,Zr.isElement=_k,Zr.isEmpty=eI,Zr.isEqual=tI,Zr.isEqualWith=rI,Zr.isError=B2,Zr.isFinite=nI,Zr.isFunction=Lv,Zr.isInteger=Sx,Zr.isLength=Yw,Zr.isMap=Ex,Zr.isMatch=iI,Zr.isMatchWith=aI,Zr.isNaN=oI,Zr.isNative=sI,Zr.isNil=lI,Zr.isNull=uI,Zr.isNumber=kx,Zr.isObject=My,Zr.isObjectLike=By,Zr.isPlainObject=ew,Zr.isRegExp=L2,Zr.isSafeInteger=dI,Zr.isSet=Ix,Zr.isString=Xw,Zr.isSymbol=j1,Zr.isTypedArray=T$,Zr.isUndefined=cI,Zr.isWeakMap=pI,Zr.isWeakSet=fI,Zr.join=yE,Zr.kebabCase=rC,Zr.last=Y1,Zr.lastIndexOf=vE,Zr.lowerCase=nC,Zr.lowerFirst=iC,Zr.lt=hI,Zr.lte=mI,Zr.max=QC,Zr.maxBy=JC,Zr.mean=eO,Zr.meanBy=tO,Zr.min=rO,Zr.minBy=nO,Zr.stubArray=q2,Zr.stubFalse=K2,Zr.stubObject=FC,Zr.stubString=WC,Zr.stubTrue=VC,Zr.multiply=iO,Zr.nth=bE,Zr.noConflict=DC,Zr.noop=Z2,Zr.now=Zw,Zr.pad=aC,Zr.padEnd=oC,Zr.padStart=sC,Zr.parseInt=uC,Zr.random=XI,Zr.reduce=_3,Zr.reduceRight=x3,Zr.repeat=lC,Zr.replace=dC,Zr.result=UI,Zr.round=aO,Zr.runInContext=ko,Zr.sample=S3,Zr.size=I3,Zr.snakeCase=cC,Zr.some=C3,Zr.sortedIndex=EE,Zr.sortedIndexBy=kE,Zr.sortedIndexOf=IE,Zr.sortedLastIndex=CE,Zr.sortedLastIndexBy=OE,Zr.sortedLastIndexOf=AE,Zr.startCase=fC,Zr.startsWith=hC,Zr.subtract=oO,Zr.sum=sO,Zr.sumBy=uO,Zr.template=mC,Zr.times=HC,Zr.toFinite=Uv,Zr.toInteger=X0,Zr.toLength=Ox,Zr.toLower=gC,Zr.toNumber=X1,Zr.toSafeInteger=gI,Zr.toString=wy,Zr.toUpper=yC,Zr.trim=vC,Zr.trimEnd=bC,Zr.trimStart=$C,Zr.truncate=wC,Zr.unescape=_C,Zr.uniqueId=ZC,Zr.upperCase=xC,Zr.upperFirst=W2,Zr.each=gx,Zr.eachRight=yx,Zr.first=px,G2(Zr,function(){var at={};return Tv(Zr,function(pt,Tt){Sy.call(Zr.prototype,Tt)||(at[Tt]=pt)}),at}(),{chain:!1}),Zr.VERSION=o,$1(["bind","bindKey","curry","curryRight","partial","partialRight"],function(at){Zr[at].placeholder=Zr}),$1(["drop","take"],function(at,pt){ly.prototype[at]=function(Tt){Tt=Tt===a?1:Qy(X0(Tt),0);var Kt=this.__filtered__&&!pt?new ly(this):this.clone();return Kt.__filtered__?Kt.__takeCount__=h1(Tt,Kt.__takeCount__):Kt.__views__.push({size:h1(Tt,xn),type:at+(Kt.__dir__<0?"Right":"")}),Kt},ly.prototype[at+"Right"]=function(Tt){return this.reverse()[at](Tt).reverse()}}),$1(["filter","map","takeWhile"],function(at,pt){var Tt=pt+1,Kt=Tt==D0||Tt==Mo;ly.prototype[at]=function(Ir){var Kr=this.clone();return Kr.__iteratees__.push({iteratee:F0(Ir,3),type:Tt}),Kr.__filtered__=Kr.__filtered__||Kt,Kr}}),$1(["head","last"],function(at,pt){var Tt="take"+(pt?"Right":"");ly.prototype[at]=function(){return this[Tt](1).value()[0]}}),$1(["initial","tail"],function(at,pt){var Tt="drop"+(pt?"":"Right");ly.prototype[at]=function(){return this.__filtered__?new ly(this):this[Tt](1)}}),ly.prototype.compact=function(){return this.filter(A1)},ly.prototype.find=function(at){return this.filter(at).head()},ly.prototype.findLast=function(at){return this.reverse().find(at)},ly.prototype.invokeMap=iy(function(at,pt){return typeof at=="function"?new ly(this):this.map(function(Tt){return q$(Tt,at,pt)})}),ly.prototype.reject=function(at){return this.filter(Kw(F0(at)))},ly.prototype.slice=function(at,pt){at=X0(at);var Tt=this;return Tt.__filtered__&&(at>0||pt<0)?new ly(Tt):(at<0?Tt=Tt.takeRight(-at):at&&(Tt=Tt.drop(at)),pt!==a&&(pt=X0(pt),Tt=pt<0?Tt.dropRight(-pt):Tt.take(pt-at)),Tt)},ly.prototype.takeRightWhile=function(at){return this.reverse().takeWhile(at).reverse()},ly.prototype.toArray=function(){return this.take(xn)},Tv(ly.prototype,function(at,pt){var Tt=/^(?:filter|find|map|reject)|While$/.test(pt),Kt=/^(?:head|last)$/.test(pt),Ir=Zr[Kt?"take"+(pt=="last"?"Right":""):pt],Kr=Kt||/^find/.test(pt);Ir&&(Zr.prototype[pt]=function(){var vn=this.__wrapped__,In=Kt?[1]:arguments,zo=vn instanceof ly,c0=In[0],p0=zo||Y0(vn),m0=function(sy){var cy=Ir.apply(Zr,N1([sy],In));return Kt&&_0?cy[0]:cy};p0&&Tt&&typeof c0=="function"&&c0.length!=1&&(zo=p0=!1);var _0=this.__chain__,A0=!!this.__actions__.length,W0=Kr&&!_0,Q0=zo&&!A0;if(!Kr&&p0){vn=Q0?vn:new ly(this);var V0=at.apply(vn,In);return V0.__actions__.push({func:Hw,args:[m0],thisArg:a}),new Z1(V0,_0)}return W0&&Q0?at.apply(this,In):(V0=this.thru(m0),W0?Kt?V0.value()[0]:V0.value():V0)})}),$1(["pop","push","shift","sort","splice","unshift"],function(at){var pt=yw[at],Tt=/^(?:push|sort|unshift)$/.test(at)?"tap":"thru",Kt=/^(?:pop|shift)$/.test(at);Zr.prototype[at]=function(){var Ir=arguments;if(Kt&&!this.__chain__){var Kr=this.value();return pt.apply(Y0(Kr)?Kr:[],Ir)}return this[Tt](function(vn){return pt.apply(Y0(vn)?vn:[],Ir)})}}),Tv(ly.prototype,function(at,pt){var Tt=Zr[pt];if(Tt){var Kt=Tt.name+"";Sy.call(b$,Kt)||(b$[Kt]=[]),b$[Kt].push({name:pt,func:Tt})}}),b$[jw(a,qt).name]=[{name:"wrapper",func:a}],ly.prototype.clone=xT,ly.prototype.reverse=TT,ly.prototype.value=ST,Zr.prototype.at=e3,Zr.prototype.chain=t3,Zr.prototype.commit=r3,Zr.prototype.next=n3,Zr.prototype.plant=a3,Zr.prototype.reverse=o3,Zr.prototype.toJSON=Zr.prototype.valueOf=Zr.prototype.value=s3,Zr.prototype.first=Zr.prototype.head,U$&&(Zr.prototype[U$]=i3),Zr},Hv=rT();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(Wy._=Hv,define(function(){return Hv})):$v?(($v.exports=Hv)._=Hv,Jv._=Hv):Wy._=Hv}).call(e)}}),import_lodash=__toESM(require_lodash());async function imageDecode(e){const i=MimeType.fromString(e.type);switch(i.type){case"image/x-alpha8":{const a=parseInt(i.params.width),o=parseInt(i.params.height);return ndarray4(new Uint8Array(await e.arrayBuffer()),[o,a,1])}case"image/x-rgba8":{const a=parseInt(i.params.width),o=parseInt(i.params.height);return ndarray4(new Uint8Array(await e.arrayBuffer()),[o,a,4])}case"application/octet-stream":case"image/png":case"image/jpeg":case"image/jpg":case"image/webp":{const a=await createImageBitmap(e),o=imageBitmapToImageData(a);return ndarray4(new Uint8Array(o.data),[o.height,o.width,4])}default:throw new Error(`Invalid format: ${i.type} with params: ${i.params}`)}}async function imageEncode(e,i=.8,a="image/png"){const[o,c,s]=e.shape;switch(a){case"image/x-alpha8":case"image/x-rgba8":{const et=MimeType.create(a,{width:c.toString(),height:o.toString()});return new Blob([e.data],{type:et.toString()})}case"image/png":case"image/jpeg":case"image/webp":{const et=new ImageData(new Uint8ClampedArray(e.data),c,o);var d=createCanvas(et.width,et.height),$=d.getContext("2d");return $.putImageData(et,0,0),d.convertToBlob({quality:i,type:a})}default:throw new Error(`Invalid format: ${a}`)}}var MimeType=class Q2{constructor(i,a){this.type="application/octet-stream",this.params={},this.type=i,this.params=a}toString(){const i=[];for(const a in this.params){const o=this.params[a];i.push(`${a}=${o}`)}return[this.type,...i].join(";")}static create(i,a){return new Q2(i,a)}isIdentical(i){return this.type===i.type&&this.params===i.params}isEqual(i){return this.type===i.type}static fromString(i){const[a,...o]=i.split(";"),c={};for(const s of o){const[d,$]=s.split("=");c[d.trim()]=$.trim()}return new Q2(a,c)}};function isAbsoluteURI(e){return new RegExp("^(?:[a-z+]+:)?//","i").test(e)}function ensureAbsoluteURI(e,i){return isAbsoluteURI(e)?e:new URL(e,i).href}function imageBitmapToImageData(e){var i=createCanvas(e.width,e.height),a=i.getContext("2d");return a.drawImage(e,0,0),a.getImageData(0,0,i.width,i.height)}function createTypeArray(e){if(typeof Uint8Array<"u")return new Uint8Array(e);if(typeof Uint8ClampedArray<"u")return new Uint8ClampedArray(e);if(typeof Uint16Array<"u")return new Uint16Array(e);if(typeof Uint32Array<"u")return new Uint32Array(e);if(typeof Float32Array<"u")return new Float32Array(e);if(typeof Float64Array<"u")return new Float64Array(e);throw new Error("TypedArray not supported")}function tensorResizeBilinear(e,i,a,o=!1){const[c,s,d]=e.shape;let $=s/i,et=c/a;o&&($=et=Math.max($,et)>1?Math.max($,et):Math.min($,et));const h=ndarray4(createTypeArray(d*i*a),[a,i,d]);for(let b=0;b<a;b++)for(let g=0;g<i;g++){const st=g*$,$t=b*et,vt=Math.max(Math.floor(st),0),Ft=Math.min(Math.ceil(st),s-1),Gt=Math.max(Math.floor($t),0),qt=Math.min(Math.ceil($t),c-1),Lt=st-vt,rr=$t-Gt;for(let jr=0;jr<d;jr++){const Hr=e.get(Gt,vt,jr),wn=e.get(Gt,Ft,jr),_n=e.get(qt,vt,jr),No=e.get(qt,Ft,jr),Qo=(1-Lt)*(1-rr)*Hr+Lt*(1-rr)*wn+(1-Lt)*rr*_n+Lt*rr*No;h.set(b,g,jr,Qo)}}return h}function tensorHWCtoBCHW(e,i=[128,128,128],a=[256,256,256]){var o=e.data;const[c,s,d]=e.shape,$=c*s,et=new Float32Array(3*$);for(let h=0,b=0;h<o.length;h+=4,b+=1)et[b]=(o[h]-i[0])/a[0],et[b+$]=(o[h+1]-i[1])/a[1],et[b+$+$]=(o[h+2]-i[2])/a[2];return ndarray4(et,[1,3,c,s])}async function imageSourceToImageData(e,i){return typeof e=="string"&&(e=ensureAbsoluteURI(e,i.publicPath),e=new URL(e)),e instanceof URL&&(e=await(await fetch(e,{})).blob()),(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e=new Blob([e])),e instanceof Blob&&(e=await imageDecode(e)),e}function convertFloat32ToUint8(e){const i=new Uint8Array(e.data.length);for(let a=0;a<e.data.length;a++)i[a]=e.data[a]*255;return ndarray4(i,e.shape)}function createCanvas(e,i){let a;if(typeof OffscreenCanvas<"u"?a=new OffscreenCanvas(e,i):a=document.createElement("canvas"),!a)throw new Error("Canvas nor OffscreenCanvas are available in the current context.");return a}async function loadAsUrl(e,i){return URL.createObjectURL(await loadAsBlob(e,i))}async function loadAsBlob(e,i){const a=new URL("resources.json",i.publicPath),o=await fetch(a);if(!o.ok)throw new Error("Resource metadata not found. Ensure that the config.publicPath is configured correctly.");const s=(await o.json())[e];if(!s)throw new Error(`Resource ${e} not found. Ensure that the config.publicPath is configured correctly.`);const d=s.chunks;let $=0;const et=d.map(async g=>{const st=g.offsets[1]-g.offsets[0],$t=i.publicPath?new URL(g.hash,i.publicPath).toString():g.hash,Ft=await(await fetch($t,i.fetchArgs)).blob();if(st!==Ft.size)throw new Error(`Failed to fetch ${e} with size ${st} but got ${Ft.size}`);return i.progress&&($+=st,i.progress(`fetch:${e}`,$,s.size)),Ft}),h=await Promise.all(et),b=new Blob(h,{type:s.mime});if(b.size!==s.size)throw new Error(`Failed to fetch ${e} with size ${s.size} but got ${b.size}`);return b}var simd=()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),threads=()=>(async e=>{try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch{return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])),webgpu=()=>navigator.gpu!==void 0,maxNumThreads=()=>navigator.hardwareConcurrency??4;async function createOnnxSession(e,i){const a=i.device==="gpu",o=await threads(),c=simd(),s=i.proxyToWorker,d=[a?"webgpu":"wasm"],$=a?ort_gpu:ort_cpu;i.debug&&(console.debug("	Using Threads:",o),console.debug("	Using SIMD:",c),console.debug("	Using WebGPU:",a),console.debug("	Proxy to Worker:",s),$.env.debug=!0,$.env.logLevel="verbose"),$.env.wasm.numThreads=maxNumThreads(),$.env.wasm.simd=simd(),$.env.wasm.proxy=s;const et={"ort-wasm-simd-threaded.wasm":o&&c,"ort-wasm-simd.wasm":!o&&c,"ort-wasm-threaded.wasm":!a&&o&&!c,"ort-wasm.wasm":!a&&!o&&!c},h={};for(const[st,$t]of Object.entries(et))if($t){const vt=a&&st.includes("simd")?`/onnxruntime-web/${st.replace(".wasm",".jsep.wasm")}`:`/onnxruntime-web/${st}`;h[st]=await loadAsUrl(vt,i)}$.env.wasm.wasmPaths=h,i.debug&&console.debug("ort.env.wasm:",$.env.wasm);const b={executionProviders:d,graphOptimizationLevel:"all",executionMode:"parallel",enableCpuMemArena:!0};return await $.InferenceSession.create(e,b).catch(st=>{throw new Error(`Failed to create session: "${st}". Please check if the publicPath is set correctly.`)})}async function runOnnxSession(e,i,a,o){const s=o.device==="gpu"?ort_gpu:ort_cpu,d={};for(const[h,b]of i)d[h]=new s.Tensor("float32",new Float32Array(b.data),b.shape);const $=await e.run(d,{}),et=[];for(const h of a){const b=$[h],g=b.dims,st=b.data,$t=ndarray4(st,g);et.push($t)}return et}var package_default={name:"@imgly/background-removal",version:"1.5.3",description:"Background Removal in the Browser",keywords:["background-removal","client-side","data-privacy","image-segmentation","image-matting","onnx"],repository:{type:"git",url:"git+https://github.com/imgly/background-removal-js.git"},license:"SEE LICENSE IN LICENSE.md",author:{name:"IMG.LY GmbH",email:"support@img.ly",url:"https://img.ly"},bugs:{email:"support@img.ly"},source:"./src/index.ts",main:"./dist/index.cjs",module:"./dist/index.mjs",types:"./dist/src/index.d.ts",exports:{".":{require:"./dist/index.cjs",import:"./dist/index.mjs",types:"./dist/src/index.d.ts"}},homepage:"https://img.ly/showcases/cesdk/web/background-removal",files:["LICENSE.md","README.md","CHANGELOG.md","ThirdPartyLicenses.json","dist/","bin/"],scripts:{start:"npm run watch",clean:"npx rimraf dist",test:"true",resources:"node ../../scripts/package-resources.mjs","changelog:create":"node ../../scripts/changelog/changelog-create.mjs","changelog:generate":"node ../../scripts/changelog/changelog-generate.mjs",build:"npm run clean && npm run types && npm run resources && npm run changelog:generate && node scripts/build.mjs",types:" npx tsc --declaration --emitDeclarationOnly --declarationDir dist --declarationMap",watch:"npm run clean && npm run resources && npm run changelog:generate && node scripts/watch.mjs","publish:latest":"npm publish --tag latest --access public","publish:next":"npm publish --tag next --access public","package:pack":"npm pack . --pack-destination ../../releases",lint:"npx prettier --write ."},dependencies:{"@types/lodash-es":"^4.17.12","@types/ndarray":"~1.0.14","@types/node":"~20.3.0","lodash-es":"^4.17.21",ndarray:"~1.0.0","onnxruntime-web":"~1.18.0",zod:"^3.23.8"},devDependencies:{assert:"~2.0.0",esbuild:"~0.18.0",glob:"~10.3.0","npm-dts":"~1.3.0",process:"~0.11.0","ts-loader":"~9.4.0",tslib:"~2.5.0",typescript:"~5.1.0",util:"~0.12.0",webpack:"~5.85.0","webpack-cli":"~5.1.0"},bundleDependencies:[]},ConfigSchema=z.object({publicPath:z.string().optional().describe("The public path to the wasm files and the onnx model.").default("https://staticimgly.com/@imgly/background-removal-data/${PACKAGE_VERSION}/dist/").transform(e=>e.replace("${PACKAGE_NAME}",package_default.name).replace("${PACKAGE_VERSION}",package_default.version)),debug:z.boolean().default(!1).describe("Whether to enable debug logging."),rescale:z.boolean().default(!0).describe("Whether to rescale the image."),device:z.enum(["cpu","gpu"]).default("cpu").describe("The device to run the model on."),proxyToWorker:z.boolean().default(!0).describe("Whether to proxy inference to a web worker."),fetchArgs:z.any().default({}).describe("Arguments to pass to fetch when loading the model."),progress:z.function().args(z.string(),z.number(),z.number()).returns(z.void()).describe("Progress callback.").optional(),model:z.preprocess(e=>{switch(e){case"large":return"isnet";case"small":return"isnet_quint8";case"medium":return"isnet_fp16";default:return e}},z.enum(["isnet","isnet_fp16","isnet_quint8"])).default("medium"),output:z.object({format:z.enum(["image/png","image/jpeg","image/webp","image/x-rgba8","image/x-alpha8"]).default("image/png"),quality:z.number().default(.8)}).default({})}).default({}).transform(e=>(e.debug&&console.log("Config:",e),e.debug&&!e.progress&&(e.progress=e.progress??((i,a,o)=>{console.debug(`Downloading ${i}: ${a} of ${o}`)}),crossOriginIsolated||e.debug&&console.debug("Cross-Origin-Isolated is not enabled. Performance will be degraded. Please see  https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer.")),e.device=="gpu"&&(webgpu()||(e.debug&&console.debug("Switching to CPU for GPU not supported."),e.device="cpu")),e));function validateConfig(e){return ConfigSchema.parse(e??{})}async function initBase(e){e.debug&&console.debug("Loading model...",e.model);const i=e.model,o=await(await loadAsBlob(`/models/${i}`,e)).arrayBuffer();return await createOnnxSession(o,e)}async function initInference(e){e=validateConfig(e);const i=await initBase(e);return{config:e,session:{base:i}}}async function runInference(e,i,a){const[c,s,d]=e.shape,$=!1;let et=tensorResizeBilinear(e,1024,1024,$);const h=tensorHWCtoBCHW(et);let b=await runOnnxSession(a.base,[["input",h]],["output"],i),g=ndarray4(b[0].data,[1024,1024,1]),st=convertFloat32ToUint8(g);return i.rescale?(st=tensorResizeBilinear(st,s,c,$),[st,e]):[st,et]}var init=(0,import_lodash.memoize)(initInference,e=>JSON.stringify(e));async function removeBackground(e,i){var st,$t,vt,Ft;const{config:a,session:o}=await init(i);a.progress&&a.progress("compute:decode",0,4);const c=await imageSourceToImageData(e,a);(st=a.progress)==null||st.call(a,"compute:inference",1,4);const[s,d]=await runInference(c,a,o);($t=a.progress)==null||$t.call(a,"compute:mask",2,4);const $=d,[et,h]=$.shape,b=et*h;for(let Gt=0;Gt<b;Gt+=1)$.data[4*Gt+3]=s.data[Gt];(vt=a.progress)==null||vt.call(a,"compute:encode",3,4);const g=await imageEncode($,a.output.quality,a.output.format);return(Ft=a.progress)==null||Ft.call(a,"compute:encode",4,4),g}/*! Bundled license information:

lodash/lodash.js:
  (**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/const useRemoveBackground=()=>{const e=useIsMobile(),[i,a]=reactExports.useState(!1),[o,c]=reactExports.useState(null),[s,d]=reactExports.useState(null),$="isnet";return{removeBackground:async({file:h,output:b="no-bg",download:g=!1})=>{try{d("Started."),a(!0);const st=await removeBackground(h,{model:$,device:e?"cpu":"gpu",progress:(Ft,Gt,qt)=>{d(`Downloading ${Ft}: ${Gt} of ${qt}`)}}),$t=URL.createObjectURL(st);a(!1),d("Finished.");const vt=`${b}-${randomUUID()}.png`;if(g){const Ft=document.createElement("a");Ft.href=$t,Ft.download=vt,document.body.appendChild(Ft),Ft.click(),document.body.removeChild(Ft),URL.revokeObjectURL(Ft.href)}return{name:vt,url:$t}}catch(st){c(st),a(!1)}},progress:s,isLoading:i,error:o}},ImageViewer=({src:e,alt:i,download:a})=>{const[o,c]=reactExports.useState(!1);return jsxRuntimeExports.jsxs("div",{className:"avatar",children:[jsxRuntimeExports.jsx("div",{className:"w-24 rounded-xl",onClick:()=>c(!0),children:jsxRuntimeExports.jsx("img",{src:e,alt:i})}),jsxRuntimeExports.jsx(Modal,{title:"Image",visible:o,onClose:()=>c(!1),children:jsxRuntimeExports.jsxs("div",{className:"flex justify-center card bg-base-100 w-96 shadow-xl",children:[jsxRuntimeExports.jsx("figure",{children:jsxRuntimeExports.jsx("img",{src:e,alt:i})}),jsxRuntimeExports.jsx("a",{href:e,className:"btn btn-dark",download:a,children:"Download"})]})})]})},ActionRow=({file:e,index:i,result:a})=>jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{scope:"row",children:i+1}),jsxRuntimeExports.jsx("td",{children:e.name}),jsxRuntimeExports.jsxs("td",{children:[a&&jsxRuntimeExports.jsx("a",{href:a.url,className:"btn btn-dark",download:a.download,children:"Download"}),!a&&jsxRuntimeExports.jsx(Loading,{})]}),jsxRuntimeExports.jsxs("td",{children:[a&&jsxRuntimeExports.jsx(ImageViewer,{download:a.download,src:a.url,alt:e.name}),!a&&jsxRuntimeExports.jsx(Loading,{})]})]},e.name),RemoveBackground=()=>{const{removeBackground:e,isLoading:i,progress:a}=useRemoveBackground(),[o,c]=reactExports.useState(null),[s,d]=reactExports.useState(null),[$,et]=reactExports.useState([]),h=async g=>{if(g){c(g);for(const st of g){const $t=await e({file:st});if(!$t)return;et(vt=>[...vt,{fileName:st.name,download:$t.name,url:$t.url}])}}},b=async g=>{var $t;const st=($t=g.clipboardData)==null?void 0:$t.items;if(st){for(const vt of st)if(vt.kind==="file"){const Ft=vt.getAsFile();if(Ft){const Gt=await e({file:Ft});if(!Gt)return;d({fileName:Ft.name,download:Gt.name,url:Gt.url})}}}};return jsxRuntimeExports.jsxs(Page,{className:"table",onPaste:b,name:"Remove Background",description:"Select a file or paste it",children:[a&&jsxRuntimeExports.jsx("div",{className:"mt-2",children:jsxRuntimeExports.jsx("span",{children:a})}),i&&jsxRuntimeExports.jsx(Loading,{}),jsxRuntimeExports.jsx(FilePicker,{onFileChange:h}),jsxRuntimeExports.jsx("div",{className:"container",style:{display:"flex",marginTop:"1rem"},children:jsxRuntimeExports.jsxs("table",{className:"table table-light",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{scope:"col",children:"#"}),jsxRuntimeExports.jsx("th",{scope:"col",children:"File Name"}),jsxRuntimeExports.jsx("th",{scope:"col",children:"Actions"}),jsxRuntimeExports.jsx("th",{scope:"col",children:"Preview"})]})}),jsxRuntimeExports.jsxs("tbody",{children:[s&&jsxRuntimeExports.jsx(ActionRow,{index:1,file:new File([],s.fileName),result:s}),o&&Array.from(o).map((g,st)=>{const $t=$.find(vt=>vt.fileName===g.name);return jsxRuntimeExports.jsx(ActionRow,{file:g,index:st,result:$t},g.name)})]})]})})]})},MIN_DISTANCE=25,addImageToCanvas=(e,i,a,o)=>{const c=new Image;c.src=`images/${o}.png`,e.drawImage(c,i,a,30,30)},drawRock=(e,i,a)=>{e.fillStyle="red",addImageToCanvas(e,i,a,"rock")},drawScissors=(e,i,a)=>{e.save(),e.translate(i+15,a+15),e.rotate(Math.PI),e.translate(-15,-15),addImageToCanvas(e,-15,-15,"scissors"),e.restore()},drawPaper=(e,i,a)=>{e.fillStyle="green",addImageToCanvas(e,i,a,"paper")},itsA=(e,{type:i})=>i===e,countFor=(e,i)=>i.filter(a=>itsA(e,a)).length,calculateWinner=e=>{const i=countFor("rock",e),a=countFor("paper",e),o=countFor("scissors",e);return i>a&&i>o?"Rock":a>i&&a>o?"Paper":o>i&&o>a?"Scissors":"Tie"},CanvasGame=()=>{const e=useIsMobile(),i=reactExports.useRef(null),a=reactExports.useRef(null),o=reactExports.useRef([]),[c,s]=reactExports.useState(10),[d,$]=reactExports.useState(10),[et,h]=reactExports.useState(d),[b,g]=reactExports.useState(c),[st,$t]=reactExports.useState(c),[vt,Ft]=reactExports.useState(c),[Gt,qt]=reactExports.useState(null),[Lt,rr]=reactExports.useState(!1),jr=wn=>{const _n=a.current;if(!_n)return[];const No=_n.width,Qo=_n.height,Xo=[];for(let l0=0;l0<c;l0++){const v0={x:Math.random()*No,y:Math.random()*Qo,dx:Math.random()*4-2,dy:Math.random()*4-2,type:wn};wn==="rock"?(v0.x=No*.1,v0.y=Qo*.1):wn==="paper"?(v0.x=No*.9,v0.y=Qo*.1):wn==="scissors"&&(v0.x=No*.9,v0.y=Qo*.9),Xo.push(v0)}return Xo},Hr=()=>{o.current=[...jr("rock"),...jr("paper"),...jr("scissors")],g(c),$t(c),Ft(c),h(d),qt(null),rr(!0)};return reactExports.useEffect(()=>{const wn=a.current;if(!wn)return;const _n=wn.getContext("2d");if(!_n)return;const No=wn.width,Qo=wn.height;if(!Lt)return;const Xo=()=>{_n.clearRect(0,0,No,Qo);const M0=o.current.map(t0=>(t0.x+=t0.dx,t0.y+=t0.dy,(t0.x+10>No||t0.x-10<0)&&(t0.dx*=-1),(t0.y+10>Qo||t0.y-10<0)&&(t0.dy*=-1),t0)).filter(t0=>{let d0=!0;return o.current.forEach(xn=>{var f0;if(t0!==xn){const $0=Math.abs(t0.x-xn.x),N0=Math.abs(t0.y-xn.y);$0<MIN_DISTANCE&&N0<MIN_DISTANCE&&(itsA("rock",t0)&&itsA("paper",xn)||itsA("scissors",t0)&&itsA("rock",xn)||itsA("paper",t0)&&itsA("scissors",xn))&&(d0=!1,(f0=i.current)==null||f0.play())}}),d0}),Mo=countFor("rock",M0),e0=countFor("paper",M0),Sn=countFor("scissors",M0);g(Mo),$t(e0),Ft(Sn),Mo===0&&e0===0?qt("Scissors"):Mo===0&&Sn===0?qt("Paper"):e0===0&&Sn===0&&qt("Rock"),o.current=M0,M0.forEach(t0=>{t0.type==="paper"?drawPaper(_n,t0.x,t0.y):t0.type==="rock"?drawRock(_n,t0.x,t0.y):drawScissors(_n,t0.x,t0.y)})};let l0,v0=null;const x0=D0=>{v0||(v0=D0);const M0=(D0-v0)/1e3,Mo=d-M0;if(h(Math.max(Mo,0).toFixed(2)),Gt){window.cancelAnimationFrame(l0);return}if(Mo<=0){cancelAnimationFrame(l0),rr(!1),qt(calculateWinner(o.current));return}Xo(),l0=requestAnimationFrame(x0)};return l0=requestAnimationFrame(x0),()=>{window.cancelAnimationFrame(l0)}},[Lt,Gt]),jsxRuntimeExports.jsxs(Page,{name:"Canvas Game (Rock, Paper, Scissors)",children:[jsxRuntimeExports.jsx("audio",{src:"/sounds/impact.mp3",ref:i,style:{display:"none"}}),jsxRuntimeExports.jsx("div",{className:"container mx-auto text-center my-10",children:jsxRuntimeExports.jsxs("ul",{className:"list-none space-y-4",children:[jsxRuntimeExports.jsxs("li",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("label",{className:"inline-block text-sm mr-2",children:"Run For (s)"}),jsxRuntimeExports.jsx("input",{type:"number",disabled:Lt,value:d,onChange:wn=>{const _n=parseInt(wn.target.value);$(_n),h(_n)},className:"grow input input-sm",placeholder:"Daisy"})]}),jsxRuntimeExports.jsxs("li",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("label",{className:"inline-block text-sm mr-2",children:"Number of Elements"}),jsxRuntimeExports.jsx("div",{className:"flex items-center space-x-2",children:jsxRuntimeExports.jsx("input",{disabled:Lt,min:10,step:"0",max:"50",type:"range",value:c,className:"range input-sm",onChange:wn=>{const _n=parseInt(wn.target.value);s(_n),g(_n),$t(_n),Ft(_n)}})})]})]})}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col-reverse md:flex-row md:items-center",children:[jsxRuntimeExports.jsx("div",{className:"justify-self-end w-52 md:w-full",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("table",{className:"table",children:jsxRuntimeExports.jsxs("tbody",{children:[jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{className:"text-right",children:"Rock Count"}),jsxRuntimeExports.jsx("td",{children:b})]}),jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{className:"text-right",children:"Paper Count"}),jsxRuntimeExports.jsx("td",{children:st})]}),jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("td",{className:"text-right",children:"Scissors Count"}),jsxRuntimeExports.jsx("td",{children:vt})]})]})}),Gt&&jsxRuntimeExports.jsxs("div",{children:["Winner: ",Gt]}),jsxRuntimeExports.jsx("button",{className:"btn btn-primary mt-4",onClick:Hr,children:"Reset Game"})]})}),jsxRuntimeExports.jsx("div",{className:"justify-self-start w-full md:w-1/2",children:jsxRuntimeExports.jsx("canvas",{ref:a,width:e?"auto":600,height:e?"auto":400,style:{objectFit:"contain"},className:"mx-auto block border border-black rounded-lg bg-white"})})]}),jsxRuntimeExports.jsx("div",{className:"flex mt-4",children:jsxRuntimeExports.jsxs("h3",{children:["Remaining Time: ",et]})}),jsxRuntimeExports.jsx("div",{className:"text-center p-10",children:jsxRuntimeExports.jsx("a",{className:"underline",target:"blank",href:"https://www.instagram.com/p/C48bvLiIXM0/",children:"Based on this"})})]})},githubBaseUrl="https://github.com/emersondemetrio/emersondemetrio.github.io/blob/main/src",experiments=[{title:"Remove Background",description:"Remove background from images 🖼️",link:"/labs/background",repo:`${githubBaseUrl}/pages/remove-background/remove-background.tsx`},{title:"Canvas Game",description:"Simple game using canvas 🪨✂️📜",link:"/labs/game",repo:`${githubBaseUrl}/pages/canvas-game/canvas-game.tsx`},{title:"Weather App",description:"Weather App 🌦️",link:"/labs/weather",repo:`${githubBaseUrl}/pages/weather-app/weather-app.tsx`},{title:"Code Pens",description:"Code Pens 🖊 ️",link:"/labs/code-pen",repo:`${githubBaseUrl}/pages/code-pen/code-pen.tsx`},{title:"Countdown",description:"Countdown ⏳",link:"/labs/countdown",repo:`${githubBaseUrl}/pages/countdown/countdown.tsx`}],Labs=()=>jsxRuntimeExports.jsx(Page,{name:"Labs",description:"Some experiments I've been working on",children:jsxRuntimeExports.jsx("div",{className:"md:grid md:grid-cols-4 md:gap-4 flex flex-col items-center",children:experiments.map(e=>jsxRuntimeExports.jsx("div",{className:"md:mb-0 mb-10 w-[350px] bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center pt-4 pb-10",children:[jsxRuntimeExports.jsx("h5",{className:"mb-1 text-xl font-medium text-gray-900 dark:text-white",children:e.title}),jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.description}),jsxRuntimeExports.jsxs("div",{className:"flex mt-4 md:mt-6",children:[jsxRuntimeExports.jsx(Link,{to:e.link,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-center text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",children:"View"}),jsxRuntimeExports.jsx(Link,{to:e.repo,className:"py-2 px-4 ms-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-100 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700",children:"Code"})]})]})},e.title))})}),resume$1="",Toggle=({children:e,title:i,onChange:a,style:o={}})=>{const[c,s]=reactExports.useState(!1),d=()=>{s(!c),typeof a=="function"&&a(!c)};return jsxRuntimeExports.jsxs("div",{style:{display:"flex",flex:1,flexDirection:"column",...o},children:[jsxRuntimeExports.jsx("div",{style:{flex:1,display:"flex",justifyContent:"left"},children:jsxRuntimeExports.jsxs("button",{className:"btn btn-primary",onClick:d,children:[i," ",c?"↑":"↓"]})}),jsxRuntimeExports.jsx("div",{style:{},children:c&&e})]})},resume=new Map;reverseRange(2008,2024).map(e=>{resume.set(e,{experiences:[{year:e,title:"Software Engineer",description:`Developed software for the company.
Developed software for the company.
Developed software for the company.
Developed software for the company.`}],education:[{year:e,title:"Computer Science",description:"Learned computer science."}]})});const Bullet=()=>jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"h-5 w-5",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})}),Resume=()=>jsxRuntimeExports.jsx(Page,{name:"About Me (Under construction)",children:jsxRuntimeExports.jsx(Toggle,{title:"Show progress so far",children:jsxRuntimeExports.jsx("ul",{className:"timeline timeline-snap-icon max-md:timeline-compact timeline-vertical",children:Array.from(resume).map(([e,i],a)=>{const o=a%2===0?"timeline-start md:text-end":"timeline-end";return i.experiences.map((c,s)=>jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("div",{className:"timeline-middle",children:jsxRuntimeExports.jsx(Bullet,{})}),jsxRuntimeExports.jsxs("div",{className:`${o} mb-10`,children:[jsxRuntimeExports.jsx("time",{className:"font-mono",children:e}),jsxRuntimeExports.jsx("div",{className:"text-lg font-black",children:c.title}),c.description]}),jsxRuntimeExports.jsx("hr",{})]},s))})})})}),appRoutes=[{label:"Home",link:"/"},{label:"Labs 🧪",link:"/labs"},{label:"About",link:"/about"},{label:"Blog",link:"/blog"}],Navbar=()=>{const e=window.screen.width,i=useIsMobile(),[a,o]=reactExports.useState(!i&&e>1024);return jsxRuntimeExports.jsxs("nav",{id:"header",className:"sticky w-full z-30 top-0 text-white bg-black",children:[jsxRuntimeExports.jsxs("div",{className:"w-full container mx-auto flex flex-wrap items-center justify-between mt-0 py-2",children:[jsxRuntimeExports.jsx("div",{className:"pl-4 flex items-center",children:jsxRuntimeExports.jsx(Link,{className:"text-white no-underline hover:no-underline font-bold text-1xl lg:text-2xl",to:"/",children:"emerson.run"})}),jsxRuntimeExports.jsx("div",{className:"block lg:hidden pr-4",children:jsxRuntimeExports.jsx("button",{type:"button",id:"nav-toggle",onClick:()=>o(!a),className:"flex items-center p-1 text-gray-800 hover:text-gray-900 focus:outline-none focus:shadow-outline transform transition hover:scale-105 duration-300 ease-in-out",children:jsxRuntimeExports.jsxs("svg",{className:"fill-current h-6 w-6",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",style:{background:"#fff"},children:[jsxRuntimeExports.jsx("title",{children:"Menu"}),jsxRuntimeExports.jsx("path",{d:"M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"})]})})}),jsxRuntimeExports.jsx("div",{style:{height:i?"auto":80},className:"w-full flex-grow lg:flex lg:items-center lg:w-auto lg:block mt-2 lg:mt-0 lg:bg-transparent text-black p-4 lg:p-0 z-20"+(a?" block":" hidden"),id:"nav-content",children:jsxRuntimeExports.jsx("ul",{className:"list-reset lg:flex justify-end flex-1 items-center",children:appRoutes.map((c,s)=>jsxRuntimeExports.jsx("li",{className:"mr-3",children:jsxRuntimeExports.jsx(Link,{to:c.link,className:"inline-block text-white no-underline hover:text-white-800 hover:text-underline py-2 px-4",children:c.label})},s))})})]}),jsxRuntimeExports.jsx("hr",{className:"border-b border-gray-100 opacity-25 my-0 py-0"})]})},cacheKey="weather-app-cache",notWordsRegex=/[^a-zA-Z]+/g,cityKey=(e,i)=>`${e.replace(notWordsRegex,"_").toLowerCase()}-${i}`,getFromCache=(e,i)=>JSON.parse(localStorage.getItem(cacheKey)||"{}")[cityKey(e,i)]||null,setCache=(e,i,a)=>{const o=JSON.parse(localStorage.getItem(cacheKey)||"{}");o[cityKey(e,i)]=a,localStorage.setItem(cacheKey,JSON.stringify(o))},getTodayAsDateForHour=e=>{const i=new Date;return i.setHours(e),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),i},dateToTimestamp=e=>{const i=e.getHours();return getTodayAsDateForHour(i).getTime()},API_KEY="44c00948576d44c58db175549221303",BASE_URL="https://api.weatherapi.com/v1/current.json",DEFAULT_PLACE="Florianópolis, Santa Catarina, Brazil",fetchJson=async(e,i)=>{try{return await fetch(e,i).then(a=>a.json())}catch(a){return{error:a}}},getSearchString=e=>`${BASE_URL}?key=${API_KEY}&q=${encodeURIComponent(e||DEFAULT_PLACE)}&aqi=yes`,fetchWeather=async e=>{const i=getSearchString(e);return await fetchJson(i,{method:"GET",headers:{"Content-Type":"application/json"}})},useWeather=e=>{const[i,a]=reactExports.useState(!0),[o,c]=reactExports.useState(null),[s,d]=reactExports.useState(null),$=async(et,h)=>{if(a(!0),!h){const b=getFromCache(et,dateToTimestamp(new Date));if(b){c({...b,source:"cache"}),a(!1);return}}fetchWeather(et).then(b=>{b.error||(c({...b,source:"api"}),setCache(et,dateToTimestamp(new Date),b)),a(!1)}).catch(b=>{d(b),a(!1)})};return reactExports.useEffect(()=>{$(e,!1)},[e]),{data:o,isLoading:i,error:s,refetch:et=>$(et,!0)}},genericDateOptions={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1},formatDate=(e,i)=>new Intl.DateTimeFormat("pt-BR",{...genericDateOptions,timeZone:e}).format(i),isCurrentLocalTimeZone=e=>Intl.DateTimeFormat().resolvedOptions().timeZone===e,getNewsURL=e=>`https://www.google.com/search?q=${encodeURI(e)}&source=lnms&tbm=nws`,titleCase=e=>{if(e)return e.split(" ").map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join(" ")},Clock=({timeZone:e})=>{const[i,a]=reactExports.useState(formatDate(e,new Date)),o=reactExports.useRef(null);return reactExports.useEffect(()=>{const c=()=>{a(formatDate(e,new Date))};return o.current=window.setInterval(c,1e3),()=>{o.current!==null&&clearInterval(o.current)}},[e]),jsxRuntimeExports.jsx("div",{children:i})},Info=()=>jsxRuntimeExports.jsx("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 245.334 245.334",width:"30",height:"30",className:"update-button",children:jsxRuntimeExports.jsxs("g",{children:[jsxRuntimeExports.jsx("path",{d:"M122.667,0C55.028,0,0,55.028,0,122.667s55.027,122.667,122.666,122.667s122.667-55.028,122.667-122.667   S190.305,0,122.667,0z M122.667,215.334C71.57,215.334,30,173.764,30,122.667S71.57,30,122.667,30s92.667,41.57,92.667,92.667   S173.763,215.334,122.667,215.334z"}),jsxRuntimeExports.jsx("rect",{width:"30",x:"107.667",y:"109.167",height:"79"}),jsxRuntimeExports.jsx("rect",{width:"30",x:"107.667",y:"57.167",height:"29"})]})}),Reload=()=>jsxRuntimeExports.jsx("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 488.482 488.482",width:"30",height:"30",className:"update-button",children:jsxRuntimeExports.jsx("g",{children:jsxRuntimeExports.jsx("g",{children:jsxRuntimeExports.jsx("path",{d:`M456.382,359.741l4.1-6.6c1.2-2.3,2.4-4.6,3.5-6.9c2.3-4.7,4.8-9.2,6.8-14c3.7-9.7,7.7-19.3,10.1-29.4
            c3.1-10,4.4-20.3,6.1-30.6c0.7-5.2,0.7-10.4,1.1-15.6l0.4-7.8v-0.5v-0.2v-0.1v-1.1v-0.9l-0.1-1.8l-0.2-3.6l-0.6-14.3l-2.3-16.2
            c-0.4-2.7-0.7-5.5-1.3-8l-1.9-7.6c-1.4-5-2.4-10.2-4.2-15.1c-6.4-19.9-16.1-38.7-27.7-56c-12.1-17.1-26.6-32.3-42.7-45.6
            c-15.7-13-33.1-24.5-52-33.1c-7.5-3.2-15.3-6.1-23-8.8l-11.9-3.2c-4-1-7.9-2.3-12-2.8l-12.2-2l-6.1-1l-6.2-0.4l-12.3-0.7l-3.1-0.2
            h-0.8h-0.2h-1.2h-0.4l-1.4,0.1l-5.6,0.2l-11.3,0.5c-1.8,0-4,0.4-6.1,0.7l-6.4,0.9l-12.8,1.9l-12,3c-4,1.1-8.1,1.8-11.9,3.4
            l-11.6,4.2l-5.8,2.2l-5.6,2.7l-11.1,5.4c-58.8,30.5-101.2,89.3-112,153.5c-0.6,4.6-1.1,9.1-1.5,13.4c-0.4,4.3-0.8,8.5-0.5,12.5
            c0.1,2.4,0.2,4.6,0.4,6.9c-11.1-17.4-23.7-33.9-34-51.8c-0.8-1.4-5.2-1.7-7.7-1c-4.9,1.3-7.2,5.4-8.1,9.7
            c-2.9,14.3,0.3,27.3,6.4,38.6c11.5,21.3,22.1,43.2,35.8,63.2l0.3,0.5c0.5,0.7,1,1.4,1.7,2.1c7,7.6,18.9,8.1,26.6,1
            c4.9-4.5,9.6-9.2,14.1-14.2c3.1-2.3,6.2-4.5,9.2-6.9c19.1-15,37.5-30.9,52.7-50.1c4.3-5.5,5.5-12.7-1-19.1
            c-5.9-5.8-13.6-7.1-19.5-3.1c-10.6,7.2-21.3,14.3-30.6,23c-8.6,8-16.8,16.4-24.9,24.9c0.5-1.6,1-3.3,1.5-5.2
            c1.5-5.2,3-11.1,4.2-17.9c0.4-3.4,1.7-6.8,2.4-10.5c0.8-3.7,1.6-7.5,2.4-11.5c7-28.5,20.7-55.1,39.3-77.5
            c18.5-22.5,42.5-40,68.5-52.3c5.1-2.8,10.7-4.5,16.1-6.6c5.4-2.3,11-3.5,16.7-5.1c2.8-0.7,5.6-1.7,8.4-2.1l8.2-1.3l8.3-1.4
            l9.5-0.6c23.4-1.5,46.9,1.1,69.2,8.2c44.7,13.9,84.1,45.4,107.3,86.8l6,14.7c1.1,2.4,1.8,5,2.6,7.5l2.3,7.6
            c1.8,5,2.6,10.2,3.7,15.3l1.6,7.7c0.4,2.5,0.5,5,0.8,7.5l0.8,7.4c0.1,1.3,0.3,2.4,0.4,3.8l0.1,4.3l0.1,8.6l0.1,4.3v2.1v0.5v0.3
            v0.1c0,0.2,0-1.6,0-0.8l-0.1,1l-1.3,15.6c-0.5,5.2-1.8,10.3-2.6,15.4c-8.3,40.6-29.6,78.7-61.3,105.6
            c-15.7,13.6-33.6,24.5-52.9,32.2c-4.9,1.7-9.7,3.8-14.7,5.2l-15.1,3.9l-14.6,2.3c-2.2,0.5-5.2,0.6-8.1,0.8l-8.6,0.5l-4.3,0.2
            l-1.7,0.1h-0.4h-1l-7.8-0.2c-5.2-0.4-10.4-0.7-15.5-1.5c-10.3-1.4-20.4-3.7-30.3-6.9c-19.8-6.3-38.3-16.3-54.6-28.9
            c-2.9-2.3-7.1-4.6-10.9-6.4c-3.8-1.6-8.1-3.9-10.3-4.3c-4.6-1-5.7,1-4.5,5c0.6,1.9,1.7,4.4,3.3,7.1c1.6,2.6,3.6,5.5,6.1,8.5
            c16.3,20,40.6,38,70.1,48.8c14.7,5.4,30.6,9.1,47.1,10.4l6.2,0.4l1.5,0.1l0.8,0.1h0.4h0.2h0.8h2.9c3.9-0.1,7.8-0.1,11.8-0.2
            l5.9-0.1l6.4-0.8l12.9-1.7c40.2-7.1,78.4-25.4,108.8-53.2C432.182,393.241,445.882,377.541,456.382,359.741z`})})})}),openNews=e=>window.open(e),dateDiffInHours=e=>{const i=new Date,o=new Date(new Date().toLocaleString("en-US",{timeZone:e})).getTime()-i.getTime(),c=Math.round(o/(1e3*60*60));return c===0?"Same as local":`${c}h ${c>0?"ahead":"behind"}`},feelsLike=e=>{var a;let i="";return(a=e==null?void 0:e.condition)!=null&&a.text&&(i+=e.condition.text),e!=null&&e.temp_c&&(i+=`, ${e.temp_c}°C`),e!=null&&e.feelslike_c&&(i+=`, Feels like ${e.feelslike_c}°C`),i},Place=({name:e,timeZone:i,city:a,current:o})=>{var Gt,qt;const{data:c,isLoading:s,error:d,refetch:$}=useWeather(a),et=window.innerWidth<768,h=et?"flex-col":"flex-row",b=et?"justify-items-start":"justify-between",g=et?"w-full":"w-1/3",st=et?"mb-4":"mb-0",$t=(...Lt)=>Lt.join(" "),vt=c&&c.current&&!s&&!d,Ft=[`${et?"h-full":"h-40"}`,"w-full","border-2","flex",h,b,`${et?"p-10":"p-1"}`,"my-4","rounded-lg","items-center","bg-slate-600","shadow-lg",`${o?"border-amber-50":"border-transparent"}`].join(" ");return jsxRuntimeExports.jsxs("div",{className:Ft,children:[jsxRuntimeExports.jsx("div",{className:$t("ml-2",g,st),children:jsxRuntimeExports.jsxs("h3",{children:[e," ",s?"Loading...":""]})}),jsxRuntimeExports.jsxs("div",{className:$t(g,st,"flex-col flex justify-between"),children:[jsxRuntimeExports.jsx(Clock,{timeZone:i}),jsxRuntimeExports.jsxs("span",{children:[dateDiffInHours(i),o&&", Current"]})]}),!!d&&jsxRuntimeExports.jsxs("div",{className:$t(g,st),children:[jsxRuntimeExports.jsx("p",{children:"Unable to get weather info"}),jsxRuntimeExports.jsx("button",{style:{border:"solid 1px #ddd",padding:10},onClick:()=>$(a),children:"Try again"})]}),!vt&&!d&&jsxRuntimeExports.jsx("div",{className:$t(g,st),children:jsxRuntimeExports.jsx("div",{className:"bg-slate-600 skeleton h-32 w-full"})}),vt&&jsxRuntimeExports.jsxs("div",{className:$t(g,st,"p-4"),children:[jsxRuntimeExports.jsx("h3",{className:"text-gray-50 flex justify-start lg:justify-end md:justify-end",children:feelsLike(c.current)}),jsxRuntimeExports.jsxs("div",{className:"flex flex-row items-center justify-end",children:[jsxRuntimeExports.jsx("div",{children:((qt=(Gt=c==null?void 0:c.current)==null?void 0:Gt.condition)==null?void 0:qt.icon)&&jsxRuntimeExports.jsx("img",{className:"condition-img",src:c.current.condition.icon,alt:c.current.condition.text})}),jsxRuntimeExports.jsxs("div",{className:"left-40 ml-5",children:[jsxRuntimeExports.jsx("button",{className:"btn btn-circle btn-info",disabled:s,onClick:()=>$(a),children:jsxRuntimeExports.jsx(Reload,{})}),jsxRuntimeExports.jsx("button",{className:"btn btn-circle btn-info",onClick:()=>openNews(getNewsURL(a)),children:jsxRuntimeExports.jsx(Info,{})})]})]})]})]})},Place$1=reactExports.memo(Place),places=[{name:"Florianópolis/Brazil",city:"Florianópolis, Santa Catarina, Brazil",timeZone:"America/Sao_Paulo"},{name:"Munich/Germany",city:"Munich, Germany",timeZone:"Europe/Berlin"},{name:"San Francisco/USA",city:"San Francisco, California, USA",timeZone:"America/Los_Angeles"},{name:"Lisbon/Portugal",city:"Lisbon, Portugal",timeZone:"Europe/Lisbon"},{name:"Dublin/Ireland",timeZone:"Europe/Dublin",city:"Dublin, Ireland"},{name:"Europe/Gothenburg",city:"Gothenburg, Sweden",timeZone:"Europe/Stockholm"}].map(e=>({...e,current:isCurrentLocalTimeZone(e.timeZone)})),WeatherApp=()=>{const e=useIsMobile();return jsxRuntimeExports.jsx(Page,{name:"Weather",withoutPadding:e,repo:REPOS.weather.url,children:jsxRuntimeExports.jsx("div",{className:"flex flex-col w-full",children:places.map(i=>reactExports.createElement(Place$1,{...i,key:i.timeZone}))})})},transformMap={á:"a",à:"a",ó:"o",é:"e",ç:"c",ã:"a","¿":"?",o:"o",a:"a"},transform=e=>(transformMap[e]??e).toLowerCase(),to=(e,i="yellow")=>{if(e===" ")return"  ";if(e===".")return".";if(e==="?")return":question:";if(e==="!")return":exclamation:";const a=transform(e);return/[a-zA-Z]/.test(e)?`:alphabet-${i}-${a}:`:e},createSlackAlphabet=e=>e.split("").map(i=>to(i)).join(""),url2JSON=e=>{const i={source:e,props:{},keysList:[],valuesList:[]},a=e.split("?");return a.length>1&&a[1].split("&").forEach(c=>{const s=c.split("=");i.keysList.push(s[0]),i.valuesList.push(s[1]),i.props[s[0]]=decodeURIComponent(s[1])}),i},CodePen=()=>{const e=useIsMobile(),[i,a]=reactExports.useState(null),[o,c]=reactExports.useState("");return jsxRuntimeExports.jsxs(Page,{name:"Code Pens",withoutPadding:e,repo:REPOS.codepen.url,className:"bg-gray-200 text-black",children:[jsxRuntimeExports.jsxs("div",{className:"w-full bg-grey-50 mt-3",children:[jsxRuntimeExports.jsx("h3",{className:"text-black",children:"URL to JSON"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap -mx-3 mb-6",children:[jsxRuntimeExports.jsx("div",{className:"w-full px-3",children:jsxRuntimeExports.jsx("input",{onChange:s=>a(url2JSON(s.target.value)),className:"appearance-none block w-full text-black border rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white",type:"text",placeholder:"Paste URL"})}),jsxRuntimeExports.jsxs("div",{className:"w-full px-3",children:[jsxRuntimeExports.jsx("label",{className:"block text-black text-sm font-bold mb-2",children:"Results"}),jsxRuntimeExports.jsx("textarea",{rows:10,placeholder:"Paste above ^",value:i?JSON.stringify(i,null,4):"",className:"appearance-none block w-full text-black border rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"w-full bg-grey-50 mt-3",children:[jsxRuntimeExports.jsx("h3",{className:"text-black",children:"Slacker"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap -mx-3 mb-6",children:[jsxRuntimeExports.jsx("div",{className:"w-full px-3",children:jsxRuntimeExports.jsx("input",{onChange:s=>c(createSlackAlphabet(s.target.value)),className:"appearance-none block w-full text-black border rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white",type:"text",placeholder:"Type Something"})}),jsxRuntimeExports.jsxs("div",{className:"w-full px-3",children:[jsxRuntimeExports.jsx("label",{className:"block text-black text-sm font-bold mb-2",children:"Results"}),jsxRuntimeExports.jsx("textarea",{placeholder:"Type above ^",rows:5,value:o,className:"appearance-none block w-full text-black border rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white"})]})]})]})]})};function toDate(e){const i=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&i==="[object Date]"?new e.constructor(+e):typeof e=="number"||i==="[object Number]"||typeof e=="string"||i==="[object String]"?new Date(e):new Date(NaN)}function constructFrom(e,i){return e instanceof Date?new e.constructor(i):new Date(i)}function addDays(e,i){const a=toDate(e);return isNaN(i)?constructFrom(e,NaN):(i&&a.setDate(a.getDate()+i),a)}function addMonths(e,i){const a=toDate(e);if(isNaN(i))return constructFrom(e,NaN);if(!i)return a;const o=a.getDate(),c=constructFrom(e,a.getTime());c.setMonth(a.getMonth()+i+1,0);const s=c.getDate();return o>=s?c:(a.setFullYear(c.getFullYear(),c.getMonth(),o),a)}const millisecondsInWeek=6048e5,millisecondsInDay=864e5;let defaultOptions={};function getDefaultOptions(){return defaultOptions}function startOfWeek(e,i){var $,et,h,b;const a=getDefaultOptions(),o=(i==null?void 0:i.weekStartsOn)??((et=($=i==null?void 0:i.locale)==null?void 0:$.options)==null?void 0:et.weekStartsOn)??a.weekStartsOn??((b=(h=a.locale)==null?void 0:h.options)==null?void 0:b.weekStartsOn)??0,c=toDate(e),s=c.getDay(),d=(s<o?7:0)+s-o;return c.setDate(c.getDate()-d),c.setHours(0,0,0,0),c}function startOfISOWeek(e){return startOfWeek(e,{weekStartsOn:1})}function getISOWeekYear(e){const i=toDate(e),a=i.getFullYear(),o=constructFrom(e,0);o.setFullYear(a+1,0,4),o.setHours(0,0,0,0);const c=startOfISOWeek(o),s=constructFrom(e,0);s.setFullYear(a,0,4),s.setHours(0,0,0,0);const d=startOfISOWeek(s);return i.getTime()>=c.getTime()?a+1:i.getTime()>=d.getTime()?a:a-1}function startOfDay(e){const i=toDate(e);return i.setHours(0,0,0,0),i}function getTimezoneOffsetInMilliseconds(e){const i=toDate(e),a=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()));return a.setUTCFullYear(i.getFullYear()),+e-+a}function differenceInCalendarDays(e,i){const a=startOfDay(e),o=startOfDay(i),c=+a-getTimezoneOffsetInMilliseconds(a),s=+o-getTimezoneOffsetInMilliseconds(o);return Math.round((c-s)/millisecondsInDay)}function startOfISOWeekYear(e){const i=getISOWeekYear(e),a=constructFrom(e,0);return a.setFullYear(i,0,4),a.setHours(0,0,0,0),startOfISOWeek(a)}function addWeeks(e,i){const a=i*7;return addDays(e,a)}function addYears(e,i){return addMonths(e,i*12)}function max(e){let i;return e.forEach(function(a){const o=toDate(a);(i===void 0||i<o||isNaN(Number(o)))&&(i=o)}),i||new Date(NaN)}function min(e){let i;return e.forEach(a=>{const o=toDate(a);(!i||i>o||isNaN(+o))&&(i=o)}),i||new Date(NaN)}function isSameDay(e,i){const a=startOfDay(e),o=startOfDay(i);return+a==+o}function isDate(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function isValid(e){if(!isDate(e)&&typeof e!="number")return!1;const i=toDate(e);return!isNaN(Number(i))}function differenceInCalendarMonths(e,i){const a=toDate(e),o=toDate(i),c=a.getFullYear()-o.getFullYear(),s=a.getMonth()-o.getMonth();return c*12+s}function differenceInCalendarWeeks(e,i,a){const o=startOfWeek(e,a),c=startOfWeek(i,a),s=+o-getTimezoneOffsetInMilliseconds(o),d=+c-getTimezoneOffsetInMilliseconds(c);return Math.round((s-d)/millisecondsInWeek)}function endOfMonth(e){const i=toDate(e),a=i.getMonth();return i.setFullYear(i.getFullYear(),a+1,0),i.setHours(23,59,59,999),i}function startOfMonth(e){const i=toDate(e);return i.setDate(1),i.setHours(0,0,0,0),i}function startOfYear(e){const i=toDate(e),a=constructFrom(e,0);return a.setFullYear(i.getFullYear(),0,1),a.setHours(0,0,0,0),a}function endOfWeek(e,i){var $,et,h,b;const a=getDefaultOptions(),o=(i==null?void 0:i.weekStartsOn)??((et=($=i==null?void 0:i.locale)==null?void 0:$.options)==null?void 0:et.weekStartsOn)??a.weekStartsOn??((b=(h=a.locale)==null?void 0:h.options)==null?void 0:b.weekStartsOn)??0,c=toDate(e),s=c.getDay(),d=(s<o?-7:0)+6-(s-o);return c.setDate(c.getDate()+d),c.setHours(23,59,59,999),c}function endOfISOWeek(e){return endOfWeek(e,{weekStartsOn:1})}const formatDistanceLocale={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},formatDistance=(e,i,a)=>{let o;const c=formatDistanceLocale[e];return typeof c=="string"?o=c:i===1?o=c.one:o=c.other.replace("{{count}}",i.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"in "+o:o+" ago":o};function buildFormatLongFn(e){return(i={})=>{const a=i.width?String(i.width):e.defaultWidth;return e.formats[a]||e.formats[e.defaultWidth]}}const dateFormats={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},timeFormats={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},formatLong={date:buildFormatLongFn({formats:dateFormats,defaultWidth:"full"}),time:buildFormatLongFn({formats:timeFormats,defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:dateTimeFormats,defaultWidth:"full"})},formatRelativeLocale={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},formatRelative=(e,i,a,o)=>formatRelativeLocale[e];function buildLocalizeFn(e){return(i,a)=>{const o=a!=null&&a.context?String(a.context):"standalone";let c;if(o==="formatting"&&e.formattingValues){const d=e.defaultFormattingWidth||e.defaultWidth,$=a!=null&&a.width?String(a.width):d;c=e.formattingValues[$]||e.formattingValues[d]}else{const d=e.defaultWidth,$=a!=null&&a.width?String(a.width):e.defaultWidth;c=e.values[$]||e.values[d]}const s=e.argumentCallback?e.argumentCallback(i):i;return c[s]}}const eraValues={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},quarterValues={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},monthValues={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},dayValues={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},formattingDayPeriodValues={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ordinalNumber=(e,i)=>{const a=Number(e),o=a%100;if(o>20||o<10)switch(o%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},localize={ordinalNumber,era:buildLocalizeFn({values:eraValues,defaultWidth:"wide"}),quarter:buildLocalizeFn({values:quarterValues,defaultWidth:"wide",argumentCallback:e=>e-1}),month:buildLocalizeFn({values:monthValues,defaultWidth:"wide"}),day:buildLocalizeFn({values:dayValues,defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:dayPeriodValues,defaultWidth:"wide",formattingValues:formattingDayPeriodValues,defaultFormattingWidth:"wide"})};function buildMatchFn(e){return(i,a={})=>{const o=a.width,c=o&&e.matchPatterns[o]||e.matchPatterns[e.defaultMatchWidth],s=i.match(c);if(!s)return null;const d=s[0],$=o&&e.parsePatterns[o]||e.parsePatterns[e.defaultParseWidth],et=Array.isArray($)?findIndex($,g=>g.test(d)):findKey($,g=>g.test(d));let h;h=e.valueCallback?e.valueCallback(et):et,h=a.valueCallback?a.valueCallback(h):h;const b=i.slice(d.length);return{value:h,rest:b}}}function findKey(e,i){for(const a in e)if(Object.prototype.hasOwnProperty.call(e,a)&&i(e[a]))return a}function findIndex(e,i){for(let a=0;a<e.length;a++)if(i(e[a]))return a}function buildMatchPatternFn(e){return(i,a={})=>{const o=i.match(e.matchPattern);if(!o)return null;const c=o[0],s=i.match(e.parsePattern);if(!s)return null;let d=e.valueCallback?e.valueCallback(s[0]):s[0];d=a.valueCallback?a.valueCallback(d):d;const $=i.slice(c.length);return{value:d,rest:$}}}const matchOrdinalNumberPattern=/^(\d+)(th|st|nd|rd)?/i,parseOrdinalNumberPattern=/\d+/i,matchEraPatterns={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},parseEraPatterns={any:[/^b/i,/^(a|c)/i]},matchQuarterPatterns={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},parseQuarterPatterns={any:[/1/i,/2/i,/3/i,/4/i]},matchMonthPatterns={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},parseMonthPatterns={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},matchDayPatterns={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},parseDayPatterns={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},matchDayPeriodPatterns={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},parseDayPeriodPatterns={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},match={ordinalNumber:buildMatchPatternFn({matchPattern:matchOrdinalNumberPattern,parsePattern:parseOrdinalNumberPattern,valueCallback:e=>parseInt(e,10)}),era:buildMatchFn({matchPatterns:matchEraPatterns,defaultMatchWidth:"wide",parsePatterns:parseEraPatterns,defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:matchQuarterPatterns,defaultMatchWidth:"wide",parsePatterns:parseQuarterPatterns,defaultParseWidth:"any",valueCallback:e=>e+1}),month:buildMatchFn({matchPatterns:matchMonthPatterns,defaultMatchWidth:"wide",parsePatterns:parseMonthPatterns,defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:matchDayPatterns,defaultMatchWidth:"wide",parsePatterns:parseDayPatterns,defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:matchDayPeriodPatterns,defaultMatchWidth:"any",parsePatterns:parseDayPeriodPatterns,defaultParseWidth:"any"})},enUS={code:"en-US",formatDistance,formatLong,formatRelative,localize,match,options:{weekStartsOn:0,firstWeekContainsDate:1}};function getDayOfYear(e){const i=toDate(e);return differenceInCalendarDays(i,startOfYear(i))+1}function getISOWeek(e){const i=toDate(e),a=+startOfISOWeek(i)-+startOfISOWeekYear(i);return Math.round(a/millisecondsInWeek)+1}function getWeekYear(e,i){var b,g,st,$t;const a=toDate(e),o=a.getFullYear(),c=getDefaultOptions(),s=(i==null?void 0:i.firstWeekContainsDate)??((g=(b=i==null?void 0:i.locale)==null?void 0:b.options)==null?void 0:g.firstWeekContainsDate)??c.firstWeekContainsDate??(($t=(st=c.locale)==null?void 0:st.options)==null?void 0:$t.firstWeekContainsDate)??1,d=constructFrom(e,0);d.setFullYear(o+1,0,s),d.setHours(0,0,0,0);const $=startOfWeek(d,i),et=constructFrom(e,0);et.setFullYear(o,0,s),et.setHours(0,0,0,0);const h=startOfWeek(et,i);return a.getTime()>=$.getTime()?o+1:a.getTime()>=h.getTime()?o:o-1}function startOfWeekYear(e,i){var $,et,h,b;const a=getDefaultOptions(),o=(i==null?void 0:i.firstWeekContainsDate)??((et=($=i==null?void 0:i.locale)==null?void 0:$.options)==null?void 0:et.firstWeekContainsDate)??a.firstWeekContainsDate??((b=(h=a.locale)==null?void 0:h.options)==null?void 0:b.firstWeekContainsDate)??1,c=getWeekYear(e,i),s=constructFrom(e,0);return s.setFullYear(c,0,o),s.setHours(0,0,0,0),startOfWeek(s,i)}function getWeek(e,i){const a=toDate(e),o=+startOfWeek(a,i)-+startOfWeekYear(a,i);return Math.round(o/millisecondsInWeek)+1}function addLeadingZeros(e,i){const a=e<0?"-":"",o=Math.abs(e).toString().padStart(i,"0");return a+o}const lightFormatters={y(e,i){const a=e.getFullYear(),o=a>0?a:1-a;return addLeadingZeros(i==="yy"?o%100:o,i.length)},M(e,i){const a=e.getMonth();return i==="M"?String(a+1):addLeadingZeros(a+1,2)},d(e,i){return addLeadingZeros(e.getDate(),i.length)},a(e,i){const a=e.getHours()/12>=1?"pm":"am";switch(i){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h(e,i){return addLeadingZeros(e.getHours()%12||12,i.length)},H(e,i){return addLeadingZeros(e.getHours(),i.length)},m(e,i){return addLeadingZeros(e.getMinutes(),i.length)},s(e,i){return addLeadingZeros(e.getSeconds(),i.length)},S(e,i){const a=i.length,o=e.getMilliseconds(),c=Math.trunc(o*Math.pow(10,a-3));return addLeadingZeros(c,i.length)}},dayPeriodEnum={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},formatters$1={G:function(e,i,a){const o=e.getFullYear()>0?1:0;switch(i){case"G":case"GG":case"GGG":return a.era(o,{width:"abbreviated"});case"GGGGG":return a.era(o,{width:"narrow"});case"GGGG":default:return a.era(o,{width:"wide"})}},y:function(e,i,a){if(i==="yo"){const o=e.getFullYear(),c=o>0?o:1-o;return a.ordinalNumber(c,{unit:"year"})}return lightFormatters.y(e,i)},Y:function(e,i,a,o){const c=getWeekYear(e,o),s=c>0?c:1-c;if(i==="YY"){const d=s%100;return addLeadingZeros(d,2)}return i==="Yo"?a.ordinalNumber(s,{unit:"year"}):addLeadingZeros(s,i.length)},R:function(e,i){const a=getISOWeekYear(e);return addLeadingZeros(a,i.length)},u:function(e,i){const a=e.getFullYear();return addLeadingZeros(a,i.length)},Q:function(e,i,a){const o=Math.ceil((e.getMonth()+1)/3);switch(i){case"Q":return String(o);case"QQ":return addLeadingZeros(o,2);case"Qo":return a.ordinalNumber(o,{unit:"quarter"});case"QQQ":return a.quarter(o,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(o,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(o,{width:"wide",context:"formatting"})}},q:function(e,i,a){const o=Math.ceil((e.getMonth()+1)/3);switch(i){case"q":return String(o);case"qq":return addLeadingZeros(o,2);case"qo":return a.ordinalNumber(o,{unit:"quarter"});case"qqq":return a.quarter(o,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(o,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(o,{width:"wide",context:"standalone"})}},M:function(e,i,a){const o=e.getMonth();switch(i){case"M":case"MM":return lightFormatters.M(e,i);case"Mo":return a.ordinalNumber(o+1,{unit:"month"});case"MMM":return a.month(o,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(o,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(o,{width:"wide",context:"formatting"})}},L:function(e,i,a){const o=e.getMonth();switch(i){case"L":return String(o+1);case"LL":return addLeadingZeros(o+1,2);case"Lo":return a.ordinalNumber(o+1,{unit:"month"});case"LLL":return a.month(o,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(o,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(o,{width:"wide",context:"standalone"})}},w:function(e,i,a,o){const c=getWeek(e,o);return i==="wo"?a.ordinalNumber(c,{unit:"week"}):addLeadingZeros(c,i.length)},I:function(e,i,a){const o=getISOWeek(e);return i==="Io"?a.ordinalNumber(o,{unit:"week"}):addLeadingZeros(o,i.length)},d:function(e,i,a){return i==="do"?a.ordinalNumber(e.getDate(),{unit:"date"}):lightFormatters.d(e,i)},D:function(e,i,a){const o=getDayOfYear(e);return i==="Do"?a.ordinalNumber(o,{unit:"dayOfYear"}):addLeadingZeros(o,i.length)},E:function(e,i,a){const o=e.getDay();switch(i){case"E":case"EE":case"EEE":return a.day(o,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(o,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(o,{width:"short",context:"formatting"});case"EEEE":default:return a.day(o,{width:"wide",context:"formatting"})}},e:function(e,i,a,o){const c=e.getDay(),s=(c-o.weekStartsOn+8)%7||7;switch(i){case"e":return String(s);case"ee":return addLeadingZeros(s,2);case"eo":return a.ordinalNumber(s,{unit:"day"});case"eee":return a.day(c,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(c,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(c,{width:"short",context:"formatting"});case"eeee":default:return a.day(c,{width:"wide",context:"formatting"})}},c:function(e,i,a,o){const c=e.getDay(),s=(c-o.weekStartsOn+8)%7||7;switch(i){case"c":return String(s);case"cc":return addLeadingZeros(s,i.length);case"co":return a.ordinalNumber(s,{unit:"day"});case"ccc":return a.day(c,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(c,{width:"narrow",context:"standalone"});case"cccccc":return a.day(c,{width:"short",context:"standalone"});case"cccc":default:return a.day(c,{width:"wide",context:"standalone"})}},i:function(e,i,a){const o=e.getDay(),c=o===0?7:o;switch(i){case"i":return String(c);case"ii":return addLeadingZeros(c,i.length);case"io":return a.ordinalNumber(c,{unit:"day"});case"iii":return a.day(o,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(o,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(o,{width:"short",context:"formatting"});case"iiii":default:return a.day(o,{width:"wide",context:"formatting"})}},a:function(e,i,a){const c=e.getHours()/12>=1?"pm":"am";switch(i){case"a":case"aa":return a.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(c,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(c,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(c,{width:"wide",context:"formatting"})}},b:function(e,i,a){const o=e.getHours();let c;switch(o===12?c=dayPeriodEnum.noon:o===0?c=dayPeriodEnum.midnight:c=o/12>=1?"pm":"am",i){case"b":case"bb":return a.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(c,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(c,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(c,{width:"wide",context:"formatting"})}},B:function(e,i,a){const o=e.getHours();let c;switch(o>=17?c=dayPeriodEnum.evening:o>=12?c=dayPeriodEnum.afternoon:o>=4?c=dayPeriodEnum.morning:c=dayPeriodEnum.night,i){case"B":case"BB":case"BBB":return a.dayPeriod(c,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(c,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(c,{width:"wide",context:"formatting"})}},h:function(e,i,a){if(i==="ho"){let o=e.getHours()%12;return o===0&&(o=12),a.ordinalNumber(o,{unit:"hour"})}return lightFormatters.h(e,i)},H:function(e,i,a){return i==="Ho"?a.ordinalNumber(e.getHours(),{unit:"hour"}):lightFormatters.H(e,i)},K:function(e,i,a){const o=e.getHours()%12;return i==="Ko"?a.ordinalNumber(o,{unit:"hour"}):addLeadingZeros(o,i.length)},k:function(e,i,a){let o=e.getHours();return o===0&&(o=24),i==="ko"?a.ordinalNumber(o,{unit:"hour"}):addLeadingZeros(o,i.length)},m:function(e,i,a){return i==="mo"?a.ordinalNumber(e.getMinutes(),{unit:"minute"}):lightFormatters.m(e,i)},s:function(e,i,a){return i==="so"?a.ordinalNumber(e.getSeconds(),{unit:"second"}):lightFormatters.s(e,i)},S:function(e,i){return lightFormatters.S(e,i)},X:function(e,i,a){const o=e.getTimezoneOffset();if(o===0)return"Z";switch(i){case"X":return formatTimezoneWithOptionalMinutes(o);case"XXXX":case"XX":return formatTimezone(o);case"XXXXX":case"XXX":default:return formatTimezone(o,":")}},x:function(e,i,a){const o=e.getTimezoneOffset();switch(i){case"x":return formatTimezoneWithOptionalMinutes(o);case"xxxx":case"xx":return formatTimezone(o);case"xxxxx":case"xxx":default:return formatTimezone(o,":")}},O:function(e,i,a){const o=e.getTimezoneOffset();switch(i){case"O":case"OO":case"OOO":return"GMT"+formatTimezoneShort(o,":");case"OOOO":default:return"GMT"+formatTimezone(o,":")}},z:function(e,i,a){const o=e.getTimezoneOffset();switch(i){case"z":case"zz":case"zzz":return"GMT"+formatTimezoneShort(o,":");case"zzzz":default:return"GMT"+formatTimezone(o,":")}},t:function(e,i,a){const o=Math.trunc(e.getTime()/1e3);return addLeadingZeros(o,i.length)},T:function(e,i,a){const o=e.getTime();return addLeadingZeros(o,i.length)}};function formatTimezoneShort(e,i=""){const a=e>0?"-":"+",o=Math.abs(e),c=Math.trunc(o/60),s=o%60;return s===0?a+String(c):a+String(c)+i+addLeadingZeros(s,2)}function formatTimezoneWithOptionalMinutes(e,i){return e%60===0?(e>0?"-":"+")+addLeadingZeros(Math.abs(e)/60,2):formatTimezone(e,i)}function formatTimezone(e,i=""){const a=e>0?"-":"+",o=Math.abs(e),c=addLeadingZeros(Math.trunc(o/60),2),s=addLeadingZeros(o%60,2);return a+c+i+s}const dateLongFormatter=(e,i)=>{switch(e){case"P":return i.date({width:"short"});case"PP":return i.date({width:"medium"});case"PPP":return i.date({width:"long"});case"PPPP":default:return i.date({width:"full"})}},timeLongFormatter=(e,i)=>{switch(e){case"p":return i.time({width:"short"});case"pp":return i.time({width:"medium"});case"ppp":return i.time({width:"long"});case"pppp":default:return i.time({width:"full"})}},dateTimeLongFormatter=(e,i)=>{const a=e.match(/(P+)(p+)?/)||[],o=a[1],c=a[2];if(!c)return dateLongFormatter(e,i);let s;switch(o){case"P":s=i.dateTime({width:"short"});break;case"PP":s=i.dateTime({width:"medium"});break;case"PPP":s=i.dateTime({width:"long"});break;case"PPPP":default:s=i.dateTime({width:"full"});break}return s.replace("{{date}}",dateLongFormatter(o,i)).replace("{{time}}",timeLongFormatter(c,i))},longFormatters={p:timeLongFormatter,P:dateTimeLongFormatter},dayOfYearTokenRE=/^D+$/,weekYearTokenRE=/^Y+$/,throwTokens=["D","DD","YY","YYYY"];function isProtectedDayOfYearToken(e){return dayOfYearTokenRE.test(e)}function isProtectedWeekYearToken(e){return weekYearTokenRE.test(e)}function warnOrThrowProtectedError(e,i,a){const o=message(e,i,a);if(console.warn(o),throwTokens.includes(e))throw new RangeError(o)}function message(e,i,a){const o=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${i}\`) for formatting ${o} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const formattingTokensRegExp=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,longFormattingTokensRegExp=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,escapedStringRegExp=/^'([^]*?)'?$/,doubleQuoteRegExp=/''/g,unescapedLatinCharacterRegExp=/[a-zA-Z]/;function format(e,i,a){var b,g,st,$t,vt,Ft,Gt,qt;const o=getDefaultOptions(),c=(a==null?void 0:a.locale)??o.locale??enUS,s=(a==null?void 0:a.firstWeekContainsDate)??((g=(b=a==null?void 0:a.locale)==null?void 0:b.options)==null?void 0:g.firstWeekContainsDate)??o.firstWeekContainsDate??(($t=(st=o.locale)==null?void 0:st.options)==null?void 0:$t.firstWeekContainsDate)??1,d=(a==null?void 0:a.weekStartsOn)??((Ft=(vt=a==null?void 0:a.locale)==null?void 0:vt.options)==null?void 0:Ft.weekStartsOn)??o.weekStartsOn??((qt=(Gt=o.locale)==null?void 0:Gt.options)==null?void 0:qt.weekStartsOn)??0,$=toDate(e);if(!isValid($))throw new RangeError("Invalid time value");let et=i.match(longFormattingTokensRegExp).map(Lt=>{const rr=Lt[0];if(rr==="p"||rr==="P"){const jr=longFormatters[rr];return jr(Lt,c.formatLong)}return Lt}).join("").match(formattingTokensRegExp).map(Lt=>{if(Lt==="''")return{isToken:!1,value:"'"};const rr=Lt[0];if(rr==="'")return{isToken:!1,value:cleanEscapedString(Lt)};if(formatters$1[rr])return{isToken:!0,value:Lt};if(rr.match(unescapedLatinCharacterRegExp))throw new RangeError("Format string contains an unescaped latin alphabet character `"+rr+"`");return{isToken:!1,value:Lt}});c.localize.preprocessor&&(et=c.localize.preprocessor($,et));const h={firstWeekContainsDate:s,weekStartsOn:d,locale:c};return et.map(Lt=>{if(!Lt.isToken)return Lt.value;const rr=Lt.value;(!(a!=null&&a.useAdditionalWeekYearTokens)&&isProtectedWeekYearToken(rr)||!(a!=null&&a.useAdditionalDayOfYearTokens)&&isProtectedDayOfYearToken(rr))&&warnOrThrowProtectedError(rr,i,String(e));const jr=formatters$1[rr[0]];return jr($,rr,c.localize,h)}).join("")}function cleanEscapedString(e){const i=e.match(escapedStringRegExp);return i?i[1].replace(doubleQuoteRegExp,"'"):e}function getDaysInMonth(e){const i=toDate(e),a=i.getFullYear(),o=i.getMonth(),c=constructFrom(e,0);return c.setFullYear(a,o+1,0),c.setHours(0,0,0,0),c.getDate()}function getUnixTime(e){return Math.trunc(+toDate(e)/1e3)}function lastDayOfMonth(e){const i=toDate(e),a=i.getMonth();return i.setFullYear(i.getFullYear(),a+1,0),i.setHours(0,0,0,0),i}function getWeeksInMonth(e,i){return differenceInCalendarWeeks(lastDayOfMonth(e),startOfMonth(e),i)+1}function isAfter(e,i){const a=toDate(e),o=toDate(i);return a.getTime()>o.getTime()}function isBefore(e,i){const a=toDate(e),o=toDate(i);return+a<+o}function isSameMonth(e,i){const a=toDate(e),o=toDate(i);return a.getFullYear()===o.getFullYear()&&a.getMonth()===o.getMonth()}function isSameYear(e,i){const a=toDate(e),o=toDate(i);return a.getFullYear()===o.getFullYear()}function subDays(e,i){return addDays(e,-i)}function setMonth(e,i){const a=toDate(e),o=a.getFullYear(),c=a.getDate(),s=constructFrom(e,0);s.setFullYear(o,i,15),s.setHours(0,0,0,0);const d=getDaysInMonth(s);return a.setMonth(i,Math.min(c,d)),a}function setYear(e,i){const a=toDate(e);return isNaN(+a)?constructFrom(e,NaN):(a.setFullYear(i),a)}var __assign=function(){return __assign=Object.assign||function(i){for(var a,o=1,c=arguments.length;o<c;o++){a=arguments[o];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(i[s]=a[s])}return i},__assign.apply(this,arguments)};function __rest(e,i){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&i.indexOf(o)<0&&(a[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,o=Object.getOwnPropertySymbols(e);c<o.length;c++)i.indexOf(o[c])<0&&Object.prototype.propertyIsEnumerable.call(e,o[c])&&(a[o[c]]=e[o[c]]);return a}function __spreadArray(e,i,a){if(a||arguments.length===2)for(var o=0,c=i.length,s;o<c;o++)(s||!(o in i))&&(s||(s=Array.prototype.slice.call(i,0,o)),s[o]=i[o]);return e.concat(s||Array.prototype.slice.call(i))}typeof SuppressedError=="function"&&SuppressedError;function isDayPickerMultiple(e){return e.mode==="multiple"}function isDayPickerRange(e){return e.mode==="range"}function isDayPickerSingle(e){return e.mode==="single"}var defaultClassNames={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function formatCaption(e,i){return format(e,"LLLL y",i)}function formatDay(e,i){return format(e,"d",i)}function formatMonthCaption(e,i){return format(e,"LLLL",i)}function formatWeekNumber(e){return"".concat(e)}function formatWeekdayName(e,i){return format(e,"cccccc",i)}function formatYearCaption(e,i){return format(e,"yyyy",i)}var formatters=Object.freeze({__proto__:null,formatCaption,formatDay,formatMonthCaption,formatWeekNumber,formatWeekdayName,formatYearCaption}),labelDay=function(e,i,a){return format(e,"do MMMM (EEEE)",a)},labelMonthDropdown=function(){return"Month: "},labelNext=function(){return"Go to next month"},labelPrevious=function(){return"Go to previous month"},labelWeekday=function(e,i){return format(e,"cccc",i)},labelWeekNumber=function(e){return"Week n. ".concat(e)},labelYearDropdown=function(){return"Year: "},labels=Object.freeze({__proto__:null,labelDay,labelMonthDropdown,labelNext,labelPrevious,labelWeekNumber,labelWeekday,labelYearDropdown});function getDefaultContextValues(){var e="buttons",i=defaultClassNames,a=enUS,o={},c={},s=1,d={},$=new Date;return{captionLayout:e,classNames:i,formatters,labels,locale:a,modifiersClassNames:o,modifiers:c,numberOfMonths:s,styles:d,today:$,mode:"default"}}function parseFromToProps(e){var i=e.fromYear,a=e.toYear,o=e.fromMonth,c=e.toMonth,s=e.fromDate,d=e.toDate;return o?s=startOfMonth(o):i&&(s=new Date(i,0,1)),c?d=endOfMonth(c):a&&(d=new Date(a,11,31)),{fromDate:s?startOfDay(s):void 0,toDate:d?startOfDay(d):void 0}}var DayPickerContext=reactExports.createContext(void 0);function DayPickerProvider(e){var i,a=e.initialProps,o=getDefaultContextValues(),c=parseFromToProps(a),s=c.fromDate,d=c.toDate,$=(i=a.captionLayout)!==null&&i!==void 0?i:o.captionLayout;$!=="buttons"&&(!s||!d)&&($="buttons");var et;(isDayPickerSingle(a)||isDayPickerMultiple(a)||isDayPickerRange(a))&&(et=a.onSelect);var h=__assign(__assign(__assign({},o),a),{captionLayout:$,classNames:__assign(__assign({},o.classNames),a.classNames),components:__assign({},a.components),formatters:__assign(__assign({},o.formatters),a.formatters),fromDate:s,labels:__assign(__assign({},o.labels),a.labels),mode:a.mode||o.mode,modifiers:__assign(__assign({},o.modifiers),a.modifiers),modifiersClassNames:__assign(__assign({},o.modifiersClassNames),a.modifiersClassNames),onSelect:et,styles:__assign(__assign({},o.styles),a.styles),toDate:d});return jsxRuntimeExports.jsx(DayPickerContext.Provider,{value:h,children:e.children})}function useDayPicker(){var e=reactExports.useContext(DayPickerContext);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function CaptionLabel(e){var i=useDayPicker(),a=i.locale,o=i.classNames,c=i.styles,s=i.formatters.formatCaption;return jsxRuntimeExports.jsx("div",{className:o.caption_label,style:c.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:s(e.displayMonth,{locale:a})})}function IconDropdown(e){return jsxRuntimeExports.jsx("svg",__assign({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:jsxRuntimeExports.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Dropdown(e){var i,a,o=e.onChange,c=e.value,s=e.children,d=e.caption,$=e.className,et=e.style,h=useDayPicker(),b=(a=(i=h.components)===null||i===void 0?void 0:i.IconDropdown)!==null&&a!==void 0?a:IconDropdown;return jsxRuntimeExports.jsxs("div",{className:$,style:et,children:[jsxRuntimeExports.jsx("span",{className:h.classNames.vhidden,children:e["aria-label"]}),jsxRuntimeExports.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:h.classNames.dropdown,style:h.styles.dropdown,value:c,onChange:o,children:s}),jsxRuntimeExports.jsxs("div",{className:h.classNames.caption_label,style:h.styles.caption_label,"aria-hidden":"true",children:[d,jsxRuntimeExports.jsx(b,{className:h.classNames.dropdown_icon,style:h.styles.dropdown_icon})]})]})}function MonthsDropdown(e){var i,a=useDayPicker(),o=a.fromDate,c=a.toDate,s=a.styles,d=a.locale,$=a.formatters.formatMonthCaption,et=a.classNames,h=a.components,b=a.labels.labelMonthDropdown;if(!o)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});if(!c)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});var g=[];if(isSameYear(o,c))for(var st=startOfMonth(o),$t=o.getMonth();$t<=c.getMonth();$t++)g.push(setMonth(st,$t));else for(var st=startOfMonth(new Date),$t=0;$t<=11;$t++)g.push(setMonth(st,$t));var vt=function(Gt){var qt=Number(Gt.target.value),Lt=setMonth(startOfMonth(e.displayMonth),qt);e.onChange(Lt)},Ft=(i=h==null?void 0:h.Dropdown)!==null&&i!==void 0?i:Dropdown;return jsxRuntimeExports.jsx(Ft,{name:"months","aria-label":b(),className:et.dropdown_month,style:s.dropdown_month,onChange:vt,value:e.displayMonth.getMonth(),caption:$(e.displayMonth,{locale:d}),children:g.map(function(Gt){return jsxRuntimeExports.jsx("option",{value:Gt.getMonth(),children:$(Gt,{locale:d})},Gt.getMonth())})})}function YearsDropdown(e){var i,a=e.displayMonth,o=useDayPicker(),c=o.fromDate,s=o.toDate,d=o.locale,$=o.styles,et=o.classNames,h=o.components,b=o.formatters.formatYearCaption,g=o.labels.labelYearDropdown,st=[];if(!c)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});if(!s)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});for(var $t=c.getFullYear(),vt=s.getFullYear(),Ft=$t;Ft<=vt;Ft++)st.push(setYear(startOfYear(new Date),Ft));var Gt=function(Lt){var rr=setYear(startOfMonth(a),Number(Lt.target.value));e.onChange(rr)},qt=(i=h==null?void 0:h.Dropdown)!==null&&i!==void 0?i:Dropdown;return jsxRuntimeExports.jsx(qt,{name:"years","aria-label":g(),className:et.dropdown_year,style:$.dropdown_year,onChange:Gt,value:a.getFullYear(),caption:b(a,{locale:d}),children:st.map(function(Lt){return jsxRuntimeExports.jsx("option",{value:Lt.getFullYear(),children:b(Lt,{locale:d})},Lt.getFullYear())})})}function useControlledValue(e,i){var a=reactExports.useState(e),o=a[0],c=a[1],s=i===void 0?o:i;return[s,c]}function getInitialMonth(e){var i=e.month,a=e.defaultMonth,o=e.today,c=i||a||o||new Date,s=e.toDate,d=e.fromDate,$=e.numberOfMonths,et=$===void 0?1:$;if(s&&differenceInCalendarMonths(s,c)<0){var h=-1*(et-1);c=addMonths(s,h)}return d&&differenceInCalendarMonths(c,d)<0&&(c=d),startOfMonth(c)}function useNavigationState(){var e=useDayPicker(),i=getInitialMonth(e),a=useControlledValue(i,e.month),o=a[0],c=a[1],s=function(d){var $;if(!e.disableNavigation){var et=startOfMonth(d);c(et),($=e.onMonthChange)===null||$===void 0||$.call(e,et)}};return[o,s]}function getDisplayMonths(e,i){for(var a=i.reverseMonths,o=i.numberOfMonths,c=startOfMonth(e),s=startOfMonth(addMonths(c,o)),d=differenceInCalendarMonths(s,c),$=[],et=0;et<d;et++){var h=addMonths(c,et);$.push(h)}return a&&($=$.reverse()),$}function getNextMonth(e,i){if(!i.disableNavigation){var a=i.toDate,o=i.pagedNavigation,c=i.numberOfMonths,s=c===void 0?1:c,d=o?s:1,$=startOfMonth(e);if(!a)return addMonths($,d);var et=differenceInCalendarMonths(a,e);if(!(et<s))return addMonths($,d)}}function getPreviousMonth(e,i){if(!i.disableNavigation){var a=i.fromDate,o=i.pagedNavigation,c=i.numberOfMonths,s=c===void 0?1:c,d=o?s:1,$=startOfMonth(e);if(!a)return addMonths($,-d);var et=differenceInCalendarMonths($,a);if(!(et<=0))return addMonths($,-d)}}var NavigationContext=reactExports.createContext(void 0);function NavigationProvider(e){var i=useDayPicker(),a=useNavigationState(),o=a[0],c=a[1],s=getDisplayMonths(o,i),d=getNextMonth(o,i),$=getPreviousMonth(o,i),et=function(g){return s.some(function(st){return isSameMonth(g,st)})},h=function(g,st){et(g)||(st&&isBefore(g,st)?c(addMonths(g,1+i.numberOfMonths*-1)):c(g))},b={currentMonth:o,displayMonths:s,goToMonth:c,goToDate:h,previousMonth:$,nextMonth:d,isDateDisplayed:et};return jsxRuntimeExports.jsx(NavigationContext.Provider,{value:b,children:e.children})}function useNavigation(){var e=reactExports.useContext(NavigationContext);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function CaptionDropdowns(e){var i,a=useDayPicker(),o=a.classNames,c=a.styles,s=a.components,d=useNavigation().goToMonth,$=function(b){d(addMonths(b,e.displayIndex?-e.displayIndex:0))},et=(i=s==null?void 0:s.CaptionLabel)!==null&&i!==void 0?i:CaptionLabel,h=jsxRuntimeExports.jsx(et,{id:e.id,displayMonth:e.displayMonth});return jsxRuntimeExports.jsxs("div",{className:o.caption_dropdowns,style:c.caption_dropdowns,children:[jsxRuntimeExports.jsx("div",{className:o.vhidden,children:h}),jsxRuntimeExports.jsx(MonthsDropdown,{onChange:$,displayMonth:e.displayMonth}),jsxRuntimeExports.jsx(YearsDropdown,{onChange:$,displayMonth:e.displayMonth})]})}function IconLeft(e){return jsxRuntimeExports.jsx("svg",__assign({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:jsxRuntimeExports.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function IconRight(e){return jsxRuntimeExports.jsx("svg",__assign({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:jsxRuntimeExports.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var Button=reactExports.forwardRef(function(e,i){var a=useDayPicker(),o=a.classNames,c=a.styles,s=[o.button_reset,o.button];e.className&&s.push(e.className);var d=s.join(" "),$=__assign(__assign({},c.button_reset),c.button);return e.style&&Object.assign($,e.style),jsxRuntimeExports.jsx("button",__assign({},e,{ref:i,type:"button",className:d,style:$}))});function Navigation(e){var i,a,o=useDayPicker(),c=o.dir,s=o.locale,d=o.classNames,$=o.styles,et=o.labels,h=et.labelPrevious,b=et.labelNext,g=o.components;if(!e.nextMonth&&!e.previousMonth)return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{});var st=h(e.previousMonth,{locale:s}),$t=[d.nav_button,d.nav_button_previous].join(" "),vt=b(e.nextMonth,{locale:s}),Ft=[d.nav_button,d.nav_button_next].join(" "),Gt=(i=g==null?void 0:g.IconRight)!==null&&i!==void 0?i:IconRight,qt=(a=g==null?void 0:g.IconLeft)!==null&&a!==void 0?a:IconLeft;return jsxRuntimeExports.jsxs("div",{className:d.nav,style:$.nav,children:[!e.hidePrevious&&jsxRuntimeExports.jsx(Button,{name:"previous-month","aria-label":st,className:$t,style:$.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:c==="rtl"?jsxRuntimeExports.jsx(Gt,{className:d.nav_icon,style:$.nav_icon}):jsxRuntimeExports.jsx(qt,{className:d.nav_icon,style:$.nav_icon})}),!e.hideNext&&jsxRuntimeExports.jsx(Button,{name:"next-month","aria-label":vt,className:Ft,style:$.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:c==="rtl"?jsxRuntimeExports.jsx(qt,{className:d.nav_icon,style:$.nav_icon}):jsxRuntimeExports.jsx(Gt,{className:d.nav_icon,style:$.nav_icon})})]})}function CaptionNavigation(e){var i=useDayPicker().numberOfMonths,a=useNavigation(),o=a.previousMonth,c=a.nextMonth,s=a.goToMonth,d=a.displayMonths,$=d.findIndex(function(vt){return isSameMonth(e.displayMonth,vt)}),et=$===0,h=$===d.length-1,b=i>1&&(et||!h),g=i>1&&(h||!et),st=function(){o&&s(o)},$t=function(){c&&s(c)};return jsxRuntimeExports.jsx(Navigation,{displayMonth:e.displayMonth,hideNext:b,hidePrevious:g,nextMonth:c,previousMonth:o,onPreviousClick:st,onNextClick:$t})}function Caption(e){var i,a=useDayPicker(),o=a.classNames,c=a.disableNavigation,s=a.styles,d=a.captionLayout,$=a.components,et=(i=$==null?void 0:$.CaptionLabel)!==null&&i!==void 0?i:CaptionLabel,h;return c?h=jsxRuntimeExports.jsx(et,{id:e.id,displayMonth:e.displayMonth}):d==="dropdown"?h=jsxRuntimeExports.jsx(CaptionDropdowns,{displayMonth:e.displayMonth,id:e.id}):d==="dropdown-buttons"?h=jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(CaptionDropdowns,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),jsxRuntimeExports.jsx(CaptionNavigation,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):h=jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(et,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),jsxRuntimeExports.jsx(CaptionNavigation,{displayMonth:e.displayMonth,id:e.id})]}),jsxRuntimeExports.jsx("div",{className:o.caption,style:s.caption,children:h})}function Footer(e){var i=useDayPicker(),a=i.footer,o=i.styles,c=i.classNames.tfoot;return a?jsxRuntimeExports.jsx("tfoot",{className:c,style:o.tfoot,children:jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{colSpan:8,children:a})})}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})}function getWeekdays(e,i,a){for(var o=a?startOfISOWeek(new Date):startOfWeek(new Date,{locale:e,weekStartsOn:i}),c=[],s=0;s<7;s++){var d=addDays(o,s);c.push(d)}return c}function HeadRow(){var e=useDayPicker(),i=e.classNames,a=e.styles,o=e.showWeekNumber,c=e.locale,s=e.weekStartsOn,d=e.ISOWeek,$=e.formatters.formatWeekdayName,et=e.labels.labelWeekday,h=getWeekdays(c,s,d);return jsxRuntimeExports.jsxs("tr",{style:a.head_row,className:i.head_row,children:[o&&jsxRuntimeExports.jsx("td",{style:a.head_cell,className:i.head_cell}),h.map(function(b,g){return jsxRuntimeExports.jsx("th",{scope:"col",className:i.head_cell,style:a.head_cell,"aria-label":et(b,{locale:c}),children:$(b,{locale:c})},g)})]})}function Head(){var e,i=useDayPicker(),a=i.classNames,o=i.styles,c=i.components,s=(e=c==null?void 0:c.HeadRow)!==null&&e!==void 0?e:HeadRow;return jsxRuntimeExports.jsx("thead",{style:o.head,className:a.head,children:jsxRuntimeExports.jsx(s,{})})}function DayContent(e){var i=useDayPicker(),a=i.locale,o=i.formatters.formatDay;return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:o(e.date,{locale:a})})}var SelectMultipleContext=reactExports.createContext(void 0);function SelectMultipleProvider(e){if(!isDayPickerMultiple(e.initialProps)){var i={selected:void 0,modifiers:{disabled:[]}};return jsxRuntimeExports.jsx(SelectMultipleContext.Provider,{value:i,children:e.children})}return jsxRuntimeExports.jsx(SelectMultipleProviderInternal,{initialProps:e.initialProps,children:e.children})}function SelectMultipleProviderInternal(e){var i=e.initialProps,a=e.children,o=i.selected,c=i.min,s=i.max,d=function(h,b,g){var st,$t;(st=i.onDayClick)===null||st===void 0||st.call(i,h,b,g);var vt=!!(b.selected&&c&&(o==null?void 0:o.length)===c);if(!vt){var Ft=!!(!b.selected&&s&&(o==null?void 0:o.length)===s);if(!Ft){var Gt=o?__spreadArray([],o,!0):[];if(b.selected){var qt=Gt.findIndex(function(Lt){return isSameDay(h,Lt)});Gt.splice(qt,1)}else Gt.push(h);($t=i.onSelect)===null||$t===void 0||$t.call(i,Gt,h,b,g)}}},$={disabled:[]};o&&$.disabled.push(function(h){var b=s&&o.length>s-1,g=o.some(function(st){return isSameDay(st,h)});return!!(b&&!g)});var et={selected:o,onDayClick:d,modifiers:$};return jsxRuntimeExports.jsx(SelectMultipleContext.Provider,{value:et,children:a})}function useSelectMultiple(){var e=reactExports.useContext(SelectMultipleContext);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function addToRange(e,i){var a=i||{},o=a.from,c=a.to;return o&&c?isSameDay(c,e)&&isSameDay(o,e)?void 0:isSameDay(c,e)?{from:c,to:void 0}:isSameDay(o,e)?void 0:isAfter(o,e)?{from:e,to:c}:{from:o,to:e}:c?isAfter(e,c)?{from:c,to:e}:{from:e,to:c}:o?isBefore(e,o)?{from:e,to:o}:{from:o,to:e}:{from:e,to:void 0}}var SelectRangeContext=reactExports.createContext(void 0);function SelectRangeProvider(e){if(!isDayPickerRange(e.initialProps)){var i={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return jsxRuntimeExports.jsx(SelectRangeContext.Provider,{value:i,children:e.children})}return jsxRuntimeExports.jsx(SelectRangeProviderInternal,{initialProps:e.initialProps,children:e.children})}function SelectRangeProviderInternal(e){var i=e.initialProps,a=e.children,o=i.selected,c=o||{},s=c.from,d=c.to,$=i.min,et=i.max,h=function($t,vt,Ft){var Gt,qt;(Gt=i.onDayClick)===null||Gt===void 0||Gt.call(i,$t,vt,Ft);var Lt=addToRange($t,o);(qt=i.onSelect)===null||qt===void 0||qt.call(i,Lt,$t,vt,Ft)},b={range_start:[],range_end:[],range_middle:[],disabled:[]};if(s?(b.range_start=[s],d?(b.range_end=[d],isSameDay(s,d)||(b.range_middle=[{after:s,before:d}])):b.range_end=[s]):d&&(b.range_start=[d],b.range_end=[d]),$&&(s&&!d&&b.disabled.push({after:subDays(s,$-1),before:addDays(s,$-1)}),s&&d&&b.disabled.push({after:s,before:addDays(s,$-1)}),!s&&d&&b.disabled.push({after:subDays(d,$-1),before:addDays(d,$-1)})),et){if(s&&!d&&(b.disabled.push({before:addDays(s,-et+1)}),b.disabled.push({after:addDays(s,et-1)})),s&&d){var g=differenceInCalendarDays(d,s)+1,st=et-g;b.disabled.push({before:subDays(s,st)}),b.disabled.push({after:addDays(d,st)})}!s&&d&&(b.disabled.push({before:addDays(d,-et+1)}),b.disabled.push({after:addDays(d,et-1)}))}return jsxRuntimeExports.jsx(SelectRangeContext.Provider,{value:{selected:o,onDayClick:h,modifiers:b},children:a})}function useSelectRange(){var e=reactExports.useContext(SelectRangeContext);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function matcherToArray(e){return Array.isArray(e)?__spreadArray([],e,!0):e!==void 0?[e]:[]}function getCustomModifiers(e){var i={};return Object.entries(e).forEach(function(a){var o=a[0],c=a[1];i[o]=matcherToArray(c)}),i}var InternalModifier;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(InternalModifier||(InternalModifier={}));var Selected=InternalModifier.Selected,Disabled=InternalModifier.Disabled,Hidden=InternalModifier.Hidden,Today=InternalModifier.Today,RangeEnd=InternalModifier.RangeEnd,RangeMiddle=InternalModifier.RangeMiddle,RangeStart=InternalModifier.RangeStart,Outside=InternalModifier.Outside;function getInternalModifiers(e,i,a){var o,c=(o={},o[Selected]=matcherToArray(e.selected),o[Disabled]=matcherToArray(e.disabled),o[Hidden]=matcherToArray(e.hidden),o[Today]=[e.today],o[RangeEnd]=[],o[RangeMiddle]=[],o[RangeStart]=[],o[Outside]=[],o);return e.fromDate&&c[Disabled].push({before:e.fromDate}),e.toDate&&c[Disabled].push({after:e.toDate}),isDayPickerMultiple(e)?c[Disabled]=c[Disabled].concat(i.modifiers[Disabled]):isDayPickerRange(e)&&(c[Disabled]=c[Disabled].concat(a.modifiers[Disabled]),c[RangeStart]=a.modifiers[RangeStart],c[RangeMiddle]=a.modifiers[RangeMiddle],c[RangeEnd]=a.modifiers[RangeEnd]),c}var ModifiersContext=reactExports.createContext(void 0);function ModifiersProvider(e){var i=useDayPicker(),a=useSelectMultiple(),o=useSelectRange(),c=getInternalModifiers(i,a,o),s=getCustomModifiers(i.modifiers),d=__assign(__assign({},c),s);return jsxRuntimeExports.jsx(ModifiersContext.Provider,{value:d,children:e.children})}function useModifiers(){var e=reactExports.useContext(ModifiersContext);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function isDateInterval(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function isDateRange(e){return!!(e&&typeof e=="object"&&"from"in e)}function isDateAfterType(e){return!!(e&&typeof e=="object"&&"after"in e)}function isDateBeforeType(e){return!!(e&&typeof e=="object"&&"before"in e)}function isDayOfWeekType(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function isDateInRange(e,i){var a,o=i.from,c=i.to;if(o&&c){var s=differenceInCalendarDays(c,o)<0;s&&(a=[c,o],o=a[0],c=a[1]);var d=differenceInCalendarDays(e,o)>=0&&differenceInCalendarDays(c,e)>=0;return d}return c?isSameDay(c,e):o?isSameDay(o,e):!1}function isDateType(e){return isDate(e)}function isArrayOfDates(e){return Array.isArray(e)&&e.every(isDate)}function isMatch(e,i){return i.some(function(a){if(typeof a=="boolean")return a;if(isDateType(a))return isSameDay(e,a);if(isArrayOfDates(a))return a.includes(e);if(isDateRange(a))return isDateInRange(e,a);if(isDayOfWeekType(a))return a.dayOfWeek.includes(e.getDay());if(isDateInterval(a)){var o=differenceInCalendarDays(a.before,e),c=differenceInCalendarDays(a.after,e),s=o>0,d=c<0,$=isAfter(a.before,a.after);return $?d&&s:s||d}return isDateAfterType(a)?differenceInCalendarDays(e,a.after)>0:isDateBeforeType(a)?differenceInCalendarDays(a.before,e)>0:typeof a=="function"?a(e):!1})}function getActiveModifiers(e,i,a){var o=Object.keys(i).reduce(function(s,d){var $=i[d];return isMatch(e,$)&&s.push(d),s},[]),c={};return o.forEach(function(s){return c[s]=!0}),a&&!isSameMonth(e,a)&&(c.outside=!0),c}function getInitialFocusTarget(e,i){for(var a=startOfMonth(e[0]),o=endOfMonth(e[e.length-1]),c,s,d=a;d<=o;){var $=getActiveModifiers(d,i),et=!$.disabled&&!$.hidden;if(!et){d=addDays(d,1);continue}if($.selected)return d;$.today&&!s&&(s=d),c||(c=d),d=addDays(d,1)}return s||c}var MAX_RETRY=365;function getNextFocus(e,i){var a=i.moveBy,o=i.direction,c=i.context,s=i.modifiers,d=i.retry,$=d===void 0?{count:0,lastFocused:e}:d,et=c.weekStartsOn,h=c.fromDate,b=c.toDate,g=c.locale,st={day:addDays,week:addWeeks,month:addMonths,year:addYears,startOfWeek:function(Gt){return c.ISOWeek?startOfISOWeek(Gt):startOfWeek(Gt,{locale:g,weekStartsOn:et})},endOfWeek:function(Gt){return c.ISOWeek?endOfISOWeek(Gt):endOfWeek(Gt,{locale:g,weekStartsOn:et})}},$t=st[a](e,o==="after"?1:-1);o==="before"&&h?$t=max([h,$t]):o==="after"&&b&&($t=min([b,$t]));var vt=!0;if(s){var Ft=getActiveModifiers($t,s);vt=!Ft.disabled&&!Ft.hidden}return vt?$t:$.count>MAX_RETRY?$.lastFocused:getNextFocus($t,{moveBy:a,direction:o,context:c,modifiers:s,retry:__assign(__assign({},$),{count:$.count+1})})}var FocusContext=reactExports.createContext(void 0);function FocusProvider(e){var i=useNavigation(),a=useModifiers(),o=reactExports.useState(),c=o[0],s=o[1],d=reactExports.useState(),$=d[0],et=d[1],h=getInitialFocusTarget(i.displayMonths,a),b=c??($&&i.isDateDisplayed($))?$:h,g=function(){et(c),s(void 0)},st=function(Gt){s(Gt)},$t=useDayPicker(),vt=function(Gt,qt){if(c){var Lt=getNextFocus(c,{moveBy:Gt,direction:qt,context:$t,modifiers:a});isSameDay(c,Lt)||(i.goToDate(Lt,c),st(Lt))}},Ft={focusedDay:c,focusTarget:b,blur:g,focus:st,focusDayAfter:function(){return vt("day","after")},focusDayBefore:function(){return vt("day","before")},focusWeekAfter:function(){return vt("week","after")},focusWeekBefore:function(){return vt("week","before")},focusMonthBefore:function(){return vt("month","before")},focusMonthAfter:function(){return vt("month","after")},focusYearBefore:function(){return vt("year","before")},focusYearAfter:function(){return vt("year","after")},focusStartOfWeek:function(){return vt("startOfWeek","before")},focusEndOfWeek:function(){return vt("endOfWeek","after")}};return jsxRuntimeExports.jsx(FocusContext.Provider,{value:Ft,children:e.children})}function useFocusContext(){var e=reactExports.useContext(FocusContext);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function useActiveModifiers(e,i){var a=useModifiers(),o=getActiveModifiers(e,a,i);return o}var SelectSingleContext=reactExports.createContext(void 0);function SelectSingleProvider(e){if(!isDayPickerSingle(e.initialProps)){var i={selected:void 0};return jsxRuntimeExports.jsx(SelectSingleContext.Provider,{value:i,children:e.children})}return jsxRuntimeExports.jsx(SelectSingleProviderInternal,{initialProps:e.initialProps,children:e.children})}function SelectSingleProviderInternal(e){var i=e.initialProps,a=e.children,o=function(s,d,$){var et,h,b;if((et=i.onDayClick)===null||et===void 0||et.call(i,s,d,$),d.selected&&!i.required){(h=i.onSelect)===null||h===void 0||h.call(i,void 0,s,d,$);return}(b=i.onSelect)===null||b===void 0||b.call(i,s,s,d,$)},c={selected:i.selected,onDayClick:o};return jsxRuntimeExports.jsx(SelectSingleContext.Provider,{value:c,children:a})}function useSelectSingle(){var e=reactExports.useContext(SelectSingleContext);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function useDayEventHandlers(e,i){var a=useDayPicker(),o=useSelectSingle(),c=useSelectMultiple(),s=useSelectRange(),d=useFocusContext(),$=d.focusDayAfter,et=d.focusDayBefore,h=d.focusWeekAfter,b=d.focusWeekBefore,g=d.blur,st=d.focus,$t=d.focusMonthBefore,vt=d.focusMonthAfter,Ft=d.focusYearBefore,Gt=d.focusYearAfter,qt=d.focusStartOfWeek,Lt=d.focusEndOfWeek,rr=function(e0){var Sn,t0,d0,xn;isDayPickerSingle(a)?(Sn=o.onDayClick)===null||Sn===void 0||Sn.call(o,e,i,e0):isDayPickerMultiple(a)?(t0=c.onDayClick)===null||t0===void 0||t0.call(c,e,i,e0):isDayPickerRange(a)?(d0=s.onDayClick)===null||d0===void 0||d0.call(s,e,i,e0):(xn=a.onDayClick)===null||xn===void 0||xn.call(a,e,i,e0)},jr=function(e0){var Sn;st(e),(Sn=a.onDayFocus)===null||Sn===void 0||Sn.call(a,e,i,e0)},Hr=function(e0){var Sn;g(),(Sn=a.onDayBlur)===null||Sn===void 0||Sn.call(a,e,i,e0)},wn=function(e0){var Sn;(Sn=a.onDayMouseEnter)===null||Sn===void 0||Sn.call(a,e,i,e0)},_n=function(e0){var Sn;(Sn=a.onDayMouseLeave)===null||Sn===void 0||Sn.call(a,e,i,e0)},No=function(e0){var Sn;(Sn=a.onDayPointerEnter)===null||Sn===void 0||Sn.call(a,e,i,e0)},Qo=function(e0){var Sn;(Sn=a.onDayPointerLeave)===null||Sn===void 0||Sn.call(a,e,i,e0)},Xo=function(e0){var Sn;(Sn=a.onDayTouchCancel)===null||Sn===void 0||Sn.call(a,e,i,e0)},l0=function(e0){var Sn;(Sn=a.onDayTouchEnd)===null||Sn===void 0||Sn.call(a,e,i,e0)},v0=function(e0){var Sn;(Sn=a.onDayTouchMove)===null||Sn===void 0||Sn.call(a,e,i,e0)},x0=function(e0){var Sn;(Sn=a.onDayTouchStart)===null||Sn===void 0||Sn.call(a,e,i,e0)},D0=function(e0){var Sn;(Sn=a.onDayKeyUp)===null||Sn===void 0||Sn.call(a,e,i,e0)},M0=function(e0){var Sn;switch(e0.key){case"ArrowLeft":e0.preventDefault(),e0.stopPropagation(),a.dir==="rtl"?$():et();break;case"ArrowRight":e0.preventDefault(),e0.stopPropagation(),a.dir==="rtl"?et():$();break;case"ArrowDown":e0.preventDefault(),e0.stopPropagation(),h();break;case"ArrowUp":e0.preventDefault(),e0.stopPropagation(),b();break;case"PageUp":e0.preventDefault(),e0.stopPropagation(),e0.shiftKey?Ft():$t();break;case"PageDown":e0.preventDefault(),e0.stopPropagation(),e0.shiftKey?Gt():vt();break;case"Home":e0.preventDefault(),e0.stopPropagation(),qt();break;case"End":e0.preventDefault(),e0.stopPropagation(),Lt();break}(Sn=a.onDayKeyDown)===null||Sn===void 0||Sn.call(a,e,i,e0)},Mo={onClick:rr,onFocus:jr,onBlur:Hr,onKeyDown:M0,onKeyUp:D0,onMouseEnter:wn,onMouseLeave:_n,onPointerEnter:No,onPointerLeave:Qo,onTouchCancel:Xo,onTouchEnd:l0,onTouchMove:v0,onTouchStart:x0};return Mo}function useSelectedDays(){var e=useDayPicker(),i=useSelectSingle(),a=useSelectMultiple(),o=useSelectRange(),c=isDayPickerSingle(e)?i.selected:isDayPickerMultiple(e)?a.selected:isDayPickerRange(e)?o.selected:void 0;return c}function isInternalModifier(e){return Object.values(InternalModifier).includes(e)}function getDayClassNames(e,i){var a=[e.classNames.day];return Object.keys(i).forEach(function(o){var c=e.modifiersClassNames[o];if(c)a.push(c);else if(isInternalModifier(o)){var s=e.classNames["day_".concat(o)];s&&a.push(s)}}),a}function getDayStyle(e,i){var a=__assign({},e.styles.day);return Object.keys(i).forEach(function(o){var c;a=__assign(__assign({},a),(c=e.modifiersStyles)===null||c===void 0?void 0:c[o])}),a}function useDayRender(e,i,a){var o,c,s,d=useDayPicker(),$=useFocusContext(),et=useActiveModifiers(e,i),h=useDayEventHandlers(e,et),b=useSelectedDays(),g=!!(d.onDayClick||d.mode!=="default");reactExports.useEffect(function(){var wn;et.outside||$.focusedDay&&g&&isSameDay($.focusedDay,e)&&((wn=a.current)===null||wn===void 0||wn.focus())},[$.focusedDay,e,a,g,et.outside]);var st=getDayClassNames(d,et).join(" "),$t=getDayStyle(d,et),vt=!!(et.outside&&!d.showOutsideDays||et.hidden),Ft=(s=(c=d.components)===null||c===void 0?void 0:c.DayContent)!==null&&s!==void 0?s:DayContent,Gt=jsxRuntimeExports.jsx(Ft,{date:e,displayMonth:i,activeModifiers:et}),qt={style:$t,className:st,children:Gt,role:"gridcell"},Lt=$.focusTarget&&isSameDay($.focusTarget,e)&&!et.outside,rr=$.focusedDay&&isSameDay($.focusedDay,e),jr=__assign(__assign(__assign({},qt),(o={disabled:et.disabled,role:"gridcell"},o["aria-selected"]=et.selected,o.tabIndex=rr||Lt?0:-1,o)),h),Hr={isButton:g,isHidden:vt,activeModifiers:et,selectedDays:b,buttonProps:jr,divProps:qt};return Hr}function Day(e){var i=reactExports.useRef(null),a=useDayRender(e.date,e.displayMonth,i);return a.isHidden?jsxRuntimeExports.jsx("div",{role:"gridcell"}):a.isButton?jsxRuntimeExports.jsx(Button,__assign({name:"day",ref:i},a.buttonProps)):jsxRuntimeExports.jsx("div",__assign({},a.divProps))}function WeekNumber(e){var i=e.number,a=e.dates,o=useDayPicker(),c=o.onWeekNumberClick,s=o.styles,d=o.classNames,$=o.locale,et=o.labels.labelWeekNumber,h=o.formatters.formatWeekNumber,b=h(Number(i),{locale:$});if(!c)return jsxRuntimeExports.jsx("span",{className:d.weeknumber,style:s.weeknumber,children:b});var g=et(Number(i),{locale:$}),st=function($t){c(i,a,$t)};return jsxRuntimeExports.jsx(Button,{name:"week-number","aria-label":g,className:d.weeknumber,style:s.weeknumber,onClick:st,children:b})}function Row(e){var i,a,o=useDayPicker(),c=o.styles,s=o.classNames,d=o.showWeekNumber,$=o.components,et=(i=$==null?void 0:$.Day)!==null&&i!==void 0?i:Day,h=(a=$==null?void 0:$.WeekNumber)!==null&&a!==void 0?a:WeekNumber,b;return d&&(b=jsxRuntimeExports.jsx("td",{className:s.cell,style:c.cell,children:jsxRuntimeExports.jsx(h,{number:e.weekNumber,dates:e.dates})})),jsxRuntimeExports.jsxs("tr",{className:s.row,style:c.row,children:[b,e.dates.map(function(g){return jsxRuntimeExports.jsx("td",{className:s.cell,style:c.cell,role:"presentation",children:jsxRuntimeExports.jsx(et,{displayMonth:e.displayMonth,date:g})},getUnixTime(g))})]})}function daysToMonthWeeks(e,i,a){for(var o=a!=null&&a.ISOWeek?endOfISOWeek(i):endOfWeek(i,a),c=a!=null&&a.ISOWeek?startOfISOWeek(e):startOfWeek(e,a),s=differenceInCalendarDays(o,c),d=[],$=0;$<=s;$++)d.push(addDays(c,$));var et=d.reduce(function(h,b){var g=a!=null&&a.ISOWeek?getISOWeek(b):getWeek(b,a),st=h.find(function($t){return $t.weekNumber===g});return st?(st.dates.push(b),h):(h.push({weekNumber:g,dates:[b]}),h)},[]);return et}function getMonthWeeks(e,i){var a=daysToMonthWeeks(startOfMonth(e),endOfMonth(e),i);if(i!=null&&i.useFixedWeeks){var o=getWeeksInMonth(e,i);if(o<6){var c=a[a.length-1],s=c.dates[c.dates.length-1],d=addWeeks(s,6-o),$=daysToMonthWeeks(addWeeks(s,1),d,i);a.push.apply(a,$)}}return a}function Table(e){var i,a,o,c=useDayPicker(),s=c.locale,d=c.classNames,$=c.styles,et=c.hideHead,h=c.fixedWeeks,b=c.components,g=c.weekStartsOn,st=c.firstWeekContainsDate,$t=c.ISOWeek,vt=getMonthWeeks(e.displayMonth,{useFixedWeeks:!!h,ISOWeek:$t,locale:s,weekStartsOn:g,firstWeekContainsDate:st}),Ft=(i=b==null?void 0:b.Head)!==null&&i!==void 0?i:Head,Gt=(a=b==null?void 0:b.Row)!==null&&a!==void 0?a:Row,qt=(o=b==null?void 0:b.Footer)!==null&&o!==void 0?o:Footer;return jsxRuntimeExports.jsxs("table",{id:e.id,className:d.table,style:$.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!et&&jsxRuntimeExports.jsx(Ft,{}),jsxRuntimeExports.jsx("tbody",{className:d.tbody,style:$.tbody,children:vt.map(function(Lt){return jsxRuntimeExports.jsx(Gt,{displayMonth:e.displayMonth,dates:Lt.dates,weekNumber:Lt.weekNumber},Lt.weekNumber)})}),jsxRuntimeExports.jsx(qt,{displayMonth:e.displayMonth})]})}function canUseDOM(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var useIsomorphicLayoutEffect=canUseDOM()?reactExports.useLayoutEffect:reactExports.useEffect,serverHandoffComplete=!1,id=0;function genId(){return"react-day-picker-".concat(++id)}function useId(e){var i,a=e??(serverHandoffComplete?genId():null),o=reactExports.useState(a),c=o[0],s=o[1];return useIsomorphicLayoutEffect(function(){c===null&&s(genId())},[]),reactExports.useEffect(function(){serverHandoffComplete===!1&&(serverHandoffComplete=!0)},[]),(i=e??c)!==null&&i!==void 0?i:void 0}function Month(e){var i,a,o=useDayPicker(),c=o.dir,s=o.classNames,d=o.styles,$=o.components,et=useNavigation().displayMonths,h=useId(o.id?"".concat(o.id,"-").concat(e.displayIndex):void 0),b=o.id?"".concat(o.id,"-grid-").concat(e.displayIndex):void 0,g=[s.month],st=d.month,$t=e.displayIndex===0,vt=e.displayIndex===et.length-1,Ft=!$t&&!vt;c==="rtl"&&(i=[$t,vt],vt=i[0],$t=i[1]),$t&&(g.push(s.caption_start),st=__assign(__assign({},st),d.caption_start)),vt&&(g.push(s.caption_end),st=__assign(__assign({},st),d.caption_end)),Ft&&(g.push(s.caption_between),st=__assign(__assign({},st),d.caption_between));var Gt=(a=$==null?void 0:$.Caption)!==null&&a!==void 0?a:Caption;return jsxRuntimeExports.jsxs("div",{className:g.join(" "),style:st,children:[jsxRuntimeExports.jsx(Gt,{id:h,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),jsxRuntimeExports.jsx(Table,{id:b,"aria-labelledby":h,displayMonth:e.displayMonth})]},e.displayIndex)}function Months(e){var i=useDayPicker(),a=i.classNames,o=i.styles;return jsxRuntimeExports.jsx("div",{className:a.months,style:o.months,children:e.children})}function Root(e){var i,a,o=e.initialProps,c=useDayPicker(),s=useFocusContext(),d=useNavigation(),$=reactExports.useState(!1),et=$[0],h=$[1];reactExports.useEffect(function(){c.initialFocus&&s.focusTarget&&(et||(s.focus(s.focusTarget),h(!0)))},[c.initialFocus,et,s.focus,s.focusTarget,s]);var b=[c.classNames.root,c.className];c.numberOfMonths>1&&b.push(c.classNames.multiple_months),c.showWeekNumber&&b.push(c.classNames.with_weeknumber);var g=__assign(__assign({},c.styles.root),c.style),st=Object.keys(o).filter(function(vt){return vt.startsWith("data-")}).reduce(function(vt,Ft){var Gt;return __assign(__assign({},vt),(Gt={},Gt[Ft]=o[Ft],Gt))},{}),$t=(a=(i=o.components)===null||i===void 0?void 0:i.Months)!==null&&a!==void 0?a:Months;return jsxRuntimeExports.jsx("div",__assign({className:b.join(" "),style:g,dir:c.dir,id:c.id,nonce:o.nonce,title:o.title,lang:o.lang},st,{children:jsxRuntimeExports.jsx($t,{children:d.displayMonths.map(function(vt,Ft){return jsxRuntimeExports.jsx(Month,{displayIndex:Ft,displayMonth:vt},Ft)})})}))}function RootProvider(e){var i=e.children,a=__rest(e,["children"]);return jsxRuntimeExports.jsx(DayPickerProvider,{initialProps:a,children:jsxRuntimeExports.jsx(NavigationProvider,{children:jsxRuntimeExports.jsx(SelectSingleProvider,{initialProps:a,children:jsxRuntimeExports.jsx(SelectMultipleProvider,{initialProps:a,children:jsxRuntimeExports.jsx(SelectRangeProvider,{initialProps:a,children:jsxRuntimeExports.jsx(ModifiersProvider,{children:jsxRuntimeExports.jsx(FocusProvider,{children:i})})})})})})})}function DayPicker(e){return jsxRuntimeExports.jsx(RootProvider,__assign({},e,{children:jsxRuntimeExports.jsx(Root,{initialProps:e})}))}const style="",dateToQueryParam=e=>{const i=e.split(" "),[a,o]=i;return`${a}_${o}`},getDescription=(e,i)=>[`From: ${format(e,"dd/MM/yyyy")}`,`To: ${format(i,"dd/MM/yyyy HH:00")}`,`(${format(i,"EEEE")})`],createDateTime=(e,i)=>(e.setHours(parseInt(i,10),0,0,0),e),queryToDate=e=>{const[i,a]=e.split("_"),o=new Date(i);return createDateTime(o,a)},getIntervalFromId=e=>{const i=new Date,a=queryToDate(e);return isNaN(a.getTime())?[null,null,null]:[i,a,getDescription(i,a)]},durationToString=e=>{if(!e)return"Invalid duration";const i=Math.floor(e/1e3),a=Math.floor(i/60),o=Math.floor(a/60),c=Math.floor(o/24),s=("0"+i%60).slice(-2),d=("0"+a%60).slice(-2),$=("0"+o%24).slice(-2);return`${c!==0?c+"d ":""}${$}h ${d}m ${s}s`},useIntervalCountdown=e=>{const[i,a]=reactExports.useState(null),[o,c]=reactExports.useState(!1);return reactExports.useEffect(()=>{if(!e){c(!0);return}const s=()=>{const $=new Date,et=e.getTime()-$.getTime();if(et<=0){c(!0),a(0);return}a(et)};s();const d=setInterval(s,1e3);return()=>clearInterval(d)},[e]),{remainingTime:i,durationString:durationToString(i),expired:o}},ViewCountdown=({end:e,name:i,description:a})=>{const{durationString:o}=useIntervalCountdown(e),c=decodeURIComponent(i||"");return jsxRuntimeExports.jsx(Page,{landing:!0,children:jsxRuntimeExports.jsx("div",{className:"my-[50px] flex items-start justify-center text-white",children:jsxRuntimeExports.jsxs("div",{className:"shadow rounded-lg p-6 max-w-sm w-full bg-white border border-gray-200 dark:bg-gray-800 dark:border-gray-700",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-bold text-center mb-4 capitalize",children:c?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:["Countdown to",jsxRuntimeExports.jsx("br",{}),titleCase(c)]}):`Countdown to ${format(e,"dd/MM/yyyy")}`}),jsxRuntimeExports.jsxs("div",{className:"text-center mb-4",children:[a.map(s=>jsxRuntimeExports.jsx("div",{className:"my-2",children:s},s)),o&&jsxRuntimeExports.jsx("div",{children:o})]}),jsxRuntimeExports.jsx("div",{className:"mt-20 w-full",children:i&&jsxRuntimeExports.jsx(Link,{target:"_blank",to:getNewsURL(i),className:"w-full bg-green-700 text-white py-2 px-4 rounded",children:"What's going on in over there?"})}),jsxRuntimeExports.jsx("div",{className:"mt-20 w-full",children:jsxRuntimeExports.jsx(Link,{to:"/labs/countdown",className:"w-full text-white py-2 px-4 rounded hover:bg-blue-700",children:"Click to create a countdown"})})]})})})},notHexDecimalRegex=/[^a-zA-Z0-9]/g,replaceNonHexDecimal=(e,i="")=>e.replace(notHexDecimalRegex,i),dateIsToday=e=>e.getDate()===new Date().getDate()&&e.getMonth()===new Date().getMonth()&&e.getFullYear()===new Date().getFullYear(),dateIsInThePast=e=>e.getTime()<new Date().getTime(),sanitize=e=>e?encodeURIComponent(limitString(replaceNonHexDecimal(e," "),30)):"",Countdown=()=>{const{id:e,countdownName:i}=useParams(),[a,o]=reactExports.useState(new Date),[c,s]=reactExports.useState("10:00"),[d,$]=reactExports.useState("");if(e){const[h,b,g]=getIntervalFromId(e);return!h||!b?jsxRuntimeExports.jsx(Page,{name:"View Countdown",description:"Invalid countdown",children:jsxRuntimeExports.jsx(Link,{to:"/labs/countdown",className:"btn btn-black text-blue-600",children:"Create one here."})}):jsxRuntimeExports.jsx(ViewCountdown,{end:b,name:sanitize(i),description:g})}const et=()=>{if(!a)return;const h=a.getDate(),b=a.getMonth()+1,g=a.getFullYear(),$t=`#/labs/countdown/${dateToQueryParam(`${g}-${b}-${h} ${c}`)}`+(d?`/${encodeURIComponent(d)}`:"");o(void 0),$(""),window.location.href=$t};return jsxRuntimeExports.jsx(Page,{name:"Countdown",className:"flex items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 max-w-md w-full",children:[jsxRuntimeExports.jsx("div",{className:"mb-6",children:jsxRuntimeExports.jsx("input",{type:"text",id:"first_name",value:d,onChange:h=>$(h.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"Enter countdown name",required:!0,maxLength:30,minLength:5})}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx(DayPicker,{mode:"single",selected:a,onSelect:o}),!a&&jsxRuntimeExports.jsx("p",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:"Please select a different ending date."})]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("label",{htmlFor:"theTime",className:"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"Select time"}),jsxRuntimeExports.jsx("select",{value:c,id:"theTime",name:"theTime",onChange:h=>s(h.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",children:Array.from({length:24},(h,b)=>b).map(h=>jsxRuntimeExports.jsxs("option",{value:h,children:[h,":00"]},h))})]}),jsxRuntimeExports.jsx("button",{disabled:!a||dateIsToday(a)||dateIsInThePast(a)||!d,className:`w-full py-2 px-4 rounded ${!a||dateIsToday(a)||dateIsInThePast(a)||!d?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-700 text-white"}`,onClick:et,children:"Create Countdown"})]})})},oldRoutes=[{from:["/bg","experiment/bg"],to:"/labs/bg"},{from:["/game","/experiment/game"],to:"/labs/game"},{from:"/experiments/timezones",to:"/labs/timezones"}].map(({from:e,to:i})=>typeof e=="string"?{from:e,to:i}:e.map(a=>({from:a,to:i}))).flat(),App=()=>jsxRuntimeExports.jsx(HashRouter,{basename:"/",children:jsxRuntimeExports.jsxs("div",{className:"grid min-h-[100dvh] grid-rows-[auto_1fr_auto]",children:[jsxRuntimeExports.jsx(Navbar,{}),jsxRuntimeExports.jsx("main",{children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(Home,{})}),jsxRuntimeExports.jsx(Route,{path:"/about",element:jsxRuntimeExports.jsx(Resume,{})}),jsxRuntimeExports.jsx(Route,{path:"/resume",element:jsxRuntimeExports.jsx(Resume,{})}),jsxRuntimeExports.jsx(Route,{path:"/blog",element:jsxRuntimeExports.jsx(Blog,{})}),jsxRuntimeExports.jsx(Route,{path:"/labs",element:jsxRuntimeExports.jsx(Labs,{})}),jsxRuntimeExports.jsx(Route,{path:"/labs/background",element:jsxRuntimeExports.jsx(RemoveBackground,{})}),jsxRuntimeExports.jsx(Route,{path:"/labs/game",element:jsxRuntimeExports.jsx(CanvasGame,{})}),jsxRuntimeExports.jsx(Route,{path:"/labs/timezones",element:jsxRuntimeExports.jsx(WeatherApp,{})}),jsxRuntimeExports.jsx(Route,{path:"/labs/weather",element:jsxRuntimeExports.jsx(WeatherApp,{})}),jsxRuntimeExports.jsx(Route,{path:"/labs/code-pen",element:jsxRuntimeExports.jsx(CodePen,{})}),jsxRuntimeExports.jsx(Route,{path:"/labs/countdown",element:jsxRuntimeExports.jsx(Countdown,{})}),jsxRuntimeExports.jsx(Route,{path:"/labs/countdown/:id/:countdownName?",element:jsxRuntimeExports.jsx(Countdown,{})}),oldRoutes.map(({from:e,to:i})=>jsxRuntimeExports.jsx(Route,{path:e,element:jsxRuntimeExports.jsx(Navigate,{to:i})},`${e}-${i}`)),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(Navigate,{to:"/"})})]})}),jsxRuntimeExports.jsx(Footer$1,{})]})});client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
